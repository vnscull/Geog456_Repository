// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.45/esri/copyright.txt for details.
// See https://www.arcgis.com/home/copyright.txt for further details.
//>>built
/*
 layerInfo.showLabels && layer.url ||*/
require({cache:{"arcgisonline/pages/basePage":function(){define("require exports tslib calcite-web/js/calcite-web dojo/_base/kernel dojo/Deferred dojo/when dojo/_base/lang dojo/_base/window dojo/query dojo/debounce dijit/_WidgetBase dijit/registry dojo/on dojo/string dojo/topic dojo/dom-attr dojo/dom-construct dojo/dom-class esri/Evented esri/config arcgisonline/sharing/util ./utils/alerts ./utils/dom ./utils/organization arcgisonline/telemetry ../sharing/dijit/SiteHeader ./components/SiteFooter ./components/ManageBlockedApps/blocked-apps-service ../tsutils/declareDecorator arcgisonline/esriGeowConfig preact ./utils/queryHandler dojo/i18n!../nls/arcgisonline dojo/i18n!../nls/notebooks".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);C=p.__importStar(C);y=p.__importDefault(y);G=p.__importDefault(G);return function(){function L(O){this.esriPortalConfig=F.default;this._handles=[];this._forceErrorToast=this._hideErrors=this._showErrors=this.hideFooter=this.hideHeader=this.isLoaded=!1;this.page=p.__assign({},O);this.portalUser=
O.portalUser||null;this.portal=O.portal||null}L.prototype.destroy=function(){(0,D.render)(null,this.footerDiv)};L.prototype.postMixInProperties=function(){this.inherited(arguments);this.i18n=y.default;this.i18n.notebookLanding=G.default.notebookLanding;this.i18n.notebookViewer=G.default.notebookViewer;this.i18n.notebookServerManager=G.default.notebookServerManager;this.i18n.CreateNotebookDlg=G.default.CreateNotebookDlg;z.default.defaults.io.errorHandler=this._showError.bind(this);this._queryStringParams=
C.queryToObject(window.location.search.slice(1))};L.prototype.startup=function(){this.inherited(arguments);this.telemetry=R.default.init({config:this.portal});var O=getComputedStyle(document.documentElement);"rgba(0, 0, 0, 0)"===(null===O||void 0===O?void 0:O["background-color"])&&document.body.classList.contains("dj_a11y")&&document.documentElement.classList.add("a11y-black");this._buildPage();this._addEventListeners()};L.prototype.toggleErrors=function(O){this._hideErrors=!O;this._showErrors=O};
L.prototype._setPageTitleAttr=function(O){window.document.title=O};L.prototype._setIsLoadedAttr=function(O){this.isLoaded=O};L.prototype.showLoader=function(){J.default.activateNode(this._loader);J.default.hideNode(this._content)};L.prototype.hideLoader=function(){J.default.deactivateNode(document.querySelector(".js-page-loader"));J.default.showNode(document.querySelector(".js-content-wrapper"));J.default.deactivateNode(this._loader);J.default.showNode(this._content)};L.prototype.removeError=function(){var O=
document.querySelector(".js-alert");O&&u.default.destroy(O)};L.prototype.hideErrors=function(){var O=document.querySelector(".js-alert");O&&u.default.empty(O)};L.prototype.showAlert=function(O){var U=O.type||"success";O=O.text||"";this._alert&&this._alert.destroy();var M=document.querySelector("arcgis-onboarding-whats-new");M&&M.parentElement.removeChild(M);this._alert=B.default.showAlert(U,O)};L.prototype.showError=function(O){this._showError(O)};L.prototype._addEventListeners=function(){var O=this;
this.own(t.default.subscribe("alert/show",this.showAlert.bind(this)),t.default.subscribe("tabs/disable",this._disableTabs.bind(this)),t.default.subscribe("tabs/enable",this._enableTabs.bind(this)),t.default.subscribe("page/showError",this._showError.bind(this)),t.default.subscribe("page/disableErrors",function(){O._hideErrors=!0}),t.default.subscribe("page/enableErrors",function(){O._hideErrors=!1}),(0,r.default)(window,"resize",(0,l.default)(function(){return t.default.publish("window/resize")},
300)))};L.prototype._buildPage=function(){var O=this,U;this.set("pageTitle",F.default.portalName||this.i18n.common.arcgis);var M=g.default.locale.split("-");document.documentElement.lang=-1!==g.default.locale.indexOf("-")?[M[0],M[1].toUpperCase()].join("-"):M[0];this.pageNode=this.pageNode||c.default.body();this.flexFix=u.default.create("div",{class:"flex-column"},this.pageNode,"next");this.contentWrapper=u.default.create("div",{class:"js-content-wrapper content-wrapper flex-column flex-1 hide"},
this.flexFix,"next");this.hideHeader||(this.header=new S.default({page:this,id:"header",esriPortalConfig:this.esriPortalConfig,relativePath:this.relativePath,telemetry:this.telemetry}),this.header.placeAt(this.contentWrapper,"first"),this.header.startup());u.default.place(this.domNode,this.contentWrapper);this.hideFooter||(this.footerDiv=u.default.create("div",null,this.contentWrapper,"last"),this.footer=(0,D.h)(T.default,{id:"footer",portal:this.portal}),(0,D.render)(this.footer,this.footerDiv));
this.skipToContent&&(M=q.default.substitute('\x3ca href\x3d"#${skipToContent}" class\x3d"skip-to-content js-skip-to-content"\x3e${i18n.common.skipToContent}\x3c/a\x3e',{skipToContent:this.skipToContent,i18n:y.default}),u.default.place(M,this.pageNode,"first"),document.querySelector(".js-skip-to-content").addEventListener("click",function(Q){Q.preventDefault();Q.stopPropagation();if(Q=document.getElementById(O.skipToContent))Q.tabIndex=-1,Q.focus()}));this.set("htmlCssClasses");(null===(U=this.portalUser)||
void 0===U?0:U.orgId)&&this.setBlockedClasses()};L.prototype.setBlockedClasses=function(){E.default.getBlockedApps().then(function(O){var U={webappbuilder:"wab-blocked",arcgisstorymaps:"storymap-blocked",opsdashboard:"dashboard-blocked",experienceBuilder:"exp-builder-blocked",HubforArcGIS:"hub-blocked",arcgisinstantapps:"instant-apps-blocked"};Object.keys(U).forEach(function(M){-1<(null===O||void 0===O?void 0:O.indexOf(M))&&(M=U[M],document.documentElement.classList.add(M),document.body.classList.add(M))})})};
L.prototype._setHtmlCssClassesAttr=function(){var O=[],U=this.portal,M=U.getPortalUser(),Q=M&&M.isOrgUser,Y=M&&M.licenses,fa;O.push(U.isPortal?"is-on-premise":"is-online");O.push(M?"is-signed-in":"is-signed-out");Object.keys(Y||{}).forEach(function(va){fa=Y[va];!fa.valid&&fa.className&&O.push(fa.className)});O.push(F.default.webAppBuilderEnabled&&Q?"is-wab-enabled":"");O.push(F.default.showCreateDashboard&&Q?"is-createDashboard-enabled":"");O.push(F.default.sceneViewerEnabled?"is-sceneViewer-enabled":
"");v.default.add(document.querySelector("html"),O.join(" "))};L.prototype._request=function(O,U){return A.default.request(O,U)};L.prototype._showError=function(O){var U=null;U=O&&O.message||this.i18n.common.errors.genericError.message;var M=document.querySelector(".js-alert")||u.default.toDom('\x3cdiv class\x3d"flex-center js-alert leader-2 trailer-2"\x3e\x3c/div\x3e'),Q=null;if(!(this._hideErrors||O&&("SB_0001"===O.messageCode||"SB_0002"===O.messageCode)||403!==O.code&&"GWM_0003"===O.messageCode)){if(!this._item&&
this.portalUser&&O&&403===O.code){if(-1!==O.message.indexOf("world/utilities.gpserver"))return;U=this.i18n.errorWidget.accessDeniedResource;this._showErrors=!0}else"GWM_0011"===(null===O||void 0===O?void 0:O.messageCode)?(U=-1<window.location.href.indexOf("/group.html")?this.i18n.common.errors.spamContentGroupUpdate:this.i18n.common.errors.spamContentItemUpdate,this._showErrors=!0):U&&"Item does not exist or is inaccessible."===U?(U=this.i18n.errorWidget.itemNotFound+" "+this.i18n.errorWidget.invalidItem,
this._showErrors=!0):U&&"User does not exist or is inaccessible."===U?(U=this.i18n.errorWidget.userNotFound+" "+this.i18n.errorWidget.invalidUser,this._showErrors=!0):U&&"Your request has timed out."===U?U=this.i18n.contentCategories.errors.timedOut:this.portal.isPortal&&O&&"string"===typeof O&&-1<O.indexOf("ERROR 002555")?(U=this.i18n.itemProperties.error.dataStoreReadOnlyMode,this._showErrors=!0):U&&-1<U.indexOf("Your account is out of storage space and your item cannot be updated.")?(U=this.i18n.common.errors.outOfStorageSpace,
this._showErrors=!0):U=O.messageHTML?O.messageHTML:A.default.htmlEncode(U);Q=u.default.toDom('\x3cdiv class\x3d"column-12 alert alert-red alert-inline break-word is-active"\x3e'+U+"\x3c/div\x3e");if(this._showErrors&&O&&499!==O.code&&498!==O.code&&404!==O.code)if(this._forceErrorToast||this.isLoaded&&!O.forceErrorNode)B.default.showAlert("error",U);else{(0,d.default)(".content-wrapper .loader, .js-page-loader").removeClass("is-active");(0,d.default)(".js-content-wrapper").removeClass("hide");U=document.querySelector(".view-background");
var Y=document.querySelectorAll("header.subnav").length?1:0;u.default.place(M,U,Y);u.default.place(Q,M,"only")}t.default.publish("ago/page/error",{error:O});return O}};L.prototype._createTab=function(O,U){var M=this.tabDijit=new O(b.default.mixin({page:this,i18n:this.i18n,portal:this.portal,portalUser:this.portalUser,telemetry:this.telemetry},U||{}),u.default.create("div",{},this._content)),Q=new m.default;M.startup().then(function(){a.default.init();window.setTimeout(function(){var Y;null===(Y=document.body.querySelectorAll(".accordion, .accordion-title"))||
void 0===Y?void 0:Y.forEach(function(fa){fa.removeAttribute("role")})},10);Q.resolve(M)});return Q};L.prototype._destroyTab=function(){var O=this,U=new m.default,M=this.tabDijit&&this.tabDijit.canDestroy?this.tabDijit.canDestroy():!0;(0,n.default)(M,function(){O.showLoader();(f.default.findWidgets(O._content)||[]).forEach(function(Q){Q.destroy?Q.destroy():Q.destroyRecursive&&Q.destroyRecursive()});u.default.empty(O._content);B.default.clearAlerts();U.resolve(!0)});return U};L.prototype._disableTabs=
function(){var O=this;this._clearTabHandlerOverrides();var U=document.querySelectorAll(".js-subnav-link");J.default.forEachNode(U,function(M){O._disabledTabHandlers.push((0,r.default)(M,"click",function(Q){Q.stopPropagation();Q.preventDefault()}));w.default.set(M,"aria-disabled",!0);v.default.add(M,"disabled")})};L.prototype._enableTabs=function(){var O=this;setTimeout(function(){O._clearTabHandlerOverrides();var U=document.querySelectorAll(".js-subnav-link");J.default.forEachNode(U,function(M){w.default.set(M,
"aria-disabled",!1);v.default.remove(M,"disabled")})},500)};L.prototype._clearTabHandlerOverrides=function(){this._disabledTabHandlers=this._disabledTabHandlers||[];this._disabledTabHandlers.forEach(function(O){return O.remove()})};L.prototype.getMemberDefaults=function(){var O,U=null===(O=this.portalUser)||void 0===O?void 0:O.userRole;O=(null===U||void 0===U?void 0:U.isAdmin())||(null===U||void 0===U?void 0:U.canManageSecurity());return this.portalUser&&this.portal.id&&O?this.portal.getMemberDefaults():
(O=new m.default,O.resolve(),O)};L.prototype.getHomePageConfig=function(){var O=new m.default;if(!this.portalUser||!this.portal.id)return O.resolve(),O;var U=P.default.hasModernHomePageEnabled(this.portal);(this.portal.hasModernHomePageEnabled=U)?this.portal.getHomePageConfig().then(function(){O.resolve()}):O.resolve();return O};return L=p.__decorate([(0,I.default)(h.default,x.default)],L)}()})},"arcgisonline/pages/components/SiteFooter":function(){define("require exports tslib ../../esriGeowConfig ../../pages/utils/organization ../utils/arrays dojo/topic preact preact/hooks dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);d=p.__importDefault(d);K.default=function(l){var h=l.id,f=l.portal;l=(0,c.useState)(!1);var r=l[0],q=l[1];l=(0,c.useState)([]);var t=l[0],w=l[1];(0,c.useEffect)(function(){var B=n.default.subscribe("contact-us-link/update",u);return function(){var J;null===(J=null===B||void 0===B?void 0:B.remove)||void 0===J?void 0:J.call(B)}},[]);
(0,c.useEffect)(function(){u()},[]);var u=function(){var B,J,P=p.__assign(p.__assign(p.__assign({},d.default.common),d.default.siteFooter),{helpLabel:d.default.supportPage.helpLabel}),R=f.portalUser,S=f.isPortal,T=window.location.href;-1<T.indexOf("?useExisting\x3d1")&&(T=T.substring(0,T.length-14));q(-1<T.indexOf("viewer.html")&&-1===T.indexOf("returnUrl")&&!g.default.isMobile());var E=[];(a.default.footerLinks||[]).forEach(function(I){var F,D,C="${i18n.legal}"===(null===I||void 0===I?void 0:I.title),
y=!!(C&&(null===R||void 0===R?0:R.accountId)),G="${i18n.help}"===(null===I||void 0===I?void 0:I.title)||"support.html"===(null===I||void 0===I?void 0:I.url),L=!(G&&!R&&"public"===f.access&&(S||!S&&f.customBaseUrl));C=!C&&!G||C&&!y||G&&!L;y=null===(F=I.title)||void 0===F?void 0:F.indexOf("${i18n.");F=null===(D=I.title)||void 0===D?void 0:D.indexOf("}");D=-1<y&&-1<F?"".concat(P[I.title.substring(y+7,F)]):I.title;if(I.url){-1===I.url.indexOf("http")&&-1===I.url.indexOf("mailto:")&&r&&(I.url="support.html"===
I.url?f.helpBase||"".concat(a.default.baseUrl).concat(I.url):"".concat(a.default.baseUrl).concat(I.url));if("${i18n.help}"===I.title||"support.html"===I.url)I.url=f.helpBase;C&&E.push({href:I.url,target:"_blank",title:D})}else S&&"contactUs"===I.type?(C=a.default.portalName||"ArcGIS.com",F=escape(T),I="mailto:".concat(I.email),I+='?subject\x3d"A comment about '.concat(C,'"'),I+='\x26body\x3d"I have the following comment about the '.concat(C," Web site. %0AReferring page: ").concat(F,' %0A %0A(Please provide as much detail as possible. Note: Contact Us is not meant for obtaining technical support or general product information.)"'),
E.push({id:"".concat(h,"_contactEsri"),href:I,title:D})):"reportAbuse"===I.type&&(F=escape(T),I="mailto:".concat(I.email,'?subject\x3d"Concerns about an item"'),I+='\x26body\x3d"I have concerns about the following. %0AReferring page: '.concat(F," %0A %0A(Please describe your concerns. If you have concerns about a particular item, it's best to click the 'Report Abuse' link while viewing the item description. Doing so will include the URL to the specific item in this e-mail.)\""),E.push({href:I,title:D}))});
v(null===(J=null===(B=f.portalProperties)||void 0===B?void 0:B.links)||void 0===J?void 0:J.contactUs,E)},v=function(B,J){J=null!==J&&void 0!==J?J:t;B=null!==B&&void 0!==B?B:{visible:!1,url:""};B={id:"".concat(h,"_customContactUs"),href:B.url,title:d.default.siteFooter.customContactUs,className:B.visible?"footer__contact-us":"footer__contact-us hide"};var P=m.default.findIndex(J,function(R){return R.id==="".concat(h,"_customContactUs")});-1<P?J[P]=B:(P=m.default.findIndex(J,function(R){return R.id===
"".concat(h,"_contactEsri")}),-1<P?J.splice(P,0,B):J.push(B));w(J)};l="".concat(h,"_links");var x=r?"\x26nbsp;. ":"",z=t.filter(function(B){return!B.className||-1===B.className.indexOf("hide")}),A=z.map(function(B,J){var P,R,S,T=null!==(P=B.id)&&void 0!==P?P:"".concat(h,"_link").concat(J);P=B.href;var E=null!==(R=B.target)&&void 0!==R?R:"";R=null!==(S=B.className)&&void 0!==S?S:"";J=J===z.length-1;return(0,b.h)(b.Fragment,null,(0,b.h)("a",{id:T,href:P,className:R,target:E},B.title),J?null:(0,b.h)("span",
null,x))});return(0,b.h)("div",{class:"padding-leader-2 footer text-center padding-trailer-1 font-size--2 text-light-gray",role:"contentinfo"},(0,b.h)("span",{id:l,class:"esriItemLinks"},A),(0,b.h)("div",{class:"esri-footer-barrier"}))}})},"arcgisonline/pages/utils/layer":function(){define(["require","exports","tslib","./icons","dojo/i18n!../../nls/arcgisonline"],function(e,K,p,a,g){function m(c,d){var l,h,f;if(!c)return!1;var r=null===(l=c.subtypes)||void 0===l?void 0:l.length;d=null===(f=null===
(h=null===d||void 0===d?void 0:d.itemData)||void 0===h?void 0:h.layers)||void 0===f?void 0:f.find(function(q){return q.id===c.id});return r&&"SubtypeGroupLayer"===(null===d||void 0===d?void 0:d.layerType)}function n(c){var d,l;return!(null===(l=null===(d=null===c||void 0===c?void 0:c.itemData)||void 0===d?void 0:d.layers)||void 0===l||!l.every(function(h){return"SubtypeGroupLayer"===h.layerType}))}Object.defineProperty(K,"__esModule",{value:!0});K.getLayerGeometryInfo=K.containsBothSublayerGroupTypeAndNon=
K.containsOnlySubtypeGroupLayers=K.isSubtypeGroupLayer=void 0;a=p.__importDefault(a);g=p.__importDefault(g);var b={esriGeometryPoint:a.default.inline.point["16"],esriGeometryPolygon:a.default.inline.polygon["16"],esriGeometryPolyline:a.default.inline.line["16"],esriGeometryMultipoint:a.default.inline["layer-points"]["16"],esriGeometryMultiPatch:a.default.inline.cube["16"]};K.isSubtypeGroupLayer=m;K.containsOnlySubtypeGroupLayers=n;K.containsBothSublayerGroupTypeAndNon=function(c){var d,l;return!n(c)&&
!(null===(l=null===(d=null===c||void 0===c?void 0:c.itemData)||void 0===d?void 0:d.layers)||void 0===l||!l.some(function(h){return"SubtypeGroupLayer"===h.layerType}))};K.getLayerGeometryInfo=function(c,d){var l=c.geometryType,h=l&&g.default.sublayer.geometryTypes[l]||g.default.sublayer.layer;return"Catalog Layer"===c.type?{geometryType:g.default.sublayer.catalogLayer,geometryIcon:a.default.inline.layer["16"]}:"Table"===c.type?{geometryType:g.default.sublayer.table,geometryIcon:a.default.inline.table["16"]}:
m(c,d)?{geometryType:h,geometryIcon:a.default.inline.layers["16"]}:{geometryIcon:l&&b[l]||a.default.inline.layer["16"],geometryType:h}}})},"arcgisonline/pages/item/widgets/_datasets":function(){define("require exports tslib dojo/Deferred arcgisonline/tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase preact arcgisonline/pages/item/components/bigdatafileshare/Datasets".split(" "),function(e,K,p,a,g,m,n,b,c){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);g=p.__importDefault(g);
m=p.__importDefault(m);n=p.__importDefault(n);c=p.__importDefault(c);e=function(){function d(){this.templateString='\x3cdiv class\x3d"datasetsWrapper"\x3e\x3cdiv id\x3d"datasetsTab"\x3e\x3c/div\x3e\x3cdiv\x3e'}d.prototype.startup=function(){this.inherited(arguments);var l=new a.default;l.resolve(!0);return l};d.prototype.destroy=function(){this.inherited(arguments)};d.prototype.postCreate=function(){(0,b.render)((0,b.h)(c.default,{url:this.item.url,isOwner:this.item.isOwner}),this.domNode.querySelector("#datasetsTab"))};
return d=p.__decorate([(0,g.default)(n.default,m.default)],d)}();K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/Datasets":function(){define("require exports tslib preact arcgisonline/sharing/util arcgisonline/pages/utils/arrays arcgisonline/pages/utils/clone ./DataSyncing ./DataFiltering ./DatasetsHeader ./DatasetsTable ./DatasetsPagination ./PropertyEditing ./AdvancedSettings ./NotificationModal dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),function(e,K,p,a,g,m,n,b,c,d,
l,h,f,r,q,t){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);e=function(w){function u(){var v=null!==w&&w.apply(this,arguments)||this;v.state={isSyncDisabled:!1,dataFilterText:"",datasetsStatus:"downloading",datasetsSource:[],
datasetsForRendering:[],dataSortOrder:"ascend",selectedDataItemIDMap:{},matchedDataItemNum:0,shouldDisplayDeleteIcon:!1,isDeletingDataset:!1,counts:{start:0,num:0,total:0},itemPerPage:20,shouldDisplayPagination:!1,shouldDisplayAdvancedSetting:!1,datasetsManifestStatus:"downloading",datasetsManifest:[],isManifestActive:!1,activeManifestName:"",isSidebarDisabled:!0,isNotificationModalActive:!1,alertIndicator:{alertIndicatorActive:!1,alertIndicatorColor:"",alertIndicatorInfo:""}};v.datasetsRequestURL=
"";v.manifestRequestURL="";v.manifestAdminURL="";v.hintsAdminURL="";v.manifestRegenerateURL="";v.portalURL="";v.adminURL="";v.globalDataFilterText="";v.filterTextLength=0;return v}p.__extends(u,w);u.prototype.componentDidMount=function(){this.generateURLs();this.requestDatasets();this.requestDatasetsManifest()};u.prototype.generateURLs=function(){var v=this.props.url.split("/"),x="".concat(v[0],"//").concat(v[2],"/").concat(v[3]),z=v.filter(function(A){return"bigDataFileShares"===A.substring(0,17)})[0];
v=z.split("_")[0];z=z.split("_").slice(1).join("_");v="".concat(v,"/").concat(z);this.adminURL="".concat(x,"/admin/data/items/").concat(v);this.datasetsRequestURL=this.props.url;this.manifestRequestURL="".concat(this.props.url,"/manifest");this.manifestAdminURL="".concat(this.adminURL,"/manifest");this.hintsAdminURL="".concat(this.adminURL,"/hints");this.manifestRegenerateURL="".concat(this.manifestAdminURL,"/regenerate");x=this.adminURL.split("/");this.portalURL="".concat(x[0],"//").concat(x[2],
":6443/arcgis/admin/data/items/").concat(v)};u.prototype.regenerateManifestFromServer=function(){var v=this;g.default.request({url:this.adminURL},{useProxy:g.default.shouldUseProxy(this.adminURL)}).then(function(x){x?v.regenerateDatastoreFromServer(JSON.stringify(x)):v.regenerateManifestFromPortal()},function(x){v.regenerateManifestFromPortal()})};u.prototype.regenerateManifestFromPortal=function(){var v=this;g.default.request({url:this.portalURL},{useProxy:g.default.shouldUseProxy(this.portalURL)}).then(function(x){x?
v.regenerateDatastoreFromPortal(JSON.stringify(x)):v.syncupErrorHandler()},function(x){v.syncupErrorHandler()})};u.prototype.regenerateDatastoreFromServer=function(v){var x=this;g.default.request({url:this.manifestRegenerateURL,content:{item:v}},{useProxy:g.default.shouldUseProxy(this.manifestRegenerateURL),usePost:!0}).then(function(z){"success"===(null===z||void 0===z?void 0:z.status)?x.syncupSuccessHandler():x.syncupErrorHandler()},function(z){x.syncupErrorHandler()})};u.prototype.regenerateDatastoreFromPortal=
function(v){var x=this;g.default.request({url:this.portalURL+"/manifest/regenerate",content:{item:v}},{useProxy:g.default.shouldUseProxy(this.portalURL+"/manifest/regenerate"),usePost:!0}).then(function(z){"success"===(null===z||void 0===z?void 0:z.status)?x.syncupSuccessHandler():x.syncupErrorHandler()},function(z){x.syncupErrorHandler()})};u.prototype.syncupSuccessHandler=function(){var v=this;this.displayNotificationIndicator(!0,"success",t.default.itemProperties.notificationIndicator.alertIndicatorInfo.datasetSyncUp.success);
var x=(new Date).getTime(),z=setInterval(function(){3E4<(new Date).getTime()-x?clearInterval(z):(v.requestDatasets(),v.requestDatasetsManifest())},5E3)};u.prototype.syncupErrorHandler=function(){this.displayNotificationIndicator(!0,"danger",t.default.itemProperties.notificationIndicator.alertIndicatorInfo.datasetSyncUp.failure);this.requestDatasets();this.requestDatasetsManifest()};u.prototype.requestDatasets=function(){var v=this,x=this.datasetsRequestURL;g.default.request({url:x},{useProxy:g.default.shouldUseProxy(x)}).then(function(z){z=
null===z||void 0===z?void 0:z.children;z.forEach(function(A){A.isItemFiltered=!0});v.setState({datasetsStatus:"success",datasetsSource:(0,n.default)(z),datasetsForRendering:(0,n.default)(z),shouldDisplayPagination:!0,counts:{start:1,num:v.state.itemPerPage,total:z.length},isSyncDisabled:!1})},function(z){v.setState({datasetsStatus:"fail",shouldDisplayPagination:!1,counts:{start:0,num:0,total:0},isSyncDisabled:!1})})};u.prototype.requestDatasetsManifest=function(){var v=this,x=this.manifestRequestURL;
g.default.request({url:x},{useProxy:g.default.shouldUseProxy(x)}).then(function(z){v.setState({datasetsManifestStatus:"success",datasetsManifest:(0,n.default)(z.datasets),isSidebarDisabled:!1})},function(z){v.setState({datasetsManifestStatus:"fail",isSidebarDisabled:!0})})};u.prototype.syncDatasets=function(v){this.setState({selectedDataItemIDMap:{},shouldDisplayDeleteIcon:!1,dataFilterText:"",isSyncDisabled:v,datasetsStatus:"downloading",datasetsManifestStatus:"downloading",dataSortOrder:"ascend",
shouldDisplayPagination:!1,counts:{start:0,num:0,total:0},itemPerPage:20,shouldDisplayAdvancedSetting:!1});this.regenerateManifestFromServer()};u.prototype.openEditingModal=function(v){this.setState({isManifestActive:!0,activeManifestName:v})};u.prototype.selectDataItem=function(v){var x=(0,n.default)(this.state.selectedDataItemIDMap),z=!1;x[v]?(delete x[v],this.state.datasetsForRendering.forEach(function(A){A.isItemFiltered&&m.default.includes(Object.keys(x),A.name)&&(z=!0)})):(x[v]=v,z=!0);this.setState({selectedDataItemIDMap:x,
shouldDisplayDeleteIcon:z})};u.prototype.flipSortOrder=function(v){this.setState({dataSortOrder:"ascend"===v?"descend":"ascend"})};u.prototype.deleteEmptyGeometryZField=function(v){v.forEach(function(x){var z,A,B;""===(null===(B=null===(A=null===(z=null===x||void 0===x?void 0:x.geometry)||void 0===z?void 0:z.fields)||void 0===A?void 0:A[2])||void 0===B?void 0:B.name)&&x.geometry.fields.pop()});return v};u.prototype.deleteDatasetItemFromServer=function(v){var x=this;this.setState({isDeletingDataset:v});
var z=(0,n.default)(this.state.selectedDataItemIDMap),A=(0,n.default)(this.state.datasetsManifest);A=A.filter(function(T){return!z[T.name]});v="".concat(this.manifestAdminURL,"/update");var B={};B.datasets=this.deleteEmptyGeometryZField(A);g.default.request({url:v,content:{fileData:JSON.stringify(B)}},{useProxy:g.default.shouldUseProxy(v),usePost:!0}).then(function(T){"success"===T.status?P():J(B)},function(T){J(B)});var J=function(T){var E="".concat(x.portalURL,"/manifest/update");g.default.request({url:E,
content:{fileData:JSON.stringify(T)}},{useProxy:g.default.shouldUseProxy(E),usePost:!0}).then(function(I){"success"===I.status?P():R()},function(I){R()})},P=function(){x.displayNotificationIndicator(!0,"success",t.default.itemProperties.notificationIndicator.alertIndicatorInfo.manifestDelete.success);S()},R=function(){x.displayNotificationIndicator(!0,"danger",t.default.itemProperties.notificationIndicator.alertIndicatorInfo.manifestDelete.failure);x.setState({datasetsManifest:x.state.datasetsManifest,
isDeletingDataset:!1})},S=function(){var T=(0,n.default)(x.state.datasetsForRendering),E=x.state.matchedDataItemNum;if(2<x.filterTextLength){T=T.filter(function(y){return y.isItemFiltered&&z[y.name]?(E--,delete z[y.name],!1):!0});var I=E;var F="success"}else F=T.length-Object.keys(z).length,T=T.filter(function(y){return z[y.name]?(delete z[y.name],!1):!0}),I=F,F=0===I?"deleted":x.state.datasetsStatus;var D=0===I?0:x.state.counts.num,C=x.recalculatePagination(I,D);x.setState({datasetsManifest:A,datasetsForRendering:T,
datasetsStatus:F,counts:{start:C.start,num:D,total:I},matchedDataItemNum:E,selectedDataItemIDMap:z,shouldDisplayPagination:C.shouldDisplayPagination,shouldDisplayDeleteIcon:!1,isDeletingDataset:!1})}};u.prototype.onFilterChanged=function(v){var x=this,z=v.trim();this.filterTextLength=z.length;2>=this.filterTextLength&&(z="");if(z!==this.globalDataFilterText){this.globalDataFilterText=z;z=(0,n.default)(this.state.datasetsForRendering);var A=this.filterDataSource(z);z=A.datasetsForRendering;A=A.filteredDatasets.length;
var B=0===A?0:this.state.itemPerPage;var J=this.recalculatePagination(A,B),P=J.shouldDisplayPagination;J={start:J.start,num:B,total:A};this.globalDataFilterText?(z=this.processFilteredResults(z),B="success"):(B=0===A?"deleted":this.state.datasetsStatus,J.total=A);var R=!1;z.forEach(function(S){S.isItemFiltered&&m.default.includes(Object.keys(x.state.selectedDataItemIDMap),S.name)&&(R=!0)});this.setState({counts:J,dataFilterText:v,datasetsStatus:B,datasetsForRendering:z,matchedDataItemNum:A,shouldDisplayPagination:P,
shouldDisplayDeleteIcon:R})}else this.setState({dataFilterText:v})};u.prototype.filterDataSource=function(v){var x=this,z=v.filter(function(A){return x.doesFilterMatch(A)});return{datasetsForRendering:v,filteredDatasets:z}};u.prototype.doesFilterMatch=function(v){if(this.globalDataFilterText){var x=this.globalDataFilterText.split(" ");v.isItemFiltered=x.some(function(z){return-1<v.name.toLowerCase().indexOf(z.toLocaleLowerCase())})}else v.isItemFiltered=!0;return v.isItemFiltered};u.prototype.processFilteredResults=
function(v){var x=[],z=0,A=v.length-1;v.forEach(function(B){B.isItemFiltered?(x[z]=B,z++):(x[A]=B,A--)});return x};u.prototype.changePage=function(v){this.setState({counts:v})};u.prototype.setItemPerPage=function(v){var x=this.state.counts.total;v=0===x?0:Number(v);x={start:this.recalculatePagination(x,v).start,num:v,total:x};this.setState({itemPerPage:v,counts:x})};u.prototype.recalculatePagination=function(v,x){if(0===v)return{start:0,shouldDisplayPagination:!1};var z=Math.ceil(this.state.counts.start/
this.state.counts.num);return{start:Math.ceil(v/x)>=z?(z-1)*x+1:1,shouldDisplayPagination:!0}};u.prototype.onToggleAdvancedSetting=function(v){this.setState({shouldDisplayAdvancedSetting:v})};u.prototype.viewManifest=function(){var v=this.deleteEmptyGeometryZField((0,n.default)(this.state.datasetsManifest));return JSON.stringify(v,null,2)};u.prototype.closeEditingModal=function(v){this.setState({isManifestActive:v})};u.prototype.updateManifest=function(v){this.setState({datasetsManifest:v})};u.prototype.displayNotificationIndicator=
function(v,x,z){this.setState({isNotificationModalActive:!0,alertIndicator:{alertIndicatorActive:v,alertIndicatorColor:x,alertIndicatorInfo:z}})};u.prototype.closeNotificationIndicator=function(v){this.setState({isNotificationModalActive:v})};u.prototype.render=function(){var v=this.state,x=v.isSyncDisabled,z=v.datasetsStatus,A=v.datasetsForRendering,B=v.dataFilterText,J=v.shouldDisplayDeleteIcon,P=v.isDeletingDataset,R=v.dataSortOrder,S=v.counts,T=v.selectedDataItemIDMap,E=v.shouldDisplayPagination,
I=v.itemPerPage,F=v.activeManifestName,D=v.isSidebarDisabled,C=v.datasetsManifestStatus,y=v.datasetsManifest,G=v.shouldDisplayAdvancedSetting;v=v.alertIndicator;var L=this.props.isOwner;return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"datasetsHeader"},(0,a.h)("div",{class:"grid-container"},(0,a.h)("div",{class:"column-24 flex"},L&&(0,a.h)(b.default,{entryComponent:"datasets",isSyncDisabled:x,syncDatasets:this.syncDatasets.bind(this)}),(0,a.h)(c.default,{page:"datasets",datasetsStatus:z,datasetsForRendering:A,
dataFilterText:B,onFilterChanged:this.onFilterChanged.bind(this)})))),(0,a.h)("div",{class:"grid-container"},(0,a.h)(d.default,{isOwner:L,shouldDisplayDeleteIcon:J,isDeletingDataset:P,counts:S,deleteDatasetItem:this.deleteDatasetItemFromServer.bind(this)}),(0,a.h)(l.default,{datasetsStatus:z,datasetsForRendering:A,datasetsManifest:y,dataSortOrder:R,counts:S,selectedDataItemIDMap:T,openEditingModal:this.openEditingModal.bind(this),selectDataItem:this.selectDataItem.bind(this),flipSortOrder:this.flipSortOrder.bind(this)})),
(0,a.h)(h.default,{shouldDisplayPagination:E,counts:S,itemPerPage:I,changePage:this.changePage.bind(this),setItemPerPage:this.setItemPerPage.bind(this)}),this.state.isManifestActive&&(0,a.h)(f.default,{isOwner:L,activeManifestName:F,isSidebarDisabled:D,datasetsManifestStatus:C,datasetsManifest:y,manifestAdminURL:this.manifestAdminURL,portalURL:this.portalURL,displayNotificationIndicator:this.displayNotificationIndicator.bind(this),closeEditingModal:this.closeEditingModal.bind(this),updateManifest:this.updateManifest.bind(this)}),
L&&(0,a.h)(r.default,{displayNotificationIndicator:this.displayNotificationIndicator.bind(this),portalURL:this.portalURL,manifestAdminURL:this.manifestAdminURL,hintsAdminURL:this.hintsAdminURL,shouldDisplayAdvancedSetting:G,viewManifest:this.viewManifest.bind(this),onToggleAdvancedSetting:this.onToggleAdvancedSetting.bind(this)}),this.state.isNotificationModalActive&&(0,a.h)(q.default,{alertIndicator:v,closeNotificationIndicator:this.closeNotificationIndicator.bind(this)}))};return u}(a.Component);
K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/DataSyncing":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);e=function(m){function n(){return null!==m&&m.apply(this,arguments)||this}p.__extends(n,m);n.prototype.syncDatasets=function(){this.props.syncDatasets(!0)};n.prototype.render=function(){var b=this.props,c=b.isSyncDisabled;b=b.entryComponent;
return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"sync-button flex flex-center"},(0,a.h)("div",{class:"full-width"},(0,a.h)("div",{class:"trailer-quarter leader-quarter margin-right-half margin-left-0 flex-1"},(0,a.h)("button",{class:"btn btn-clear btn-fill",disabled:c,onClick:this.syncDatasets.bind(this)},c?"datasets"===b?g.default.itemProperties.datasetsSync.syncing:g.default.itemProperties.datasetsSync.adding:"datasets"===b?g.default.itemProperties.datasetsSync.sync:g.default.itemProperties.datasetsSync.addOutputsTemplate)))))};
return n}(a.Component);K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/DataFiltering":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);e=function(m){function n(){return null!==m&&m.apply(this,arguments)||this}p.__extends(n,m);n.prototype.onFilterChanged=function(b){b=b.target.value.toLowerCase();this.props.onFilterChanged(b)};n.prototype.render=
function(){var b=this.props,c=b.page;b=b.dataFilterText;return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"filtering-section flex"},(0,a.h)("span",{class:"filtering-section-icon"},(0,a.h)("svg",{viewBox:"0 0 24 24",width:"24",height:"24",class:"icon-inline"},(0,a.h)("path",{d:"M22.289 20.91l-6.847-6.846a7.524 7.524 0 1 0-1.419 1.409l6.852 6.852zM4 9.5A5.5 5.5 0 1 1 9.5 15 5.506 5.506 0 0 1 4 9.5z"}))),(0,a.h)("div",{class:"full-width position-relative"},(0,a.h)("input",{type:"search",placeholder:"datasets"===
c?g.default.itemProperties.datasetsFiltering.searchDatasets:g.default.itemProperties.datasetsFiltering.searchOutputTemplates,class:"filtering-section-input",onInput:this.onFilterChanged.bind(this),value:b}))))};return n}(a.Component);K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/DatasetsHeader":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/pages/pageUtil".split(" "),function(e,K,p,a,g,m){Object.defineProperty(K,"__esModule",
{value:!0});g=p.__importDefault(g);m=p.__importDefault(m);e=function(n){function b(){return null!==n&&n.apply(this,arguments)||this}p.__extends(b,n);b.prototype.deleteDatasetItem=function(){this.props.deleteDatasetItem(!0)};b.prototype.displayPageInfo=function(){return m.default.getPageRangeString({start:0===this.props.counts.total?0:this.props.counts.start,end:0===this.props.counts.total?0:this.props.counts.start-1+this.props.counts.num>=this.props.counts.total?this.props.counts.total:this.props.counts.start-
1+this.props.counts.num,total:this.props.counts.total})};b.prototype.render=function(){var c=this.props,d=c.isOwner,l=c.shouldDisplayDeleteIcon,h=(c=c.isDeletingDataset)?" dataset-deleting":"";return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"column-24 clearfix padding-leader-1 padding-trailer-quarter flex"},(0,a.h)("div",{class:"font-size--1 inline-block flex-1 flex flex-align-center filter-status-wrap"},(0,a.h)("span",{class:"padding-right-1 padding-left-0 padding-leader-quarter padding-trailer-quarter font-size--2 flex-0 break-word border-box"},
this.displayPageInfo()),d&&l&&(0,a.h)("div",{class:"datasets-delete-icon".concat(h),onClick:this.deleteDatasetItem.bind(this)},(0,a.h)("span",null,c?(0,a.h)(a.Fragment,null,(0,a.h)("calcite-loader",{class:"margin-right-quarter",label:"deletingDataset",scale:"m",inline:!0,hidden:!c}),(0,a.h)("calcite-icon",{class:"icon-ui-trash",scale:"s"}),g.default.itemProperties.datasetsDelete.deleting):(0,a.h)(a.Fragment,null,(0,a.h)("calcite-icon",{class:"icon-ui-trash",scale:"s"}),g.default.itemProperties.datasetsDelete.delete))))))};
return b}(a.Component);K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/DatasetsTable":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);e=function(m){function n(){return null!==m&&m.apply(this,arguments)||this}p.__extends(n,m);n.prototype.sortDatasetByName=function(b){var c=this;b.sort(function(d,l){if(d.isItemFiltered&&l.isItemFiltered)return d.name.toLowerCase()>
l.name.toLowerCase()?"ascend"===c.props.dataSortOrder?1:-1:d.name.toLowerCase()<l.name.toLowerCase()?"ascend"===c.props.dataSortOrder?-1:1:0});return b};n.prototype.processDatasets=function(b){var c=this;return b.map(function(d,l){d.isItemOnCurrentPage=l>=c.props.counts.start-1&&l<c.props.counts.start+c.props.counts.num-1?!0:!1;return d})};n.prototype.configureDatasetIcon=function(b){var c="",d="",l="",h="";this.props.datasetsManifest.forEach(function(f){var r,q,t,w,u;f.name===b.name&&("esriGeometryPoint"===
(null===(r=null===f||void 0===f?void 0:f.geometry)||void 0===r?void 0:r.geometryType)?(c="pin",d="Points"):"esriGeometryPolygon"===(null===(q=null===f||void 0===f?void 0:f.geometry)||void 0===q?void 0:q.geometryType)?(c="polygon",d="Areas"):"esriGeometryPolyline"===(null===(t=null===f||void 0===f?void 0:f.geometry)||void 0===t?void 0:t.geometryType)?(c="line",d="Lines"):"None"===(null===(w=null===f||void 0===f?void 0:f.geometry)||void 0===w?void 0:w.geometryType)?(c="table",d="Table"):"table"===(null===
b||void 0===b?void 0:b.type)&&(c="table",d="Table"),l=(f=null===(u=null===f||void 0===f?void 0:f.time)||void 0===u?void 0:u.timeType)||"icon-grey-out-color-class",h=f?"Time Enabled: ".concat(f):"No Time Enabled")});return{geometryIconName:c,geometryIconTitle:d,timeIconClass:l,timeIconTitle:h}};n.prototype.createDatasetsTSX=function(b,c){var d=this;b=this.sortDatasetByName(b);b=this.processDatasets(b).map(function(q){var t=q.isItemFiltered&&q.isItemOnCurrentPage?"":" hide",w=!!d.props.selectedDataItemIDMap[q.name],
u=d.configureDatasetIcon(q),v=u.geometryIconName,x=u.geometryIconTitle,z=u.timeIconClass;u=u.timeIconTitle;return(0,a.h)("div",{key:q.name,class:"datasets-table-row".concat(t),role:"row"},(0,a.h)("label",{class:"datasets-table-cell datasets-table-checkbox",role:"cell"},(0,a.h)("input",{type:"checkbox",checked:w,"aria-label":"Select Item",onChange:d.selectDataItem.bind(d,q.name)})),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-medium",role:"cell"},v&&(0,a.h)("calcite-icon",{icon:v,
class:"dataset-icon",scale:"s",title:x}),(0,a.h)("calcite-icon",{icon:"clock",class:"dataset-icon ".concat(z),scale:"s",title:u}),(0,a.h)("span",{class:"datasets-table-cell-name"},q.name)),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-medium datasets-table-edit",onClick:d.openEditingModal.bind(d,q.name),role:"cell"},(0,a.h)("calcite-icon",{class:"icon-ui-edit"}),(0,a.h)("span",null,g.default.itemProperties.datasetsTable.edit)))});var l="ascend"===this.props.dataSortOrder?["0 6px 8px 6px",
"transparent transparent #007ac2 transparent","0.5em","0.75em"]:["8px 6px 0 6px","#007ac2 transparent transparent transparent","0.5em","1em"],h=l[0],f=l[1],r=l[2];l=l[3];b=(0,a.h)("div",{key:"datasetkey",class:"datasets-table"},(0,a.h)("div",{class:"datasets-table-head",role:"rowgroup"},(0,a.h)("div",{class:"datasets-table-row datasets-table-row-header",role:"row"},(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-th datasets-table-cell-extra-small",role:"columnheader"},(0,a.h)("div",
{class:"datasets-table-cell-sort"})),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",role:"columnheader",onClick:this.flipSortOrder.bind(this)},(0,a.h)("div",{class:"datasets-table-cell-sort datasets-table-header"},g.default.itemProperties.datasetsTable.dataset),(0,a.h)("div",{style:{content:"",width:0,height:0,position:"absolute","border-style":"solid","border-width":h,"border-color":f,right:r,top:l}})),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",
role:"columnheader"},(0,a.h)("div",{class:"datasets-table-cell-sort"},g.default.itemProperties.datasetsTable.operation)))),(0,a.h)("div",{class:"datasets-table-rows",role:"rowgroup"},b));h="";"downloading"===c?h=g.default.itemProperties.datasetsTable.datasetsStatusMessage.downloading:"fail"===c?h=g.default.itemProperties.datasetsTable.datasetsStatusMessage.fail:"success"===c?0===this.props.counts.total&&(b=(0,a.h)("div",{class:"text-center leader-1 text-constrain margin-auto"},g.default.itemProperties.datasetsTable.datasetsStatusMessage.success)):
"deleted"===c&&(b=(0,a.h)("div",{class:"text-center leader-1 text-constrain margin-auto"},g.default.itemProperties.datasetsTable.datasetsStatusMessage.deleted));""!==h&&(b=(0,a.h)("div",{class:"padding-leader-half"},(0,a.h)("em",null,h)));return b};n.prototype.flipSortOrder=function(){this.props.flipSortOrder(this.props.dataSortOrder)};n.prototype.selectDataItem=function(b){this.props.selectDataItem(b)};n.prototype.openEditingModal=function(b){this.props.openEditingModal(b)};n.prototype.render=function(){var b=
this.props;b=this.createDatasetsTSX(b.datasetsForRendering,b.datasetsStatus);return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"column-24 padding-leader-half padding-trailer-5 datasets-table-wrapper"},b))};return n}(a.Component);K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/DatasetsPagination":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);
e=function(m){function n(){return null!==m&&m.apply(this,arguments)||this}p.__extends(n,m);n.prototype.changePage=function(b){b=b.target;this.props.changePage({start:b.startItem,num:b.pageSize,total:b.totalItems})};n.prototype.setItemPerPage=function(b){this.props.setItemPerPage(b.target.value)};n.prototype.render=function(){var b=this.props,c=b.counts,d=b.itemPerPage;return(0,a.h)(a.Fragment,null,b.shouldDisplayPagination&&(0,a.h)("div",{class:"grid-container"},(0,a.h)("div",{class:"flex text-center trailer-half padding-leader-half"},
(0,a.h)("div",{class:"pagination-space-wrapper"},(0,a.h)("calcite-pagination",{class:"datasetsPagination",startItem:c.start,pageSize:c.num,totalItems:c.total,oncalcitePaginationChange:this.changePage.bind(this)})),(0,a.h)("div",{class:"itemPerPage flex"},(0,a.h)("div",{class:"padding-leader-quarter padding-right-half text-right pagination-space-wrapper"},g.default.itemProperties.pagination.itemPerPage),(0,a.h)("div",{class:"pagination-space-wrapper"},(0,a.h)("select",{class:"inline-block select-full",
value:d,onChange:this.setItemPerPage.bind(this)},(0,a.h)("option",{value:"20"},"20"),(0,a.h)("option",{value:"60"},"60"),(0,a.h)("option",{value:"100"},"100")))))))};return n}(a.Component);K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/PropertyEditing":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/pages/components/BodyAppender arcgisonline/sharing/util ../../../utils/arrays arcgisonline/pages/utils/clone ../../../../esriGeowConfig".split(" "),
function(e,K,p,a,g,m,n,b,c,d){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);e=function(l){function h(){var f=null!==l&&l.apply(this,arguments)||this;f.state={datasetsManifest:[],datasetsManifestStatus:"downloading",activeManifestIndex:0,modalActive:!1,isSidebarDisabled:!0,sidebarMenu:[{label:g.default.itemProperties.datasetsManifest.sidebarMenu.fields,value:"Fields"},
{label:g.default.itemProperties.datasetsManifest.sidebarMenu.geometry,value:"Geometry"},{label:g.default.itemProperties.datasetsManifest.sidebarMenu.time,value:"Time"},{label:g.default.itemProperties.datasetsManifest.sidebarMenu.file,value:"File"}],activeMenuItem:"Fields",isModalButtonDisabled:!1,progressIndicatorActive:!1,isReadOnly:!f.props.isOwner,isGeometryErrorActive:!1,isTimeErrorActive:!1,validationErrorType:"",timeTypeChanged:!1};f.originalDatasetsManifest=[];f.geometryFieldsListLength=0;
f.hasGeometryValidationError=!1;f.hasTimeValidationError=!1;f.dataItemFields=[];f.availableTimeZones=[{canonicalID:"Etc/GMT+12"},{canonicalID:"Etc/GMT+11"},{canonicalID:"Etc/GMT+10"},{canonicalID:"Pacific/Marquesas"},{canonicalID:"Etc/GMT+9"},{canonicalID:"Etc/GMT+8"},{canonicalID:"Etc/GMT+7"},{canonicalID:"Etc/GMT+6"},{canonicalID:"Etc/GMT+5"},{canonicalID:"Etc/GMT+4"},{canonicalID:"America/St_Johns"},{canonicalID:"Etc/GMT+3"},{canonicalID:"Etc/GMT+2"},{canonicalID:"Etc/GMT+1"},{canonicalID:"Etc/GMT"},
{canonicalID:"UTC"},{canonicalID:"Etc/GMT-1"},{canonicalID:"Etc/GMT-2"},{canonicalID:"Etc/GMT-3"},{canonicalID:"Asia/Tehran"},{canonicalID:"Etc/GMT-4"},{canonicalID:"Asia/Kabul"},{canonicalID:"Etc/GMT-5"},{canonicalID:"Asia/Colombo"},{canonicalID:"Asia/Kathmandu"},{canonicalID:"Etc/GMT-6"},{canonicalID:"Asia/Yangon"},{canonicalID:"Etc/GMT-7"},{canonicalID:"Etc/GMT-8"},{canonicalID:"Australia/Eucla"},{canonicalID:"Etc/GMT-9"},{canonicalID:"Australia/Adelaide"},{canonicalID:"Etc/GMT-10"},{canonicalID:"Australia/Lord_Howe"},
{canonicalID:"Etc/GMT-11"},{canonicalID:"Etc/GMT-12"},{canonicalID:"Pacific/Chatham"},{canonicalID:"Etc/GMT-13"},{canonicalID:"Etc/GMT-14"},{canonicalID:"custom"}];return f}p.__extends(h,l);h.prototype.componentDidMount=function(){this.originalDatasetsManifest=(0,c.default)(this.props.datasetsManifest);this.setState({isSidebarDisabled:this.props.isSidebarDisabled,datasetsManifestStatus:this.props.datasetsManifestStatus,datasetsManifest:this.props.datasetsManifest});this.openEditingModal(this.props.activeManifestName)};
h.prototype.convertFromEsriGeometryType=function(f){return"esriGeometryPoint"===f?"Point":"esriGeometryPolyline"===f?"Polyline":"esriGeometryPolygon"===f?"Polygon":"None"};h.prototype.convertToEsriGeometryType=function(f){return"Point"===f?"esriGeometryPoint":"Polyline"===f?"esriGeometryPolyline":"Polygon"===f?"esriGeometryPolygon":"None"};h.prototype.retrieveDatasetProperty=function(f,r,q){var t;if(r[f]){q=r[f];f=q.format;r=q.geometry;var w=q.schema;q=q.time;var u=w.fields;this.dataItemFields=w.fields;
w=(null===r||void 0===r?0:r.geometryType)?this.convertFromEsriGeometryType(r.geometryType):"None";var v=this.initializeTimeProperty(q),x=v.timeInstantArr,z=v.timeIntervalStartArr,A=v.timeIntervalEndArr,B=v.timeZone,J=v.customTimeZone;v=v.timeType;"\t"===(null===f||void 0===f?void 0:f.fieldDelimiter)&&(f.fieldDelimiter=this.handleEscapeChars(f.fieldDelimiter));1===(null===(t=null===f||void 0===f?void 0:f.recordTerminator)||void 0===t?void 0:t.length)&&(f.recordTerminator=this.handleEscapeChars(f.recordTerminator));
return{dataItemFields:u,geometry:r,geometryType:w,dataItemTime:q,timeInstantArr:x,timeIntervalStartArr:z,timeIntervalEndArr:A,timeZone:B,customTimeZone:J,timeType:v,fileFormat:f}}u=[];this.dataItemFields=[];r={};q={};x=[];z=[];A=[];f={};return{dataItemFields:u,geometry:r,geometryType:"Point",dataItemTime:q,timeInstantArr:x,timeIntervalStartArr:z,timeIntervalEndArr:A,timeZone:"",customTimeZone:"",timeType:"instant",fileFormat:f}};h.prototype.handleEscapeChars=function(f){f=JSON.stringify(f);return f=
f.substring(1,f.length-1)};h.prototype.createDatasetsPropertyMenu=function(f,r){var q=this;return f.map(function(t,w){return(0,a.h)("button",{key:w,class:"btn-link btn-link-darker-gray font-size--1 data-property-sidebar-menu-item"+(q.state.activeMenuItem===t.value?" data-property-sidebar-menu-item--active":""),disabled:r,onClick:q.checkSidebarItem.bind(q,t.value)},t.label)})};h.prototype.openEditingModal=function(f){var r=0;(0,c.default)(this.props.datasetsManifest).forEach(function(q,t){q.name===
f&&(r=t)});this.renderEditingModal(r,this.props.datasetsManifest,this.state.activeMenuItem)};h.prototype.renderEditingModal=function(f,r,q){this.setState({datasetsManifest:r,modalActive:!0,activeManifestIndex:f,isModalButtonDisabled:!1,activeMenuItem:q})};h.prototype.closeEditingModal=function(f){if(this.state.modalActive){var r=[];"save"===f?(r=(0,c.default)(this.state.datasetsManifest),this.originalDatasetsManifest=(0,c.default)(this.state.datasetsManifest)):r=(0,c.default)(this.originalDatasetsManifest);
this.setState({modalActive:!1,activeMenuItem:"Fields",datasetsManifest:r,isGeometryErrorActive:!1,isTimeErrorActive:!1,validationErrorType:""})}this.props.closeEditingModal(!1)};h.prototype.createFieldFormatTSX=function(f){var r=[g.default.itemProperties.datasetsManifest.fields.integer,g.default.itemProperties.datasetsManifest.fields.smallInteger,g.default.itemProperties.datasetsManifest.fields.bigInteger,g.default.itemProperties.datasetsManifest.fields.string,g.default.itemProperties.datasetsManifest.fields.double,
g.default.itemProperties.datasetsManifest.fields.date,g.default.itemProperties.datasetsManifest.fields.single];b.default.includes(["orc","parquet"],f)&&r.push(g.default.itemProperties.datasetsManifest.fields.binary);return r.map(function(q){return(0,a.h)("option",{value:q},q)})};h.prototype.isFieldDisabled=function(f,r){return"delimited"!==f&&!b.default.includes(["csv","orc","parquet"],r)||this.state.isReadOnly};h.prototype.createDataItemFieldsTSX=function(f,r,q){var t=this,w=r.type,u=r.extension,
v=this.createFieldFormatTSX(u);f=f.map(function(x,z){var A="key_".concat(t.state.activeManifestIndex,"_itemname_").concat(z),B="schema_name_".concat(t.state.activeManifestIndex,"_").concat(x.name,"_").concat(z),J="schema_value_".concat(t.state.activeManifestIndex,"_").concat(x.name,"_").concat(z);return(0,a.h)("tr",{key:A},(0,a.h)("td",null," ",(0,a.h)("input",{name:B,value:x.name,onChange:t.changeDataFieldName.bind(t,t.state.activeManifestIndex,z),disabled:t.isFieldDisabled(w,u)})," "),(0,a.h)("td",
null," ",(0,a.h)("select",{class:"select-full bdfs-select",name:J,value:t.convertFromEsriType(x.type),onChange:t.changeDataFieldType.bind(t,t.state.activeManifestIndex,z),disabled:t.isFieldDisabled(w,u)},v)," "))});f=(0,a.h)("table",{class:"table"},(0,a.h)("thead",null,(0,a.h)("tr",null,(0,a.h)("th",null," ",g.default.itemProperties.datasetsManifest.fields.name," "),(0,a.h)("th",null," ",g.default.itemProperties.datasetsManifest.fields.type," "))),(0,a.h)("tbody",null,f));r="";"downloading"===q?r=
g.default.itemProperties.datasetsManifest.statusMessage.downloading:"fail"===q&&(r=g.default.itemProperties.datasetsManifest.statusMessage.fail);""!==r&&(f=(0,a.h)("div",{class:"padding-leader-half"},(0,a.h)("em",null,r)));return f};h.prototype.convertFromEsriType=function(f){if("esriFieldTypeBigInteger"===f)return g.default.itemProperties.datasetsManifest.fields.bigInteger;if("esriFieldTypeSmallInteger"===f)return g.default.itemProperties.datasetsManifest.fields.smallInteger;if("esriFieldTypeInteger"===
f)return g.default.itemProperties.datasetsManifest.fields.integer;if("esriFieldTypeSingle"===f)return g.default.itemProperties.datasetsManifest.fields.single;if("esriFieldTypeString"===f)return g.default.itemProperties.datasetsManifest.fields.string;if("esriFieldTypeDouble"===f)return g.default.itemProperties.datasetsManifest.fields.double;if("esriFieldTypeBlob"===f)return g.default.itemProperties.datasetsManifest.fields.binary;if("esriFieldTypeDate"===f)return g.default.itemProperties.datasetsManifest.fields.date};
h.prototype.convertToEsriItemType=function(f){if(f===g.default.itemProperties.datasetsManifest.fields.bigInteger)return"esriFieldTypeBigInteger";if(f===g.default.itemProperties.datasetsManifest.fields.smallInteger)return"esriFieldTypeSmallInteger";if(f===g.default.itemProperties.datasetsManifest.fields.integer)return"esriFieldTypeInteger";if(f===g.default.itemProperties.datasetsManifest.fields.single)return"esriFieldTypeSingle";if(f===g.default.itemProperties.datasetsManifest.fields.string)return"esriFieldTypeString";
if(f===g.default.itemProperties.datasetsManifest.fields.double)return"esriFieldTypeDouble";if(f===g.default.itemProperties.datasetsManifest.fields.binary)return"esriFieldTypeBlob";if(f===g.default.itemProperties.datasetsManifest.fields.date)return"esriFieldTypeDate"};h.prototype.changeDataFieldName=function(f,r,q){q=q.target.value;var t=(0,c.default)(this.state.datasetsManifest);t[f].schema.fields[r].name=q;this.setState({datasetsManifest:t})};h.prototype.changeDataFieldType=function(f,r,q){q=q.target.value;
var t=(0,c.default)(this.state.datasetsManifest);t[f].schema.fields[r].type=this.convertToEsriItemType(q);this.setState({datasetsManifest:t})};h.prototype.filterDataFields=function(f,r){if("XYZ"===r)f=f.filter(function(q){if("esriFieldTypeString"===q.type||"esriFieldTypeDouble"===q.type||"esriFieldTypeBigInteger"===q.type)return q});else if("WKB"===r||"EsriShape"===r)f=f.filter(function(q){if("esriFieldTypeBlob"===q.type)return q});else if("WKT"===r||"GeoJSON"===r||"EsriJSON"===r)f=f.filter(function(q){if("esriFieldTypeString"===
q.type)return q});this.geometryFieldsListLength=f.length;return this.createDataFieldsList(f)};h.prototype.createDataFieldsList=function(f){return f.map(function(r){return(0,a.h)("option",{value:r.name},r.name)})};h.prototype.createGeometryTSX=function(f,r){var q=this,t=(null===r||void 0===r?0:r.spatialReference)?r.spatialReference:{},w=(null===r||void 0===r?0:r.fields)?r.fields:[];r=w?w.length:0;this.hasGeometryValidationError=!1;var u="",v="",x="",z="";if(3===r){if(""===w[0].name||""===w[1].name)this.hasGeometryValidationError=
!0;"unavailable"===this.state.validationErrorType?(v=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageX,x=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageY):"unselected"===this.state.validationErrorType&&(v=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageX,x=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageY);var A=this.filterDataFields(f,"XYZ");z="XYZ";f=["X","Y","Z"];var B=f.map(function(T,E){var I="";
w.forEach(function(F){b.default.includes(F.formats,T.toLocaleLowerCase())&&(I=F.name)});return(0,a.h)(a.Fragment,null,(0,a.h)("div",null,"".concat(T," ").concat(g.default.itemProperties.datasetsManifest.geometry.Field)),0===E&&(0,a.h)(a.Fragment,null,(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" input-error":""," "),name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,
E)},A),(0,a.h)("div",{class:"input-error-message XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" is-active":"")},v)),1===E&&(0,a.h)(a.Fragment,null,(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" input-error":""),name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,E)},A),(0,a.h)("div",{class:"input-error-message XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&
""===I?" is-active":"")},x)),2===E&&(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field",name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,E)},A,(0,a.h)("option",{value:""})))})}else if(2===r){if(""===w[0].name||""===w[1].name)this.hasGeometryValidationError=!0;"unavailable"===this.state.validationErrorType?(v=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageX,x=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageY):
"unselected"===this.state.validationErrorType&&(v=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageX,x=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageY);var J=this.filterDataFields(f,"XYZ"),P=(0,c.default)(w);P.push({name:"",formats:["Z"]});z="XYZ";f=["X","Y","Z"];B=f.map(function(T,E){var I="";P.forEach(function(F){b.default.includes(F.formats,T.toLocaleLowerCase())&&(I=F.name)});return(0,a.h)(a.Fragment,null,(0,a.h)("div",null,"".concat(T," ").concat(g.default.itemProperties.datasetsManifest.geometry.Field)),
0===E&&(0,a.h)(a.Fragment,null,(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" input-error":""),name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,E)},J),(0,a.h)("div",{class:"input-error-message XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" is-active":"")},v)),1===E&&(0,a.h)(a.Fragment,null,(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&
""===I?" input-error":""),name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,E)},J),(0,a.h)("div",{class:"input-error-message XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" is-active":"")},x)),2===E&&(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field",name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,E)},J,(0,a.h)("option",{value:""})))})}else if(1===
r){z=w[0].formats[0];""===w[0].name&&(this.hasGeometryValidationError=!0);"unavailable"===this.state.validationErrorType?"WKB"===z?u=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageWKB:"EsriShape"===z?u=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageEsriShape:"GeoJSON"===z?u=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageGeoJSON:"EsriJSON"===z?u=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageEsriJSON:
"WKT"===z&&(u=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageWKT):"unselected"===this.state.validationErrorType&&("WKB"===z?u=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageWKB:"EsriShape"===z?u=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageEsriShape:"GeoJSON"===z?u=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageGeoJSON:"EsriJSON"===z?u=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageEsriJSON:
"WKT"===z&&(u=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageWKT));var R=this.filterDataFields(f,z);B=w.map(function(T,E){T=T.name;return(0,a.h)(a.Fragment,null,(0,a.h)("div",null,"".concat(z," ").concat(g.default.itemProperties.datasetsManifest.geometry.Field)),(0,a.h)("select",{class:"select-full bdfs-select nonXYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===T?" input-error":""),name:"geometryFieldsValue_".concat(E),value:T,disabled:q.state.isReadOnly,onChange:q.nonXYZGeometryFieldChange.bind(q)},
R),(0,a.h)("div",{class:"input-error-message nonXYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===T?" is-active":"")},u))})}else if(!w||0===r){"unavailable"===this.state.validationErrorType?(v=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageX,x=g.default.itemProperties.bdfsValidation.geometry.unavailable.errorMessageY):"unselected"===this.state.validationErrorType&&(v=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageX,x=g.default.itemProperties.bdfsValidation.geometry.unselected.errorMessageY);
var S=this.filterDataFields(f,"XYZ");z="XYZ";f=["X","Y","Z"];B=f.map(function(T,E){var I="";I="";return(0,a.h)(a.Fragment,null,(0,a.h)("div",null,"".concat(T," ").concat(g.default.itemProperties.datasetsManifest.geometry.Field)),0===E&&(0,a.h)(a.Fragment,null,(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" input-error":""),name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,
E)},S),(0,a.h)("div",{class:"input-error-message XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" is-active":"")},v)),1===E&&(0,a.h)(a.Fragment,null,(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&""===I?" input-error":""),name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,E)},S),(0,a.h)("div",{class:"input-error-message nonXYZ-geometry-field ".concat(q.state.isGeometryErrorActive&&
""===I?" is-active":"")},x)),2===E&&(0,a.h)("select",{class:"select-full bdfs-select XYZ-geometry-field",name:"geometryFieldsValue_".concat(E),value:I,disabled:q.state.isReadOnly,onChange:q.geometryFieldXYZUpdate.bind(q,E)},S,(0,a.h)("option",{value:""})))})}return{geometrySpatialReference:t,geometryFieldsTSX:B,geometryFormatType:z}};h.prototype.geometryTypeChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].geometry||(r[this.state.activeManifestIndex].geometry=
{geometryType:"",spatialReference:{wkid:4326}});if("Polyline"===f.value||"Polygon"===f.value)r[this.state.activeManifestIndex].geometry.fields=[],r[this.state.activeManifestIndex].geometry.fields.push({formats:["WKT"],name:""});"Point"===f.value&&(r[this.state.activeManifestIndex].geometry.fields=[],r[this.state.activeManifestIndex].geometry.fields.push({formats:["x"],name:""}),r[this.state.activeManifestIndex].geometry.fields.push({formats:["y"],name:""}),r[this.state.activeManifestIndex].geometry.fields.push({formats:["z"],
name:""}));r[this.state.activeManifestIndex].geometry.geometryType=this.convertToEsriGeometryType(f.value);"None"===f.value&&delete r[this.state.activeManifestIndex].geometry;this.setState({datasetsManifest:r,isGeometryErrorActive:!1})};h.prototype.geometrySpatialReferenceChange=function(f){var r=(0,c.default)(this.state.datasetsManifest);f=f.target.value;isNaN(parseFloat(f))?(delete r[this.state.activeManifestIndex].geometry.spatialReference.wkid,r[this.state.activeManifestIndex].geometry.spatialReference.wkt=
f):(delete r[this.state.activeManifestIndex].geometry.spatialReference.wkt,r[this.state.activeManifestIndex].geometry.spatialReference.wkid=Number(f));this.setState({datasetsManifest:r})};h.prototype.geometryFormatTypeChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest),q=[];"XYZ"===f.value?(q.push({name:"",formats:["x"]}),q.push({name:"",formats:["y"]}),q.push({name:"",formats:["z"]})):q.push({name:"",formats:[f.value]});r[this.state.activeManifestIndex].geometry.fields=
(0,c.default)(q);this.setState({datasetsManifest:r,isGeometryErrorActive:!1})};h.prototype.nonXYZGeometryFieldChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].geometry.fields[0].name=f.value;this.setState({datasetsManifest:r})};h.prototype.geometryFieldXYZUpdate=function(f,r){r=r.target;var q=(0,c.default)(this.state.datasetsManifest);2!==f||q[this.state.activeManifestIndex].geometry.fields[f]?q[this.state.activeManifestIndex].geometry.fields[f].name=
r.value:q[this.state.activeManifestIndex].geometry.fields[f]={formats:["z"],name:r.value};this.setState({datasetsManifest:q})};h.prototype.timeTypeChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].time||(r[this.state.activeManifestIndex].time={timeReference:{timeZone:"UTC"}});r[this.state.activeManifestIndex].time.timeType=f.value;r[this.state.activeManifestIndex].time.fields=[];"instant"===f.value?r[this.state.activeManifestIndex].time.fields.push({name:"",
formats:[""]}):"interval"===f.value?(r[this.state.activeManifestIndex].time.fields.push({name:"",role:"start",formats:[""]}),r[this.state.activeManifestIndex].time.fields.push({name:"",role:"end",formats:[""]})):"none"===f.value&&delete r[this.state.activeManifestIndex].time;this.setState({datasetsManifest:r,isTimeErrorActive:!1,timeTypeChanged:!0})};h.prototype.timeZoneChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].time.timeReference.timeZone=
f.value;"custom"===f.value?r[this.state.activeManifestIndex].time.timeReference.customTimeZone="":delete r[this.state.activeManifestIndex].time.timeReference.customTimeZone;this.setState({datasetsManifest:r})};h.prototype.customTimeZoneChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].time.timeReference.customTimeZone=f.value;this.setState({datasetsManifest:r})};h.prototype.processCustomTimezone=function(f){var r,q=(null===(r=null===f||
void 0===f?void 0:f.timeReference)||void 0===r?void 0:r.timeZone)||"UTC",t=!0;this.availableTimeZones.forEach(function(w){"custom"!==w.canonicalID&&q===w.canonicalID&&(t=!1)});t&&"custom"!==q&&(f.timeReference.customTimeZone=q,q=f.timeReference.timeZone="custom");return p.__assign({},null===f||void 0===f?void 0:f.timeReference)};h.prototype.initializeTimeProperty=function(f){var r=this.processCustomTimezone(f),q=r.timeZone;r=r.customTimeZone;var t=[],w=[],u=[],v=(null===f||void 0===f?0:f.timeType)?
f.timeType:"none";if(f)if(f=f.fields,"instant"===v){w.push({id:0,timeField:"",timeFormat:""});u.push({id:0,timeField:"",timeFormat:""});var x=0;f.forEach(function(B){t.push({id:x,timeField:B.name,timeFormat:B.formats?B.formats[0]:""});x++})}else{if("interval"===v){t.push({id:0,timeField:"",timeFormat:""});var z=0,A=0;f.forEach(function(B){var J=B.formats?B.formats[0]:"";"start"===B.role?(w.push({id:z,timeField:B.name,timeFormat:J}),z++):"end"===B.role&&(u.push({id:A,timeField:B.name,timeFormat:J}),
A++)})}}else t.push({id:0,timeField:"",timeFormat:""}),w.push({id:0,timeField:"",timeFormat:""}),u.push({id:0,timeField:"",timeFormat:""});return{timeInstantArr:t,timeIntervalStartArr:w,timeIntervalEndArr:u,timeZone:q,customTimeZone:r,timeType:v}};h.prototype.createTimeZoneList=function(){return this.availableTimeZones.map(function(f){return(0,a.h)("option",{key:f.canonicalID,value:f.canonicalID},f.canonicalID)})};h.prototype.hasValidationError=function(f,r){return"date"!==f.timeField.toLocaleLowerCase()&&
(""===f.timeField||""===f.timeFormat)&&!this.checkFieldDateType(f,r)};h.prototype.displayValidationError=function(f,r){return this.state.isTimeErrorActive&&""===f.timeFormat&&"date"!==f.timeField.toLocaleLowerCase()&&!this.checkFieldDateType(f,r)};h.prototype.checkFieldDateType=function(f,r){return r.some(function(q){return q.name===f.timeField&&"esriFieldTypeDate"===q.type})};h.prototype.createTimeFieldsTSX=function(f,r,q,t,w){var u=this,v=this.createDataFieldsList(w),x=this.createTimeZoneList();
this.hasTimeValidationError=!1;var z=r.map(function(J,P){u.hasValidationError(J,w)&&"instant"===f&&(u.hasTimeValidationError=!0);""===J.timeField&&""===J.timeFormat&&(u.hasTimeValidationError=!1);P=(0,a.h)(a.Fragment,null,(0,a.h)("td",null,(0,a.h)("select",{class:"select-full bdfs-select".concat(u.state.isTimeErrorActive&&""===J.timeField?" input-error":""),name:"timeFields_".concat(P),value:J.timeField,onChange:u.changeTimeFieldName.bind(u,J.id,"instant"),disabled:u.state.isReadOnly},v),(0,a.h)("div",
{class:"input-error-message-wrapper"},(0,a.h)("span",{class:"bdfs-error-message input-error-message".concat(u.state.isTimeErrorActive&&""===J.timeField?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageField))),(0,a.h)("td",null,(0,a.h)("input",{class:"bdfs-time-input".concat(u.displayValidationError(J,w)?" input-error":""),type:"text",name:"timeFormat_".concat(P),value:J.timeFormat,onChange:u.changeTimeFormat.bind(u,J.id,"instant"),disabled:u.state.isReadOnly||u.checkFieldDateType(J,
w)}),(0,a.h)("div",{class:"input-error-message-wrapper"},(0,a.h)("span",{class:"bdfs-error-message input-error-message".concat(u.displayValidationError(J,w)?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageFormat))));return 1>J.id?(0,a.h)("tr",{key:"instant".concat(J.id)},P,(0,a.h)("td",null,(0,a.h)("span",null))):(0,a.h)("tr",{key:"instant".concat(J.id)},P,(0,a.h)("td",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",onClick:u.deleteTimeFields.bind(u,
J.id,"instant"),disabled:u.state.isReadOnly},"x"))))}),A=q.map(function(J,P){u.hasValidationError(J,w)&&"interval"===f&&(u.hasTimeValidationError=!0);""===J.timeField&&""===J.timeFormat&&(u.hasTimeValidationError=!1);P=(0,a.h)(a.Fragment,null,(0,a.h)("td",null,(0,a.h)("select",{class:"select-full bdfs-select".concat(u.state.isTimeErrorActive&&""===J.timeField?" input-error":""),name:"timeIntervalStart_".concat(P),value:J.timeField,onChange:u.changeTimeFieldName.bind(u,J.id,"intervalStart"),disabled:u.state.isReadOnly},
v),(0,a.h)("div",{class:"input-error-message-wrapper"},(0,a.h)("span",{class:"bdfs-error-message input-error-message".concat(u.state.isTimeErrorActive&&""===J.timeField?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageField))),(0,a.h)("td",null,(0,a.h)("input",{class:"bdfs-time-input".concat(u.displayValidationError(J,w)?" input-error":""),type:"text",name:"timeIntervalStartFormat_".concat(P),value:J.timeFormat,onChange:u.changeTimeFormat.bind(u,J.id,"intervalStart"),disabled:u.state.isReadOnly||
u.checkFieldDateType(J,w)}),(0,a.h)("div",{class:"input-error-message-wrapper"},(0,a.h)("span",{class:"bdfs-error-message input-error-message".concat(u.displayValidationError(J,w)?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageFormat))));return 1>J.id?(0,a.h)("tr",{key:"intervalStart".concat(J.id)},P,(0,a.h)("td",null,(0,a.h)("span",null))):(0,a.h)("tr",{key:"intervalStart".concat(J.id)},P,(0,a.h)("td",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",
onClick:u.deleteTimeFields.bind(u,J.id,"intervalStart"),disabled:u.state.isReadOnly},"x"))))}),B=t.map(function(J,P){u.hasValidationError(J,w)&&"interval"===f&&(u.hasTimeValidationError=!0);""===J.timeField&&""===J.timeFormat&&(u.hasTimeValidationError=!1);P=(0,a.h)(a.Fragment,null,(0,a.h)("td",null,(0,a.h)("select",{class:"select-full bdfs-select".concat(u.state.isTimeErrorActive&&""===J.timeField?" input-error":""),name:"timeIntervalEnd_".concat(P),value:J.timeField,onChange:u.changeTimeFieldName.bind(u,
J.id,"intervalEnd"),disabled:u.state.isReadOnly},v),(0,a.h)("div",{class:"input-error-message-wrapper"},(0,a.h)("span",{class:"bdfs-error-message input-error-message".concat(u.state.isTimeErrorActive&&""===J.timeField?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageField))),(0,a.h)("td",null,(0,a.h)("input",{class:"bdfs-time-input".concat(u.displayValidationError(J,w)?" input-error":""),type:"text",name:"timeIntervalEndFormat_".concat(P),value:J.timeFormat,onChange:u.changeTimeFormat.bind(u,
J.id,"intervalEnd"),disabled:u.state.isReadOnly||u.checkFieldDateType(J,w)}),(0,a.h)("div",{class:"input-error-message-wrapper"},(0,a.h)("span",{class:"bdfs-error-message input-error-message".concat(u.displayValidationError(J,w)?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageFormat))));return 1>J.id?(0,a.h)("tr",{key:"intervalEnd".concat(J.id)},P,(0,a.h)("td",null,(0,a.h)("span",null))):(0,a.h)("tr",{key:"intervalEnd".concat(J.id)},P,(0,a.h)("td",null,(0,a.h)("span",null,
(0,a.h)("button",{type:"button",class:"timeFieldBtn",onClick:u.deleteTimeFields.bind(u,J.id,"intervalEnd"),disabled:u.state.isReadOnly},"x"))))});this.disableAddButtonIfChange(f,r,q,t);return{timeInstantFieldsTSX:z,timeIntervalStartFieldsTSX:A,timeIntervalEndFieldsTSX:B,timeZoneListTSX:x}};h.prototype.disableAddButtonIfChange=function(f,r,q,t){0!==r.length&&"instant"===f&&""===r[r.length-1].timeField&&""===r[r.length-1].timeFormat&&document.getElementById("timeInstantButton")&&(r=document.getElementById("timeInstantButton"),
r.disabled=!0);0!==q.length&&"interval"===f&&""===q[q.length-1].timeField&&""===q[q.length-1].timeFormat&&document.getElementById("timeIntervalStartButton")&&(r=document.getElementById("timeIntervalStartButton"),r.disabled=!0);0!==t.length&&"interval"===f&&""===t[t.length-1].timeField&&""===t[t.length-1].timeFormat&&document.getElementById("timeIntervalEndButton")&&(r=document.getElementById("timeIntervalEndButton"),r.disabled=!0)};h.prototype.addTimeFields=function(f,r){r=(0,c.default)(this.state.datasetsManifest);
"instant"===f?(r[this.state.activeManifestIndex].time.fields.push({name:"",formats:[""]}),f=document.getElementById("timeInstantButton"),f.disabled=!0):"intervalStart"===f?(r[this.state.activeManifestIndex].time.fields.push({name:"",role:"start",formats:[""]}),f=document.getElementById("timeIntervalStartButton"),f.disabled=!0):"intervalEnd"===f&&(f=document.getElementById("timeIntervalEndButton"),f.disabled=!0,r[this.state.activeManifestIndex].time.fields.push({name:"",role:"end",formats:[""]}));
this.setState({datasetsManifest:r})};h.prototype.deleteTimeFields=function(f,r){var q=(0,c.default)(this.state.datasetsManifest),t=q[this.state.activeManifestIndex].time.fields,w=0;"instant"===r?t=t.filter(function(u,v){return f!==v}):"intervalStart"===r?t=t.filter(function(u){if("start"===u.role){if(w!==f)return w++,!0;w++;return!1}return!0}):"intervalEnd"===r&&(t=t.filter(function(u){if("end"===u.role){if(w!==f)return w++,!0;w++;return!1}return!0}));q[this.state.activeManifestIndex].time.fields=
t;this.setState({datasetsManifest:q});document.getElementsByClassName("timeFieldBtn")[0].disabled=!1};h.prototype.disableAddButtonForTimeFieldChange=function(f,r){if("instant"===r){r=document.getElementsByClassName("timeFieldBtn")[0];var q=document.getElementsByClassName("bdfs-time-input");q=q[q.length-1];f.toUpperCase().includes("DATE")?r.disabled=!1:f.toUpperCase().includes("DATE")||""===q.value?r.disabled=!0:r.disabled=!1}else if("intervalStart"===r){r=document.getElementById("timeIntervalStartButton");
var t=document.getElementsByClassName("intervalStartTbody")[0];q=t.childNodes.length-1;f=t.children[q].getElementsByTagName("td")[0].getElementsByTagName("select")[0];q=t.children[q].getElementsByTagName("td")[1].getElementsByTagName("input")[0];f.value.toUpperCase().includes("DATE")?r.disabled=!1:f.value.toUpperCase().includes("DATE")||""===q.value||""===f.value?r.disabled=!0:r.disabled=!1}else"intervalEnd"===r&&(r=document.getElementById("timeIntervalEndButton"),t=document.getElementsByClassName("intervalEndTbody")[0],
q=t.childNodes.length-1,f=t.children[q].getElementsByTagName("td")[0].getElementsByTagName("select")[0],q=t.children[q].getElementsByTagName("td")[1].getElementsByTagName("input")[0],f.value.toUpperCase().includes("DATE")?r.disabled=!1:f.value.toUpperCase().includes("DATE")||""===q.value||""===f.value?r.disabled=!0:r.disabled=!1)};h.prototype.changeTimeFieldName=function(f,r,q){q=q.target.value;this.modifyTimeFieldsData(f,q,"",r);this.disableAddButtonForTimeFieldChange(q,r)};h.prototype.disableAddButtonForTimeFormatChange=
function(f,r){if("instant"===r){r=document.getElementsByClassName("select-full bdfs-select");var q=r[r.length-2].value;r=document.getElementsByClassName("timeFieldBtn")[0];r.disabled=""!==q&&""!==f?!1:!0}else if("intervalStart"===r){r=document.getElementById("timeIntervalStartButton");var t=document.getElementsByClassName("intervalStartTbody")[0];q=t.childNodes.length-1;f=t.children[q].getElementsByTagName("td")[0].getElementsByTagName("select")[0];q=t.children[q].getElementsByTagName("td")[1].getElementsByTagName("input")[0];
f.value.toUpperCase().includes("DATE")?r.disabled=!1:f.value.toUpperCase().includes("DATE")||""===q.value||""===f.value?r.disabled=!0:r.disabled=!1}else"intervalEnd"===r&&(r=document.getElementById("timeIntervalEndButton"),t=document.getElementsByClassName("intervalEndTbody")[0],q=t.childNodes.length-1,f=t.children[q].getElementsByTagName("td")[0].getElementsByTagName("select")[0],q=t.children[q].getElementsByTagName("td")[1].getElementsByTagName("input")[0],f.value.toUpperCase().includes("DATE")?
r.disabled=!1:f.value.toUpperCase().includes("DATE")||""===q.value||""===f.value?r.disabled=!0:r.disabled=!1)};h.prototype.changeTimeFormat=function(f,r,q){q=q.target.value;this.modifyTimeFieldsData(f,"",q,r);this.disableAddButtonForTimeFormatChange(q,r)};h.prototype.modifyTimeFieldsData=function(f,r,q,t){var w=this,u=(0,c.default)(this.state.datasetsManifest),v=u[this.state.activeManifestIndex].time.fields,x=0;"instant"===t?v.forEach(function(z,A){A===f&&(""===r?z.formats=[q]:""===q&&(w.checkFieldDateType({timeField:r},
w.dataItemFields)&&(z.formats=[""]),z.name=r))}):"intervalStart"===t?v.forEach(function(z){"start"===z.role&&(x===f&&(""===r?z.formats=[q]:""===q&&(w.checkFieldDateType({timeField:r},w.dataItemFields)&&(z.formats=[""]),z.name=r)),x++)}):"intervalEnd"===t&&v.forEach(function(z){"end"===z.role&&(x===f&&(""===r?z.formats=[q]:""===q&&(w.checkFieldDateType({timeField:r},w.dataItemFields)&&(z.formats=[""]),z.name=r)),x++)});u[this.state.activeManifestIndex].time.fields=v;this.setState({datasetsManifest:u})};
h.prototype.fieldDelimiterChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].format.fieldDelimiter=f.value;"custom"===f.value?r[this.state.activeManifestIndex].format.customFieldDelimiter="":delete r[this.state.activeManifestIndex].format.customFieldDelimiter;this.setState({datasetsManifest:r})};h.prototype.customFieldDelimiterChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].format.customFieldDelimiter=
f.value;this.setState({datasetsManifest:r})};h.prototype.recordTerminatorChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].format.recordTerminator=f.value;"custom"===f.value?r[this.state.activeManifestIndex].format.customRecordTerminator="":delete r[this.state.activeManifestIndex].format.customRecordTerminator;this.setState({datasetsManifest:r})};h.prototype.customRecordTerminatorChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);
r[this.state.activeManifestIndex].format.customRecordTerminator=f.value;this.setState({datasetsManifest:r})};h.prototype.quoteCharChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].format.quoteChar=f.value;this.setState({datasetsManifest:r})};h.prototype.hasHeaderRowChange=function(){var f=(0,c.default)(this.state.datasetsManifest);f[this.state.activeManifestIndex].format.hasHeaderRow=!f[this.state.activeManifestIndex].format.hasHeaderRow;
this.setState({datasetsManifest:f})};h.prototype.encodingChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].format.encoding=f.value;"custom"===f.value?r[this.state.activeManifestIndex].format.customEncoding="":delete r[this.state.activeManifestIndex].format.customEncoding;this.setState({datasetsManifest:r})};h.prototype.customEncodingChange=function(f){f=f.target;var r=(0,c.default)(this.state.datasetsManifest);r[this.state.activeManifestIndex].format.customEncoding=
f.value;this.setState({datasetsManifest:r})};h.prototype.checkSidebarItem=function(f,r){r.preventDefault();this.renderEditingModal(this.state.activeManifestIndex,this.state.datasetsManifest,f)};h.prototype.deleteEmptyGeometryZField=function(f){f.forEach(function(r){var q,t,w;""===(null===(w=null===(t=null===(q=null===r||void 0===r?void 0:r.geometry)||void 0===q?void 0:q.fields)||void 0===t?void 0:t[2])||void 0===w?void 0:w.name)&&r.geometry.fields.pop()});return f};h.prototype.deleteCustomFields=
function(f){var r,q;f.format.customFieldDelimiter&&(f.format.fieldDelimiter=f.format.customFieldDelimiter);delete f.format.customFieldDelimiter;f.format.customRecordTerminator&&(f.format.recordTerminator=f.format.customRecordTerminator);delete f.format.customRecordTerminator;f.format.customEncoding&&(f.format.encoding=f.format.customEncoding);delete f.format.customEncoding;if(null===(q=null===(r=null===f||void 0===f?void 0:f.time)||void 0===r?void 0:r.timeReference)||void 0===q?0:q.customTimeZone)f.time.timeReference.timeZone=
f.time.timeReference.customTimeZone,delete f.time.timeReference.customTimeZone};h.prototype.deleteUnnecessaryKeys=function(f){b.default.includes(["shapefile","orc","parquet"],f.format.type)&&(delete f.format.fieldDelimiter,delete f.format.recordTerminator,delete f.format.encoding)};h.prototype.deleteDataFormat=function(f){var r=this,q;null===(q=null===f||void 0===f?void 0:f.time)||void 0===q?void 0:q.fields.forEach(function(t){r.checkFieldDateType({timeField:t.name},r.dataItemFields)&&delete t.formats})};
h.prototype.reformatEscapeCharacters=function(f){return"\\r"===f?"\r":"\\n"===f?"\n":"\\t"===f?"\t":"\\b"===f?"\b":"\\f"===f?"\f":f};h.prototype.saveEditingModal=function(){var f=this;if(this.hasGeometryValidationError||this.hasTimeValidationError)this.setState({isGeometryErrorActive:this.hasGeometryValidationError,isTimeErrorActive:this.hasTimeValidationError,validationErrorType:0===this.geometryFieldsListLength?"unavailable":"unselected"});else{this.setState({isModalButtonDisabled:!0,progressIndicatorActive:!0,
isGeometryErrorActive:!1,isTimeErrorActive:!1,validationErrorType:""});var r="".concat(this.props.manifestAdminURL,"/update"),q={},t=(0,c.default)(this.state.datasetsManifest);t.forEach(function(w){w.time&&2<=w.time.fields.length&&""===w.time.fields[w.time.fields.length-1].name&&""===w.time.fields[w.time.fields.length-1].formats[0]&&(f.deleteTimeFields(w.time.fields.length-1,w.time.timeType),w.time.fields.pop());f.deleteCustomFields(w);w.format.fieldDelimiter=f.reformatEscapeCharacters(w.format.fieldDelimiter);
w.format.recordTerminator=f.reformatEscapeCharacters(w.format.recordTerminator);f.deleteUnnecessaryKeys(w);f.deleteDataFormat(w)});q.datasets=this.deleteEmptyGeometryZField(t);n.default.request({url:r,content:{fileData:JSON.stringify(q)}},{useProxy:n.default.shouldUseProxy(r),usePost:!0}).then(function(w){"success"===w.status?f.handleManifestUpdateSuccess():f.updateEditingModal(q)},function(w){f.updateEditingModal(q)})}};h.prototype.updateEditingModal=function(f){var r=this,q="".concat(this.props.portalURL,
"/manifest/update");n.default.request({url:q,content:{fileData:JSON.stringify(f)}},{useProxy:n.default.shouldUseProxy(q),usePost:!0}).then(function(w){"success"===w.status?r.handleManifestUpdateSuccess():t(w.error)},function(w){t(w)});var t=function(w){r.setState({isModalButtonDisabled:!1,progressIndicatorActive:!1,datasetsManifest:r.state.datasetsManifest});r.displayNotificationIndicator(!0,"danger",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpdate.failure)}};h.prototype.handleManifestUpdateSuccess=
function(){this.props.updateManifest(this.state.datasetsManifest);this.closeEditingModal("save");this.setState({isModalButtonDisabled:!1,progressIndicatorActive:!1});this.displayNotificationIndicator(!0,"success",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpdate.success)};h.prototype.displayNotificationIndicator=function(f,r,q){this.props.displayNotificationIndicator(f,r,q)};h.prototype.processCustomCharacters=function(f){-1===", \\t ; ' \" | / \\".split(" ").indexOf(f.fieldDelimiter)&&
(f.customFieldDelimiter="custom"===f.fieldDelimiter?f.customFieldDelimiter:f.fieldDelimiter,f.fieldDelimiter="custom");-1===["\\t","\\n","\\r"].indexOf(f.recordTerminator)&&(f.customRecordTerminator="custom"===f.recordTerminator?f.customRecordTerminator:f.recordTerminator,f.recordTerminator="custom");-1==="US-ASCII UTF-8 UTF-16 UTF-32 ISO-8859-1 UTF-16LE UTF-16BE".split(" ").indexOf(f.encoding)&&(f.customEncoding="custom"===f.encoding?f.customEncoding:f.encoding,f.encoding="custom")};h.prototype.getHelpLink=
function(){return"".concat(d.default.self.helpBase).concat(d.default.self.helpMap.m["120002874"])};h.prototype.render=function(){var f=this,r=this.state,q=r.datasetsManifest,t=r.activeManifestIndex,w=r.activeMenuItem,u=r.datasetsManifestStatus,v=r.modalActive,x=r.isReadOnly,z=r.timeTypeChanged,A=r.isModalButtonDisabled,B=r.progressIndicatorActive,J=g.default.itemProperties.datasetsManifest.edittingModal,P=J.title,R=J.cancel,S=J.save;J=J.saveLoading;r=this.createDatasetsPropertyMenu(r.sidebarMenu,
r.isSidebarDisabled);var T=this.retrieveDatasetProperty(t,q,w),E=T.dataItemFields,I=T.geometry;q=T.geometryType;t=T.dataItemTime;var F=T.timeInstantArr,D=T.timeIntervalStartArr,C=T.timeIntervalEndArr,y=T.timeZone,G=T.customTimeZone,L=T.timeType;T=T.fileFormat;u=this.createDataItemFieldsTSX(E,T,u);var O=this.createGeometryTSX(E,I);I=O.geometrySpatialReference;var U=O.geometryFieldsTSX;O=O.geometryFormatType;var M=g.default.itemProperties.datasetsManifest.geometry,Q=M.spatialReference,Y=M.spatialReferenceValue,
fa=M.point,va=M.polyline,Aa=M.polygon,pa=M.geomtryFormatType,N=M.XYZ,V=M.WKT,Z=M.WKB,ba=M.GeoJSON,ma=M.EsriJSON,sa=M.EsriShape,Ea=M.none;M=M.geometryFields;C=this.createTimeFieldsTSX(L,F,D,C,E);E=C.timeInstantFieldsTSX;F=C.timeIntervalStartFieldsTSX;D=C.timeIntervalEndFieldsTSX;C=C.timeZoneListTSX;var ya=g.default.itemProperties.datasetsManifest.time;L=ya.timeType;var wa=ya.instant,aa=ya.interval,ca=ya.timeFields,ka=ya.field,qa=ya.format,da=ya.startTimeFields,ia=ya.endTimeFields;ya=ya.timeZone;var ra=
g.default.itemProperties.datasetsManifest.file,Fa=ra.fileExtension,ea=ra.fieldDelimiter,xa=ra.inputDelimiter,ta=ra.recordTerminator,Ba=ra.inputTerminator,Na=ra.custom,Ra=ra.quoteCharacter,Ca=ra.hasHeaderRow,H=ra.fileEncoding;ra=ra.inputEncoding;this.processCustomCharacters(T);return(0,a.h)(a.Fragment,null,(0,a.h)(m.default,{id:"data-editing-modal"},(0,a.h)("calcite-modal",{"aria-labelledby":"modal-title",open:v,fullscreen:!0,oncalciteModalClose:function(){return f.closeEditingModal("cancel")}},(0,a.h)("h3",
{slot:"header",id:"modal-title"},P),(0,a.h)("div",{slot:"content",class:"data-editing-content"},(0,a.h)("div",{class:"grid-container flex"},(0,a.h)("div",{class:"data-fields-sidebar-menu margin-right-2 flex-0"},r),(0,a.h)("div",{class:"flex-1 leader-1"},(0,a.h)("div",{class:"panel panel-white"},"Fields"===w&&(0,a.h)("div",{class:"overflow-auto"},u),"Geometry"===w&&(0,a.h)("div",{class:"overflow-auto"},(0,a.h)("div",{class:"geometryType"},(0,a.h)("div",null,q),(0,a.h)("label",{class:"padding-left-2"},
(0,a.h)("select",{class:"select-full bdfs-select",name:"geometryTypeValue",disabled:x||"shp"===T.extension?!0:!1,value:q,onChange:this.geometryTypeChange.bind(this)},(0,a.h)("option",{value:"Point"},fa),(0,a.h)("option",{value:"Polyline"},va),(0,a.h)("option",{value:"Polygon"},Aa),(0,a.h)("option",{value:"None"},Ea)))),"None"!==q&&""!==q&&(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"spatialReference"},(0,a.h)("div",null,Q),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("input",{type:"text",name:"spatialReferenceValue",
value:I.wkt||I.wkid,placeholder:Y,onChange:this.geometrySpatialReferenceChange.bind(this),disabled:x||"shp"===T.extension}))),"shp"!==T.extension&&(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"geometryFormatType"},(0,a.h)("div",null,pa),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full bdfs-select",name:"geometryFormatTypeValue",value:O,onChange:this.geometryFormatTypeChange.bind(this),disabled:x},!b.default.includes(["csv","shp"],T.extension)&&(0,a.h)("option",{value:"WKB"},
Z),(0,a.h)("option",{value:"WKT"},V),"Point"===q&&(0,a.h)("option",{value:"XYZ"}," ",N),(0,a.h)("option",{value:"GeoJSON"},ba),(0,a.h)("option",{value:"EsriJSON"},ma),(0,a.h)("option",{value:"EsriShape"},sa)))),(0,a.h)("div",{class:"geometryFields"},(0,a.h)("div",null,M),(0,a.h)("label",{class:"padding-left-2"},U))))),"Time"===w&&(0,a.h)("div",{class:"overflow-auto"},(0,a.h)("form",{name:"time",id:"datasetTimeType"},(0,a.h)("div",{class:"timeType"},(0,a.h)("div",null,L),(0,a.h)("label",{class:"padding-left-2"},
(0,a.h)("select",{class:"select-full bdfs-select",name:"timeType",value:(null===t||void 0===t?void 0:t.timeType)||"none",onChange:this.timeTypeChange.bind(this),disabled:this.state.isReadOnly},(0,a.h)("option",{value:"interval"},aa),(0,a.h)("option",{value:"instant"},wa),(0,a.h)("option",{value:"none"},Ea))))),(null===t||void 0===t?void 0:t.timeType)&&"none"!==t.timeType&&(0,a.h)(a.Fragment,null,"instant"===t.timeType&&(0,a.h)("div",{class:"timeFields"},(0,a.h)("div",null,ca),(0,a.h)("div",{class:"padding-left-2"},
(0,a.h)("table",{class:"table"},(0,a.h)("thead",null,(0,a.h)("tr",null,(0,a.h)("th",null," ",ka," "),(0,a.h)("th",null," ",qa," "),(0,a.h)("th",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",id:"timeInstantButton",onClick:this.addTimeFields.bind(this,"instant"),disabled:x||z},"+"))))),(0,a.h)("tbody",null,E)))),"interval"===t.timeType&&(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"timeFields"},(0,a.h)("div",null,da),(0,a.h)("div",{class:"padding-left-2"},(0,a.h)("table",
{class:"table"},(0,a.h)("thead",null,(0,a.h)("tr",null,(0,a.h)("th",null," ",ka," "),(0,a.h)("th",null," ",qa," "),(0,a.h)("th",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",id:"timeIntervalStartButton",onClick:this.addTimeFields.bind(this,"intervalStart"),disabled:x||z},"+"))))),(0,a.h)("tbody",{class:"intervalStartTbody"},F)))),(0,a.h)("div",{class:"timeFields"},(0,a.h)("div",null,ia),(0,a.h)("div",{class:"padding-left-2"},(0,a.h)("table",{class:"table"},(0,a.h)("thead",
null,(0,a.h)("tr",null,(0,a.h)("th",null," ",ka," "),(0,a.h)("th",null," ",qa," "),(0,a.h)("th",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",id:"timeIntervalEndButton",onClick:this.addTimeFields.bind(this,"intervalEnd"),disabled:x||z},"+"))))),(0,a.h)("tbody",{class:"intervalEndTbody"},D))))),(0,a.h)("div",{class:"timeZone"},(0,a.h)("div",null,ya),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full bdfs-select",name:"timeZone",value:y,onChange:this.timeZoneChange.bind(this),
disabled:x},C)),"custom"===y&&(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("input",{type:"text",name:"customTimeZone",value:G,onChange:this.customTimeZoneChange.bind(this),disabled:x}))))),"File"===w&&(0,a.h)("div",{class:"overflow-auto"},(0,a.h)("div",{class:"fileExtension"},(0,a.h)("div",null,Fa),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("div",{id:"fileExtension"},T.extension))),"csv"===T.extension&&(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"fieldDelimiter"},(0,a.h)("div",null,ea),
(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full bdfs-select",name:"fieldDelimiter",value:T.fieldDelimiter,onChange:this.fieldDelimiterChange.bind(this),disabled:x},(0,a.h)("option",{value:","},","),(0,a.h)("option",{value:"\\t"},"\\t"),(0,a.h)("option",{value:";"},";"),(0,a.h)("option",{value:"'"},"'"),(0,a.h)("option",{value:'"'},'"'),(0,a.h)("option",{value:"|"},"|"),(0,a.h)("option",{value:"/"},"/"),(0,a.h)("option",{value:"\\"},"\\"),(0,a.h)("option",{value:"custom"},
Na))),"custom"===T.fieldDelimiter&&(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("input",{type:"text",name:"customFieldDelimiter",value:T.customFieldDelimiter,onChange:this.customFieldDelimiterChange.bind(this),placeholder:xa,disabled:x}))),(0,a.h)("div",{class:"recordTerminator"},(0,a.h)("div",null,ta),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full bdfs-select",name:"recordTerminator",value:T.recordTerminator,onChange:this.recordTerminatorChange.bind(this),disabled:x},
(0,a.h)("option",{value:"\\t"},"\\t"),(0,a.h)("option",{value:"\\n"},"\\n"),(0,a.h)("option",{value:"\\r"},"\\r"),(0,a.h)("option",{value:"custom"},Na))),"custom"===T.recordTerminator&&(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("input",{type:"text",name:"customRecordTerminator",value:T.customRecordTerminator,onChange:this.customRecordTerminatorChange.bind(this),placeholder:Ba,disabled:x}))),(0,a.h)("div",{class:"quoteCharacter"},(0,a.h)("div",null,Ra),(0,a.h)("label",{class:"padding-left-2"},
(0,a.h)("input",{type:"text",placeholder:"''",name:"quoteCharacter",value:T.quoteChar,onChange:this.quoteCharChange.bind(this),disabled:x}))),(0,a.h)("div",{class:"headRow"},(0,a.h)("div",null,Ca),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("input",{type:"checkbox",name:"headRow",checked:T.hasHeaderRow,onChange:this.hasHeaderRowChange.bind(this),disabled:x}))),(0,a.h)("div",{class:"fileEncoding"},(0,a.h)("div",null,H),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full bdfs-select",
name:"fileEncoding",value:T.encoding,onChange:this.encodingChange.bind(this),disabled:x},(0,a.h)("option",{value:"US-ASCII"},"US-ASCII"),(0,a.h)("option",{value:"UTF-8"},"UTF-8"),(0,a.h)("option",{value:"UTF-16"},"UTF-16"),(0,a.h)("option",{value:"UTF-32"},"UTF-32"),(0,a.h)("option",{value:"ISO-8859-1"},"ISO-8859-1"),(0,a.h)("option",{value:"UTF-16LE"},"UTF-16LE"),(0,a.h)("option",{value:"UTF-16BE"},"UTF-16BE"),(0,a.h)("option",{value:"custom"},Na))),"custom"===T.encoding&&(0,a.h)("label",{class:"padding-left-2"},
(0,a.h)("input",{type:"text",name:"customInputFileEncoding",value:T.customEncoding,onChange:this.customEncodingChange.bind(this),placeholder:ra,disabled:x})))))))),(0,a.h)("div",{class:"padding-left-1"},(0,a.h)("a",{href:this.getHelpLink(),target:"_blank"},(0,a.h)("span",{class:"bdfsHelpIcon"})))),!x&&(0,a.h)("calcite-button",{slot:"secondary",width:"full",disabled:A,onClick:function(){return f.saveEditingModal()}},B?(0,a.h)("div",{style:"display: inline-flex; align-items: center; justify-content: center; width: 100%;"},
(0,a.h)("calcite-loader",{label:"savingManifest",scale:"m",inline:!0,hidden:!B}),(0,a.h)("span",{style:"margin:0 10px"},J)):(0,a.h)("div",null,S)),(0,a.h)("calcite-button",{slot:"primary",width:"full",appearance:"outline",disabled:A,onClick:function(){return f.closeEditingModal("cancel")}},R))))};return h}(a.Component);K.default=e})},"arcgisonline/pages/components/BodyAppender":function(){define(["require","exports","tslib","preact","preact/compat"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",
{value:!0});e=function(m){function n(b){var c=this,d;c=m.call(this,b)||this;c.el=document.createElement("div");c.el.setAttribute("id",b.id);(null===(d=b.classes)||void 0===d?0:d.length)&&c.el.classList.add(b.classes.join(" "));return c}p.__extends(n,m);n.prototype.componentDidMount=function(){document.body.appendChild(this.el)};n.prototype.componentWillUnmount=function(){document.body.removeChild(this.el)};n.prototype.render=function(){return(0,g.createPortal)(this.props.children,this.el)};return n}(a.Component);
K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/AdvancedSettings":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/pages/components/BodyAppender arcgisonline/sharing/util esri/request".split(" "),function(e,K,p,a,g,m,n,b){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);e=function(c){function d(){var l=null!==c&&c.apply(this,arguments)||
this;l.state={manifestJson:"",manifestViewerActive:!1,manifestUploaderActive:!1,isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1,alertIndicatorActive:!1,alertIndicatorColor:"brand",alertIndicatorInfo:"",hintsInfo:"",hintsViewerActive:!1,hintsUploaderActive:!1};return l}p.__extends(d,c);d.prototype.onToggleAdvancedSetting=function(){this.props.onToggleAdvancedSetting(!this.props.shouldDisplayAdvancedSetting)};d.prototype.viewInfo=function(l){"Manifest"===l?this.viewManifest():"Hints"===
l&&this.viewHintsThroughPortal()};d.prototype.uploadInfo=function(l){"Manifest"===l?this.openManifestUploader():"Hints"===l&&this.openHintsUploader()};d.prototype.downloadInfo=function(l){"Manifest"===l?this.downloadManifestThroughPortal():"Hints"===l&&this.downloadHintsThroughPortal()};d.prototype.viewManifest=function(){var l=this.props.viewManifest();this.setState({manifestViewerActive:!0,manifestJson:l})};d.prototype.closeManifestViewModal=function(){this.setState({manifestViewerActive:!1})};
d.prototype.openManifestUploader=function(){this.setState({manifestUploaderActive:!0})};d.prototype.closeManifestUploader=function(){this.setState({manifestUploaderActive:!1})};d.prototype.uploadManifestThroughPortal=function(){var l=this,h=document.getElementById("manifestFile"),f=null===h||void 0===h?void 0:h.files;h=null===f||void 0===f?void 0:f[0];if(0===(null===f||void 0===f?void 0:f.length))this.displayNotificationIndicator(!0,"danger",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.noFileChosen);
else{this.setState({isUploaderButtonDisabled:!0,uploadingProgressIndicatorActive:!0});var r="".concat(this.props.manifestAdminURL,"/update");f=new FileReader;f.readAsText(h,"UTF-8");f.onload=function(q){n.default.request({url:r,content:{fileData:this.result}},{useProxy:n.default.shouldUseProxy(r),usePost:!0}).then(function(t){"success"===t.status?(l.closeManifestUploader(),l.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1}),l.displayNotificationIndicator(!0,"success",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpload.success)):
l.uploadManifestThroughServer()},function(t){l.uploadManifestThroughServer()})}}};d.prototype.uploadManifestThroughServer=function(){var l=this,h=document.getElementById("manifestFile"),f=null===h||void 0===h?void 0:h.files;h=null===f||void 0===f?void 0:f[0];if(0===(null===f||void 0===f?void 0:f.length))this.displayNotificationIndicator(!0,"danger",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.noFileChosen);else{this.setState({isUploaderButtonDisabled:!0,uploadingProgressIndicatorActive:!0});
var r="".concat(this.props.portalURL,"/manifest/update");f=new FileReader;f.readAsText(h,"UTF-8");f.onload=function(t){n.default.request({url:r,content:{fileData:this.result}},{useProxy:n.default.shouldUseProxy(r),usePost:!0}).then(function(w){"success"===w.status?(l.closeManifestUploader(),l.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1}),l.displayNotificationIndicator(!0,"success",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpload.success)):
q(w.error)},function(w){q(w)})};var q=function(t){l.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1});l.displayNotificationIndicator(!0,"danger",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpload.failure)}}};d.prototype.displayNotificationIndicator=function(l,h,f){this.props.displayNotificationIndicator(l,h,f)};d.prototype.downloadManifestThroughPortal=function(){var l=this,h=n.default.getToken(),f="".concat(this.props.manifestAdminURL,"?f\x3djson\x26download\x3dtrue\x26token\x3d").concat(h);
n.default.request({url:this.props.manifestAdminURL,content:{download:!0}},{useProxy:n.default.shouldUseProxy(this.props.manifestAdminURL)}).then(function(r){window.open(f,"_blank")},function(r){l.downloadFileThroughServer("manifest")})};d.prototype.viewHintsThroughPortal=function(){var l=this,h=this.props.hintsAdminURL;(0,b.default)({url:h,content:{read:!0,token:n.default.getToken()},handleAs:"text"},{useProxy:n.default.shouldUseProxy(h),removeFormatProp:!0}).then(function(f){l.handleHintsViewSuccess(f)},
function(f){l.viewHintsThroughServer()})};d.prototype.viewHintsThroughServer=function(){var l=this,h=this.props.portalURL+"/hints";(0,b.default)({url:h,content:{read:!0,token:n.default.getToken()},handleAs:"text"},{useProxy:n.default.shouldUseProxy(h),removeFormatProp:!0}).then(function(f){l.handleHintsViewSuccess(f)},function(f){})};d.prototype.handleHintsViewSuccess=function(l){l=this.createHintsTable(l);this.setState({hintsViewerActive:!0,hintsInfo:l})};d.prototype.createHintsTable=function(l){if(l)return l=
l.trim().split("\n").map(function(h){var f=h.split("\x3d")[0];h=h.split("\x3d")[1];return(0,a.h)("tr",{key:f},(0,a.h)("td",null,f),(0,a.h)("td",null,h))}),l=(0,a.h)("table",{id:"hintsTable"},(0,a.h)("thead",null,(0,a.h)("tr",null,(0,a.h)("th",null,g.default.itemProperties.advancedSettings.hintsTableProperty),(0,a.h)("th",null,g.default.itemProperties.advancedSettings.hintsTableValue))),(0,a.h)("tbody",null,l))};d.prototype.closeHintsViewModal=function(){this.setState({hintsViewerActive:!1})};d.prototype.openHintsUploader=
function(){this.setState({hintsUploaderActive:!0})};d.prototype.closeHintsUploader=function(){this.setState({hintsUploaderActive:!1})};d.prototype.uploadHintsThroughPortal=function(){var l=this,h,f=document.getElementById("hintsFile");0===(null===(h=null===f||void 0===f?void 0:f.files)||void 0===h?void 0:h.length)?this.displayNotificationIndicator(!0,"danger",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.noFileChosen):(h=document.getElementById("hintsUploadWrapper"),this.setState({isUploaderButtonDisabled:!0,
uploadingProgressIndicatorActive:!0}),f="".concat(this.props.hintsAdminURL,"/update"),n.default.request({url:f,form:h},{useProxy:n.default.shouldUseProxy(f),usePost:!0}).then(function(r){"success"===r.status?l.handleHintsUploadSuccess():l.uploadHintsThroughServer()},function(r){l.uploadHintsThroughServer()}))};d.prototype.uploadHintsThroughServer=function(){var l=this,h,f=document.getElementById("hintsFile");if(0===(null===(h=null===f||void 0===f?void 0:f.files)||void 0===h?void 0:h.length))this.displayNotificationIndicator(!0,
"danger",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.noFileChosen);else{h=document.getElementById("hintsUploadWrapper");this.setState({isUploaderButtonDisabled:!0,uploadingProgressIndicatorActive:!0});f="".concat(this.props.portalURL,"/hints/update");n.default.request({url:f,form:h},{useProxy:n.default.shouldUseProxy(f),usePost:!0}).then(function(q){"success"===q.status?l.handleHintsUploadSuccess():r(q.error)},function(q){r(q)});var r=function(q){l.setState({isUploaderButtonDisabled:!1,
uploadingProgressIndicatorActive:!1});l.displayNotificationIndicator(!0,"danger",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.hintsUpload.failure)}}};d.prototype.handleHintsUploadSuccess=function(){this.closeHintsUploader();this.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1});this.displayNotificationIndicator(!0,"success",g.default.itemProperties.notificationIndicator.alertIndicatorInfo.hintsUpload.success)};d.prototype.downloadHintsThroughPortal=function(){var l=
this,h=n.default.getToken(),f="".concat(this.props.hintsAdminURL,"?download\x3dtrue\x26token\x3d").concat(h);n.default.request({url:this.props.hintsAdminURL,content:{download:!0},handleAs:"text"},{useProxy:n.default.shouldUseProxy(this.props.hintsAdminURL),removeFormatProp:!0}).then(function(r){window.open(f,"_blank")},function(r){l.downloadFileThroughServer("hints")})};d.prototype.downloadFileThroughServer=function(l){var h=n.default.getToken();l="".concat(this.props.portalURL,"/").concat(l,"?").concat("manifest"===
l?"f\x3djson\x26":"","download\x3dtrue\x26token\x3d").concat(h);window.open(l,"_blank")};d.prototype.render=function(){var l=this,h=this.state,f=h.manifestViewerActive,r=h.manifestJson,q=h.manifestUploaderActive,t=h.isUploaderButtonDisabled,w=h.uploadingProgressIndicatorActive,u=h.hintsViewerActive,v=h.hintsInfo;h=h.hintsUploaderActive;var x=this.props.shouldDisplayAdvancedSetting,z=[{title:g.default.itemProperties.advancedSettings.manifest,description:g.default.itemProperties.advancedSettings.manifestDescription,
value:"Manifest"},{title:g.default.itemProperties.advancedSettings.hints,description:g.default.itemProperties.advancedSettings.hintsDescription,value:"Hints"}].map(function(A,B){B="".concat(A.title,"_").concat(B);return(0,a.h)("div",{key:B,class:"datasets-manifest"},(0,a.h)("div",{class:"leader-half trailer-half margin-left-quarter"},A.title),(0,a.h)("div",{class:"leader-half trailer-1 margin-left-quarter"},A.description),(0,a.h)("div",{class:"full-width padding-trailer-1 margin-left-quarter"},(0,a.h)("div",
{class:"grid-container"},(0,a.h)("div",{class:"column-9 leader-quarter"},(0,a.h)("div",{class:"leader-quarter margin-right-half margin-left-0 flex flex-1"},(0,a.h)("button",{class:"btn btn-clear btn-fill",onClick:l.viewInfo.bind(l,A.value)}," ",g.default.itemProperties.advancedSettings.view," "),(0,a.h)("button",{class:"btn btn-clear btn-fill",onClick:l.uploadInfo.bind(l,A.value)}," ",g.default.itemProperties.advancedSettings.upload," "),(0,a.h)("button",{class:"btn btn-clear btn-fill",onClick:l.downloadInfo.bind(l,
A.value)}," ",g.default.itemProperties.advancedSettings.download," "))))))});return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"grid-container"},(0,a.h)("div",{class:"column-24 padding-leader-quarter"},(0,a.h)("label",{class:"toggle-switch modifier-class clearfix trailer-0"},(0,a.h)("span",{class:"toggle-switch-label margin-right-1"},g.default.itemProperties.advancedSettings.showAdvanced),(0,a.h)("input",{checked:x,type:"checkbox",name:"userAdvancedSetting",class:"toggle-switch-input",onChange:this.onToggleAdvancedSetting.bind(this)}),
(0,a.h)("span",{class:"toggle-switch-track"})))),(0,a.h)("div",{class:x?"grid-container":"grid-container hide"},(0,a.h)("div",{id:"advancedSettingsSection",class:"column-24 leader-half padding-left-1 padding-right-1"},z)),(0,a.h)(m.default,{id:"manifestViewer"},(0,a.h)("calcite-modal",{"aria-labelledby":"modal-title",open:f,fullscreen:!0,oncalciteModalClose:function(){return l.closeManifestViewModal()}},(0,a.h)("h3",{slot:"header"},g.default.itemProperties.advancedSettings.manifest),(0,a.h)("div",
{slot:"content",class:"manifestViewer"},(0,a.h)("div",null,g.default.itemProperties.advancedSettings.datasetsTitle),(0,a.h)("pre",{id:"manifest"},r)))),(0,a.h)(m.default,{id:"manifestUploader"},(0,a.h)("calcite-modal",{"aria-labelledby":"modal-title",open:q,scale:"m",width:"m",oncalciteModalClose:function(){return l.closeManifestUploader()}},(0,a.h)("h3",{slot:"header"},g.default.itemProperties.advancedSettings.manifestUploaderTitle),(0,a.h)("div",{slot:"content",class:"manifest-uploader-content"},
(0,a.h)("div",{class:"leader-half trailer-half"},g.default.itemProperties.advancedSettings.manifestFileSelectorTitle),(0,a.h)("div",{class:"trailer-half"},(0,a.h)("input",{id:"manifestFile",name:"manifestFile",type:"file",accept:".json, .txt"}))),(0,a.h)("calcite-button",{slot:"secondary",width:"full",disabled:t,onClick:function(){return l.uploadManifestThroughPortal()}},w?(0,a.h)("div",{class:"manifest-uploader-indicator"},(0,a.h)("calcite-loader",{label:"uploadingManifest",scale:"m",inline:!0,hidden:!w}),
(0,a.h)("span",{class:"manifest-uploading-indicator"},g.default.itemProperties.advancedSettings.uploading)):(0,a.h)("div",null,g.default.itemProperties.advancedSettings.upload)),(0,a.h)("calcite-button",{slot:"primary",width:"full",disabled:t,onClick:function(){return l.closeManifestUploader()}},g.default.itemProperties.advancedSettings.cancel))),(0,a.h)(m.default,{id:"hintsViewer"},(0,a.h)("calcite-modal",{"aria-labelledby":"modal-title",open:u,fullscreen:!0,oncalciteModalClose:function(){return l.closeHintsViewModal()}},
(0,a.h)("h3",{slot:"header"},g.default.itemProperties.advancedSettings.hints),(0,a.h)("div",{slot:"content",class:"hintsViewer"},v))),(0,a.h)(m.default,{id:"hintsUploader"},(0,a.h)("calcite-modal",{"aria-labelledby":"modal-title",open:h,scale:"m",width:"m",oncalciteModalClose:function(){return l.closeHintsUploader()}},(0,a.h)("h3",{slot:"header"},g.default.itemProperties.advancedSettings.hintsUploaderTitle),(0,a.h)("div",{slot:"content",class:"hints-uploader-content"},(0,a.h)("div",{class:"leader-half trailer-half"},
g.default.itemProperties.advancedSettings.browseHints),(0,a.h)("div",{class:"trailer-half"},(0,a.h)("form",{id:"hintsUploadWrapper",encType:"multipart/form-data"},(0,a.h)("input",{id:"hintsFile",name:"hints",type:"file",accept:".json, .txt"})))),(0,a.h)("calcite-button",{slot:"secondary",width:"full",disabled:t,onClick:function(){return l.uploadHintsThroughPortal()}},w?(0,a.h)("div",{class:"hints-uploader-indicator"},(0,a.h)("calcite-loader",{label:"uploadingHints",scale:"m",inline:!0,hidden:!w}),
(0,a.h)("span",{class:"hints-uploading-indicator"},g.default.itemProperties.advancedSettings.uploading)):(0,a.h)("div",null,g.default.itemProperties.advancedSettings.upload)),(0,a.h)("calcite-button",{slot:"primary",width:"full",disabled:t,onClick:function(){return l.closeHintsUploader()}},g.default.itemProperties.advancedSettings.cancel))))};return d}(a.Component);K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/NotificationModal":function(){define(["require","exports","tslib",
"preact"],function(e,K,p,a){Object.defineProperty(K,"__esModule",{value:!0});e=function(g){function m(){return null!==g&&g.apply(this,arguments)||this}p.__extends(m,g);m.prototype.componentDidMount=function(){var n=this.props.alertIndicator;this.setState({alertIndicatorActive:n.alertIndicatorActive,alertIndicatorColor:n.alertIndicatorColor,alertIndicatorInfo:n.alertIndicatorInfo})};m.prototype.closeNotificationIndicator=function(){this.setState({alertIndicatorActive:!1});this.props.closeNotificationIndicator(!1)};
m.prototype.render=function(){var n=this.state,b=n.alertIndicatorActive,c=n.alertIndicatorInfo;return(0,a.h)(a.Fragment,null,(0,a.h)("calcite-alert",{class:"display-above",icon:"",label:"notificationIndicator",autoClose:!0,autoCloseDuration:"medium",open:b,scale:"m",kind:n.alertIndicatorColor,"aria-hidden":!b,oncalciteAlertClose:this.closeNotificationIndicator.bind(this)},(0,a.h)("div",{slot:"message"},c)))};return m}(a.Component);K.default=e})},"arcgisonline/pages/item/widgets/_outputs":function(){define("require exports tslib dojo/Deferred arcgisonline/tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase preact arcgisonline/pages/item/components/bigdatafileshare/Outputs".split(" "),
function(e,K,p,a,g,m,n,b,c){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);c=p.__importDefault(c);e=function(){function d(){this.templateString='\x3cdiv class\x3d"outputsWrapper"\x3e\x3cdiv id\x3d"outputsTab"\x3e\x3c/div\x3e\x3cdiv\x3e'}d.prototype.startup=function(){var l=new a.default;l.resolve(!0);return l};d.prototype.destroy=function(){this.inherited(arguments)};d.prototype.postCreate=function(){(0,b.render)((0,b.h)(c.default,
{itemId:this.item.id,url:this.item.url,portalUrl:this.item.portal.url,isOwner:this.item.isOwner,userContentUrl:this.item.portalUser.userContentUrl}),this.domNode.querySelector("#outputsTab"))};return d=p.__decorate([(0,g.default)(n.default,m.default)],d)}();K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/Outputs":function(){define("require exports tslib preact arcgisonline/sharing/util ../../../utils/arrays arcgisonline/pages/utils/clone ./DataSyncing ./DataFiltering ./DatasetsHeader ./OutputTemplatesBody ./DatasetsPagination ./OutputTemplatesEditing ./NotificationModal dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);e=function(t){function w(){var u=null!==t&&t.apply(this,arguments)||this;u.state={isSyncDisabled:!1,templateFilterText:"",templatesStatus:"downloading",templatesForRendering:[],
selectedTemplateItemIDMap:{},matchedTemplateItemNum:0,shouldDisplayDeleteIcon:!1,isDeletingDataset:!1,sortTemplatesByName:!0,templateNameSortOrder:"ascend",sortTemplatesByType:!1,templateTypeSortOrder:"ascend",counts:{start:0,num:0,total:0},itemPerPage:20,shouldDisplayPagination:!1,isManifestActive:!1,outputTemplatesModalActive:!1,sidebarMenu:["Geometry","Time","Files"],activeMenuItem:"Geometry",isSidebarDisabled:!0,activeTemplateIndex:0,activeTemplateName:"",outputTemplatesAction:"edit",isNotificationModalActive:!1,
alertIndicator:{alertIndicatorActive:!1,alertIndicatorColor:"",alertIndicatorInfo:""}};u.dataStoreID="";u.dataStoreType="";u.templatesAdminURL="";u.portalRequestURL="";u.templateResults={};u.globalTemplateFilterText="";u.filterTextLength=0;return u}p.__extends(w,t);w.prototype.componentDidMount=function(){this.generateURLs();this.getRelatedItems()};w.prototype.generateURLs=function(){var u=this.props.url.split("/"),v="".concat(u[0],"//").concat(u[2],"/").concat(u[3]);u=u.filter(function(x){return"bigDataFileShares"===
x.substring(0,17)})[0].split("_");u="".concat(u[0],"/").concat(u.slice(1).join("_"));this.templatesAdminURL=v="".concat(v,"/admin/data/items/").concat(u);v=v.split("/");this.portalRequestURL="".concat(v[0],"//").concat(v[2],":6443/arcgis/admin/data/items/").concat(u)};w.prototype.getRelatedItems=function(){var u=this,v="".concat(this.props.portalUrl,"content/items/").concat(this.props.itemId,"/relatedItems");g.default.request({url:v,content:{relationshipType:"BDFSDataStore2BDFSCatalogService",direction:"reverse"}},
{useProxy:g.default.shouldUseProxy(v)}).then(function(x){x.total?(u.dataStoreType="portalBDFS",m.default.includes(x.relatedItems[0].typeKeyWords,"bigDataFileShare")&&m.default.includes(x.relatedItems[0].typeKeyWords,"dataStore")?(x="".concat(u.props.portalUrl,"content/items/").concat(x.relatedItems[0].id,"/relatedItems"),g.default.request({url:x,content:{relationshipType:"CloudDataStore2BDFSDataStore",direction:"reverse"}},{useProxy:g.default.shouldUseProxy(x)}).then(function(z){u.dataStoreID=z.relatedItems[0].id},
function(z){u.requestOutputTemplatesErrorHandler()})):u.dataStoreID=x.relatedItems[0].id,u.requestPortalBDFSData()):(u.dataStoreType="serverBDFS",u.requestServerBDFSDataByAdmin())},function(x){u.requestOutputTemplatesErrorHandler()})};w.prototype.requestPortalBDFSData=function(){var u=this,v="".concat(this.props.portalUrl,"content/items/").concat(this.dataStoreID,"/data");g.default.request({url:v},{useProxy:g.default.shouldUseProxy(v)}).then(function(x){u.outputTemplatesRequestSuccessHandler(x)},
function(x){u.requestOutputTemplatesErrorHandler()})};w.prototype.requestServerBDFSDataByAdmin=function(){var u=this,v=this.templatesAdminURL;g.default.request({url:v},{useProxy:g.default.shouldUseProxy(v)}).then(function(x){u.dataStoreID=x.id;u.outputTemplatesRequestSuccessHandler(x)},function(x){u.requestServerBDFSDataByPortal()})};w.prototype.requestServerBDFSDataByPortal=function(){var u=this,v=this.portalRequestURL;g.default.request({url:v},{useProxy:g.default.shouldUseProxy(v)}).then(function(x){u.dataStoreID=
x.id;u.outputTemplatesRequestSuccessHandler(x)},function(x){u.requestOutputTemplatesErrorHandler()})};w.prototype.outputTemplatesRequestSuccessHandler=function(u){this.templateResults=(0,n.default)(u);u.info.outputTemplates&&u.info.outputTemplates.length?(u=u.info.outputTemplates,u.forEach(function(v){v.isItemFiltered=!0}),this.setState({templatesStatus:"success",templatesForRendering:(0,n.default)(u),shouldDisplayPagination:!0,isSyncDisabled:!1,counts:{start:1,num:this.state.itemPerPage,total:u.length}})):
this.requestOutputTemplatesErrorHandler()};w.prototype.requestOutputTemplatesErrorHandler=function(){this.setState({templatesStatus:"fail",shouldDisplayPagination:!1,counts:{start:0,num:0,total:0}})};w.prototype.requestOutputTemplates=function(u){"portal sharing api"===u?this.requestPortalBDFSData():"admin"===u?this.requestServerBDFSDataByAdmin():"portal"===u&&this.requestServerBDFSDataByPortal()};w.prototype.addNewTemplates=function(u){this.setState({isManifestActive:!0,outputTemplatesAction:"add",
isSyncDisabled:u})};w.prototype.disableSyncOutputTemplates=function(u){this.setState({isSyncDisabled:u})};w.prototype.openEditingModal=function(u){this.setState({isManifestActive:!0,outputTemplatesAction:"edit",activeTemplateName:u})};w.prototype.selectTemplateItem=function(u){var v=(0,n.default)(this.state.selectedTemplateItemIDMap),x=!1;v[u]?(delete v[u],this.state.templatesForRendering.forEach(function(z){z.isItemFiltered&&m.default.includes(Object.keys(v),z.name)&&(x=!0)})):(v[u]=u,x=!0);this.setState({selectedTemplateItemIDMap:v,
shouldDisplayDeleteIcon:x})};w.prototype.flipSortOrder=function(u){"name"===u?this.state.sortTemplatesByName?this.setState({templateNameSortOrder:"ascend"===this.state.templateNameSortOrder?"descend":"ascend"}):this.setState({sortTemplatesByName:!0,sortTemplatesByType:!1}):"type"===u&&(this.state.sortTemplatesByType?this.setState({templateTypeSortOrder:"ascend"===this.state.templateTypeSortOrder?"descend":"ascend"}):this.setState({sortTemplatesByName:!1,sortTemplatesByType:!0}))};w.prototype.removePropertyBeforeSave=
function(u){u.forEach(function(v){delete v.isItemFiltered;delete v.isItemOnCurrentPage});return u};w.prototype.deleteTemplateItem=function(u){var v=this;this.setState({isDeletingDataset:u});var x=(0,n.default)(this.state.templatesForRendering),z=this.state.matchedTemplateItemNum,A=(0,n.default)(this.state.selectedTemplateItemIDMap);if(2<this.filterTextLength){x=x.filter(function(F){return F.isItemFiltered&&A[F.name]?(z--,delete A[F.name],!1):!0});var B=z;var J="success"}else u=x.length-Object.keys(A).length,
x=x.filter(function(F){return A[F.name]?(delete A[F.name],!1):!0}),B=u,J=0===B?"deleted":this.state.templatesStatus;this.templateResults.info.outputTemplates=this.removePropertyBeforeSave((0,n.default)(x));u="portalBDFS"===this.dataStoreType?"".concat(this.props.userContentUrl,"/items/").concat(this.dataStoreID,"/update"):"".concat(this.templatesAdminURL,"/edit");var P="portalBDFS"===this.dataStoreType?{text:JSON.stringify(this.templateResults)}:{item:JSON.stringify(this.templateResults)};g.default.request({url:u,
content:P},{useProxy:g.default.shouldUseProxy(u),usePost:!0}).then(function(F){"portalBDFS"===v.dataStoreType?F.success?R():I():"success"===F.status?(E(),v.requestServerBDFSDataByAdmin()):T()},function(F){T()});var R=function(){var F="".concat(v.props.portalUrl,"portals/self/servers");g.default.request({url:F},{useProxy:g.default.shouldUseProxy(F)}).then(function(D){(null===D||void 0===D?0:D.servers)?D.servers.some(function(C){-1<C.serverFunction.indexOf("GeoAnalytics")&&S(C.id);return-1<C.serverFunction.indexOf("GeoAnalytics")}):
I()},function(D){I()})},S=function(F){var D="".concat(v.props.portalUrl,"portals/self/datastores/refreshServer");g.default.request({url:D,content:{datastoreId:v.dataStoreID,serverId:F}},{useProxy:g.default.shouldUseProxy(D),usePost:!0}).then(function(C){C.success?(E(),v.requestPortalBDFSData()):I()},function(C){I()})},T=function(){var F="".concat(v.portalRequestURL,"/edit");g.default.request({url:F,content:P},{useProxy:g.default.shouldUseProxy(F),usePost:!0}).then(function(D){"success"===D.status?
(E(),v.requestServerBDFSDataByPortal()):I()},function(D){I()})},E=function(){v.displayNotificationIndicator(!0,"success",q.default.itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateDelete.success);var F=0===B?0:v.state.counts.num,D=v.recalculatePagination(B,F);v.setState({templatesForRendering:x,templatesStatus:J,counts:{start:D.start,num:F,total:B},matchedTemplateItemNum:z,selectedTemplateItemIDMap:A,shouldDisplayPagination:D.shouldDisplayPagination,shouldDisplayDeleteIcon:!1,
isDeletingDataset:!1})},I=function(){v.displayNotificationIndicator(!0,"danger",q.default.itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateDelete.failure);v.setState({templatesForRendering:v.state.templatesForRendering,isDeletingDataset:!1})}};w.prototype.onFilterChanged=function(u){var v=this,x=u.trim();this.filterTextLength=x.length;2>=this.filterTextLength&&(x="");if(x!==this.globalTemplateFilterText){this.globalTemplateFilterText=x;x=(0,n.default)(this.state.templatesForRendering);
var z=this.filterTemplateSource(x);x=z.templatesForRendering;z=z.filteredTemplates.length;var A=0===z?0:this.state.itemPerPage;var B=this.recalculatePagination(z,A),J=B.shouldDisplayPagination;B={start:B.start,num:A,total:z};this.globalTemplateFilterText?(x=this.processFilteredResults(x),A="success"):(A=0===z?"deleted":this.state.templatesStatus,B.total=z);var P=!1;x.forEach(function(R){R.isItemFiltered&&m.default.includes(Object.keys(v.state.selectedTemplateItemIDMap),R.name)&&(P=!0)});this.setState({counts:B,
templateFilterText:u,templatesStatus:A,templatesForRendering:(0,n.default)(x),matchedTemplateItemNum:z,shouldDisplayPagination:J,shouldDisplayDeleteIcon:P})}else this.setState({templateFilterText:u})};w.prototype.filterTemplateSource=function(u){var v=this,x=u.filter(function(z){return v.doesFilterMatch(z)});return{templatesForRendering:u,filteredTemplates:x}};w.prototype.doesFilterMatch=function(u){if(this.globalTemplateFilterText){var v=this.globalTemplateFilterText.split(" ");u.isItemFiltered=
v.some(function(x){return-1<u.name.toLowerCase().indexOf(x.toLocaleLowerCase())})}else u.isItemFiltered=!0;return u.isItemFiltered};w.prototype.processFilteredResults=function(u){var v=[],x=0,z=u.length-1;u.forEach(function(A){A.isItemFiltered?(v[x]=A,x++):(v[z]=A,z--)});return v};w.prototype.changePage=function(u){this.setState({counts:u})};w.prototype.setItemPerPage=function(u){var v=this.state.counts.total;u=0===v?0:Number(u);v={start:this.recalculatePagination(v,u).start,num:u,total:v};this.setState({itemPerPage:u,
counts:v})};w.prototype.recalculatePagination=function(u,v){if(0===u)return{start:0,shouldDisplayPagination:!1};var x=Math.ceil(this.state.counts.start/this.state.counts.num);return{start:Math.ceil(u/v)>=x?(x-1)*v+1:1,shouldDisplayPagination:!0}};w.prototype.closeEditingModal=function(u){this.setState({isManifestActive:u})};w.prototype.updateManifest=function(u){this.setState({templatesForRendering:u})};w.prototype.displayNotificationIndicator=function(u,v,x){this.setState({isNotificationModalActive:!0,
alertIndicator:{alertIndicatorActive:u,alertIndicatorColor:v,alertIndicatorInfo:x}})};w.prototype.closeNotificationIndicator=function(u){this.setState({isNotificationModalActive:u})};w.prototype.render=function(){var u=this.state,v=u.isSyncDisabled,x=u.templatesStatus,z=u.templatesForRendering,A=u.templateFilterText,B=u.shouldDisplayDeleteIcon,J=u.isDeletingDataset,P=u.counts,R=u.selectedTemplateItemIDMap,S=u.sortTemplatesByName,T=u.templateNameSortOrder,E=u.sortTemplatesByType,I=u.templateTypeSortOrder,
F=u.outputTemplatesAction,D=u.isManifestActive,C=u.shouldDisplayPagination,y=u.itemPerPage,G=u.activeTemplateName,L=u.isSidebarDisabled,O=u.alertIndicator;u=u.isNotificationModalActive;var U=this.props.isOwner;return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"outputTemplatesHeader"},(0,a.h)("div",{class:"grid-container"},(0,a.h)("div",{class:"column-24 flex"},U&&(0,a.h)(b.default,{entryComponent:"outputs",isSyncDisabled:v,syncDatasets:this.addNewTemplates.bind(this)}),(0,a.h)(c.default,{page:"Outputs",
datasetsStatus:x,datasetsForRendering:z,dataFilterText:A,onFilterChanged:this.onFilterChanged.bind(this)})))),(0,a.h)("div",{class:"grid-container"},(0,a.h)(d.default,{isOwner:U,shouldDisplayDeleteIcon:B,isDeletingDataset:J,counts:P,deleteDatasetItem:this.deleteTemplateItem.bind(this)}),(0,a.h)(l.default,{templatesStatus:x,templatesForRendering:z,counts:P,selectedTemplateItemIDMap:R,sortTemplatesByName:S,templateNameSortOrder:T,sortTemplatesByType:E,templateTypeSortOrder:I,openEditingModal:this.openEditingModal.bind(this),
selectTemplateItem:this.selectTemplateItem.bind(this),flipSortOrder:this.flipSortOrder.bind(this)})),(0,a.h)(h.default,{shouldDisplayPagination:C,counts:P,itemPerPage:y,changePage:this.changePage.bind(this),setItemPerPage:this.setItemPerPage.bind(this)}),D&&(0,a.h)(f.default,{isOwner:U,dataStoreType:this.dataStoreType,portalUrl:this.props.portalUrl,portalRequestURL:this.portalRequestURL,userContentUrl:this.props.userContentUrl,dataStoreID:this.dataStoreID,activeTemplateName:G,isSidebarDisabled:L,
templatesStatus:x,templatesForRendering:z,templatesAdminURL:this.templatesAdminURL,templateResults:this.templateResults,outputTemplatesAction:F,disableSyncOutputTemplates:this.disableSyncOutputTemplates.bind(this),requestOutputTemplates:this.requestOutputTemplates.bind(this),displayNotificationIndicator:this.displayNotificationIndicator.bind(this),closeOutputTemplatesModal:this.closeEditingModal.bind(this),updateManifest:this.updateManifest.bind(this)}),u&&(0,a.h)(r.default,{alertIndicator:O,closeNotificationIndicator:this.closeNotificationIndicator.bind(this)}))};
return w}(a.Component);K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/OutputTemplatesBody":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);e=function(m){function n(){return null!==m&&m.apply(this,arguments)||this}p.__extends(n,m);n.prototype.sortTemplates=function(b){var c=this;if(!this.props.sortTemplatesByName&&!this.props.sortTemplatesByType)return b;
b.sort(function(d,l){var h,f,r,q;if(d.isItemFiltered&&l.isItemFiltered)return d=null===(f=c.props.sortTemplatesByName?d.name:null===(h=d.format)||void 0===h?void 0:h.type)||void 0===f?void 0:f.toLowerCase(),l=null===(q=c.props.sortTemplatesByName?l.name:null===(r=l.format)||void 0===r?void 0:r.type)||void 0===q?void 0:q.toLowerCase(),r=c.props.sortTemplatesByName?c.props.templateNameSortOrder:c.props.templateTypeSortOrder,d>l?"ascend"===r?1:-1:d<l?"ascend"===r?-1:1:0});return b};n.prototype.processTemplates=
function(b){var c=this;return b.map(function(d,l){l=l>=c.props.counts.start-1&&l<c.props.counts.start+c.props.counts.num-1;return p.__assign(p.__assign({},d),{isItemOnCurrentPage:l})})};n.prototype.flipSortOrder=function(b){this.props.flipSortOrder(b)};n.prototype.generateSortStylings=function(){var b=function(c,d){return(0,a.h)("div",{class:"output-template-sort output-template-sort--".concat(d||"descend"," ").concat(c?"":"hide")})};return{sortDivByName:b(this.props.sortTemplatesByName,this.props.templateNameSortOrder),
sortDivByType:b(this.props.sortTemplatesByType,this.props.templateTypeSortOrder)}};n.prototype.displayTemplateTypeLabel=function(b){return g.default.itemProperties.datasetsManifest.file[b]};n.prototype.createTemplatesTSX=function(b,c){var d=this;b=this.sortTemplates(b);b=this.processTemplates(b).map(function(f){var r=f.isItemFiltered&&f.isItemOnCurrentPage?"":" hide",q=d.props.selectedTemplateItemIDMap[f.name]?!0:!1,t=d.displayTemplateTypeLabel(f.format.type);return(0,a.h)("div",{key:f.name,class:"datasets-table-row".concat(r),
role:"row"},(0,a.h)("label",{class:"datasets-table-cell datasets-table-checkbox",role:"cell"},(0,a.h)("input",{type:"checkbox",checked:q,"aria-label":"Select Item",onChange:d.selectTemplateItem.bind(d,f.name)})),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-medium",role:"cell"},(0,a.h)("span",{class:"datasets-table-cell-name"},f.name)),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-medium",role:"cell"},(0,a.h)("span",{class:"datasets-table-cell-name"},t)),(0,a.h)("span",
{class:"datasets-table-cell datasets-table-cell-medium datasets-table-edit",onClick:d.openEditingModal.bind(d,f.name),role:"cell"},(0,a.h)("calcite-icon",{class:"icon-ui-edit"}),(0,a.h)("span",null,g.default.itemProperties.datasetsTable.edit)))});var l=this.generateSortStylings(),h=l.sortDivByName;l=l.sortDivByType;b=(0,a.h)("div",{key:"outputTemplateskey",class:"datasets-table"},(0,a.h)("div",{class:"datasets-table-head",role:"rowgroup"},(0,a.h)("div",{class:"datasets-table-row datasets-table-row-header",
role:"row"},(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-th datasets-table-cell-extra-small",role:"columnheader"},(0,a.h)("div",{class:"datasets-table-cell-sort"})),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",role:"columnheader",onClick:this.flipSortOrder.bind(this,"name")},(0,a.h)("div",{class:"datasets-table-cell-sort".concat(this.props.sortTemplatesByName?" output-templates-table-header":"")},g.default.itemProperties.datasetsTable.dataset),
h),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",role:"columnheader",onClick:this.flipSortOrder.bind(this,"type")},(0,a.h)("div",{class:"datasets-table-cell-sort".concat(this.props.sortTemplatesByType?" output-templates-table-header":"")},g.default.itemProperties.datasetsTable.type),l),(0,a.h)("span",{class:"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",role:"columnheader"},(0,a.h)("div",{class:"datasets-table-cell-sort"},g.default.itemProperties.datasetsTable.operation)))),
(0,a.h)("div",{class:"datasets-table-rows",role:"rowgroup"},b));h="";"downloading"===c?h=g.default.itemProperties.datasetsTable.datasetsStatusMessage.downloading:"fail"===c?h=g.default.itemProperties.datasetsTable.datasetsStatusMessage.fail:"success"===c?0===this.props.counts.total&&(b=(0,a.h)("div",{class:"text-center leader-1 text-constrain margin-auto"},g.default.itemProperties.datasetsTable.datasetsStatusMessage.success)):"deleted"===c&&(b=(0,a.h)("div",{class:"text-center leader-1 text-constrain margin-auto"},
g.default.itemProperties.datasetsTable.datasetsStatusMessage.deleted));""!==h&&(b=(0,a.h)("div",{class:"padding-leader-half"},(0,a.h)("em",null,h)));return b};n.prototype.selectTemplateItem=function(b){this.props.selectTemplateItem(b)};n.prototype.openEditingModal=function(b){this.props.openEditingModal(b)};n.prototype.render=function(){var b=this.props;b=this.createTemplatesTSX(b.templatesForRendering,b.templatesStatus);return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"column-24 padding-leader-half padding-trailer-5 templates-table-wrapper"},
b))};return n}(a.Component);K.default=e})},"arcgisonline/pages/item/components/bigdatafileshare/OutputTemplatesEditing":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/pages/components/BodyAppender arcgisonline/sharing/util ../../../utils/arrays arcgisonline/pages/utils/clone".split(" "),function(e,K,p,a,g,m,n,b,c){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);
c=p.__importDefault(c);e=function(d){function l(){var h=null!==d&&d.apply(this,arguments)||this;h.state={templatesForRendering:[],templatesStatus:"downloading",activeTemplateIndex:0,modalActive:!1,isSidebarDisabled:!0,sidebarMenu:[{label:g.default.itemProperties.datasetsManifest.sidebarMenu.geometry,value:"Geometry"},{label:g.default.itemProperties.datasetsManifest.sidebarMenu.time,value:"Time"}],activeMenuItem:"Geometry",isModalButtonDisabled:!1,progressIndicatorActive:!1,isReadOnly:!h.props.isOwner,
isTimeErrorActive:!1,isGeometryErrorActive:!1,disableInstantAddButton:!0,disableIntervalStartAddButton:!0,disableIntervalEndAddButton:!0};h.templateResults={};h.originalOutputTemplates=[];h.hasTimeValidationError=!1;h.hasGeometryValidationError=!1;return h}p.__extends(l,d);l.prototype.componentDidMount=function(){var h=this.preprocessTimeProperty((0,c.default)(this.props.templatesForRendering));h=this.preprocessGeometryProperty(h);this.templateResults=(0,c.default)(this.props.templateResults);this.originalOutputTemplates=
(0,c.default)(h);this.setState({isSidebarDisabled:this.props.isSidebarDisabled,templatesForRendering:h,templatesStatus:this.props.templatesStatus});"edit"===this.props.outputTemplatesAction?this.openEditingModal(this.props.activeTemplateName,h):this.addOutputTemplates(h);this.props.disableSyncOutputTemplates(!1)};l.prototype.addOutputTemplates=function(h){var f={name:"Template Example",title:"Template Example",format:{}};f.format.type="delimited";f.isItemFiltered=!1;h=(0,c.default)(h);h.push(f);h=
this.preprocessGeometryProperty(h);h=this.preprocessTimeProperty(h);this.renderEditingModal(h.length-1,h,"Geometry","add")};l.prototype.preprocessGeometryProperty=function(h){var f=this;h.forEach(function(r,q){r.geometry||(r.geometry={});r.geometry.spatialReference||(r.geometry.spatialReference={},r.geometry.spatialReference.wkid="");if(!r.geometry.encodings){r.geometry.encodings=[];var t=[{name:"",formats:[]}];["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"].forEach(function(R){var S=
[];S=[R];r.geometry.encodings.push({types:S,fields:t})})}if(3===r.geometry.encodings.length)q=r.geometry.encodings,q.forEach(function(R){"esriGeometryPoint"===R.types[0]&&2===R.fields.length&&f.organizePointXYZField(R)});else if(2===r.geometry.encodings.length){q=(0,c.default)(r.geometry.encodings);var w,u=["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"],v=[],x=[];r.geometry.encodings.forEach(function(R){2===R.types.length&&(w=R);R.types.forEach(function(S){x.push(S)})});u.forEach(function(R){-1===
x.indexOf(R)&&v.push(R)});2===x.length?(r.geometry.encodings=[],v.forEach(function(R){r.geometry.encodings.push({types:[R],fields:[{name:"",formats:[]}]})}),q.forEach(function(R){if(1===R.fields.length)var S={types:[R.types[0]],fields:[{name:R.fields[0].name?R.fields[0].name:"",formats:[R.fields[0].formats[0]]}]};else 3===R.fields.length?S={types:[R.types[0]],fields:[{name:R.fields[0].name?R.fields[0].name:"",formats:[R.fields[0].formats[0]]},{name:R.fields[1].name?R.fields[1].name:"",formats:[R.fields[1].formats[0]]},
{name:R.fields[2].name?R.fields[2].name:"",formats:[R.fields[2].formats[0]]}]}:2===R.fields.length&&(f.organizePointXYZField(R),S=R);r.geometry.encodings.push(S)})):3===x.length&&(r.geometry.encodings=[],q=q.filter(function(R){return 2===R.types.length?!1:!0}),w.types.forEach(function(R){r.geometry.encodings.push({types:[R],fields:[{name:w.fields[0].name?w.fields[0].name:"",formats:[w.fields[0].formats[0]]}]})}),q.forEach(function(R){if(1===R.fields.length)var S={types:[R.types[0]],fields:[{name:R.fields[0].name?
R.fields[0].name:"",formats:[R.fields[0].formats[0]]}]};else 3===R.fields.length?S={types:[R.types[0]],fields:[{name:R.fields[0].name?R.fields[0].name:"",formats:[R.fields[0].formats[0]]},{name:R.fields[1].name?R.fields[1].name:"",formats:[R.fields[1].formats[0]]},{name:R.fields[2].name?R.fields[2].name:"",formats:[R.fields[2].formats[0]]}]}:2===R.fields.length&&(f.organizePointXYZField(R),S=R);r.geometry.encodings.push(S)}))}else if(1===r.geometry.encodings.length){var z=r.geometry.encodings[0].types,
A=r.geometry.encodings[0].fields;if(3===z.length)r.geometry.encodings=[],["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"].forEach(function(R){var S=[];S=[R];r.geometry.encodings.push({types:S,fields:[{name:A[0].name?A[0].name:"",formats:[A[0].formats[0]]}]})});else if(2===z.length||1===z.length&&1===A.length){r.geometry.encodings=[];var B=[{name:A[0].name?A[0].name:"",formats:[A[0].formats[0]]}];u=["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"];var J=u.filter(function(R){return-1<
z.indexOf(R)?!1:!0});u.forEach(function(R){if(-1===J.indexOf(R)){var S=[];S=[R];r.geometry.encodings.push({types:S,fields:B})}});J.forEach(function(R){r.geometry.encodings.push({types:[R],fields:[{name:"",formats:[]}]})})}else if(1===z.length&&3===A.length){r.geometry.encodings=[];u=["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"];var P=u.filter(function(R){return-1<z.indexOf(R)?!1:!0});u.forEach(function(R){if(-1===P.indexOf(R)){var S=[];S=[R];r.geometry.encodings.push({types:S,
fields:[{name:A[0].name?A[0].name:"",formats:[A[0].formats[0]]},{name:A[1].name?A[1].name:"",formats:[A[1].formats[0]]},{name:A[2].name?A[2].name:"",formats:[A[2].formats[0]]}]})}});P.forEach(function(R){r.geometry.encodings.push({types:[R],fields:[{name:"",formats:[]}]})})}else 1===z.length&&2===A.length&&f.organizePointXYZField(r.geometry.encodings[0])}});return h};l.prototype.organizePointXYZField=function(h){h.fields.push({name:"",formats:["z"]})};l.prototype.preprocessTimeProperty=function(h){var f=
this;h.forEach(function(r){r.time||(r.time={});r.time.timeReference||(r.time.timeReference={},r.time.timeReference.timeZone="UTC");r.time.encodings||(r.time.encodings=[],r=f.constructTimeInstantProperty(r),r=f.constructTimeIntervalProperty(r));if(1===r.time.encodings.length)if("instant"===r.time.encodings[0].types[0])r=f.constructTimeIntervalProperty(r);else{var q=[];r.time.encodings[0].fields.forEach(function(w){b.default.includes(q,w.role)||q.push(w.role)});1===q.length&&(b.default.includes(q,"start")?
f.constructTimeIntervalFields(r,0,"end"):f.constructTimeIntervalFields(r,0,"start"));r=f.constructTimeInstantProperty(r)}else if(2===r.time.encodings.length){var t=[];r.time.encodings.forEach(function(w,u){b.default.includes(w.types,"interval")&&(w.fields.forEach(function(v){b.default.includes(t,v.role[0])||t.push(v.role[0])}),1===t.length&&(b.default.includes(t,"start")?f.constructTimeIntervalFields(r,u,"end"):f.constructTimeIntervalFields(r,u,"start")))})}});return h};l.prototype.constructTimeInstantProperty=
function(h){var f={types:[]};f.types.push("instant");f.fields=[];f.fields.push({name:"",formats:[]});h.time.encodings.push(f);return h};l.prototype.constructTimeIntervalProperty=function(h){var f={types:[]};f.types.push("interval");f.fields=[];f.fields.push({name:"",formats:[],role:["start"]});f.fields.push({name:"",formats:[],role:["end"]});h.time.encodings.push(f);return h};l.prototype.constructTimeIntervalFields=function(h,f,r){var q={name:"",formats:[]};q.role=[r];h.time.encodings[f].fields.push(q);
return h};l.prototype.openEditingModal=function(h,f){var r=0;(0,c.default)(f).forEach(function(q,t){q.name===h&&(r=t)});this.renderEditingModal(r,f,this.state.activeMenuItem,"edit")};l.prototype.renderEditingModal=function(h,f,r,q){this.setState({modalActive:!0,activeTemplateIndex:h,templatesForRendering:f,activeMenuItem:r,isModalButtonDisabled:!1})};l.prototype.closeOutputTemplatesModal=function(h){if(this.state.modalActive){var f=[];"save"===h?(f=(0,c.default)(this.state.templatesForRendering),
this.originalOutputTemplates=(0,c.default)(this.state.templatesForRendering)):f=(0,c.default)(this.originalOutputTemplates);this.setState({modalActive:!1,activeMenuItem:"Geometry",templatesForRendering:f,isTimeErrorActive:!1,isGeometryErrorActive:!1})}this.props.closeOutputTemplatesModal(!1)};l.prototype.removePropertyBeforeSave=function(h){h.forEach(function(f){delete f.isItemFiltered;delete f.isItemOnCurrentPage});return h};l.prototype.saveOutputTemplatesModal=function(){var h=this;if(this.hasTimeValidationError||
this.hasGeometryValidationError)this.setState({isTimeErrorActive:this.hasTimeValidationError,isGeometryErrorActive:this.hasGeometryValidationError});else{this.setState({isModalButtonDisabled:!0,progressIndicatorActive:!0,isTimeErrorActive:!1,isGeometryErrorActive:!1});var f=this.removePropertyBeforeSave((0,c.default)(this.state.templatesForRendering));this.templateResults.info.outputTemplates=this.removeEmptyProperty(f);f="portalBDFS"===this.props.dataStoreType?"".concat(this.props.userContentUrl,
"/items/").concat(this.props.dataStoreID,"/update"):"".concat(this.props.templatesAdminURL,"/edit");var r="portalBDFS"===this.props.dataStoreType?{text:JSON.stringify(this.templateResults)}:{item:JSON.stringify(this.templateResults)};n.default.request({url:f,content:r},{useProxy:n.default.shouldUseProxy(f),usePost:!0}).then(function(x){"portalBDFS"===h.props.dataStoreType?x.success?q():v():"success"===x.status?(u(),h.props.requestOutputTemplates("admin")):w()},function(x){w()});var q=function(){var x=
"".concat(h.props.portalUrl,"portals/self/servers");n.default.request({url:x},{useProxy:n.default.shouldUseProxy(x)}).then(function(z){(null===z||void 0===z?0:z.servers)?z.servers.some(function(A){-1<A.serverFunction.indexOf("GeoAnalytics")&&t(A.id);return-1<A.serverFunction.indexOf("GeoAnalytics")}):v()},function(z){v()})},t=function(x){var z="".concat(h.props.portalUrl,"portals/self/datastores/refreshServer");n.default.request({url:z,content:{datastoreId:h.props.dataStoreID,serverId:x}},{useProxy:n.default.shouldUseProxy(z),
usePost:!0}).then(function(A){A.success?(u(),h.props.requestOutputTemplates("portal sharing api")):v()},function(A){v()})},w=function(){var x="".concat(h.props.portalRequestURL,"/edit");n.default.request({url:x,content:r},{useProxy:n.default.shouldUseProxy(x),usePost:!0}).then(function(z){"success"===z.status?(u(),h.props.requestOutputTemplates("portal")):v()},function(z){v()})},u=function(){h.props.updateManifest(h.state.templatesForRendering);h.closeOutputTemplatesModal("save");h.setState({isModalButtonDisabled:!1,
progressIndicatorActive:!1});h.props.displayNotificationIndicator(!0,"success","edit"===h.props.outputTemplatesAction?g.default.itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateUpdate.success:g.default.itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateAdd.success)},v=function(){h.setState({isModalButtonDisabled:!1,progressIndicatorActive:!1,templatesForRendering:h.state.templatesForRendering});h.props.displayNotificationIndicator(!0,"danger","edit"===h.props.outputTemplatesAction?
g.default.itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateUpdate.failure:g.default.itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateAdd.failure)}}};l.prototype.checkSidebarItem=function(h,f){f.preventDefault();this.renderEditingModal(this.state.activeTemplateIndex,this.state.templatesForRendering,h,this.props.outputTemplatesAction)};l.prototype.convertFromEsriGeometryType=function(h){var f,r;h=null===(r=null===(f=null===h||void 0===h?void 0:h[0])||void 0===
f?void 0:f.types)||void 0===r?void 0:r[0];return"esriGeometryPoint"===h?g.default.itemProperties.datasetsManifest.geometry.point:"esriGeometryPolyline"===h?g.default.itemProperties.datasetsManifest.geometry.polyline:"esriGeometryPolygon"===h?g.default.itemProperties.datasetsManifest.geometry.polygon:g.default.itemProperties.datasetsManifest.geometry.none};l.prototype.convertToEsriGeometryType=function(h){return h===g.default.itemProperties.datasetsManifest.geometry.point?"esriGeometryPoint":h===g.default.itemProperties.datasetsManifest.geometry.polyline?
"esriGeometryPolyline":h===g.default.itemProperties.datasetsManifest.geometry.polygon?"esriGeometryPolygon":g.default.itemProperties.datasetsManifest.geometry.none};l.prototype.retrieveTemplateProperty=function(h,f,r){if(f[h]){var q=f[h];h=q.format;f=q.geometry;r=q.name;var t=q.time;q=null===f||null===f.encodings?"None":this.convertFromEsriGeometryType(f.encodings);t=this.initializeTimeProperty(t);var w=t.timeInstantArr,u=t.timeIntervalStartArr,v=t.timeIntervalEndArr;return{templateName:r,geometry:f,
geometryType:q,timeInstantArr:w,timeIntervalStartArr:u,timeIntervalEndArr:v,timeZone:t.timeZone,fileFormat:h}}f={};w=[];u=[];v=[];h={};return{templateName:"",geometry:f,geometryType:"None",timeInstantArr:w,timeIntervalStartArr:u,timeIntervalEndArr:v,timeZone:"",fileFormat:h}};l.prototype.templateNameChange=function(h){h=h.target;var f=this.getTemplatesAndEncodings().outputTemplates;f[this.state.activeTemplateIndex].name=h.value;f[this.state.activeTemplateIndex].title=h.value;this.setState({templatesForRendering:f})};
l.prototype.createTemplatesPropertyMenu=function(h){var f=this;return h.map(function(r,q){return(0,a.h)("button",{key:q,class:"btn-link btn-link-darker-gray font-size--1 data-property-sidebar-menu-item"+(f.state.activeMenuItem===r.value?" data-property-sidebar-menu-item--active":""),onClick:f.checkSidebarItem.bind(f,r.value)},r.label)})};l.prototype.checkGeometryError=function(h,f){f=null===f||void 0===f?void 0:f.some(function(r){var q;return null===(q=null===r||void 0===r?void 0:r.fields)||void 0===
q?void 0:q.some(function(t){var w,u;return(null===(w=null===t||void 0===t?void 0:t.formats)||void 0===w?void 0:w[0])&&"None"!==(null===(u=null===t||void 0===t?void 0:t.formats)||void 0===u?void 0:u[0])})});return""===(null===h||void 0===h?void 0:h.wkid)&&f};l.prototype.createGeometryTSX=function(h){var f=h.spatialReference;h=h.encodings;this.hasGeometryValidationError=this.checkGeometryError(f,h);return{geometrySpatialReference:f,encodings:h}};l.prototype.spatialReferenceChange=function(h){var f=
this.getTemplatesAndEncodings().outputTemplates,r=f[this.state.activeTemplateIndex].geometry.spatialReference;r||(r={});h=h.target.value;isNaN(parseFloat(h))?(delete r.wkid,r.wkt=h):(delete r.wkt,r.wkid=Number(h));this.setState({templatesForRendering:f})};l.prototype.pointGeometryFormatTypeChange=function(h){h=h.target;var f=this.getTemplatesAndEncodings().outputTemplates,r=[];"XYZ"===h.value?(r.push({name:"",formats:["x"]}),r.push({name:"",formats:["y"]}),r.push({name:"",formats:["z"]})):r.push({name:"",
formats:[h.value]});f[this.state.activeTemplateIndex].geometry.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPoint")&&(q.fields=r)});this.setState({templatesForRendering:f})};l.prototype.geometryFieldXChange=function(h){var f=h.target;h=this.getTemplatesAndEncodings();var r=h.outputTemplates;h.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPoint")&&(q.fields[0].name=f.value)});this.setState({templatesForRendering:r})};l.prototype.geometryFieldYChange=function(h){var f=
h.target;h=this.getTemplatesAndEncodings();var r=h.outputTemplates;h.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPoint")&&(q.fields[1].name=f.value)});this.setState({templatesForRendering:r})};l.prototype.geometryFieldZChange=function(h){var f=h.target;h=this.getTemplatesAndEncodings();var r=h.outputTemplates;h.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPoint")&&(q.fields[2].name=f.value)});this.setState({templatesForRendering:r})};l.prototype.geometryFieldNonXYZChange=
function(h){var f=h.target;h=this.getTemplatesAndEncodings();var r=h.outputTemplates;h.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPoint")&&(q.fields[0].name=f.value)});this.setState({templatesForRendering:r})};l.prototype.polylineGeometryFormatTypeChange=function(h){var f=h.target;h=this.getTemplatesAndEncodings();var r=h.outputTemplates;h.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPolyline")&&(q.fields[0].formats[0]=f.value)});this.setState({templatesForRendering:r})};
l.prototype.polylineGeometryFieldValueChange=function(h){var f=h.target;h=this.getTemplatesAndEncodings();var r=h.outputTemplates;h.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPolyline")&&(q.fields[0].name=f.value)});this.setState({templatesForRendering:r})};l.prototype.polygonGeometryFormatTypeChange=function(h){var f=h.target;h=this.getTemplatesAndEncodings();var r=h.outputTemplates;h.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPolygon")&&(q.fields[0].formats[0]=
f.value)});this.setState({templatesForRendering:r})};l.prototype.polygonGeometryFieldValueChange=function(h){var f=h.target;h=this.getTemplatesAndEncodings();var r=h.outputTemplates;h.encodings.forEach(function(q){-1<q.types.indexOf("esriGeometryPolygon")&&(q.fields[0].name=f.value)});this.setState({templatesForRendering:r})};l.prototype.getTemplatesAndEncodings=function(){var h=(0,c.default)(this.state.templatesForRendering);return{outputTemplates:h,encodings:h[this.state.activeTemplateIndex].geometry.encodings}};
l.prototype.initializeTimeProperty=function(h){var f,r=(null===(f=null===h||void 0===h?void 0:h.timeReference)||void 0===f?void 0:f.timeZone)||"UTC",q=[],t=[],w=[];h.encodings.forEach(function(u){var v=u.fields;if("instant"===u.types[0]){var x=0;v.forEach(function(B){q.push({id:x,timeField:B.name?B.name:"",timeFormat:B.formats?B.formats[0]:""});x++})}else if("interval"===u.types[0]){var z=0,A=0;v.forEach(function(B){var J=B.formats?B.formats[0]:"",P=B.name?B.name:"";b.default.includes(B.role,"start")?
(t.push({id:z,timeField:P,timeFormat:J}),z++):b.default.includes(B.role,"end")&&(w.push({id:A,timeField:P,timeFormat:J}),A++)})}});1>=q.length&&""!==q[0].timeField&&""!==q[0].timeFormat&&(this.state.disableInstantAddButton=!1);1>=t.length&&""!==t[0].timeField&&""!==t[0].timeFormat&&(this.state.disableIntervalStartAddButton=!1);1>=w.length&&""!==w[0].timeField&&""!==w[0].timeFormat&&(this.state.disableIntervalEndAddButton=!1);return{timeInstantArr:q,timeIntervalStartArr:t,timeIntervalEndArr:w,timeZone:r}};
l.prototype.createTimeZoneList=function(){return[{canonicalID:"Etc/GMT+12"},{canonicalID:"Etc/GMT+11"},{canonicalID:"Etc/GMT+10"},{canonicalID:"Pacific/Marquesas"},{canonicalID:"Etc/GMT+9"},{canonicalID:"Etc/GMT+8"},{canonicalID:"Etc/GMT+7"},{canonicalID:"Etc/GMT+6"},{canonicalID:"Etc/GMT+5"},{canonicalID:"Etc/GMT+4"},{canonicalID:"America/St_Johns"},{canonicalID:"Etc/GMT+3"},{canonicalID:"Etc/GMT+2"},{canonicalID:"Etc/GMT+1"},{canonicalID:"Etc/GMT"},{canonicalID:"UTC"},{canonicalID:"Etc/GMT-1"},
{canonicalID:"Etc/GMT-2"},{canonicalID:"Etc/GMT-3"},{canonicalID:"Asia/Tehran"},{canonicalID:"Etc/GMT-4"},{canonicalID:"Asia/Kabul"},{canonicalID:"Etc/GMT-5"},{canonicalID:"Asia/Colombo"},{canonicalID:"Asia/Kathmandu"},{canonicalID:"Etc/GMT-6"},{canonicalID:"Asia/Yangon"},{canonicalID:"Etc/GMT-7"},{canonicalID:"Etc/GMT-8"},{canonicalID:"Australia/Eucla"},{canonicalID:"Etc/GMT-9"},{canonicalID:"Australia/Adelaide"},{canonicalID:"Etc/GMT-10"},{canonicalID:"Australia/Lord_Howe"},{canonicalID:"Etc/GMT-11"},
{canonicalID:"Etc/GMT-12"},{canonicalID:"Pacific/Chatham"},{canonicalID:"Etc/GMT-13"},{canonicalID:"Etc/GMT-14"}].map(function(h){return(0,a.h)("option",{value:h.canonicalID},h.canonicalID)})};l.prototype.createTimeFieldsTSX=function(h,f,r){var q=this,t=this.createTimeZoneList();this.hasTimeValidationError=!1;h=h.map(function(w,u){var v=""!==w.timeField&&!w.timeFormat,x=""===w.timeField&&w.timeFormat;if(v||x)q.hasTimeValidationError=!0;u=(0,a.h)(a.Fragment,null,(0,a.h)("td",null,(0,a.h)("input",{class:"".concat(q.state.isTimeErrorActive&&
x?" input-error":""),name:"timeFields_".concat(u),value:w.timeField,onChange:q.changeTimeFieldName.bind(q,w.id,"instant"),disabled:q.state.isReadOnly}),(0,a.h)("div",{class:"input-error-message".concat(q.state.isTimeErrorActive&&x?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageField)),(0,a.h)("td",null,(0,a.h)("input",{class:q.state.isTimeErrorActive&&v?"input-error":"",type:"text",name:"timeFormat_".concat(u),value:w.timeFormat,onChange:q.changeTimeFormat.bind(q,w.id,
"instant"),disabled:q.state.isReadOnly}),(0,a.h)("div",{class:"input-error-message".concat(q.state.isTimeErrorActive&&v?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageFormat)));return 1>w.id?(0,a.h)("tr",{key:"instant".concat(w.id)},u,(0,a.h)("td",null,(0,a.h)("span",null))):(0,a.h)("tr",{key:"instant".concat(w.id)},u,(0,a.h)("td",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",onClick:q.deleteTimeFields.bind(q,w.id,"instant"),disabled:q.state.isReadOnly},
"x"))))});f=f.map(function(w,u){var v=""!==w.timeField&&!w.timeFormat,x=""===w.timeField&&w.timeFormat;if(v||x)q.hasTimeValidationError=!0;u=(0,a.h)(a.Fragment,null,(0,a.h)("td",null,(0,a.h)("input",{class:"".concat(q.state.isTimeErrorActive&&x?" input-error":""),name:"timeIntervalStart_".concat(u),value:w.timeField,onChange:q.changeTimeFieldName.bind(q,w.id,"intervalStart"),disabled:q.state.isReadOnly}),(0,a.h)("div",{class:"input-error-message".concat(q.state.isTimeErrorActive&&x?" is-active":"")},
g.default.itemProperties.bdfsValidation.time.errorMessageField)),(0,a.h)("td",null,(0,a.h)("input",{class:q.state.isTimeErrorActive&&v?"input-error":"",type:"text",name:"timeIntervalStartFormat_".concat(u),value:w.timeFormat,onChange:q.changeTimeFormat.bind(q,w.id,"intervalStart"),disabled:q.state.isReadOnly}),(0,a.h)("div",{class:"input-error-message".concat(q.state.isTimeErrorActive&&v?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageFormat)));return 1>w.id?(0,a.h)("tr",
{key:"intervalStart".concat(w.id)},u,(0,a.h)("td",null,(0,a.h)("span",null))):(0,a.h)("tr",{key:"intervalStart".concat(w.id)},u,(0,a.h)("td",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",onClick:q.deleteTimeFields.bind(q,w.id,"intervalStart"),disabled:q.state.isReadOnly},"x"))))});r=r.map(function(w,u){var v=""!==w.timeField&&!w.timeFormat,x=""===w.timeField&&w.timeFormat;if(v||x)q.hasTimeValidationError=!0;u=(0,a.h)(a.Fragment,null,(0,a.h)("td",null,(0,a.h)("input",
{class:"".concat(q.state.isTimeErrorActive&&x?" input-error":""),name:"timeIntervalEnd_".concat(u),value:w.timeField,onChange:q.changeTimeFieldName.bind(q,w.id,"intervalEnd"),disabled:q.state.isReadOnly}),(0,a.h)("div",{class:"input-error-message".concat(q.state.isTimeErrorActive&&x?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageField)),(0,a.h)("td",null,(0,a.h)("input",{class:q.state.isTimeErrorActive&&v?"input-error":"",type:"text",name:"timeIntervalEndFormat_".concat(u),
value:w.timeFormat,onChange:q.changeTimeFormat.bind(q,w.id,"intervalEnd"),disabled:q.state.isReadOnly}),(0,a.h)("div",{class:"input-error-message".concat(q.state.isTimeErrorActive&&v?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageFormat)));return 1>w.id?(0,a.h)("tr",{key:"intervalEnd".concat(w.id)},u,(0,a.h)("td",null,(0,a.h)("span",null))):(0,a.h)("tr",{key:"intervalEnd".concat(w.id)},u,(0,a.h)("td",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",
onClick:q.deleteTimeFields.bind(q,w.id,"intervalEnd"),disabled:q.state.isReadOnly},"x"))))});return{timeInstantFieldsTSX:h,timeIntervalStartFieldsTSX:f,timeIntervalEndFieldsTSX:r,timeZoneListTSX:t}};l.prototype.timeZoneChange=function(h){h=h.target;var f=(0,c.default)(this.state.templatesForRendering);f[this.state.activeTemplateIndex].time||(f[this.state.activeTemplateIndex].time={timeReference:{}});f[this.state.activeTemplateIndex].time.timeReference||(f[this.state.activeTemplateIndex].time.timeReference=
{});f[this.state.activeTemplateIndex].time.timeReference.timeZone=h.value;this.setState({templatesForRendering:f})};l.prototype.addTimeFields=function(h,f){f=(0,c.default)(this.state.templatesForRendering);var r=f[this.state.activeTemplateIndex].time.encodings;"instant"===h?(r.forEach(function(q){b.default.includes(q.types,"instant")&&q.fields.push({name:"",formats:[]})}),document.getElementById("timeInstantButton").disabled=!0,this.state.disableInstantAddButton=!1):"intervalStart"===h?(r.forEach(function(q){b.default.includes(q.types,
"interval")&&q.fields.push({name:"",role:["start"],formats:[]})}),document.getElementById("timeIntervalStartButton").disabled=!0,this.state.disableIntervalStartAddButton=!1):"intervalEnd"===h&&(r.forEach(function(q){b.default.includes(q.types,"interval")&&q.fields.push({name:"",role:["end"],formats:[]})}),document.getElementById("timeIntervalEndButton").disabled=!0,this.state.disableIntervalEndAddButton=!1);this.setState({templatesForRendering:f})};l.prototype.removeEmptyProperty=function(h){h.forEach(function(f){for(var r=
(0,c.default)(f.time.encodings),q=!0,t=r.length-1;0<=t;t--){for(var w=!0,u=r[t].fields.length-1;0<=u;u--)r[t].fields[u].name||r[t].fields[u].formats[0]?(q=w=!1,f.time.timeReference.timeZone="UTC"):f.time.encodings[t].fields.splice(u,1);w&&f.time.encodings.splice(t,1)}q&&delete f.time;var v=(0,c.default)(f.geometry.encodings);r=function(x){(-1<v[x].fields[0].formats.indexOf("None")||!v[x].fields[0].formats[0])&&f.geometry.encodings.splice(x,1);v[x].fields.forEach(function(z,A){var B;z.name||(null===
(B=f.geometry.encodings[x])||void 0===B?!0:delete B.fields[A].name)})};for(t=v.length-1;0<=t;t--)r(t);0===f.geometry.encodings.length&&delete f.geometry});return h};l.prototype.deleteTimeFields=function(h,f){var r=0,q=(0,c.default)(this.state.templatesForRendering),t=q[this.state.activeTemplateIndex].time.encodings;"instant"===f?(t.forEach(function(w){if(b.default.includes(w.types,"instant")){var u=w.fields.filter(function(v,x){return h!==x});w.fields=u}}),f=document.getElementById("timeInstantButton"),
f.disabled=!1):"intervalStart"===f?(t.forEach(function(w){if(b.default.includes(w.types,"interval")){var u=w.fields.filter(function(v){if(b.default.includes(v.role,"start"))if(r!==h)r++;else return r++,!1;return!0});w.fields=u}}),f=document.getElementById("timeIntervalStartButton"),f.disabled=!1):"intervalEnd"===f&&(t.forEach(function(w){if(b.default.includes(w.types,"interval")){var u=w.fields.filter(function(v){if(b.default.includes(v.role,"end")){if(r!==h)return r++,!0;r++;return!1}return!0});
w.fields=u}}),f=document.getElementById("timeIntervalEndButton"),f.disabled=!1);this.setState({templatesForRendering:q})};l.prototype.modifyTimeFields=function(h,f,r,q){var t=0,w=(0,c.default)(this.state.templatesForRendering),u=w[this.state.activeTemplateIndex].time.encodings;"instant"===q?u.forEach(function(v){b.default.includes(v.types,q)&&v.fields.forEach(function(x,z){z===h&&("timeFormat"===r?x.formats=[f]:"timeField"===r&&(x.name=f))})}):"intervalStart"===q?u.forEach(function(v){b.default.includes(v.types,
"interval")&&v.fields.forEach(function(x){b.default.includes(x.role,"start")&&(t===h&&("timeFormat"===r?x.formats=[f]:"timeField"===r&&(x.name=f)),t++)})}):"intervalEnd"===q&&u.forEach(function(v){b.default.includes(v.types,"interval")&&v.fields.forEach(function(x){b.default.includes(x.role,"end")&&(t===h&&("timeFormat"===r?x.formats=[f]:"timeField"===r&&(x.name=f)),t++)})});w[this.state.activeTemplateIndex].time.encodings=u;this.setState({templatesForRendering:w})};l.prototype.unlockAddButton=function(h){if("instant"===
h){var f=document.getElementById("timeInstantButton"),r=document.getElementsByClassName("instantTbody")[0],q=r.childNodes.length-1,t=r.children[q].getElementsByTagName("td")[0].getElementsByTagName("input")[0];q=r.children[q].getElementsByTagName("td")[1].getElementsByTagName("input")[0];f.disabled=""!==t.value&&""!==q.value?!1:!0}"intervalStart"===h?(f=document.getElementById("timeIntervalStartButton"),h=document.getElementsByClassName("intervalStartTbody")[0],q=h.childNodes.length-1,t=h.children[q].getElementsByTagName("td")[0].getElementsByTagName("input")[0],
q=h.children[q].getElementsByTagName("td")[1].getElementsByTagName("input")[0],f.disabled=""!==t.value&&""!==q.value?!1:!0):"intervalEnd"===h&&(f=document.getElementById("timeIntervalEndButton"),h=document.getElementsByClassName("intervalEndTbody")[0],q=h.childNodes.length-1,t=h.children[q].getElementsByTagName("td")[0].getElementsByTagName("input")[0],q=h.children[q].getElementsByTagName("td")[1].getElementsByTagName("input")[0],f.disabled=""!==t.value&&""!==q.value?!1:!0)};l.prototype.changeTimeFieldName=
function(h,f,r){this.modifyTimeFields(h,r.target.value,"timeField",f);this.unlockAddButton(f)};l.prototype.changeTimeFormat=function(h,f,r){this.modifyTimeFields(h,r.target.value,"timeFormat",f);this.unlockAddButton(f)};l.prototype.fileFormatChange=function(h){h=h.target.value;var f=(0,c.default)(this.state.templatesForRendering);f[this.state.activeTemplateIndex].format.type=h;this.setState({templatesForRendering:f})};l.prototype.getFields=function(h,f){for(var r=0;r<(null===h||void 0===h?void 0:
h.length);r++){var q=h[r];if(-1<(null===q||void 0===q?void 0:q.types.indexOf(f)))return q.fields}};l.prototype.getFormat=function(h,f){for(var r=0;r<(null===h||void 0===h?void 0:h.length);r++){var q=h[r];if(-1<(null===q||void 0===q?void 0:q.types.indexOf(f)))return q.fields[0].formats[0]}};l.prototype.formatNotEmpty=function(h){return h&&"None"!==h};l.prototype.render=function(){var h=this,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T=this.state,E=T.activeTemplateIndex,I=T.templatesForRendering,F=T.activeMenuItem,
D=T.modalActive,C=T.isReadOnly,y=T.isModalButtonDisabled,G=T.progressIndicatorActive,L=T.isGeometryErrorActive,O=this.props.outputTemplatesAction;T=this.createTemplatesPropertyMenu(T.sidebarMenu);var U=g.default.itemProperties.outputTemplateModal,M=U.addTitle,Q=U.editTitle,Y=U.name,fa=U.cancel,va=U.save;U=U.saveLoading;var Aa=this.retrieveTemplateProperty(E,I,F);E=Aa.templateName;I=Aa.timeInstantArr;var pa=Aa.timeIntervalStartArr,N=Aa.timeIntervalEndArr,V=Aa.timeZone,Z=Aa.fileFormat,ba="shapefile"===
Z.type?!0:!1,ma=this.createGeometryTSX(Aa.geometry);Aa=ma.geometrySpatialReference;ma=ma.encodings;var sa=g.default.itemProperties.datasetsManifest.geometry,Ea=sa.spatialReference,ya=sa.spatialReferenceValue,wa=sa.point,aa=sa.polyline,ca=sa.polygon,ka=sa.geomtryFormatType,qa=sa.XYZ,da=sa.Field,ia=sa.WKT,ra=sa.WKB,Fa=sa.GeoJSON,ea=sa.EsriJSON,xa=sa.EsriShape,ta=sa.none;sa=sa.geometryFields;var Ba=this.getFormat(ma,"esriGeometryPoint"),Na=this.getFormat(ma,"esriGeometryPolyline"),Ra=this.getFormat(ma,
"esriGeometryPolygon"),Ca=this.createTimeFieldsTSX(I,pa,N),H=Ca.timeInstantFieldsTSX,W=Ca.timeIntervalStartFieldsTSX,ha=Ca.timeIntervalEndFieldsTSX;Ca=Ca.timeZoneListTSX;var na=g.default.itemProperties.datasetsManifest.time,za=na.instant,Ga=na.interval,Oa=na.timeFields,Ia=na.field,Ka=na.format,Sa=na.startTimeFields,Ua=na.endTimeFields;na=na.timeZone;var Wa=g.default.itemProperties.datasetsManifest.file,hb=Wa.fileExtension,kb=Wa.delimited,La=Wa.parquet,X=Wa.orc;Wa=Wa.shapefile;return(0,a.h)(a.Fragment,
null,(0,a.h)(m.default,{id:"outputTemplates-editing-modal"},(0,a.h)("calcite-modal",{"aria-labelledby":"modal-title",open:D,fullscreen:!0,oncalciteModalClose:function(){return h.closeOutputTemplatesModal("cancel")}},(0,a.h)("h3",{slot:"header"},"edit"===O?Q:M),(0,a.h)("div",{slot:"content",class:"data-editing-content",style:"align-items: flex-start"},(0,a.h)("div",{class:"grid-container flex"},(0,a.h)("div",{class:"output-templates-sidebar-menu margin-right-2 flex-0"},T),(0,a.h)("div",{class:"flex-1"},
(0,a.h)("div",{class:"panel panel-white"},Y,(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("input",{type:"text",name:"outputTemplatesName",value:E,onChange:this.templateNameChange.bind(this),disabled:C})),(0,a.h)("div",{class:"overflow-auto"},(0,a.h)("div",{class:"fileExtension"},(0,a.h)("div",null,hb),(0,a.h)("label",{class:"padding-left-2"},"edit"===O?(0,a.h)("div",{id:"fileExtension"},Z.type):(0,a.h)("div",null,(0,a.h)("select",{class:"select-full",name:"fileFormat",value:Z.type,onChange:this.fileFormatChange.bind(this),
disabled:C},(0,a.h)("option",{value:"delimited"},kb),(0,a.h)("option",{value:"parquet"},La),(0,a.h)("option",{value:"orc"},X),(0,a.h)("option",{value:"shapefile"},Wa))))))),(0,a.h)("div",{class:"panel panel-white margin-top-half"},"Geometry"===F&&(0,a.h)("div",{class:"overflow-auto"},(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"spatialReference"},(0,a.h)("div",null,Ea),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("input",{class:"".concat(L?" input-error":""),type:"text",name:"spatialReferenceValue",
value:Aa?Aa.wkt||Aa.wkid:"",placeholder:ya,onChange:this.spatialReferenceChange.bind(this),disabled:C}),(0,a.h)("div",{class:"input-error-message".concat(L?" is-active":"")},g.default.itemProperties.bdfsValidation.time.errorMessageField))),(0,a.h)("div",{class:"geometry"},(0,a.h)("div",null,wa),(0,a.h)("div",{class:"geometryFormatType"},(0,a.h)("div",{class:"padding-left-2"},ka),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full",name:"geometryFormatTypeValue",value:Ba?
3===(null===(f=this.getFields(ma,"esriGeometryPoint"))||void 0===f?void 0:f.length)?"XYZ":Ba:"",onChange:this.pointGeometryFormatTypeChange.bind(this),disabled:C||ba},(0,a.h)("option",{value:"XYZ"},qa),(0,a.h)("option",{value:"WKT"},ia),!b.default.includes(["delimited","shapefile"],Z.type)&&(0,a.h)("option",{value:"WKB"},ra),(0,a.h)("option",{value:"GeoJSON"},Fa),(0,a.h)("option",{value:"EsriJSON"},ea),(0,a.h)("option",{value:"EsriShape"},xa),(0,a.h)("option",{value:"None"},ta)))),(0,a.h)("div",{class:"geometryFields"},
(0,a.h)("div",{class:"padding-left-2"},sa),(0,a.h)("label",{class:"padding-left-2"},ma&&1===(null===(r=this.getFields(ma,"esriGeometryPoint"))||void 0===r?void 0:r.length)&&(0,a.h)(a.Fragment,null,(0,a.h)("div",null,this.formatNotEmpty(Ba)&&(0,a.h)(a.Fragment,null," ",Ba," ",da," ")),(0,a.h)("input",{type:"text",name:"polylineGeometryField",value:null===(t=null===(q=this.getFields(ma,"esriGeometryPoint"))||void 0===q?void 0:q[0])||void 0===t?void 0:t.name,onChange:this.geometryFieldNonXYZChange.bind(this),
disabled:C||ba})),ma&&3===(null===(w=this.getFields(ma,"esriGeometryPoint"))||void 0===w?void 0:w.length)&&(0,a.h)(a.Fragment,null,"X ".concat(da),(0,a.h)("input",{type:"text",name:"polylineGeometryFieldX",value:null===(v=null===(u=this.getFields(ma,"esriGeometryPoint"))||void 0===u?void 0:u[0])||void 0===v?void 0:v.name,onChange:this.geometryFieldXChange.bind(this),disabled:C||ba}),"Y ".concat(da),(0,a.h)("input",{type:"text",name:"polylineGeometryFieldY",value:null===(z=null===(x=this.getFields(ma,
"esriGeometryPoint"))||void 0===x?void 0:x[1])||void 0===z?void 0:z.name,onChange:this.geometryFieldYChange.bind(this),disabled:C||ba}),"Z ".concat(da),(0,a.h)("input",{type:"text",name:"polylineGeometryFieldZ",value:null===(B=null===(A=this.getFields(ma,"esriGeometryPoint"))||void 0===A?void 0:A[2])||void 0===B?void 0:B.name,onChange:this.geometryFieldZChange.bind(this),disabled:C||ba}))))),(0,a.h)("div",{class:"geometry"},(0,a.h)("div",null,aa),(0,a.h)("div",{class:"geometryFormatType"},(0,a.h)("div",
{class:"padding-left-2"},ka),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full",name:"geometryPolylineFormatTypeValue",value:Na||"",onChange:this.polylineGeometryFormatTypeChange.bind(this),disabled:C||ba},(0,a.h)("option",{value:"WKT"},ia),!b.default.includes(["delimited","shapefile"],Z.type)&&(0,a.h)("option",{value:"WKB"},ra),(0,a.h)("option",{value:"GeoJSON"},Fa),(0,a.h)("option",{value:"EsriJSON"},ea),(0,a.h)("option",{value:"EsriShape"},xa),(0,a.h)("option",{value:"None"},
ta)))),(0,a.h)("div",{class:"geometryFields"},(0,a.h)("div",{class:"padding-left-2"},sa),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("div",null,this.formatNotEmpty(Na)&&(0,a.h)(a.Fragment,null," ",Na," ",da," ")),(0,a.h)("input",{type:"text",name:"polylineGeometryField",value:ma?null===(P=null===(J=this.getFields(ma,"esriGeometryPolyline"))||void 0===J?void 0:J[0])||void 0===P?void 0:P.name:"",onChange:this.polylineGeometryFieldValueChange.bind(this),disabled:C||ba})))),(0,a.h)("div",{class:"geometry"},
(0,a.h)("div",null,ca),(0,a.h)("div",{class:"geometryFormatType"},(0,a.h)("div",{class:"padding-left-2"},ka),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full",name:"geometryPolygonFormatTypeValue",value:Ra?Ra:"",onChange:this.polygonGeometryFormatTypeChange.bind(this),disabled:C||ba},(0,a.h)("option",{value:"WKT"},ia),!b.default.includes(["delimited","shapefile"],Z.type)&&(0,a.h)("option",{value:"WKB"},ra),(0,a.h)("option",{value:"GeoJSON"},Fa),(0,a.h)("option",{value:"EsriJSON"},
ea),(0,a.h)("option",{value:"EsriShape"},xa),(0,a.h)("option",{value:"None"},ta)))),(0,a.h)("div",{class:"geometryFields"},(0,a.h)("div",{class:"padding-left-2"},sa),(0,a.h)("label",{class:"padding-left-2"},(0,a.h)("div",null,this.formatNotEmpty(Ra)&&(0,a.h)(a.Fragment,null," ",Ra," ",da," ")),(0,a.h)("input",{type:"text",name:"polygonGeometryField",value:ma?null===(S=null===(R=this.getFields(ma,"esriGeometryPolygon"))||void 0===R?void 0:R[0])||void 0===S?void 0:S.name:"",onChange:this.polygonGeometryFieldValueChange.bind(this),
disabled:C||ba})))))),"Time"===F&&(0,a.h)("div",{class:"overflow-auto"},(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"timeZone"},(0,a.h)("div",null,na),(0,a.h)("div",{class:"padding-left-2"},(0,a.h)("select",{class:"select-full",name:"timeZone",value:V,onChange:this.timeZoneChange.bind(this),disabled:C},Ca))),(0,a.h)("div",null,za),(0,a.h)("div",{class:"timeFields"},(0,a.h)("div",null,Oa),(0,a.h)("div",{class:"padding-left-2"},(0,a.h)("table",{class:"table"},(0,a.h)("thead",null,(0,a.h)("tr",null,
(0,a.h)("th",null," ",Ia," "),(0,a.h)("th",null," ",Ka," "),(0,a.h)("th",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",id:"timeInstantButton",onClick:this.addTimeFields.bind(this,"instant"),disabled:C||1>=I.length&&this.state.disableInstantAddButton},"+"))))),(0,a.h)("tbody",{className:"instantTbody"},H)))),(0,a.h)("div",null,Ga),(0,a.h)("div",{class:"timeFields"},(0,a.h)("div",null,Sa),(0,a.h)("div",{class:"padding-left-2"},(0,a.h)("table",{class:"table"},(0,a.h)("thead",
null,(0,a.h)("tr",null,(0,a.h)("th",null," ",Ia," "),(0,a.h)("th",null," ",Ka," "),(0,a.h)("th",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",id:"timeIntervalStartButton",onClick:this.addTimeFields.bind(this,"intervalStart"),disabled:C||1>=pa.length&&this.state.disableIntervalStartAddButton},"+"))))),(0,a.h)("tbody",{className:"intervalStartTbody"},W)))),(0,a.h)("div",{class:"timeFields"},(0,a.h)("div",null,Ua),(0,a.h)("div",{class:"padding-left-2"},(0,a.h)("table",
{class:"table"},(0,a.h)("thead",null,(0,a.h)("tr",null,(0,a.h)("th",null," ",Ia," "),(0,a.h)("th",null," ",Ka," "),(0,a.h)("th",null,(0,a.h)("span",null,(0,a.h)("button",{type:"button",class:"timeFieldBtn",id:"timeIntervalEndButton",onClick:this.addTimeFields.bind(this,"intervalEnd"),disabled:C||1>=N.length&&this.state.disableIntervalEndAddButton},"+"))))),(0,a.h)("tbody",{className:"intervalEndTbody"},ha)))))))))),!C&&(0,a.h)("calcite-button",{slot:"secondary",width:"full",disabled:y,onClick:function(){return h.saveOutputTemplatesModal()}},
G?(0,a.h)("div",{style:"display: inline-flex; align-items: center; justify-content: center; width: 100%;"},(0,a.h)("calcite-loader",{label:"savingManifest",scale:"m",inline:!0,hidden:!G}),(0,a.h)("span",{style:"margin:0 10px"},U)):(0,a.h)("div",null,va)),(0,a.h)("calcite-button",{slot:"primary",width:"full",appearance:"outline",disabled:y,onClick:function(){return h.closeOutputTemplatesModal("cancel")}},fa))))};return l}(a.Component);K.default=e})},"arcgisonline/pages/item/widgets/_overview":function(){define("require exports tslib preact ../../../esriGeowConfig ../../pageUtil ../../serviceUtil ../../statusUtil ../../components/ManageBlockedApps/blocked-apps-service ../../dijit/ImageViewer ../../dijit/InlineEdit ../../dijit/ItemShareSummary ../../dijit/MemberThumb ../../dijit/OrgPopup/OrgPopup ../../dijit/_CheckReadonlyMixin ../_Actions ../_Info ../_servicesDirectoryViewModal ./_sublayer ../../portal/PortalItem ../../utils/alerts ../../utils/arrays ../../utils/dom ../../utils/formatters ../../utils/icons ../../utils/item ../../utils/itemsgroups ../../utils/productGlyphs ../../utils/queryHandler ../../utils/setItemUrls ../../utils/verified ../../../sharing/dijit/CopyToClipboard ../../../sharing/dijit/dialog/SubscriptionStatusDlg ../../../sharing/dijit/dialog/_CreateItemUtilMixin ../../../sharing/geow/Content ../../../sharing/util ../../components/Ratings ../../../tsutils/declareDecorator ../../../sharing/dijit/RasterFunctionEditor calcite-web/js/calcite-web esri/libs/sanitizer/Sanitizer dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dojo/Deferred dojo/_base/event dojo/_base/lang dojo/dom dojo/dom-attr dojo/dom-construct dojo/has dojo/on dojo/promise/all dojo/query dojo/string dojo/topic dojo/when esri/Evented esri/request esri/WKIDUnitConversion esri/lang dojo/text!./templates/_comment.html dojo/text!./templates/_layerActions.html dojo/text!./templates/_layerRenameActions.html dojo/text!./templates/_modelCharacteristics.html dojo/text!./templates/_overview.html dojo/text!./templates/_owner.html dojo/text!./templates/_ownerVerified.html dojo/text!./templates/_reply.html dojo/text!./templates/_solutionContent.html dojo/text!./templates/_solutionItem.html dojo/text!./templates/_toolActions.html dojo/text!./templates/_workflowContent.html arcgisonline/pages/components/CredentialSection arcgisonline/pages/components/Favorite arcgisonline/pages/components/LayerCard arcgisonline/pages/utils/mapViewer arcgisonline/pages/utils/url dojo/i18n!../../../nls/arcgisonline ../_export arcgisonline/pages/components/DependencyAccessCheck arcgisonline/pages/utils/notebook arcgisonline/pages/components/ConfirmDialog ../components/HelpLinks".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U,M,Q,Y,fa,va,Aa,pa,N,V,Z,ba,ma,sa,Ea,ya,wa,aa,ca,ka,qa,da,ia,ra,Fa,ea,xa,ta,Ba,Na,Ra,Ca,H,W,ha,na,za,Ga,Oa,Ia,Ka,Sa,Ua,Wa,hb,kb){g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);
v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importStar(S);T=p.__importDefault(T);E=p.__importStar(E);I=p.__importDefault(I);F=p.__importDefault(F);D=p.__importDefault(D);C=p.__importDefault(C);y=p.__importDefault(y);G=p.__importDefault(G);L=p.__importDefault(L);U=p.__importDefault(U);M=p.__importDefault(M);Q=p.__importDefault(Q);Y=p.__importDefault(Y);fa=
p.__importDefault(fa);va=p.__importDefault(va);Aa=p.__importDefault(Aa);pa=p.__importDefault(pa);N=p.__importDefault(N);V=p.__importDefault(V);Z=p.__importDefault(Z);ba=p.__importDefault(ba);ma=p.__importDefault(ma);sa=p.__importDefault(sa);Ea=p.__importDefault(Ea);ya=p.__importDefault(ya);wa=p.__importDefault(wa);aa=p.__importDefault(aa);ca=p.__importDefault(ca);ka=p.__importDefault(ka);qa=p.__importDefault(qa);da=p.__importDefault(da);ia=p.__importDefault(ia);ra=p.__importDefault(ra);Fa=p.__importDefault(Fa);
ea=p.__importDefault(ea);xa=p.__importDefault(xa);ta=p.__importDefault(ta);Ba=p.__importDefault(Ba);Na=p.__importDefault(Na);Ra=p.__importDefault(Ra);Ca=p.__importDefault(Ca);H=p.__importDefault(H);W=p.__importDefault(W);ha=p.__importDefault(ha);za=p.__importDefault(za);Ga=p.__importDefault(Ga);Ka=p.__importDefault(Ka);Wa=p.__importDefault(Wa);hb=p.__importDefault(hb);kb=p.__importDefault(kb);return function(){function La(X,la){var ja=this;this.NO_THUMBNAIL_PATH="js/arcgisonline/css/images/no-user-thumb.jpg";
this.CACHE_CHECK_INTERVAL=3E3;this.icons=P.default;this.productGlyphs=T.default;this.i18n=Ka.default;this.basePath=e.toUrl("arcgisonline/sharing/dijit");this.sanitizer=new Y.default;this.portalUrl=g.default.restBaseUrl.replace("/sharing/rest/","");this.dependencyAccessCheckRef=(0,a.createRef)();this.handleUnifiedMetadataOpen=function(){return p.__awaiter(ja,void 0,void 0,function(){var oa;return p.__generator(this,function(ua){switch(ua.label){case 0:return ua.trys.push([0,2,,3]),[4,(0,qa.default)({url:"".concat(g.default.restBaseUrl,
"content/items/").concat(this.item.id,"/info/metadata/metadata.xml"),content:{f:"json"},handleAs:"text"})];case 1:return oa=ua.sent(),this.metadataEditor.values=oa,[3,3];case 2:return ua.sent(),[3,3];case 3:return this.metadataEditor.portalItem=this.item,this.metadataEditor.open=!0,[2]}})})}}La.prototype.startup=function(){this.inherited(arguments);return this.initUI()};La.prototype.destroy=function(){this.inherited(arguments);this._subscriptionStatusDlg&&(this._subscriptionStatusDlg.subscriptionStatusDlg.destroyRecursive(),
this._subscriptionStatusDlg.destroyRecursive());this.cancelInlineEdit()};La.prototype._getDefaultOpenButtonAttr=function(){return B.default.nodeListToArray(document.querySelectorAll(".js-open-btn")).filter(function(X){return 0!==X.offsetHeight}).shift()};La.prototype.createUnifiedMetadataEditor=function(){var X,la;return p.__awaiter(this,void 0,void 0,function(){var ja,oa,ua,Da,Ha,Ja=this;return p.__generator(this,function(Ma){if(!this.item.canUpdate||!this.page.portal.metadataEditable)return[2];
B.default.showNode(this.metadataIframe);ja=document.documentElement;oa=ja.lang;ua=ja.dir;this.metadataIframe.src="./metadata-editor.html?portalUrl\x3d".concat(this.portalUrl,"\x26itemId\x3d").concat(this.item.id,"\x26metadataFormat\x3d").concat((null===(la=null===(X=this.page.portal)||void 0===X?void 0:X.metadataFormats)||void 0===la?void 0:la[0])||"","\x26lang\x3d").concat(oa,"\x26dir\x3d").concat(ua);B.default.hideNode(this.domNode.querySelector(".js-action-editMetadata"));Da=this.domNode.querySelector(".js-metadata-split");
Da.classList.remove("hide");Da.classList.add("display-block");Ha=this.domNode.querySelector(".js-unified-metadata");Ha.addEventListener("click",function(){Ja.metadataIframe.contentWindow.postMessage({name:"init-strings",strings:p.__assign(p.__assign({},Ja.i18n.common),Ja.i18n.metadataEditor)},"*");Ja.metadataIframe.contentWindow.postMessage({name:"edit-metadata",itemId:Ja.item.id},"*");B.default.showNode(Ja.domNode.querySelector(".js-metadata-wrapper"));document.documentElement.classList.add("overflow-hidden")});
window.onmessage=function(Qa){return p.__awaiter(Ja,void 0,void 0,function(){var Ta,$a;return p.__generator(this,function(Za){switch(Za.label){case 0:if("metadata-close"!==Qa.data)return[3,1];B.default.hideNode(this.domNode.querySelector(".js-metadata-wrapper"));document.documentElement.classList.remove("overflow-hidden");Ha.focus();this.logMetadataEvent("close");return[3,4];case 1:return"metadata-save"!==Qa.data?[3,3]:[4,this.page.fetchItemResult()];case 2:return Ta=Za.sent(),$a=new x.default(p.__assign(p.__assign({},
Ta),{portal:this.page.portal})),this._snippetSection.updateValue(Ta.snippet),this._descriptionSection.updateValue(Ta.description),this.domNode.querySelector(".js-thumbnail").src="".concat($a.thumbnailUrl,"\x26ts\x3d").concat(Date.now()),this.item.set("accessInformation",Ta.accessInformation),this.item.set("description",Ta.description||""),this.item.set("licenseInfo",Ta.licenseInfo),this.item.set("snippet",Ta.snippet||""),this.item.set("tags",Ta.tags),this.item.set("title",Ta.title),this.item.set("serviceChanged",
!0),this.logMetadataEvent("save"),[3,4];case 3:"metadata-close-no-save"===Qa.data&&(B.default.hideNode(this.domNode.querySelector(".js-metadata-wrapper")),document.documentElement.classList.remove("overflow-hidden"),Ha.focus(),this.logMetadataEvent("close without saving")),Za.label=4;case 4:return[2]}})})};return[2]})})};La.prototype.logMetadataEvent=function(X){var la;null===(la=this.page.telemetry)||void 0===la?void 0:la.logEvent({category:"metadata editor",action:X,pageName:"item",pageUrl:window.location.href})};
La.prototype.initUI=function(){var X=this,la,ja,oa,ua,Da,Ha,Ja,Ma,Qa,Ta,$a,Za,gb,eb,Va=new Aa.default,Xa=this.i18n,ib=this.portalUser,db=this.item,Pa=this.sublayer,cb=this.productGlyphs,Ya=this.basePath;this.item.set("navigatorUrl","https://navigator.arcgis.app?routeItemID\x3d".concat(this.item.id));I.default.instantApps(db);I.default.createDashboard(db);I.default.experienceBuilder(db);I.default.configureStoryMapTheme(db);"Data Pipeline"===db.type&&I.default.dataPipeline(db,this.page.portal);var bb=
N.default.mixin(this.page,J.default,{sanitizeUrl:function(ab){return 0===X.item.owner.indexOf("esri_")?ab:ab?X.sanitizer.sanitizeUrl(ab):""}});ba.default.place(wa.default.substitute(ta.default,{displayName:null!==(la=db.sentenceCaseDisplayName)&&void 0!==la?la:db.displayName,item:db,productGlyphs:cb,i18n:Xa,currentHref:window.location.href,portalUser:ib,icons:P.default,basePath:Ya,portalUrl:this.portalUrl,metadataFormat:(null===(oa=null===(ja=this.page.portal)||void 0===ja?void 0:ja.metadataFormats)||
void 0===oa?void 0:oa[0])||""},function(ab){return 0===ab?"".concat(ab):ab||""},bb),this.domNode);(null===(ua=this.portalUser)||void 0===ua?0:ua.orgId)&&c.default.getBlockedApps().then(function(ab){(null===ab||void 0===ab?0:ab.includes("arcgisinstantapps"))&&B.default.hideNode(X.domNode.querySelector(".js-create-instant-apps"))});this.metadataIframe=this.domNode.querySelector(".js-metadata-iframe");la=this.item.type;ja=this.page.portal;var mb=["configurableApp","Web AppBuilder"];["Application","API Key",
"Native Application","Web Mapping Application","Mobile Application"].includes(la)&&this.item.isRegisteredApp&&!db.typeKeywords.some(function(ab){return mb.includes(ab)})&&(null===(Da=this.portalUser)||void 0===Da?0:Da.orgId)&&(!ja.isPortal||"esri_apps"!==db.owner)&&(0,a.render)((0,a.h)(na.CredentialSection,{item:this.item,portal:ja}),document.querySelector(".js-credentials"));["Web Scene","Web Map","Group Layer"].includes(la)&&db.canUpdate&&(0,a.render)((0,a.h)(Ua.DependencyAccessCheck,{item:db,portal:ja,
user:ib,i18n:Xa,componentRef:this.dependencyAccessCheckRef}),document.querySelector(".js-item-access-mismatch"));this._snippetSection=new l.default({inputType:"textArea",rows:4,maxLength:2048,showCharactersLeft:!0,inputLabel:this.i18n.itemProperties.editSummary,prop:"snippet",value:this.item.snippet,pattern:"^[^\x3c\x3e]*$",invalidText:this.i18n.itemProperties.error.badCharacterSnippet,formatter:this.page._linkify},document.querySelector(".js-snippet-section"));this._descriptionSection=new l.default({inputId:"item-description-edit",
inputType:"richText",inputLabel:this.i18n.itemProperties.editDescription,prop:"description",value:this.item.description},document.querySelector(".js-description-section"));this._licenseInfoSection=new l.default({inputId:"item-licenseInfo-edit",inputType:"richText",inputLabel:this.i18n.itemProperties.editAttribution,prop:"licenseInfo",value:this.item.licenseInfo},document.querySelector(".js-licenseInfo-section"));this._tagsSection=new l.default({prop:"tags",inputType:"tags",inputId:"saveItemTags",
viewTitle:this.i18n.itemProperties.tags,formTitle:this.i18n.itemProperties.editTags,formClass:"leader-1 padding-leader-half trailer-1",buttonsClass:"leader-half",value:null!==(Ha=this.item.tags)&&void 0!==Ha?Ha:[],knownTags:this.item.itemOwner?this.item.itemOwner.contentTags||[]:null!==(Ja=this.portalUser.contentTags)&&void 0!==Ja?Ja:[]},this.domNode.querySelector(".js-tags-section"));this._accessInfo=new l.default({inputType:"textArea",rows:6,inputLabel:this.i18n.itemProperties.editCredits,prop:"accessInformation",
value:this.item.accessInformation,pattern:"^[^\x3c\x3e]*$",invalidText:this.i18n.itemProperties.error.badCharacterCredits,formatter:this.page._linkify},this.domNode.querySelector(".js-accessInformation-section"));this.updateRatings();this.updateBadges();this.portalUser?(this._tagsSection.initTagsEditor(),(0,a.render)((0,a.h)(za.default,{item:this.item,showText:!0}),this.domNode.querySelector(".js-favorites-container"))):this.own((0,ya.default)(".js-action-update-rating, .js-action-signin").on("click",
function(){window.location.href="signin.html?returnUrl\x3d".concat(escape(window.location.href),"\x26error\x3d403")}));try{var jb=L.default.getAbsoluteUrl(this.item.url)||this.item.itemUrl+"/data"}catch(ab){jb=this.item.url||this.item.itemUrl+"/data"}jb&&-1<jb.indexOf(".arcgis.com")&&-1<jb.indexOf("http://")&&(jb=jb.replace("http://","https://"));this.item.url||"Dashboard"!==this.item.type||(this.item.dashboardUrl||I.default.dashboard(this.item),jb="https://".concat(this.page.portal.portalHostname).concat(this.item.dashboardUrl.replace("../",
"/")),Da=(0,Ia.redirectExternalAppURL)(this.item,this.item.dashboardUrl),jb=-1<(null===Da||void 0===Da?void 0:Da.indexOf("http"))?Da:jb,document.documentElement.classList.add("has-url"),this.domNode.querySelector(".js-view-url").href=jb);this.item.url||"raster function template"!==this.item.type.toLowerCase()||(this.domNode.querySelector(".js-open-rfxEditor").onclick=function(ab){return X.openInRFxEditor({user:X.item.portalUser,parent:X.page,item:X.item,entryPoint:"itemDetailsPage"})});Da=m.default.getQueryParams();
if("raster function template"===this.item.type.toLowerCase()&&Da.openRasterFunctionTemplateEditor){var nb=ba.default.create("div",null,document.body,"last");(0,a.render)((0,a.h)(hb.default,{renderHtmlDescription:!0,strings:{title:Xa.itemProperties.rasterEditorConfirm.title,ok:Xa.common.yesLabel,cancel:Xa.common.noLabel,description:'\x3ch4 class\x3d"font-size-0 avenir-medium trailer-half"\x3e'.concat(Xa.itemProperties.rasterEditorConfirm.bodyHeadline,'\x3c/h4\x3e \x3cp class\x3d"font-size-0"\x3e').concat(Xa.itemProperties.rasterEditorConfirm.body,
"\x3c/p\x3e"),close:Xa.common.close},onCancel:function(){B.default.removeComponent(nb,document.body)},onOk:function(){X.openInRFxEditor({user:X.item.portalUser,parent:X.page,item:X.item,entryPoint:"itemDetailsPage"});B.default.removeComponent(nb,document.body)}}),nb);m.default.removeQueryParams(["openRasterFunctionTemplateEditor"])}this._copyUrlDijit=new D.default({text:jb,tooltipModifier:"tooltip-left",id:"url",label:this.i18n.itemProperties.url,telemetry:this.page.telemetry,telemetryPayload:p.__assign(p.__assign({},
this.page.baseTelemetryPayload),{category:"item action",action:"copy item url"})},document.getElementById("copyToClipBoardURL"));this._copyShortUrlDijit=new D.default({text:"",id:"shortUrl",tooltipModifier:"tooltip-left",label:this.i18n.itemProperties.shortUrl},V.default.byId("copyToClipBoardShortURL"));this._copyNavigatorUrlDijit=new D.default({text:this.item.navigatorUrl,id:"navUrl",label:this.i18n.itemProperties.navigatorLink},V.default.byId("copyToClipBoardNavURL"));((0,ma.default)("ios")||(0,ma.default)("android"))&&
[".navigator-button-mobile",".navigator-button-mobile"].forEach(function(ab){B.default.showNodes(X.domNode.querySelectorAll(ab))});this.page._queryStringParams.emptyLayer&&(m.default.removeQueryParams(["emptyLayer"]),document.querySelector(".js-empty-layer-notice").open=!0);Xa=this.item.owner!==(null===(Ma=this.portalUser)||void 0===Ma?void 0:Ma.username)&&"update"===(null===(Qa=this.item.itemControl)||void 0===Qa?void 0:Qa[0]);Ma=0<(null===($a=null===(Ta=this.item.relatedItems)||void 0===Ta?void 0:
Ta.Service2Data_forward)||void 0===$a?void 0:$a.map(function(ab){return ab.type}).filter(function(ab){return"Feature Service"===ab}).length);(!this.portalUser||Xa||Ma)&&B.default.hideNodes(this.domNode.querySelectorAll(".js-action-replaceLayer"));this.showReplaceLayer(this.item);this.showInstantApps(this.item);this.showOwner(this.item);this.showLayers(this.item);this.showRelationships(this.item);this.showItemCompleteness(this.item);this.showProjectContent(this.item,this.portalUser);this.showSolutionContent(this.item);
this.showWorkflowContent(this.item);this.showFormContent(this.item);this.showComments(this.item);this.showUrbanModelInfo(this.item);this.showFolders(this.item);this.showScreenshots(this.item);this.showCategories(this.item);this.showOpenInRFxEditorOption(this.item);this.showThumbnailActions(this.item);this.showShareStatus(this.item);this.initHandlers();this.checkForCachingJob(this.item);this.showNBVersion(this.item);this.page.set("attributeCssClasses",this.item);this.page.set("bodyCssClasses",this.item);
"processing"===this.item.status&&this.item.set("status","processing");this.updateLoaderText();this.configureViewUI();this.showManageTile();Va.resolve("processing"!==this.item.status||this.page._queryStringParams.jobid||(null===(Za=this.item.properties)||void 0===Za?void 0:Za.jobId)&&(null===(gb=this.item.properties)||void 0===gb?void 0:gb.jobUrl)&&"GPServer"===(null===(eb=this.item.properties)||void 0===eb?void 0:eb.jobType));Pa?(this.toggleSubLayer(Pa),document.body.classList.remove("is-parent-item")):
document.body.classList.add("is-parent-item");(this.item.isRetiredApp||this.item.isRetiredStoryMap)&&B.default.hideNodes([this.domNode.querySelector(".js-view-btn"),this.domNode.querySelector(".js-configure-btn")]);this.item.origin&&B.default.hideNode(this.domNode.querySelector(".js-edit-dashboard"));this.item.typeKeywords.includes("configurableApp")&&this.domNode.querySelector(".js-configure-btn").classList.add("if-instant-apps-and-not-blocked");R.default.isHubType(this.item.type)&&(this.domNode.querySelector(".js-view-btn").classList.add("if-hub-and-not-blocked"),
this.domNode.querySelector(".js-configure-btn").classList.add("if-hub-and-not-blocked"));this.createUnifiedMetadataEditor();this.page.portal.isPortal&&"Feature Service"===this.item.type&&this.item.typeKeywords.includes("CatalogLayer")&&B.default.hideNode(this.domNode.querySelector(".js-publish-dropdown"));(0,a.render)((0,a.h)(kb.default,{item:this.item,portal:this.page.portal,strings:{help:this.i18n.itemProperties.help,helpLinks:this.i18n.itemProperties.helpLinks}}),this.domNode.querySelector(".js-help-container"));
"CityEngine Web Scene"===db.type&&this.domNode.querySelector(".js-action-updateData").classList.add("hide");return Va};La.prototype.showManageTile=function(){var X=m.default.getHashParts().includes("manageTiles"),la=this.item.types.some(function(ja){return["is-tile","is-vectorTile","is-tiled-imagery"].includes(ja)});X&&la&&!this.page.portal.isPortal&&(document.querySelector(".tile-layer-auto-cache-alert").open=!0)};La.prototype.configureViewUI=function(){var X=this,la,ja,oa,ua=this.domNode.querySelector("span.js-service-link \x3e a"),
Da=this.domNode.querySelector(".js-view-url"),Ha=this.domNode.querySelector(".js-open-viewStyle"),Ja=function(Ma,Qa){(0,u.shouldOpenViewModal)(X.item,X.portalUser)&&(Ma.preventDefault(),Ma.stopPropagation(),(0,u.handleViewModalClick)(X.item,X.portalUser,Qa))};ua&&(0,u.shouldOpenViewModal)(this.item,this.portalUser)&&(null===(la=this.serviceLinkClickHandler)||void 0===la?void 0:la.remove(),this.serviceLinkClickHandler=void 0,ua.dataset.url=ua.href,ua.href="".concat(I.default.removeToken(ua.href)),
this.serviceLinkClickHandler=(0,sa.default)(ua,"click",function(Ma){Ja(Ma,ua)}),this.own(this.serviceLinkClickHandler));Da&&(0,u.shouldOpenViewModal)(this.item,this.portalUser)&&(null===(ja=this.viewLinkClickHandler)||void 0===ja?void 0:ja.remove(),this.viewLinkClickHandler=void 0,Da.dataset.url=Da.href,Da.href="".concat(I.default.removeToken(Da.href)),this.viewLinkClickHandler=(0,sa.default)(Da,"click",function(Ma){Ja(Ma,Da)}),this.own(this.viewLinkClickHandler));Ha&&(0,u.shouldOpenViewModal)(this.item,
this.portalUser)&&(null===(oa=this.viewStyleClickHandler)||void 0===oa?void 0:oa.remove(),this.viewStyleClickHandler=void 0,Ha.dataset.url=Ha.href,Ha.href="".concat(I.default.removeToken(Ha.href)),this.viewStyleClickHandler=(0,sa.default)(Ha,"click",function(Ma){Ja(Ma,Ha)}))};La.prototype.toggleSubLayer=function(X,la){var ja,oa=this.domNode.querySelector(".js-item-pane"),ua=this.domNode.querySelector(".js-sublayer-pane");window.scroll({top:0,left:0,behavior:"smooth"});X?(this.sublayer=X,null===(ja=
this._sublayerDijit)||void 0===ja?void 0:ja.destroy(),this._sublayerDijit=new v.default({item:this.item,sublayer:X,page:this.page,portalUser:this.portalUser},ba.default.place(ba.default.create("div"),this.domNode.querySelector(".js-sublayer"),"last")),oa.classList.remove("item-pane--active"),ua.classList.add("item-pane--active"),document.body.classList.remove("is-parent-item")):(this.sublayer=null,oa.classList.add("item-pane--active"),ua.classList.remove("item-pane--active"),document.body.classList.add("is-parent-item"));
this.page.toggleSubLayer(X,la);this.page.subnav.updateActiveTab("overview")};La.prototype.updateLoaderText=function(){var X,la,ja;"Image Service"===this.item.type&&(null===(X=this.item.properties)||void 0===X?0:X.jobId)&&(null===(la=this.item.properties)||void 0===la?0:la.jobUrl)&&"GPServer"===(null===(ja=this.item.properties)||void 0===ja?void 0:ja.jobType)?n.default.isImageManagementTask(this.item.properties.jobUrl)&&(this.domNode.querySelector(".js-service-status .loader-text").innerHTML=this.i18n.itemProperties.updatingService):
b.default.isVectorTileFromFeatures(this.item)&&(this.domNode.querySelector(".js-service-status .loader-text").innerHTML=this.i18n.itemProperties.buildingCache)};La.prototype.getLayerStatus=function(X){return p.__awaiter(this,void 0,void 0,function(){var la,ja,oa,ua,Da,Ha,Ja,Ma,Qa;return p.__generator(this,function(Ta){switch(Ta.label){case 0:if(!X.layers)return[2];la=[];ja=function($a){$a.forEach(function(Za){if(Za.layers)return ja(Za.layers);Za.itemId&&!la.includes(Za.itemId)&&la.push(Za.itemId)})};
ja(X.layers);return(oa=la.map(function($a){return"id: ".concat($a)}).join(" OR "))?[4,L.default.request({url:"".concat(g.default.restBaseUrl,"search"),content:{filter:oa,start:1,num:100}})]:[3,6];case 1:ua=Ta.sent().results,Da=0,Ha=ua,Ta.label=2;case 2:if(!(Da<Ha.length))return[3,5];Ja=Ha[Da];Ja.portal=this.item.portal;Ma=Ja;return[4,F.default.getVerifiedInfo(Ja)];case 3:Ma.verified=Ta.sent(),Ja.badges=R.default.getContentStatusBadges(Ja),Ta.label=4;case 4:return Da++,[3,2];case 5:Qa=function($a){for(var Za,
gb=function(Va){Va.layers&&Qa(Va.layers);var Xa=ua.find(function(ib){return ib.id===Va.itemId});null!==(Za=Va.url)&&void 0!==Za?Za:Va.url=null===Xa||void 0===Xa?void 0:Xa.url;Va.contentStatus=null===Xa||void 0===Xa?void 0:Xa.contentStatus;Va.badges=null===Xa||void 0===Xa?void 0:Xa.badges;Va.itemId&&"ArcGISMapServiceLayer"===Va.layerType&&(Va.layerType="MapImageLayer")},eb=0;eb<$a.length;eb++)gb($a[eb])},Qa(X.layers),Ta.label=6;case 6:return[2]}})})};La.prototype.showInstantApps=function(X){X.typeKeywords.includes("instantApp")&&
B.default.hideNode(this.domNode.querySelector(".js-open-downloadAttachment"))};La.prototype.showOpenInRFxEditorOption=function(X){var la=this.portalUser;la=!(null===la||void 0===la?0:la.username);A.default.includes(X.typeKeywords,"Function Template")&&!la||B.default.hideNode(this.domNode.querySelector(".js-open-rfxEditor"))};La.prototype.openInRFxEditor=function(X){X=X||{};this._rasterFunctionEditor?(this._rasterFunctionEditor.set("parent",X.parent),this._rasterFunctionEditor.set("item",X.item),this._rasterFunctionEditor.open()):
(X.showOnStart=!0,X=new M.default(X,document.createElement("div")),X.startup(),document.body.appendChild(X.domNode),this._rasterFunctionEditor=X)};La.prototype.showReplaceLayer=function(X){var la,ja,oa=X.types.some(function(Ta){return["is-tile","is-vectorTile","is-tiled-imagery"].includes(Ta)}),ua=X.typeKeywords.includes("Tiled Imagery");X.types.includes("is-vectorTile");var Da=X.types.some(function(Ta){return["is-3d","is-scene"].includes(Ta)})&&!X.types.includes("is-tiled-imagery"),Ha=X.types.includes("is-scene-2"),
Ja=X.relatedItems&&0<Object.keys(X.relatedItems).filter(function(Ta){return Ta.includes("Service2Data")}).length,Ma=["Feature Service"].includes(null===(la=X.sourceData)||void 0===la?void 0:la.type);la=X.types.includes("is-hosted");var Qa=X.typeKeywords.includes("ExtractedCache");(!oa||ua||!la&&!Qa||la&&-1<X.types.indexOf("is-tile")&&Ma||"FeatureServer"===(null===(ja=X.serviceInfo)||void 0===ja?void 0:ja.sourceServiceType))&&B.default.hideNodes(this.domNode.querySelectorAll(".js-action-replaceLayer"));
(!Da||!Ja||!la&&!Qa||oa&&Ha)&&B.default.hideNodes(this.domNode.querySelectorAll(".js-action-replaceSceneLayer"))};La.prototype.showOwner=function(X){if(X.verified){var la=this.i18n;this.domNode.querySelector(".js-owner-info").innerHTML=wa.default.substitute(Na.default,{item:X,i18n:la});new f.default({cssClasses:"margin-right-quarter inline-block flex-0",member:X.itemOwner,scale:"s"},this.domNode.querySelector(".js-owner-thumbnail"));new f.default({cssClasses:"margin-right-half inline-block flex-0 member-thumb--small org-thumb",
member:{username:X.verified.name,fullName:X.verified.name,id:X.verified.name,thumbnailUrl:X.verified.thumbnail,thumbnail:X.verified.thumbnail,defaultThumbnailUrl:"./images/group-no-image.png"}},this.domNode.querySelector(".js-verified-thumbnail"))}else this.domNode.querySelector(".js-owner-info").innerHTML=wa.default.substitute(Ba.default,{item:X,i18n:Ka.default}),new f.default({cssClasses:"margin-right-half inline-block flex-0 member-thumb--small",member:X.itemOwner},this.domNode.querySelector(".js-owner-thumbnail"));
ba.default.place(J.default.formatOwnerText(X,!1,!0),this.domNode.querySelector(".js-owner-section"),"replace");X.verified&&(this.domNode.querySelector(".js-by-owner").textContent=this.i18n.itemProperties.from);la=this.domNode.querySelector(".js-typeOwner-info");m.default.registerItemActions(this,la,t.default,this.page);(la=this.domNode.querySelector(".js-verified-owner-link"))&&this.own((0,sa.default)(la,"click",function(ja){ja.preventDefault();ja.stopPropagation();(new r.default({item:X,opener:ja.target})).open()}))};
La.prototype.showNBVersion=function(X){var la,ja;return p.__awaiter(this,void 0,void 0,function(){var oa,ua,Da,Ha,Ja,Ma,Qa;return p.__generator(this,function(Ta){switch(Ta.label){case 0:Ta.trys.push([0,3,,4]);"string"===typeof X.properties&&(X.properties=JSON.parse(X.properties));if(!("notebook"===X.type.toLowerCase()&&(null===(la=X.properties)||void 0===la?0:la.notebookRuntimeName)&&(null===(ja=X.properties)||void 0===ja?0:ja.notebookRuntimeVersion)))return[3,2];(0,ya.default)(".js-nb-curr-version").innerHTML("".concat(X.properties.notebookRuntimeName,
" - ").concat(X.properties.notebookRuntimeVersion));(0,ya.default)(".js-nb-version-info").removeClass("hide");return[4,Wa.default.getNotebookRuntimes()];case 1:oa=Ta.sent();Da=ua=0;for(Ha=oa;Da<Ha.length;Da++)Ja=Ha[Da],Ja.esriProvidedRuntime&&(Ma=parseInt(Ja.version,10),ua=Math.max(ua,Ma));(Qa=oa.find(function($a){return $a.esriProvidedRuntime&&$a.name===X.properties.notebookRuntimeName&&parseInt($a.version,10)===parseInt(X.properties.notebookRuntimeVersion,10)}))&&parseInt(Qa.version,10)<ua&&(0,ya.default)(".js-nb-new-version").removeClass("hide");
Ta.label=2;case 2:return[3,4];case 3:return Ta.sent(),[3,4];case 4:return[2]}})})};La.prototype.showShareStatus=function(X){var la=this,ja=this.portalUser;S.getItemGroups({item:X,url:this.page.portal.url,portalUser:ja,contentUser:X.itemOwner}).then(function(oa){var ua;null===(ua=la._itemShareSummary)||void 0===ua?void 0:ua.destroy();la._itemShareSummary=new h.default({item:oa,portalUser:ja,canShare:oa.canShare,responsive:!1,telemetry:la.page.telemetry,showShareGroups:!0,portal:la.portal},ba.default.place(ba.default.create("div"),
la.domNode.querySelector(".js-item-share-summary"),"last"))})};La.prototype.showLayers=function(X){var la;return p.__awaiter(this,void 0,void 0,function(){var ja;return p.__generator(this,function(oa){switch(oa.label){case 0:if(null===(la=X.layers)||void 0===la||!la.length)return[3,1];"Web Map"===X.type||"Web Scene"===X.type?this.showMapLayers(X):-1<X.types.indexOf("is-tool")?this.showToolLayers(X):this.showServiceLayers(X);return[3,3];case 1:return"Group Layer"!==X.type?[3,3]:[4,X.getData()];case 2:ja=
oa.sent();if(null===ja||void 0===ja?0:ja.layers)X.operationalLayers=ja.layers,document.body.classList.add("has-featureLayers"),this.showMapLayers(X);oa.label=3;case 3:return[2]}})})};La.prototype._showDataUpdatedLast=function(X){var la=this,ja,oa,ua;(null===(ja=X.layers)||void 0===ja?0:ja.length)&&"Feature Service"===X.type&&A.default.includes(X.typeKeywords,"Hosted Service")&&(X.layers.forEach(function(Da){var Ha;(oa=null===(Ha=Da.editingInfo)||void 0===Ha?void 0:Ha.lastEditDate)&&(!ua||ua<oa)&&
(ua=oa)}),ua&&B.default.forEachNode(document.querySelectorAll(".js-dataUpdatedLast"),function(Da){return Da.innerHTML="".concat(la.i18n.itemProperties.dataLastModified," ").concat(la.page._formatDateTime(ua))}))};La.prototype.showServiceLayers=function(X){var la=this,ja,oa=null!==(ja=X.layers)&&void 0!==ja?ja:[],ua=X.isLoaded&&!X.isFeatureCollection&&(A.default.includes(X.types,"is-feature")||A.default.includes(X.types,"is-table")),Da=document.querySelector(".js-tables"),Ha=document.querySelector(".js-layers"),
Ja,Ma=Ha;oa.length&&(Da&&ba.default.empty(Da),Ha&&ba.default.empty(Ha),oa.forEach(function(Qa){if(ua){la.setLayerAttributes(Qa,X);var Ta=Qa.hasAttachments?"disableAttachments":"enableAttachments",$a=Qa.hasAttachments?"hideAttachments":"showAttachments";m.default.canEditViewAttachments(X);Ja=wa.default.substitute(Fa.default,{item:X,layerType:(null===Qa||void 0===Qa?void 0:Qa.type)||"",geometryType:(null===Qa||void 0===Qa?void 0:Qa.geometryType)||"",icons:P.default,url:"".concat(window.location.origin).concat(window.location.pathname,
"?id\x3d").concat(X.id,"\x26sublayer\x3d").concat(Qa.id),attributes:Qa.attributes.join(" "),layer:Qa,i18n:la.i18n,attachmentLabel:la.i18n.itemProperties[Ta],viewAttachmentLabel:la.i18n.itemProperties[$a],hideViewAttachmentsClass:""})}else Ja=X.isHostedService&&"Map Service"===X.type&&(X.isAdmin||X.isOwner)&&la.isTilesFromFeatureLayer()?ea.default:la.getLayerNode(Qa,X);(Ma="Table"===Qa.type?Da:Ha)&&ba.default.place(Ja,Ma);document.querySelector(".js-layer-rename")&&(la._layerRename=new l.default({inputType:"layerRename",
prop:"layerRename",value:Qa.name,layerUrl:Qa.url,layerId:Qa.id,required:!0,pattern:"^[^\x3c\x3e]+$",emptyText:la.i18n.itemProperties.error.needTitle,invalidText:la.i18n.itemProperties.error.badCharacter,showLoader:L.default.isPortal()},document.querySelector(".js-layer-rename")));(null===Qa||void 0===Qa?0:Qa.subLayers)&&"Group Layer"!==(null===Qa||void 0===Qa?void 0:Qa.type)&&Qa.subLayers.forEach(function(Za){ba.default.place(la.getLayerNode(Za,X,"padding-left-1"),Ma)})}),this.sublayer||this.toggleSubLayer())};
La.prototype.isTilesFromFeatureLayer=function(){var X=this.item.sourceData;X="Feature Service"===(null===X||void 0===X?void 0:X.type);return g.default.tilesOnDemandEnabled&&X};La.prototype.showToolLayers=function(X){var la=this.i18n,ja=X.mapViewerUrl,oa=X.tools,ua=ja.substring(ja.indexOf("?")+1,ja.length),Da=E.queryToObject(ua),Ha=document.querySelector(".js-tools");if(null===oa||void 0===oa?0:oa.length)ba.default.empty(Ha),delete Da.layers,(oa||[]).forEach(function(Ja){Ja.attributes=[];var Ma=Ja.attributes.join(" ");
Da.url=Ja.url;Ja.mapViewerUrl=ja.substring(0,ja.indexOf("?")+1)+E.objectToQuery(Da);Ja=wa.default.substitute(W.default,{item:X,attributes:Ma,tool:Ja,i18n:la});ba.default.place(Ja,Ha)})};La.prototype.showMapLayers=function(X){var la=this,ja,oa=[].concat(X.operationalLayers||[]).reverse(),ua=X.baseMapLayers||[],Da=X.elevationLayers||[];X=X.tables||[];var Ha=document.querySelector(".js-layers"),Ja=document.querySelector(".js-baseMapLayers"),Ma=document.querySelector(".js-elevationLayers"),Qa=document.querySelector(".js-tables"),
Ta={opLayers:{layers:oa,node:Ha},baseMapLayers:{layers:ua,node:Ja},elevationLayers:{layers:Da,node:Ma},tables:{layers:X,node:Qa}};oa=this.page.portal;var $a=null===(ja=null===oa||void 0===oa?void 0:oa.portalUser)||void 0===ja?void 0:ja.getToken();B.default.forEachNode(document.querySelectorAll(".js-layerNode"),function(Za){return ba.default.empty(Za)});Object.keys(Ta).forEach(function(Za){var gb=Ta[Za],eb=gb.layers,Va=gb.node;"baseMapLayers"===Za&&0<ua.length?(gb={title:ua[0].baseMapTitle,layerType:"Basemap",
layers:p.__spreadArray([],eb,!0).reverse(),isBaseMapLayer:!0},eb=B.default.createElement("div",{},Va),B.default.addClasses(eb,["layer-card-container"]),(0,a.render)((0,a.h)(Ga.default,{item:la.item,hostItemId:la.item.id,layer:gb,token:$a}),eb)):eb.forEach(function(Xa){"tables"===Za&&(Xa.type="Table");var ib=B.default.createElement("div",{},Va);B.default.addClasses(ib,["layer-card-container"]);(0,a.render)((0,a.h)(Ga.default,{item:la.item,hostItemId:la.item.id,layer:Xa,token:$a}),ib)})})};La.prototype.getLayerNode=
function(X,la,ja){la=X.name||X.title||m.default.getServiceNameFromUrl(la);la=this.sanitizer.sanitize(la)||"";X=X.itemUrl||X.url;ja=null!==ja&&void 0!==ja?ja:"";X=X?'\x3ca target\x3d"_blank" href\x3d"'.concat(encodeURI(X),'"\x3e').concat(la,"\x3c/a\x3e"):la;return'\x3cdiv class\x3d"padding-leader-quarter padding-trailer-quarter '.concat(ja,'"\x3e').concat(X,"\x3c/div\x3e")};La.prototype.renderGroupLayer=function(X,la,ja){var oa=this,ua,Da=this.getLayerNode(X,la,"subLayer"),Ha=ba.default.place(Da,ja);
null===(ua=X.layers)||void 0===ua?void 0:ua.forEach(function(Ja){return oa.renderGroupLayer(Ja,la,Ha)})};La.prototype.getItemUrl=function(X){return"".concat(g.default.baseUrl,"item.html?id\x3d").concat(X)};La.prototype.showRelationships=function(X){var la=this,ja,oa,ua="Feed"===X.type,Da=X.sourceData,Ha={"Map Service":1,"Scene Service":1,WFS:1,"Feature Service":1,"Vector Tile Service":1,"Image Service":1,OGCFeatureServer:1},Ja={"Feature Service":1},Ma=null===(ja=X.resultData)||void 0===ja?void 0:
ja.map(function(Pa){return Pa});ja=null===Ma||void 0===Ma?void 0:Ma.filter(function(Pa){return(null===Pa||void 0===Pa?void 0:Pa.type)in Ja&&ua});var Qa=null===Ma||void 0===Ma?void 0:Ma.filter(function(Pa){return Pa&&!A.default.includes(Pa.typeKeywords,"View Service")&&Pa.type in Ha&&!(ua&&"Feature Service"===Pa.type)}),Ta=null===Ma||void 0===Ma?void 0:Ma.filter(function(Pa){return Pa&&A.default.includes(Pa.typeKeywords,"View Service")&&Pa.type in Ja}),$a=document.querySelector(".js-relationshipsCreatedFrom"),
Za=document.querySelector(".js-resultCreatingIn"),gb=document.querySelector(".js-relationshipsVisualizedTo"),eb=document.querySelector(".js-relationshipsDataViews"),Va=document.querySelector(".related-items-section");if(A.default.includes(X.typeKeywords,"cloudStore_azure")||A.default.includes(X.typeKeywords,"cloudStore_amazon")||A.default.includes(X.typeKeywords,"cloudStore_azuredatalakegen2store")){var Xa="\x3cdiv\x3e\x3ch4\x3e".concat(this.i18n.itemProperties.dataStores,"\x3c/h4\x3e");X.getRelatedItems("CloudDataStore2BDFSDataStore",
"forward").then(function(Pa){if(null===Pa||void 0===Pa?0:Pa.length){Pa=Pa[0];var cb=la.getItemUrl(Pa.id);Xa="".concat(Xa,"\x3cdiv\x3e\x3ca href\x3d").concat(cb,"\x3e").concat(Pa.title," (").concat(la.i18n.itemProperties.relatedItemDataStore,")\x3c/a\x3e\x3c/div\x3e");Va.innerHTML=Xa;Pa.getRelatedItems("BDFSDataStore2BDFSCatalogService","forward").then(function(Ya){if(null===Ya||void 0===Ya?0:Ya.length){Ya=Ya[0];var bb=la.getItemUrl(Ya.id);Xa="".concat(Xa.substring(0,Xa.length-6),"\x3cdiv\x3e\x3ca href\x3d").concat(bb,
"\x3e").concat(Ya.title," (").concat(la.i18n.itemProperties.relatedItemBDFS,")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e");Va.innerHTML=Xa}},function(Ya){return 0})}},function(Pa){return 0})}else A.default.includes(X.typeKeywords,"fileShare")||A.default.includes(X.typeKeywords,"hdfs")||A.default.includes(X.typeKeywords,"hive")?X.getRelatedItems("BDFSDataStore2BDFSCatalogService","forward").then(function(Pa){if(null===Pa||void 0===Pa?0:Pa.length){Pa=Pa[0];var cb=la.getItemUrl(Pa.id);Va.innerHTML="\x3cdiv\x3e\x3ch4\x3e".concat(la.i18n.itemProperties.dataStores,
"\x3c/h4\x3e\x3cdiv\x3e\x3ca href\x3d").concat(cb,"\x3e").concat(Pa.title," (").concat(la.i18n.itemProperties.relatedItemBDFS,")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e")}},function(Pa){return 0}):A.default.includes(X.typeKeywords,"bigDataFileShare")&&A.default.includes(X.typeKeywords,"dataStore")?(Xa="\x3cdiv\x3e\x3ch4\x3e".concat(this.i18n.itemProperties.dataStores,"\x3c/h4\x3e"),X.getRelatedItems("CloudDataStore2BDFSDataStore","reverse").then(function(Pa){if(null===Pa||void 0===Pa?0:Pa.length){Pa=Pa[0];
var cb=la.getItemUrl(Pa.id);Xa="".concat(Xa,"\x3cdiv\x3e\x3ca href\x3d").concat(cb,"\x3e").concat(Pa.title," (").concat(la.i18n.itemProperties.relatedItemCloudDS,")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e");Va.innerHTML=Xa;X.getRelatedItems("BDFSDataStore2BDFSCatalogService","forward").then(function(Ya){if(null===Ya||void 0===Ya?0:Ya.length){Ya=Ya[0];var bb=la.getItemUrl(Ya.id);Xa="".concat(Xa.substring(0,Xa.length-6),"\x3cdiv\x3e\x3ca href\x3d").concat(bb,"\x3e").concat(Ya.title," (").concat(la.i18n.itemProperties.relatedItemBDFS,
")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e");Va.innerHTML=Xa}},function(Ya){return 0})}},function(Pa){return 0})):A.default.includes(X.typeKeywords,"Big Data Catalog Service")&&(Xa="\x3cdiv\x3e\x3ch4\x3e".concat(this.i18n.itemProperties.dataStores,"\x3c/h4\x3e"),X.getRelatedItems("BDFSDataStore2BDFSCatalogService","reverse").then(function(Pa){if(null===Pa||void 0===Pa?0:Pa.length){Pa=Pa[0];var cb=la.getItemUrl(Pa.id);Xa="".concat(Xa,"\x3cdiv\x3e\x3ca href\x3d").concat(cb,"\x3e").concat(Pa.title," (").concat(la.i18n.itemProperties.relatedItemDataStore,
")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e");Va.innerHTML=Xa;Pa.getRelatedItems("CloudDataStore2BDFSDataStore","reverse").then(function(Ya){if(null===Ya||void 0===Ya?0:Ya.length){Ya=Ya[0];var bb=la.getItemUrl(Ya.id);Xa="".concat(Xa.substring(0,Xa.length-6),"\x3cdiv\x3e\x3ca href\x3d").concat(bb,"\x3e").concat(Ya.title," (").concat(la.i18n.itemProperties.relatedItemCloudDS,")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e");Va.innerHTML=Xa}},function(Ya){return 0})}},function(Pa){return 0}));"Feature Service"===X.type&&
(null===Ma||void 0===Ma?0:Ma.length)&&Ma.some(function(Pa){return"Feed"===Pa.type})&&(Ma=A.default.find(Ma,function(Pa){return"Feed"===Pa.type}),$a.innerHTML=wa.default.substitute("".concat(this.i18n.itemProperties.createdFrom," ").concat('\x3ca href\x3d"item.html?id\x3d${relItem.id}"\x3e${relItem.title}\x3c/a\x3e, ${relItem.sentenceCaseDisplayName}'),{relItem:Ma,i18n:this.i18n}));Da?X.isMultiServicesView?X.getRelatedItems("Service2Data","forward").then(function(Pa){ib=Pa.slice(0,5);db=ib.reduce(function(cb,
Ya,bb,mb){return la.renderResultItems(cb,Ya,bb,mb)},"");db+=la.toSearchString(Pa,5);$a.innerHTML=la.i18n.itemProperties.createdFrom;ba.default.create("ul",{innerHTML:db,class:"other-views trailer-0 font-size--1"},$a,"after")}):$a.innerHTML=wa.default.substitute("".concat(this.i18n.itemProperties.createdFrom," ").concat('\x3ca href\x3d"item.html?id\x3d${relItem.id}"\x3e${relItem.title}\x3c/a\x3e, ${relItem.sentenceCaseDisplayName}'),{relItem:Da,i18n:this.i18n}):-1!==X.attributes.indexOf("has-cloudDriveData")&&
X.isOwner&&X.isAdmin&&y.default.getCloudProviderItemResource(X).then(function(Pa){X.cloudProviderInfo=Pa;var cb="",Ya="",bb=Pa.mimeType,mb=Pa.cloudDriveFileName,jb=Pa.id,nb=Pa.zipItemType,ab=la.i18n.itemProperties;cb=ab.cloudFileTypeGoogleSheets;var ob=ab.cloudFileTypeCsv,pb=ab.cloudFileTypeExcel,qb=ab.cloudFileTypeShapefile,lb=ab.cloudFileTypeFgdb,rb=ab.cloudFileTypeGeojson;Ya=ab.cloudDriveProviderBox;var sb=ab.cloudDriveProviderDropbox,tb=ab.cloudDriveProviderOneDrive,ub=ab.cloudDriveProviderGoogleDrive,
vb=ab.fromCloudDrive;ab=ab.createdFrom;-1===bb.indexOf("google-apps")&&-1===bb.indexOf("googlesheets")&&(-1!==bb.indexOf("csv")?cb=ob:-1!==bb.indexOf("excel")||-1!==bb.indexOf("spreadsheetml")?cb=pb:-1!==bb.indexOf("shapeFile")?cb=qb:-1!==bb.indexOf("fgdb")?cb=lb:-1!==bb.indexOf("geojson")?cb=rb:(cb=pb,ob={shapefile:qb,"csv collection":ob,"file geodatabase":lb},"zip"===bb&&nb&&(bb=nb.toLowerCase(),bb in ob&&(cb=ob[bb]))));bb="";"boxConnect"===Pa.cloudProvider?bb="https://www.box.com/":"dropBoxConnect"===
Pa.cloudProvider?(Ya=sb,bb="https://www.dropbox.com/"):"oneDriveConnect"===Pa.cloudProvider?(Ya=tb,bb="https://onedrive.live.com/"):Pa.cloudProvider?(Ya=ub,bb="https://drive.google.com/file/d/".concat(jb)):(Ya=Ka.default.overwriteFromGeoJSON.url,bb=Pa.url);Pa='\x3ca href\x3d"'.concat(bb,'" target\x3d"_blank"\x3e ').concat(null!==mb&&void 0!==mb?mb:Pa.fileName,"\x3c/a\x3e, ").concat(cb).concat(vb,"\n          ").concat(Ya);$a.innerHTML="".concat(ab," ").concat(Pa)});X.isVectorTileService&&X.getRelatedItems("Service2Style",
"forward").then(function(Pa){0<Pa.length&&(la.domNode.querySelector(".js-otherStyles-label").innerHTML="Other Styles:",Pa.forEach(function(cb,Ya){var bb="item.html?id\x3d".concat(cb.id);ba.default.create("ul",{class:"leader-0 trailer-0 padding-left-1 inline-block other-styles-".concat(Ya)},la.domNode.querySelector(".js-otherStyles"),"last");ba.default.create("a",{href:bb,innerHTML:cb.title,target:"_blank"},la.domNode.querySelector(".other-styles-".concat(Ya)));ba.default.create("span",{innerHTML:", ".concat(cb.displayName)},
la.domNode.querySelector(".other-styles-".concat(Ya)),"last")}))});if(null===ja||void 0===ja?0:ja.length)Za.innerHTML=wa.default.substitute("".concat(this.i18n.itemProperties.creatingDataIn," ").concat('\x3ca href\x3d"item.html?id\x3d${relItem.id}"\x3e${relItem.title}\x3c/a\x3e, ${relItem.sentenceCaseDisplayName}'),{relItem:null===(oa=ja.slice(0,1))||void 0===oa?void 0:oa.shift(),i18n:this.i18n}),B.default.forEachNode(document.querySelectorAll(".js-details"),function(Pa){Pa.classList.add("has-resultCreatingIn")});
if(null===Qa||void 0===Qa?0:Qa.length){var ib=Qa.slice(0,5);var db=ib.reduce(function(Pa,cb,Ya,bb){return la.renderResultItems(Pa,cb,Ya,bb)},"");db+=this.toSearchString(Qa,5);gb.innerHTML=db;B.default.forEachNode(document.querySelectorAll(".js-details"),function(Pa){return Pa.classList.add("has-resultVisualizations")})}if(null===Ta||void 0===Ta?0:Ta.length)ib=Ta.slice(0,5),db=ib.reduce(function(Pa,cb,Ya,bb){return la.renderResultItems(Pa,cb,Ya,bb)},""),db+=this.toSearchString(Ta,5),eb.innerHTML=db,
B.default.forEachNode(document.querySelectorAll(".js-details"),function(Pa){return Pa.classList.add("has-resultDataViews")})};La.prototype.renderResultItems=function(X,la,ja,oa){return X+wa.default.substitute('\x3cli\x3e\x3ca href\x3d"item.html?id\x3d${relItem.id}"\x3e${relItem.title}\x3c/a\x3e, ${displayName}\x3c/li\x3e',{relItem:la,displayName:la.sentenceCaseDisplayName,i18n:this.i18n})};La.prototype.toSearchString=function(X,la){var ja=X.length-la,oa=X.map(function(ua){return"id:".concat(ua.id)}).join(" OR ");
return X.length>la?wa.default.substitute('\x3cli\x3e\x3ca target\x3d"_blank" href\x3d"search.html?t\x3dcontent\x26q\x3d(${query})"\x3e${i18n.FilterDlg.and} ${count} ${i18n.itemProperties.more}\x3c/a\x3e\x3c/li\x3e',{query:encodeURIComponent(oa),i18n:this.i18n,count:ja||0}):""};La.prototype.showItemCompleteness=function(X,la){var ja=this,oa="snippet thumbnail description title tags licenseInfo".split(" "),ua=this.domNode.querySelector(".js-scoreCompletenessClosed"),Da=this.domNode.querySelector(".js-scoreCompletenessOpen"),
Ha=this.domNode.querySelector(".js-itemCompleteness-list"),Ja=this.domNode.querySelector(".js-itemCompleteness-top"),Ma=X.setScoreCompleteness(X.scoreCompleteness),Qa=!1;if(X.canUpdate){Qa=oa.map(function(Va){return ja.getAttributeCompleteness(Va,X)});var Ta=Qa.reduce(function(Va,Xa,ib,db){return ja.toItemCompletenessList(Va,Xa,ib,db)},""),$a='\x3cspan class\x3d"padding-right-half inline-block"\x3e'+P.default.inline.lightbulb[24]+'${i18n.itemCompleteness.topImprovement}\x3c/span\x3e\x3cbutton data-attribute\x3d"${attribute}" class\x3d"btn-link font-size--2 js-itemCompleteness-attr"\x3e${msg}\x3c/a\x3e',
Za=Qa.filter(function(Va){return!Va.isComplete&&Va.msg});Qa=!Za||!Za.length;Ma=!Qa&&90<Ma?90:Ma;ba.default.empty(Ha);Ha.innerHTML=Ta;document.querySelectorAll(".js-item-scoreCompleteness-bar").forEach(function(Va){Va.style.width="".concat(Ma,"%");Va.parentElement.setAttribute("aria-valuenow",Ma.toString())});Qa?(ba.default.empty(Ja),Ta=document.querySelector(".js-itemCompleteness-wellDone"),Ta.innerHTML=this.page._formatWellDone(Ma),B.default.showHide(Ta,la)):(Ja.innerHTML=wa.default.substitute($a,
N.default.mixin(Za.shift(),{i18n:this.i18n})),B.default.showNode(Ja),B.default.hideNodes(document.querySelectorAll(".js-itemCompleteness-wellDone")));100===Ma&&(B.default.showNode(ua),B.default.hideNode(Da),ua.classList.remove("hide"),Da.classList.add("hide"));if(!la){var gb=this.domNode.querySelector(".js-hide-itemCompleteness"),eb=this.domNode.querySelector(".js-show-itemCompleteness");this.own((0,sa.default)(gb,"click",function(){eb.setAttribute("aria-expanded","false");setTimeout(function(){eb.focus()},
100);B.default.showNode(ua);B.default.hideNode(Da)}),(0,sa.default)(eb,"click",function(){eb.setAttribute("aria-expanded","true");setTimeout(function(){gb.focus()},100);B.default.hideNode(ua);B.default.showNode(Da)}),(0,sa.default)(Ha,".js-itemCompleteness-attr:click",function(Va){var Xa;Va=Va.target.dataset.attribute;Va=document.querySelector("[data-edit-id\x3d'".concat(Va,"'].js-inline-edit"))||document.querySelector("[data-edit-id\x3d'".concat(Va,"'].js-action-editThumbnail"));null===(Xa=null===
Va||void 0===Va?void 0:Va.click)||void 0===Xa?void 0:Xa.call(Va)}),(0,sa.default)(Ja,".js-itemCompleteness-attr:click",function(Va){var Xa;Va=document.querySelector("[data-edit-id\x3d'".concat(Va.target.dataset.attribute,"'].js-inline-edit"));if(null===Va||void 0===Va?0:Va.click)ja.page.topImprovementClicked=!0,null===(Xa=ja.page.telemetry)||void 0===Xa?void 0:Xa.logEvent(p.__assign(p.__assign({},ja.page.baseTelemetryPayload),{category:"item action",action:"top improvement"})),Va.click(),setTimeout(function(){ja.page.topImprovementClicked=
!1},200)}),this.item.watch(function(Va){(-1<oa.indexOf(Va)||"thumbnailUrl"===Va)&&ja.showItemCompleteness(ja.item,!0)}))}}else B.default.hideNodes(document.querySelectorAll(".js-scoreCompletenessClosed, .js-scoreCompletenessOpen"))};La.prototype.toItemCompletenessList=function(X,la,ja,oa){oa='\x3cspan class\x3d"tooltip tooltip-multiline tooltip-bottom-left" aria-label\x3d"${tip}"\x3e\x3cbutton data-attribute\x3d"${attribute}" class\x3d"btn-link font-size--3 text-left break-word js-itemCompleteness-attr"\x3e${msg}'+
'\x3cspan class\x3d"screen-readers-only"\x3e'.concat(this.i18n.itemCompleteness[la.isComplete?"complete":"incomplete"],"\x3c/span\x3e")+"\x3c/button\x3e\x3c/span\x3e";ja='\x3cli class\x3d"icon-ui-radio-unchecked icon-ui-gray leader-0 trailer-0 flex"\x3e'.concat(oa,"\x3c/li\x3e");oa='\x3cli class\x3d"icon-ui-check-mark icon-ui-gray leader-0 trailer-0 flex"\x3e'.concat(oa,"\x3c/li\x3e");return X+wa.default.substitute(la.isComplete?oa:ja,la)};La.prototype.getAttributeCompleteness=function(X,la){var ja=
this.i18n.itemCompleteness;var oa=!la[X];switch(X){case "title":la=!oa&&(1<la[X].replace(/^[\s_]+|[\s_]+$/g,"").split(/[\s_]+/).length||14<la[X].length);oa=oa||la?ja.addTitle:ja.addLongerTitle;X={msg:oa,tip:ja.addTitleTip,attribute:X,isComplete:la};break;case "tags":la=oa||"string"!==typeof la[X]?la[X]:la[X].split(",");var ua=la.length;la=2<ua;oa=oa||la?ja.addTags:ja.addLongerTags;X={msg:wa.default.substitute(oa,{num:ua,total:"3"}),tip:ja.addTagsTip,attribute:X,isComplete:la};break;case "snippet":la=
!oa&&9<la[X].split(" ").length;oa=oa||la?ja.addSummary:ja.addLongerSummary;X={msg:oa,tip:ja.addSummaryTip,attribute:X,isComplete:la};break;case "thumbnail":la=ia.default.isDefined(la.thumbnail);X={msg:ja.addCustomThumbnail,tip:ja.addCustomThumbnailTip,attribute:X,isComplete:la};break;case "description":la=!oa&&99<J.default.stripHTML(la[X].replace(/<br\s*\/?>/gi," ")).replace(/^\s+|\s+$/g,"").split(/\s+/).length;oa=oa||la?ja.addDescription:ja.addLongerDescription;X={msg:oa,tip:ja.addDescriptionTip,
attribute:X,isComplete:la};break;case "licenseInfo":la=!oa;oa=oa||la?ja.addTermsOfUse:ja.addLongerTermsOfUse;X={msg:oa,tip:ja.addTermsOfUse,attribute:X,isComplete:la};break;default:X={msg:"",tip:"",attribute:X,isComplete:!1}}return X};La.prototype.showThumbnailActions=function(X){var la=this.i18n.itemProperties,ja=document.getElementById("thumbnailAspectRatioTip"),oa=document.getElementById("thumbnailAspectRatioTipButton");if(!X.thumbnail||X.isRetired)oa&&B.default.hideNode(oa);else if(null!==X.thumbnailUrl){var ua=
new Image;ua.src=X.thumbnailUrl;var Da=L.default.getAbsoluteUrl("images/transparent.gif");ua.src!==Da?ua.onload=function(){var Ha=.1>Math.abs(1.5-ua.width/ua.height);!Ha&&ja&&(ja.innerHTML=wa.default.substitute(la.thumbnailAspectRatioTip,{aspectRatio:"3:2"}));oa&&B.default.showHide(oa,!Ha&&X.canUpdate)}:oa&&(null===oa||void 0===oa?void 0:oa.classList.add("hide"))}};La.prototype._showCollaboratedContentNode=function(X){var la=["Hosted Service","arcgis.com","Registered App"],ja=this.portalUser,oa=!ja||
!(null===ja||void 0===ja?0:ja.username);ja=!(null===ja||void 0===ja?0:ja.orgId);(null===X||void 0===X?0:X.origin)&&-1===la.indexOf(X.origin)&&!oa&&!ja&&(X=document.querySelector(".js-collaboratedNode"),la=ba.default.create("span",{className:"label esri-premium-content",title:this.i18n.common.collaboratedcontenttitle,innerHTML:this.i18n.common.collaboratedcontent}),ba.default.place(la,X,"first"),X.classList.remove("hide"))};La.prototype.showCategories=function(X){var la,ja=this.portalUser,oa=this.item,
ua=oa.portal;oa=oa.categories;var Da=null===ua||void 0===ua?void 0:ua.hasCategorySchema,Ha=!(null===(la=X.categories)||void 0===la||!la.length);this.categoryEdit=new l.default({prop:"categories",inputType:"categories",inputLabel:this.i18n.contentCategories.edit,viewTitle:this.i18n.contentCategories.categories,formTitle:this.i18n.contentCategories.addCategory,formClass:"trailer-1",portal:ua,value:oa},this.domNode.querySelector(".js-category-section"));Da&&(null===ja||void 0===ja?0:ja.isOrgUser)&&X.canUpdate?
this.categoryEdit.initCategoryPicker():Ha||this.categoryEdit.hide()};La.prototype.setLayerAttributes=function(X,la){var ja=X.supportsAppend,oa=X.hasMetadata;X.attributes=[];X.id=X.id||0;X.layerMetadataUrl="";X.attributes.push(la.isHostedService?"is-hosted":"is-not-hosted");la.portal.isPortal||(X.attributes.push(la.isLocationTrackingService?"is-location-tracking":""),la.isLocationTrackingService&&-1<[1,2].indexOf(X.id)&&X.attributes.push("no-location-tracking-export"));la.canUpdate&&"Table"!==X.type&&
n.default.getDateFields(X).length?X.attributes.push("has-dateTime"):la.canUpdate&&"Table"!==X.type&&!n.default.getDateFields(X).length&&X.attributes.push("has-no-dateTime");la.isAdmin&&ja&&X.attributes.push("can-appendData");!la.isLocationTrackingService&&la.canUpdate&&la.isHostedService&&(la.isAdmin||la.isOwner)&&X.attributes.push("can-renameLayer");oa&&X.url&&(X.attributes.push("has-layerMetadata"),ja=X.url.split("?"),oa=N.default.mixin(1<ja.length?E.queryToObject(ja[1]):{},{format:"default",f:"html"}),
X.layerMetadataUrl="".concat(ja[0],"/metadata?").concat(E.objectToQuery(oa)));X.mapViewerUrl="".concat(la.mapViewerUrl,"\x26layerId\x3d").concat(X.id);X.mapViewerUrlWithGeocode="".concat(la.mapViewerWithReviewUrl,"\x26layerId\x3d$layer.id}");X.newMapViewerUrl=la.newMapViewerUrl&&"".concat(la.newMapViewerUrl,"\x26layerId\x3d").concat(X.id)||"";X.sceneViewerUrl="".concat(la.sceneViewerUrl,"\x26layerId\x3d").concat(X.id)};La.prototype._setToolAttr=function(X,la){X.attributes=[]};La.prototype.showComments=
function(X){var la=this,ja;this.portalUser&&new f.default({member:this.portalUser},this.domNode.querySelector(".js-portal-user-top-level-avatar"));ba.default.empty("comments");if(X.numComments){X.comments.forEach(function(ua){var Da;la.renderComment(ua,ra.default,"comments");null===(Da=ua.replies)||void 0===Da?void 0:Da.forEach(function(Ha){return la.renderComment(Ha,Ra.default,"comments")})});document.getElementById("comments").classList.remove("hide");var oa=document.querySelector(".js-loadMore-comments");
-1<(null===(ja=X.commentsInfo)||void 0===ja?void 0:ja.nextStart)?oa.classList.remove("hide"):oa.classList.add("hide")}};La.prototype.renderComment=function(X,la,ja){var oa=this.item,ua=this.portalUser,Da=this.i18n,Ha=X.ownerProfile,Ja=(null===ua||void 0===ua?void 0:ua.username)===X.owner,Ma=X.owner===oa.owner;oa=[].concat(X.numReplies||!oa.isAdmin&&!Ja?"":"can-delete-comment").concat(Ma?"is-item-owner":"is-not-item-owner");ua={comment:X,i18n:Da,portalUser:ua,commentOwnerProfile:Ha,classNames:oa.join(" ")};
la=wa.default.substitute(la,ua,function(Qa){return Qa||""},this.page);ja=ba.default.place(la,ja,"next");new f.default({member:X.ownerProfile},document.querySelector('[data-comment-id\x3d"'.concat(X.id,'"] .js-comment-avatar')));this.portalUser&&new f.default({member:this.portalUser},ja.querySelector(".js-portal-user-avatar"));return ja};La.prototype.showFolders=function(X){var la;if(X.isAdmin){var ja=null!==(la=X.itemOwner)&&void 0!==la?la:{},oa=X.folderId||ja.username;(ja.folders||[]).some(function(ua){return ua.id===
oa?(document.querySelector(".js-folder-title").innerHTML="".concat(P.default.inline.folder["16"]).concat(ua.title),!0):!1})}};La.prototype.showScreenshots=function(X){var la=this,ja=document.querySelector(".js-screenshotGroup"),oa=X.screenshots||[],ua="".concat(X.itemUrl,"/info/"),Da=this.portalUser,Ha=(Da=null===Da||void 0===Da?void 0:Da.getToken())?"?token\x3d".concat(Da):"";oa.length&&("Deep Learning Package"===X.type?(document.querySelector(".js-screenshots-title").innerHTML=this.i18n.itemProperties.modelCharacteristics,
oa.forEach(function(Ja){ba.default.place(wa.default.substitute(xa.default,{url:ua+Ja+Ha,i18n:la.i18n,icons:la.icons}),ja)}),this.own((0,ya.default)(".js-model-characteristic",this.domNode).on("click",function(Ja){Ja=Ja.target.querySelector(".js-model-characteristic-img");(new d.default({url:Ja.src,width:Ja.naturalWidth,height:Ja.naturalHeight,title:la.i18n.itemProperties.modelCharacteristics})).open()}))):oa.forEach(function(Ja){ba.default.place(wa.default.substitute('\x3cdiv class\x3d"block trailer-1"\x3e\x3cimg src\x3d"${url}"\x3e\x3c/div\x3e',
{url:ua+Ja+Ha}),ja)}))};La.prototype.showUrbanModelInfo=function(X){if("Urban Model"===X.type){X=X.properties||{};var la=X.master,ja=X.publicView;X=[la,ja].filter(function(oa){return oa});X.length&&(X="id:(".concat(X.join(" OR "),")"),this.page.portal.queryItems({q:X,num:2}).then(function(oa){oa=oa.results||[];var ua=oa.find(function(Ha){return Ha.id===la});oa=oa.find(function(Ha){return Ha.id===ja});if(ua){var Da=document.querySelector(".js-urban-database");ua='\x3ca href\x3d"item.html?id\x3d'.concat(ua.id,
'" target\x3d"_blank"\x3e').concat(ua.title,"\x3c/a\x3e");Da.innerHTML=wa.default.substitute(Ka.default.itemProperties.urbanDatabase,{link:ua});Da.classList.remove("hide")}oa&&(Da=document.querySelector(".js-urban-view"),ua='\x3ca href\x3d"item.html?id\x3d'.concat(oa.id,'" target\x3d"_blank"\x3e').concat(oa.title,"\x3c/a\x3e"),Da.innerHTML=wa.default.substitute(Ka.default.itemProperties.urbanDatabaseView,{link:ua}),Da.classList.remove("hide"))}))}};La.prototype.showMapImageLayerProperties=function(X){var la=
X.isCachedMapImageLayer,ja=X.serviceInfo;"Map Service"!==X.type||-1===X.types.indexOf("is-mapImage")||!ja||null!==ja&&void 0!==ja&&ja.error||(this.domNode.querySelector(".js-map-image-layer-details").classList.remove("hide"),la?this.domNode.querySelector(".js-map-image-layer-drawing-cached").classList.remove("hide"):this.domNode.querySelector(".js-map-image-layer-drawing-dynamic").classList.remove("hide"))};La.prototype.showImageProperties=function(X){var la,ja,oa=X.serviceInfo;if("Image Service"===
X.type&&oa&&(null===oa||void 0===oa||!oa.error)){("esriImageServiceSourceTypeMosaicDataset"===oa.serviceSourceType||(null===(la=oa.fields)||void 0===la?0:la.length))&&document.querySelector(".js-image-service-source-collection").classList.remove("hide");X=Ka.default.itemProperties.pixelTypes.U1;X=p.__assign(p.__assign({},Ka.default.itemProperties.pixelTypes),{U2:X,U4:X,U8:X,C128:Ka.default.itemProperties.pixelTypes.C64});la=(null===(ja=oa.serviceDataType)||void 0===ja?void 0:ja.replace("esriImageServiceDataType",
""))||"Generic";ja=Ka.default.itemProperties.imageServiceTypes[la]||Ka.default.itemProperties.imageServiceTypes.Generic;X=X[oa.pixelType]||Ka.default.itemProperties.unknown;la=oa.bandCount;var ua=oa.spatialReference,Da=Ka.default.itemProperties.unknown;(null===ua||void 0===ua?0:ua.wkid)?(Da=da.default.units[da.default[ua.wkid]],ua=-1<[4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140].indexOf(ua.wkid)?"grad":"degrees",Da=Da||ua):(null===ua||void 0===ua?0:ua.wkt)&&(ua=/UNIT\[([^\]]+)\]\]$/i.exec(ua.wkt))&&
ua[1]&&(Da=ua[1].split(",")[0].replace(/['"]+/g,""));document.querySelector(".js-image-properties-source-type").textContent=wa.default.substitute(Ka.default.itemProperties.sourceType,{sourceType:ja});X&&(document.querySelector(".js-image-properties-pixel-type").textContent=wa.default.substitute(Ka.default.itemProperties.pixelType,{pixelType:X}));la&&(document.querySelector(".js-image-properties-bands").textContent=wa.default.substitute(Ka.default.itemProperties.bands,{bands:la}));oa.pixelSizeX&&oa.pixelSizeY&&
(oa="".concat(oa.pixelSizeX," / ").concat(oa.pixelSizeY," ").concat(Da),document.querySelector(".js-image-properties-cell-size").textContent=wa.default.substitute(Ka.default.itemProperties.cellSize,{cellSize:oa}));document.querySelector(".js-image-service-details").classList.remove("hide")}};La.prototype.showProjectContent=function(X,la){if(null===X||void 0===X?0:X.projectContent){var ja=document.querySelector(".js-projectContent");X=X.itemData;la=X.workerWebMapId;var oa=X.dispatchers,ua=X.assignments,
Da=X.workers,Ha=X.tracks,Ja=function(Ma){(null===Ma||void 0===Ma?0:Ma.id)&&(null===Ma||void 0===Ma?0:Ma.title)&&ba.default.place(wa.default.substitute('\x3ctr\x3e\x3ctd\x3e\x3ca target\x3d "_blank" href\x3d"item.html?id\x3d${id}"\x3e${title}\x3c/a\x3e\x3c/td\x3e\x3c/tr\x3e',{id:Ma.id,title:Ma.title}),ja)};Ja({id:X.dispatcherWebMapId,title:this.i18n.itemProperties.dispatcherMap});Ja({id:la,title:this.i18n.itemProperties.mobileWorkerMap});Ja({id:ua.serviceItemId,title:this.i18n.itemProperties.assignments});
Ja({id:oa.serviceItemId,title:this.i18n.itemProperties.dispatchers});Ja({id:Da.serviceItemId,title:this.i18n.itemProperties.workers});Ja({id:Ha.serviceItemId,title:this.i18n.itemProperties.workerTracks})}};La.prototype.showWorkflowContent=function(X){var la=null===X||void 0===X?void 0:X.workflowContent;"Workflow"===(null===X||void 0===X?void 0:X.type)&&la&&(X=document.querySelector(".js-workflowContent"),ba.default.place(wa.default.substitute(ha.default,{id:(la.workflowLocations||{}).itemId,title:this.i18n.itemProperties.workflowJobLocations}),
X))};La.prototype.showSolutionContent=function(X){var la=this,ja=document.querySelector(".has-solutionContent");if("Solution"===X.type&&ja)try{var oa=X.itemData.templates,ua=-1<X.typeKeywords.indexOf("Deployed");(ua?this.updateTemplates(oa):(new Aa.default).resolve({templates:oa,removeTemplates:[]})).then(function(Da){la.createHierarchyDisplay(Da.templates,ua,Da.removeTemplates);la.initSolutionRowHandler()})}catch(Da){ja.classList.remove("has-solutionContent")}};La.prototype.initSolutionRowHandler=
function(){var X=(0,ya.default)(".js-solution-row",this.domNode);if(0<X.length){var la=function(ja){if(ja instanceof MouseEvent||13===ja.keyCode||32===ja.keyCode)32===ja.keyCode&&(ja.preventDefault(),ja.target.parentNode.classList.contains("accordion-title")&&ja.target.click()),ja=ja.srcElement,(ja=ja.classList.contains("accordion-title")?ja.parentNode:ja.parentNode.classList.contains("accordion-title")?ja.parentNode.parentNode:void 0)&&(ja.classList.contains("is-active")?B.default.deactivateNode(ja):
B.default.activateNode(ja))};X.on("click",la);X.on("keydown",la)}else document.querySelector(".has-solutionContent").classList.remove("has-solutionContent")};La.prototype.updateTemplates=function(X){function la(Ha,Ja,Ma){return L.default.request({url:Ha,content:{f:"json",num:Ma,q:Ja}})}var ja=new Aa.default,oa=[];X.forEach(function(Ha){var Ja=oa.push;Ha=Ha.itemId;Ha=Ha.startsWith("{{")?Ha.substring(2,Ha.indexOf(".")):Ha;return Ja.call(oa,"id:"+Ha)});for(var ua=[];0<oa.length;){var Da=oa.splice(0,
100).join(" OR ");ua.push(la("".concat(this.item.portal.url,"search"),Da,100));ua.push(la("".concat(this.item.portal.url,"community/groups"),Da,100))}(0,Ea.default)(ua).then(function(Ha){var Ja=[];Ha.forEach(function(Qa){Ja=Ja.concat(Qa.results||[])});var Ma=[];X.forEach(function(Qa){var Ta=Ja.filter(function($a){return $a.id===Qa.itemId});0<Ta.length?Qa.item=Ta[0]:Ma.push(Qa.itemId)});ja.resolve({templates:X,removeTemplates:Ma})});return ja};La.prototype.getTopLevelItemIds=function(X){var la=X.map(function(ja){return ja.itemId});
X.forEach(function(ja){(ja.dependencies||[]).forEach(function(oa){oa=la.indexOf(oa);0<=oa&&la.splice(oa,1)})});return la};La.prototype.getItemHierarchy=function(X){function la(Ha,Ja){var Ma=Ha.findIndex(function(Qa){return Ja===Qa.itemId});return 0<=Ma?Ha[Ma]:null}function ja(Ha,Ja,Ma){void 0===Ma&&(Ma=[]);var Qa=la(X,Ha);if(Qa){var Ta={id:Ha,dependencies:[]};0>Ma.indexOf(Ha)&&(Ma.push(Ha),Qa.dependencies.forEach(function($a){var Za=ua.indexOf($a);0<=Za&&ua.splice(Za,1);ja($a,Ta.dependencies,Ma)}));
Ja.push(Ta)}}var oa=[],ua=this.getTopLevelItemIds(X),Da=X.filter(function(Ha){return 0>ua.indexOf(Ha.itemId)}).sort(function(Ha,Ja){return Ja.dependencies.length-Ha.dependencies.length});ua=ua.concat(Da.map(function(Ha){return Ha.itemId}));for(Da=ua.shift();"undefined"!==typeof Da;)ja(Da,oa),Da=ua.shift();return oa};La.prototype.createHierarchyDisplay=function(X,la,ja){var oa=this,ua=document.querySelector(".js-solutionContent"),Da=function(Ha){if((null===Ha||void 0===Ha?0:Ha.title)&&(null===Ha||
void 0===Ha?0:Ha.source)&&(null===Ha||void 0===Ha?0:Ha.type)){var Ja=ba.default.toDom(wa.default.substitute(Ca.default,{title:Ha.title,source:Ha.source,child:Ha.child,type:Ha.type,icons:P.default}));if(""===Ha.child){var Ma=Ja.querySelector(".accordion-title");Ma.classList.add("accordion-title-parent-only");["filters--accordion--title","filters--accordion--title__override"].forEach(function(Qa){return Ma.classList.remove(Qa)});Ha=Ma.querySelector(".icon-inline");Ma.removeChild(Ha);Ha=Ja.querySelector(".accordion-content");
Ha.parentNode.removeChild(Ha)}ba.default.place(Ja,ua)}};this.getItemHierarchy(X).forEach(function(Ha){if(0>ja.indexOf(Ha.id)){var Ja=X.filter(function(Za){return Za.itemId===Ha.id})[0],Ma=Ja.item;Ma.iconUrl=G.default._getItemIconUrl(Ma);"Group"!==Ja.type&&w.default.getItemInfo(Ma);var Qa=Ma.title||Ma.name||Ja.type,Ta="Group"===Ja.type?"group":"item",$a=Array.isArray(Ha.dependencies)&&0<Ha.dependencies.length;Da({title:la?wa.default.substitute("\x3ca href\x3d'${webpage}.html?id\x3d${id}' target\x3d'_blank'\x3e${label}\x3c/a\x3e",
{id:Ha.id,webpage:Ta,label:Qa}):Qa,source:"group"===Ta?"js/arcgisonline/css/images/userGroup.png":Ma.svgIconUrl16,child:$a?oa.createChildHierarchyDisplay({solutionItems:X,hierarchy:Ha.dependencies,createLinks:la,groupImage:"js/arcgisonline/css/images/userGroup.png",linkTemplate:"\x3ca href\x3d'${webpage}.html?id\x3d${id}' target\x3d'_blank'\x3e${label}\x3c/a\x3e",removeTemplates:ja}):"",type:Ja.type})}})};La.prototype.createChildHierarchyDisplay=function(X){var la=this,ja=X.solutionItems,oa=X.createLinks,
ua=X.groupImage,Da=X.linkTemplate,Ha=X.removeTemplates,Ja=[];X.hierarchy.forEach(function(Ma){if(0>Ha.indexOf(Ma.id)){var Qa=ja.filter(function(eb){return eb.itemId===Ma.id})[0],Ta=Qa.item;Ta.iconUrl=G.default._getItemIconUrl(Ta);"Group"!==Qa.type&&w.default.getItemInfo(Ta);var $a=Ta.title||Ta.name||Qa.type,Za="Group"===Qa.type?"group":"item",gb=Array.isArray(Ma.dependencies)&&0<Ma.dependencies.length;Ja.push(wa.default.substitute(H.default,{source:"group"===Za?ua:Ta.svgIconUrl16,type:Qa.type,titleOrLink:oa?
wa.default.substitute(Da,{webpage:Za,id:Ma.id,label:$a}):$a,childList:gb?la.createChildHierarchyDisplay({solutionItems:ja,hierarchy:Ma.dependencies,createLinks:oa,groupImage:ua,linkTemplate:Da,removeTemplates:Ha}):""}))}});return Ja.join("")};La.prototype.showFormContent=function(X){var la,ja,oa="Form"===X.type||"QuickCapture Project"===X.type,ua=(null===(la=X.relatedService)||void 0===la?void 0:la.length)&&(null===(ja=X.relatedService)||void 0===ja?void 0:ja[0]);oa&&ua&&(X=(0,ya.default)(".js-formContent").shift(),
ba.default.place(wa.default.substitute('\x3cspan\x3e\x3ca target\x3d "_blank" href\x3d"item.html?id\x3d${id}"\x3e${title}\x3c/a\x3e\x3c/span\x3e',{id:ua.id,title:ua.title}),X))};La.prototype.updateComments=function(){var X=this,la=new Aa.default;this.page.fetchComments(this.item).then(function(){Z.default.set("addComment","value","");B.default.forEachNode(document.querySelectorAll(".js-numComments"),function(ja){return ja.innerHTML="(".concat(X.page._formatCount(X.item.numComments),")")});X.showComments(X.item);
la.resolve(X.item)});return la};La.prototype.updateBadges=function(){this.domNode.querySelector(".js-item-badges").innerHTML="";B.default.createElement("arcgis-item-badges",{item:this.item,user:this.portalUser,width:"full",showTooltips:!0,scale:"m",portal:this.page.portal},this.domNode.querySelector(".js-item-badges"))};La.prototype.updateRatings=function(){(0,a.render)((0,a.h)(O.Ratings,{user:this.portalUser,item:this.item,telemetry:this.page.telemetry}),document.querySelector(".js-update-ratings"))};
La.prototype.checkForCachingJob=function(X){var la=this,ja="Vector Tile Service"===X.type,oa=X.cachingJobUrl||X.properties&&X.properties.cacheJobUrl,ua=function(Da){var Ha=Da&&(Da.status||Da.jobStatus),Ja=(Ha=!(!Ha||!A.default.includes(["Completed","esriJobSucceeded","Failed","esriJobFailed"],Ha)))?b.default.getEndTime(Da):void 0;Ja=Ja?Date.now()-Ja:void 0;la.page._item.set("lastCachingJobStatus",Da);Ha&&Ja&&1728E5>Ja||(la.page._item.set("cachingJobUrl",void 0),la.page._item.set("serviceChanged",
!0),la.page.dropCacheJobInfo())};"Scene Service"===X.type&&oa&&(X.isOwner||X.isAdmin)?(X=new Aa.default,b.default.checkSceneCachingJobStatus(this.page._item,this.CACHE_CHECK_INTERVAL,X),X.then(ua,ua)):ja&&this.page._item.adminUrl&&this.item.watch("readyToRetrieveServiceLayers",function(){b.default.checkVectorTileServiceJobStatus(la.page._item,la.CACHE_CHECK_INTERVAL).then(ua,ua)})};La.prototype.getShortenedUrl=function(){var X=this,la=new Aa.default,ja=this.page.portal,oa=L.default.parseUrl(window.location.href).host;
ja=window.location.href.replace(oa,"multitenant"===ja.portalMode?ja.portalHostname||oa:oa);this._fetchingShortUrl?setTimeout(function(){X.getShortenedUrl().then(function(ua){la.resolve(ua)})},250):(this._fetchingShortUrl=!0,(0,ca.default)(this.item.shortUrl||L.default.shortenUrl(ja),function(ua){X.item.set("shortUrl",ua);X._fetchingShortUrl=!1;la.resolve(ua)}));return la};La.prototype.fetchLastSnapshot=function(){var X=new Aa.default,la="".concat(this.item.itemUrl,"/resources/").concat("cdwServiceInfo.json");
L.default.request({url:la}).then(function(ja){X.resolve((null===ja||void 0===ja?0:ja.lastSnapshot)?ja.lastSnapshot:void 0)},function(){X.resolve(void 0)});return X};La.prototype.initHandlers=function(){var X=this;this.domNode.querySelector(".js-layers").addEventListener("click",this.handleLayerClick.bind(this));this.domNode.querySelector(".js-tables").addEventListener("click",this.handleLayerClick.bind(this));this.own(this.item.watch("folderId",function(ja){var oa=document.querySelector(".js-folders [data-folder-id\x3d'".concat(X.item.folderId,
"']"));B.default.forEachNode(document.querySelectorAll(".js-folder-title"),function(ua){return ua.innerHTML=oa.innerHTML})}),this.item.watch("thumbnailUrl",function(ja,oa,ua){var Da,Ha;if(ua!==oa){ja=(null===(Da=X.item.thumbnailUrl)||void 0===Da?void 0:Da.split("?"))||[];var Ja=ja[0]||X.item.thumbnailUrl;Da=(Da=ja[1])?E.queryToObject(Da):{};if(ja=null===(Ha=X.portalUser)||void 0===Ha?void 0:Ha.getToken())Da.token=ja;Da.ts=(new Date).getTime();Ja="".concat(Ja,"?").concat(E.objectToQuery(Da));B.default.forEachNode(document.querySelectorAll(".thumbnail-img"),
function(Ma){return Ma.src=Ja})}X.showThumbnailActions(X.item)}),this.item.watch("description",function(){X._descriptionSection.updateValue(X.item.description)}),this.item.watch("snippet",function(){X._snippetSection.updateValue(X.item.snippet)}),this.item.watch("licenseInfo",function(){X._licenseInfoSection.updateValue(X.item.licenseInfo)}),this.item.watch("accessInformation",function(){X._accessInfo.updateValue(X.item.accessInformation)}),this.item.watch("tags",function(){X._tagsSection.updateValue(X.item.tags||
[])}),this.item.watch("contentStatus",function(){F.default.getVerifiedInfo(X.item).then(function(ja){X.item.set("verified",ja);X.showOwner(X.item);X.updateBadges()})}),this.item.watch("sharing",function(){var ja=X.item,oa="public"===ja.sharing.access.toString(),ua=ja.privileges,Da=ja.types;Da=A.default.concatUnique(Da||[],oa?["is-public"]:["is-not-public"]);Da=A.default.filterOut(Da,oa?["is-not-public"]:["is-public"]);ja.set("types",A.default[oa?"concatUnique":"filterOut"](Da,["is-public"]));X.showShareStatus(ja);
ja.isHostedService&&(0,Ea.default)({canPublishWFSService:m.default.canPublishWFSServiceFromFeatureService(ja),canPublishOGCFeatureServer:m.default.canPublishOGCFeatureServerFromFeatureService(ja)}).then(function(Ha){if(Ha.canPublishWFSService){var Ja=m.default.isMultipatchFeatureService(ja);Da=A.default.concatUnique(Da,["is-publish"]);ua=A.default[Ha.canPublishWFSService&&!Ja?"concatUnique":"filterOut"](ua||[],["can-publish-wfs"])}else Da=m.default.canPublishTileServiceFromFeatureService(ja)?Da:A.default.filterOut(Da,
["is-publish"]),ua=A.default.filterOut(ua||[],["can-publish-wfs"]);ua=Ha.canPublishOGCFeatureServer?A.default[Ha.canPublishOGCFeatureServer?"concatUnique":"filterOut"](ua||[],["can-publish-ogcfeatures"]):A.default.filterOut(ua||[],["can-publish-ogcfeatures"]);ja.set("types",Da);ja.set("privileges",ua)});ja.set("contentStatus",R.default.getContentStatus(ja));X.configureViewUI();!ja.portal.isPortal&&ja.isHostedService&&"Map Service"===ja.type&&ja.serviceInfo.singleFusedMapCache&&ja.set("wmtsUrl",oa?
I.default.wmtsUrl(ja):void 0)}),this.item.watch("wmtsUrl",function(){var ja,oa,ua=X.item.wmtsUrl;!X.item.portal.isPortal&&ua?(-1<ua.indexOf(".arcgis.com")&&-1<ua.indexOf("http://")&&(ua=ua.replace("http://","https://")),X._copyWmtsUrlDijit?X._copyWmtsUrlDijit.updateText(X.item.wmtsUrl):X._copyWmtsUrlDijit=new D.default({text:null!==ua&&void 0!==ua?ua:"",tooltipModifier:"tooltip-left",id:"wmtsUrl",label:X.i18n.itemProperties.wmtsUrl},document.getElementById("copyToClipBoardWMTSURL")),X.domNode.querySelector(".js-wmts-link").href=
X.item.wmtsUrl,null===(ja=X.domNode.querySelector(".js-view-wmts-url"))||void 0===ja?void 0:ja.classList.remove("hide")):null===(oa=X.domNode.querySelector(".js-view-wmts-url"))||void 0===oa?void 0:oa.classList.add("hide")}),this.item.watch("status",function(){var ja=X.item,oa=ja.status;ja=ja.statusErrorCode;var ua="completed"===oa||"failed"===oa?"deactivateNode":"activateNode",Da="completed"===oa?"remove":"add";b.default.isVectorTileFromFeatures(X.item)&&(X.domNode.querySelector(".js-service-status .loader-text").innerHTML=
X.i18n.itemProperties.buildingCache);B.default[ua](document.querySelector(".js-service-status"));B.default.forEachNode(document.querySelectorAll(".js-status-disable"),function(Ha){return Ha.classList[Da]("btn-disabled")});"failed"===oa&&(X.page._showErrors=!0,X.page._showError(X.item.statusError),X.page.hideLoader(),400===ja||403===ja)&&(oa=document.querySelector(".js-subnav-link.js-status-disable"),null===oa||void 0===oa?void 0:oa.classList.remove("btn-disabled"))}),this.item.watch("displayName",
function(){X.domNode.querySelector(".js-typeOwner-info span span").innerHTML=X.item.displayName;X.item.iconUrl=G.default._getItemIconUrl(X.item);X.domNode.querySelector(".js-typeOwner-info span img").src=w.default.getSvgIconUrl(X.item,"16")}),this.item.watch("isLoaded",function(){return p.__awaiter(X,void 0,void 0,function(){var ja,oa,ua,Da,Ha,Ja,Ma,Qa,Ta,$a,Za,gb,eb,Va,Xa,ib,db,Pa,cb,Ya,bb,mb,jb,nb,ab,ob,pb,qb,lb=this,rb,sb,tb,ub,vb,wb,xb,yb,zb;return p.__generator(this,function(Ab){switch(Ab.label){case 0:return ja=
this.portalUser||{},oa=!!this.item.origin,ua=this.item.isAdmin||this.item.isOwner||ja.isOrgAdmin&&this.item.isOwnedByMyOrg,this.item.layers&&this.reverseLayers(this.item.layers),(Da=ua&&!this.sublayer)?[4,this.getLayerStatus(this.item)]:[3,2];case 1:Da=Ab.sent(),Ab.label=2;case 2:Da;this.showLayers(this.item);this.showImageProperties(this.item);this.showMapImageLayerProperties(this.item);this.showReplaceLayer(this.item);this.page._showDataLastUpdated(this.item);m.default.registerItemActions(this,
document.querySelector(".js-serviceLayers"),t.default);m.default.registerItemActions(this,document.querySelector(".js-serviceTables"),t.default);Q.default.dropdown();this.page.hideLoader();this.item.canUpdate&&A.default.includes(this.item.types,"is-storymap")&&!oa&&(document.body.classList.add("is-editable-storymap"),I.default.configureStoryMap(this.item),B.default.forEachNode(this.domNode.querySelectorAll(".js-configure-storymap"),function(fb){return fb.href=lb.item.configureStoryMapUrl}));this.item.canUpdate&&
["Web Experience","Web Experience Template"].includes(this.item.type)&&oa&&(Ha="Web Experience"===this.item.type?".if-can-edit-webExperience-and-not-blocked":".if-can-edit-webExperienceTemplate",null===(rb=this.domNode.querySelector("".concat(Ha,".js-open-btn")))||void 0===rb?void 0:rb.classList.add("hide"));if(Ja=this.domNode.querySelector(".js-vtse-edit"))"Vector Tile Service"===this.item.type&&(null===(sb=this.portalUser)||void 0===sb?0:sb.canCreateItems)?(Ja.classList.remove("hide"),I.default.setVectorTileStyleEditorUrl(this.item),
Ja.href=this.item.vtseEditUrl):Ja.classList.add("hide");this.item.canUpdate&&"Vector Tile Service"===this.item.type&&(Ma=this.domNode.querySelector("button[data-action\x3d'updateData']"))&&(Ma.textContent=Ka.default.common.update);Qa=this.domNode.querySelector(".js-create-view-button");Ta=this.domNode.querySelector(".js-create-view-dropdown");if($a=document.body.classList.contains("can-update")&&document.body.classList.contains("can-publish-views")&&!this.item.isVelocity())if(this.item.isSpatiotemporal&&
(B.default.hideNode(Ta),B.default.showNode(Qa)),this.page.portal.isPortal&&(null===(ub=null===(tb=this.item.serviceInfo)||void 0===tb?void 0:tb.editorTrackingInfo)||void 0===ub?0:ub.enableOwnershipAccessControl)&&(Za=this.item.layers,gb=1===Za.length||Za.every(function(fb){return fb.ownershipBasedAccessControlForFeatures&&!fb.ownershipBasedAccessControlForFeatures.allowOthersToQuery})))this.domNode.querySelector(".js-no-join-view-notice").open=!0,this.domNode.querySelector(".js-action-join-view").disabled=
!0,this.domNode.querySelector(".js-no-joined-link").href="".concat(this.page.portal.helpBase).concat(this.page.portal.helpMap.m["120004648"]||"");if(eb=this.get("defaultOpenButton")){Va=eb.innerHTML;eb.classList.remove("btn-clear");Xa=A.default.includes(this.item.types,"is-pdf");ib=Va?-1<Va.indexOf(this.i18n.itemLinks.download):(A.default.includes(this.item.types,"is-download")||A.default.includes(this.item.types,"is-file")||Xa)&&-1===this.item.type.indexOf("Package");db=A.default.includes(this.item.types,
"is-desktop");Va=(Pa=A.default.includes(this.item.types,"is-desktopPro")||A.default.includes(this.item.types,"is-pro"))?this.item.defaultOpenText:Va?Va:db?this.i18n.itemLinks.openDesktop:ib?this.i18n.itemLinks.download:this.i18n.common.open;if(ib||db||Pa||(null===(vb=this.item.openIn)||void 0===vb?0:vb.length))B.default.forEachNode(document.querySelectorAll(".js-thumbnail"),function(fb){return fb.alt=Va}),cb=ib&&!Xa?P.default.inline["download-to"][16]:P.default.inline.launch[16],A.default.includes(this.item.types,
"is-storymap")&&(A.default.includes(this.item.typeKeywords,"storymapcollection"),Ya=A.default.includes(this.item.typeKeywords,"smstatusdraft"),bb=A.default.includes(this.item.openIn,"configureStoryMap"),(mb=!bb||!Ya&&this.item.storyMapViewerUrl)?B.default.forEachNode(this.domNode.querySelectorAll(".js-action-openDefault"),function(fb){return fb.href=lb.item.storyMapViewerUrl}):bb&&(B.default.forEachNode(this.domNode.querySelectorAll(".js-action-openDefault"),function(fb){return fb.href=lb.item.configureStoryMapUrl}),
B.default.removeClasses(this.domNode.querySelector(".js-configure-storymap"),["btn-clear"])),Va=this.item.defaultOpenText,B.default.forEachNode(this.domNode.querySelectorAll(".js-action-share"),function(fb){return fb.classList.add("btn-clear")})),"Data Pipeline"===this.item.type&&B.default.forEachNode(this.domNode.querySelectorAll(".js-action-openDefault"),function(fb){return fb.href=lb.item.dataPipelineUrl}),-1<this.item.type.indexOf("GeoBIM")&&this.item.portal.canCreateGeoBIM&&(document.querySelector(".js-action-openDefault").href=
this.item.geoBIMUrl),B.default.forEachNode(this.domNode.querySelectorAll(".js-thumbnail-overlay-text"),function(fb){return fb.innerHTML=cb+'\x3cspan class\x3d"js-open-string"\x3e'.concat(Va,"\x3c/span\x3e")||""});"Raster function template"===this.item.type&&(this.domNode.querySelector(".js-thumbnail-overlay-text").textContent=this.i18n.itemLinks.download)}jb="classic"===this.item.portal.defaultMapViewer;nb=m.default.checkLayersForNewFieldTypes(this.item);ab=!this.item.numViews&&"Map Service"===this.item.type;
ob=(null===(wb=this.item.layers)||void 0===wb?void 0:wb.length)&&nb;this.item.isHostedService&&ab&&this.item.serviceInfo&&this.item.adminServiceInfo||jb&&ob?this.rewriteMapViewerUrls():"Notebook"===this.item.type&&(I.default.notebookViewer(this.item),B.default.forEachNode(this.domNode.querySelectorAll(".js-open-notebook, .js-action-openDefault"),function(fb){return fb.href=lb.item.notebookViewerUrl}));this.page.portal.isPortal&&B.default.hideNodes(null===(xb=this.domNode)||void 0===xb?void 0:xb.querySelectorAll(".js-hide-portal"));
this.item.canOpenInNewMapViewer||this.portalUser&&this.portalUser.defaultMapViewer!==Oa.MapViewerType.Modern||B.default.hideNode(document.querySelector(".js-map-open-more-dropdown"));"OGCFeatureServer"===this.item.type&&B.default.hideNode(document.querySelector(".js-map-open-more-dropdown"));m.default.checkLayersForNewFieldTypes(this.item)&&B.default.hideNode(document.querySelector(".js-map-open-more-dropdown"));this.item.get("canPublishWFSService")&&!g.default.ogcFeaturesEnabled&&(pb=this.domNode.querySelector("button[data-type\x3d'ogcfeatures']"))&&
(pb.style.display="none");(0,Sa.alignToSupportedExportFormats)(this.item,this.page.portal,this.domNode);-1<this.item.typeKeywords.indexOf("usesSnapshot")&&this.fetchLastSnapshot().then(function(fb){fb&&(lb.domNode.querySelector(".js-last-snapshot-value").textContent=J.default.completeDate(fb),B.default.showHide(lb.domNode.querySelector(".js-last-snapshot"),!!fb))});this.item.readyToRetrieveServiceLayers&&this.page.refreshServiceInfo();qb=null!==(zb=null===(yb=E.queryToObject(window.location.search.slice(1)))||
void 0===yb?void 0:yb.view)&&void 0!==zb?zb:"";"service"===qb&&((0,u.shouldOpenViewModal)(this.item,this.portalUser)?(0,u.handleViewModalClick)(this.item,this.portalUser,this.domNode.querySelector(".js-view-url"),!0):m.default.removeQueryParams(["view"]));return[2]}})})}),this.item.watch("url",function(){I.default.appViewer(X.item);document.querySelector("copy-to-clipboard-url").value=X.item.url;document.querySelector(".if-app .js-open-url").href=X.item.url;document.querySelector(".if-mobile .js-open-url").href=
X.item.appViewerUrl;document.querySelector(".if-link .js-open-url").href=X.item.appViewerUrl;B.default.forEachNode(document.querySelectorAll(".js-view-url"),function(ja){X.item.viewUrl="public"!==X.item.access?m.default.needsToken(X.item,X.item.url):X.item.url;ja.href=X.item.viewUrl})}),aa.default.subscribe("items/itemDetailRefresh",function(ja){B.default.forEachNode(document.querySelectorAll(".js-folder-title"),function(oa){return oa.innerHTML=P.default.inline.folder["16"]+ja.title})}),aa.default.subscribe("inlineEdit/layerRename/done",
function(ja){X.sublayer&&(document.querySelector('.js-sublayer-name[data-id\x3d"'.concat(X.sublayer.id,'"]')).innerHTML=ja)}),(0,sa.default)(this.page,"service-info-change",function(){var ja;!X.item.isFeatureCollection&&(A.default.includes(X.item.types,"is-feature")||A.default.includes(X.item.types,"is-table"))&&0<(null===(ja=X.item.layers)||void 0===ja?void 0:ja.length)&&X.item.layers.forEach(function(oa){return X.setLayerAttributes(oa,X.item)});X.item.readyToRetrieveServiceLayers&&(X.showLayers(X.item),
aa.default.publish("thumbnail/update"))}),aa.default.subscribe("inlineEdit/submit",function(ja){var oa=ja.prop;delete ja.prop;"layerRename"===oa?n.default.renameServiceLayers(ja,X.item).then(function(){X.item.set("maxAgeCheck",!0);X.page.refreshServiceInfo();aa.default.publish("inlineEdit/".concat(oa,"/done"),ja[oa]);X.page.hideErrors();return X.item}):-1===oa.indexOf("sublayer")&&(X.page.updateItem(ja,!0).then(function(){return L.default.request({url:X.item.itemUrl}).then(function(ua){X.item.scoreCompleteness=
ia.default.isDefined(ua.scoreCompleteness)?X.item.setScoreCompleteness(ua.scoreCompleteness):null;X.item.set(oa,ia.default.isDefined(ua[oa])?ua[oa]:"");aa.default.publish("inlineEdit/".concat(oa,"/done"),ja[oa]);X.page.hideErrors();return X.item})}),function(ua){(null===ua||void 0===ua?0:ua.messageCode)&&"GWM_0021"===ua.messageCode&&z.default.showAlert("error",ua.message)})}),aa.default.subscribe("inlineEdit/categories/submit",function(ja){var oa={};oa[X.item.id]={categories:ja};oa={url:"".concat(X.item.portal.url,
"content/updateItems"),content:{items:JSON.stringify([oa])}};L.default.request(oa,{usePost:!0}).then(function(){aa.default.publish("inlineEdit/categories/done");X.item.set("categories",ja)},function(ua){return 0})}),aa.default.subscribe("view/updateShare",function(){return X.dependencyAccessCheckRef.current.analyzeSharingDetail()}),(0,sa.default)((0,ya.default)(".js-comments").shift(),".js-action-addComment:click",function(ja){var oa;X.page.logItemAction("comment");pa.default.stop(ja);var ua=X.item,
Da=Z.default.get(ja.target,"data-type"),Ha=Z.default.get(ja.target,"data-id");ua="comment"===Da?{}:(ua.comments||[]).filter(function(Ta){return Ta.id===Ha});var Ja=ua.replies||[];ja=(0,ya.default)(ja.target).siblings("textarea").shift().value.trim();var Ma=X.item.commentsInfo,Qa=null!==(oa=X.item.comments)&&void 0!==oa?oa:[];ja&&X.commentIsValid(ja)&&(B.default.forEachNode(document.querySelectorAll(".js-disable-addComment"),function(Ta){return Ta.disabled=!0}),X.item.numComments++,X.item.commentsInfo=
N.default.mixin(Ma,{nextStart:0,overrideNum:"comment"!==Da?Qa.length:Qa.length+1,comments:[]}),ua.commentsInfo=N.default.mixin(ua.commentsInfo||{},{nextStart:0,overrideNum:Ja.length+1,comments:[]}),X.item.addComment({comment:escape(ja.trim()),parentId:"reply"===Da?Ha:null}).then(function(){return X.updateComments()}).then(function(){B.default.forEachNode(document.querySelectorAll(".js-disable-addComment"),function(Ta){return Ta.disabled=!1})}),function(Ta){var $a=["SB_0001","SB_0002","SB_0003","SB_0004"],
Za=["SB_0005","SB_0006","SB_0007"];if(null===Ta||void 0===Ta?0:Ta.messageCode)A.default.includes($a,Ta.messageCode)?(X._subscriptionStatusDlg=new C.default,X._subscriptionStatusDlg.show(X.page.portal.subscriptionInfo)):A.default.includes(Za,Ta.messageCode)&&(X._subscriptionStatusDlg=new C.default,X._subscriptionStatusDlg.showOther(Ta.messageCode));X.item.numComments--;B.default.forEachNode(document.querySelectorAll(".js-disable-addComment"),function(gb){return gb.disabled=!0})})}),(0,sa.default)(document.getElementById("comments"),
".js-action-deleteComment:click",function(ja){pa.default.stop(ja);if(!X._isDeletingComment){var oa=Z.default.get(ja.target,"data-type"),ua=Z.default.get(ja.target,"data-id"),Da=X.item.comments||[];m.default.createConfirmationDialog({strings:{title:X.i18n.common.deleteCommentTitle,description:X.i18n.common.deleteCommentMsg,ok:X.i18n.common.yesLabel,cancel:X.i18n.common.noLabel},onOk:function(Ha){X._isDeletingComment=!0;X.item.numComments--;X.item.commentsInfo=p.__assign(p.__assign({},X.item.commentsInfo||
{}),{nextStart:0,overrideNum:"comment"!==oa?Da.length:Da.length-1,comments:[]});X.item.deleteComment({url:"".concat(X.item.itemUrl,"/comments/").concat(ua)}).then(function(){return X.updateComments()}).then(function(){Ha();X._isDeletingComment=!1},function(){Ha();X._isDeletingComment=!1})}})}}),(0,sa.default)(document.getElementById("comments"),".js-action-reply:click",function(ja){pa.default.stop(ja);ja=Z.default.get(ja.target,"data-id");var oa=document.querySelector(".js-reply-".concat(ja," textarea"));
B.default.showNodes(document.querySelectorAll(".js-reply-".concat(ja)));oa&&oa.focus()}),(0,sa.default)(document.getElementById("comments"),".js-action-cancelReply:click",function(ja){pa.default.stop(ja);(0,ya.default)(ja.target).closest("[class*\x3djs-reply]").addClass("hide")}),(0,sa.default)(document.getElementById("comments"),".js-comment-profile:click",function(ja){pa.default.stop(ja);var oa=Z.default.get(ja.selectorTarget,"data-owner");"deletedUser"!==oa&&t.default.profilePopup({evt:ja,item:X.item,
profile:oa,page:X.page})}),(0,ya.default)(".js-loadMore-comments",this.domNode).on("click",function(ja){pa.default.stop(ja);X.updateComments()}),(0,ya.default)(".js-sort-comments",this.domNode).on("change",function(ja){pa.default.stop(ja);N.default.mixin(X.item.commentsInfo,{nextStart:0,comments:[],sortField:ja.target.value||"created"});X.updateComments()}),sa.default.once(V.default.byId("shorten-url"),"mouseover, click",function(ja){pa.default.stop(ja);X.getShortenedUrl().then(function(oa){(0,ya.default)("#copy-to-clipboard-shortUrl").attr("value",
oa)})}),(0,ya.default)(".js-shorten-url",this.domNode).on("click",function(ja){pa.default.stop(ja)}));this._thumbnailErrorConnect=(0,ya.default)(".js-thumbnail",this.domNode).on("error",function(){(0,ya.default)(".js-thumbnail",X.domNode).attr("src",L.default.relativeToExplicitUrl("js/arcgisonline/css/images/default_thumb.png"));X._thumbnailErrorConnect.remove();X._thumbnailErrorConnect=null});"StoryMap"===this.item.type&&document.querySelector(".js-action-openDefault").removeAttribute("data-action");
if("StoryMap Theme"===this.item.type){var la=document.querySelector(".js-action-openDefault");la.removeAttribute("data-action");la.href=this.item.typeKeywords.includes("smstatuspublished")?this.item.newStoryMapFromThemeUrl:this.item.configureStoryMapThemeUrl}m.default.registerItemActions(this,this.domNode,t.default,this.page,this.actionGuard.bind(this));this.item.portal.isPortal&&this.item.portal.isReadOnly&&(this.domNode.querySelector(".js-if-not-readonly").classList.remove("js-dropdown-toggle"),
this.own((0,ya.default)(".js-if-not-readonly",this.domNode).on("click",function(ja){X.checkReadonly(X.item.portal);ja.preventDefault()})))};La.prototype.rewriteMapViewerUrls=function(){var X=this;I.default.mapViewer(this.item);[".js-action-openDefault",".js-open-mapViewer",".js-action-newWebMapViewer.add-to-new-viewer"].forEach(function(la){B.default.forEachNode(X.domNode.querySelectorAll(la),function(ja){var oa=X.page._formatMapViewerPrimaryLink(X.item);ja.href=oa;ja.dataset.href=oa;oa=X.page._formatMapViewerPrimaryLabel(X.item);
if(".js-action-openDefault"===la){var ua=ja.querySelector(".js-open-string")||ja.querySelector(".js-thumbnail-overlay-text");ua&&(ua.textContent=oa);if(ja=ja.querySelector(".js-thumbnail"))ja.alt=oa}else ja.textContent=oa})})};La.prototype.handleLayerClick=function(X){var la=X.target;if(null===la||void 0===la?0:la.classList.contains("js-sublayer-link")){X.preventDefault();var ja=parseInt(la.getAttribute("data-id"),10);(X=A.default.find(this.item.layers||[],function(oa){return oa.id===ja}))&&this.toggleSubLayer(X,
!0)}};La.prototype.actionGuard=function(X){return-1===["publishTiles","share","thumbnail"].indexOf(X)?!1:this.checkReadonly(this.item.portal)};La.prototype.commentIsValid=function(X){return!this.item.portal.isPortal&&-1<(null===X||void 0===X?void 0:X.indexOf("http://"))?(z.default.showAlert("error",this.i18n.common.httpNotSupported),!1):!0};La.prototype.reverseLayers=function(X){for(var la=0;la<X.length;la++){var ja=X[la];ja.layers&&(this.reverseLayers(ja.layers),ja.layers.reverse())}};La.prototype.cancelInlineEdit=
function(){aa.default.publish("inlineEdit/cancel")};return La=p.__decorate([(0,U.default)(fa.default,va.default,ka.default,q.default)],La)}()})},"arcgisonline/pages/dijit/ImageViewer":function(){define("require exports tslib dojo/i18n!../../nls/arcgisonline dojo/string ./Overlay dijit/_TemplatedMixin dijit/_WidgetBase ../../tsutils/declareDecorator dojo/text!./ImageViewer/ImageViewer.html".split(" "),function(e,K,p,a,g,m,n,b,c,d){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);
n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);return function(){function l(h,f){this.alt="";this.i18n=a.default;this.showActionBar=!1}l.prototype.postMixInProperties=function(){this.inherited(arguments);this.overlayContents=g.default.substitute(d.default,{i18n:a.default,url:this.url,alt:this.alt});this.maxWidth=this.width};l.prototype.postCreate=function(){this.inherited(arguments);var h=this.domNode.querySelector(".js-image-viewer");h.style.width="".concat(this.width,
"px");h.style.height="".concat(this.height,"px")};return l=p.__decorate([(0,c.default)(b.default,n.default,m.default)],l)}()})},"arcgisonline/pages/dijit/InlineEdit":function(){define("require exports tslib esri/lang esri/libs/sanitizer/Sanitizer arcgis-components/wrappers/Tags dojo/on dojo/query dojo/has dojo/topic dojo/string dojo/i18n!../../nls/arcgisonline dijit/_TemplatedMixin dijit/_WidgetBase ../pageUtil ../utils/formatters ../utils/alerts ../utils/arrays ../utils/dom ../../sharing/util ../utils/icons ../../sharing/dijit/Editor dojox/uuid/generateRandomUuid ./CategoryPicker dojo/text!./InlineEdit/templates/InlineEdit.html dojo/text!./InlineEdit/templates/inlineEditTextArea.html dojo/text!./InlineEdit/templates/inlineEditFieldValueType.html dojo/text!./InlineEdit/templates/inlineEditRichText.html dojo/text!./InlineEdit/templates/inlineEditCustom.html dojo/text!./InlineEdit/templates/inlineEditLayerRename.html dojo/text!./InlineEdit/templates/inlineEditLayerRenameSubnav.html dojo/text!./InlineEdit/templates/inlineEditNotebookTags.html dojo/text!./InlineEdit/templates/inlineEditNumericChange.html arcgisonline/tsutils/declareDecorator dijit/_editor/plugins/FontChoice dijit/_editor/plugins/TextColor ./InlineEdit/ViewSource ../../sharing/dijit/LinkDialog".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y){a=p.__importDefault(a);g=p.__importDefault(g);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);B=p.__importDefault(B);
J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);D=p.__importDefault(D);C=p.__importDefault(C);y=p.__importDefault(y);return function(){function G(L,O){this.templateString=P.default;this.i18n=h.default;this.icons=z.default;this.inputType="textbox";this.inputClass="subnav-edit__input";this.defaultText=this.inputLabel="";this.invalidText=this.emptyText=void 0;this.required=
!1;this.pattern=void 0;this.editorHeight="240px";this.rows=4;this.titleClass="subnav-title";this.titleId="pagetitle";this.viewTitle=this.placeholder=this.buttonsClass=this.formClass=this.formTitle="";this.knownTags=[];this.isGroup=!1;this.editButtonClasses="btn-link-white if-can-update";this.editButtonUpdatePermissionClasses="if-can-update";this.cancelButtonClasses="btn btn-transparent btn-link-white";this.saveButtonClasses="btn btn-white margin-left-half";this.showCharactersLeft=this.showLoader=
!1;this.sanitizer=new g.default;this.dontSanitize=!1;this._oldValue=this.prop="";this._supportsFormValidation=!1;this.templateString={textArea:R.default,fieldValueType:S.default,richText:T.default,tags:E.default,categories:E.default,layerRename:I.default,layerRenameSubnav:F.default,notebookTags:D.default,numericChange:C.default}[L.isNotebook?"notebookTags":L.inputType]||P.default;this.baseUrl=L.baseUrl;this.openInNewTab=L.openInNewTab;this.inputLabel=L.inputLabel||L.formTitle||h.default.common.edit}
G.prototype.postMixInProperties=function(){this.inherited(arguments);this.inputId=this.inputId||(0,B.default)();this._oldValue=this.value=this._sanitizeValue(this.value);this.knownTags&&(this.knownTags=this._sanitizeStringArray(this.knownTags))};G.prototype.postCreate=function(){this.inherited(arguments);this.showLoader&&v.default.showNode(this._saveLoader);this.required&&(this._input.required=!0);this.pattern&&(this._input.pattern=this.pattern);var L=document.createElement("input");this._supportsFormValidation=
!(0,c.default)("safari")&&"required"in L&&"pattern"in L;!this._supportsFormValidation||"textArea"!==this.inputType&&"textbox"!==this.inputType||this._input.setCustomValidity(this._valOrFunction(this.defaultText||"",window,[this._input]));switch(this.inputType){case "textArea":case "textbox":this.maxLength&&(this._input.maxLength=this.maxLength);break;case "richText":this._formatRichText();break;case "tags":this._inputEl.id=this.inputId,this._form.addEventListener("keydown",function(O){"Enter"===O.key&&
"INPUT"===O.target.nodeName&&O.preventDefault()})}this._hasCharactersLeft()&&(v.default.showNode(this._charactersLeft),this._setCharactersLeft(),this.own((0,n.default)(this._input,"keyup",this._setCharactersLeft.bind(this))));this._updateView();this._initHandlers()};G.prototype.initTagsEditor=function(){var L=Array.isArray(this.value)?this.value:this.value.split(",");this.domNode.querySelector(".js-inline-edit").setAttribute("data-edit-id","tags");this._input=new m.TagsWrapper(this.domNode.querySelector("#".concat(this.inputId)),
{activeTags:L.filter(function(O){return O}),knownTags:this.knownTags.map(function(O){return O.tag}),maxWidth:"100%",minWidth:"100%"})};G.prototype.initCategoryPicker=function(){var L=this;this.portal&&this.portal.getCategories().then(function(O){L._formatCategories(L.value);L._input=new J.default({categories:L.value,schema:O,alwaysOpen:!0},L._inputEl);L._input.startup()},function(O){})};G.prototype.hide=function(){v.default.hideNode(this.domNode)};G.prototype.hideEditLink=function(){(0,b.default)(".js-inline-edit",
this.domNode).addClass("visibility-hidden")};G.prototype.showEditLink=function(){(0,b.default)(".js-inline-edit",this.domNode).removeClass("visibility-hidden")};G.prototype.updateText=function(L){L=this._sanitizeString(L);(0,b.default)(".js-view",this.domNode).innerHTML(L);this.value=this._input.value=L};G.prototype.updateValue=function(L){L=this._sanitizeValue(L);this._setInputValue(L);this.value=L;this._updateView()};G.prototype._sanitizeValue=function(L){return L instanceof Array?this._sanitizeStringArray(L):
this._sanitizeString(L)};G.prototype._sanitizeStringArray=function(L){var O=this;return this.dontSanitize?L:(L||[]).map(function(U){return O.sanitizer.sanitize(U)})};G.prototype._sanitizeString=function(L){return this.dontSanitize?L:this.sanitizer.sanitize(L)};G.prototype._setCharactersLeft=function(){this._hasCharactersLeft()&&(this._charactersLeft.textContent=l.default.substitute(this.i18n.myOrganization.generalTab.summaryCharsLeft,{chars:this.maxLength-this._input.value.length}))};G.prototype._setInputValue=
function(L){this._input&&("richText"===this.inputType?this._input.set("value",L||""):"categories"===this.inputType?this._input.setCategories(L,!0):"tags"===this.inputType?(L=Array.isArray(L)?L:L.split(","),this._input.setTags(L.filter(function(O){return O}))):this._input.value=a.default.isDefined(L)?L:"")};G.prototype._initHandlers=function(){var L=this;this.own((0,n.default)(this._cancelButton,"click",function(O){O.stopPropagation();O.preventDefault();L._cancelEdit()}),(0,b.default)(".js-inline-edit",
this.domNode).on("click",function(O){var U;O.stopPropagation();d.default.publish("inlineEdit/".concat(L.prop,"/start"));L._oldValue=L.value;v.default.hideNode(L._textView);v.default.showNode(L._form);"richText"===L.inputType&&((null===(U=L._input)||void 0===U?0:U.destroy)&&L._input.destroy(!0),O=q.default.editorDefaults(L.inputId),O.height=L.editorHeight,L._input=new A.default(O,L._inputEl),L._input.startup(),L._input.set("value",L.value||""));"fieldValueType"===L.inputType&&L._setupFieldValueType(L.value);
"categories"!==L.inputType&&L._input.focus();"numericChange"===L.inputType&&L._setInputValue(L.value)}),(0,n.default)(this._form,"submit",function(O){O.stopPropagation();O.preventDefault();O="richText"===L.inputType&&L._input.get("value")||"textArea"===L.inputType&&L._input.value;L.containsHttp(O)?w.default.showAlert("error",L.i18n.common.httpNotSupported):L._submitForm()}),d.default.subscribe("inlineEdit/".concat(this.prop,"/done"),function(O){L.containsHttp(L.value)&&w.default.showAlert("error",
L.i18n.common.httpNotSupported);L._updateView();L.showLoader&&L._saveLoader&&(L._saveButton.disabled=!1,L._cancelButton.disabled=!1,L._saveLoader.classList.remove("inline-edit-save-loader--active"));L._hideEdit()}),d.default.subscribe("inlineEdit/cancel",function(){L._cancelEdit()}),d.default.subscribe("inlineEdit/".concat(this.prop,"/oldValue"),function(O){L.value=L._oldValue=O}));"textbox"!==this.inputType&&"textArea"!==this.inputType&&"layerRename"!==this.inputType&&"layerRenameSubnav"!==this.inputType||
this.own((0,n.default)(this._input,"change",this._changeOrInput.bind(this)),(0,n.default)(this._input,"input",this._changeOrInput.bind(this)),(0,n.default)(this._input,"invalid",this._invalid.bind(this)))};G.prototype.containsHttp=function(L){var O;return!x.default.isPortal()&&("richText"===this.inputType||"textArea"===this.inputType)&&-1<(null===(O=null===L||void 0===L?void 0:L.indexOf)||void 0===O?void 0:O.call(L,"http://"))};G.prototype._cancelEdit=function(){var L;this._setInputValue(this._oldValue);
this._setCharactersLeft();(null===(L=this._input)||void 0===L?0:L.validity)&&this._setCustomValidity("");"categories"===this.inputType&&this._input.hideError();this._hideEdit();d.default.publish("inlineEdit/".concat(this.prop,"/cancel"))};G.prototype._hasCharactersLeft=function(){return"textArea"===this.inputType&&this.maxLength&&this.showCharactersLeft&&a.default.isDefined(this._charactersLeft)};G.prototype._updateView=function(){var L=this.domNode.querySelectorAll(".js-view"),O=this.inputType;if(0<
L.length&&this.value||"tags"===O){switch(O){case "categories":L=this._formatCategories(this.value);break;case "fieldValueType":L=this._getFieldValueType(this.value);break;case "tags":L=this._formatTags(this.value);break;default:L=this.formatter?this.formatter(this.value):this.value}"tags"!==O&&"categories"!==O&&(L=this._sanitizeString(L));(0,b.default)(".js-view",this.domNode).innerHTML(L);"richText"===this.inputType&&this._formatRichText()}};G.prototype._submitForm=function(){var L={},O=u.default.from(this._form.elements)||
[],U;if(("textbox"===this.inputType||"textArea"===this.inputType||"layerRename"===this.inputType||"layerRenameSubnav"===this.inputType)&&!this._supportsFormValidation&&(O=O.some(function(M){return(U=M.getAttribute("data-customValidity"))?(d.default.publish("page/showError",{message:U}),!0):!1})))return;this.showLoader&&this._saveLoader&&(this._saveButton.disabled=!0,this._cancelButton.disabled=!0,this._saveLoader.classList.add("inline-edit-save-loader--active"));"categories"===this.inputType?(this._input.hideError(),
this.value=this._input.getCategories(!0),d.default.publish("inlineEdit/categories/submit",this.value)):(L[this.prop]="tags"===this.inputType?this._input.getTags().join(","):this._input.value,L.clearEmptyFields=!0,L.prop=this.prop,-1<["layerRename","layerRenameSubnav","layerDescription","layerCopyright"].indexOf(this.prop)&&void 0!==this.layerId&&(L.layerId=this.layerId),this.value=L[this.prop],d.default.publish("inlineEdit/submit",L));this._oldValue=this.value};G.prototype._changeOrInput=function(){var L,
O,U=null!==(O=null===(L=this._input.value)||void 0===L?void 0:L.trim())&&void 0!==O?O:"";L=this._input.pattern;O=this._input.required;var M="TEXTAREA"!==this._input.nodeName;!U&&O?this.emptyText&&this._setCustomValidity(this._valOrFunction(this.emptyText,window,[this._input])):this._supportsFormValidation&&M||!L?this._setCustomValidity(""):(new RegExp(L)).test(U)?this._setCustomValidity(""):this.invalidText&&this._setCustomValidity(this._valOrFunction(this.invalidText,window,[this._input]))};G.prototype._invalid=
function(){var L,O,U,M,Q,Y,fa=null!==(O=null===(L=this._input.value)||void 0===L?void 0:L.trim())&&void 0!==O?O:"";fa&&""!==fa?(null===(U=this._input.validity)||void 0===U?0:U.patternMismatch)||(null===(M=this._input.validity)||void 0===M?0:M.badInput)||(null===(Q=this._input.validity)||void 0===Q?0:Q.typeMismatch)||(null===(Y=this._input.validity)||void 0===Y?0:Y.customError)?this.invalidText&&this._setCustomValidity(this._valOrFunction(this.invalidText,window,[this._input])):this._setCustomValidity(""):
this.emptyText&&this._setCustomValidity(this._valOrFunction(this.emptyText,window,[this._input]))};G.prototype._valOrFunction=function(L,O,U){return"function"===typeof L?L.apply(O,U):L};G.prototype._setCustomValidity=function(L){this._supportsFormValidation?this._input.setCustomValidity(L):(this._input.setAttribute("data-customvalidity",L),""===L&&d.default.publish("hidePageError"))};G.prototype._hideEdit=function(){v.default.showNode(this._textView);v.default.hideNode(this._form)};G.prototype._formatCategories=
function(L){var O=new RegExp(/^\/.+\//);L=L.map(function(U){return U.replace(O,"")}).map(t.default.formatCategoryChip).reduce(function(U,M){return U+l.default.substitute("\x3cspan class\x3d'label filter-label'\x3e${category}\x3c/span\x3e",{category:M})},"");return 0<L.length?L:this.i18n.contentCategories.noCategoriesItem};G.prototype._formatTags=function(L){var O=this;L=L&&"string"===typeof L?L.split(","):L||[];var U="settings-tab"===this._currentView,M=this.isGroup?"groups":"content";return 0>=L.filter(function(Q){return Q}).length?
this.i18n.contentCategories.noTags:L.map(function(Q){var Y=O.dontSanitize?Q:O.sanitizer.sanitize(Q);Y=x.default.htmlEncode(Y);return U?Q:'\x3ca href\x3d"'.concat(O.baseUrl||"","search.html?t\x3d").concat(M,"\x26q\x3dtags:%22").concat(Y,'%22" target\x3d"').concat(O.openInNewTab?"_blank":"_self",'"\x3e').concat(Y,"\x3c/a\x3e")}).join(", ")};G.prototype._formatRichText=function(){(0,b.default)(".js-view table").addClass("table")};G.prototype._setupFieldValueType=function(L){for(var O=this.fieldValueTypeList.fieldValueType,
U=0;U<O.length;U++)this._input.options[U]=new Option(this._getFieldValueType(O[U].title),O[U].title),L===O[U].title&&(this._input.selectedIndex=U)};G.prototype._getFieldValueType=function(L){if("none"===L)return this.i18n.attributeFieldDetails.none;L=L||this.i18n.attributesView.commonUndefined;return this.i18n.attributeFieldDetails.fieldValueTypesList[L]||L};return G=p.__decorate([(0,y.default)(r.default,f.default)],G)}()})},"arcgisonline/sharing/dijit/Editor":function(){define("require exports tslib ../../tsutils/declareDecorator dijit/Editor dijit/_editor/_Plugin dijit/form/ToggleButton".split(" "),
function(e,K,p,a,g,m,n){function b(c){return new m.default({buttonClass:n.default,command:c.name})}a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);e=function(){function c(d,l){this.declaredClass="arcgisonline.sharing.dijit.Editor"}return c=p.__decorate([(0,a.default)(g.default)],c)}();m.default.registry=p.__assign(p.__assign({},m.default.registry),{insertOrderedList:b,insertUnorderedList:b,justifyCenter:b,justifyFull:b,justifyLeft:b,justifyRight:b});return e})},
"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q){e=p("dijit._editor.plugins._FontDropDown",[d,l,h],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:e,postMixInProperties:function(){this.inherited(arguments);this.strings=g.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=c.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new b({idProperty:"value",data:K.map(this.values,function(x){var z=this.strings[x]||x;return{label:this.getLabel(x,z),name:z,value:x}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(x,z){z=!1!==z;this.select.set("value",0>K.indexOf(this.values,x)?"":x,z);z||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(x){this._set("disabled",x);this.select.set("disabled",x)}});var t=p("dijit._editor.plugins._FontNameDropDown",e,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(x,z){return this.plainText?z:"\x3cdiv style\x3d'font-family: "+x+"'\x3e"+z+"\x3c/div\x3e"},_normalizeFontName:function(x){var z=this.values;if(!x||!z)return x;var A=x.split(",");if(1<A.length)for(var B=0,J=A.length;B<J;B++){var P=n.trim(A[B]);if(-1<K.indexOf(z,P))return P}return x},_setValueAttr:function(x,z){z=!1!==
z;x=this._normalizeFontName(x);this.generic&&(x={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[x]||x);this.inherited(arguments,[x,z])}}),w=p("dijit._editor.plugins._FontSizeDropDown",e,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(x,
z){return this.plainText?z:"\x3cfont size\x3d"+x+"'\x3e"+z+"\x3c/font\x3e"},_setValueAttr:function(x,z){z=!1!==z;x.indexOf&&-1!=x.indexOf("px")&&(x={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(x,10)]||x);this.inherited(arguments,[x,z])}}),u=p("dijit._editor.plugins._FormatBlockDropDown",e,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(x,z){return this.plainText||
"noFormat"==x?z:"\x3c"+x+"\x3e"+z+"\x3c/"+x+"\x3e"},_execCommand:function(x,z,A){if("noFormat"===A){var B;if((z=q.getSelection(x.window))&&0<z.rangeCount&&(A=z.getRangeAt(0),A)){z=A.startContainer;for(B=A.endContainer;z&&z!==x.editNode&&z!==x.document.body&&1!==z.nodeType;)z=z.parentNode;for(;B&&B!==x.editNode&&B!==x.document.body&&1!==B.nodeType;)B=B.parentNode;var J=m.hitch(this,function(T,E){if(T.childNodes&&T.childNodes.length){var I;for(I=0;I<T.childNodes.length;I++){var F=T.childNodes[I];if(1==
F.nodeType&&x.selection.inSelection(F)){var D=F.tagName?F.tagName.toLowerCase():"";-1!==K.indexOf(this.values,D)&&E.push(F);J(F,E)}}}});A=m.hitch(this,function(T){if(T&&T.length){for(x.beginEditing();T.length;)this._removeFormat(x,T.pop());x.endEditing()}});var P=[];if(z==B){for(B=z;B&&B!==x.editNode&&B!==x.document.body;){if(1==B.nodeType){var R=B.tagName?B.tagName.toLowerCase():"";if(-1!==K.indexOf(this.values,R)){var S=B;break}}B=B.parentNode}J(z,P);S&&(P=[S].concat(P))}else for(B=z;x.selection.inSelection(B);)1==
B.nodeType&&(R=B.tagName?B.tagName.toLowerCase():"",-1!==K.indexOf(this.values,R)&&P.push(B),J(B,P)),B=B.nextSibling;A(P);x.onDisplayChanged()}}else x.execCommand(z,A)},_removeFormat:function(x,z){if(x.customUndo){for(;z.firstChild;)a.place(z.firstChild,z,"before");z.parentNode.removeChild(z)}else{x.selection.selectElementChildren(z);var A=x.selection.getSelectedHtml();x.selection.selectElement(z);x.execCommand("inserthtml",A||"")}}}),v=p("dijit._editor.plugins.FontChoice",r,{useDefaultCommand:!1,
_initButton:function(){var x={fontName:t,fontSize:w,formatBlock:u}[this.command],z=this.params;this.params.custom&&(z.values=this.params.custom);var A=this.editor;this.button=new x(m.delegate({dir:A.dir,lang:A.lang},z));this.own(this.button.select.on("change",m.hitch(this,function(B){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=B.indexOf(" ")&&(B="'"+B+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,B):this.editor.execCommand(this.command,
B)})))},updateState:function(){var x=this.editor,z=this.command;if(x&&x.isLoaded&&z.length&&this.button){var A=this.get("disabled");this.button.set("disabled",A);if(!A){try{var B=x.queryCommandValue(z)||""}catch(P){B=""}(A=m.isString(B)&&(B.match(/'([^']*)'/)||B.match(/"([^"]*)"/)))&&(B=A[1]);"fontSize"!==z||B||(B=3);if("formatBlock"===z)if(B&&"p"!=B)0>K.indexOf(this.button.values,B)&&(B="noFormat");else{B=null;if((z=q.getSelection(this.editor.window))&&0<z.rangeCount&&(z=z.getRangeAt(0)))var J=z.endContainer;
for(;J&&J!==x.editNode&&J!==x.document;){if((z=J.tagName?J.tagName.toLowerCase():"")&&-1<K.indexOf(this.button.values,z)){B=z;break}J=J.parentNode}B||(B="noFormat")}B!==this.button.get("value")&&this.button.set("value",B,!1)}}}});K.forEach(["fontName","fontSize","formatBlock"],function(x){r.registry[x]=function(z){return new v({command:x,plainText:z.plainText})}});v._FontDropDown=e;v._FontNameDropDown=t;v._FontSizeDropDown=w;v._FormatBlockDropDown=u;return v})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),
function(e,K,p,a,g,m){var n=p("dijit._editor.plugins.TextColor",g,{buttonClass:m,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var b=this;this.button.loadDropDown=function(c){function d(l){b.button.dropDown=new l({dir:b.editor.dir,ownerDocument:b.editor.ownerDocument,value:b.value,onChange:function(h){b.editor.execCommand(b.command,h)},onExecute:function(){b.editor.execCommand(b.command,this.get("value"))}});c()}"string"==
typeof b.colorPicker?e([b.colorPicker],d):d(b.colorPicker)}},updateState:function(){var b=this.editor,c=this.command;if(b&&b.isLoaded&&c.length){if(this.button){var d=this.get("disabled");this.button.set("disabled",d);if(d)return;try{var l=b.queryCommandValue(c)||""}catch(h){l=""}}""==l&&(l="#000000");"transparent"==l&&(l="#ffffff");"string"==typeof l?-1<l.indexOf("rgb")&&(l=K.fromRgb(l).toHex()):(l=((l&255)<<16|l&65280|(l&16711680)>>>16).toString(16),l="#000000".slice(0,7-l.length)+l);this.value=
l;(b=this.button.dropDown)&&b.get&&l!==b.get("value")&&b.set("value",l,!1)}}});g.registry.foreColor=function(b){return new n(b)};g.registry.hiliteColor=function(b){return new n(b)};return n})},"arcgisonline/pages/dijit/InlineEdit/ViewSource":function(){define("require exports tslib ../../../tsutils/declareDecorator dijit/_editor/_Plugin dijit/_editor/plugins/ViewSource esri/libs/sanitizer/Sanitizer".split(" "),function(e,K,p,a,g,m,n){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);
n=p.__importDefault(n);var b=function(){function c(d){this.declaredClass="arcgisonline.pages.dijit.InlineEdit.ViewSource";this.sanitizer=new n.default}c.prototype._filter=function(d){d&&(d=this.sanitizer.sanitize(d),this.stripScripts&&(d=this._stripScripts(d)),this.stripComments&&(d=this._stripComments(d)),this.stripIFrames&&(d=this._stripIFrames(d)),this.stripEventHandlers&&(d=this._stripEventHandlers(d)));return d};return c=p.__decorate([(0,a.default)(m.default)],c)}();g.default.registry.viewSourceSanitize=
g.default.registry.viewsourcesanitize=function(c){return new b({readOnly:"readOnly"in c?c.readOnly:!1,stripComments:"stripComments"in c?c.stripComments:!0,stripScripts:"stripScripts"in c?c.stripScripts:!0,stripIFrames:"stripIFrames"in c?c.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in c?c.stripEventHandlers:!0})};return b})},"dijit/_editor/plugins/ViewSource":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/window ../../focus ../_Plugin ../../form/ToggleButton ../.. ../../registry dojo/i18n!../nls/commands".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u){var v=p("dijit._editor.plugins.ViewSource",q,{stripScripts:!0,stripComments:!0,stripIFrames:!0,stripEventHandlers:!0,readOnly:!1,_fsPlugin:null,toggle:function(){h("webkit")&&(this._vsFocused=!0);this.button.set("checked",!this.button.get("checked"))},_initButton:function(){var x=b.getLocalization("dijit._editor","commands"),z=this.editor;this.button=new t({label:x.viewSource,ownerDocument:z.ownerDocument,dir:z.dir,lang:z.lang,showLabel:!1,iconClass:this.iconClassPrefix+
" "+this.iconClassPrefix+"ViewSource",tabIndex:"-1",onChange:d.hitch(this,"_showSource")});this.button.set("readOnly",!1)},setEditor:function(x){this.editor=x;this._initButton();this.removeValueFilterHandles();this._setValueFilterHandle=K.before(this.editor,"setValue",d.hitch(this,function(z){return[this._filter(z)]}));this._getValueFilterHandle=K.after(this.editor,"getValue",d.hitch(this,function(z){return this._filter(z)}));this.editor.addKeyHandler(c.F12,!0,!0,d.hitch(this,function(z){this.button.focus();
this.toggle();z.stopPropagation();z.preventDefault();setTimeout(d.hitch(this,function(){this.editor.focused&&this.editor.focus()}),100)}))},_showSource:function(x){var z=this.editor,A=z._plugins;this._sourceShown=x;var B=this;try{this.sourceArea||this._createSourceView();if(x)z._sourceQueryCommandEnabled=z.queryCommandEnabled,z.queryCommandEnabled=function(P){return"viewsource"===P.toLowerCase()},this.editor.onDisplayChanged(),e.forEach(A,function(P){!P||P instanceof v||!P.isInstanceOf(q)||P.set("disabled",
!0)}),this._fsPlugin&&(this._fsPlugin._getAltViewNode=function(){return B.sourceArea}),this.sourceArea.value=z.get("value"),this.sourceArea.style.height=z.iframe.style.height,this.sourceArea.style.width=z.iframe.style.width,z.iframe.parentNode.style.position="relative",n.set(z.iframe,{position:"absolute",top:0,visibility:"hidden"}),n.set(this.sourceArea,{display:"block"}),this._resizeHandle=l(window,"resize",d.hitch(this,function(){var P=f.getBox(z.ownerDocument);"_prevW"in this&&"_prevH"in this&&
P.w===this._prevW&&P.h===this._prevH||(this._prevW=P.w,this._prevH=P.h,this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(d.hitch(this,function(){delete this._resizer;this._resize()}),10))})),setTimeout(d.hitch(this,this._resize),100),this.editor.onNormalizedDisplayChanged(),this.editor.__oldGetValue=this.editor.getValue,this.editor.getValue=d.hitch(this,function(){var P=this.sourceArea.value;return P=this._filter(P)}),this._setListener=K.after(this.editor,
"setValue",d.hitch(this,function(P){this.sourceArea.value=P||""}),!0);else{if(!z._sourceQueryCommandEnabled)return;this._setListener.remove();delete this._setListener;this._resizeHandle.remove();delete this._resizeHandle;this.editor.__oldGetValue&&(this.editor.getValue=this.editor.__oldGetValue,delete this.editor.__oldGetValue);z.queryCommandEnabled=z._sourceQueryCommandEnabled;if(!this._readOnly){var J=this.sourceArea.value;z.beginEditing();z.set("value",J);z.endEditing()}e.forEach(A,function(P){P&&
P.isInstanceOf(q)&&P.set("disabled",!1)});n.set(this.sourceArea,"display","none");n.set(z.iframe,{position:"relative",visibility:"visible"});delete z._sourceQueryCommandEnabled;this.editor.onDisplayChanged()}setTimeout(d.hitch(this,function(){var P=z.domNode.parentNode;P&&(P=u.getEnclosingWidget(P))&&P.resize&&P.resize();z.resize()}),300)}catch(P){}},updateState:function(){this.button.set("disabled",this.get("disabled"))},_resize:function(){var x=this.editor,z=x.getHeaderHeight(),A=x.getFooterHeight(),
B=m.position(x.domNode),J=m.getPadBorderExtents(x.iframe.parentNode),P=m.getMarginExtents(x.iframe.parentNode),R=m.getPadBorderExtents(x.domNode),S=B.w-R.w;B=B.h-(z+R.h+A);this._fsPlugin&&this._fsPlugin.isFullscreen&&(x=f.getBox(x.ownerDocument),S=x.w-R.w,B=x.h-(z+R.h+A));m.setMarginBox(this.sourceArea,{w:Math.round(S-(J.w+P.w)),h:Math.round(B-(J.h+P.h))})},_createSourceView:function(){var x=this.editor,z=x._plugins;this.sourceArea=g.create("textarea");this.readOnly&&(a.set(this.sourceArea,"readOnly",
!0),this._readOnly=!0);n.set(this.sourceArea,{padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});a.set(this.sourceArea,"aria-label",this.editor.id);g.place(this.sourceArea,x.iframe,"before");h("ie")&&x.iframe.parentNode.lastChild!==x.iframe&&n.set(x.iframe.parentNode.lastChild,{width:"0px",height:"0px",padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});x._viewsource_oldFocus=x.focus;var A=this;x.focus=function(){if(A._sourceShown)A.setSourceAreaCaret();else try{this._vsFocused?
(delete this._vsFocused,r.focus(x.editNode)):x._viewsource_oldFocus()}catch(P){}};var B,J;for(B=0;B<z.length;B++)if((J=z[B])&&("dijit._editor.plugins.FullScreen"===J.declaredClass||J.declaredClass===w._scopeName+"._editor.plugins.FullScreen")){this._fsPlugin=J;break}this._fsPlugin&&(this._fsPlugin._viewsource_getAltViewNode=this._fsPlugin._getAltViewNode,this._fsPlugin._getAltViewNode=function(){return A._sourceShown?A.sourceArea:this._viewsource_getAltViewNode()});this.own(l(this.sourceArea,"keydown",
d.hitch(this,function(P){this._sourceShown&&P.keyCode==c.F12&&P.ctrlKey&&P.shiftKey&&(this.button.focus(),this.button.set("checked",!1),setTimeout(d.hitch(this,function(){x.focus()}),100),P.stopPropagation(),P.preventDefault())})))},_stripScripts:function(x){x&&(x=x.replace(/<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>/ig,""),x=x.replace(/<\s*script\b([^<>]|\s)*>?/ig,""),x=x.replace(/<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>/ig,""));return x},_stripComments:function(x){x&&(x=x.replace(/\x3c!--(.|\s){1,}?--\x3e/g,
""));return x},_stripIFrames:function(x){x&&(x=x.replace(/<\s*iframe[^>]*>((.|\s)*?)<\\?\/\s*iframe\s*>/ig,""));return x},_stripEventHandlers:function(x){if(x){var z=x.match(/<[a-z]+?\b(.*?on.*?(['"]).*?\2.*?)+>/gim);if(z)for(var A=0,B=z.length;A<B;A++){var J=z[A],P=J.replace(/\s+on[a-z]*\s*=\s*(['"])(.*?)\1/igm,"");x=x.replace(J,P)}}return x},_filter:function(x){x&&(this.stripScripts&&(x=this._stripScripts(x)),this.stripComments&&(x=this._stripComments(x)),this.stripIFrames&&(x=this._stripIFrames(x)),
this.stripEventHandlers&&(x=this._stripEventHandlers(x)));return x},removeValueFilterHandles:function(){this._setValueFilterHandle&&(this._setValueFilterHandle.remove(),delete this._setValueFilterHandle);this._getValueFilterHandle&&(this._getValueFilterHandle.remove(),delete this._getValueFilterHandle)},setSourceAreaCaret:function(){var x=this.sourceArea;r.focus(x);this._sourceShown&&!this.readOnly&&(x.setSelectionRange?x.setSelectionRange(0,0):this.sourceArea.createTextRange&&(x=x.createTextRange(),
x.collapse(!0),x.moveStart("character",-99999),x.moveStart("character",0),x.moveEnd("character",0),x.select()))},destroy:function(){this._resizer&&(clearTimeout(this._resizer),delete this._resizer);this._resizeHandle&&(this._resizeHandle.remove(),delete this._resizeHandle);this._setListener&&(this._setListener.remove(),delete this._setListener);this.removeValueFilterHandles();this.inherited(arguments)}});q.registry.viewSource=q.registry.viewsource=function(x){return new v({readOnly:"readOnly"in x?
x.readOnly:!1,stripComments:"stripComments"in x?x.stripComments:!0,stripScripts:"stripScripts"in x?x.stripScripts:!0,stripIFrames:"stripIFrames"in x?x.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in x?x.stripEventHandlers:!0})};return v})},"arcgisonline/sharing/dijit/LinkDialog":function(){define("require exports tslib dijit/_editor/_Plugin dijit/_editor/plugins/LinkDialog dojo/on ../util ../../pages/utils/validation ../../tsutils/declareDecorator dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);var l=function(){function f(r,q){this.linkDialogTemplate="\x3cdiv class\x3d'link-container'\x3e\x3cdiv class\x3d'link-container__content text-left'\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_textInputLabel' for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/div\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_urlInputLabel' for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'\x3e\x3cdiv class\x3d'input-error-message' id\x3d'${id}_urlInputError'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'hide'\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit/form/Select'\x3e\x3coption selected\x3d'selected' value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3c/select\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'link-container__button-row leader-half text-right'\x3e\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton class\x3d'padding-left-half cancel' data-dojo-type\x3d'dijit/form/Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e"}
f.prototype._loadDropDown=function(){var r=this;this.inherited(arguments);var q=0,t=setInterval(function(){r._urlInput?(clearInterval(t),r._urlInput.isValid=function(){return!0}):15<q&&clearInterval(t);q++},1E3)};f.prototype._onOpenDialog=function(){this.inherited(arguments);var r=d.default.linkDialog;this._urlInputError=document.getElementById("".concat(this._uniqueId,"_urlInputError"));this.dropDown.contentsNode.parentNode.classList.add("link-container");var q=this.dropDown.containerNode;q.classList.add("text-left");
q.title=r.linkTitle;q.firstChild.textContent="";var t=q.children[0];t.className+="link-container__title font-size-1";t.style.cssText="";t.textContent=r.linkTitle;if(t=document.getElementById("".concat(this._uniqueId,"_textInputLabel")))t.innerHTML=r.text;if(t=document.getElementById("".concat(this._uniqueId,"_urlInputLabel")))t.innerHTML=r.url;this._setButton.set("label",r.update);r=q.querySelector("#".concat(this._uniqueId,"_textInput"));var w=q.querySelector("#".concat(this._uniqueId,"_urlInput")),
u=r.value;setTimeout(function(){u&&w.focus()},150)};f.prototype._isValid=function(){var r=this._urlInput.get("value"),q=document.getElementById("widget_".concat(this._uniqueId,"_urlInput")),t=document.getElementById("".concat(this._uniqueId,"_urlInput"));if(0===(null===r||void 0===r?void 0:r.length))return q.classList.add("input-error-border"),b.default.setInvalidState(t,this._urlInputError,d.default.linkDialog.invalidUrl),!1;if(!n.default.isPortal()&&r.length&&-1<r.indexOf("http:"))return q.classList.add("input-error-border"),
b.default.setInvalidState(t,this._urlInputError,d.default.common.httpNotSupported),!1;q.classList.remove("input-error-border");b.default.clearState([t,this._urlInputError]);return!0};f.prototype._checkAndFixInput=function(){var r=this,q=this._urlInput.get("value");this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var t=q,w=!1,u=!1;1<(null===t||void 0===t?void 0:t.length)&&(t=t.trim(),0!==t.indexOf("mailto:")&&(0<t.indexOf("/")?
-1===t.indexOf("://")&&"/"!==t.charAt(0)&&t.indexOf("./")&&0!==t.indexOf("../")&&r._hostRxp.test(t)&&(w=!0):r._userAtRxp.test(t)&&(u=!0)));w&&-1===t.indexOf("{expression/")&&-1===t.indexOf("{relationships/")&&r._urlInput.set("value","http://".concat(t));u&&r._urlInput.set("value","mailto:".concat(t));r._setButton.set("disabled",!r._isValid())},250)};return f=p.__decorate([(0,c.default)(g.default)],f)}(),h=function(){function f(r,q){this.linkDialogTemplate="\x3cdiv class\x3d'link-container'\x3e\x3cdiv class\x3d'link-container__content text-left'\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_urlInputLabel' for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'\x3e\x3cdiv class\x3d'input-error-message' id\x3d'${id}_urlInputError'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_textInputLabel' for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'link-container__button-row leader-half text-right'\x3e\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton class\x3d'padding-left-half cancel' data-dojo-type\x3d'dijit/form/Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e";
this.htmlTemplate='\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e';this.tag="img"}f.prototype._getCurrentValues=function(r){if((null===r||void 0===r?void 0:r.tagName.toLowerCase())===this.tag){var q=r.getAttribute("_djrealurl")||r.getAttribute("src");var t=r.getAttribute("alt");this.editor.selection.selectElement(r,!0)}else t=this.editor.selection.getSelectedText();return{urlInput:q||"",textInput:t||""}};f.prototype._onOpenDialog=function(){this.inherited(arguments);
var r=d.default.linkDialog;this._urlInputError=document.getElementById("".concat(this._uniqueId,"_urlInputError"));this.dropDown.contentsNode.parentNode.classList.add("link-container");var q=this.dropDown.containerNode;q.classList.add("text-left");q.title=r.imageTitle;q.firstChild.textContent="";q=q.children[0];q.className+="link-container__title font-size-1";q.style.cssText="";q.textContent=r.imageTitle;if(q=document.getElementById("".concat(this._uniqueId,"_textInputLabel")))q.innerHTML=r.description;
if(q=document.getElementById("".concat(this._uniqueId,"_urlInputLabel")))q.innerHTML=r.url;this._setButton.set("label",r.update)};f.prototype._isValid=function(){var r=this._urlInput.get("value"),q=document.getElementById("widget_".concat(this._uniqueId,"_urlInput")),t=document.getElementById("".concat(this._uniqueId,"_urlInput"));if(0===(null===r||void 0===r?void 0:r.length))return q.classList.add("input-error-border"),b.default.setInvalidState(t,this._urlInputError,d.default.linkDialog.invalidUrl),
!1;if(!n.default.isPortal()&&r.length&&-1<r.indexOf("http:"))return q.classList.add("input-error-border"),b.default.setInvalidState(t,this._urlInputError,d.default.common.httpNotSupported),!1;q.classList.remove("input-error-border");b.default.clearState([t,this._urlInputError]);return!0};f.prototype._connectTagEvents=function(){var r=this;this.inherited(arguments);this.editor.onLoadDeferred.then(function(){r.own((0,m.default)(r.editor.editNode,"mousedown",r._selectTag.bind(r)))})};f.prototype._selectTag=
function(r){if(null===r||void 0===r?0:r.target)r=r.target,(r.tagName?r.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(r)};f.prototype._checkValues=function(r){if(null===r||void 0===r?0:r.urlInput)r.urlInput=r.urlInput.replace(/"/g,"\x26quot;");if(null===r||void 0===r?0:r.textInput)r.textInput=r.textInput.replace(/"/g,"\x26quot;");return r};f.prototype._onDblClick=function(r){if(r&&r.target&&(r=r.target,(r.tagName?r.tagName.toLowerCase():"")===this.tag&&r.src)){var q=this.editor;
this.editor.selection.selectElement(r);q.onDisplayChanged();q._updateTimer&&(q._updateTimer.remove(),delete q._updateTimer);q.onNormalizedDisplayChanged();var t=this.button;setTimeout(function(){t.set("disabled",!1);t.loadAndOpenDropDown().then(function(){t.dropDown.focus&&t.dropDown.focus()})},10)}};return f=p.__decorate([(0,c.default)(g.default)],f)}();a.default.registry.createEsriLink=function(f){return new l({command:"createLink"})};a.default.registry.insertEsriImage=function(f){return new h({command:"insertImage"})};
l.ImgLinkDialog=h;return l})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(e,K,p,a,g,m,n,b,c,d,l,h,f){var r=p("dijit._editor.plugins.LinkDialog",l,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:h,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=m.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(t){e("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),m.hitch(this,function(w,u,v){var x=this;this.tag="insertImage"==this.command?"img":"a";w=m.delegate(w.getLocalization("dijit","common",this.lang),w.getLocalization("dijit._editor",
"LinkDialog",this.lang));var z=this.dropDown=this.button.dropDown=new u({title:w[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:m.hitch(this,"setValue"),onOpen:function(){x._onOpenDialog();u.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(m.hitch(x,"_onCloseDialog"),0)}});w.urlRegExp=this.urlRegExp;w.id=v.getUniqueId(this.editor.id);this._uniqueId=w.id;this._setContent(z.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
d.substitute(this.linkDialogTemplate,w));z.startup();this._urlInput=v.byId(this._uniqueId+"_urlInput");this._textInput=v.byId(this._uniqueId+"_textInput");this._setButton=v.byId(this._uniqueId+"_setButton");this.own(v.byId(this._uniqueId+"_cancelButton").on("click",m.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",m.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",m.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=m.hitch(this,function(){var A=this._urlInput.get("value");return this._urlRegExp.test(A)||this._emailRegExp.test(A)});this.own(n(z.domNode,"keydown",m.hitch(this,m.hitch(this,function(A){!A||A.keyCode!=g.ENTER||A.shiftKey||A.metaKey||A.ctrlKey||A.altKey||this._setButton.get("disabled")||(z.onExecute(),z.execute(z.get("value")))}))));t()}))},_checkAndFixInput:function(){var t=this,w=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var u=w,v=!1,x=!1;u&&1<u.length&&(u=m.trim(u),0!==u.indexOf("mailto:")&&(0<u.indexOf("/")?-1===u.indexOf("://")&&"/"!==u.charAt(0)&&u.indexOf("./")&&0!==u.indexOf("../")&&t._hostRxp.test(u)&&(v=!0):t._userAtRxp.test(u)&&(x=!0)));v&&t._urlInput.set("value","http://"+u);x&&t._urlInput.set("value","mailto:"+u);t._setButton.set("disabled",!t._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(m.hitch(this,
function(){this.own(n(this.editor.editNode,"mouseup",m.hitch(this,"_onMouseUp")));this.own(n(this.editor.editNode,"dblclick",m.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(t){this.dropDown.set({parserScope:"dojo",content:t})},_checkValues:function(t){t&&t.urlInput&&(t.urlInput=t.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&t&&t.textInput&&("function"===typeof this.linkFilter?t.textInput=this.linkFilter(t.textInput):
K.forEach(this.linkFilter,function(w){t.textInput=t.textInput.replace(w[0],w[1])}));return t},_createlinkEnabledImpl:function(){return!0},setValue:function(t){this._onCloseDialog();if(9>b("ie")){var w=f.getSelection(this.editor.window).getRangeAt(0).endContainer;3===w.nodeType&&(w=w.parentNode);w&&w.nodeName&&w.nodeName.toLowerCase()!==this.tag&&(w=this.editor.selection.getSelectedElement(this.tag));w&&w.nodeName&&w.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(w),
this.editor.execCommand("unlink"))}t=this._checkValues(t);this.editor.execCommand("inserthtml",d.substitute(this.htmlTemplate,t));c("a",this.editor.document).forEach(function(u){u.innerHTML||a.has(u,"name")||u.parentNode.removeChild(u)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(t){if(t&&t.tagName.toLowerCase()===this.tag){var w=t.getAttribute("_djrealurl")||t.getAttribute("href");var u=t.getAttribute("target")||"_self";var v=t.textContent||
t.innerText;this.editor.selection.selectElement(t,!0)}else v=this.editor.selection.getSelectedText();return{urlInput:w||"",textInput:v||"",targetSelect:u||""}},_onOpenDialog:function(){if(b("ie")){var t=f.getSelection(this.editor.window);if(t.rangeCount){var w=t.getRangeAt(0);var u=w.endContainer;3===u.nodeType&&(u=u.parentNode);u&&u.nodeName&&u.nodeName.toLowerCase()!==this.tag&&(u=this.editor.selection.getSelectedElement(this.tag));if(!u||u.nodeName&&u.nodeName.toLowerCase()!==this.tag)(t=this.editor.selection.getAncestorElement(this.tag))&&
t.nodeName&&t.nodeName.toLowerCase()==this.tag?(u=t,this.editor.selection.selectElement(u)):w.startContainer===w.endContainer&&(t=w.startContainer.firstChild)&&t.nodeName&&t.nodeName.toLowerCase()==this.tag&&(u=t,this.editor.selection.selectElement(u))}}else u=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(u))},_onDblClick:function(t){if(t&&t.target&&(t=t.target,(t.tagName?t.tagName.toLowerCase():
"")===this.tag&&a.get(t,"href"))){var w=this.editor;this.editor.selection.selectElement(t);w.onDisplayChanged();w._updateTimer&&(w._updateTimer.remove(),delete w._updateTimer);w.onNormalizedDisplayChanged();var u=this.button;setTimeout(function(){u.set("disabled",!1);u.loadAndOpenDropDown().then(function(){u.dropDown.focus&&u.dropDown.focus()})},10)}},_onMouseUp:function(){if(b("ff")){var t=this.editor.selection.getAncestorElement(this.tag);if(t){var w=f.getSelection(this.editor.window).getRangeAt(0);
if(w.collapsed&&t.childNodes.length){var u=w.cloneRange();u.selectNodeContents(t.childNodes[t.childNodes.length-1]);u.setStart(t.childNodes[0],0);1!==w.compareBoundaryPoints(u.START_TO_START,u)?w.setStartBefore(t):-1!==w.compareBoundaryPoints(u.END_TO_START,u)&&w.setStartAfter(t)}}}}}),q=p("dijit._editor.plugins.ImgLinkDialog",[r],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(t){if(t&&t.tagName.toLowerCase()===this.tag){var w=t.getAttribute("_djrealurl")||t.getAttribute("src");var u=t.getAttribute("alt");this.editor.selection.selectElement(t,!0)}else u=this.editor.selection.getSelectedText();return{urlInput:w||"",textInput:u||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(m.hitch(this,function(){this.own(n(this.editor.editNode,"mousedown",m.hitch(this,"_selectTag")))}))},_selectTag:function(t){t&&t.target&&(t=t.target,(t.tagName?t.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(t))},_checkValues:function(t){t&&t.urlInput&&(t.urlInput=t.urlInput.replace(/"/g,"\x26quot;"));t&&t.textInput&&(t.textInput=t.textInput.replace(/"/g,"\x26quot;"));return t},_onDblClick:function(t){if(t&&t.target&&(t=t.target,(t.tagName?
t.tagName.toLowerCase():"")===this.tag&&a.get(t,"src"))){var w=this.editor;this.editor.selection.selectElement(t);w.onDisplayChanged();w._updateTimer&&(w._updateTimer.remove(),delete w._updateTimer);w.onNormalizedDisplayChanged();var u=this.button;setTimeout(function(){u.set("disabled",!1);u.loadAndOpenDropDown().then(function(){u.dropDown.focus&&u.dropDown.focus()})},10)}}});l.registry.createLink=function(t){var w={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in t?t.allowUnsafeHtml:!1};
"linkFilter"in t&&(w.linkFilter=t.linkFilter);return new r(w)};l.registry.insertImage=function(){return new q({command:"insertImage"})};r.ImgLinkDialog=q;return r})},"arcgisonline/pages/dijit/ItemShareSummary":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/on dojo/dom-construct dijit/_TemplatedMixin dijit/_WidgetBase ../utils/icons ../utils/dom ../utils/item dojo/text!./ItemShareSummary/ItemShareSummary.html dojo/i18n!../../nls/arcgisonline ../item/_Actions".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);return function(){function q(t,w){this.templateString=h.default;this.i18n=f.default;this.icons=c.default;this.showShareGroups=this.canShare=this.right=!1;this.responsive=!0;this.totalGroups=0;this.responsiveClass=
this.directionClass=""}q.prototype.postMixInProperties=function(){this.inherited(arguments);var t={private:c.default.user["16"],shared:c.default.user["16"],org:c.default.organization["16"],public:c.default.globe["16"]},w={private:f.default.itemSharing.owner,shared:f.default.itemSharing.owner,org:f.default.itemSharing.org,public:f.default.itemSharing.public};this.levelIcon=this.item.access&&t[this.item.access]||"";this.levelTooltip="".concat(f.default.itemSharing.shareLevel," ").concat(w[this.item.access]);
this.right&&(this.directionClass="share-summary--right");this.responsive&&(this.responsiveClass="share-summary--responsive");this.uid="".concat(this.item.id,"-share-summary")};q.prototype.postCreate=function(){var t,w;this.inherited(arguments);var u=!this.showShareGroups&&"shared"===this.item.access,v=this.showShareGroups&&0<(null===(t=this.item.groupData)||void 0===t?void 0:t.length);t=this.domNode.querySelector(".js-share-button");var x=this.item.title?f.default.itemSharing.updateSharingTitle.replace("${title}",
this.item.title):f.default.itemSharing.updateSharing,z=f.default.itemSharing.updateSharing,A=this.item.title?f.default.itemSharing.shareLevelTitle.replace("${title}",this.item.title):f.default.itemSharing.shareLevel,B=f.default.itemSharing.ariaLabels.privateGroups;"shared"!==this.item.access&&(B=v?"Groups":"",B=f.default.itemSharing.ariaLabels["".concat(this.item.access).concat(B)]);this.allowShare&&(this.item.canShare||l.default.canShareItem(this.item,this.portalUser))?(this.own((0,g.default)(t,
"click",this.handleClick.bind(this))),t.classList.add("share-summary__button--editable")):(z=m.default.create("span"),m.default.place(z,t,"before"),z.innerHTML=t.innerHTML,t.parentNode.removeChild(t),t=z,d.default.addClasses(t,["share-summary__button","flex","flex-center","flex-0"]),t.querySelector(".js-icon").tabIndex=0,z=x="");A="".concat(A," ").concat(B," ").concat(x);z="".concat(z).concat(z?", ":"").concat(f.default.itemSharing.shareLevel," ").concat(B);B=this.domNode.querySelector(".js-share-summary-tooltip");
t.setAttribute("aria-label",A);t.setAttribute("id",this.uid);B.querySelector(".js-tooltip-content").innerHTML=z;B.setAttribute("label",A);v&&(this.totalGroups=this.item.sharedGroups||0,z=null===(w=this.item.groupData)||void 0===w?void 0:w.map(function(J){return{id:J.id||J.groupId,title:J.title||J.groupTitle,thumbnail:J.thumbnail||J.groupThumbnail}}),0<(null===z||void 0===z?void 0:z.length)&&d.default.createElement("arcgis-group-thumbnail-stack",{groups:z,portal:this.portal,maxGroups:3,scale:"s"},
t));u&&this.domNode.classList.add("share-summary--show-unknown-group");v&&this.domNode.classList.add("share-summary--show-unknown-group-responsive");u||v||(this.domNode.querySelector(".js-sharing-plus-icon").classList.add("hide"),this.domNode.classList.add("share-summary--no-groups"))};q.prototype.handleClick=function(t){var w=this,u,v;t.preventDefault();t.stopPropagation();var x=this.item,z=this.telemetry,A=x.portal,B=this.portalUser;if(null===(u=window.location.pathname)||void 0===u?0:u.includes("content.html"))null===
(v=this.telemetry)||void 0===v?void 0:v.logEvent({eventType:"other",pageName:"content",pageUrl:window.location.href,path:window.location.pathname,category:"item action",action:"share"});this.item.isOwner?r.default.share({evt:t,item:x,user:B,portal:A,telemetry:z}):this.item.getOwnerProfile(!0,!0).then(function(J){w.item.itemOwner=J;r.default.share({evt:t,item:x,user:B,portal:A,telemetry:z})})};return q=p.__decorate([(0,a.default)(b.default,n.default)],q)}()})},"arcgisonline/pages/dijit/OrgPopup/OrgPopup":function(){define("require exports tslib esri/Evented dojo/text!./OrgPopup.html dojo/i18n!../../../nls/arcgisonline dojo/on dojo/keys dijit/_TemplatedMixin dijit/_WidgetBase dijit/popup dijit/TooltipDialog arcgisonline/pages/utils/dom arcgisonline/pages/utils/focus arcgisonline/pages/utils/icons arcgisonline/tsutils/declareDecorator".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);return function(){function w(u,v){this.templateString=g.default;this.i18n=m.default;this.icons=q.default}w.prototype.postCreate=function(){this.inherited(arguments);
this.dialog=new h.default({class:"profile-popup",title:"",content:this.domNode,_onKey:this.handleDialogKeydown.bind(this)});this.render();this.addEventListeners()};w.prototype.open=function(){var u=this;l.default.open({popup:this.dialog,orient:["below","above"],around:this.opener,onCancel:function(){u.opener.focus();u.close()}});this.dialog.domNode.parentElement.classList.add("profile-popup__container");var v=r.default.getFocusableElements(this.dialog.domNode);this.firstFocusItem=v[0];this.lastFocusItem=
v[v.length-1];this.firstFocusItem.focus();setTimeout(function(){f.default.showHide(u.descToggle,u.descEl.scrollHeight>u.descEl.clientHeight)},100)};w.prototype.close=function(){l.default.close(this.dialog);this.dialog.destroy();this.destroy();this.emit("close")};w.prototype.render=function(){f.default.showHide(this.descContainer,!!this.item.verified.description);this.item.verified.description&&(this.descEl.innerHTML=this.item.verified.description)};w.prototype.addEventListeners=function(){var u=this;
this.own((0,n.default)(this.closeIcon,"click",function(){l.default.close(u.dialog)}),(0,n.default)(this.domNode,"click",function(v){v.stopPropagation()}),(0,n.default)(document.body,"click",function(){u.close()}),(0,n.default)(this.descToggle,"click",function(){return u.handleDescToggle()}))};w.prototype.handleDialogKeydown=function(u){var v=this;if(u.keyCode===b.default.TAB)if(u.stopPropagation(),this.lastFocusItem!==u.target||u.shiftKey)u.shiftKey&&this.firstFocusItem===u.target&&(u.preventDefault(),
this.opener.focus(),this.close());else{u.preventDefault();var x=r.default.getFocusableElements(document.body);x.forEach(function(z,A){z===v.opener&&x[A+1].focus()});this.close()}};w.prototype.handleDescToggle=function(){this.descContainer.classList.toggle("profile-popup__bio-container--expanded")};return w=p.__decorate([(0,t.default)(d.default,c.default,a.default)],w)}()})},"arcgisonline/pages/item/_servicesDirectoryViewModal":function(){define("require exports tslib ../pageUtil ../utils/queryHandler ../utils/setItemUrls ./components/ServicesDirectoryModal preact dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c){Object.defineProperty(K,"__esModule",{value:!0});K.handleViewModalClick=K.shouldOpenLayerInViewModal=K.shouldOpenViewModal=void 0;a=p.__importDefault(a);g=p.__importStar(g);m=p.__importDefault(m);n=p.__importDefault(n);c=p.__importDefault(c);K.shouldOpenViewModal=function(d,l){var h,f,r="WFS"===d.type,q=-1<d.typeKeywords.indexOf("Service Proxy")&&-1<(null===(h=d.sourceUrl)||void 0===h?void 0:h.indexOf(".arcgis.com"))&&"public"!==d.sharing.access;h="Feature Service"===d.type&&
-1<(null===(f=d.url)||void 0===f?void 0:f.indexOf(".arcgis.com"))&&"public"!==d.sharing.access;f=!r||"public"!==d.sharing.access&&r;l=!l&&"public"===d.sharing.access;return(d.isHostedService||d.isFeatureCollection||q||h)&&f&&!l&&!d.portal.isPortal};K.shouldOpenLayerInViewModal=function(d,l,h){var f;h=!h&&"public"===d.sharing.access;var r=!l.itemId&&l.url;l=null===(f=l.url)||void 0===f?void 0:f.includes(".arcgis.com");return r&&l&&!h&&!d.portal.isPortal};K.handleViewModalClick=function(d,l,h,f){var r,
q;void 0===f&&(f=!1);var t=document.body.querySelector("#".concat("services-directory-container"));t||(t=document.createElement("div"),t.id="services-directory-container",document.body.appendChild(t));var w=c.default.common;w={title:"ArcGIS REST Services Directory",close:w.close,loading:w.loading};var u=(null===(q=null===(r=null===h||void 0===h?void 0:h.dataset)||void 0===r?void 0:r.url)||void 0===q?void 0:q.split("?"))||[];r=1<u.length?g.queryToObject(u[1]):{};q=1<u.length?r.token||"":"";l=d.serverToken||
(null===l||void 0===l?void 0:l.getToken())||"";!q&&d.canUpdate?(r.token=l,l="".concat(u[0],"?").concat(g.objectToQuery(r))):l=m.default.swivelToken(h.dataset.url,q,l);a.default.updateQueryParams({view:"service"});(0,b.render)((0,b.h)(n.default,{item:d,itemUrl:l,strings:w,onClose:function(){a.default.removeQueryParams(["view"]);(0,b.render)(null,t);f||h.focus()}}),t)};K.default={shouldOpenViewModal:K.shouldOpenViewModal,handleViewModalClick:K.handleViewModalClick}})},"arcgisonline/pages/item/components/ServicesDirectoryModal":function(){define("require exports tslib ../../utils/queryHandler preact preact/hooks ./EmbedServiceDataModal".split(" "),
function(e,K,p,a,g,m,n){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importStar(a);K.default=function(b){var c=b.item,d=b.itemUrl,l=void 0===d?c.viewUrl:d;d=b.strings;var h=b.onClose,f=(0,m.useState)(!1);b=f[0];var r=f[1];f=(0,m.useMemo)(function(){var q=-1<["Map Service","Image Service"].indexOf(c.type);var t=c.sourceData&&-1<["Service Definition","Tile Package"].indexOf(c.sourceData.type),w=!c.portal.isPortal&&0===l.indexOf("https://tiles")&&-1<l.indexOf(".arcgis.com");q&&(t||w)?(q=l.split("?"),
t=1<q.length?a.queryToObject(q[1]):{},t.f="pjson",q="".concat(q[0],"?").concat(a.objectToQuery(t))):q=l;return q},[c,l]);return(0,g.h)(n.EmbedServiceDataModal,{onClose:function(){h();r(!1)},isActive:b,onModalMounted:function(){return r(!0)},url:f,strings:d})}})},"arcgisonline/pages/item/components/EmbedServiceDataModal":function(){define(["require","exports","preact","preact/hooks"],function(e,K,p,a){Object.defineProperty(K,"__esModule",{value:!0});K.EmbedServiceDataModal=void 0;K.EmbedServiceDataModal=
function(g){var m=g.isActive,n=g.url,b=g.strings,c=g.onClose,d=g.onModalMounted;g=g.isImageResource;var l=(0,a.useState)(!0),h=l[0],f=l[1],r=(0,a.useRef)(null);l=(0,a.useRef)(null);var q=(0,a.useRef)(null);(0,a.useEffect)(function(){r.current&&(null===d||void 0===d?void 0:d())},[r.current]);(0,a.useEffect)(function(){m&&r.current.setFocus()},[m]);var t=function(){c()},w=function(){f(!1)};return(0,p.h)("calcite-modal",{ref:r,open:m,role:"dialog","aria-label":b.title,"aria-modal":"true",fullscreen:!0,
escapeDisabled:!0,outsideCloseDisabled:!0,oncalciteModalClose:t,"data-test":"modal"},(0,p.h)("h3",{slot:"header",class:"font-size-2 trailer-0","data-test":"title"},b.title),(0,p.h)("div",{slot:"content",ref:l,class:"full-height ".concat(g?"":"flex-column")},g?(0,p.h)("img",{src:n,alt:b.imgAlt}):(0,p.h)("div",{class:"flex-column flex-1"},(0,p.h)("calcite-loader",{hidden:!h,scale:"l",type:"indeterminate",label:b.loading,"data-test":"loader"}),(0,p.h)("iframe",{ref:q,class:"flex-1 services-directory-modal__iframe",
src:n,onLoad:w,"data-test":"iframe",style:h?"visibility: hidden;":"visibility: visible;"}))),(0,p.h)("calcite-button",{slot:"primary",width:"full",kind:"brand",appearance:"solid",onClick:t,"data-test":"close"},b.close))}})},"arcgisonline/pages/item/widgets/_sublayer":function(){define("require exports tslib ../../serviceUtil ../../pageUtil ../../utils/dom ../../dijit/ConfirmDlg ../../dijit/InlineEdit ../../dijit/MemberThumb ../../dijit/ToggleSwitch ../_Actions ../_export ../_servicesDirectoryViewModal ../../utils/alerts ../../utils/arrays ../../utils/dom ../../utils/formatters ../../utils/icons ../../utils/mapViewer ../../utils/metadata ../../utils/setItemUrls ../../utils/layer ../../../esriGeowConfig ../../../sharing/dijit/CopyToClipboard ../../../sharing/dijit/dialog/LayerTimeSettings ../../../tsutils/declareDecorator calcite-web/js/calcite-web dijit/_WidgetBase dijit/_TemplatedMixin dojo/Deferred dojo/topic dojo/on esri/lang esri/libs/sanitizer/Sanitizer dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/_sublayer.html dojo/text!./templates/sublayer/_disableAttachments.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);z=p.__importDefault(z);B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);
T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);D=p.__importDefault(D);C=p.__importDefault(C);y=p.__importDefault(y);G=p.__importDefault(G);L=p.__importDefault(L);O=p.__importDefault(O);return function(){function U(M,Q){this.icons=u.default;this.i18n=G.default;this.templateString=L.default;this.completeDate=w.default.completeDate;this.fullDate=w.default.fullDate;this.empty=w.default.empty;this.sanitizer=new y.default}U.prototype.postMixInProperties=function(){var M,
Q,Y;this.inherited(arguments);this.layerType=(null===(M=this.sublayer)||void 0===M?void 0:M.type)||"";this.geometryType=(null===(Q=this.sublayer)||void 0===Q?void 0:Q.geometryType)||"";this.lastUpdate=(M=null===(Y=this.sublayer.editingInfo)||void 0===Y?void 0:Y.lastEditDate)?this.page._formatDateTime(M):""};U.prototype.postCreate=function(){var M=this;this.inherited(arguments);this.item.isLoaded?(this.sublayer=this.findSublayer(this.item,this.sublayer),this.addMetadata().then(function(){return M.initUI()})):
this.own(this.item.watch("isLoaded",function(){M.sublayer=M.findSublayer(M.item,M.sublayer);M.addMetadata().then(function(){return M.initUI()})}))};U.prototype.findSublayer=function(M,Q){var Y;return 0<(null===(Y=M.layers)||void 0===Y?void 0:Y.length)&&(M=q.default.find(M.layers,function(fa){return fa.id===Q.id}))?M:Q};U.prototype.addMetadata=function(){var M=this,Q=this.sublayer,Y=new I.default;Q.hasMetadata?(Q=this.metadataUrl(this.sublayer),(0,x.retrieveArcGISXml)(Q.url,{token:Q.token}).then(function(fa){M.parseMetadata(fa);
Y.resolve()},function(fa){Y.resolve()})):(this.parseMetadata(),Y.resolve());return Y};U.prototype.parseMetadata=function(M){var Q=this.sublayer,Y={};M?(this.originalXML=(new DOMParser).parseFromString(M,"text/xml"),Y=(0,x.parseEsriXML)(this.originalXML)):this.originalXML=null;M=Q.description&&(0,x.decodeHTMLEntities)(Q.description);this.descriptionText=Y.abstract||M||"";this.summaryText=Y.summary||"";this.copyrightText=Y.credits||Q.copyrightText||"";this.zDefault=String(Q.zDefault);this.enableZDefaults=
Q.enableZDefaults};U.prototype.userCanEditMetadata=function(M){var Q=M.portal,Y=M.canUpdate;M=M.isHostedService;var fa=this.originalXML&&!(0,x.isValidArcGISMetadata)(this.originalXML);return M&&Y&&Q.metadataEditable&&!Q.isPortal&&!fa};U.prototype.createUnifiedMetadataEditor=function(){var M,Q,Y;return p.__awaiter(this,void 0,void 0,function(){var fa,va,Aa,pa,N,V,Z,ba,ma=this;return p.__generator(this,function(sa){if(!this.item.canUpdate||!this.page.portal.metadataEditable)return[2];fa=!1!==(null===
(M=this.page.portal.portalProperties)||void 0===M?void 0:M.metadataEditorBetaEnabled);if(!fa)return[2];va=this.domNode.querySelector(".js-metadata-iframe");m.default.showNode(va);Aa=document.documentElement;pa=Aa.lang;N=Aa.dir;V="";this.sublayer.layerMetadataUrl?V=this.sublayer.layerMetadataUrl.split("?")[0]:this.sublayer.url&&(V="".concat(this.sublayer.url.split("?")[0],"/metadata"));va.src="./metadata-editor.html?portalUrl\x3d".concat(B.default.restBaseUrl.replace("/sharing/rest/",""),"\x26itemId\x3d").concat(this.item.id,
"\x26metadataFormat\x3d").concat((null===(Y=null===(Q=this.page.portal)||void 0===Q?void 0:Q.metadataFormats)||void 0===Y?void 0:Y[0])||"","\x26lang\x3d").concat(pa,"\x26dir\x3d").concat(N,"\x26layerUrl\x3d").concat(V,"\x26layerName\x3d").concat(this.sublayer.name);m.default.hideNode(this.metadataEdit);Z=this.domNode.querySelector(".js-metadata-split");Z.classList.remove("hide");Z.classList.add("display-block");ba=this.domNode.querySelector(".js-metadata-wrapper");this.domNode.querySelector(".js-unified-metadata").addEventListener("click",
function(){va.contentWindow.postMessage({name:"init-strings",strings:p.__assign(p.__assign({},ma.i18n.common),ma.i18n.metadataEditor)},"*");va.contentWindow.postMessage({name:"edit-metadata",itemId:ma.item.id},"*");m.default.showNode(ba);document.documentElement.classList.add("overflow-hidden")});window.onmessage=function(Ea){return p.__awaiter(ma,void 0,void 0,function(){return p.__generator(this,function(ya){"metadata-close"===Ea.data?(m.default.hideNode(ba),document.documentElement.classList.remove("overflow-hidden")):
"metadata-save"===Ea.data&&this.metadataUpdated({deleted:!1});return[2]})})};document.body.appendChild(ba);return[2]})})};U.prototype.initUI=function(){var M,Q=this.item,Y=this.sublayer,fa=Q.isLocationTrackingService,va=Q.canUpdate,Aa=Q.isHostedService,pa=Q.isAdmin,N=Q.isOwner;this.canEditMetadata=this.userCanEditMetadata(Q);this.canEditInfo=!fa&&va&&Aa&&(pa||N);t.default.addClasses(this.domNode.querySelector(".js-sublayer-content"),(this.sublayer.attributes||[]).filter(function(V){return V}));this.initEditors();
this.setUrls();new J.default({text:null===(M=Y.url)||void 0===M?void 0:M.split("?")[0],tooltipModifier:"tooltip-left",id:"service-url",label:this.i18n.itemProperties.url},this.domNode.querySelector(".js-sublayer-copy"));this.enableAttachments=new d.default({label:Q.isDataView?G.default.sublayer.showAttachments:G.default.sublayer.enableAttachments,labelPosition:"left",isChecked:Y.hasAttachments},this.domNode.querySelector(".js-toggle-attachments"));this.showSections();M=this.domNode.querySelector(".js-create-view-button");
Q=this.domNode.querySelector(".js-create-view-dropdown");document.body.classList.contains("can-update")&&document.body.classList.contains("can-publish-views")&&!this.item.isVelocity()&&this.item.isSpatiotemporal&&(m.default.hideNode(Q),m.default.showNode(M),this.viewLayer=M);g.default.checkLayersForNewFieldTypes(this.item)&&m.default.hideNode(this.domNode.querySelector(".js-map-dropdown"));this.addEventListeners();S.default.init();(0,h.alignToSupportedExportFormats)(this.item,this.page.portal,this.domNode);
this.createUnifiedMetadataEditor()};U.prototype.initEditors=function(){var M=this.summaryText,Q=this.descriptionText,Y=this.copyrightText,fa=this.zDefault,va=this.enableZDefaults,Aa=this.item,pa=this.canEditMetadata||this.canEditInfo,N=!this.page.portal.isPortal&&va,V=G.default.sublayer.defaultZValue;"esriUnknownUnits"!==Aa.serviceInfo.units&&(V+=" (".concat(G.default.sublayer.units[Aa.serviceInfo.units],")"));this.summaryEditor=new b.default({inputId:"sublayer-summary-edit",inputType:"textArea",
inputLabel:this.i18n.itemProperties.editSummary,editButtonUpdatePermissionClasses:this.canEditMetadata?"":"hide",prop:"sublayerSummary",value:M},document.querySelector(".js-sublayer-summary-section"));this.descriptionEditor=new b.default({inputId:"sublayer-description-edit",inputType:"richText",inputLabel:this.i18n.itemProperties.editDescription,editButtonUpdatePermissionClasses:pa?"":"hide",prop:"sublayerDescription",value:Q},document.querySelector(".js-sublayer-description-section"));this.creditsEditor=
new b.default({inputType:"textArea",rows:6,inputLabel:this.i18n.itemProperties.editCredits,prop:"sublayerCredits",value:Y,editButtonUpdatePermissionClasses:pa?"":"hide",pattern:"^[^\x3c\x3e]*$",invalidText:this.i18n.itemProperties.error.badCharacterCredits,formatter:this.page._linkify},this.domNode.querySelector(".js-sublayer-credits"));this.zDefaultEditor=va&&new b.default({inputType:"numericChange",inputLabel:V,prop:"sublayerZDefault",value:fa,editButtonUpdatePermissionClasses:N?"":"hide",inputClass:"z-default-value-edit"},
this.domNode.querySelector(".js-zDefaultValueEnabled"))};U.prototype.configureViewUI=function(){var M=this,Q;this.viewLink&&(0,f.shouldOpenViewModal)(this.item,this.portalUser)&&(null===(Q=this.viewLinkClickHandler)||void 0===Q?void 0:Q.remove(),this.viewLinkClickHandler=void 0,this.viewLink.dataset.url=this.viewLink.href,this.viewLink.href="".concat(z.default.removeToken(this.viewLink.href)),this.viewLinkClickHandler=(0,D.default)(this.viewLink,"click",function(Y){var fa=M.viewLink;(0,f.shouldOpenViewModal)(M.item,
M.portalUser)&&(Y.preventDefault(),Y.stopPropagation(),(0,f.handleViewModalClick)(M.item,M.portalUser,fa))}),this.own(this.viewLinkClickHandler))};U.prototype.setUrls=function(){var M,Q=-1<(null===(M=this.item.typeKeywords)||void 0===M?void 0:M.indexOf("Service Proxy"))?"".concat(-1<this.item.url.indexOf("?")?"\x26":"?","f\x3dpjson"):"";M=this.sublayer.mapViewerUrl.replace("useExisting\x3d1\x26","");this.viewLink.href=this.sublayer.url+Q;this.portalUser&&this.portalUser.defaultMapViewer!==v.MapViewerType.Modern?
(this.viewerLink.href=this.sublayer.mapViewerUrl,this.newViewerLink.href=M,this.newViewerWithEditLink.href="".concat(M,"\x26isAdmin\x3dtrue"),this.newMapViewerLink.href=this.sublayer.newMapViewerUrl,this.newViewerLink.dataset.href=M,this.newViewerWithEditLink.dataset.href="".concat(M,"\x26isAdmin\x3dtrue")):(this.viewerLink.textContent=G.default.itemLinks.openMapViewerBeta,this.viewerLink.href=this.sublayer.newMapViewerUrl,this.viewerLink.dataset.href=this.sublayer.newMapViewerUrl,this.newMapViewerLink.textContent=
G.default.itemLinks.openMapViewer,this.newMapViewerLink.href=this.sublayer.mapViewerUrl,this.newMapViewerLink.dataset.href=this.sublayer.mapViewerUrl,this.newViewerWithEditLink.href="".concat(M,"\x26isAdmin\x3dtrue"),this.newViewerWithEditLink.textContent=G.default.itemLinks.openMapViewerWithControl,this.newViewerWithEditLink.dataset.href="".concat(M,"\x26isAdmin\x3dtrue"),t.default.hideNode(this.newViewerLink));this.configureViewUI()};U.prototype.showSections=function(){this.showOwner();this.showLastUpdated();
this.showSummary();this.showDescription();this.showCredits();this.showTimeSettings();this.showAttachments();this.showAppend();this.showContent();this.showMetadata();this.showGeocodeReview();this.showSubtypes()};U.prototype.addEventListeners=function(){var M=this;this.own(F.default.subscribe("inlineEdit/submit",function(Q){C.default.isDefined(Q.sublayerDescription)&&M.updateDescription(Q.sublayerDescription);C.default.isDefined(Q.sublayerCredits)&&M.updateCredits(Q.sublayerCredits);C.default.isDefined(Q.sublayerSummary)&&
M.updateSummary(Q.sublayerSummary);C.default.isDefined(Q.sublayerZDefault)&&M.updateZDefault(Q.sublayerZDefault)}),F.default.subscribe("metadata/layerEditor/updated",this.metadataUpdated.bind(this)),this.enableAttachments.on("change",this.toggleAttachments.bind(this)));this.timeSettingsEdit.addEventListener("click",this.editTime.bind(this));this.append.addEventListener("click",this.appendData.bind(this));this.export.addEventListener("click",this.exportData.bind(this));this.metadataEdit.addEventListener("click",
this.editMetadata.bind(this));this.metadataEditSplit.addEventListener("click",this.editMetadata.bind(this));this.sublayerOwnerPopup.addEventListener("click",this.openOwnerPopup.bind(this));this.viewLayer.addEventListener("click",this.publishViewLayer.bind(this));this.joinedViewLayer.addEventListener("click",this.publishViewLayer.bind(this));this.newViewerLink.addEventListener("click",this.openNewMap.bind(this));this.newViewerWithEditLink.addEventListener("click",this.openNewMap.bind(this))};U.prototype.showContent=
function(){t.default.hideNode(this.domNode.querySelector(".js-sublayer-loader"));t.default.showNode(this.domNode.querySelector(".js-sublayer-content"))};U.prototype.showLastUpdated=function(){t.default.showHide(this.lastUpdated,!!this.lastUpdate)};U.prototype.showOwner=function(){new c.default({cssClasses:"margin-right-quarter inline-block flex-0",member:this.item.itemOwner,scale:"s"},this.domNode.querySelector(".js-sublayer-owner-thumb"))};U.prototype.showGeocodeReview=function(){var M=-1<this.item.typeKeywords.indexOf("Involved Lookup"),
Q=this.item.isAdmin;t.default.addRemoveClass(this.geocodeReview,"hide",!M||!Q);this.geocodeReview.href="".concat(this.item.mapViewerWithReviewUrl,"\x26layerId\x3d").concat(this.sublayer.id)};U.prototype.showSubtypes=function(){var M=(0,A.isSubtypeGroupLayer)(this.sublayer,this.item);t.default.addRemoveClass(this.subtypes,"hide",!M);M&&(this.subtypesList.innerHTML=this.sublayer.subtypes.reduce(function(Q,Y){return"".concat(Q,' \x3cli class\x3d"padding-trailer-half"\x3e').concat(Y.name,"\x3c/li\x3e")},
""))};U.prototype.showSummary=function(){var M=this.summaryText;this.summary.innerHTML=this.sanitizer.sanitize(M);M=!!M;t.default.addRemoveClass(this.summary,"hide",!M);t.default.addRemoveClass(this.summaryAdd,"hide",M||!this.canEditMetadata);t.default.addRemoveClass(this.summaryUnavailable,"hide",M||this.canEditMetadata)};U.prototype.updateSummary=function(M){var Q=this,Y=this.domNode.querySelector(".js-sublayer-summary-loader");Y.classList.add("is-active");this.updateXML("summary",M).then(function(){Q.summaryText=
M;Y.classList.remove("is-active");F.default.publish("inlineEdit/sublayerSummary/done");r.default.showAlert("success",G.default.sublayer.summaryUpdated);Q.showSummary()},this.errorHandler)};U.prototype.showDescription=function(){this.description.innerHTML=this.sanitizer.sanitize(this.descriptionText);var M=this.canEditInfo,Q=!!this.descriptionText;t.default.addRemoveClass(this.description,"hide",!Q);t.default.addRemoveClass(this.descriptionAdd,"hide",Q||!M);t.default.addRemoveClass(this.descriptionUnavailable,
"hide",Q||M)};U.prototype.updateDescription=function(M){var Q=this,Y=this.domNode.querySelector(".js-sublayer-description-loader");Y.classList.add("is-active");this.updateService({description:(0,x.encodeHTMLEntities)(M)}).then(function(){return Q.updateXML("abstract",M)},this.errorHandler).then(function(){Q.sublayer.description=M;Q.descriptionText=M;F.default.publish("inlineEdit/sublayerDescription/done");r.default.showAlert("success",G.default.sublayer.descriptionUpdated);Q.showDescription();Y.classList.remove("is-active")},
this.errorHandler)};U.prototype.updateZDefault=function(M){var Q=this;this.updateService({zDefault:M}).then(function(Y){var fa=Q.domNode.querySelector(".z-default-value-edit"),va=fa.getAttribute("value");fa.setAttribute("value",M);Y?Q.sublayer.zDefault=Number(M):(Q.zDefaultEditor.value=va,fa.setAttribute("value",va));F.default.publish("inlineEdit/sublayerZDefault/done")})};U.prototype.showCredits=function(){this.credits.innerHTML=this.sanitizer.sanitize(this.copyrightText);var M=this.canEditInfo,
Q=!!this.copyrightText;t.default.addRemoveClass(this.credits,"hide",!Q);t.default.addRemoveClass(this.creditsAdd,"hide",Q||!M);t.default.addRemoveClass(this.creditsUnavailable,"hide",Q||M)};U.prototype.updateCredits=function(M){var Q=this,Y=this.domNode.querySelector(".js-sublayer-credits-loader");Y.classList.add("is-active");this.updateService({copyrightText:M}).then(function(){return Q.updateXML("credits",M)}).then(function(){Y.classList.remove("is-active");Q.copyrightText=M;Q.sublayer.copyrightText=
M;r.default.showAlert("success",G.default.sublayer.creditsUpdated);F.default.publish("inlineEdit/sublayerCredits/done");Q.showCredits()},this.errorHandler)};U.prototype.showAppend=function(){t.default.addRemoveClass(this.append,"hide",!this.item.canAppendData)};U.prototype.showAttachments=function(){var M=this,Q,Y=null===(Q=this.item.typeKeywords)||void 0===Q?void 0:Q.includes("Spatiotemporal"),fa=g.default.canEditViewAttachments(this.item)&&this.sublayer.viewSourceHasAttachments&&!Y;g.default.canEnableAttachments(this.item).then(function(va){t.default.addRemoveClass(M.attachments,
"hide",!(va||fa))})};U.prototype.showTimeSettings=function(){var M,Q=this.item,Y=this.sublayer,fa=this.i18n,va=!(null===(M=Y.timeInfo)||void 0===M||!M.startTimeField);M=0<a.default.getDateFields(Y).length;t.default.addRemoveClass(this.timeSettings,"hide",!(Q.canUpdate&&"Table"!==Y.type&&M));this.timeSettingsStatus.setAttribute("placeholder",va?fa.sublayer.enabled:fa.sublayer.disabled);this.timeSettingsStatus.setAttribute("icon",va?"toggle-on":"toggle-off")};U.prototype.showMetadata=function(){var M=
"Feature Service"===this.item.type&&this.item.isHostedService,Q=this.sublayer.layerMetadataUrl;t.default.forEachNode(this.domNode.querySelectorAll(".js-metadata-link"),function(Y){return Y.href=Q});this.page._showDataLastUpdated(this.item,this.sublayer.id);"Table"!==this.sublayer.type&&M&&this.page._showMAndZDefaults(this.item,this.sublayer.id)};U.prototype.updateService=function(M){return a.default.updateServiceDefinition({layerId:this.sublayer.id,item:this.item,definition:M}).then(function(){return!0},
this.errorHandler.bind(this))};U.prototype.toggleAttachments=function(M){var Q=this;this.item.isDataView||M?(this.enableAttachments.showLoader(),g.default.enableAttachments(this.item,this.sublayer,M).then(function(){r.default.showAlert("success",G.default.sublayer[Q.item.isDataView?"attachmentVisibilityUpdated":"attachmentsEnabled"]);Q.page.sublayer.hasAttachments=!0;Q.enableAttachments.hideLoader()},function(Y){Q.errorHandler(Y);Q.enableAttachments.hideLoader()})):(new n.default({title:G.default.sublayer.disableAttachments,
template:O.default,primaryButtonLabel:G.default.common.yes,secondaryButtonLabel:G.default.common.no})).open().then(function(Y){Y?(Q.enableAttachments.showLoader(),g.default.enableAttachments(Q.item,Q.sublayer,!1).then(function(){r.default.showAlert("success",G.default.sublayer.attachmentsDisabled);Q.page.sublayer.hasAttachments=!1;Q.enableAttachments.hideLoader()},function(fa){Q.errorHandler(fa);Q.enableAttachments.hideLoader()})):(M=!0,Q.enableAttachments.setChecked(M,!0))})};U.prototype.editTime=
function(){var M=this;(new P.default({item:this.item,layer:this.sublayer,user:this.portalUser})).showModal().then(function(Q){null!==Q&&void 0!==Q&&Q.id||(M.sublayer.timeInfo=Q.timeInfo,r.default.showAlert("success",G.default.sublayer.timeSettingsUpdated),M.showTimeSettings())})};U.prototype.appendData=function(){l.default.appendData({item:this.item,layer:this.sublayer,page:this.page,user:this.portalUser,newItemEntryPage:"sublayer"})};U.prototype.exportData=function(M){l.default.exportData({layer:this.sublayer,
item:this.item,layerId:this.sublayer.id,evt:M})};U.prototype.editMetadata=function(M){l.default.openLayerMetadata({layer:this.sublayer,layerId:"".concat(this.sublayer.id),item:this.item,evt:M})};U.prototype.openNewMap=function(M){M.preventDefault();M.stopPropagation();l.default.newMapViewer({item:this.item,evt:M})};U.prototype.openOwnerPopup=function(M){l.default.profilePopup({item:this.item,page:this.page,evt:M})};U.prototype.publishViewLayer=function(M){l.default.publishTiles({layer:this.sublayer,
item:this.item,page:this.page,evt:M})};U.prototype.metadataUpdated=function(M){var Q=this;this.sublayer.hasMetadata=!M.deleted;this.addMetadata().then(function(){var Y=Q.sublayer;Q.canEditMetadata=Q.userCanEditMetadata(Q.item);Q.descriptionEditor.updateValue(Y.description);Q.summaryEditor.updateValue(Y.summary);Q.creditsEditor.updateValue(Y.copyrightText);Q.zDefaultEditor.updateValue(String(null===Y||void 0===Y?void 0:Y.zDefault));Q.showSections()})};U.prototype.metadataUrl=function(M){M=M.url.split("?token\x3d");
return{url:"".concat(M[0],"/metadata"),token:M[1]}};U.prototype.updateXML=function(M,Q){var Y=this,fa=new I.default;if(!this.canEditMetadata)return fa.resolve(Q),fa;var va=this.metadataUrl(this.sublayer),Aa=va.url;va=va.token;this.originalXML?(0,x.updateLayerXMLProperty)({url:"".concat(Aa,"/update/"),token:va,prop:M,value:Q,xml:this.originalXML}).then(function(pa){pa&&(Y.originalXML=pa);fa.resolve(Q)},function(pa){Y.errorHandler(pa);fa.resolve(Q)}):(0,x.createLayerXML)({url:"".concat(Aa,"/update/"),
layer:this.sublayer,portal:this.item.portal,token:va,prop:M,value:Q}).then(function(pa){pa&&(Y.originalXML=pa,Y.sublayer.hasMetadata=!0);fa.resolve(Q)},function(pa){Y.errorHandler(pa);fa.resolve(Q)});return fa};U.prototype.errorHandler=function(M){var Q=M.message||G.default.sublayer.errorUpdatingLayer;"Unable to update feature service layer definition."===M.message&&(Q=G.default.sublayer.errorUpdatingLayer);r.default.showAlert("error",Q)};return U=p.__decorate([(0,R.default)(T.default,E.default)],
U)}()})},"arcgisonline/pages/dijit/ConfirmDlg":function(){define("require exports tslib dojo/string dojo/Deferred ./Overlay dojo/i18n!../../nls/arcgisonline ../utils/icons ../../tsutils/declareDecorator".split(" "),function(e,K,p,a,g,m,n,b,c){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);return function(){function d(l,h){this.title="";this.i18n=n.default;this.icons=b.default;this.constrain=!0;this.overlayContents=
"";this.maxWidth=600;this.secondaryBtnText=this.primaryBtnText="";this.closeOnScrimClick=!1;this.secondaryButtonLabel=this.primaryButtonLabel=this.template=""}d.prototype.postMixInProperties=function(){this.inherited(arguments);this.primaryBtnText=this.primaryButtonLabel||n.default.common.ok;this.secondaryBtnText=this.secondaryButtonLabel||n.default.common.cancel;this.overlayContents=a.default.substitute(this.template,{i18n:n.default,icons:b.default})};d.prototype.open=function(){this.inherited(arguments);
return this.dfd=new g.default};d.prototype.close=function(l){this.inherited(arguments);this.dfd.resolve(l)};d.prototype.handleCancel=function(){this.close(!1)};d.prototype.handlePrimary=function(){this.close(!0)};return d=p.__decorate([(0,c.default)(m.default)],d)}()})},"arcgisonline/pages/dijit/ToggleSwitch":function(){define("require exports tslib dojo/text!./ToggleSwitch/templates/ToggleSwitch.html dojo/i18n!../../nls/arcgisonline dojo/Evented dijit/_TemplatedMixin dijit/_WidgetBase dojox/uuid/generateRandomUuid ../utils/dom ../../tsutils/declareDecorator".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);return function(){function h(f,r){this.templateString=a.default;this.i18n=g.default;this.label="";this.labelPosition="right";this.labelClasses="";this.direction="left";this.isChecked=!1;this.tooltipLabel=this.tooltipClass="";this.disabled=!1;this.switchTrackClasses=this.loaderClasses=
this.hasTooltip="";this.hideLabel=!1;this.ariaLabel="";this.isLoading=!1}h.prototype.postMixInProperties=function(){this.inherited(arguments);this.label&&!this.ariaLabel&&(this.ariaLabel=this.label.replace(/(<([^>]+)>)/gi,""));"left"===this.labelPosition&&(this.direction="right");this.uid=(0,c.default)();this.tooltip&&(this.hasTooltip="toggle-switch--tooltip",this.tooltipClass=this.tooltipClass||"tooltip tooltip-multiline")};h.prototype.postCreate=function(){var f=this;this.inherited(arguments);this.hideLabel&&
d.default.hideNode(this._label);this.isChecked&&(this._checkbox.checked=this.isChecked);this.disabled&&this.disable();this.label||d.default.hideNode(this._label);this.tooltip&&this._label.setAttribute("aria-label",this.tooltip);this._checkbox.addEventListener("change",function(r){f.isLoading||f.emit("change",f._checkbox.checked)});this._checkbox.addEventListener("keyup",function(r){13===r.keyCode&&(r.stopPropagation(),f._checkbox.checked=!f._checkbox.checked,f.emit("change",f._checkbox.checked))});
this.domNode.addEventListener("click",function(){f.labelWrapper.click()});this.labelWrapper.addEventListener("click",function(r){r.stopPropagation()});this.trackId&&(this.toggleTrack.id=this.trackId)};h.prototype.hide=function(){d.default.hideNode(this.domNode)};h.prototype.show=function(){d.default.showNode(this.domNode)};h.prototype.checked=function(){return this._checkbox.checked};h.prototype.setChecked=function(f,r){this._checkbox.checked=f;r||this.emit("change",this._checkbox.checked)};h.prototype.enable=
function(){this._checkbox.removeAttribute("disabled");this.domNode.classList.remove("toggle-switch--disabled");this.disabled=!1};h.prototype.disable=function(){this._checkbox.setAttribute("disabled","true");this.domNode.classList.add("toggle-switch--disabled");this.disabled=!0};h.prototype.focus=function(){this._checkbox.focus()};h.prototype.check=function(){this.setChecked(!0,!0)};h.prototype.uncheck=function(){this.setChecked(!1,!0)};h.prototype.showSwitch=function(){d.default.showNode(this.toggleTrack);
d.default.showNode(this._checkbox)};h.prototype.hideSwitch=function(){d.default.hideNode(this.toggleTrack);d.default.hideNode(this._checkbox)};h.prototype.showLoader=function(){this.loader.hidden=!1;d.default.showNode(this.loaderContainer);this.hideSwitch();this.isLoading=!0;this._checkbox.disabled=!0};h.prototype.hideLoader=function(){this.loader.hidden=!0;d.default.hideNode(this.loaderContainer);this.showSwitch();this.isLoading=!1;this._checkbox.disabled=!1};return h=p.__decorate([(0,l.default)(b.default,
n.default,m.default)],h)}()})},"arcgisonline/pages/item/_export":function(){define(["require","exports","tslib","../utils/dom"],function(e,K,p,a){function g(n){a.default.forEachNode(n.querySelectorAll("nav.js-action-exportData \x3e button.dropdown-link"),function(b){b.classList.remove("if-no-multipatch");b.classList.remove("if-no-location-tracking");b.classList.add("hide")})}function m(n,b){var c;null===(c=b.querySelector('button.dropdown-link[data-type\x3d"'.concat(n,'"]')))||void 0===c?void 0:c.classList.remove("hide")}
Object.defineProperty(K,"__esModule",{value:!0});K.alignToSupportedExportFormats=void 0;a=p.__importDefault(a);K.alignToSupportedExportFormats=function(n,b,c){var d,l;!b.isPortal&&(null===(l=null===(d=n.serviceInfo)||void 0===d?void 0:d.supportedExportFormats)||void 0===l?0:l.length)&&(g(c),b=n.serviceInfo.supportedExportFormats.split(","),n.isLocationTrackingService||n.isLocationTrackingView||b.push("kml"),b.forEach(function(h){switch(h){case "csv":m("CSV",c);break;case "shapefile":m("Shapefile",
c);break;case "kml":m("KML",c);break;case "filegdb":m("File Geodatabase",c);break;case "featureCollection":m("Feature Collection",c);break;case "geojson":m("GeoJson",c);break;case "excel":m("Excel",c);break;case "geoPackage":m("GeoPackage",c)}}))}})},"arcgisonline/sharing/dijit/CopyToClipboard":function(){define("require exports tslib ../../pages/utils/icons ../../tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase dojo/text!./templates/CopyToClipboard.html dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);return function(){function d(l,h){this.templateString=b.default;this.icons=a.default;this.i18n=c.default;this.tooltipModifier="";this.icon="copy-to-clipboard"}d.prototype.postMixInProperties=function(){this.inherited(arguments);this.copySupported=document.queryCommandSupported("copy")};d.prototype.postCreate=function(){this.copySupported||
(this.domNode.querySelector(".js-copy-group").classList.remove("input-group"),this.domNode.querySelector(".js-copy-tooltip").classList.add("hide"))};d.prototype.copy=function(l){var h;l=this.domNode.querySelector("#copy-to-clipboard-".concat(this.id));var f=this.domNode.querySelector(".js-copy-tooltip"),r=this.domNode.querySelector(".js-copy-alert");try{l.select(),document.execCommand("copy"),l.blur(),f.setAttribute("aria-label",c.default.common.copiedLbl),r.innerHTML=c.default.common.copiedLbl,this.telemetry&&
this.telemetryPayload&&(null===(h=this.telemetry)||void 0===h?void 0:h.logEvent(this.telemetryPayload))}catch(q){}};d.prototype.reset=function(){this.domNode.querySelector(".js-copy-tooltip").setAttribute("aria-label",c.default.tocPanel.copy);this.domNode.querySelector(".js-copy-alert").innerHTML=""};d.prototype.updateText=function(l){this.copyInput.value=l};return d=p.__decorate([(0,g.default)(n.default,m.default)],d)}()})},"arcgisonline/pages/utils/productGlyphs":function(){define(["require","exports"],
function(e,K){var p={dashboard:{path:"M25.819 28H23.18a.181.181 0 0 1-.181-.181V13.18a.181.181 0 0 1 .181-.181h2.638a.181.181 0 0 1 .181.181V27.82a.181.181 0 0 1-.181.181zM21 27.816v-9.631a.184.184 0 0 0-.184-.185h-2.631a.184.184 0 0 0-.185.184v9.631a.184.184 0 0 0 .184.185h2.631a.184.184 0 0 0 .185-.184zm9.82.184a.18.18 0 0 0 .18-.18v-7.64a.18.18 0 0 0-.18-.18h-2.64a.18.18 0 0 0-.18.18v7.64a.18.18 0 0 0 .18.18zM7 9.267v10.475c.706.033 3.538-1.718 4.274-4.7.679-2.751 3.485-2.864 4.443-2.94 1.766-.14 3.588-.607 4.566-2.798A.216.216 0 0 0 20.085 9H7.267A.267.267 0 0 0 7 9.267zm18.997-1.053A4.411 4.411 0 0 0 21.63 4H2.684A.684.684 0 0 0 2 4.684V21.81A3.19 3.19 0 0 0 5.19 25h9.565a.245.245 0 0 0 .245-.245v-2.362a.393.393 0 0 0-.393-.393H6.38A1.385 1.385 0 0 1 5 20.619V7.349A.348.348 0 0 1 5.348 7h16.324A1.346 1.346 0 0 1 23 8.363v1.28a.357.357 0 0 0 .357.357h2.599a.046.046 0 0 0 .046-.046z",
fill:"#ee9e01"},experienceBuilder:{path:"M30.85 12.82l-2.85 5v7.44A1.78 1.78 0 0 1 26.22 27H25V7.75a.76.76 0 0 0-.75-.75H12V1.31a.28.28 0 0 1 .42-.25L17.51 4h8.71A1.78 1.78 0 0 1 28 5.78v4.42l2.54 1.47a.83.83 0 0 1 .31 1.15zM12 18h8v-6h-8zm7.62 5H7.75a.76.76 0 0 1-.75-.75V4H5.78A1.78 1.78 0 0 0 4 5.78V13l-2.89 5a.85.85 0 0 0 .31 1.15L4 20.59v4.61A1.78 1.78 0 0 0 5.78 27h8.62l5.18 3a.28.28 0 0 0 .42-.24v-6.39a.38.38 0 0 0-.38-.37z",fill:"#09b8ca"},geoBIM:{path:"M17.802 21.398l6.2 2.557-5.14 2.133a.772.772 0 0 1-1.06-.717zM9.311 7.868a.604.604 0 0 1-.003-1.122L16 4.169l8.12 3.148-8.119 3.184zm-3.5 1.541l8.387 3.413v12.554a.772.772 0 0 1-1.06.717l-6.297-2.736a1.639 1.639 0 0 1-1.03-1.521zM3.844 6.03a1.316 1.316 0 0 0-.827 1.22v17.395a1.316 1.316 0 0 0 .827 1.221L16 30.888l12.983-5.317v-2.423l-7.156-3.023 7.156-2.963v-1.95l-5.101-2.2-3.867 1.516L24 16.123l-6.199 2.505v-5.711l.073-.122 11.108-4.487v-1.95l-12.47-5.047a1.384 1.384 0 0 0-1.027 0z",
fill:"#11ad1d"},notebooks:{path:"M2.941 25A.906.906 0 0 1 2 24.135v-.271A.906.906 0 0 1 2.941 23h3.118a.906.906 0 0 1 .941.864v.271a.906.906 0 0 1-.941.865zm3.118-8A.906.906 0 0 0 7 16.135v-.271A.906.906 0 0 0 6.059 15H2.941a.906.906 0 0 0-.941.864v.271a.906.906 0 0 0 .941.865zm0-8A.906.906 0 0 0 7 8.135v-.271A.906.906 0 0 0 6.059 7H2.941A.906.906 0 0 0 2 7.864v.271A.906.906 0 0 0 2.941 9zm9.44 16h-3.726a.773.773 0 0 1-.773-.774V6.171A.172.172 0 0 1 11.172 6H15.5a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 0-.5-.5H5.342A1.345 1.345 0 0 0 4 4.343V5h2.059A2.904 2.904 0 0 1 9 7.858v.277A2.907 2.907 0 0 1 6.059 11H4v2h2.059A2.907 2.907 0 0 1 9 15.864v.271A2.907 2.907 0 0 1 6.059 19H4v2h2.059A2.907 2.907 0 0 1 9 23.864v.271A2.907 2.907 0 0 1 6.059 27H4v1.405a.595.595 0 0 0 .595.595H15.5a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5zM20 3.5v2a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 .5.5v18a.5.5 0 0 1-.5.5h-4a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-25a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.499.5z",
fill:"#6e6e6e"},online:{path:"M25.479 23.504a.231.231 0 0 1 .204 0l3.933 1.939a.12.12 0 0 1 0 .216l-8.273 4.078a.822.822 0 0 1-.727 0l-8.274-4.078a.12.12 0 0 1 0-.216l3.933-1.94a.231.231 0 0 1 .205 0l4.206 2.075a.663.663 0 0 0 .587 0zM12.342 18.6a.12.12 0 0 0 0 .215l8.344 4.112a.663.663 0 0 0 .586 0l8.344-4.112a.12.12 0 0 0 0-.215l-8.534-4.208a.231.231 0 0 0-.205 0zm-2.438-6.434C7.397 6.051 15.42 2.655 18.687 7.96a.185.185 0 0 0 .236.07c3.545-1.654 6.604.885 5.75 4.528a.278.278 0 0 0 .146.312l6.048 2.982a.093.093 0 0 0 .132-.1 7.18 7.18 0 0 0-2.683-4.454.185.185 0 0 1-.068-.13A7.287 7.287 0 0 0 20.1 4.43a.185.185 0 0 1-.143-.047C14.775-.32 6.919 2.959 6.302 10.003a.185.185 0 0 1-.102.15c-9.865 4.91-4.46 18.472 5.924 12.182-9.26 1.228-8.848-9.392-2.22-10.169z",
fill:"#5763f8"},sites:{path:"M2.656 29A.656.656 0 0 1 2 28.344V6.185A3.189 3.189 0 0 1 5.185 3H29.72a.281.281 0 0 1 .281.281v22.53A3.194 3.194 0 0 1 26.81 29zm2.838-3h21.211a.295.295 0 0 0 .296-.295V13.494a.493.493 0 0 0-.493-.494H5v12.506a.494.494 0 0 0 .494.494zM23 9.91a.09.09 0 0 0 .09.09h3.82a.09.09 0 0 0 .09-.09V6.026A.026.026 0 0 0 26.974 6h-3.948a.026.026 0 0 0-.026.026zM6.633 6A1.597 1.597 0 0 0 5 7.595V10h14.523A.477.477 0 0 0 20 9.523V6.477A.477.477 0 0 0 19.523 6zM16 22v-5h7v5zm-7-2v-3h3v3z",
fill:"#7842ed"},storyMaps:{path:"M25.5 0C23.015 0 21 .953 21 3.433v8.517a1.467 1.467 0 0 0 .43 1.038l3.837 3.827a.33.33 0 0 0 .466 0l3.836-3.827A1.467 1.467 0 0 0 30 11.95V3.433C30 .953 27.985 0 25.5 0zm0 8.1a2.6 2.6 0 1 1 2.6-2.599A2.599 2.599 0 0 1 25.5 8.1zm-7.856.453c.294-.153.312-.457.312-.788v-2.31a.104.104 0 0 0-.129-.1 6.128 6.128 0 0 0-2.248 1.19.14.14 0 0 1-.167.008c-3.437-2.283-8.543-1.52-12.131-.988-.432.064-1.762.34-2.164.424A.146.146 0 0 0 1 6.133V26.69a.147.147 0 0 0 .05.11.134.134 0 0 0 .116.035A36.394 36.394 0 0 1 9.5 25.781c3.283.054 4.403.96 4.967 1.513l.915.897a.164.164 0 0 0 .23 0l.916-.897a5.98 5.98 0 0 1 3.972-1.47 25.341 25.341 0 0 1 5.715.516c.718.109 1.46.22 2.186.312l1.251.16a.308.308 0 0 0 .348-.305v-7.375a.161.161 0 0 0-.303-.077l-.107.2a7.218 7.218 0 0 1-6.902 3.766 10.455 10.455 0 0 0-5.688.796V9.454a.89.89 0 0 1 .332-.693 2.058 2.058 0 0 1 .312-.208zM14 23.817c-3.071-1.38-5.998-.808-9.447-.293l-.253.036a.263.263 0 0 1-.3-.259V8.525a.098.098 0 0 1 .084-.097l.804-.115c2.518-.372 6.303-1.048 8.708.515a.89.89 0 0 1 .404.746z",
fill:"#4fbaa9"},webAppBuilder:{path:"M15.044 19.974a.188.188 0 0 1-.192-.001l-3.762-2.35a.188.188 0 0 1-.09-.16v-4.098a.188.188 0 0 1 .096-.163l3.761-2.178a.188.188 0 0 1 .182-.001l3.863 2.179a.188.188 0 0 1 .098.165v4.095a.187.187 0 0 1-.092.161zm15.13-1.04a.052.052 0 0 0 .099.022 8.048 8.048 0 0 0 .67-3.147 7.155 7.155 0 0 0-3.507-6.213L17.59 3.768a4.054 4.054 0 0 0-1.968-.627 3.95 3.95 0 0 0-1.894.485c-.607.334-1.132.67-1.278.754a2.951 2.951 0 0 0-1.39 2.506v1.078a.2.2 0 0 0 .307.167l1.365-.87a4.988 4.988 0 0 1 2.319-.792 4.62 4.62 0 0 1 2.219.792s8.442 5.017 9.392 5.576a7.045 7.045 0 0 1 3.513 6.084zM9.546 23.55l.947-.547a.2.2 0 0 0 0-.345l-1.369-.79a4.326 4.326 0 0 1-2.13-3.842V7.286a7.16 7.16 0 0 1 3.63-6.083l.081-.05a.025.025 0 0 0-.012-.045l-.25-.005a8.333 8.333 0 0 0-3.887.994A7.102 7.102 0 0 0 3.069 8.31v10.786a3.96 3.96 0 0 0 1.89 3.362c.894.545 1.605.974 1.81 1.092a2.787 2.787 0 0 0 2.777 0zm4.383 6.37l9.997-5.773a3.959 3.959 0 0 0 1.967-3.32c.021-.929.034-1.604.034-1.806a2.786 2.786 0 0 0-1.39-2.406l-1.123-.57a.2.2 0 0 0-.289.177v1.604a4.45 4.45 0 0 1-2.218 3.842l-3.708 2.14a3.366 3.366 0 0 1-.256.135L11.6 27.128a6.427 6.427 0 0 1-3.343.938 7.137 7.137 0 0 1-3.513-1.038c-.09-.052-.38-.226-.797-.479a.094.094 0 0 0-.134.12 7.182 7.182 0 0 0 2.942 3.25 7.241 7.241 0 0 0 3.587 1.028 7.243 7.243 0 0 0 3.587-1.028z",
fill:"#09b8ca"},urban:{path:"M32 14l-4 .003a1 1 0 0 0-1 1V21a1 1 0 0 1-1 1h-2V5.451l-7.598-3.335A1 1 0 0 0 15 3.03V25a1 1 0 0 1-1 1h-2V11.24h-.02L7.5 9l-4.48 2.24H3V20H0v4h5a1 1 0 0 0 1-1V12.717L7.5 12l1.5.717V28a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2V6.094l3 1.317V24a2 2 0 0 0 2 2h5.02A1.977 1.977 0 0 0 30 24.024V17h2z",fill:"#3DB8FF"},instant:{path:"M11.206 4.805v-1.38a2.231 2.231 0 0 1 2.23-2.231h13.168a2.231 2.231 0 0 1 2.231 2.23v11.15a2.231 2.231 0 0 1-2.23 2.231h-1.398V5.555a.75.75 0 0 0-.75-.75zM30.94 27.204l-5.447-4.41a.211.211 0 0 0-.344.164v2.225H8.197a1.344 1.344 0 0 1-1.344-1.344V11.665a.75.75 0 0 1 .75-.75h9.872a.75.75 0 0 1 .75.75l-.003 7.534a2.422 2.422 0 0 1-.798 1.796l-.945.855h4.3a1.075 1.075 0 0 0 1.074-1.075v-10.54a2.231 2.231 0 0 0-2.23-2.23H5.354a2.148 2.148 0 0 0-2.13 2.23v16.507a2.231 2.231 0 0 0 2.23 2.231l19.695-.003v2.725a.211.211 0 0 0 .344.164l5.447-4.41a.158.158 0 0 0 0-.245z",
fill:"#83a238"}},a=[];Object.keys(p).forEach(function(g){a[g]='\x3csvg viewBox\x3d"0 0 32 32" width\x3d"32" height\x3d"32" fill\x3d"'.concat(p[g].fill,'"\x3e\x3cpath d\x3d"').concat(p[g].path,'"/\x3e\x3c/svg\x3e')});return a})},"arcgisonline/pages/components/Ratings":function(){define("require exports tslib preact dojo/i18n!../../nls/arcgisonline preact/hooks ../../sharing/util".split(" "),function(e,K,p,a,g,m,n){Object.defineProperty(K,"__esModule",{value:!0});K.Ratings=void 0;g=p.__importDefault(g);
n=p.__importDefault(n);K.Ratings=function(b){var c=b.user,d=b.item,l=b.telemetry,h=(0,m.useState)(d.avgRating);b=h[0];var f=h[1],r=(0,m.useState)(d.numRatings);h=r[0];var q=r[1];r=(0,m.useState)(0);var t=r[0],w=r[1];return(0,a.h)("div",{class:"inline-block padding-trailer-quarter ".concat(d.isOwner?"tooltip":""),"aria-label":d.isOwner?g.default.ratings.cantRate:!1},(0,a.h)("calcite-rating",{scale:"s",value:t,average:b,count:h,readOnly:!c||d.isOwner,oncalciteRatingChange:function(u){null===l||void 0===
l?void 0:l.logEvent({eventType:"other",pageName:"item",pageUrl:window.location.href,path:window.location.pathname,attribute:d.type,category:"item action",action:"rate"});u=u.target.value;w(u);d.addRating(u).then(function(){n.default.request({url:d.itemUrl}).then(function(v){f(v.avgRating);q(v.numRatings)})})}}))}})},"arcgisonline/sharing/dijit/RasterFunctionEditor":function(){define("dojo/dom-class dojo/string dojo/on dojo/topic dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dijit/_TemplatedMixin dijit/Dialog esri/domUtils ../../pages/dijit/Overlay dojo/text!./templates/RasterFunctionEditor.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q){return g("arcgisonline.sharing.dijit.RasterFunctionEditor",[b,d,f],{baseClass:"esriRFxEditorContainer",user:null,constructor:function(t,w){this.user=t&&t.user;this.parent=t&&t.parent;this.item=t&&t.item;this.entryPoint=t&&t.entryPoint;this.domNode=w;this.overlayContents=K.substitute(r,{i18n:q});this.destroyOnClose=this.showActionBar=!1},postCreate:function(){this.inherited(arguments);this._iframe=this.domNode.querySelector("iframe");this._passiveOverlay=this.domNode.querySelector(".passive-overlay");
this._closeBtn=this.domNode.querySelector(".close-btn");e.add(this.domNode,"overlay--top")},startup:function(){this.inherited(arguments);var t=this.user,w=this.item?this.item.id:null,u=esriGeowConfig.rasterFunctionEditor+"?locale\x3d"+dojo.locale+"\x26entryPoint\x3d"+this.entryPoint+"\x26isViewerMode\x3d"+(t?!t.canCreateItems:!0)+"\x26portalUrl\x3d"+esriGeowConfig.restBaseUrl;t&&(u=u+"\x26username\x3d"+t.username+"\x26userId\x3d"+t.accountId+"\x26token\x3d"+t.token);w&&(u=u+"\x26itemId\x3d"+w);this._iframe.src=
u;this._showLoadingDialog();this._attachListeners()},destroy:function(){this._detachAnalysisToolListeners()},activate:function(){e.remove(this.domNode,"passive");this._iframe.contentWindow.postMessage(JSON.stringify({action:"activate"}),"*")},deactivate:function(){e.add(this.domNode,"passive");this._iframe.contentWindow.postMessage(JSON.stringify({action:"deactivate"}),"*")},onLoad:function(){this._closeLoadingDialog();this.showOnStart&&this.open()},run:function(t){"analysisStack"!==arcgisonline.map.leftPanel.getLeftContentPanelStack()&&
(arcgisonline.map.dijit.toc.analysis.configureAnalysis(),a.publish("Analysis/ShowAnalysis"));this.applyRFxTool?this.applyRFxTool.set("rasterFunction",t):t&&this.parent&&(this.parent.analysisTool.openApplyRFxTool(t,!0),this.applyRFxTool=leftPanel.toolPanel.get("currentTool"),this._detachAnalysisToolListeners(),this._attachAnalysisToolListeners());this.deactivate()},open:function(){this._iframe.contentWindow.postMessage(JSON.stringify({action:"reset",itemId:this.item?this.item.id:null}),"*");this.inherited(arguments);
this._sendMapInfo();this.activate()},close:function(t){this.inherited(arguments);this.item=void 0;this._iframe.contentWindow.postMessage(JSON.stringify({action:"close"}),"*");this._detachAnalysisToolListeners();t&&this.applyRFxTool&&this.applyRFxTool._onClose(!0);setTimeout(m.hitch(this,this._attachAnalysisToolListeners),0)},_sendMapInfo:function(){var t=[],w=[];arcgisonline.map.main&&arcgisonline.map.main.mapLayers&&0<arcgisonline.map.main.mapLayers.length&&n.forEach(arcgisonline.map.main.mapLayers,
function(v){var x=v.layer,z=x&&x.url;x&&(z&&-1<z.toLowerCase().indexOf("/imageserver")?t.push({id:x.id,name:x.name||v.title,url:z,renderingRule:x.renderingRule&&x.renderingRule.toJson(),mosaicRule:x.mosaicRule&&x.mosaicRule.toJson()}):"esri.layers.FeatureLayer"===x.declaredClass&&w.push({id:x.id,name:x.name,url:z}))});var u=arcgisonline.map.main&&arcgisonline.map.main.map&&arcgisonline.map.main.map.extent;this._iframe.contentWindow.postMessage(JSON.stringify({action:"info",layers:{imageService:t,
feature:w},extent:u&&u.toJson()}),"*")},_closeLoadingDialog:function(){this._loadingDialog&&this._loadingDialog.hide()},_showLoadingDialog:function(){this._loadingDialog||(this._loadingDialog=new l({title:q.common.loading,content:"\x3cdiv\x3e\x3cdiv\x3e"+q.common.loadingRFxEditor+"\x3c/div\x3e\x3cdiv class\x3d'throb-loading'\x3e\x3c/div\x3e\x3c/div\x3e"}));this._loadingDialog.show()},_detachAnalysisToolListeners:function(){this.applyRFxTool&&this._analysisHandles&&n.forEach(this._analysisHandles,
function(t){t&&t.remove&&t.remove()},this)},_attachAnalysisToolListeners:function(){this.applyRFxTool&&(this._analysisHandles=[],this._analysisHandles.push(this.applyRFxTool.on("close",m.hitch(this,this.close,!1))),this._analysisHandles.push(this.applyRFxTool.on("start",m.hitch(this,this.close,!1))))},_setParentAttr:function(t){t!==this.parent&&(this.parent=t,this.applyRFxTool=null)},_setItemAttr:function(t){this.item=t},_attachListeners:function(){window.addEventListener("message",m.hitch(this,function(t){if(t.source&&
t.source===this._iframe.contentWindow){t=t.data;try{t=JSON.parse(t);"close"===t.action&&this.close(!0);if("loaded"===t.action)this.onLoad();"run"===t.action&&this.run(t.rft)}catch(w){}}}),!1);this.own(p(this._passiveOverlay,"click",m.hitch(this,this.activate)),p(this._closeBtn,"click",m.hitch(this,this.close)),a.subscribe("onLayerUpdate",this._sendMapInfo.bind(this)),a.subscribe("_onRendererUpdate",this._sendMapInfo.bind(this)),a.subscribe("onMosaicRuleApply",this._sendMapInfo.bind(this)),a.subscribe("onMosaicRuleReset",
this._sendMapInfo.bind(this)))}})})},"arcgisonline/pages/components/Favorite":function(){define("require exports tslib ../pageUtil ../../sharing/geow/Content dojo/topic preact dojo/i18n!../../nls/arcgisonline".split(" "),function(e,K,p,a,g,m,n,b){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);b=p.__importDefault(b);e=function(c){function d(){var l=null!==c&&c.apply(this,arguments)||this;l.buttonRef=(0,n.createRef)();l.handleClick=
function(h){h.stopPropagation();var f=l.state.isFavorite,r=l.props.item;l.checkReadonly(r.portal)||(l.setState(function(q){return{isFavorite:!q.isFavorite}}),r.set("isFavorite",f),(f?g.default.removeFromFavorites(r):g.default.addToFavorites(r)).then(function(){},function(q){m.default.publish("alert/show",{type:"error",text:null===q||void 0===q?void 0:q.message});l.setState(function(t){return{isFavorite:!t.isFavorite}});r.set("isFavorite",f)}))};return l}p.__extends(d,c);d.prototype.componentDidMount=
function(){this.setState({isFavorite:this.props.item.isFavorite})};d.prototype.checkReadonly=function(l){return(null===l||void 0===l?0:l.isPortal)&&l.isReadOnly?(a.default.createConfirmationDialog({strings:{title:b.default.common.errorTitle,description:b.default.common.errors.portalInReadOnlyModeMsg},hideCancel:!0,autoCloseOnOk:!0}),!0):!1};d.prototype.render=function(){var l,h=this.state.isFavorite,f=this.props.showText,r=h?b.default.common.unfavorite:b.default.common.favorite,q=f?"thumbnail-favorite":
"card-action";return(0,n.h)("span",null,(0,n.h)("button",{onClick:this.handleClick,ref:this.buttonRef,role:"checkbox","aria-label":b.default.common.favorite,"aria-checked":h?"true":"false",class:"font-size--3 ".concat(h?"btn-link-yellow":""," ").concat(q)},(0,n.h)("calcite-icon",{icon:h?"star-f":"star",scale:"s"}),f&&(0,n.h)("span",{class:"btn-link-off-black margin-left-half"},r)),!f&&(0,n.h)("calcite-tooltip",{referenceElement:null===(l=this.buttonRef)||void 0===l?void 0:l.current,"close-on-click":!0,
label:b.default.common.favorite,placement:"bottom",overlayPositioning:"fixed"},(0,n.h)("p",{class:"avenir-regular font-size--3 trailer-0 leader-0"},r)))};return d}(n.Component);K.default=e})},"arcgisonline/pages/components/LayerCard":function(){define("require exports tslib dojo/i18n!../../nls/arcgisonline preact preact/hooks arcgisonline/esriGeowConfig dojo/string dojo/text!../dijit/Card/badges/deprecated.html preact/compat ../../sharing/util ../item/components/EmbedServiceDataModal ../item/_servicesDirectoryViewModal".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f){var r=this;Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);l=p.__importDefault(l);var q=function(x,z,A){void 0===A&&(A=!0);return p.__awaiter(r,void 0,void 0,function(){var B,J,P,R;return p.__generator(this,function(S){switch(S.label){case 0:return[4,fetch("".concat(x,"?f\x3djson").concat(A?"\x26token\x3d".concat(z):""))];case 1:return B=S.sent(),[4,B.json()];case 2:J=S.sent();
if(P=J.error){if((null===(R=P.message)||void 0===R?0:R.toLowerCase().includes("invalid token"))&&A)return[2,q(x,z,!1)];throw Error(P.message);}return[2,J]}})})},t={ArcGISFeatureLayer:{name:"Feature layer",icon:"feature-layer"},Table:{name:"Table",icon:"table"},ArcGISTiledMapServiceLayer:{name:"Tile layer",icon:"layer-basemap"},ArcGISTiledImageServiceLayer:{name:"Tiled imagery layer",icon:"image-layer"},ArcGISStreamLayer:{name:"Feature layer",icon:"feature-layer"},VectorTileLayer:{name:"Vector tile layer",
icon:"tile-layer"},CSV:{icon:"feature-layer"},GroupLayer:{name:"Group layer"},Basemap:{name:"Basemap"},WebTiledLayer:{name:"Tile Layer",icon:"tile-layer"},ArcGISImageServiceLayer:{name:"Imagery layer",icon:"image-layer"},ArcGISMapServiceLayer:{name:"Map image layer",icon:"layer-map"},MapImageLayer:{name:"Map image layer",icon:"layer-map"},OGCFeatureLayer:{name:"OGC feature layer",icon:"feature-layer"},OrientedImageryLayer:{name:"Oriented imagery layer",icon:"oriented-imagery-layer"},SubtypeGroupLayer:{name:"Feature layer",
icon:"layers"},SketchLayer:{name:"Sketch layer",icon:"feature-layer"},RouteLayer:{name:"Route layer",icon:"road-sign"},GeoRSS:{icon:"feature-layer"},WFS:{icon:"feature-layer"},KML:{icon:"feature-layer"},WMS:{icon:"layer-map"},WMTS:{name:"WMTS",icon:"tile-layer"},Layer:{name:"Layer",icon:"layer"},MediaLayer:{name:"Media layer"},unknown:{icon:"layer"}},w="GeoRSS WFS KML WMS WMTS unknown".split(" "),u="https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Dark_Gray_Base/MapServer https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Dark_Gray_Reference/MapServer https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Light_Gray_Base/MapServer https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Light_Gray_Reference/MapServer https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Boundaries_and_Places/MapServer https://services.arcgisonline.com/arcgis/rest/services/NatGeo_World_Map/MapServer https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer https://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Transportation/MapServer".split(" "),
v=function(x){function z(){var V,Z,ba=null===(V=I.templateUrl)||void 0===V?void 0:V.replace("http://","https://").toLowerCase(),ma=null===(Z=I.url)||void 0===Z?void 0:Z.replace("http://","https://").toLowerCase();return u.some(function(sa){return[ba,ma].includes(sa.toLowerCase())})}function A(){var V;return p.__awaiter(this,void 0,void 0,function(){var Z,ba,ma,sa;return p.__generator(this,function(Ea){switch(Ea.label){case 0:return Ea.trys.push([0,4,5,6]),Z=Object.keys(t).filter(function(ya){return!w.includes(ya)}),
!pa||I.isBaseMapLayer||I.featureCollection||!Z.includes(L)?[3,3]:(ma=ba=I.url)?[4,q(ba,C)]:[3,2];case 1:ma=Ea.sent(),Ea.label=2;case 2:ma,Ea.label=3;case 3:return[3,6];case 4:return sa=Ea.sent(),(null===(V=sa.message)||void 0===V?0:V.toLowerCase().includes("not valid json"))||M("layerUnavailable"),[3,6];case 5:return G(!1),[7];case 6:return[2]}})})}function B(V){var Z,ba=function(){var Ea,ya,wa,aa;return(0,g.h)("div",{class:"flex flex-center padding-leader-quarter padding-trailer-quarter no-pointer"},
(0,g.h)("div",{class:"flex-0 margin-right-1 margin-left-half"},y?(0,g.h)("calcite-loader",{inline:!0,label:a.default.common.loading,type:"indeterminate",scale:"s"}):(0,g.h)("calcite-icon",{icon:null!==(ya=null===(Ea=t[L])||void 0===Ea?void 0:Ea.icon)&&void 0!==ya?ya:"layer",scale:"s"})),(0,g.h)("div",{class:"flex-1"},(0,g.h)("h5",{class:"font-size--1 avenir-medium trailer-0 ".concat((null!==(wa=V.itemUrl)&&void 0!==wa?wa:V.url)?"text-blue":"text-off-black")},null!==(aa=V.name)&&void 0!==aa?aa:V.title),
(0,g.h)("p",{class:"font-size--3 trailer-0 text-darker-gray pointer-none"},N)),(0,g.h)("div",{class:"flex-0 layer-card__badges"},V.contentStatus&&(0,g.h)("div",{dangerouslySetInnerHTML:{__html:I.badges}})))};U&&(0,g.h)("div",{class:"flex flex-align-center layer-card__warning"},(0,g.h)("calcite-icon",{class:"margin-right-1 layer-card--text-red",icon:"exclamation-mark-triangle",scale:"s"}),a.default.sublayer.error[U],"rasterDeprecated"===U&&(0,g.h)("a",{href:"https://www.esri.com/arcgis-blog/products/arcgis-online/announcements/reminder-raster-basemaps-services-moving-to-mature-support/",
target:"_blank",rel:"noopener noreferrer",class:"margin-left-half"},a.default.sublayer.error.seeDetails));var ma="side-nav-link layer-card ".concat(D?"layer-card__nested":""),sa=(0,f.shouldOpenLayerInViewModal)(T,V,T.portal.portalUser);return Aa?(0,g.h)("button",{class:"".concat(ma," dropdown-link"),onClick:function(){return fa(!0)}},ba()):sa?(sa="".concat(V.url).concat("public"!==T.access&&T.portal.portalUser?"?token\x3d".concat(null===(Z=T.portal.portalUser)||void 0===Z?void 0:Z.credential.token):
""),(0,g.h)("a",{onClick:function(Ea){(0,f.handleViewModalClick)(T,T.portal.portalUser,Ea.target)},"data-url":sa,class:ma},ba())):(0,g.h)("a",{href:va,target:"_blank",class:ma},ba())}var J,P,R,S,T=x.item,E=x.hostItemId,I=x.layer,F=x.nested,D=void 0===F?!1:F,C=x.token;x=(0,m.useState)(!0);var y=x[0],G=x[1];x=(0,m.useState)();var L=x[0],O=x[1];x=(0,m.useState)();var U=x[0],M=x[1];x=(0,m.useState)(!0);var Q=x[0],Y=x[1];F=(0,m.useState)(!1);x=F[0];var fa=F[1];F=(0,m.useRef)(document.body);var va=(0,m.useMemo)(function(){var V,
Z=null!==(V=I.itemUrl)&&void 0!==V?V:I.url;if(null===Z||void 0===Z?0:Z.startsWith("./"))Z="".concat(n.default.restBaseUrl,"content/items/").concat(E).concat(Z.slice(1));return Z},[I,I.itemUrl,C]),Aa="MediaLayer"===I.layerType&&!I.itemId,pa=Object.keys(I).includes("contentStatus"),N=null!==(R=null!==(P=null===(J=t[L])||void 0===J?void 0:J.name)&&void 0!==P?P:I.layerType)&&void 0!==R?R:I.type;(0,m.useEffect)(function(){var V,Z,ba,ma;if(I.itemId&&!I.itemUrl)I.itemUrl="item.html?id\x3d".concat(I.itemId);
else if(!I.itemId&&"VectorTileLayer"===I.layerType){var sa=l.default.parseUrl(I.styleUrl),Ea=null===(V=null===sa||void 0===sa?void 0:sa.segments)||void 0===V?void 0:V[(null===(Z=null===sa||void 0===sa?void 0:sa.segments)||void 0===Z?void 0:Z.indexOf("items"))+1];Ea&&(I.itemUrl="item.html?id\x3d".concat(Ea))}V=null!==(ma=null!==(ba=I.layerType)&&void 0!==ba?ba:I.type)&&void 0!==ma?ma:"Layer";I.featureCollectionType?"notes"!==I.featureCollectionType.toLowerCase()||I.id.includes("mapNotes")?"route"===
I.featureCollectionType.toLowerCase()&&(V="RouteLayer"):V="SketchLayer":I.wmtsInfo&&(V="WMTS");O(null!==V&&void 0!==V?V:"unknown")},[I]);(0,m.useEffect)(function(){z()&&(I.contentStatus="deprecated",I.badges=b.default.substitute(c.default,{i18n:a.default,hideText:"",tooltipClass:"tooltip tooltip-bottom-left tooltip-multiline",tooltipLabel:a.default.badges.deprecatedTooltip}),M("rasterDeprecated"));A()},[L]);return(0,g.h)(g.Fragment,null,"GroupLayer"===I.layerType||"Basemap"===I.layerType?(0,g.h)("calcite-accordion",
{class:"layer-card__accordion","icon-position":"start",appearance:"transparent"},(0,g.h)("calcite-accordion-item",{class:"".concat(D&&"layer-card__accordion--nested"),heading:null!==(S=I.name)&&void 0!==S?S:I.title,description:N,key:I.id,expanded:Q,oncalciteInternalAccordionItemSelect:function(V){V.stopPropagation();Y(!Q)}},I.layers.map(function(V){V.isBaseMapLayer=I.isBaseMapLayer;return(0,g.h)(v,{key:V.id,item:T,hostItemId:E,layer:V,nested:!0,token:C})}))):B(I),Aa&&(0,d.createPortal)((0,g.h)(h.EmbedServiceDataModal,
{url:"".concat(va,"?").concat(C?"token\x3d".concat(C):""),isActive:x,onClose:function(){return fa(!1)},strings:{title:"".concat(I.name," - ").concat(N),close:a.default.itemProperties.closeLabel,loading:a.default.common.loading},isImageResource:!0}),F.current))};K.default=v})},"arcgisonline/pages/components/DependencyAccessCheck":function(){define("require exports tslib arcgis-app-components-utils/index arcgisonline/esriGeowConfig preact preact/compat preact/hooks".split(" "),function(e,K,p,a,g,m,
n,b){Object.defineProperty(K,"__esModule",{value:!0});K.DependencyAccessCheck=void 0;a=p.__importDefault(a);g=p.__importDefault(g);K.DependencyAccessCheck=(0,n.forwardRef)(function(c,d){var l=c.item,h=c.portal,f=c.user,r=c.i18n,q=c.componentRef,t=(0,b.useState)(!1);c=t[0];var w=t[1];t=(0,b.useRef)(document.body);var u=(0,b.useState)(null),v=u[0],x=u[1];u=(0,b.useMemo)(function(){return v?Object.keys(v).some(function(J){return 0<v[J].length}):!1},[v]);var z=(0,b.useCallback)(function(){a.default.analyzeSharingDetail(l,
h).then(function(J){x(J.result)})},[l,h]),A=(0,b.useMemo)(function(){return{analyzeSharingDetail:z}},[z]);(0,b.useImperativeHandle)(d,function(){return A},[A]);(0,b.useEffect)(function(){q.current=A},[q,A]);(0,b.useEffect)(function(){a.default.initConfig({portal:h,user:f,api:3});z()},[l]);var B=function(){w(!1)};return u?(0,m.h)("div",{"data-component-type":"dependency-access-check",class:"leader-half"},(0,m.h)("calcite-notice",{icon:"",open:!0,closable:!1,kind:"warning"},(0,m.h)("div",{slot:"message"},
r.itemProperties.warning["Group Layer"===l.type?"mismatchSharingGroupLayer":"mismatchSharing"]),(0,m.h)("calcite-link",{slot:"link",onClick:function(){return w(!0)}},r.itemProperties.reviewLayerSharing)),v&&(0,n.createPortal)((0,m.h)("arcgis-dependency-check",{items:[{item:l}],portal:h,user:f,config:g.default,isActive:c,api:3,onworkflowCancel:B,onworkflowComplete:function(){B();z()},preProcessedSharingDetail:v}),t.current)):null})})},"arcgisonline/pages/item/components/HelpLinks":function(){define(["require",
"exports","preact"],function(e,K,p){Object.defineProperty(K,"__esModule",{value:!0});var a=function(g,m){return function(n){var b=n.text,c=n.href;n=n.helpId;c=null!==c&&void 0!==c?c:"".concat(g).concat(m[n]);return(0,p.h)("li",null,(0,p.h)("a",{href:c,target:"_blank",rel:"noopener noreferrer"},b))}};K.default=function(g){var m,n=g.item,b=g.strings;g=g.portal;var c=null===(m=null===g||void 0===g?void 0:g.helpMap)||void 0===m?void 0:m.m,d=null===g||void 0===g?void 0:g.helpBase;m=a(d,c);var l=n.typeKeywords||
[];l="Map Service"===n.type&&!l.includes("Spatiotemporal")&&(l.includes("Hosted Service")||l.includes("Tiled"))&&!l.includes("Relational");if(!((["Feature Service","Scene Service","Vector Tile Service","Web Map","Web Scene"].includes(n.type)||l)&&b&&c&&d&&n))return null;g=!g.isPortal||(null===d||void 0===d?void 0:d.includes("enterprise.arcgis.com"));return(0,p.h)("div",{class:"leader-1 padding-leader-half"},(0,p.h)("h5",{class:"trailer-half"},b.help),(0,p.h)("ul",{class:"list-plain"},"Feature Service"===
n.type&&(0,p.h)(p.Fragment,null,(0,p.h)(m,{text:b.helpLinks.featureLayers,helpId:120004158}),g&&(0,p.h)(m,{text:b.helpLinks.featureLayersDeveloper,href:"https://developers.arcgis.com/documentation/mapping-apis-and-services/data-hosting/hosted-feature-layers/"})),"Scene Service"===n.type&&(0,p.h)(m,{text:b.helpLinks.sceneLayers,helpId:120003720}),"Vector Tile Service"===n.type&&(0,p.h)(p.Fragment,null,(0,p.h)(m,{text:b.helpLinks.vectorTilelayers,helpId:120004159}),g&&(0,p.h)(m,{text:b.helpLinks.vectorTileLayersDeveloper,
href:"https://developers.arcgis.com/documentation/mapping-apis-and-services/data-hosting/hosted-vector-tile-layers/"})),l&&(0,p.h)(p.Fragment,null,(0,p.h)(m,{text:b.helpLinks.tileLayers,helpId:120004160}),g&&(0,p.h)(m,{text:b.helpLinks.tileLayersDeveloper,href:"https://developers.arcgis.com/documentation/mapping-apis-and-services/data-hosting/hosted-image-tile-layers/"})),"Web Map"===n.type&&(0,p.h)(p.Fragment,null,(0,p.h)(m,{text:b.helpLinks.webMaps,helpId:120004161}),g&&(0,p.h)(m,{text:b.helpLinks.webMapsDeveloper,
href:"https://developers.arcgis.com/documentation/mapping-apis-and-services/content-management/items/#web-maps"})),"Web Scene"===n.type&&(0,p.h)(p.Fragment,null,(0,p.h)(m,{text:b.helpLinks.webScenes,helpId:120004162}),g&&(0,p.h)(m,{text:b.helpLinks.webScenesDeveloper,href:"https://developers.arcgis.com/documentation/mapping-apis-and-services/content-management/items/#web-scenes"}))))}})},"arcgisonline/pages/item/widgets/_visualize":function(){define("require exports tslib ../../../esriGeowConfig ../../pageUtil ../../utils/dom ../../utils/mapViewer ../../utils/layer ../../utils/queryHandler ../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/string dojo/on dojo/has dojo/Deferred esri/Evented esri/lang dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/_visualize.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importStar(n);c=p.__importStar(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);return function(){function z(){this.templateString=x.default;this.i18n=v.default;this.widgetsInTemplate=
!0;this.sublayer=null}z.prototype.startup=function(){var A=this,B,J=new t.default;this.inherited(arguments);this.isStreamLayer="Stream Service"===this.item.type;this.targetOrigin="".concat(window.location.protocol,"//").concat(window.location.hostname);this.viewerBaseUrl="".concat(this.targetOrigin,"/home");this.isMobile=480>window.innerWidth;this.computeMapViewer().then(function(R){A.mapViewerSetting=R;A.setViewerUrl()});document.documentElement.classList.add("no-footer");if(null===(B=this.item)||
void 0===B?0:B.isLoaded)this.initUI().then(J.resolve);else var P=this.item.watch("isLoaded",function(){P.unwatch();A.initUI().then(J.resolve)});return J};z.prototype.setViewerUrl=function(){var A=a.default.isDebug?"/webviewer/dist/mobilemap.html":"../apps/mapviewer/mobilemap.html",B=this.isStreamLayer?"":"\x26layerId\x3d";this.isMobile?this.iframeSrc="".concat(A,"?embedded\x3d1\x26isViz\x3dtrue\x26layers\x3d").concat(this.item.id):this.useMapViewer?(B=this.page.sublayer?"\x26layerId\x3d".concat(this.page.sublayer.id):
"",this.iframeSrc="../apps/mapviewer/visualization.html?layers\x3d".concat(this.item.id).concat(B)):this.iframeSrc="./webmap/viewer.html?embedded\x3d1\x26isViz\x3dtrue\x26type\x3ditemDetail\x26layers\x3d".concat(this.item.id).concat(B)};z.prototype.canDestroy=function(){var A=new t.default;this.promptUnsavedChanges().then(function(){return A.resolve(!0)});return A};z.prototype.destroy=function(){this.viewer.src="about:blank";this.inherited(arguments);clearInterval(this.mapLoadTimer);clearInterval(this.unsavedChangesTimer);
document.documentElement.classList.remove("no-footer")};z.prototype.computeMapViewer=function(){var A,B=new t.default;this.item.portal.portalUser?null===(A=this.item.portal.portalUser)||void 0===A?void 0:A.getProperties().then(function(J){B.resolve(n.default.determineMapViewerSetting(J))},function(){B.resolve(n.default.determineMapViewerSetting())}):B.resolve(n.default.determineMapViewerSetting());return B};z.prototype.initUI=function(){var A=new t.default;this.showLayers();this.initHandlers();this.page.sublayer&&
(this.layerSelect.value="".concat(this.page.sublayer.id),this.set("selectedLayer",this.page.sublayer.id));this.set("visibleLayer",this.get("selectedLayer"));(0,b.isSubtypeGroupLayer)(this.sublayer,this.item)&&m.default.hideNode(this.saveBtn);(0,b.containsBothSublayerGroupTypeAndNon)(this.item)&&(this.useMapViewer=!0,this.setViewerUrl());this.useMapViewer&&m.default.hideNode(document.querySelector(".js-viz-controls"));A.resolve(!1);return A};z.prototype.showLayers=function(){var A;if(this.isMobile)document.querySelector(".js-viz-controls").remove();
else{this.page.sublayer&&(this.layerSelect.classList.add("hide"),this.layerSelectLabel.classList.add("hide"));var B=(null===(A=this.item)||void 0===A?void 0:A.featureLayers)||[],J=this.layerSelect;B.forEach(function(P,R){var S,T=document.createElement("option");T.value="".concat(null!==(S=P.id)&&void 0!==S?S:R);T.innerHTML=P.name;J.appendChild(T)});J.selectedIndex=0;m.default.showHide(this.domNode.querySelector(".js-featureLayers"),1<(null===B||void 0===B?void 0:B.length))}};z.prototype.saveChanges=
function(A){var B=this.item.id;A=u.default.isDefined(A)?A:this.get("selectedLayer");m.default.forEachNode(this.domNode.querySelectorAll(".js-subnav-link"),function(J){return J.classList.remove("btn-disabled")});this.mapSavedDfd=new t.default;this.postMapMessage({type:"saveLayer",itemId:B,layerId:A});return this.mapSavedDfd};z.prototype.saveAsNewLayer=function(){var A=this.item.id,B=this.get("selectedLayer");this.layerSavedDfd=new t.default;this.postMapMessage({type:"saveAsNewLayerItem",itemId:A,layerId:B});
return this.layerSavedDfd};z.prototype.promptUnsavedChanges=function(A){var B=this,J,P=new t.default,R=this.item.canUpdate,S=null!==(J=this.layerSelect.options)&&void 0!==J?J:[];A=u.default.isDefined(A)?A:this.layerSelect.selectedIndex;var T=(S=S[A])?Number(S.value):-1;S=f.default.substitute(this.i18n.itemProperties.layerUnsavedChanges,{layerName:S?S.innerHTML:this.item.title});R&&this.hasUnsavedChanges?g.default.createConfirmationDialog({strings:{title:this.i18n.openPresentationDlg.title,description:S,
ok:this.i18n.common.yesLabel,cancel:this.i18n.common.noLabel},hideClose:!0,onOk:function(E){B.saveChanges(T).then(function(){P.resolve(!0);E()})},onCancel:function(){P.resolve(!0)}}):P.resolve(!0);return P};z.prototype._setVisibleLayerAttr=function(A){var B,J,P=(0,q.default)("mozilla")?"hideLoader":"showLoader";this.page[P]();P="";var R=((null===(B=this.item)||void 0===B?void 0:B.featureLayers)||[]).find(function(S){return S.id===A});this.item.isAdmin&&-1===(null===(J=null===R||void 0===R?void 0:
R.capabilities)||void 0===J?void 0:J.toLowerCase().indexOf("query"))&&(P="\x26isAdmin\x3dtrue");this.useMapViewer=-1<this.item.typeKeywords.indexOf("ArcGIS API for JavaScript")||this.mapViewerSetting===n.MapViewerType.Modern;m.default.showHideAll([this.saveBtn,this.saveAsBtn],!this.useMapViewer);this.setViewerUrl();this.viewer.src=this.useMapViewer?this.iframeSrc+P:this.iframeSrc+(this.isStreamLayer||this.isMobile?"":A||"0")+P;this.blockSaveForSGL()};z.prototype._getSelectedLayerAttr=function(){return parseInt(this.layerSelect.value,
10)};z.prototype.initHandlers=function(){var A=this;this.own((0,r.default)(window,"message",function(B){B.origin!==A.targetOrigin||A.isMobile||A.processMapMessage(B.data)}));(0,r.default)(this.viewer,"load",function(){A.page.hideLoader();clearInterval(A.mapLoadTimer);A.mapLoadTimer=window.setInterval(function(){A.postMapMessage({type:"isLoaded"});A.page.sublayer&&A.postMapMessage({type:"setSingleLayerMode"});A.own((0,r.default)(A.viewer.contentWindow||A.viewer,"click",function(){m.default.forEachNode(document.querySelectorAll(".js-logged-in-navigation"),
function(B){return B.classList.remove("is-active")})}))},500)});(0,r.default)(this.layerSelect,"focus",function(B){A.previousSelectedIdx=A.layerSelect.selectedIndex});(0,r.default)(this.layerSelect,"change",function(B){A.promptUnsavedChanges(A.previousSelectedIdx).then(function(){A.set("visibleLayer",A.layerSelect.value)})});(0,r.default)(this.saveBtn,"click",function(B){null===B||void 0===B?void 0:B.preventDefault();A.saveChanges()});(0,r.default)(this.saveAsBtn,"click",function(B){null===B||void 0===
B?void 0:B.preventDefault();A.saveAsBtn.classList.add("btn-disabled");A.saveAsNewLayer().then(function(J){window.location.href="item.html?id\x3d".concat(J.newItemId)},function(){A.saveAsBtn.classList.remove("btn-disabled")})})};z.prototype.blockSaveForSGL=function(){var A=this,B=this.page._item,J=B.layers.find(function(P){return"".concat(P.id)===A.layerSelect.value});B=(0,b.isSubtypeGroupLayer)(J,B);m.default.showHide(this.saveBtn,!B)};z.prototype.checkForChanges=function(){this.postMapMessage({type:"hasLayerUnsavedChanges",
itemId:this.item.id,layerId:this.get("selectedLayer")})};z.prototype.postMapMessage=function(A){(this.viewer.contentWindow||this.viewer).postMessage(JSON.stringify(A),this.targetOrigin)};z.prototype.processMapMessage=function(A){var B=this;A=JSON.parse(A);var J=null===A||void 0===A?void 0:A.type,P=this.item.canUpdate;if("loaded"===J&&A.value)clearInterval(this.mapLoadTimer),this.page.hideLoader(),P&&(clearInterval(this.unsavedChangesTimer),this.unsavedChangesTimer=window.setInterval(function(){return B.checkForChanges()},
500));else if("layerUnsavedChanges"===J)this.saveBtn.classList[A.value?"remove":"add"]("btn-disabled"),this.hasUnsavedChanges=A.value;else if("layerSaved"===J){this.hasUnsavedChanges=!1;this.item.serviceInfo=null;this.item.set("status","completed");var R=this.item.watch("isLoaded",function(){R.remove();var S=B.item.thumbnailUrl;S=S.substring(S.indexOf("?")+1,S.length);S=c.queryToObject(S);S.ts=(new Date).getTime();B.item.set("thumbnailUrl","".concat(B.item.thumbnailUrl,"?").concat(c.objectToQuery(S)));
setTimeout(function(){var T;m.default.forEachNode(document.querySelectorAll(".js-subnav-link"),function(E){return E.classList.remove("btn-disabled")});null===(T=B.mapSavedDfd)||void 0===T?void 0:T.resolve(!0)},500)})}else"newLayerItemCreated"===J?(this.layerSavedDfd&&this.layerSavedDfd.resolve(A),this.useMapViewer&&(window.location.href="item.html?id\x3d".concat(A.value.id))):"saveAsNewLayerItemCancelled"===J&&this.layerSavedDfd&&this.layerSavedDfd.reject(A)};return z=p.__decorate([(0,d.default)(l.default,
h.default,w.default)],z)}()})},"arcgisonline/pages/item/widgets/_imageManagement":function(){define("require exports tslib ../../../esriGeowConfig ../../utils/dom ../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/Deferred dojo/on dojo/query dojo/topic dojo/_base/kernel esri/Evented dojo/text!./templates/_imageManagement.html".split(" "),function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=
p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);return function(){function t(){this.templateString=q.default}t.prototype.startup=function(){var w=this,u=new c.default;this.inherited(arguments);this._targetOrigin="".concat(window.location.protocol,"//").concat(window.location.hostname);var v=a.default.imageManagementUrl.replace("#","?lang\x3d".concat(f.default.locale,
"#"));this._iframeSrc="".concat(v,"/").concat(this.item.id);this.divImageManagement.src=this._iframeSrc;document.documentElement.classList.add("no-footer");if(this.item&&this.item.isLoaded)this._initUI().then(function(z){u.resolve(z)});else var x=this.item.watch("isLoaded",function(){x.unwatch();w._initUI().then(function(z){u.resolve(z)})});return u};t.prototype.canDestroy=function(){var w=new c.default;w.resolve(!0);return w};t.prototype.destroy=function(){this.divImageManagement.src="about:blank";
this.inherited(arguments);document.documentElement.classList.remove("no-footer")};t.prototype._initUI=function(){var w=new c.default;this._initHandlers();w.resolve(!0);return w};t.prototype._initHandlers=function(){var w=this;this.own((0,d.default)(window,"message",function(u){if(u.origin===w._targetOrigin&&"imagery"===u.data.msgType){var v=u.data.status;-1<["completed","failed","processing"].indexOf(v)&&(w.item.properties=w.item.properties||{},w.item.properties.jobUrl=w.item.jobUrl=u.data.jobUrl,
w.item.properties.jobId=w.item.jobId=u.data.jobId,w.item.properties.status=v,w.item.set("status",v),u="completed"===v||"failed"===v?"removeClass":"addClass",g.default["completed"===v||"failed"===v?"deactivateNode":"activateNode"]((0,l.default)(".js-service-status").shift()),(0,l.default)(".js-status-disable")[u]("btn-disabled"),h.default.publish("imagery/update",{completed:"completed"===v||"failed"===v}))}}),(0,d.default)(this.divImageManagement,"load",function(){w.page.hideLoader()}))};return t=
p.__decorate([(0,m.default)(n.default,b.default,r.default)],t)}()})},"arcgisonline/pages/item/widgets/_data":function(){define("require exports tslib esri/Evented esri/lang esri/request dojo/_base/event dojo/_base/json dojo/_base/lang dojo/aspect dojo/string dojo/query dojo/on dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dgrid/OnDemandGrid dojo/promise/all dojo/Deferred dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/MenuItem esri/layers/FeatureLayer esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition esri/dijit/CalculateField esri/dijit/FeatureTable esri/dijit/FeatureTable/dataUtils esri/dijit/FeatureTable/dialogUtils esri/dijit/Histogram arcgisonline/map/itemData arcgisonline/map/edit arcgisonline/sharing/util ../_Actions ../../utils/data ../../utils/dom ../../utils/icons ../../utils/arrays ../../utils/strings ./AttributesView/_attributesView ../../dijit/ArcadeCalculatorDlg ../../dijit/CalculateWithOptionsDlg ../../pageUtil arcgisonline/sharing/dijit/dialog/TableAddFieldDlg arcgisonline/sharing/dijit/dialog/WaitingDlg dojo/i18n!esri/nls/jsapi dojo/text!./templates/_data.html ../../../tsutils/declareDecorator arcgisonline/esriGeowConfig esri/support/expressionUtils xstyle/css!./css/data.css".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U,M,Q,Y,fa,va,Aa,pa,N,V,Z,ba,ma,sa,Ea,ya){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);
z=p.__importDefault(z);A=p.__importDefault(A);B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);D=p.__importDefault(D);C=p.__importDefault(C);y=p.__importDefault(y);G=p.__importDefault(G);L=p.__importDefault(L);O=p.__importDefault(O);U=p.__importDefault(U);M=p.__importDefault(M);Q=p.__importDefault(Q);Y=p.__importDefault(Y);fa=p.__importDefault(fa);
va=p.__importDefault(va);Aa=p.__importDefault(Aa);pa=p.__importDefault(pa);N=p.__importDefault(N);V=p.__importDefault(V);Z=p.__importDefault(Z);ba=p.__importDefault(ba);ma=p.__importDefault(ma);sa=p.__importDefault(sa);Ea=p.__importDefault(Ea);ya=p.__importDefault(ya);return function(){function wa(aa,ca){this.templateString=ma.default;this.layer=null;this.layerInfos=[];this.userCanEdit=!1;this.sublayer=this.table=null;this.arcadeDisabledDescription="";this.newFieldTypesExist=!1;this.portalUser=this.page=
this.item=this.i18n=null;this.icons=Q.default;this.css={noFooter:"no-footer",hide:"hide",loader:"loader-bars",column5:"column-5",tabletColumn12:"tablet-column-12",menuItem:"esri-feature-table-menu-item",sortAscendingIcon:"icon-ui-sort-ascending",sortDescendingIcon:"icon-ui-sort-descending",propertiesIcon:"esri-icon-properties",iconCalculator:"esri-icon-statistics",iconTrash:"esri-icon-trash",histogram:"field-view-histogram-node",uniqueValueGrid:"field-view-unique-value-grid-node",attributeRulesGrid:"field-view-attribute-grid-node",
calcFieldDialog:"calculateFieldDialog",calcCloseButton:"cancel",calcClearIcon:"icon-ui-erase",calcValidateIcon:"icon-ui-check-mark"};this._connects=[];this._userIsAdmin=this._userIsOwner=!1;this._subtypeLayerIndex=-1;this._showAdminEditWarning=!1;this._fieldViewEvents=[];this._calcField=this._calcDialog=this._histogram=this._fieldRulesTable=this._fieldValuesTable=this._activeFieldInfo=null;this._uneditableFieldTypes="esriFieldTypeBlob esriFieldTypeGlobalID esriFieldTypeGeometry esriFieldTypeGUID esriFieldTypeOID esriFieldTypeRaster".split(" ")}
wa.prototype.startup=function(){var aa=this,ca,ka;this.inherited(arguments);var qa=new x.default;t.default.add(document.documentElement,this.css.noFooter);if(null===(ca=this.item)||void 0===ca?0:ca.isLoaded)return this._initUI().then(qa.resolve),qa;var da=null===(ka=this.item)||void 0===ka?void 0:ka.watch("isLoaded",function(){da.unwatch();aa._initUI().then(qa.resolve)});return qa};wa.prototype.destroy=function(){this.inherited(arguments);this.page.toggleErrors(!0);t.default.remove(document.documentElement,
this.css.noFooter);this._connects.forEach(function(aa){aa.remove()})};wa.prototype._initUI=function(){var aa=new x.default;this.page.toggleErrors(!1);Ea.default.hideFieldsViewInDataTab&&(0,h.default)(".js-data-attributes").addClass("hide");this._initHandlers();this._showLayers();this.sublayer?(this.set("visibleLayer",this.sublayer.id),this.layerSelect.value=this.sublayer.id,this.domNode.querySelector(".js-featureLayers").classList.add("visually-hidden")):this.set("visibleLayer",this.layerSelect.value);
aa.resolve(!1);return aa};wa.prototype._showLayers=function(){var aa=this.item,ca=aa.itemData;aa=[].concat(aa.featureLayers||[]).concat(aa.tables||[]);var ka=this.layerSelect,qa=ca&&ca.layers&&ca.layers.length,da=!aa.length&&qa;aa=(ca=da?ca.layers:aa)&&1<ca.length?"removeClass":"addClass";ca.forEach(function(ia,ra){var Fa=da?ia.layerDefinition.name:ia.name;w.default.place(w.default.toDom('\x3coption value\x3d"'+(g.default.isDefined(ia.id)?ia.id:ra)+'"\x3e'+Fa+"\x3c/option\x3e"),ka)});q.default.set(ka,
"selected",0);(0,h.default)(".js-featureLayers")[aa]("hide")};wa.prototype._initHandlers=function(){var aa=this;this.adminEditWarning=this.domNode.querySelector(".js-admin-edit-notice");this.own((0,f.default)(this.layerSelect,"change",function(){aa._dataView?aa.set("visibleLayer",q.default.get(aa.layerSelect,"value")):aa.set("visibleAttributes",q.default.get(aa.layerSelect,"value"));t.default.add(aa.fieldViewContainer,aa.css.hide);t.default.add(aa.fieldViewTop,aa.css.hide);aa._cleanUpFieldView();
aa._fieldViewEvents&&(aa._fieldViewEvents.forEach(function(ca){ca.remove()}),aa._fieldViewEvents=[])}),(0,h.default)(".js-data-aspect",this.domNode).on("change",function(ca){aa.set("data"===ca.target.value?"visibleLayer":"visibleAttributes",q.default.get(aa.layerSelect,"value"))}))};wa.prototype._showError=function(aa){};wa.prototype._hideError=function(){};wa.prototype._setVisibleLayerAttr=function(aa){var ca=this;this._dataView=!0;document.querySelector(".js-attributesView").checked=!1;document.querySelector(".js-dataView").checked=
!0;(0,h.default)(".js-feature-table").removeClass("hide");(0,h.default)(".js-attributes-view").addClass("hide");(0,h.default)(".js-hide-on-error").removeClass("hide");(0,h.default)(".js-data-error").removeClass("is-active");this._hideError();this.page.showLoader();this._connects.forEach(function(qa){qa.remove()});this.getRelatedTSForFS(this.item).then(function(qa){ca.item.relTileLayers=qa});var ka=parseInt(aa,10);this._createLayer(this.item,ka).then(function(qa){var da=ca.item;ca.layer=qa.layer;var ia=
["esriFieldTypeTimestampOffset","esriFieldTypeBigInteger","esriFieldTypeDateOnly","esriFieldTypeTimeOnly"];ca.newFieldTypesExist=ca.item.layers[ca.layer.layerId<ca.item.layers.length?ca.layer.layerId:0].fields.some(function(ra){return ia.includes(ra.type)});ca.newFieldTypesExist&&(ca.arcadeDisabledDescription=ca.i18n.calculateSQLArcadeDlg.arcadeDisabledUnsupportedFieldType);ca.layerInfos=qa.layerInfos;ca.userCanEdit=qa.userCanEdit;qa=ca.layer.isEditable?ca.layer.isEditable():!1;ca.userCanEdit&&!qa&&
(ca.layer.userIsAdmin=!0);ca.adminEditWarning.open=ca._showAdminEditWarning;ca._setUpTable();ca.setupDataLastUpdated(da,ka);ca.page.hideLoader()},function(){(0,h.default)(".js-hide-on-error").addClass("hide");ca.page.hideLoader();(0,h.default)(".js-data-error").addClass("is-active")})};wa.prototype._setVisibleAttributesAttr=function(aa){var ca=this;this._dataView=!1;document.querySelector(".js-attributesView").checked=!0;document.querySelector(".js-dataView").checked=!1;(0,h.default)(".js-hide-on-error").removeClass("hide");
(0,h.default)("js-data-error").removeClass("is-active");this._hideError();this.page.showLoader();(0,h.default)(".js-feature-table").addClass("hide");(0,h.default)(".js-attributes-view").removeClass("hide");var ka=parseInt(aa,10);this._createLayer(this.item,ka).then(function(qa){ca.layer=qa.layer;ca.layerInfos=qa.layerInfos;ca.layer.fields.forEach(function(da){da.canDeleteField=ca._canDeleteField(da);da.canFieldEditableProp=ca._canFieldEditableProp(da)});ca.attributesView&&(ca.attributesView.destroy(!0),
ca.attributesView=null);qa=new va.default({tab:ca},ca.domNode.querySelector(".js-attributes-view"));qa.startup(ca.item,ca.layer,ca.layerInfos,ca._canAddField());ca.attributesView=qa;ca._setUpAttributeViewEvents();ca.setupDataLastUpdated(ca.item,ka);ca.page.hideLoader()},function(qa){(0,h.default)(".js-hide-on-error").addClass("hide");ca.page.hideLoader();(0,h.default)(".js-data-error").addClass("is-active")})};wa.prototype._setUpAttributeViewEvents=function(){var aa=this;this.attributesView.own((0,h.default)(".js-add-field-btn",
this.domNode).on("click",function(ca){n.default.stop(ca);aa._showAddFieldDialog()}),z.default.subscribe("attributeFieldDetails/deleteField",this._showDeleteFieldDialog.bind(this)),z.default.subscribe("attributesView/deleteSingleField",this._showDeleteFieldDialog.bind(this)),z.default.subscribe("attributesView/deleteMultipleFields",this._showDeleteMultipleFieldDialog.bind(this)))};wa.prototype._createLayer=function(aa,ca){var ka,qa,da=new x.default,ia=null===aa||void 0===aa?void 0:aa.url.replace(/\/+$/,
""),ra=ca||0;ca=(null===ia||void 0===ia?0:ia.match(/Server\/(\d+)/))?ia:ia+"/"+ra;ia=c.default.clone(aa.itemData)||null;var Fa=this.portalUser,ea=[],xa;this._userIsOwner=Fa&&aa?Fa.username===aa.owner:!1;this._userIsAdmin=this.item.isAdmin;var ta=!aa.isMultiServicesView&&(this._canEditData()||this._userIsOwner||this._userIsAdmin);if(null===ia||void 0===ia?0:ia.layers){ea=ia.layers||[];ea.length&&(ea.some(function(Ca){if(g.default.isDefined(Ca.id)&&Ca.id===ra||Ca.layerDefinition&&g.default.isDefined(Ca.layerDefinition.id)&&
Ca.layerDefinition.id===ra)return xa=Ca,!0}),xa||(xa=ea[ra]||null));var Ba=(Ba=xa?xa.layerDefinition:null)?Ba.definitionExpression:null}Fa="admin"===aa.itemControl||"update"===aa.itemControl;var Na=null===(ka=aa.layers)||void 0===ka?void 0:ka.find(function(Ca){return Ca.id===ra});ka=null===(qa=null===Na||void 0===Na?void 0:Na.capabilities)||void 0===qa?void 0:qa.includes("Editing");this._showAdminEditWarning=aa.isHostedService&&!aa.isMultiServicesView&&!ka&&Fa;ka=(qa=this._getSTGLSublayerInfo(ia,
ra))&&(null===qa||void 0===qa?void 0:qa.groupLayer);M.default.showHide(this.domNode.querySelector(".js-subtype-group-layers"),ka);ka&&this._createSTGLpicker(qa,ra);if(aa.isFeatureCollection){var Ra=new P.default(xa,{userIsAdmin:ta,visible:!0});if(Ra.loaded)da.resolve({layer:Ra,layerInfos:ea,userCanEdit:ta});else f.default.once(Ra,"load",function(Ca){da.resolve({layer:Ra,layerInfos:ea,userCanEdit:ta})})}else if(Ra=qa&&qa.subtypeLayer?this._createFeatureLayerFromSTGLSublayer(aa,qa,ta):new P.default(ca.replace(/.*?:\/\//g,
"//"),{userIsAdmin:ta,mode:P.default.MODE_ONDEMAND,outFields:["*"],visible:!0,definitionExpression:Ba}),f.default.once(Ra,"error",da.reject),(0,f.default)(Ra,"add-attachment-complete",this._updateLayerDataOrSchemaUpdatedDate.bind(this)),(0,f.default)(Ra,"delete-attachments-complete",this._updateLayerDataOrSchemaUpdatedDate.bind(this)),Ra.loaded)da.resolve({layer:Ra,layerInfos:ea,userCanEdit:ta});else f.default.once(Ra,"load",function(Ca){da.resolve({layer:Ra,layerInfos:ea,userCanEdit:ta})});return da};
wa.prototype.setupDataLastUpdated=function(aa,ca){var ka;this.page._showDataLastUpdated({type:aa.type,typeKeywords:[].concat(aa.typeKeywords),layers:(null===(ka=aa.layers)||void 0===ka?void 0:ka.length)>ca?[aa.layers[ca]]:[]})};wa.prototype._isViewServiceLayer=function(aa){return(null===aa||void 0===aa?void 0:aa.typeKeywords)&&-1<aa.typeKeywords.indexOf("View Service")};wa.prototype._isHostedServiceLayer=function(aa){return(null===aa||void 0===aa?void 0:aa.typeKeywords)&&-1<aa.typeKeywords.indexOf("Hosted Service")};
wa.prototype._isSpatioTemporalService=function(aa){return(null===aa||void 0===aa?void 0:aa.typeKeywords)&&-1<aa.typeKeywords.indexOf("Spatiotemporal")};wa.prototype.getRelatedTSForFS=function(aa){var ca=new x.default,ka=aa.itemUrl;this._isViewServiceLayer(aa)?ka+="/relatedItems?relationshipType\x3dService2Service\x26direction\x3dforward":aa.isHostedService||this._isHostedServiceLayer(aa)?ka+="/relatedItems?relationshipType\x3dService2Data\x26direction\x3dreverse":ca.resolve(null);L.default.getJson(ka,
function(qa){var da=null;if(null===qa||void 0===qa?0:qa.total)da=[],null===qa||void 0===qa?void 0:qa.relatedItems.forEach(function(ia){"Map Service"===ia.type&&da.push(ia)});ca.resolve(da)},function(qa){ca.resolve(null)});return ca};wa.prototype._setUpTable=function(){var aa=this.layer,ca=this.css;this.table&&(this.table.destroy(),this.table=null);var ka=this._getPopupInfo(aa),qa=(null===ka||void 0===ka?void 0:ka.fieldInfos)||null;ka=qa?this._getOrderedOutFields(aa,qa):["*"];qa=qa?this._getHiddenFields(aa,
qa,ka):null;var da=this.userCanEdit&&!this.item.isMultipatchFeatureService&&!this.item.isFeatureCollection;this.wrapper.querySelector("#grid")||w.default.create("div",{id:"grid"},this.wrapper);var ia=new I.default({featureLayer:aa,editable:da,showAttachments:!0,showFieldDetails:!0,showRelatedRecords:!0,showDataTypes:!1,showColumnHeaderTooltips:aa.supportsFieldDescription?!1:!0,showColumnHeaderTooltipsWithDescription:!!aa.supportsFieldDescription,showDefaultSortMenuItem:!1,showFilterMenuItems:!1,showStatistics:!1,
dateOptions:{timeEnabled:!0,dateEnabled:!0,datePattern:"M/d/y",timePattern:"h:mm a"},outFields:ka,hiddenFields:qa,_layerInfos:this.layerInfos},"grid");ia.own((0,f.default)(ia,"load",function(){ia.css=p.__assign(p.__assign({},ia.css),{sortAscendingIcon:ca.sortAscendingIcon,sortDescendingIcon:ca.sortDescendingIcon,propertiesIcon:ca.propertiesIcon});setTimeout(ia.resize,200)}));ia.resize();ia.startup();this.table=ia;this._setUpTableEvents()};wa.prototype._createSTGLpicker=function(aa,ca){var ka=this,
qa,da;ca=this.domNode.querySelector(".js-subtype-group-layers-select");var ia=this.domNode.querySelector(".js-subtype-group-layers-label");this.subtypeGroupLayerPicker||(this.domNode.querySelector(".js-subtype-group-layers").classList.remove("hide"),ca.addEventListener("change",function(ra){ra=parseInt(ra.target.value,10);ka._subtypeLayerIndex=ra;ka._setVisibleLayerAttr(ka.layerSelect.value)}),this.subtypeGroupLayerPicker=ca,this._subtypeLayerIndex=-1);ia.innerHTML="".concat(aa.subtypeLabel,":");
ca.innerHTML=null===(da=null===(qa=aa.groupLayer)||void 0===qa?void 0:qa.layers)||void 0===da?void 0:da.reduce(function(ra,Fa,ea){return"\n        ".concat(ra,' \x3coption value\x3d"').concat(ea,'" ').concat(ea===ka._subtypeLayerIndex?"selected":"","\x3e\n          ").concat(Fa.title,"\n        \x3c/option\x3e\n      ")},'\x3coption value\x3d"-1" '.concat(-1===this._subtypeLayerIndex?"selected":"","\x3e").concat(this.i18n.gallery.filters.all,"\x3c/option\x3e"))};wa.prototype._createFeatureLayerFromSTGLSublayer=
function(aa,ca,ka){var qa;if(ca&&ca.subtypeLayer){var da=ca.subtypeLayer;ca=ca.groupLayer;aa="".concat(aa.url,"/").concat(ca.id);return new P.default(aa,{definitionExpression:null===(qa=ca.layerDefinition)||void 0===qa?void 0:qa.definitionExpression,subtypeSublayerInfo:da,outFields:["*"],userIsAdmin:ka})}};wa.prototype._findById=function(aa,ca){return null===aa||void 0===aa?void 0:aa.find(function(ka){return(null===ka||void 0===ka?void 0:ka.id)===ca})};wa.prototype._isSubtypeGroupLayer=function(aa,
ca){aa=this._findById(null===aa||void 0===aa?void 0:aa.layers,ca);return"SubtypeGroupLayer"===(null===aa||void 0===aa?void 0:aa.layerType)?aa:!1};wa.prototype._getSTGLSublayerInfo=function(aa,ca){var ka;aa=this._isSubtypeGroupLayer(aa,ca);if(!aa)return!1;ca=this._findById(this.item.layers,ca);var qa=null===ca||void 0===ca?void 0:ca.subtypeField,da="Subtype";qa&&(ca=null===(ka=ca.fields)||void 0===ka?void 0:ka.find(function(ia){return(null===ia||void 0===ia?void 0:ia.name)===qa}),da=(null===ca||void 0===
ca?void 0:ca.alias)||(null===ca||void 0===ca?void 0:ca.name)||"Subtype");return{groupLayer:aa,subtypeLayer:aa.layers[this._subtypeLayerIndex],subtypeLabel:da}};wa.prototype._setUpTableEvents=function(){var aa=this,ca=this.item,ka=this.table,qa=this.css,da=this.arcadeDisabledDescription;ka.own((0,f.default)(ka,"show-detailed-field-view",this._showFieldView.bind(this)),(0,f.default)(ka,"error",function(ia){aa._showError({message:ia.message})}),(0,f.default)(ka,"edits-complete",this._updateLayerDataOrSchemaUpdatedDate.bind(this)),
d.default.after(ka._grid,"_generateOptionsMenuItems",function(ia){(null===ca||void 0===ca?0:ca.canAppendData)&&ia.unshift({label:aa.i18n.itemProperties.updateData,callback:aa._showAppendDataDialog.bind(aa)});aa._canAddField()&&ia.unshift({label:ba.default.calculateFields.addFieldTitle,callback:aa._showAddFieldDialog.bind(aa)});return ia}),d.default.before(ka._grid,"_showColumnMenu",function(ia){var ra,Fa,ea=ia.menu,xa=ia.fieldInfo;if(aa._canCalculateField(xa))if(null===(Fa=null===(ra=aa.item)||void 0===
ra?void 0:ra.serviceInfo)||void 0===Fa?0:Fa.supportsAppend){var ta=aa._canArcadeCalculateField(xa);ea.addChild(new J.default({label:ba.default.calculateFields.calculate,iconClass:qa.iconCalculator,baseClass:qa.menuItem,onClick:function(){return aa._showCalculateWithOptionsDialog({fieldInfo:xa,showArcadeOption:ta,arcadeDisabledDescription:da})}}))}else ea.addChild(new J.default({label:ba.default.calculateFields.calculate,iconClass:qa.iconCalculator,baseClass:qa.menuItem,onClick:function(){return aa._showCalculateFieldDialog(xa)}}));
aa._canDeleteField(xa)&&ea.addChild(new J.default({label:ba.default.calculateFields.deleteLabel,iconClass:qa.iconTrash,baseClass:qa.menuItem,onClick:function(){return aa._showDeleteFieldDialog(xa)}}))}),z.default.subscribe("append/done",function(ia){ia&&"success"===ia.type&&(aa._updateLayerDataOrSchemaUpdatedDate("data"),ka.refresh())}),z.default.subscribe("arcadeCalculatorDlg/done",function(ia){"success"===(null===ia||void 0===ia?void 0:ia.type)&&(aa._updateLayerDataOrSchemaUpdatedDate("data"),aa._fieldViewActive&&
aa._updateFieldView({fieldInfo:aa._activeFieldInfo}),ka.refresh())}))};wa.prototype._updateLayerDataOrSchemaUpdatedDate=function(aa){var ca,ka=this.item,qa=this.layer,da=(new Date).getTime();this.item.set("maxAgeCheck",!0);if(qa){qa.editingInfo=qa.editingInfo||{};"schema"===aa?qa.editingInfo.schemaLastEditDate=da:qa.editingInfo.dataLastEditDate=da;if(ka.layers){var ia=qa.layerId<ka.layers.length?ka.layers[qa.layerId]:ka.layers[0];ia.editingInfo=ia.editingInfo||{};"schema"===aa?ia.editingInfo.schemaLastEditDate=
da:ia.editingInfo.dataLastEditDate=da}this.setupDataLastUpdated(ka,null!==(ca=qa.id)&&void 0!==ca?ca:qa.layerId)}};wa.prototype._reloadTable=function(){var aa=this;this._hideError();this._updateItemData().then(function(){aa.table&&(aa.table.destroy(),aa.table=null);w.default.create("div",{id:"grid"},aa.wrapper);aa.page.refreshServiceInfo().then(function(){aa._dataView?aa._setVisibleLayerAttr(aa.layer.layerId):aa.set("visibleAttributes",q.default.get(aa.layerSelect,"value"))})})};wa.prototype._getOrderedOutFields=
function(aa,ca){var ka,qa,da=ca.map(function(ia){return ia.fieldName});if(null===(ka=aa.fields)||void 0===ka?0:ka.length)null===(qa=aa.fields)||void 0===qa?void 0:qa.forEach(function(ia){-1===da.indexOf(ia.name)&&da.push(ia.name)});return da};wa.prototype._getHiddenFields=function(aa,ca,ka){var qa,da,ia=aa.objectIdField,ra=ca.filter(function(ea){return!ea.visible}).map(function(ea){return ea.fieldName}),Fa=ca.map(function(ea){return ea.fieldName});0<(null===(qa=aa.fields)||void 0===qa?void 0:qa.length)&&
(null===(da=aa.fields)||void 0===da?void 0:da.forEach(function(ea){-1===Fa.indexOf(ea.name)&&-1<ka.indexOf(ea.name)&&ra.push(ea.name)}),aa=aa.fields.every(function(ea){return-1<ra.indexOf(ea.name)}),ia&&aa&&ra.splice(ra.indexOf(ia),1));return ra};wa.prototype._showFieldView=function(aa){var ca=this,ka,qa=this.table,da=this.css;this._activeFieldInfo=aa.fieldInfo;this._columnPickerButton=aa.pickerButton;this._fieldViewActive=!0;t.default.add(r.default.byId("grid"),[da.column5,da.tabletColumn12]);t.default.remove(this.fieldViewContainer,
da.hide);t.default.remove(this.fieldViewTop,da.hide);this._updateFieldView(aa);null===(ka=null===qa||void 0===qa?void 0:qa._gridBorderContainerNode)||void 0===ka?void 0:ka.resize();this.own(f.default.once(this.fieldViewTopCloseBtn,"click",this._hideFieldView.bind(this)),(0,f.default)(qa,"column-focus-change",function(ia){ca._activeFieldInfo=ia.fieldInfo;ca._updateFieldView(ia)}));this._fieldViewEvents=[(0,f.default)(this.calculateFieldButton,"click",function(){var ia,ra;(null===(ra=null===(ia=ca.item)||
void 0===ia?void 0:ia.serviceInfo)||void 0===ra?0:ra.supportsAppend)?ca._showCalculateWithOptionsDialog({fieldInfo:ca._activeFieldInfo,showArcadeOption:ca._canArcadeCalculateField(ca._activeFieldInfo),arcadeDisabledDescription:ca.arcadeDisabledDescription}):ca._showCalculateFieldDialog(ca._activeFieldInfo)}),(0,f.default)(this.deleteFieldButton,"click",function(){ca._showDeleteFieldDialog(ca._activeFieldInfo)}),(0,f.default)(qa,"edits-complete",function(){ca._updateFieldView({fieldInfo:ca._activeFieldInfo})}),
(0,h.default)(".index-form",this.domNode).on("change",function(ia){n.default.stop(ia);ia=(0,h.default)(".unique-index-checkbox",ca.domNode).shift().checked;ca._currentFieldHasIndex&&!ia?(0,h.default)(".index-form-submit",ca.domNode).removeAttr("disabled"):!ca._currentFieldHasIndex&&ia?(0,h.default)(".index-form-submit",ca.domNode).removeAttr("disabled"):(0,h.default)(".index-form-submit",ca.domNode).attr("disabled","true")}),(0,h.default)(".cancel-index-form",this.contentWrapper).on("click",function(ia){n.default.stop(ia);
ia=ia.target.form;(0,h.default)(".index-form").addClass("hide");(0,h.default)(".edit-index").removeClass("hide");ia.reset()}),(0,h.default)(".index-form-submit",this.contentWrapper).on("click",function(ia){n.default.stop(ia);(0,h.default)(".index-form").addClass("hide");var ra=ca.domNode.querySelector(".unique-index-checkbox").checked;ia=ra?ca.i18n.itemProperties.createUniqueIndex:ca.i18n.itemProperties.deleteUniqueIndex;(0,h.default)(".change-index-text",ca.domNode).attr("innerHTML",ia);ca._generateIndexJsonParameters(ra).then(function(Fa){ca._buildOrDeleteIndex(ra,
Fa).then(function(){ca._addOrRemoveIndex(ra,Fa);setTimeout(function(){z.default.publish("alert/show",{type:"success",text:ca.i18n.itemProperties.createindexSuccess});ca._showAttributeRulesGrid(ca._activeFieldInfo)},1E3)},function(ea){setTimeout(function(){z.default.publish("alert/show",{type:"error",text:ca.i18n.itemProperties.error.indexFailure});ca._showAttributeRulesGrid(ca._activeFieldInfo)},1E3)})})})]};wa.prototype._addOrRemoveIndex=function(aa,ca){if(aa)this.layer.indexes.push(ca.indexes[0]);
else for(aa=0;aa<this.layer.indexes.length;aa++)if(this.layer.indexes[aa].name.toLowerCase()===ca.indexes[0].name.toLowerCase()&&this.layer.indexes[aa].isUnique){this.layer.indexes.splice(aa,1);break}};wa.prototype._buildOrDeleteIndex=function(aa,ca){var ka=this,qa=new x.default,da="".concat(this.item.adminUrl,"/").concat(this.layerSelect.value);aa?(da+="/addToDefinition",aa={addToDefinition:JSON.stringify(ca),async:!0}):(da+="/deleteFromDefinition",aa={deleteFromDefinition:JSON.stringify(ca),async:!0});
L.default.request({url:da,content:aa},{usePost:!0}).then(this._checkStatus.bind(this),function(ia){qa.reject(ia)}).then(function(ia){ka.page._item.set("serviceChanged",!0);qa.resolve(ia)});return qa};wa.prototype._checkStatus=function(aa,ca,ka){var qa=this,da=null===aa||void 0===aa?void 0:aa.statusURL,ia=ka||new x.default,ra=ca||500;L.default.request({url:da}).then(function(Fa){Fa=Fa||{status:"completed"};Fa.status&&"completed"===Fa.status.toLowerCase()?ia.resolve(!0):Fa.status&&"failed"===Fa.status.toLowerCase()||
400<Fa.code||""===Fa.status?ia.reject(Fa):(ra=(ra||500)+250,setTimeout(function(){qa._checkStatus(aa,ra,ia)},ca))},function(Fa){setTimeout(function(){z.default.publish("alert/show",{type:"error",text:qa.i18n.itemProperties.error.indexFailure});qa._showAttributeRulesGrid(qa._activeFieldInfo);ia.reject(Fa)},1E3)});return ia};wa.prototype._generateIndexJsonParameters=function(aa){var ca=new x.default,ka=this._activeFieldInfo,qa=this._currentLayerForIndex.indexes,da={indexes:[]},ia={name:void 0,fields:void 0,
isUnique:void 0};if(aa)ia.name="".concat(ka.name,"_Index"),ia.fields=ka.name,ia.isUnique=!0;else for(aa=0;aa<qa.length;aa++)if(qa[aa].fields===ka.name){ia.name=qa[aa].name;break}da.indexes[0]=ia;ca.resolve(da);return ca};wa.prototype._updateFieldView=function(aa){var ca=this,ka=aa.fieldInfo;aa=this.css;var qa=this.i18n.itemProperties,da=this.i18n.addItemFrm,ia=this.fieldViewTopTitle,ra=this.fieldViewTopTitleTablet,Fa=this.fieldViewFieldType,ea=this.fieldViewFieldName;this._cleanUpFieldView();this._toggleFieldViewButtons();
ia.innerHTML=ka.alias||ka.name;ra.innerHTML=ka.alias||ka.name;Fa.innerHTML=da.fieldTypes[ka.type]||ka.type;ea.innerHTML=ka.name;w.default.create("div",{className:aa.loader},this.fieldViewSummaryContainer);this._getFieldStatistics(ka).then(function(xa){ca._cleanUpSummaryNode();var ta=xa.statistics,Ba=xa.histogram;xa=xa.uniqueValueInfos;"esriFieldTypeDate"===ka.type?Ba&&(null===ta||void 0===ta?0:ta.count)?ca._generateHistogram(ka,Ba,ta):(null===xa||void 0===xa?0:xa.length)?ca._generateUniqueValuesGrid(ka,
xa):ca.fieldViewSummaryContainer.innerHTML=ba.default.widgets.FeatureTable.noData:ta&&Ba?ta.count?ca._generateHistogram(ka,Ba,ta):ca.fieldViewSummaryContainer.innerHTML=ba.default.widgets.FeatureTable.noData:(null===xa||void 0===xa?0:xa.length)?ca._generateUniqueValuesGrid(ka,xa):ca.fieldViewSummaryContainer.innerHTML=qa.error.noFieldInfo}).otherwise(function(){ca._cleanUpSummaryNode();ca.fieldViewSummaryContainer.innerHTML=qa.error.noFieldInfo});this._showAttributeRulesGrid(ka)};wa.prototype._hideFieldView=
function(){var aa=this.table,ca=this._columnPickerButton,ka=this.css;this._cleanUpFieldView();t.default.add(this.fieldViewContainer,ka.hide);t.default.add(this.fieldViewTop,ka.hide);t.default.add(this.calculateFieldButton,ka.hide);t.default.add(this.deleteFieldButton,ka.hide);(0,h.default)(".index-form").addClass("hide");(0,h.default)(".edit-index").addClass("hide");t.default.remove(r.default.byId("grid"),[ka.column5,ka.tabletColumn12]);aa._removeButtonNode(ca);aa._growGrid({grid:aa._grid});this._fieldViewEvents.forEach(function(qa){qa.remove()});
this._fieldViewEvents=[];this._activeFieldInfo=null;this._fieldViewActive=!1;this._columnPickerButton=null};wa.prototype._cleanUpSummaryNode=function(){for(var aa=this.fieldViewSummaryContainer;aa.firstChild;)aa.removeChild(aa.firstChild);aa.innerHTML=""};wa.prototype._cleanUpFieldView=function(){this._cleanUpSummaryNode();this._fieldRulesTable&&this._fieldRulesTable.destroy();this._fieldValuesTable&&this._fieldValuesTable.destroy();this._histogram&&this._histogram.destroy()};wa.prototype._getUniqueValuesData=
function(aa){var ca;if("esriFieldTypeDate"===aa.type||"esriFieldTypeString"===aa.type&&!this.item.isHostedService&&!this._isHostedServiceLayer(this.item)||-1!==F.default.numericFieldTypes.indexOf(aa.type))return this.layer.statisticsPlugin.getUniqueValues({field:aa.name,resultRecordCount:10}).then(function(ra){ra=ra.uniqueValueInfos||[];ra.sort(function(Fa,ea){return parseFloat(ea.count)-parseFloat(Fa.count)});return ra=ra.slice(0,10)}).otherwise(function(){return[]});var ka=new x.default,qa=new S.default(this.layer.url),
da=new T.default;da.onStatisticField="*";da.outStatisticFieldName="countOFExpr";da.statisticType="count";var ia=new R.default;ia.returnGeometry=!1;ia.outStatistics=[da];(null===(ca=this.layer.advancedQueryCapabilities)||void 0===ca?0:ca.supportsOrderByOnlyOnLayerFields)?(ia.outFields=["*"],ia.groupByFieldsForStatistics=[aa.name]):(ia.orderByFields=["count(*) desc"],ia.groupByFieldsForStatistics=["CASE WHEN ".concat(aa.name," is null THEN '\x3cNULL RESULT\x3e' ELSE ").concat(aa.name," END")]);ia.start=
0;qa.execute(ia).then(function(ra){ra=ra.features;null!==ra&&void 0!==ra&&ra.length?ka.resolve(ra.map(function(Fa){return{value:Fa.attributes.EXPR_1,count:Fa.attributes.countOFExpr}})):ka.resolve([])}).otherwise(function(ra){ka.reject(ra)});return ka};wa.prototype._getFieldStatisticsData=function(aa){return this.layer.statisticsPlugin.getFieldStatistics({field:aa.name})};wa.prototype._getHistogramData=function(aa,ca,ka){var qa;aa={field:aa.name,numBins:100<(null===(qa=this.table)||void 0===qa?void 0:
qa.featureCount)?30:10,minValue:void 0,maxValue:void 0};isNaN(ca)||isNaN(ka)||(aa.minValue=ca,aa.maxValue=ka);return this.layer.statisticsPlugin.getHistogram(aa)};wa.prototype._getFieldStatistics=function(aa){var ca=this,ka=new x.default;this.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(function(){var qa="esriFieldTypeString esriFieldTypeOID esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeDate esriFieldTypeGUID esriFieldTypeRaster esriFieldTypeBlob esriFieldTypeGeometry esriFieldTypeXML".split(" ");
aa.name===ca.layer.objectIdField||-1!==qa.indexOf(aa.type)||aa.typeId||aa.domain&&aa.domain.codedValues?"esriFieldTypeDate"===aa.type&&(ca.item.isHostedService||ca._isHostedServiceLayer(ca.item))?ca._getFieldStatisticsData(aa).then(function(da){if(da){var ia=ca.layer.statisticsPlugin.getSuggestedDataRange({statistics:da,isDate:!0});ia.defaultStatistics&&(da.min=ia.min,da.max=ia.max);ca._getHistogramData(aa,ia.min,ia.max).then(function(ra){ka.resolve({histogram:ra,statistics:da})}).otherwise(function(){ka.resolve({})})}else ka.resolve({})}).otherwise(function(){ka.resolve({})}):
ca._getUniqueValuesData(aa).then(function(da){ka.resolve({uniqueValueInfos:da})}).otherwise(function(){ka.resolve({})}):(0,v.default)([ca._getFieldStatisticsData(aa),ca._getHistogramData(aa)]).then(function(da){ka.resolve({statistics:da[0]||null,histogram:da[1]||null})}).otherwise(function(){ka.resolve({})})});return ka};wa.prototype._generateHistogram=function(aa,ca,ka){this._histogram&&(this._histogram.destroy(),this._histogram=null);var qa=w.default.create("div",{className:this.css.histogram},
this.fieldViewSummaryContainer);this._histogram=new C.default({data:ca,statistics:ka,isDate:"esriFieldTypeDate"===aa.type},qa);this._histogram.startup()};wa.prototype._generateUniqueValuesGrid=function(aa,ca){var ka=this,qa=this.i18n.itemProperties;this._fieldValuesTable&&(this._fieldValuesTable.destroy(),this._fieldValuesTable=null);var da=ca.map(function(ra){var Fa;if("esriFieldTypeDate"===aa.type&&""!==ra.value&&null!==ra.value)ra.value=F.default.formatDateForLocale({dateOptions:ka.table.dateOptions,
timestamp:ra.value,fieldInfo:aa});else if(aa.typeId){var ea=-1!==F.default.numericFieldTypes.indexOf(aa.type),xa=ka.table.layerInfo.types,ta=null;if(null===(Fa=null===xa||void 0===xa?void 0:xa[0])||void 0===Fa?0:Fa.id)ta="string"===typeof xa[0].id&&ea?F.default.findFirst(xa,"id",ra.value.toString()):F.default.findFirst(xa,"id",ra.value);ra.value=(null===ta||void 0===ta?0:ta.name)?ta.name:(null===ta||void 0===ta?0:ta.id)?ta.id:null}else aa.domain&&aa.domain.codedValues&&(Fa=F.default.findFirst(aa.domain.codedValues,
"code",ra.value),ra.value=Fa?Fa.name:null);if(""===ra.value||null===ra.value||"\x3cNULL RESULT\x3e"===ra.value)ra.value=qa.nullFieldValue;return ra},this),ia=w.default.create("div",{className:this.css.uniqueValueGrid},this.fieldViewSummaryContainer);this._fieldValuesTable=new u.default({columns:[{field:"value",label:9<ca.length?qa.top10Values:qa.topValues},{field:"count",label:qa.fieldCount}]},ia);this._fieldValuesTable.renderArray(da)};wa.prototype._showAttributeRulesGrid=function(aa){var ca=this,
ka=this.i18n.itemProperties,qa=this.i18n.common,da=aa.nullable?qa.yesLabel:qa.noLabel,ia=aa.editable?qa.yesLabel:qa.noLabel,ra=(null===aa||void 0===aa?void 0:aa.length)||ka.none;da=[["".concat(this.i18n.attributeFieldDetails.nullable,":"),da],[ka.editable,ia],[ka.length,ra]];aa.domain&&"range"===aa.domain.type&&da.push([ka.minMaxValue,"".concat(aa.domain.minValue," - ").concat(aa.domain.maxValue)]);if("Feature Service"===this.item.type){this._currentLayerForIndex=this.layer;this._currentFieldHasIndex=
!1;for(ka=0;ka<this._currentLayerForIndex.indexes.length;ka++)if(this._currentLayerForIndex.indexes[ka].fields===aa.name&&this._currentLayerForIndex.indexes[ka].isUnique){this._currentFieldHasIndex=!0;break}ka=this._currentFieldHasIndex?qa.yesLabel:qa.noLabel;this._canEditUniqueIndex(aa)?da.push([this.i18n.itemProperties.uniqueLabel,"\x3clabel class\x3d'change-index-text'\x3e".concat(ka,"\x3c/label\x3e\x3cbutton class\x3d'btn-link btn-link-darker-gray icon-ui-edit font-size--3 edit-index right'\x3e").concat(qa.edit,
"\x3c/button\x3e")]):da.push([this.i18n.itemProperties.uniqueLabel,ka]);this._clearTableAndCreateNewOne(da);aa=(0,h.default)(".edit-index",this.domNode).on("click",function(Fa){n.default.stop(Fa);(0,h.default)(".index-form").removeClass("hide");(0,h.default)(".edit-index").addClass("hide");(0,h.default)(".index-form-submit",ca.domNode).attr("disabled","true");ca._currentFieldHasIndex?ca.domNode.querySelector(".unique-index-checkbox").checked=!0:ca.domNode.querySelector(".unique-index-checkbox").checked=
!1});this._fieldViewEvents.push(aa)}else this._clearTableAndCreateNewOne(da)};wa.prototype._clearTableAndCreateNewOne=function(aa){for(var ca=this.domNode.querySelector(".settingsTable");0<ca.rows.length;)ca.deleteRow(0);aa.reduce(function(ka,qa){var da=ca.insertRow(ca.rows.length);ka=da.insertCell(0);da=da.insertCell(1);ka.innerHTML=qa[0];da.innerHTML=qa[1]},"")};wa.prototype._toggleFieldViewButtons=function(){var aa=this._activeFieldInfo,ca=this.css,ka=this.calculateFieldButton,qa=this.deleteFieldButton;
this._canCalculateField(aa)?t.default.remove(ka,ca.hide):t.default.add(ka,ca.hide);this._canDeleteField(aa)?t.default.remove(qa,ca.hide):t.default.add(qa,ca.hide)};wa.prototype._showAppendDataDialog=function(aa){var ca=this.layer;ca=g.default.isDefined(ca.id)?ca.id:g.default.isDefined(ca.layerId)?ca.layerId:null;O.default.appendData({evt:aa,item:this.item,layerId:ca,page:this.page,user:this.portalUser,newItemEntryPage:"data"})};wa.prototype._showAddFieldDialog=function(){var aa=this.domNode.querySelector(".js-add-field-btn"),
ca=this.layer,ka=ca.id||ca.layerId||0;aa=N.default.createSpecifiedDialog(V.default,{css:{},layer:ca},aa);var qa=this._hasPopupInfo(ca)?this._getPopupInfo(ca):null;aa.show({mapLayer:{layer:ca,itemCard:this.item,itemId:this.item.id,popupInfo:qa,url:"".concat(this.item.url,"/").concat(ka)},subLayerId:ka,layer:ca,table:this})};wa.prototype._showCalculateWithOptionsDialog=function(aa){var ca=new pa.default;ca.startup(aa);ca.showModal("true");this.calculateWithOptionsDlg=ca;this._setUpCalculateWithOptionsDlgEvents();
f.default.once(ca,"hide",function(ka){ca.destroyRecursive()})};wa.prototype._setUpCalculateWithOptionsDlgEvents=function(){this.calculateWithOptionsDlg.own(z.default.subscribe("calculateWithOptionsDlg/arcade",this._showArcadeCalculatorDialog.bind(this)),z.default.subscribe("calculateWithOptionsDlg/sql",this._showCalculateFieldDialog.bind(this)))};wa.prototype._showArcadeCalculatorDialog=function(aa){var ca=new Aa.default({item:this.item,layer:this.layer,fieldInfo:aa,whereClause:this.layer.getDefinitionExpression()});
ca.showModal("true");f.default.once(ca,"hide",function(ka){ca.destroyRecursive()})};wa.prototype._showCalculateFieldDialog=function(aa){var ca=this,ka=this.layer,qa=this.table,da=this.css;aa=aa||this._activeFieldInfo;var ia=this._calcField,ra=this._calcDialog;ia&&ra?(ia.reset(),ia.set({layer:ka,field:aa.name}),ra.show()):(ia=new E.default({layer:ka,field:aa.name,css:{closeButton:da.calcCloseButton,clearIcon:da.calcClearIcon,validateIcon:da.calcValidateIcon},showHeader:!1},w.default.create("div")),
ia.startup(),ra=D.default.generateDialog({title:ba.default.calculateFields.calculateField,content:ia,css:{dialog:da.calcFieldDialog}}),ia.on("calculate-success",function(Fa){ca._updateLayerDataOrSchemaUpdatedDate("data");ca._fieldViewActive&&ca._updateFieldView({fieldInfo:ca._activeFieldInfo});qa.refresh()}),ia.on("close",function(){ra.hide()}),this._calcDialog=ra,this._calcField=ia);ra.show()};wa.prototype._showDeleteMultipleFieldDialog=function(aa){var ca=this,ka=this.i18n.deleteWarningDlg.deleteWarningDlgTitle;
if(aa){var qa=l.default.substitute(this.i18n.deleteWarningDlg.confirmDeleteMultipleFields,[aa.length]);N.default.createConfirmationDialog({strings:{title:ka,description:qa,ok:ka},okColor:"red",autoCloseOnOk:!0,onOk:function(){ca._deleteField(null,aa)}})}};wa.prototype._showDeleteFieldDialog=function(aa){var ca=this,ka=aa||this._activeFieldInfo;aa=ba.default.calculateFields.deleteField;if(ka){var qa=l.default.substitute(ba.default.calculateFields.deleteFieldConfirm,{field:ka.alias||ka.name});N.default.createConfirmationDialog({strings:{title:aa,
description:qa,ok:aa},okColor:"red",autoCloseOnOk:!0,onOk:function(){ca._deleteField(ka)}})}};wa.prototype._deleteField=function(aa,ca){var ka=this,qa=this.layer,da=this.item,ia={f:"json",token:void 0,deleteFromDefinition:void 0},ra="".concat(qa.url.replace("/rest/services","/rest/admin/services"),"/deleteFromDefinition"),Fa=L.default.getToken(),ea=[],xa;Fa&&(ia.token=Fa);Fa=!1;ca?(ca.forEach(function(Ra){ea.push({name:Ra.name})}),Fa=ca.some(function(Ra){return ka._isDisplayField(Ra,ka.layer)})):
(ea.push({name:aa.name}),Fa=this._isDisplayField(aa,this.layer));var ta={fields:ea};Fa&&(ta.displayField="");ia.deleteFromDefinition=b.default.toJson(ta);var Ba=Z.default.prototype.statics.getInstance();Ba.show({title:this.i18n.common.save,message:l.default.substitute(this.i18n.viewer.mapUtil.savingProps,{title:da.title}),reference:"updateFeatureService"});var Na;(0,m.default)({url:ra,content:ia},{usePost:!0}).then(function(Ra){(0,m.default)({url:qa.url,content:{f:"json"},callbackParamName:"callback"}).then(function(Ca){Na=
Ca;ka.item.set("maxAgeCheck",!0);qa.fields=Na.fields;ka._fieldViewActive&&ka._hideFieldView();return ka._updateItemData()}).then(function(){var Ca,H=ka._hasPopupInfo(qa);H&&(xa=ka._getPopupInfo(qa),ca?ca.forEach(function(W){xa.fieldInfos=xa.fieldInfos.filter(function(ha){return ha.fieldName!==W.name})}):xa.fieldInfos=xa.fieldInfos.filter(function(W){return W.fieldName!==aa.name}));-1!==["Feature Layer","Table"].indexOf(qa.type)?(H={layer:qa,url:ka.item.url,serviceInfo:Na,itemCard:da,itemId:da.id,
popupInfo:xa,popupChanged:H,featureTemplatesChanged:!0},G.default.updateTypesAndTemplatesOnLayer(H.layer),H.featureTemplatesChanged=!0,(null===(Ca=H.serviceInfo.templates)||void 0===Ca?0:Ca.length)?H.serviceInfo.templates.forEach(function(W){ca?ca.forEach(function(ha){delete W.prototype.attributes[ha.name]}):delete W.prototype.attributes[aa.name]}):H.serviceInfo.types.forEach(function(W){W.templates.forEach(function(ha){ca?ca.forEach(function(na){delete ha.prototype.attributes[na.name]}):delete ha.prototype.attributes[aa.name]})}),
y.default.updateFeatureServiceAfterAddRemoveField(H,ka._reloadTable.bind(ka))):(ka._reloadTable(),Ba.hide("updateFeatureService"));ka._updateLayerDataOrSchemaUpdatedDate("schema")},function(Ca){ka._showError({message:Ca.toString()})})},function(Ra){ka._showError({message:Ra.toString()})})};wa.prototype._canEditData=function(){var aa,ca,ka,qa,da,ia,ra,Fa,ea=this.item,xa=this.portalUser,ta=-1!==(null===(ca=null===(aa=ea.serviceInfo)||void 0===aa?void 0:aa.capabilities)||void 0===ca?void 0:ca.indexOf("Editing"));
aa=-1!==(null===(qa=null===(ka=ea.serviceInfo)||void 0===ka?void 0:ka.capabilities)||void 0===qa?void 0:qa.indexOf("Update"));qa=!xa;ca=!qa&&!(null===xa||void 0===xa?0:xa.isOrgUser);ka=null===xa||void 0===xa?void 0:xa.isOrgUser;var Ba=null===(da=null===xa||void 0===xa?void 0:xa.userRole)||void 0===da?void 0:da.canEditFeaturesFullControl();da=null===(ia=null===xa||void 0===xa?void 0:xa.userRole)||void 0===ia?void 0:ia.canEditFeatures();ia=!(null===(ra=ea.itemControl)||void 0===ra||!ra.includes("admin"));
ra=!(null===(Fa=ea.itemControl)||void 0===Fa||!Fa.includes("update"));Fa=ta&&aa&&(qa||ca||ka&&(ea.isHostedService?Ba||da:da))||ta&&ka&&ea.isHostedService;ta&&!aa&&ka&&ea.isHostedService&&!ia&&(!da||da&&!ra)&&(Fa=!1);return ea.isHostedService?ea.canUpdate||Fa:Fa};wa.prototype._canAddField=function(){var aa,ca,ka=this.layer,qa=this.item,da=this._userIsOwner||this._userIsAdmin&&qa.isOwnedByMyOrg||qa.canUpdate&&qa.canEditService;ka="Feature Layer"===ka.type||"Table"===ka.type;var ia=qa.isFeatureCollection,
ra=0<(null===(aa=qa.relTileLayers)||void 0===aa?void 0:aa.length);aa=qa.isMultipatchFeatureService;var Fa=!1!==(null===(ca=qa.serviceInfo)||void 0===ca?void 0:ca.sourceSchemaChangesAllowed);return da&&ka&&!ia&&!this._isViewServiceLayer(qa)&&!this.item.isLocationTrackingService&&!ra&&this._isHostedServiceLayer(qa)&&!aa&&Fa};wa.prototype._canCalculateField=function(aa){var ca=this.layer,ka=this.item,qa=this._userIsOwner||this._userIsAdmin&&ka.isOwnedByMyOrg,da="Feature Layer"===ca.type||"Table"===ca.type,
ia=ka.isFeatureCollection,ra=ka.relTileLayers&&0<ka.relTileLayers.length;aa=aa.editable&&-1===this._uneditableFieldTypes.indexOf(aa.type);var Fa=this._isSpatioTemporalService(ka);return qa&&ca.supportsCalculate&&da&&!ia&&aa&&!ra&&this._isHostedServiceLayer(ka)&&!Fa};wa.prototype._canArcadeCalculateField=function(aa){var ca,ka,qa;this._serviceInfo=(null===(ca=this.item)||void 0===ca?void 0:ca.serviceInfo)||{};this._adminServiceInfo=(null===(ka=this.item)||void 0===ka?void 0:ka.adminServiceInfo)||{};
this._capabilities=(null===(qa=this.item)||void 0===qa?0:qa.isPortal)&&!this.item.isSDS?fa.default.stringToArray(this._serviceInfo.capabilities,",",!0):fa.default.stringToArray(this._adminServiceInfo.capabilities||"",",",!0);this._changeTrackingEnabled=Y.default.includes(this._capabilities,"ChangeTracking");ca=Y.default.includes(this._capabilities,"Uploads");ca=!this.page.portal.isPortal||ca;this._syncEnabled=this._serviceInfo.syncEnabled||!1;return this._canCalculateField(aa)&&!this._syncEnabled&&
!this._changeTrackingEnabled&&ca&&!this.newFieldTypesExist};wa.prototype._canEditUniqueIndex=function(aa){aa=aa.editable&&-1===this._uneditableFieldTypes.indexOf(aa.type);return this._isHostedServiceLayer(this.item)&&!this.page.portal.isPortal&&!this._isViewServiceLayer(this.item)&&!this.item.isLocationTrackingService&&aa&&(this._userIsOwner||this._userIsAdmin)};wa.prototype._canDeleteField=function(aa){var ca=this.page.portal.isPortal&&this._isSpatioTemporalService(this.item);return this._canDeleteOrEditableField(aa)&&
!this._isViewServiceLayer(this.item)&&!ca};wa.prototype._canFieldEditableProp=function(aa){return this._canDeleteOrEditableField(aa)?aa.nullable?!0:aa.defaultValue?!0:!1:!1};wa.prototype._canDeleteOrEditableField=function(aa){var ca,ka,qa,da=this.layer,ia=this.item,ra=this._userIsOwner||this._userIsAdmin&&ia.isOwnedByMyOrg||ia.canUpdate&&ia.canEditService,Fa=0<(null===(ca=ia.relTileLayers)||void 0===ca?void 0:ca.length);ca=!0;-1!==this._uneditableFieldTypes.indexOf(aa.type)?ca=!1:da.objectIdField===
aa.name?ca=!1:!da.renderer||da.renderer.attributeField!==aa.name&&da.renderer.normalizationField!==aa.name?!da.timeInfo||da.timeInfo.startTimeField!==aa.name&&da.timeInfo.endTimeField!==aa.name&&da.timeInfo.trackIdField!==aa.name?!da.editFieldsInfo||da.editFieldsInfo.creationDateField!==aa.name&&da.editFieldsInfo.creatorField!==aa.name&&da.editFieldsInfo.editDateField!==aa.name&&da.editFieldsInfo.editorField!==aa.name?da.getDefinitionExpression()&&-1!==da.getDefinitionExpression().search(aa.name)?
ca=!1:Fa?ca=!1:0<(null===(ka=da.labelingInfo)||void 0===ka?void 0:ka.length)&&(ca=!this._isUsedByLabel({fieldInfo:aa,labelingInfo:da.labelingInfo})):ca=!1:ca=!1:ca=!1;if("Feature Layer"!==da.type&&"Table"!==da.type||this.item.isLocationTrackingService||ia.isFeatureCollection||!this._isHostedServiceLayer(ia))ca=!1;!1===(null===(qa=ia.serviceInfo)||void 0===qa?void 0:qa.sourceSchemaChangesAllowed)&&(ca=!1);return ra&&ca};wa.prototype._isDisplayField=function(aa,ca){return aa.name&&aa.name===ca.displayField};
wa.prototype._isUsedByLabel=function(aa){var ca=aa.fieldInfo,ka=!1;aa.labelingInfo.forEach(function(qa){var da,ia;if(qa){var ra=ya.default.extractFieldNames(null===(da=qa.labelExpressionInfo)||void 0===da?void 0:da.expression);da=ya.default.extractFieldNames(null===(ia=qa.labelExpressionInfo)||void 0===ia?void 0:ia.value);qa=ya.default.extractFieldNames(qa.labelExpression);if(-1<ra.indexOf(ca.name)||-1<da.indexOf(ca.name)||-1<qa.indexOf(ca.name))ka=!0}});return ka};wa.prototype.refreshTable=function(){this._reloadTable()};
wa.prototype.updateLayerDataOrSchemaUpdatedDate=function(aa){this._updateLayerDataOrSchemaUpdatedDate(aa)};wa.prototype.getPopupInfo=function(aa){return this._getPopupInfo(aa.layer)};wa.prototype._hasPopupInfo=function(aa){var ca=aa.id||aa.layerId||0,ka=!1;this.layerInfos.forEach(function(qa){qa.id===ca&&qa.popupInfo&&(ka=!0)});return ka};wa.prototype._getPopupInfo=function(aa){var ca=aa.id||aa.layerId||0,ka=null;this.layerInfos.filter(function(qa){qa.id===ca&&(ka=qa.popupInfo)});return ka||U.default.getPopupInfo(aa)};
wa.prototype.getDefaultPopupInfo=function(aa){return U.default._getDefaultPopupInfo(aa)};wa.prototype._updateItemData=function(){var aa=this,ca=new x.default;this._hasPopupInfo(this.layer)?L.default.request({url:this.item.itemDataUrl}).then(function(ka){aa.item.itemData=ka;aa.layerInfos=ka.layers;ca.resolve()}):ca.resolve();return ca};return wa=p.__decorate([(0,sa.default)(A.default,B.default,a.default)],wa)}()})},"esri/dijit/CalculateField":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/kernel dojo/_base/fx dojo/has dojo/json dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/_base/event dojo/Evented dojo/fx/easing dojo/store/Memory dojo/mouse dojo/on dojo/topic dojo/_base/window dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/Button dijit/form/CheckBox dijit/form/Form dijit/form/Select dijit/form/MultiSelect dijit/form/TextBox dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/layout/ContentPane dijit/form/ComboBox dijit/Dialog dijit/Tooltip dgrid/OnDemandList dgrid/Selection dgrid/Keyboard dgrid/extensions/DijitRegistry dgrid/util/mouse put-selector/put ../kernel ../lang ../request ./SingleFilter ./ExpressionEditor dojo/i18n!../nls/jsapi dojo/text!./templates/CalculateField.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U,M,Q,Y,fa,va,Aa,pa,N,V,Z,ba,ma,sa,Ea,ya,wa,aa){var ca=e([va,pa,Aa,N]),ka={base:"esriCalcField",titleLabel:"esriCalcTitleLabel",selectField:"esriCalcSelField",expressionBox:"esriExprBox",actionBtnContainer:"esriActionButtonCtr",validateIcon:"esriCalcFieldValidateIcon",validateDisabledIcon:"esriCalcFieldValidateDisabledIcon",actionButton:"esriActionButton",clearIcon:"esriCalcFieldClearIcon",clearDisabledIcon:"esriCalcFieldClearDisabledIcon",
fieldFunctionContainer:"esriCalcFieldFuncCtr",fieldContainer:"esriCalcFieldCtr",functionContainer:"esriCalcFuncCtr",fieldLabelDiv:"esriFieldsLabelDiv",functionLabelDiv:"esriFunctionLabelDiv",fieldListContainer:"esriCalcFieldsList",functionListContainer:"esriCalcFunctionList",fieldTypeContainer:"esriFieldsSelectionCtr",loadingIcon:"esriLoadingLarge",formWarning:"esriFormWarning",formSuccess:"esriFormSuccess",addButton:"",closeButton:"",actionDividerLine:"esriActionDividerLine",titleDividerLine:"esriTitleDivideLine",
actionCtr:"esriCalcFieldActionCtr"},qa=e([P,R,S,T,E,w],{declaredClass:"esri.dijit.CalculateField",templateString:aa,widgetsInTemplate:!0,showSelectField:!1,showHeader:!0,closeOnAdd:!0,addButtonClass:"",closeButtonClass:"",_showMsgTimerInterval:3E3,showHelp:!1,expressionBoxRows:4,expressionBoxCols:2,baseClass:ka.base,constructor:function(da){da.containerNode&&(this.container=da.containerNode);this._css=K.mixin(ka,da.css);this.expressionMode=ma.isDefined(da.expressionMode)?da.expressionMode:qa.MODE_SQL;
this.fieldId=da.fieldId;this.arcadeProfile=da.arcadeProfile;this.arcadeProfileType=da.arcadeProfileType},destroy:function(){this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments);this.i18n={};K.mixin(this.i18n,wa.common);K.mixin(this.i18n,wa.calculateFields);this.calculateLabel||(this.calculateLabel=this.i18n.calculate)},postCreate:function(){this.inherited(arguments);if(this.expressionMode===qa.MODE_ARCADE)this._loadArcadeUIEvents(),this._buildArcadeEditorUI();else{var da=
["ar","he"],ia;for(ia=0;ia<da.length;ia+=1){var ra=da[ia];m.locale&&-1!==m.locale.indexOf(ra)&&(-1!==m.locale.indexOf("-")?-1!==m.locale.indexOf(ra+"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0)}this._buildUI();this._loadEvents();this.onlineHelpMap={};l.set(this._helpNode,"display",this.showHelp?"block":"none");this.helpUrl&&h.set(this._helpurlNode,"href",this.helpUrl);this.validate()}},_loadArcadeUIEvents:function(){K.mixin(this.i18n,wa.expressionEditor);this.own(this.watch("layer",K.hitch(this,
this._buildArcadeEditorUI)))},_deleteArcadeEditorUI:function(){this.expressionEditor&&this._destroyArcadeUI()},_buildArcadeEditorUI:function(){this._deleteArcadeEditorUI();var da=this.expressionMode===qa.MODE_ARCADE;l.set(this._expressionForm,"display",da?"none":"block");l.set(this._headerPane.domNode,"display",da?"none":"block");l.set(this._arcadeExpressionEditorDlg,"display",da?"block":"none");this.expressionEditorCommitHandler=A.subscribe("expression-commit",K.hitch(this,function(ia){this.set("expression",
ia.expression);this.emit("expression-add",ia);this._close()}));this.expressionEditorCancelHandler=A.subscribe("expression-cancel",K.hitch(this,function(){this._close()}));ma.isDefined(this.fieldId)||(this.fieldId="$feature");this.expressionEditor=new ya({arcadeEditor:this.arcadeEditor,map:this.map,mapLayer:{layer:this.layer,popupInfo:this.layer.infoTemplate?this.layer.infoTemplate.toJson():null},layer:this.layer,expression:this.get("expression"),captureTitle:!1,fieldId:this.fieldId,arcadeProfile:this.arcadeProfile,
arcadeProfileType:this.arcadeProfileType,showViewScale:!1},f.create("div",null,this._arcadeExpressionEditorDlg));this.expressionEditor.startup();this.own(this.watch("arcadeProfile",K.hitch(this,function(){this.expressionEditor.set("arcadeProfile",this.get("arcadeProfile"))})))},_destroyArcadeUI:function(){this.expressionEditorCommitHandler&&this.expressionEditorCommitHandler.remove();this.expressionEditorCommitHandler=null;this.expressionEditorCancelHandler&&this.expressionEditorCancelHandler.remove();
this.expressionEditorCancelHandler=null;this.expressionEditor&&this.expressionEditor.destroy();this.expressionEditor=null;this.expression&&(this.expression=null)},_buildUI:function(){var da=[];l.set(this._header,"display",this.showHeader?"block":"none");l.set(this._selCalcFieldDiv,"display",this.showSelectField?"block":"none");if(this.field){var ia=p.filter(this.layer.fields,function(ra){return ra.name===this.field},this);this._calcField=ia=ia[0];h.set(this._calcFieldLabel,"innerHTML",d.substitute(this.i18n.exprLabel,
{fieldName:ia?ia.name:this.field}))}if(!this.helperMethods||this.helperMethods&&0===this.helperMethods.length)ia=this._labelFormatter.bind(this),ia=[{type:"NumType",label:ia({functionName:"ABS(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.absFunc,functionParams:[{name:"number",label:this.i18n.commonNumberParamDesc}]}),name:"ABS()"},{type:"NumType",label:ia({functionName:"CAST(\x3ci\x3eexpression\x3c/i\x3e AS FLOAT|INT)",functionDesc:this.i18n.castFunc,functionParams:[{name:"expression",label:this.i18n.castParam1Desc},
{name:"FLOAT",label:this.i18n.castParam2Desc},{name:"INT",label:this.i18n.castParam3Desc}]}),name:"CAST()"},{type:"NumType",label:ia({functionName:"CEILING(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.ceilingFunc,functionParams:[{name:"number",label:this.i18n.ceilingParamDesc}]}),name:"CEILING()"},{type:"NumType",label:ia({functionName:"COS(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.cosFunc,functionParams:[{name:"number",label:this.i18n.trignomParamDesc}]}),name:"COS()"},{type:"NumType",
label:ia({functionName:"FLOOR(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.floorFunc,functionParams:[{name:"number",label:this.i18n.floorParamDesc}]}),name:"FLOOR()"},{type:"NumType",label:ia({functionName:"LOG(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.logFunc,functionParams:[{name:"number",label:this.i18n.commonNumberParamDesc}]}),name:"LOG()"},{type:"NumType",label:ia({functionName:"LOG10(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.log10Func,functionParams:[{name:"number",
label:this.i18n.commonNumberParamDesc}]}),name:"LOG10()"},{type:"NumType",label:ia({functionName:"MOD(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3en\x3c/i\x3e)",functionDesc:this.i18n.modFunc,functionParams:[{name:"number",label:this.i18n.modParam1Desc},{name:"n",label:this.i18n.modParam2Desc}]}),name:"MOD(,)"},{type:"NumType",label:ia({functionName:"NULLIF(\x3ci\x3enumber\x3c/i\x3e,\x3ci\x3evalue\x3c/i\x3e)",functionDesc:this.i18n.nullifFunc,functionParams:[{name:"number",label:this.i18n.commonNumberParamDesc},
{name:"value",label:this.i18n.commonNumberParamDesc}]}),name:"NULLIF(,)"},{type:"NumType",label:ia({functionName:"POWER(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3ey\x3c/i\x3e)",functionDesc:this.i18n.powerFunc,functionParams:[{name:"number",label:this.i18n.powerParam1Desc},{name:"y",label:this.i18n.powerParam2Desc}]}),name:"POWER(,)"},{type:"NumType",label:ia({functionName:"ROUND(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3elength\x3c/i\x3e)",functionDesc:this.i18n.roundFunc,functionParams:[{name:"number",label:this.i18n.roundParam1Desc},
{name:"length",label:this.i18n.roundParam2Desc}]}),name:"ROUND(,)"},{type:"NumType",label:ia({functionName:"SIN(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.sinFunc,functionParams:[{name:"number",label:this.i18n.trignomParamDesc}]}),name:"SIN()"},{type:"NumType",label:ia({functionName:"TAN(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.tanFunc,functionParams:[{name:"number",label:this.i18n.trignomParamDesc}]}),name:"TAN()"},{type:"NumType",label:ia({functionName:"TRUNCATE(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3edecimal_place\x3c/i\x3e)",
functionDesc:this.i18n.truncateFunc,functionParams:[{name:"number",label:this.i18n.truncateParam1Desc},{name:"decimal_place",label:this.i18n.truncateParam2Desc}]}),name:"TRUNCATE(,)"},{type:"StrType",label:ia({functionName:"CHAR_LENGTH(\x3ci\x3estring\x3c/i\x3e)",functionDesc:this.i18n.char_lengthFunc,functionParams:[{name:"string",label:this.i18n.char_lengthParamDesc}]}),name:"CHAR_LENGTH()"},{type:"StrType",label:ia({functionName:"CONCAT(\x3ci\x3estring1\x3c/i\x3e, \x3ci\x3estring2\x3c/i\x3e)",
functionDesc:this.i18n.concatFunc,functionParams:[{name:"string1",label:this.i18n.concatParam1Desc},{name:"string2",label:this.i18n.concatParam2Desc}]}),name:"CONCAT(,)"},{type:"StrType",label:ia({functionName:"POSITION(\x3ci\x3esubstring\x3c/i\x3e, \x3ci\x3estring\x3c/i\x3e)",functionDesc:this.i18n.positionFunc,functionParams:[{name:"substring",label:this.i18n.positionParam1Desc},{name:"string",label:this.i18n.positionParam2Desc}]}),name:"POSITION(,)"},{type:"StrType",label:ia({functionName:"LOWER(\x3ci\x3estring\x3c/i\x3e)",
functionDesc:this.i18n.lowerFunc,functionParams:[{name:"string",label:this.i18n.lowerParamDesc}]}),name:"LOWER()"},{type:"StrType",label:ia({functionName:"SUBSTRING(\x3ci\x3estring\x3c/i\x3e, \x3ci\x3estart\x3c/i\x3e, \x3ci\x3elength\x3c/i\x3e)",functionDesc:this.i18n.substringFunc,functionParams:[{name:"string",label:this.i18n.substrParam1Desc},{name:"start",label:this.i18n.substrParam2Desc},{name:"length",label:this.i18n.substrParam3Desc}]}),name:"SUBSTRING(,,)"},{type:"StrType",label:ia({functionName:"TRIM(BOTH|LEADING|TRAILING \u2018 \u2018 FROM string)",
functionDesc:this.i18n.trimFunc,functionParams:[{name:"BOTH",label:this.i18n.trimBothDesc},{name:"LEADING",label:this.i18n.trimLeadingDesc},{name:"TRAILING",label:this.i18n.trimTrailingDesc},{name:"string",label:this.i18n.trimParamDesc}]}),name:"TRIM()"},{type:"StrType",label:ia({functionName:"UPPER(\x3ci\x3estring\x3c/i\x3e)",functionDesc:this.i18n.upperFunc,functionParams:[{name:"string",label:this.i18n.upperParamDesc}]}),name:"UPPER()"},{type:"DateType",label:ia({functionName:"CURRENT_DATE()",
functionDesc:this.i18n.current_dateFunc}),name:"CURRENT_DATE()"},{type:"DateType",label:d.substitute(this.i18n.current_timeFunc,{functionName:"CURRENT_TIME()"}),name:"CURRENT_TIME()"},{type:"DateType",label:d.substitute(this.i18n.current_timestampFunc,{functionName:"CURRENT_TIMESTAMP()"}),name:"CURRENT_TIMESTAMP()"},{type:"DateType",label:ia({functionName:"EXTRACT(unit FROM date)",functionDesc:this.i18n.extractFunc,functionParams:[{name:"unit",label:this.i18n.extractUnitDesc},{name:"date",label:this.i18n.extractDataDesc}]}),
name:"EXTRACT()"}],p.forEach(ia,function(ra){ra.label="\x3cb\x3e"+ra.label.substring(0,ra.label.indexOf(":")+1)+"\x3c/b\x3e\x3cbr/\x3e "+ra.label.substring(ra.label.indexOf(":")+1)},this),this.set("helperMethods",ia);(!this.operators||this.operators&&0===this.operators.length)&&this.set("operators","+-/*()".split(""));this._operatorBtns=[];p.forEach(this.operators,function(ra){this._operatorBtns.push(new F({value:ra,label:ra,style:{width:"4em"},onClick:K.hitch(this,this._updateExpression,{value:ra,
type:"operator"})},f.create("div",null,this._operatorCtr)))},this);this.layer&&this.layer.fields&&0<this.layer.fields.length&&(da=this._createIds(this.layer.fields),ia=p.map(this.layer.fields,function(ra){return{label:ra.name,value:ra.name}}),this._selCalcField.addOption(ia),this._selCalcField.set("value",this.field));this.fieldsStore=new v({data:da});this.attributeList=new ca({renderRow:K.hitch(this,this._renderAttributesRow),selectionMode:"single",store:this.fieldsStore},this._attributeListCtr);
da=this._createIds(this.get("helperMethods"));this.operatorStore=new v({data:da});this.helpersList=new ca({renderRow:K.hitch(this,this._renderOperatorRow),selectionMode:"single",store:this.operatorStore},this._helpersListCtr)},_loadEvents:function(){this.own(this.watch("fields",K.hitch(this,this._handleFieldsChange)),this.watch("field",K.hitch(this,this._handleFieldChange)));this.showSelectField&&this.own(this._selCalcField.on("change",K.hitch(this,this._handleSelcCalFieldChange)));this.own(this._expressionForm.watch("value",
K.hitch(this,this._handleHelperTypeChange)),this._expressionForm.on("focus",K.hitch(this,this._setfocus)),this._exprBox.watch("value",K.hitch(this,this._handleExpChange)),this.attributeList.on("dgrid-select",K.hitch(this,function(da){this._updateExpression({value:da.rows[0].data,type:"field"})})),this.helpersList.on("dgrid-select",K.hitch(this,function(da){this._updateExpression({value:da.rows[0].data,type:"helper"})})),this.attributeList.on(V.enterRow,K.hitch(this,function(da){da=this.attributeList.row(da);
var ia=da.data.alias||da.data.name;var ra="";ra=this._getTypeLabel(da.data.type);this._showTooltip(da.element,"\x3cb\x3e"+ia+"\x3c/b\x3e: "+ra)})),this.attributeList.on(V.leaveRow,K.hitch(this,function(da){da=this.attributeList.row(da);this._hideTooltip(da.element)})),this.helpersList.on(V.enterRow,K.hitch(this,function(da){da=this.helpersList.row(da);this._showTooltip(da.element,da.data.label)})),this.helpersList.on(V.leaveRow,K.hitch(this,function(da){da=this.helpersList.row(da);this._hideTooltip(da.element)})),
this.attributeList.on("dgrid-refresh-complete",K.hitch(this,this._setfocus)),this.helpersList.on("dgrid-refresh-complete",K.hitch(this,this._setfocus)),this._exprBox.on("blur",K.hitch(this,function(){this._exprBox.textbox.setSelectionRange&&"number"==typeof this._exprBox.textbox.selectionStart?this._exprBox.set("cursorPosition",[this._exprBox.textbox.selectionStart,this._exprBox.textbox.selectionEnd]):this._exprBox.set("cursorPosition",this._getCursorRange(this._exprBox.textbox))})),this._exprBox.on("focus",
K.hitch(this,function(){var da=this._exprBox.get("cursorPosition");da&&(this._exprBox.textbox.setSelectionRange&&"number"==typeof this._exprBox.textbox.selectionStart?this._exprBox.textbox.setSelectionRange(da[1],da[1]):this._setCaretPosition(this._exprBox.textbox,da[1],da[1]))})),z(this._calcFieldLabel,x.enter,K.hitch(this,function(da){da="";da=this._getTypeLabel(this._calcField.type);this._showTooltip(this._calcFieldLabel,"\x3cb\x3e"+this._calcField.alias+"\x3c/b\x3e: "+da)})),z(this._calcFieldLabel,
x.leave,K.hitch(this,function(da){this._hideTooltip(this._calcFieldLabel)})))},startup:function(){this.inherited(arguments);this.expressionMode===qa.MODE_SQL&&(this.attributeList.startup(),this.helpersList.startup(),this.set("helperType",this.helperType))},reset:function(){ba.show(this.domNode);this.expressionMode===qa.MODE_SQL?(this._expressionForm.reset(),this._handleCloseMsg(),this.set("helperType",this.helperType)):this._buildArcadeEditorUI()},_close:function(){this.emit("close",{});ba.hide(this.domNode);
this._deleteArcadeEditorUI()},_createIds:function(da){var ia=[];da&&0<da.length&&(ia=p.map(da,function(ra,Fa){return K.mixin(ra,{id:Fa})}));return ia},_renderAttributesRow:function(da){var ia=f.create("div",{"class":"esriCalExpRowOuter"}),ra=f.create("div",{"class":"esriCalcExpLabelRow"},ia);f.create("div",{"class":"esriCalcFieldTextTrimWithEllipses",innerHTML:da.name},ra);return ia},_renderOperatorRow:function(da){var ia=f.create("div",{"class":"esriCalExpRowOuter"}),ra=f.create("div",{"class":"esriCalcExpLabelRow"},
ia);f.create("div",{"class":"esriCalcFieldTextTrimWithEllipses",innerHTML:da.name},ra);return ia},_handleFieldsChange:function(da,ia,ra){da=[];this.layer&&this.layer.fields&&0<this.layer.fields.length&&(0<this._selCalcField.getOptions().length&&this._selCalcField.removeOption(this._selCalcField.getOptions()),da=this._createIds(this.layer.fields),ia=p.map(this.layer.fields,function(Fa){return{label:Fa.name,value:Fa.name}}),this._selCalcField.addOption(ia),this._selCalcField.set("value",this.field));
this.fieldsStore=new v({data:da});this.attributeList.set("store",this.fieldsStore)},_handleFieldChange:function(da,ia,ra){h.set(this._calcFieldLabel,"innerHTML",d.substitute(this.i18n.exprLabel,{fieldName:ra}));this.set("helperType",this.helperType);this._setfocus()},_setHelperTypeAttr:function(da){if(da)this.helperType=da;else if(this.field){var ia=p.filter(this.layer.fields,function(ra){return ra.name===this.field},this);(this._calcField=ia=ia[0])&&-1!==p.indexOf(["esriFieldTypeDate","esriFieldTypeDateOnly",
"esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"],ia.type)?da="date":ia&&"esriFieldTypeString"===ia.type?da="string":ia&&-1!==p.indexOf(["esriFieldTypeBigInteger","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],ia.type)&&(da="numeric")}else da="string";"string"===da?this._strRadioBtn.set("checked",!0):"numeric"===da?this._numRadioBtn.set("checked",!0):"date"===da&&this._dateRadioBtn.set("checked",!0)},_handleHelperTypeChange:function(da,ia,ra){this.helpersList.set("query",
{type:ra.functionType});"DateType"===ra.functionType?this.attributeList.set("query",function(Fa){return-1!==p.indexOf(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"],Fa.type)}):"StrType"===ra.functionType?this.attributeList.set("query",{type:"esriFieldTypeString"}):"NumType"===ra.functionType&&this.attributeList.set("query",function(Fa){return-1!==p.indexOf(["esriFieldTypeBigInteger","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle",
"esriFieldTypeDouble"],Fa.type)});this.helpersList.refresh();this.attributeList.refresh()},_handleSelcCalFieldChange:function(da){this.set("field",da)},_handleRemoveBtnClick:function(){this._exprBox.set("value","");this._setfocus()},_handleAddButtonClick:function(da){t.stop(da);var ia={f:"json"},ra;this._exprBox.get("value")?(this._handleCloseMsg(),ia.calcExpression=g.toJson(this.get("expression")),ia.sqlFormat="standard",this.layer.supportsASyncCalculate&&(ia.async=!0),this.layer.getDefinitionExpression&&
this.layer.getDefinitionExpression()?ia.where=this.layer.getDefinitionExpression():ma.isDefined(this.layer.definitionExpression)&&""!==this.layer.definitionExpression&&(ia.where=this.layer.definitionExpression),ba.id.getCredential(this.layer.url+"/calculate").then(K.hitch(this,function(Fa){ia.token=Fa.token;ra=sa({url:this.layer.url+"/calculate",content:ia},{usePost:!0});this.emit("calculate-start",{calcPromise:ra.promise});this._addBtn.set("disabled",!0);this._showLoading();ra.then(K.hitch(this,
function(ea){this._checkStatus(ea).then(K.hitch(this,function(xa){this._addBtn.set("disabled",!1);this._hideLoading();var ta={};K.mixin(ta,{calcExpression:g.fromJson(ia.calcExpression)[0].sqlExpression,where:ia.where,sqlFormat:ia.sqlFormat},xa);this.emit("calculate-success",ta);this.layer.refresh();q.toggle(this._errorMessagePane,this._css.formSuccess,!0);this._showMessages(d.substitute(this.i18n.successMsg,{count:xa.updatedFeatureCount||xa.recordCount}),!0);this.closeOnAdd&&this._close()}))}),K.hitch(this,
this._handleErrorResponse))}),K.hitch(this,this._handleErrorResponse))):this._addBtn.set("disabled",!0)},_checkStatus:function(da,ia,ra){var Fa=da&&da.statusUrl,ea=ra||new J,xa=ia||500;ra={f:"json"};this.layer.supportsASyncCalculate?sa({url:Fa,content:ra},{usePost:!0}).then(K.hitch(this,function(ta){ta=ta||{status:"completed"};var Ba=ta.status;Ba&&"completed"===Ba.toLowerCase()?ea.resolve(ta):Ba&&"failed"===Ba.toLowerCase()||400<ta.code||""===Ba?this._handleErrorResponse(ta):(xa+=250,setTimeout(K.hitch(this,
function(){this._checkStatus(da,xa,ea)}),ia))}),K.hitch(this,function(ta){this._handleErrorResponse(ta)})):ea.resolve(da);return ea},_handleErrorResponse:function(da){this._addBtn.set("disabled",!1);this._hideLoading();this.emit("calculate-error",da);q.toggle(this._errorMessagePane,this._css.formSuccess,!1);this._showMessages(d.substitute(this.i18n.exprFailedMsg,{expr:this._exprBox.get("value")})+"\x3cbr/\x3e"+(da.details||da.description).toString())},_handleCloseButtonClick:function(da){t.stop(da);
this._close()},_showTooltip:function(da,ia){ia=f.create("label",{innerHTML:ia,className:"esriSmallFont",dir:"ltr"});this._isRightToLeft?fa.show(ia.outerHTML,da,["after"],!0):fa.show(ia.outerHTML,da,["after"])},_hideTooltip:function(da,ia){fa.hide(da)},_setfocus:function(){this._exprBox.focus()},_showMessages:function(da,ia){h.set(this._bodyNode,"innerHTML",da);n.fadeIn({node:this._errorMessagePane,easing:u.quadIn,onEnd:K.hitch(this,function(){l.set(this._errorMessagePane,{display:""})})}).play();
ia&&window.setTimeout(K.hitch(this,this._handleCloseMsg),this._showMsgTimerInterval)},_handleCloseMsg:function(da){da&&da.preventDefault();"none"!==l.get(this._errorMessagePane,"display")&&n.fadeOut({node:this._errorMessagePane,easing:u.quadOut,onEnd:K.hitch(this,function(){l.set(this._errorMessagePane,{display:"none"})})}).play()},validate:function(){var da=!0;this.layer?this.field?this.layer.supportsCalculate?this.layer.userIsAdmin||this.layer.getEditCapabilities().canUpdate||(d.substitute(this.i18n.lyrUpdateCapMsg,
{layername:this.layer.name}),da=!1):(d.substitute(this.i18n.lyrSupportCalMsg,{layername:this.layer.name}),da=!1):da=!1:da=!1;this._addBtn.set("disabled",!da);return da},_validateExpObj:function(da){var ia=!0;da||(ia=!1);ia?this._handleCloseMsg():this._showMessages(void 0);return ia},_updateExpression:function(da){var ia=this._exprBox.get("cursorPosition"),ra=this._exprBox.get("value"),Fa="",ea=0,xa;if(this._validateExpObj(da)){this._exprStack||(this._exprStack=[]);0<this._exprStack.length&&(xa=this._exprStack[this._exprStack.length-
1]);ia&&ra||(ia=[0,0]);if("operator"===da.type){var ta=" "+da.value+" ";ea=ta.length}else"helper"===da.type?(ta=da.value.name,ea=-1!==da.value.name.indexOf(",")?da.value.name.indexOf(","):da.value.name.length-1):"field"===da.type&&(Fa=ma.isDefined(xa)&&"helper"===xa.type&&-1!==xa.value.name.indexOf("MOD")&&-1!==p.indexOf(["esriFieldTypeBigInteger","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle"],da.value.type),xa=ma.isDefined(xa)&&"helper"===xa.type&&-1!==xa.value.name.indexOf("MOD")&&
"esriFieldTypeDouble"===da.value.type,ta=this._calcField&&"esriFieldTypeDouble"===this._calcField.type&&!Fa&&-1!==p.indexOf(["esriFieldTypeBigInteger","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle"],da.value.type)?"CAST("+da.value.name+" AS FLOAT)":this._calcField&&-1!==p.indexOf(["esriFieldTypeBigInteger","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle"],this._calcField.type)&&xa?"CAST("+da.value.name+" AS INT)":da.value.name,ea=ta.length+1);Fa=ra.substring(0,
ia[0])+ta+ra.substring(ia[1]);this._exprBox.set("value",Fa);this._exprBox.focus();this._exprBox.textbox.setSelectionRange&&"number"==typeof this._exprBox.textbox.selectionStart?(this._exprBox.textbox.setSelectionRange(ia[0]+ea,ia[0]+ea),this._exprBox.set("cursorPosition",[ia[0]+ea,ia[0]+ea])):(this._setCaretPosition(this._exprBox.textbox,ia[0]+ea,ia[0]+ea),this._exprBox.set("cursorPosition",this._getCursorRange(this._exprBox.textbox)));this._setfocus();this._exprStack.push(da)}},_setCaretPosition:function(da,
ia,ra){da.setSelectionRange&&"number"==typeof da.selectionStart?da.setSelectionRange(ia,ra):"undefined"!=typeof da.createTextRange&&(da=da.createTextRange(),da.collapse(!0),da.moveEnd("character",ra),da.moveStart("character",ia),da.select())},_getCaretPosition:function(da){var ia=0;if(B.doc.selection)da.focus(),ia=B.doc.selection.createRange(),ia.moveStart("character",-da.value.length),ia=ia.text.length;else if(da.selectionStart||"number"==typeof da.selectionStart)ia=da.selectionStart;return ia},
_getCursorRange:function(da){if(da.setSelectionRange&&"number"==typeof da.selectionStart){var ia=da.selectionStart;var ra=da.selectionEnd}else"undefined"!=typeof da.createTextRange&&(ia=this._getCaretPosition(da),ra=this._getCaretPosition(da));return[ia,ra]},_handleExpChange:function(da,ia,ra){this._addBtn.set("disabled",!ra);this._validateBtn.set("disabled",!ra);this._removeBtn.set("disabled",!ra)},_handleValidationBtnClick:function(){var da={sql:this.field+" \x3d "+this._exprBox.get("value"),sqlType:"where",
f:"json"};da=sa({url:this.layer.url+"/validateSQL",content:da},{usePost:!0});this._addBtn.set("disabled",!0);this._validateBtn.set("disabled",!0);this._showLoading();da.then(K.hitch(this,function(ia){this._hideLoading();this._validateBtn.set("disabled",!1);this._addBtn.set("disabled",!ia.isValidSQL);if(ia.isValidSQL)q.toggle(this._errorMessagePane,this._css.formSuccess,!0),this._handleCloseMsg(),this._showMessages(wa.calculateFields.validExpression);else{if(ia.validationErrors&&0<ia.validationErrors.length){var ra=
"";p.forEach(ia.validationErrors,function(Fa){if(Fa.params&&wa.calculateFields.errorCodes[Fa.errorCode]){var ea={},xa;for(xa in Fa.params)Fa.params.hasOwnProperty(xa)&&(ea[xa]=Fa.params[xa]);ra+=d.substitute(wa.calculateFields.errorCodes[Fa.errorCode],ea)+"\x3cbr/\x3e"}else ra+=(wa.calculateFields.errorCodes[Fa.errorCode]||Fa.description)+"\x3cbr/\x3e"},this);this._showMessages(ra,!1)}else this._showMessages(wa.calculateFields.invalidExpression);q.toggle(this._errorMessagePane,this._css.formSuccess,
!1)}}),K.hitch(this,function(ia){this._hideLoading();this._validateBtn.set("disabled",!1);this._addBtn.set("disabled",!1)}))},_showLoading:function(){l.set(this._underlay,"display","block")},_hideLoading:function(){l.set(this._underlay,"display","none")},_getTypeLabel:function(da){if(-1!==p.indexOf(["esriFieldTypeBigInteger","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle"],da))var ia=this.i18n.integerLabel;else"esriFieldTypeDouble"===da?ia=this.i18n.doubleLabel:-1!==p.indexOf(["esriFieldTypeDate",
"esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"],da)?ia=this.i18n.dateLabel:"esriFieldTypeString"===da&&(ia=this.i18n.stringLabel);return ia},_labelFormatter:function(da){var ia=d.substitute(da.functionDesc,{functionName:da.functionName})+"\x3cbr/\x3e",ra=this._isRightToLeft;p.forEach(da.functionParams,function(Fa){ia=ra?ia+(Fa.label+" - \x3ci\x3e"+Fa.name+"\x3c/i\x3e\x3cbr/\x3e"):ia+("\x3ci\x3e"+Fa.name+"\x3c/i\x3e - "+Fa.label+"\x3cbr/\x3e")});return ia},_setLayerAttr:function(da){this._set("layer",
da);this._set("fields",da.fields)},_setFieldsAttr:function(da){this._set("fields",da)},_setFieldAttr:function(da){this._set("field",da)},_setHelperMethodsAttr:function(da){this._set("helperMethods",da)},_setOperatorsAttr:function(da){this._set("operators",da)},_setShowSelectFieldAttr:function(da){this._set("showSelectField",da)},_setShowHeaderAttr:function(da){this._set("showHeader",da)},_setCloseOnAddAttr:function(da){this._set("closeOnAdd",da)},_getExpressionAttr:function(){var da=this._exprBox.get("value");
if(da){da.split(" ");var ia=[];var ra={field:this.field};ra.sqlExpression=da;ia.push(ra);return this.expressionMode===qa.MODE_SQL?ia:this._exprBox&&this._exprBox.get("value")}this._addBtn.set("disabled",!0)},_setExpressionAttr:function(da){this._set("expression",da);this._exprBox&&this._exprBox.set("value",da)},_setAddButtonClassAttr:function(da){this._set("addButtonClass",da)},_setCloseButtonClassAttr:function(da){this._set("closeButtonClass",da)},_setExpressionBoxRowsAttr:function(da){this.expressionBoxRows=
da||4},_setExpressionBoxColsAttr:function(da){this.expressionBoxCols=da||2},_setArcadeEditorAttr:function(da){this.arcadeEditor=da},_setFieldIdAttr:function(da){this.fieldId=da},_setArcadeProfileAttr:function(da){this._set("arcadeProfile",da)},_setArcadeProfileTypeAttr:function(da){this._set("arcadeProfileType",da)}});K.mixin(qa,{MODE_SQL:0,MODE_ARCADE:1});K.setObject("dijit.CalculateField",qa,ba);return qa})},"dijit/form/MultiSelect":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-geometry dojo/sniff dojo/query ./_FormValueWidget dojo/NodeList-dom".split(" "),
function(e,K,p,a,g,m){m=K("dijit.form.MultiSelect"+(a("dojo-bidi")?"_NoBidi":""),m,{size:7,baseClass:"dijitMultiSelect",templateString:"\x3cselect multiple\x3d'multiple' ${!nameAttrSetting} data-dojo-attach-point\x3d'containerNode,focusNode' data-dojo-attach-event\x3d'onchange: _onChange'\x3e\x3c/select\x3e",addSelected:function(n){n.getSelected().forEach(function(b){this.containerNode.appendChild(b);this.domNode.scrollTop=this.domNode.offsetHeight;b=n.domNode.scrollTop;n.domNode.scrollTop=0;n.domNode.scrollTop=
b},this);this._set("value",this.get("value"))},getSelected:function(){return g("option",this.containerNode).filter(function(n){return n.selected})},_getValueAttr:function(){return e.map(this.getSelected(),function(n){return n.value})},multiple:!0,_setMultipleAttr:function(n){},_setValueAttr:function(n){a("android")?g("option",this.containerNode).orphan().forEach(function(b){var c=b.ownerDocument.createElement("option");c.value=b.value;c.selected=-1!=e.indexOf(n,b.value);c.text=b.text;c.originalText=
b.originalText;this.containerNode.appendChild(c)},this):g("option",this.containerNode).forEach(function(b){b.selected=-1!=e.indexOf(n,b.value)});this.inherited(arguments)},invertSelection:function(n){var b=[];g("option",this.containerNode).forEach(function(c){c.selected||b.push(c.value)});this._setValueAttr(b,!(!1===n||null==n))},_onChange:function(){this._handleOnChange(this.get("value"),!0)},resize:function(n){n&&p.setMarginBox(this.domNode,n)},postCreate:function(){this._set("value",this.get("value"));
this.inherited(arguments)}});a("dojo-bidi")&&(m=K("dijit.form.MultiSelect",m,{addSelected:function(n){n.getSelected().forEach(function(b){b.text=this.enforceTextDirWithUcc(this.restoreOriginalText(b),b.text)},this);this.inherited(arguments)},_setTextDirAttr:function(n){this.textDir==n&&this._created||!this.enforceTextDirWithUcc||(this._set("textDir",n),g("option",this.containerNode).forEach(function(b){this._created||b.value!==b.text||(b.value=b.text);b.text=this.enforceTextDirWithUcc(b,b.originalText||
b.text)},this))}}));return m})},"esri/dijit/ExpressionEditor":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/Evented dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/aspect dojo/_base/json dojo/Deferred dojo/dom-class dojo/dom-style dijit/registry dijit/TooltipDialog dijit/Tooltip dojo/store/Memory ../layers/ArcGISImageServiceLayer ../layers/ArcGISImageServiceVectorLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISTiledMapServiceLayer ../support/expressionUtils ../lang ../symbols/jsonUtils ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../SpatialReference ../tasks/QueryTask ../tasks/query dojo/i18n!../nls/jsapi dijit/_Widget dijit/_Templated dojo/text!./templates/ExpressionEditor.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U){e=e([L,O],{declaredClass:"esri.dijit.ExpressionEditor",basePath:require.toUrl("."),baseClass:"esriAGOExpressionEditor",widgetsInTemplate:!0,templateString:U,i18n:null,constructor:function(M,Q){M&&(p.mixin(this,M),this.defaultExpressionScript=this.defaultExpressionScript||"")},destroy:function(){clearInterval(this.editorFrameListener);window.removeEventListener("message",this.receiveMessageHitch);this.inherited(arguments)},
postMixInProperties:function(){this.inherited(arguments);this.i18n=p.clone(G.common);p.mixin(this.i18n,G.rendererCommon)},postCreate:function(){},_onClose:function(M){M.preventDefault();g.publish("expression-cancel")},startup:function(){this.inherited(arguments);this._init()},_init:function(){var M=0;this.editorFrameLoaded=!1;this.editorUrl=this.arcadeEditor+"?locale\x3d"+K.locale;this._expressionEditor.onload=p.hitch(this,function(){w.set(this._expressionEditorLoading,"display","none");w.set(this._expressionEditor,
"visibility","visible")});this._expressionEditor.src=this.editorUrl;this.receiveMessageHitch=p.hitch(this,"receiveMessage");window.addEventListener("message",this.receiveMessageHitch,!1);this.editorFrameListener=setInterval(p.hitch(this,function(){this.editorFrameLoaded?(clearInterval(this.editorFrameListener),this.editorFrameListener=null):this.sendPostMessage({type:"isLoaded"});M++;60<M&&g.publish("expression-cancel")}),500)},sendPostMessage:function(M){this._expressionEditor&&this._expressionEditor.contentWindow&&
this._expressionEditor.contentWindow.postMessage(r.toJson(M),this.editorUrl)},receiveMessage:function(M){if(-1!==this.editorUrl.indexOf(M.origin)){var Q="string"===typeof M.data?r.fromJson(M.data):M.data;switch(Q.type){case "loaded":if(this.editorFrameLoaded=Q.value){var Y=this.layer instanceof B,fa=this.mapLayer.layer instanceof J,va="esri.layers.ArcGISTiledMapServiceLayer"===this.mapLayer.layer.declaredClass;if(this.layer instanceof A||Y){if(!this.mapLayer._queryResponse){Y=new C(this.layer.url);
fa=new y;fa.where="1\x3d1";fa.num=1;fa.outFields=["*"];fa.outSpatialReference=this.map.spatialReference;Y.execute(fa,K.hitch(this,function(pa){this.mapLayer._queryResponse=pa;this.receiveMessage(M)}),K.hitch(this,function(){this.mapLayer._queryResponse={};this.receiveMessage(M)}));break}}else if((fa||va)&&this.layer.url&&(this.mapLayer._queryResponse=this.mapLayer._queryResponse||[],!this.mapLayer._queryResponse[this.layer.url])){Y=new C(this.layer.url);fa=new y;fa.where="1\x3d1";fa.num=1;fa.outFields=
["*"];fa.outSpatialReference=this.map.spatialReference;Y.execute(fa,K.hitch(this,function(pa){this.mapLayer._queryResponse[this.layer.url]=pa;this.receiveMessage(M)}),K.hitch(this,function(){this.mapLayer._queryResponse[this.layer.url]={};this.receiveMessage(M)}));break}Y={type:"initializeDialog",title:this.expressionTitle?this.expressionTitle:this.i18n.custom,captureTitle:S.isDefined(this.captureTitle)?this.captureTitle:!0,predictOutputType:!0,script:this.expression?this.expression:this.defaultExpressionScript,
profile:this.arcadeProfile?this.arcadeProfile:this.makeCurrentProfile(),existing:this.makeExistingList(),spatialReference:this.map.spatialReference.toJson(),includeGeometryWarning:!1};this.arcadeProfileType?(Y.profileName=this.arcadeProfileType,"geoanalyticstrack"===this.arcadeProfileType&&Y.profile[0].value&&(Y.trackData={layer:Y.profile[0].value.layer,track:[{attributes:Y.profile[0].value.attributes&&Y.profile[0].value.attributes,geometry:Y.profile[0].value.geometry&&Y.profile[0].value.geometry}],
trackstarttime:(new Date).getTime(),trackindex:1,trackduration:10,trackcurrenttime:(new Date).getTime()})):this.arcadeProfileType&&"geoanalyticstrack"===this.arcadeProfileType||(Y.bannedFunctions="TrackCurrentTime TrackDuration TrackFieldWindow TrackGeometryWindow TrackIndex TrackStartTime TrackWindow".split(" "));this.sendPostMessage(Y)}case "initFinished":break;case "scriptSaveAndClose":if(!Q.script||Q.script===this.defaultExpressionScript){g.publish("expression-cancel");break}var Aa=function(pa){g.publish("expression-commit",
[{expression:pa.script,returnType:"Number"===pa.predictOutputType?"esriFieldTypeDouble":"String"===pa.predictOutputType?"esriFieldTypeString":"esriFieldTypeUnknown",title:pa.title}])};R.hasGeometryOperations(Q.script)?R.enableGeometryOperations().then(function(){Aa(Q)}):Aa(Q);break;case "scriptClose":g.publish("expression-cancel")}}},makeCurrentProfile:function(){var M=this.layer.fields,Q=[{type:"Feature",value:{attributes:null,geometry:null,layer:{fields:a.map(M,function(fa){return fa}),objectIdField:this.layer.objectIdField,
typeIdField:this.layer.typeIdField,types:this.layer.types?a.map(this.layer.types,function(fa){return fa.toJson?fa.toJson():fa}):null,templates:this.layer.templates}},id:S.isDefined(this.fieldId)?this.fieldId:"$feature"}];this.showViewScale&&Q.push({type:"Dictionary",value:{attributes:{scale:this.map.getScale()},layer:{fields:[{name:"scale",alias:this.i18n.currentMapScale,type:"Number"}]}},id:"$view"});if(this.mapLayer._queryResponse&&this.mapLayer._queryResponse.features&&this.mapLayer._queryResponse.features.length)Q[0].value.attributes=
p.clone(this.mapLayer._queryResponse.features[0].attributes),Q[0].value.geometry=this.mapLayer._queryResponse.features[0].geometry;else if(this.mapLayer._queryResponse&&this.mapLayer._queryResponse[this.layer.url]&&this.mapLayer._queryResponse[this.layer.url].features&&this.mapLayer._queryResponse[this.layer.url].features.length)Q[0].value.attributes=p.clone(this.mapLayer._queryResponse[this.layer.url].features[0].attributes),Q[0].value.geometry=this.mapLayer._queryResponse[this.layer.url].features[0].geometry;
else if(this.layer.graphics&&this.layer.graphics.length)Q[0].value.attributes=p.clone(this.layer.graphics[0].attributes),Q[0].value.geometry=this.layer.graphics[0].geometry.toJson();else{var Y={};a.forEach(M,function(fa){-1<a.indexOf("esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGlobalID".split(" "),fa.type)?!1===fa.nullable?fa.defaultValue?Y[fa.name]=fa.defaultValue:-1<a.indexOf(["esriFieldTypeString"],
fa.type)?Y[fa.name]="":Y[fa.name]=0:Y[fa.name]=null:Y[fa.name]=null});Q[0].value.attributes=Y;M=this.map.extent;"esriGeometryPolygon"==this.layer.geometryType||this.layer.getCustomRasterFields?(Q[0].value.geometry=new F(new D(this.map.spatialReference.toJson())),Q[0].value.geometry.addRing([[M.xmin,M.ymin],[M.xmax,M.ymin],[M.xmax,M.ymax],[M.xmin,M.ymax],[M.xmin,M.ymin]])):"esriGeometryPoint"==this.layer.geometryType||"esriGeometryMultipoint"==this.layer.geometryType?Q[0].value.geometry=new E(M.getCenter().toJson()):
"esriGeometryPolyline"==this.layer.geometryType&&(Q[0].value.geometry=new I(new D(this.map.spatialReference.toJson())),Q[0].value.geometry.addPath([[M.xmin,M.ymin],[M.xmax,M.ymax]]))}return Q},makeExistingList:function(){var M=K.hitch(this,function(fa,va,Aa){if(fa&&(fa.shortTitle!==this.expressionTitle||fa.valueExpression!==this.expression)){fa={shortTitle:fa.shortTitle||this.i18n.untitled,script:fa.valueExpression,returnType:fa.returnType};switch(Aa){case "color":fa.title=b.substitute(this.i18n.expressionOriginColor,
{title:fa.shortTitle});break;case "size":fa.title=b.substitute(this.i18n.expressionOriginSize,{title:fa.shortTitle});break;case "type":fa.title=b.substitute(this.i18n.expressionOriginColor,{title:fa.shortTitle});break;case "transparency":fa.title=b.substitute(this.i18n.expressionOriginTransparency,{title:fa.shortTitle});break;case "rotation":fa.title=b.substitute(this.i18n.expressionOriginRotation,{title:fa.shortTitle});break;default:fa.title=fa.shortTitle}va.push(fa)}}),Q=[],Y=this.getRendererCustomExpression(this.layer.renderer,
"color");M(Y,Q,"color");Y=this.getRendererCustomExpression(this.layer.renderer,"size");M(Y,Q,"size");Y=this.getRendererCustomExpression(this.layer.renderer,"type");M(Y,Q,"type");Y=this.getRendererCustomExpression(this.layer.renderer,"transparency");M(Y,Q,"transparency");Y=this.getRendererCustomExpression(this.layer.renderer,"rotation");M(Y,Q,"rotation");if(this.layer.labelingInfo||this.layer.drawingInfo&&this.layer.drawingInfo.labelingInfo)M=this.layer.drawingInfo?this.layer.drawingInfo.labelingInfo[0]:
this.layer.labelingInfo[0],M.labelExpressionInfo&&M.labelExpressionInfo.expression&&M.name&&(M.name!==this.expressionTitle||M.labelExpressionInfo.expression!==this.expression)&&Q.push({shortTitle:M.name||this.i18n.untitled,title:b.substitute(this.i18n.expressionOriginLabels,{title:M.name||this.i18n.untitled}),script:M.labelExpressionInfo.expression});M=this.latestPopupInfo||this.mapLayer.popupInfo;if(!M&&this.mapLayer.itemLayers)for(Y=0;Y<this.mapLayer.itemLayers.length;Y++)if(this.mapLayer.itemLayers[Y].id===
this.layer.id){M=this.mapLayer.itemLayers[Y].popupInfo;break}M&&M.expressionInfos&&a.forEach(M.expressionInfos,function(fa){!fa||fa.title===this.expressionTitle&&fa.expression===this.expression||Q.push({shortTitle:fa.title||this.i18n.untitled,title:b.substitute(this.i18n.expressionOriginPopup,{title:fa.title||this.i18n.untitled}),script:fa.expression})},this);return Q},getRendererCustomExpression:function(M,Q){if(!M)return null;if(M.valueExpression&&("esri.renderer.UniqueValueRenderer"==M.declaredClass||
"esri.renderer.ClassBreaksRenderer"==M.declaredClass&&!this.getVisualVariableByType("colorInfo",null,M.visualVariables)&&!this.getVisualVariableByType("sizeInfo",null,M.visualVariables))&&"type"===Q)return Q="esriFieldTypeDouble","esri.renderer.UniqueValueRenderer"==M.declaredClass&&M.infos&&M.infos[0]&&"string"===typeof M.infos[0].value&&(Q="esriFieldTypeString"),{valueExpression:M.valueExpression,returnType:Q,shortTitle:M.valueExpressionTitle||M.legendOptions&&M.legendOptions.title};if(M.visualVariables){var Y=
this.getVisualVariableByType("colorInfo",null,M.visualVariables);if(Y&&Y.valueExpression&&"color"===Q||(Y=this.getVisualVariableByType("sizeInfo",null,M.visualVariables))&&Y.valueExpression&&"size"===Q||(Y=this.getVisualVariableByType("opacityInfo",null,M.visualVariables))&&Y.valueExpression&&"transparency"===Q||(Y=this.getVisualVariableByType("rotationInfo",null,M.visualVariables))&&Y.valueExpression&&"rotation"===Q)return{valueExpression:Y.valueExpression,returnType:"esriFieldTypeDouble",shortTitle:Y.valueExpressionTitle||
Y.legendOptions&&Y.legendOptions.title}}return M.observationRenderer?this.getRendererCustomExpression(M.observationRenderer):M.latestObservationRenderer?this.getRendererCustomExpression(M.latestObservationRenderer):null},getVisualVariableByType:function(M,Q,Y){return Y&&(Y=a.filter(Y,function(fa){return S.isDefined(Q)?fa.type===M&&fa.target===Q:fa.type===M&&!fa.target}),Y.length)?p.clone(Y[0]):null}});p.setObject("esri.dijit.ExpressionEditor",e);return e})},"esri/layers/ArcGISImageServiceVectorLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/sniff ../kernel ../lang ./GraphicsLayer ./ImageServiceLayerMixin ./pixelFilters/VectorFieldPixelFilter ../renderers/VectorFieldRenderer ../geometry/Point ../geometry/Extent ../graphic dojox/gfx".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q){e=e([b,c],{declaredClass:"esri.layers.ArcGISImageServiceVectorLayer",constructor:function(t,w){this.symbolTileSize=w&&w.symbolTileSize?w.symbolTileSize:50;this._maxMag=this._minMag=null;var u=K.clone(this._params);delete u.imageServiceParameters;delete u.pixelFilter;delete u.rendererStyle;delete u.symbolTileSize;this._initialize(t,w);this.renderer||this.setVectorRendererStyle(w&&w.rendererStyle?w.rendererStyle:l.STYLE_SINGLE_ARROW);this.geometryType="esriGeometryPoint";
this.symbolTileSizeUnits="Pixels";K.mixin(this._params,u)},getField:function(t){return this._getField(t,!0)},setVectorRendererStyle:function(t){this.rendererStyle=t;this._updateVectorFieldRenderer();this.useDefaultRenderer=!0},setRenderer:function(t){t&&(this.vectorFieldPixelFilter=this.vectorFieldPixelFilter||new d,this.vectorFieldPixelFilter.setUnits(t.inputUnit,t.outputUnit));this.useDefaultRenderer=!1;this.inherited(arguments)},getFlowRepresentation:function(){return this.renderer&&this.renderer.flowRepresentation||
this._vectorFlowRepresentation},onResume:function(){this.inherited(arguments);this._toggleTime()},onSuspend:function(){this.inherited(arguments);this._toggleTime()},_fixSymbolTileSize:function(){this.renderer&&(this.renderer.symbolTileSize?this.symbolTileSize=this.renderer.symbolTileSize:this.renderer.symbolTileSize=this.symbolTileSize)},_refresh:function(t){if(10>g("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else if(this._map){this._fixSymbolTileSize();
this.setImageFormat("LERC",!0);t=this.fullExtent&&this.fullExtent.xmin;var w=this.fullExtent&&this.fullExtent.ymax,u=K.clone(this._map.extent),v=1/this.symbolTileSize*this._map.width;v=v?Math.ceil(v):50;var x=1/this.symbolTileSize*this._map.height;x=x?Math.ceil(x):Math.ceil((u.ymax-u.ymin)/(u.xmax-u.xmin)*v);var z=(u.xmax-u.xmin)/v,A=(u.ymax-u.ymin)/x;u.xmin=t+Math.floor((u.xmin-t)/z)*z;u.xmax=t+Math.ceil((u.xmax-t)/z)*z;u.ymin=w+Math.floor((u.ymin-w)/A)*A;u.ymax=w+Math.ceil((u.ymax-w)/A)*A;this._requestData(u,
v,x)}},_drawPixelData:function(){this.clear();if(this.pixelData){var t=this.pixelData.pixelBlock,w=this.pixelData.extent,u=this.pixelData.locations,v=n.isDefined(t.mask)&&0<t.mask.length;if(t&&w&&u){if(this.useDefaultRenderer&&this.renderer&&(!n.isDefined(this._minMag)||!n.isDefined(this._maxMag))){var x=this._getServiceMinMaxStats();x?(this._minMag=x.min,this._maxMag=x.max):(this._minMag=t.statistics[0].minValue,this._maxMag=t.statistics[0].maxValue);x={type:"sizeInfo",minSize:q.px2pt(.2*this.symbolTileSize),
maxSize:q.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag};var z=[];z.push(x);z.push({type:"colorInfo"});this.renderer.setVisualVariables(z)}var A=z=x=0,B=w.spatialReference?w.spatialReference._getInfo():null;for(x=0;x<t.height;x++)for(z=0;z<t.width;z++,A++){var J=u[A];if((!v||t.mask[A])&&J&&2===J.length){J=new h(J[0],J[1],w.spatialReference);B&&(J.x=f.prototype._normalizeX(J.x,B).x);var P={Magnitude:t.pixels[0][A],Direction:t.pixels[1][A],Location:a.toJson(J.toJson())};
J=new r(J,null,P);this.add(J)}}}}},_getServiceMinMaxStats:function(){if(!n.isDefined(this.minValues)||!n.isDefined(this.maxValues)||2>this.minValues.length||2>this.maxValues.length)return null;var t=this.minValues[0],w=this.maxValues[0],u=this.minValues[1],v=this.maxValues[1];if(this.pixelFilter&&t&&w&&u&&v){var x=[];x.push([t,w]);x.push([u,v]);u=this._createPixelData(x);this.pixelFilter(u);u&&u.pixelBlock&&u.pixelBlock.pixels&&0<u.pixelBlock.pixels.length&&(t=u.pixelBlock.pixels[0][0],w=u.pixelBlock.pixels[0][1])}return t&&
w?{min:t,max:w}:null},_updateVectorFieldRenderer:function(){var t={type:"sizeInfo",minSize:q.px2pt(.2*this.symbolTileSize),maxSize:q.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},w=[];w.push(t);t=new l({style:this.rendererStyle,visualVariables:w,flowRepresentation:this._vectorFlowRepresentation});this.setRenderer(t)},_getField:function(t,w){if(n.isDefined(t))return w&&(t=t.toLowerCase()),"magnitude"!==t&&"direction"!==t?null:{name:t,alias:t,domain:null,editable:!1,
length:50,type:"esriFieldTypeDouble"}},_requestDataErrorHandler:function(t){"CancelError"!==t.name&&(this.clear(),this.onError(t))},_setFlowRepresentation:function(t){this.renderer&&this.renderer.flowRepresentation?this._vectorFlowRepresentation=this.renderer.flowRepresentation:t&&this.renderer&&n.isDefined(t.FlowDirection)&&t.FlowDirection&&(this._vectorFlowRepresentation="oceanographic"===t.FlowDirection.toLowerCase()?this.renderer.FLOW_TO:this.renderer.FLOW_FROM);this.renderer&&(this.renderer.flowRepresentation=
this._vectorFlowRepresentation)}});K.setObject("layers.ArcGISImageServiceVectorLayer",e,m);return e})},"esri/dijit/FeatureTable":function(){define("../kernel ../lang ./FeatureTable/Grid ./FeatureTable/storeUtils ./FeatureTable/dataUtils dojo/dom-class dojo/dom-construct dojo/dom-style dojo/aspect dojo/debounce dojo/has dojo/on dojo/string dojo/promise/all dojo/Deferred dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/text!../dijit/FeatureTable/templates/FeatureTable.html dojo/i18n!../nls/jsapi dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/a11yclick dijit/Menu dijit/MenuItem dgrid/util/misc dijit/layout/BorderContainer dijit/layout/TabContainer dijit/layout/ContentPane dojo/query!css2 dojo/domReady!".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C){t=w([B,J,P,R,t],{declaredClass:"esri.dijit.FeatureTable.Grid",baseClass:"esri-feature-table",templateString:z,featureLayer:null,map:null,fieldInfos:null,gridOptions:null,dateOptions:null,editable:!1,editOn:null,hiddenFields:null,outFields:null,menuFunctions:null,columnMenuFunctions:null,batchCount:50,syncSelection:!1,zoomToSelection:!1,showDataTypes:!1,showGridHeader:!0,showGridMenu:!0,showFeatureCount:!0,showColumnHeaderTooltips:!1,
showColumnHeaderTooltipsWithDescription:!1,showAttachments:!1,showStatistics:!0,showRelatedRecords:!1,showCyclicalRelationships:!1,filterIds:null,showFieldDetails:!1,showColumnHiderButton:!1,showDefaultSortMenuItem:!0,showExpressionFields:!1,loaded:!1,grid:null,layerInfo:null,dataStore:null,columns:null,featureCount:0,idProperty:"id",gridMenu:null,gridMenuAnchor:null,selectedRows:null,selectedRowIds:null,css:{button:"esri-feature-table-button",hidden:"esri-feature-table-hidden",select:"esri-feature-table-select",
borderContainer:"esri-feature-table-border-container",contentPane:"esri-feature-table-content-pane",grid:"esri-feature-table-grid",title:"esri-feature-table-title",loadingIndicator:"esri-feature-table-loading-indicator",cellLoadingIndicator:"esri-feature-table-cell-loading-indicator",menu:"esri-feature-table-menu",menuItem:"esri-feature-table-menu-item",menuOptions:"esri-feature-table-menu-options",columnHeader:"esri-feature-table-column-header",columnHeaderTitle:"esri-feature-table-column-header-title",
columnHeaderType:"esri-feature-table-column-header-type",columnHeaderClear:"esri-feature-table-column-header-clear",columnMenu:"esri-feature-table-column-menu",sortAscendingIcon:"esri-icon-ascending icon-ui-ascending",sortDescendingIcon:"esri-icon-descending icon-ui-descending",filterIcon:"esri-icon-filter icon-ui-filter",propertiesIcon:"esri-icon-properties icon-ui-properties",statisticsIcon:"esri-icon-statistics icon-ui-statistics",settingsIcon:"esri-icon-settings icon-ui-settings",columnHeaderTooltip:"esri-feature-table-column-header-tooltip",
lockedIcon:"esri-icon-locked icon-ui-locked",lockedIconContainer:"esri-locked-icon-container",downIcon:"esri-icon-down icon-ui-down",menuIcon:"esri-icon-menu icon-ui-menu",closeIcon:"esri-icon-close icon-ui-close",optionsMenu:"esri-feature-table-options-menu-container",relatedRecordsCell:"esri-feature-table-related-records-cell",relatedRecordsTitle:"esri-feature-table-related-records-title",relatedRecordsLink:"esri-related-records-link",attachmentsCell:"esri-feature-table-attachments-cell",attachmentsTitle:"esri-feature-table-attachments-title",
attachmentsLink:"esri-attachments-link",expressionsCell:"esri-feature-table-expressions-cell",expressionsTitle:"esri-feature-table-expressions-title",expressionsLink:"esri-expressions-link",dialog:"esri-feature-table-dialog",closeButton:"esri-dialog-close-button dijitButton",statisticsTableContainer:"esri-feature-table-statistics",statisticsHeader:"esri-statistics-header",statisticsBreak:"esri-break",statisticsHorizontalBreak:"esri-horizontal-break",statisticsAttrTable:"esri-attribute-table",statisticsAttrName:"esri-attribute-name",
statisticsAttrValue:"esri-attribute-value",leftMargin:"esri-feature-table-left-margin",dateValue:"esri-date-value"},_i18nStrings:A.widgets.FeatureTable,_layerInfos:null,_fieldInfos:null,_cachedIds:null,_defaultBatchCount:50,_defaultFeatureCount:2E3,_defaultDateOptions:{timeEnabled:!0,dateEnabled:!0,timePattern:null,datePattern:null},_defaultGridOptions:{allowSelectAll:!1,cellNavigation:!0,selectionMode:"extended",pagination:!1,allowTextSelection:!1,pageSizeOptions:[10,25,50],columnHider:!0,columnResizer:!0,
pagingDelay:300,keepScrollPosition:!0,queryRowsOverlap:0,sort:{field:"id",descending:!1}},_defaultSort:null,_defaultEditOn:"dblclick, keypress",_orderByFields:null,_showRelatedRecords:!1,_showAttachments:!1,_rollbackInfos:null,_statisticsDialog:null,_attachmentsDialog:null,_columnRules:null,_relatedGridInfos:null,_popupDateFormats:{shortDate:{datePattern:"M/d/y"},shortDateLE:{datePattern:"d/M/y"},longMonthDayYear:{datePattern:"MMMM d, y"},dayShortMonthYear:{datePattern:"d MMM y"},longDate:{datePattern:"EEEE, MMMM d, y",
selector:"date"},shortDateShortTime:{datePattern:"M/d/y",timePattern:"h:mm a",timeEnabled:!0},shortDateLEShortTime:{datePattern:"d/M/y",timePattern:"h:mm a",timeEnabled:!0},shortDateShortTime24:{datePattern:"M/d/y",timePattern:"H:mm",timeEnabled:!0},shortDateLEShortTime24:{datePattern:"d/M/y",timePattern:"H:mm",timeEnabled:!0},shortDateLongTime:{datePattern:"M/d/y",timePattern:"h:mm:ss a",timeEnabled:!0},shortDateLELongTime:{datePattern:"d/M/y",timePattern:"h:mm:ss a",timeEnabled:!0},shortDateLongTime24:{datePattern:"M/d/y",
timePattern:"H:mm:ss",timeEnabled:!0},shortDateLELongTime24:{datePattern:"d/M/y",timePattern:"H:mm:ss",timeEnabled:!0},longMonthYear:{datePattern:"MMMM y"},shortMonthYear:{datePattern:"MMM y"},year:{datePattern:"y"}},constructor:function(y,G){G&&(this._rowSelectHandler=d(this._rowSelectHandler,0),this._rowDeselectHandler=d(this._rowDeselectHandler,0),this._refreshHandler=d(this._refreshHandler,0))},postMixInProperties:function(){this.inherited(arguments);this.set({columns:[],layerInfo:{},selectedRows:[],
selectedRowIds:[],hiddenFields:this.hiddenFields||[],outFields:this.outFields||["*"],fieldInfos:this.fieldInfos||[],menuFunctions:this.menuFunctions||[],columnMenuFunctions:this.columnMenuFunctions||[],gridOptions:u.mixin({},this._defaultGridOptions,this.gridOptions),dateOptions:u.mixin({},this._defaultDateOptions,this.dateOptions),_fieldInfos:[],_cachedIds:[],_columnRules:{},_relatedGridInfos:[]});l("touch")&&!this.editOn?this.set("editOn",S):this.editOn||this.set("editOn",this._defaultEditOn);this.filterIds&&
0===this.filterIds.length&&(this.filterIds=null);this._noDataMessage=this.gridOptions.noDataMessage||this._i18nStrings.noData},startup:function(){this.inherited(arguments);var y=this.featureLayer;y&&y.loadError?this._showLoadError():this.domNode&&y.loaded?this._setUpDataForMainGrid():this.own(h(y,"load",u.hitch(this,function(){this._setUpDataForMainGrid()})),h(y,"error",u.hitch(this,function(){y.loaded||this._showLoadError()})))},destroy:function(){this.inherited(arguments);this._statisticsDialog&&
this._statisticsDialog.destroy();this._attachmentsDialog&&this._attachmentsDialog.destroy();this._grid&&this._grid._destroyColumns()},refresh:function(y){var G=y||this._grid,L=this._relatedGridInfos,O=L.length,U;G===this._grid&&0<O&&v.forEach(L,function(M,Q){(U=L[O-1-Q])&&U.grid&&this._removeGrid(U.grid)},this);return this._refreshStore({grid:G}).then(function(){G.refresh()})},resize:function(y){this._gridBorderContainerNode&&this._gridBorderContainerNode.resize();(y=y&&y.resize?y:this._grid)&&y.resize()},
clearSelection:function(y){(y=y||this._grid)&&y.clearSelection()},getRowDataById:function(y,G){if(G=G||this._grid)return G.getRowDataById(y)},filterSelectedRecords:function(y,G){G=(y=G||this._grid)?y.selectedRowIds:[];y&&G&&G.length&&this.filterRecordsByIds(y.selectedRowIds)},filterRecordsByIds:function(y,G){if(G=G||this._grid)this.filterIds=y,G.filterIds=y,y&&0!==y.length||(this.selectedRows=[],this.selectedRowIds=[],G.selectedFeatureCount=0,G.selectedRowIds=[],G.selectedRows=[]),this._refreshStore({grid:G}),
this.emit("filter",{ids:y||[]})},clearFilter:function(y){(y=y||this._grid)&&this.filterRecordsByIds(null,y)},getFeatureDataById:function(y){return y instanceof Array?g.queryLayerForFeature({layer:this.featureLayer,id:y}):g.queryLayerForFeatures({layer:this.featureLayer,ids:y})},selectRows:function(y,G,L){(L=L||this._grid)&&L.selectRows(y,G)},sort:function(y,G,L){L=L||this._grid;if(L&&y){var O=g.getOrderByString(y,G);var U=g.getColumnFromFieldName({fieldName:y,grid:L});this._sortField(L,{field:y,descending:G,
column:U,orderByFields:[O]})}},centerOnSelection:function(y){return(y||this._grid).centerOnSelection()},_setUpMainGrid:function(y,G){var L=new p({map:this.map,layer:y,layerInfo:G,idProperty:G.idProperty,customFieldInfos:this._getCustomFieldInfos(y)||this.fieldInfos,expressionInfos:this._getExpressionInfos(y),defaultSort:this._defaultSort,outFields:this.outFields,hiddenFields:this.hiddenFields,filterIds:this.filterIds,gridOptions:this.gridOptions,dateOptions:this.dateOptions,batchCount:this.batchCount,
editable:this.editable,editOn:this.editOn,css:this.css,showAttachments:this._showAttachments,showRelatedRecords:this._showRelatedRecords,showCyclicalRelationships:this.showCyclicalRelationships,showStatistics:this.showStatistics,showFieldDetails:this.showFieldDetails,showGridHeader:this.showGridHeader,showGridMenu:this.showGridMenu,showFeatureCount:this.showFeatureCount,showDataTypes:this.showDataTypes,showColumnHeaderTooltips:this.showColumnHeaderTooltips,showColumnHeaderTooltipsWithDescription:this.showColumnHeaderTooltipsWithDescription,
showColumnHider:this.showColumnHiderButton,syncSelection:this.syncSelection,menuFunctions:this.menuFunctions,showDefaultSortMenuItem:this.showDefaultSortMenuItem,columnMenuFunctions:this.columnMenuFunctions,showFilterMenuItems:this.showFilterMenuItems,showExpressionFields:this.showExpressionFields},this._gridNode);L.startup();this.set({_grid:L,grid:L.dGrid,gridMenu:L.optionsMenu,gridMenuAnchor:L.optionsMenuAnchor});this._wireUpGridEvents(L);L.showLoadingIndicator();L.updateNoDataMessage("");L.setHeaderTitle(this._i18nStrings.loadingData);
L.resize();this._setUpColumns({grid:L,layer:y});g.queryLayerForCount({layer:y,layerInfo:G}).then(u.hitch(this,function(O){L.set("featureCount",O);L.updateHeaderText();this._generateStore({grid:L,layer:y,layerInfo:G,count:O,filterIds:this.filterIds}).then(u.hitch(this,function(U){O||L.updateNoDataMessage(this._noDataMessage);this.set("dataStore",U);L.updateStore(U);L.hideLoadingIndicator();setTimeout(u.hitch(this,function(){this.resize()},200))})).otherwise(u.hitch(this,function(){this._showLoadError();
L.updateNoDataMessage(this._noDataMessage)}))})).otherwise(u.hitch(this,function(){this._showLoadError();L.updateNoDataMessage(this._noDataMessage)}))},_setUpDataForMainGrid:function(){var y=this.featureLayer,G=this.gridOptions,L=this.outFields;this._generateLayerInfo(y).then(u.hitch(this,function(O){var U=O.idProperty;O.hasRelatedRecords&&(this._showRelatedRecords=!!this.showRelatedRecords);O.hasAttachments&&(this._showAttachments=!!this.showAttachments);var M=G.sort&&G.sort.field?g.findFirst(y.fields,
"name",G.sort.field):null;M=M&&M.name?M.name:U;var Q=!(!G.sort||!G.sort.descending),Y=g.getOrderByString(M,Q);L=v.filter(L,function(fa){return!!g.findFirst(y.fields,"name",fa)},this);0===L.length&&L.push("*");this.layerInfo=O;this.idProperty=U;this._orderByFields=[Y];this._defaultSort={attribute:M,descending:Q};this._setUpMainGrid(y,O)}))},_getCustomFieldInfos:function(y){return(y=this._getPopupInfo(y))&&y.fieldInfos?this._updatePopupInfosDateFormat(y.fieldInfos):null},_getExpressionInfos:function(y){return(y=
this._getPopupInfo(y))&&y.expressionInfos?y.expressionInfos:null},_getPopupInfo:function(y){y=y.id||y.layerId||0;return(y=this._layerInfos?this._layerInfos[y]:null)?y.popupInfo:null},_generateLayerInfo:function(y){var G=new q,L=y.id||y.layerId||0,O=y.objectIdField;if(!O){var U=JSON.parse(y._json);U.uniqueIdField&&U.uniqueIdField.name&&(O=U.uniqueIdField.name)}O={idProperty:O,layerId:L,userIds:{}};y.credential&&(O.userIds[L]=y.credential.userId);O.userId&&(O.userIds[L]=O.userId);O.isFeatureCollection=
y._collection&&!0===y._collection||null===y.url&&null===y._url;O.typeIdField=y.typeIdField;O.types=y.types;O.subtypeField=y.subtypeField;O.subtypes=y.subtypes;O.editable=y.isEditable?y.isEditable():!!y.userIsAdmin||!1;O.editCapabilities=y.getEditCapabilities?y.getEditCapabilities():{};O.hasRelatedRecords=y.relationships&&0<y.relationships.length;O.supportsAdvancedQueryRelated=!(!y.advancedQueryCapabilities||!y.advancedQueryCapabilities.supportsAdvancedQueryRelated);O.hasAttachments=y.hasAttachments;
O.queryAttachmentsSupported=!0;O=u.clone(O);G.resolve(O);return G},_setUpColumns:function(y){var G=y.grid;y=y.layer;var L=y.fields,O;var U=(O=y.getOutFields?y.getOutFields():["*"])&&O[0]&&"*"===O[0]?L:v.filter(L,function(Q){return-1!==v.indexOf(O,Q.name)});G===this._grid&&"*"!==this.outFields[0]&&(U=v.filter(U,u.hitch(this,function(Q){return-1!==v.indexOf(this.outFields,Q.name)})));K.isDefined(y.objectIdField)&&!g.findFirst(U,"name",y.objectIdField)&&(L=g.findFirst(L,"name",y.objectIdField))&&U.unshift(L);
if(this.showExpressionFields){var M=this._getPopupInfo(y);M&&M.expressionInfos&&(y=this._getCustomFieldInfos(y),v.forEach(y,function(Q){var Y=g.getExpressionInfo(M.expressionInfos,Q.fieldName);Y&&U.push({name:Q.fieldName,alias:Y.title,editable:!1,nullable:!1,type:Y.returnType})}))}y=G._setUpColumns(U);G===this._grid&&this.set({columns:y.columns,_fieldInfos:y.fieldInfos})},_showLoadError:function(y){var G=y&&y.grid?y.grid:this._grid;y=y&&y.error?y.error:this._i18nStrings.dataError;G&&(G.hideLoadingIndicator(),
G.setHeaderTitle(y));this.emit("error",{message:y})},_wireUpGridEvents:function(y){y&&(y.on("load",u.hitch(this,function(G){y===this._grid&&this.set("loaded",G.loaded);this.emit("load",G.loaded)})),y.on("error",u.hitch(this,function(G){this._showLoadError();this.emit("error",G)})),y.on("row-select",u.hitch(this,this._rowSelectHandler,y)),y.on("row-deselect",u.hitch(this,this._rowDeselectHandler,y)),y.on("refresh",u.hitch(this,this._refreshHandler,y)),y.on("sort",u.hitch(this,this._sortField,y)),y.on("filter",
u.hitch(this,function(G){this.emit("filter",G)})),y.on("column-resize",u.hitch(this,function(G){this.emit("column-resize",G)})),y.on("column-state-change",u.hitch(this,function(G){this.emit("column-state-change",G)})),y.on("editor-show",u.hitch(this,function(G){this.emit("editor-show",G)})),y.on("editor-hide",u.hitch(this,function(G){this.emit("editor-hide",G)})),y.on("data-change",u.hitch(this,function(G){this.emit("data-change",G)})),y.on("edits-complete",u.hitch(this,function(G){this.emit("edits-complete",
G)})),y.on("layer-click",u.hitch(this,function(G){this.emit("layer-click",G)})),y.on("layer-selection-complete",u.hitch(this,function(G){y===this._grid&&this.syncSelection&&this._syncSelectionFromLayer({grid:y,features:G.features});this.emit("layer-selection-complete",G)})),y.on("layer-selection-clear",u.hitch(this,function(G){y===this._grid&&this.syncSelection&&this.clearSelection();this.emit("layer-selection-clear",G)})),y.on("layer-update-end",u.hitch(this,function(G){this.emit("layer-update-end",
G)})),y.on("layer-refresh-tick",u.hitch(this,function(G){this.refresh()})),y.on("show-selected-records",u.hitch(this,function(G){this.emit("show-selected-records",{grid:y,ids:G.ids});this.filterRecordsByIds(G.ids,y)})),y.on("clear-selection",u.hitch(this,function(){this.emit("clear-selection")})),y.on("clear-filter",u.hitch(this,this.clearFilter,y)),y.on("show-statistics",u.hitch(this,function(G){this._statisticsDialog=G.dialog;this.emit("show-statistics",{dialog:G.dialog,statistics:G.statistics})})),
y.on("show-attachments",u.hitch(this,function(G){this._attachmentsDialog=G.dialog;this.emit("show-attachments",{featureId:G.featureId,dialog:G.dialog,attachments:G.attachments})})),y.on("show-related-records",u.hitch(this,this._showRelatedRecordsCallback,y)),y.on("show-detailed-field-view",u.hitch(this,this._showDetailedFieldViewCallback,y)),y.on("add-attachment-complete",u.hitch(this,function(G){this.emit("add-attachment-complete",G)})),y.on("delete-attachment-complete",u.hitch(this,function(G){this.emit("delete-attachment-complete",
G)})))},_wireUpRelatedGridEvents:function(y){y.grid.own(h(y.parentGrid,"row-select",this._updateRelatedGridsHandler.bind(this,y)))},_updateRelatedGridsHandler:function(y,G){if(G.rows&&G.rows.length&&G.rows[0].data){var L=y.grid,O=y.parentGrid;y=y.relationship;var U=this._relatedGridInfos;G=G.rows[0];var M=U[U.length-1];if(M=M?M.grid:null){var Q=L===M,Y=parseInt(G.id,10);M=g.findFirst(L.layer.relationships,"id",y.id);var fa=g.findFirst(U,"grid",L),va=v.indexOf(U,fa),Aa=O._getRelatedRecordsCount({featureId:Y,
relationshipId:y.id});0<Aa?(Q||v.forEach(U,function(pa,N){pa.grid&&N>=va&&(pa.grid.emptyStore(),pa.grid.set("featureCount",0),pa.grid.updateHeaderText())}),U=y.keyField,"undefined"===typeof G.data[U]&&(U=O.layer.getField(U).name),g.getRelationshipWhereClause({layer:L.layer,originRelationship:y,destinationRelationship:M,keyValue:G.data[U]}).then(u.hitch(this,function(pa){L.set({where:pa,featureCount:Aa});L.updateHeaderText();this._refreshStore({grid:L}).then(function(N){Q||setTimeout(function(){if(L.store){var V=
L.store.data;if(V=V?V[Object.keys(V)[0]]:null)V=V.attributes[L.idProperty],L.selectRows(V,!1)}},600)})}))):Q?(L.emptyStore(),L.set("featureCount",0),L.updateHeaderText(),L.refresh()):(L.set("featureCount",0),L.updateHeaderText(),v.forEach(U,function(pa,N){pa=pa.grid;N<va||(pa.emptyStore(),pa.set("featureCount",0),pa.updateHeaderText(),pa.refresh())}))}}},_generateStore:function(y){var G=y.grid,L=y.layer,O=y.layerInfo,U=y.where||null,M=y.orderByFields||null,Q=y.count||null,Y=y.filterIds||null;(y.store||
G.store)&&G.emptyStore();return O.isFeatureCollection?this._generateStoreForFeatureCollection({grid:G,layer:L,layerInfo:O}):L.advancedQueryCapabilities&&!L.advancedQueryCapabilities.supportsPagination?this._generateStoreForNonPaginatedLayer({grid:G,layer:L,layerInfo:O,where:U,orderByFields:M,count:Q,filterIds:Y}):this._generateCacheStore({grid:G,where:U,orderByFields:M,count:Q,ids:Y})},_generateCacheStore:function(y){var G=new q,L=y.grid;var O=y.orderByFields?y.orderByFields:L===this._grid?this._orderByFields&&
this._orderByFields.length?this._orderByFields:[g.getOrderByString(this._defaultSort.attribute,this._defaultSort.descending)]:null;y=a.generateCacheStore({grid:L,layer:L.layer,ids:y.ids,where:y.where,orderByFields:O,count:y.count,getAttachments:this.showAttachments&&L.layerInfo.hasAttachments,getRelatedRecords:this.showRelatedRecords&&L.layerInfo.hasRelatedRecords});c.before(y,"query",function(U,M){L.showLoadingIndicator()});c.after(y,"query",function(U){U.then(function(M){M.attachmentInfos?L._updateAttachmentInfos(M.attachmentInfos):
L.layerInfo.queryAttachmentsSupported=!1;M.relatedRecordInfos&&(L.layerInfo.supportsAdvancedQueryRelated?L._updateRelatedRecordCounts(M.relatedRecordInfos):L._updateRelatedRecordInfos(M.relatedRecordInfos));L.hideLoadingIndicator()}).otherwise(function(){L.hideLoadingIndicator()});return U});G.resolve(y);return G},_generateMemoryStore:function(y){var G=y.grid,L=y.features;y=new q;L=a.generateMemoryStore({features:L,idProperty:this.idProperty});L.query=u.hitch(this,a.generateSort,G.dGrid,L);y.resolve(L);
return y},_generateStoreForFeatureCollection:function(y){return this._generateMemoryStore({grid:y.grid,features:y.layer.graphics})},_generateStoreForNonPaginatedLayer:function(y){var G=y.grid,L=y.layer,O=y.layerInfo,U=y.where||null,M=y.orderByFields||null;return(y=y.filterIds||null)&&y.length?this._generateCacheStore({grid:G,ids:y,where:U,orderByFields:M}):g.queryLayerForIds({layer:L,idProperty:O.idProperty,where:U}).then(u.hitch(this,function(Q){O._cachedIds=Q;G.layerInfo.cachedIds=Q;return this._generateCacheStore({grid:G,
ids:Q,where:U,orderByFields:M})})).otherwise(u.hitch(this,function(){this._showLoadError()}))},_refreshStore:function(y){var G=y.grid,L=G.filterIds,O=y.where||G.where||null,U=y.orderByFields,M=G.layer,Q=G.layerInfo;G.showLoadingIndicator();G.updateNoDataMessage("");G.setHeaderTitle(this._i18nStrings.loadingData);return g.queryLayerForCount({layer:M,layerInfo:Q,where:O}).then(u.hitch(this,function(Y){G.set("featureCount",Y);G.updateHeaderText();return this._generateStore({grid:G,layer:M,layerInfo:Q,
orderByFields:U,where:O,count:Y,filterIds:L}).then(u.hitch(this,function(fa){G===this._grid&&this.set("dataStore",fa);Y||G.updateNoDataMessage(this._noDataMessage);G.updateStore(fa);G.hideLoadingIndicator();return fa}))})).otherwise(u.hitch(this,function(){this._showLoadError();G.updateNoDataMessage(this._noDataMessage);return null}))},_setEditableAttr:function(y){this._grid&&this._grid.set("editable",!!y);v.forEach(this._relatedGridInfos,function(G){G.grid.set("editable",!!y)})},_sortField:function(y,
G){var L=G.column,O=parseInt(G.id,10),U=G.field,M=G.descending;G=G.orderByFields;y===this._grid&&(this._orderByFields=G);y.emptyStore();L?y.updateSort([{attribute:U,columnId:O,fieldType:L.type,descending:M}]):y.updateSort([{attribute:U,descending:M}]);this._refreshStore({grid:y,orderByFields:G}).then(u.hitch(this,function(){this.emit("sort",{field:U,descending:M})}))},_rowSelectHandler:function(y,G){this.syncSelection&&this._syncSelectionFromGrid({grid:y,ids:y.selectedRowIds});y===this._grid&&(this.set({selectedRows:y.selectedRows,
selectedRowIds:y.selectedRowIds}),this.emit("row-select",G))},_rowDeselectHandler:function(y,G){var L=y.selectedRows;this.syncSelection&&(0<L.length?this._syncSelectionFromGrid({grid:y,ids:y.selectedRowIds}):y.layer.clearSelection(!0));y===this._grid&&(this.set({selectedRows:L,selectedRowIds:y.selectedRowIds}),this.emit("row-deselect",G))},_refreshHandler:function(y,G){y===this._grid&&this.emit("refresh",G)},_syncSelectionFromLayer:function(y){var G=y.features||[],L=(y.grid||this._grid).idProperty;
0===G.length?this.clearSelection():(y=v.map(G,function(O){return O.attributes[L]}),g.compareIntArrays(y,this.selectedRowIds)||(this.map&&this.zoomToSelection&&0<G.length&&(G=g.calculateExtentFromFeatures(G),this.map.setExtent(G)),this.selectRows(y,!0)))},_syncSelectionFromGrid:function(y){var G=y.grid||this._grid,L=G.layer,O=y.ids;y=L.getSelectedFeatures();var U=G.idProperty,M;y=v.map(y,function(Q){return Q.attributes[U]});g.compareIntArrays(O,y)||g.queryLayerForFeatures({grid:G,layer:L,ids:O}).then(u.hitch(this,
function(Q){Q&&Q.features&&(Q=Q.features,Q.length&&(this.map&&this.zoomToSelection&&(M=g.calculateExtentFromFeatures(Q),this.map.setExtent(M)),g.selectFeaturesById({grid:G,ids:O})))}))},_showRelatedRecordsCallback:function(y,G){var L=G.columnId,O=G.relationship,U=G.keyFieldValue,M=G.row,Q=G.count;G=[];if(y===this._grid){var Y=this._centerPaneNode;var fa=this._leadingPaneNode}else G=this._relatedGridInfos.length-1,G=this._relatedGridInfos[G],Y=G.layout.centerContentPane,fa=G.layout.leadingContentPane,
this._removeButtonNode(G.closeButton),G.closeButton=null;this._addSmallRelatedRecordsColumn({grid:y,relationship:O});y.showFieldDetails=!1;y.showFeatureCount=!1;y.updateSelectionMode("single");y.updateHeaderText();y.hideOptionsMenu();G=[this._shrinkGrid({grid:y,centerPane:Y,leadingPane:fa,columnId:L}),this._setUpDataForRelatedGrid({parentGrid:y,relationship:O})];r(G).then(u.hitch(this,function(va){var Aa=va[1].layer;va=Y;var pa;this._addHiddenColumnRules({grid:y,columnId:L});y.refresh();y.selectRows(M[y.idProperty],
!0,!0);this._showPane(va);var N=this._generateSubLayout(va.domNode);this.resize();this._generateLayerInfo(Aa).then(u.hitch(this,function(V){this.emit("show-related-records",{grid:y,relationship:O,row:M});pa=g.findFirst(Aa.relationships,"id",O.id);g.getRelationshipWhereClause({layer:Aa,originRelationship:O,destinationRelationship:pa,keyValue:U}).then(u.hitch(this,function(Z){this._setUpRelatedGrid({parentGrid:y,layer:Aa,layerInfo:V,relationship:O,where:Z,layout:N,count:Q})}))}))}))},_setUpDataForRelatedGrid:function(y){var G=
y.relationship.relatedTableId;return this._setUpRelatedLayer({baseLayer:y.parentGrid.layer,layerId:G}).then(function(L){return{layer:L,layerId:G}})},_generateSubLayout:function(y){var G=this.css,L=G.contentPane+" "+G.hidden;var O=new F({className:G.borderContainer+" "+G.leftMargin,gutters:!1,design:"headline"});G=new C({className:G.contentPane,region:"leading"});L=new C({className:L,region:"center"});var U=n.create("div",null,G.domNode);O.addChild(G);O.addChild(L);O.placeAt(y);O.startup();return{borderContainer:O,
leadingContentPane:G,centerContentPane:L,containerNode:U}},_setUpRelatedGrid:function(y){var G=this,L=y.layer,O=y.layerInfo,U=O.idProperty,M=y.parentGrid,Q=y.relationship,Y=y.layout,fa=y.where||null,va=y.count||null;y=v.map(this._relatedGridInfos,function(N){return N.grid.layer.layerId});y.unshift(this._grid.layer.layerId);var Aa=[{label:this._i18nStrings.close,callback:function(){G._removeGrid(this)}}],pa=new p({map:this.map,layer:L,layerInfo:O,idProperty:U,customFieldInfos:this._getCustomFieldInfos(L),
expressionInfos:this._getExpressionInfos(L),defaultSort:{attribute:U,descending:!1},outFields:["*"],where:fa,gridOptions:this.gridOptions,dateOptions:this.dateOptions,batchCount:this.batchCount,editable:this.editable,editOn:this.editOn,css:this.css,showAttachments:!(!this.showAttachments||!O.hasAttachments),showRelatedRecords:!0,showCyclicalRelationships:this.showCyclicalRelationships,showStatistics:this.showStatistics,showFieldDetails:!1,showGridHeader:this.showGridHeader,showGridMenu:this.showGridMenu,
showFeatureCount:this.showFeatureCount,showDataTypes:this.showDataTypes,showColumnHeaderTooltips:this.showColumnHeaderTooltips,showColumnHeaderTooltipsWithDescription:this.showColumnHeaderTooltipsWithDescription,showColumnHider:this.showColumnHiderButton,menuFunctions:Aa,showFilterMenuItems:!1,showDefaultSortMenuItem:this.showDefaultSortMenuItem,syncSelection:!1,showExpressionFields:this.showExpressionFields,visibleLayerIds:y},Y.containerNode);pa.startup();this._wireUpGridEvents(pa);this._wireUpRelatedGridEvents({grid:pa,
parentGrid:M,relationship:Q});pa.showLoadingIndicator();pa.updateNoDataMessage("");pa.setHeaderTitle(this._i18nStrings.loadingData);pa.resize();U=this._generateColumnSwitcherButton(M);y=this._generateGridCloseButton(pa);this._relatedGridInfos.push({grid:pa,parentGrid:M,layout:Y,relationship:Q,pickerButton:U,closeButton:y});this._setUpColumns({grid:pa,layer:L});if(g.isValueEmpty(va))return g.queryLayerForCount({layer:L,layerInfo:O}).then(u.hitch(this,function(N){pa.set("featureCount",N);pa.updateHeaderText();
this._generateStore({grid:pa,layer:L,layout:Y,layerInfo:O,where:fa,count:N,filterIds:null}).then(u.hitch(this,function(V){N||pa.updateNoDataMessage(this._noDataMessage);pa.updateStore(V);pa.hideLoadingIndicator()}))})).otherwise(u.hitch(this,function(){this._showLoadError();pa.updateNoDataMessage(this._noDataMessage)}));pa.set("featureCount",va);pa.updateHeaderText();this._generateStore({grid:pa,layer:L,layout:Y,layerInfo:O,where:fa,count:va,filterIds:null}).then(u.hitch(this,function(N){va||pa.updateNoDataMessage(this._noDataMessage);
pa.updateStore(N);pa.hideLoadingIndicator()})).otherwise(u.hitch(this,function(){this._showLoadError();pa.updateNoDataMessage(this._noDataMessage)}))},_setUpRelatedLayer:function(y){var G=new q,L=g.initFeatureLayer(y.baseLayer,y.layerId);L.loaded?G.resolve(L):h(L,"load",function(){G.resolve(L)});return G},_showPane:function(y){y&&y.domNode&&m.remove(y.domNode,this.css.hidden)},_hidePane:function(y){y&&y.domNode&&m.add(y.domNode,this.css.hidden)},_shrinkGrid:function(y){var G=new q,L=y.grid,O=y.leadingPane,
U=y.finalWidth||220;y=x.animateProperty({node:O.id,properties:{width:{start:function(){return O.domNode.getBoundingClientRect().width},end:function(){return U}}}}).play();h(y,"End",function(){G.resolve(L)});return G},_growGrid:function(y){y=y.grid;this._removeSmallRelatedRecordsColumn(y);this._removeHiddenColumnRules(y);y.showColumnHider&&y.showColumnHiderButton();if(y===this._grid){var G=this._centerPaneNode;var L=this._leadingPaneNode;y.showFieldDetails=this.showFieldDetails;this.emit("hide-related-records")}else{var O=
this._relatedGridInfos.length-1;O=this._relatedGridInfos[O];G=O.layout.centerContentPane;L=O.layout.leadingContentPane;O.closeButton=this._generateGridCloseButton(y)}this._hidePane(G);L.domNode&&b.set(L.domNode,"width","100%");y.updateSelectionMode(this.gridOptions.selectionMode);y.showFeatureCount=this.showFeatureCount;y.updateHeaderText();this.showGridMenu&&y.showOptionsMenu();y.resize();this.resize()},_removeGrid:function(y){if(y!==this._grid){var G=g.findFirst(this._relatedGridInfos,"grid",y),
L=G.parentGrid,O=G.layout.borderContainer,U=G.layout.leadingContentPane;this._hidePane(G.layout.centerContentPane);U.domNode&&b.set(U.domNode,"width","100%");this._removeButtonNode(G.pickerButton);this._relatedGridInfos.pop();y.destroy();O.destroy();this._growGrid({grid:L})}},_addHiddenColumnRules:function(y){var G=y.grid,L=y.columnId;y=G.getColumns();y=Object.keys(y);var O=[],U;O=v.map(y,function(M,Q){U=Q===L?"display: table-cell;":"display: none;";return G.styleColumn(M,U)});this._columnRules[G.id]=
O},_removeHiddenColumnRules:function(y){v.forEach(this._columnRules[y.id],function(G){G.remove()});this._columnRules[y.id]=[]},_addSmallRelatedRecordsColumn:function(y){var G=y.grid,L=y.relationship.id,O=G.idProperty;G.columns.push({unhidable:!0,label:"esriRelatedRecordsSmall",field:"esriRelatedRecordsSmall",get:function(U){U=G._getRelatedRecordsCount({featureId:U[O],relationshipId:L});return f.substitute(G._i18nStrings.parenValue,{value:U})}})},_removeSmallRelatedRecordsColumn:function(y){var G=
y.columns;"esriRelatedRecordsSmall"===(G&&G[G.length-1]?G[G.length-1].field:null)&&(G.pop(),y.refresh())},_generateGridCloseButton:function(y){var G=this.css;G=n.create("div",{className:G.menuItem+" "+G.button+" "+G.closeIcon,tabIndex:0});n.place(G,y._menuNode,"before");h(G,S,u.hitch(this,function(){this._removeGrid(y)}));return G},_generateColumnSwitcherButton:function(y){var G=y._gridHeaderNode.domNode,L=this._generateColumnSwitcherMenu(y);y=this.css;var O=this._i18nStrings;var U=n.create("div",
{title:O.columnSelectionMenu,"aria-label":O.columnSelectionMenu,className:y.menuItem+" "+y.button+" "+y.menuIcon,tabIndex:0},G);h(U,[S,"keydown"],u.hitch(this,function(M){var Q=U.getBoundingClientRect(),Y=Q.top+Q.height;Q=this.isLeftToRight()?Q.right-Q.width:Q.right;L._openMyself({target:M.target,delegatedTarget:U,iframe:null,coords:{x:Q,y:Y}})}));return U},_generateColumnSwitcherMenu:function(y){var G=y.fieldInfos,L=this.css,O;var U=new T({className:L.optionsMenu});v.forEach(y.columns,function(M){var Q=
parseInt(M.id,10),Y=g.findFirst(G,"name",M.field);"esriRelatedRecords"===M.type||"esriRelatedRecordsSmall"===M.field||"esriAttachments"===M.type||"esriFieldTypeGUID"===Y.type||"esriFieldTypeGlobalID"===Y.type||-1!==v.indexOf(y._unsupportedFieldTypes,Y.type)||M.hidden||(O=new E({label:M.label||M.field,baseClass:L.menuItem,tabIndex:1}),h(O,S,u.hitch(this,function(){this._removeHiddenColumnRules(y);this._addHiddenColumnRules({grid:y,columnId:Q});this.emit("column-focus-change",{fieldInfo:Y,column:M})})),
U.addChild(O))},this);U.startup();return U},_removeButtonNode:function(y){y&&y&&y.parentNode&&y.parentNode.removeChild(y)},_showDetailedFieldViewCallback:function(y,G){var L=G.columnId,O=G.fieldInfo;G=this._centerPaneNode;var U=this._leadingPaneNode,M=U.domNode.getBoundingClientRect().width/6,Q;y.showFeatureCount=!1;y.showFieldDetails=!1;y.updateHeaderText();y.hideOptionsMenu();this._shrinkGrid({grid:y,centerPane:G,leadingPane:U,columnId:L,finalWidth:M}).then(u.hitch(this,function(){Q=this._generateColumnSwitcherButton(y);
this._addHiddenColumnRules({grid:y,columnId:L});y.updateSelectionMode("single");y.refresh();this.resize();this.emit("show-detailed-field-view",{columnId:L,grid:y,fieldInfo:O,pickerButton:Q})}))},_updatePopupInfosDateFormat:function(y){v.forEach(y,function(G){G.format&&G.format.dateFormat&&(G.format.dateFormat=this._popupDateFormats[G.format.dateFormat])},this);return y}});u.setObject("dijit.FeatureTable",t,e);return t})},"esri/dijit/FeatureTable/Grid":function(){define("../../kernel ../../arcadeProfiles/popupProfile ./dataUtils ./dialogUtils dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/keys dojo/on dojo/string dojo/dom-class dojo/dom-construct dojo/Deferred dojox/html/entities dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_WidgetBase dijit/a11yclick dijit/focus dijit/Menu dijit/MenuItem dijit/Tooltip dijit/form/Button dijit/form/DateTextBox dijit/form/DropDownButton dijit/form/NumberTextBox dijit/form/Select dijit/form/SimpleTextarea dijit/form/TimeTextBox dijit/form/ValidationTextBox dijit/layout/BorderContainer dijit/layout/ContentPane dgrid/OnDemandGrid dgrid/Selection dgrid/selector dgrid/Keyboard dgrid/editor dgrid/extensions/Pagination dgrid/extensions/DijitRegistry dgrid/extensions/ColumnHider dgrid/extensions/ColumnResizer dojo/i18n!../../nls/jsapi dojo/text!./templates/Grid.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U,M,Q,Y,fa,va,Aa,pa){c=g([v,w,u],{declaredClass:"esri.dijit.FeatureTable.Grid",baseClass:"esri-feature-table-grid",templateString:pa,map:null,layer:null,layerInfo:null,idProperty:"id",sort:null,defaultSort:null,filterIds:null,where:null,batchCount:50,editable:!1,editOn:"dblclick, keypress",css:null,showAttachments:!1,showRelatedRecords:!1,showCyclicalRelationships:!1,showStatistics:!1,showFieldDetails:!1,showGridHeader:!0,
showGridMenu:!0,showFilterMenuItems:!0,showDefaultSortMenuItem:!0,showFeatureCount:!0,showDataTypes:!1,showColumnHeaderTooltips:!1,showColumnHeaderTooltipsWithDescription:!1,showColumnHider:!1,syncSelection:!1,menuFunctions:null,columnMenuFunctions:null,gridOptions:null,dateOptions:null,visibleLayerIds:null,showExpressionFields:!1,loaded:!1,store:null,columns:null,fieldInfos:null,customFieldInfos:null,expressionInfos:null,expressionCache:{},noDataMessage:"",featureCount:0,selectedFeatureCount:0,selectedRows:null,
selectedRowIds:null,optionsMenu:null,optionsMenuAnchor:null,columnMenu:null,rollbackInfos:null,attachmentInfos:null,relatedRecordInfos:null,relatedRecordCounts:null,_i18nStrings:Aa.widgets.FeatureTable,_numericFieldTypes:["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeSmallInteger","number"],_unsupportedFieldTypes:["esriFieldTypeRaster","esriFieldTypeBlob","esriFieldTypeGeometry","esriFieldTypeXML"],_activeEditors:[],_relationshipColumnLimit:5,_nullConstant:"ft_null",
_watchers:null,_tableTitle:null,_previousSelectedRowIds:null,_loading:0,_lastClickedCell:null,postMixInProperties:function(){this.inherited(arguments);this.set({sort:{},columns:[],fieldInfos:[],selectedRows:[],selectedRowIds:[],rollbackInfos:{},attachmentInfos:{},relatedRecordInfos:{},relatedRecordCounts:{},_watchers:[],_previousSelectedRowIds:[]})},startup:function(){this.inherited(arguments);this.showExpressionFields&&this.expressionInfos&&(this.expressionCache=p.compileExpressions(this.expressionInfos));
this.dGrid=this._generateBaseGrid();this._cleanUpGrid();this.dGrid.startup();this.dGrid.resize();this.updateHeaderText();this._generateOptionsMenu();this.showGridHeader||this.hideHeader();this.showGridMenu||this.hideOptionsMenu();this._addGridListeners()},destroy:function(){this.inherited(arguments);this.optionsMenu&&this.optionsMenu.destroy();this.columnMenu&&this.columnMenu.destroyRecursive();n.forEach(this._watchers,function(N){N.remove()})},resize:function(){this._gridBorderContainerNode&&this._gridBorderContainerNode.resize();
this._gridHeaderNode&&this._gridHeaderNode.resize();this._gridContentPaneNode&&this._gridContentPaneNode.resize();this.dGrid&&this.dGrid.resize()},setHeaderTitle:function(N){p.sanitizer&&(N=p.sanitizer.sanitize(N));this._gridTitleNode&&(this._gridTitleNode.innerHTML=N)},showHeader:function(){f.remove(this._gridHeaderNode.domNode,this.css.hidden);this.resize()},hideHeader:function(){f.add(this._gridHeaderNode.domNode,this.css.hidden);this.resize()},showLoadingIndicator:function(){this._gridLoadingIndicatorNode&&
0===this._loading&&f.remove(this._gridLoadingIndicatorNode,this.css.hidden);this._loading++},hideLoadingIndicator:function(){this._loading--;this._gridLoadingIndicatorNode&&!this._loading&&f.add(this._gridLoadingIndicatorNode,this.css.hidden)},showOptionsMenu:function(){this._menuNode&&f.remove(this._menuNode,this.css.hidden)},hideOptionsMenu:function(){this._menuNode&&f.add(this._menuNode,this.css.hidden)},updateNoDataMessage:function(N){this.dGrid.set("noDataMessage",N)},showColumnHiderMenu:function(){this.gridOptions.columnHider&&
this.dGrid._toggleColumnHiderMenu()},refresh:function(){this.dGrid&&this.dGrid.refresh();0===this.featureCount&&this.hideLoadingIndicator();this._updateSelection().then(m.hitch(this,this.updateHeaderText))},getRowById:function(N){return this.dGrid.row(N)||{}},getRowDataById:function(N){return(N=this.getRowById(N))&&N.data?N.data:{}},emptyStore:function(){this.updateNoDataMessage("");this.updateStore(null)},updateStore:function(N){this.set("store",N);this.dGrid.set("store",N)},updateSort:function(N){this.set("sort",
N[0]);this.dGrid.set("sort",N)},updateSelectionMode:function(N){this.dGrid.set("selectionMode",N)},getColumns:function(){return this.dGrid.columns},styleColumn:function(N,V){return this.dGrid.styleColumn(N,V)},clearSelection:function(){this.dGrid.clearSelection();this._updateSelection().then(m.hitch(this,this.updateHeaderText));this.emit("clear-selection")},centerOnSelection:function(){var N=this.map,V=this.selectedRowIds;if(N&&V&&0!==V.length)return p.queryLayerForFeatures({layer:this.layer,ids:V}).then(m.hitch(function(Z){(Z=
Z.features)&&0<Z.length&&N.setExtent(p.calculateExtentFromFeatures(Z))}))},selectRows:function(N,V,Z){var ba=this.dGrid,ma=[];this._closeCellEditors();this.clearSelection();if(N instanceof Array){n.forEach(N,function(Ea){ba._select(Ea);ma.push(this.getRowById(Ea))},this);var sa=N[0]}else ba._select(N),sa=N,ma=[this.getRowById(N)];this._updateSelection().then(m.hitch(this,function(){this.updateHeaderText();Z||this.emit("row-select",{rows:ma,grid:this.dGrid});V&&this._scrollToRow(sa)}))},_generateBaseGrid:function(){var N=
this.gridOptions||{},V=[Y,G,L,M,O,U];N.pagination&&V.push(Q);N.columnHider&&V.push(fa);N.columnResizer&&V.push(va);return new (g(V))({columns:this.columns,sort:[this.defaultSort],noDataMessage:this.noDataMessage,selectionMode:N.selectionMode,allowSelectAll:N.allowSelectAll,allowTextSelection:N.allowTextSelection,cellNavigation:N.cellNavigation,keepScrollPosition:N.keepScrollPosition,pageSizeOptions:N.pageSizeOptions,queryRowsOverlap:N.queryRowsOverlap,minRowsPerPage:this.batchCount,maxRowsPerPage:this.batchCount,
pagingDelay:this.pagingDelay,query:m.hitch(this,this._getQueryForGrid)},this._gridNode)},_getQueryForGrid:function(N){return!this.filterIds||-1!==n.indexOf(this.filterIds,N[this.idProperty])},_cleanUpGrid:function(){var N=this.dGrid,V=b.before(N,"removeRow",m.hitch(this,function(ba){n.forEach(this.columns.length,function(ma,sa){ma=N.cell(ba,sa).element;(ma=ma.contents||ma)&&ma.widget&&ma.widget.destroyRecursive()})})),Z=b.after(N,"renderHeader",function(){N._sortListener.remove()});this._watchers.push(V,
Z)},_setUpColumns:function(N){N=this._generateFieldInfos(N);var V=this._generateColumns(N);this.set({columns:V,fieldInfos:N});this.dGrid.set("columns",V);return{fieldInfos:N,columns:V}},_generateFieldInfos:function(N){if(N&&0!==N.length&&this.layerInfo){N=this._orderFieldsForDisplay(N);var V=this.layer,Z=this.layerInfo,ba=[],ma=this.customFieldInfos;n.forEach(N,function(sa){var Ea=sa.name,ya=sa.length||null,wa=p.findFirst(V.fields,"name",Ea)||{},aa=p.findFirst(ma,"name",Ea)||p.findFirst(ma,"fieldName",
Ea);if(p.isExpressionField(Ea)){wa=p.getExpressionInfo(this.expressionInfos,Ea);var ca=K.isAsync(this.expressionCache[wa.name]);ba.push({name:wa.name,expression:!0,hasFeatureSetOperations:ca,length:ya,hidden:!aa.visible,alias:sa.alias,type:sa.type,editable:sa.editable,nullable:sa.nullable,domain:!1,typeId:!1,subtypeField:!1,subtypeDomain:!1,format:aa.format||null,dateOptions:null,description:sa.description})}else{var ka=this.idProperty,qa=this.outFields,da=this.hiddenFields;ca=aa&&(aa.label||aa.alias)||
wa.alias;var ia=V.getDomain&&V.getDomain(Ea)?V.getDomain(Ea):!1;var ra=!(!Z.typeIdField||Ea!==Z.typeIdField);var Fa=!(!Z.subtypeField||Ea!==Z.subtypeField);var ea=Z.types&&n.some(Z.types,function(ta){if(ta.domains&&ta.domains[Ea]&&ta.domains[Ea].name)return!0});qa=!this._getFieldVisibility({field:sa,hiddenFields:da,customFieldInfo:aa,outFields:qa});da=Z.editable&&Z.editCapabilities.canUpdate;var xa=aa&&("undefined"!==typeof aa.editable&&!1!==wa.editable||"undefined"!==typeof aa.isEditable&&!1!==wa.isEditable);
ka=da&&Ea!==ka&&wa&&"undefined"!==wa.editable?xa?!!aa.editable||!!aa.isEditable:!!wa.editable:!1;da=aa&&aa.format?aa.format:null;ba.push({name:Ea,alias:ca,length:ya,type:sa.type,hidden:qa,editable:ka,nullable:!!wa.nullable,domain:ia,typeId:ra,subtypeField:Fa,subtypeDomain:ea,format:da,dateOptions:aa&&(aa.dateOptions||aa.format&&aa.format.dateFormat)||null,stringOptions:aa&&aa.stringOptions?aa.stringOptions:null,description:sa.description})}},this);n.every(ba,function(sa){return sa.hidden})&&(p.findFirst(ba,
"name",this.idProperty).hidden=!1);this.showRelatedRecords&&(N=this._generateRelatedRecordFieldInfos({relationships:V.relationships}),ba=ba.concat(N));this.showAttachments&&ba.push({alias:this._i18nStrings.photosAndFiles,name:"esriAttachments",type:"esriAttachments",editable:Z.editable});return ba}},_destroyColumns:function(){this.dGrid&&this.dGrid._destroyColumns()},_getFieldVisibility:function(N){var V=N.field,Z=N.outFields,ba=N.customFieldInfo;N=-1!==n.indexOf(N.hiddenFields,V.name);ba=!(!ba||
!1!==ba.visible);Z="*"!==Z[0]&&-1===n.indexOf(Z,V.name);V="esriFieldTypeOID"===V.type||"esriFieldTypeGlobalID"===V.type;return!(N||V&&(ba||Z)||ba||Z)},_applyEdits:function(N){var V=N.row,Z=N.rollbackInfo;this.showLoadingIndicator();Z&&this._updateRollbackInfos(Z);this.emit("data-change",{row:V,rollbackInfo:Z});return p.applyEditsFromRow({layer:this.layer,idProperty:this.idProperty,row:V}).then(m.hitch(this,function(ba){var ma=ba.updates||[];ma&&ma.length&&n.forEach(ma,function(sa){sa.success||(sa.error?
this.emit("error",{message:sa.error}):this.emit("error",{message:this._i18nStrings.errorUpdateFailed}),Z?(V=this.getRowDataById(Z.rowId),V[Z.fieldName]=Z.oldValue,this.dGrid.updateDirty(Z.rowId,Z.fieldName,Z.oldValue),this.refresh()):this.emit("error",{message:this._i18nStrings.errorRollback}))},this);this.hideLoadingIndicator();this.emit("edits-complete",ba)})).otherwise(m.hitch(this,function(){Z&&(V=this.getRowDataById(Z.rowId),V[Z.fieldName]=Z.oldValue,this.dGrid.updateDirty(Z.rowId,Z.fieldName,
Z.oldValue),this.refresh());this.hideLoadingIndicator();this.emit("error",{message:this._i18nStrings.errorUpdateFailed})}))},_updateRollbackInfos:function(N){if(N){var V=N.rowId;this.rollbackInfos[V]||(this.rollbackInfos[V]=[]);this.rollbackInfos[V].push(N)}},_updateSelection:function(){var N=this.dGrid.selection,V=new q,Z=[],ba=[],ma;for(ma in N)if(N.hasOwnProperty(ma)){var sa=parseInt(ma,10);ba.push(sa);sa=this.dGrid.row(sa);(sa=sa.data)&&Z.push(sa)}N={selectedRows:Z,selectedRowIds:ba,selectedFeatureCount:ba.length};
this.set(N);V.resolve(N);return V},_scrollToRow:function(N){var V=this.store,Z=this.dGrid,ba=Z.row(N),ma=this.sort;if(ba&&V)if(ba.element)ba.element.scrollIntoView();else if(N=V.data[N]||ba.data)V=ma&&ma.attribute===this.idProperty&&ma.descending?V.data.length-n.indexOf(V.data,N):n.indexOf(V.data,N),Z.scrollTo({x:0,y:Z.rowHeight*V-Z.rowHeight}),ba.element?ba.element.scrollIntoView():setTimeout(function(){ba.element&&ba.element.scrollIntoView()},200)},_generateColumns:function(N){N=m.clone(N)||[];
var V=[];n.forEach(N,function(Z){Z.expression?V.push(this._generateExpressionColumn(Z)):"esriAttachments"===Z.type?V.push(this._generateAttachmentsColumn(Z)):"esriRelatedRecords"===Z.type?V.push(this._generateRelatedRecordsColumn(Z)):"esriFieldTypeDate"===Z.type?this.dateOptions.timeEnabled||Z.dateOptions&&Z.dateOptions.timeEnabled?V.push(this._generateDateTimeColumn(Z)):V.push(this._generateDateColumn(Z)):!Z.subtypeDomain||Z.typeId||Z.subtypeField?Z.domain?V.push(this._generateDomainColumn(Z)):Z.typeId?
V.push(this._generateTypeColumn(Z,"types","id")):Z.subtypeField?V.push(this._generateTypeColumn(Z,"subtypes","code")):-1<n.indexOf(this._numericFieldTypes,Z.type)?V.push(this._generateNumberColumn(Z)):-1===n.indexOf(this._unsupportedFieldTypes,Z.type)&&V.push(this._generateStringColumn(Z)):V.push(this._generateSubtypeDomainColumn(Z))},this);return V},_orderFieldsForDisplay:function(N){var V=this.outFields,Z=this.idProperty,ba=[];if(V&&"*"===V[0])ba=m.clone(N);else{if(!p.isValueEmpty(Z)&&-1===n.indexOf(V,
Z)){var ma=p.findFirst(N,"name",Z);ma&&ba.push(ma)}n.forEach(V,function(sa){var Ea=p.findFirst(N,"name",sa);Ea&&sa!==Z&&-1===n.indexOf(ba,Ea)&&ba.push(Ea)},this);n.forEach(N,function(sa){-1===n.indexOf(ba,sa)&&ba.push(m.clone(sa))})}return ba},_generateDateColumn:function(N){var V=N.dateOptions||this.dateOptions;return{label:N.alias,field:N.name,type:N.type,hidden:N.hidden,className:this.css.dateValue,get:m.hitch(this,function(Z){return p.isValueEmpty(Z[N.name])?null:p.formatDateForLocale({dateOptions:V,
timestamp:new Date(Z[N.name]),fieldInfo:N})}),renderCell:m.hitch(this,function(Z,ba,ma){ba=r.create("div",{innerHTML:p.isValueEmpty(ba)?"":ba},ma);this._setUpDateCell({row:Z,cellNode:ma,fieldInfo:N,container:ba})}),renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N})})}},_generateDateTimeColumn:function(N){return{label:N.alias,field:N.name,type:N.type,hidden:N.hidden,className:this.css.dateValue,get:m.hitch(this,function(V){return p.isValueEmpty(V[N.name])?
null:p.formatDateForLocale({dateOptions:N.dateOptions||this.dateOptions,timestamp:new Date(V[N.name]),fieldInfo:N})}),renderCell:m.hitch(this,function(V,Z,ba){Z=r.create("div",{innerHTML:p.isValueEmpty(Z)?"":Z},ba);this._setUpDateTimeCell({row:V,cellNode:ba,fieldInfo:N,container:Z})}),renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N})})}},_generateDomainColumn:function(N){return{label:N.alias,field:N.name,type:N.type,hidden:N.hidden,get:function(V){return p.getDomainValueFromRow({fieldInfo:N,
row:V})},renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N})}),renderCell:m.hitch(this,function(V,Z,ba){var ma=r.create("div");if(N.domain.codedValues)Z=this._formatStringCellContent({fieldInfo:N,value:Z}),Z=String(Z),Z=t.encode(Z),this._setUpCodedValueDomainCell({row:V,cellNode:ba,fieldInfo:N,container:ma});else if("range"===N.domain.type)Z=p.isDateFieldWithStringDataValue(N.type)?this._formatStringCellContent({fieldInfo:N,value:Z}):this._formatNumberCellContent({fieldInfo:N,
value:Z}),this._setUpRangeDomainCell({row:V,cellNode:ba,fieldInfo:N,container:ma});else{this.emit("error",{message:this._i18nStrings.errorDomainType});return}ma.innerHTML=Z;r.place(ma,ba)})}},_generateTypeColumn:function(N,V,Z){return{label:N.alias,field:N.name,type:N.type,hidden:N.hidden,get:m.hitch(this,function(ba){var ma=p.getTypeValueFromRow({layerInfo:this.layerInfo,fieldInfo:N,row:ba,typesProperty:V,typeIdProperty:Z});return p.isValueEmpty(ma)?ba[N.name]:ma}),renderCell:m.hitch(this,function(ba,
ma,sa){ma=this._formatStringCellContent({fieldInfo:N,value:ma});ma=r.create("div",{innerHTML:ma},sa);this._setUpTypeCell({row:ba,cellNode:sa,fieldInfo:N,container:ma,typesProperty:V,typeIdProperty:Z})}),renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N})})}},_generateSubtypeDomainColumn:function(N){return{label:N.alias,field:N.name,type:N.type,hidden:N.hidden,editOn:this.editOn,editor:"text",get:m.hitch(this,function(V){return p.getSubtypeDomainValue({layerInfo:this.layerInfo,
fieldInfo:N,row:V})}),renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N})}),renderCell:m.hitch(this,function(V,Z,ba){Z=this._formatStringCellContent({fieldInfo:N,value:Z});Z=r.create("div",{innerHTML:Z},ba);this._setUpSubtypeDomainCell({row:V,cellNode:ba,fieldInfo:N,container:Z})})}},_generateNumberColumn:function(N){return{label:N.alias,field:N.name,type:N.type,hidden:N.hidden,renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N})}),
renderCell:m.hitch(this,function(V,Z,ba){Z=this._formatNumberCellContent({fieldInfo:N,value:Z});Z=r.create("div",{innerHTML:Z},ba);this._setUpNumberCell({row:V,cellNode:ba,fieldInfo:N,container:Z})})}},_generateStringColumn:function(N){return{label:N.alias,field:N.name,type:N.type,hidden:N.hidden,renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N})}),renderCell:m.hitch(this,function(V,Z,ba){Z=this._formatStringCellContent({fieldInfo:N,value:Z});Z=r.create("div",
{innerHTML:Z},ba);this._setUpStringCell({row:V,cellNode:ba,fieldInfo:N,container:Z})})}},_generateAttachmentsColumn:function(N){var V=this.layerInfo||{};return{label:N.alias,field:N.name,type:"esriAttachments",sortable:!1,get:m.hitch(this,function(Z){Z=this.attachmentInfos[Z[this.idProperty]];var ba=V.queryAttachmentsSupported?0:null;return Z&&Z.attachments?Z.attachments.length:ba}),renderCell:m.hitch(this,function(Z,ba,ma){this._generateAttachmentsCell({row:Z,fieldInfo:N,cellValue:ba,cellNode:ma})}),
renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N,cssClass:this.css.attachmentsTitle})})}},_generateRelatedRecordsColumn:function(N){return{label:N.alias,field:N.name,type:"esriRelatedRecords",hidden:N.hidden,sortable:!1,get:m.hitch(this,function(V){return this._getRelatedRecordsCount({featureId:V[this.idProperty],relationshipId:N.relationship.id})}),renderCell:m.hitch(this,function(V,Z,ba){this._generateRelatedRecordsCell({row:V,fieldInfo:N,cellValue:Z,
cellNode:ba})}),renderHeaderCell:m.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:N,cssClass:this.css.relatedRecordsTitle})})}},_generateExpressionColumn:function(N){return{label:N.alias,field:N.name,type:"esriExpressions",sortable:!1,get:m.hitch(this,function(V){return N.hasFeatureSetOperations?null:this._getExpressionValueForField(N.name,V)}),renderCell:m.hitch(this,function(V,Z,ba){this._generateExpressionCell({row:V,fieldInfo:N,cellValue:Z,cellNode:ba})}),renderHeaderCell:m.hitch(this,
function(){return this._getColumnHeaderCellContent({fieldInfo:N,cssClass:this.css.expressionsTitle})})}},_closeCellEditors:function(){n.forEach(this._activeEditors,function(N){N.widget.onBlur()});this.set("_activeEditors",[])},_getColumnHeaderCellContent:function(N){var V=N.fieldInfo,Z=N.cssClass||null;N=this.css;var ba=r.create("div",{className:N.columnHeader});var ma=Z?N.columnHeaderTitle+" "+Z:N.columnHeaderTitle;!V.editable&&this.editable&&this.layerInfo.editable&&r.create("span",{className:N.lockedIconContainer+
" "+N.lockedIcon},ba);Z=t.encode(V.alias||V.name);r.create("div",{innerHTML:Z,className:ma},ba);r.create("div",{className:N.columnHeaderClear},ba);if(this.showColumnHeaderTooltips||this.showColumnHeaderTooltipsWithDescription)this.showColumnHeaderTooltipsWithDescription&&this.layer.supportsFieldDescription&&V.description&&V.description.value&&(Z+=" - "+t.encode(V.description.value)),this.own(new J({connectId:[ba],label:"\x3cdiv class\x3d"+N.columnHeaderTooltip+"\x3e"+Z+"\x3c/div\x3e"}));Z="esriExpressions"===
V.type||"esriRelatedRecords"===V.type||"esriAttachments"===V.type;this.showDataTypes&&!Z&&(r.create("div",{innerHTML:V.type.replace("esriFieldType",""),className:N.columnHeaderType},ba),r.create("div",{className:N.columnHeaderClear},ba));return ba},_setUpNumberCell:function(N){var V=N.row,Z=N.cellNode,ba=N.fieldInfo,ma=N.container,sa=this.idProperty,Ea=p.isIntegerFieldType(ba.type)?0:"0,20",ya,wa;this.editOn===x&&l(Z,"pointerdown",m.hitch(this,function(aa){aa.preventDefault()}));l(Z,this.editOn,m.hitch(this,
function(){var aa=p.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:V});this.editable&&ba.editable&&!1!==aa&&!p.findFirst(this._activeEditors,"cellNode",Z)&&(this._lastClickedCell!==Z&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==Z?this._lastClickedCell=Z:(ma.innerHTML="",ya=new T({value:V[ba.name],required:!ba.nullable,constraints:{places:Ea}}),ya.placeAt(ma),ya.focus(),ya.textbox.select(),this.emit("editor-show",{cell:Z,editor:ya,grid:this}),ya.on("blur",
m.hitch(this,function(){ma.innerHTML=this._formatNumberCellContent({fieldInfo:ba,value:V[ba.name]});Z.focus();this.emit("editor-hide",{cell:Z,editor:ya,grid:this});this._activeEditors.pop()})),ya.on("keydown",function(ca){ca.keyCode===d.ENTER&&ya.isValid()&&ya.focusNode.blur()}),ya.on("change",m.hitch(this,function(ca){wa={fieldName:ba.name,oldValue:V[ba.name],rowId:V[sa],row:V};if(""===ca||isNaN(ca))ca=null;ya.isValid()?(V[ba.name]=ca,ma.innerHTML=this._formatNumberCellContent({fieldInfo:ba,value:ca}),
this._applyEdits({row:V,rollbackInfo:wa})):ma.innerHTML=this._formatNumberCellContent({fieldInfo:ba,value:V[ba.name]});ya.destroy()})),this._activeEditors.push({cellNode:Z,id:V[sa],widget:ya})))}))},_setUpDateCell:function(N){var V=N.row,Z=N.cellNode,ba=N.fieldInfo,ma=N.container,sa=this.idProperty,Ea,ya;this.editOn===x&&l(Z,"pointerdown",m.hitch(this,function(wa){wa.preventDefault()}));l(Z,this.editOn,m.hitch(this,function(){var wa=p.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:V});
if(this.editable&&ba.editable&&!1!==wa)if(this._lastClickedCell!==Z&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==Z)this._lastClickedCell=Z;else{ma.innerHTML="";ya=ba.dateOptions&&ba.dateOptions.datePattern?ba.dateOptions.datePattern:this.dateOptions.datePattern;Ea=p.isValueEmpty(V[ba.name])?null:new Date(V[ba.name]);var aa=new R({value:Ea,constraints:{datePattern:ya}});aa.placeAt(ma);aa.focus();aa.textbox.select();this.emit("editor-show",{cell:Z,editor:aa,grid:this});aa.on("blur",
m.hitch(this,function(){ma.innerHTML=p.isValueEmpty(V[ba.name])?null:p.formatDateForLocale({dateOptions:this.dateOptions,timestamp:V[ba.name],fieldInfo:ba});Z.focus();this.emit("editor-hide",{cell:Z,editor:aa,grid:this});this._activeEditors.pop()}));aa.on("keydown",function(ca){ca.keyCode===d.ENTER&&aa.isValid()&&aa.focusNode.blur()});aa.on("change",m.hitch(this,function(ca){if(aa.isValid()){var ka={fieldName:ba.name,oldValue:V[ba.name],rowId:V[sa],row:V};V[ba.name]=p.isValueEmpty(ca)?null:ca.getTime();
ma.innerHTML=p.isValueEmpty(V[ba.name])?null:p.formatDateForLocale({dateOptions:this.dateOptions,timestamp:V[ba.name],fieldInfo:ba});this._applyEdits({row:V,rollbackInfo:ka})}else ma.innerHTML=p.isValueEmpty(V[ba.name])?null:p.formatDateForLocale({dateOptions:this.dateOptions,timestamp:V[ba.name],fieldInfo:ba})}));this._activeEditors.push({cellNode:Z,id:V[sa],widget:aa})}}))},_setUpDateTimeCell:function(N){var V=N.row,Z=N.cellNode,ba=N.fieldInfo,ma=N.container,sa=this.idProperty,Ea,ya,wa;l(Z,this.editOn,
m.hitch(this,function(){var aa=p.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:V});if(this.editable&&ba.editable&&!1!==aa)if(this._lastClickedCell!==Z&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==Z)this._lastClickedCell=Z;else{this._closeCellEditors();ma.innerHTML="";ya=ba.dateOptions&&ba.dateOptions.datePattern?ba.dateOptions.datePattern:this.dateOptions.datePattern;wa=ba.dateOptions&&ba.dateOptions.timePattern?ba.dateOptions.timePattern:this.dateOptions.timePattern;
Ea=p.isValueEmpty(V[ba.name])?null:new Date(V[ba.name]);var ca=new R({value:Ea,constraints:{datePattern:ya}}),ka=new F({value:Ea,constraints:{timePattern:wa}});ca.placeAt(ma);ka.placeAt(ma);ca.focus();ca.textbox.select();this.emit("editor-show",{cell:Z,editor:[ca,ka],grid:this});ca.on("change",m.hitch(this,function(da){ca.isValid()&&(null===da||""===da?ka.setValue(null):(da=ka.getValue(),null===da&&(da=new Date(0,0),ka.setValue(da))))}));ka.on("change",m.hitch(this,function(da){ka.isValid()&&(null===
da||""===da?ca.setValue(null):(da=ca.getValue(),null===da&&(da=new Date(0,0),ca.setValue(da))))}));var qa=z.watch("activeStack",m.hitch(this,function(da,ia,ra){da=-1!==n.indexOf(ia,ca.id)||-1!==n.indexOf(ia,ka.id);ra=-1===n.indexOf(ra,ca.id)&&-1===n.indexOf(ra,ka.id);if(da&&ra){qa.remove();this.emit("editor-hide",{cell:Z,editor:[ca,ka],grid:this});da=ca.getValue();ia=ka.getValue();ra=V[ba.name];if(ka.isValid()&&ca.isValid()){da&&ia?(da=p.getCombinedDateTime(da,ia).getTime(),ma.innerHTML=p.formatDateForLocale({dateOptions:this.dateOptions,
timestamp:new Date(da),fieldInfo:ba})):(da=null,ma.innerHTML="");if(V[ba.name]===da)return;V[ba.name]=da;this._applyEdits({row:V,rollbackInfo:{fieldName:ba.name,oldValue:ra,rowId:V[sa],row:V}})}else ma.innerHTML=null===ra?"":p.formatDateForLocale({dateOptions:this.dateOptions,timestamp:V[ba.name],fieldInfo:ba});ca.destroy();ka.destroy()}}))}}))},_setUpCodedValueDomainCell:function(N){var V=N.row,Z=N.cellNode,ba=N.fieldInfo;this.editOn===x&&l(Z,"pointerdown",m.hitch(this,function(ma){ma.preventDefault()}));
l(Z,this.editOn,m.hitch(this,function(){var ma=p.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:V});if(this.editable&&ba.editable&&!1!==ma&&!p.findFirst(this._activeEditors,"cellNode",Z))if(this._lastClickedCell!==Z&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==Z)this._lastClickedCell=Z;else{var sa=ba.name;ma=ba.domain.codedValues;var Ea=N.container,ya=V[this.idProperty],wa=[];Ea.innerHTML="";n.forEach(ma,function(ca){wa.push({label:t.encode(String(ca.name)),
value:String(ca.code),selected:V[sa]===ca.code})});p.isValueEmpty(V[sa])?wa.push({label:this._i18nStrings.empty,value:this._nullConstant,selected:!0,disabled:!ba.nullable}):ba.nullable&&wa.push({label:this._i18nStrings.empty,value:this._nullConstant});var aa=new E({options:wa,"class":this.css.select,style:{width:"100%"}});aa.placeAt(Ea);aa.focus();this.emit("editor-show",{cell:Z,editor:aa,grid:this});aa.on("blur",m.hitch(this,function(){var ca=p.getDomainValueFromRow({fieldInfo:ba,row:V});ca=this._formatStringCellContent({fieldInfo:ba,
value:ca});ca=String(ca);Ea.innerHTML=t.encode(ca);this.emit("editor-hide",{cell:Z,editor:aa,grid:this});this._activeEditors.pop()}));aa.on("keydown",function(ca){ca.keyCode===d.ENTER&&aa.focusNode.blur()});aa.on("change",m.hitch(this,function(ca){var ka={fieldName:sa,oldValue:V[sa],rowId:ya,row:V};ca===this._nullConstant?ca=null:p.isNumericFieldType(ba.type)&&(ca=Number(ca));V[sa]=ca;aa.onBlur();this._applyEdits({row:V,rollbackInfo:ka});aa.destroy();aa=null}));this._activeEditors.push({cellNode:Z,
id:ya,widget:aa})}}))},_setUpRangeDomainCell:function(N){var V=N.row,Z=N.cellNode,ba=N.fieldInfo,ma=N.container,sa=ba.domain.minValue,Ea=ba.domain.maxValue,ya=this.idProperty,wa=p.isIntegerFieldType(ba.type)?0:"0,20",aa;this.editOn===x&&l(Z,"pointerdown",m.hitch(this,function(ca){ca.preventDefault()}));l(Z,this.editOn,m.hitch(this,function(){var ca=p.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:V});if(this.editable&&ba.editable&&!1!==ca&&!p.findFirst(this._activeEditors,
"cellNode",Z))if(this._lastClickedCell!==Z&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==Z)this._lastClickedCell=Z;else{ma.innerHTML="";var ka=p.isDateFieldWithStringDataValue(ba.type)?new D({value:V[ba.name],required:!ba.nullable}):new T({value:V[ba.name],required:!ba.nullable,constraints:{min:sa,max:Ea,places:wa}});ka.placeAt(ma);ka.focus();ka.textbox.select();this.emit("editor-show",{cell:Z,editor:ka,grid:this});ka.on("blur",m.hitch(this,function(){value=p.isDateFieldWithStringDataValue(ba.type)?
this._formatStringCellContent({fieldInfo:ba,value:V[ba.name]}):this._formatNumberCellContent({fieldInfo:ba,value:V[ba.name]});ma.innerHTML=value;this.emit("editor-hide",{cell:Z,editor:ka,grid:this});this._activeEditors.pop()}));ka.on("keydown",function(qa){qa.keyCode===d.ENTER&&ka.isValid()&&ka.focusNode.blur()});ka.on("change",m.hitch(this,function(qa){aa={fieldName:ba.name,oldValue:V[ba.name],rowId:V[ya],row:V};ka.isValid()&&(V[ba.name]=qa,this._applyEdits({row:V,rollbackInfo:aa}));ka.onBlur();
ka.destroy();ka=null}));this._activeEditors.push({cellNode:Z,id:V[ya],widget:ka})}}))},_setUpTypeCell:function(N){var V=N.row,Z=N.cellNode,ba=N.fieldInfo,ma=N.container,sa=N.typesProperty,Ea=N.typeIdProperty,ya=this.idProperty,wa=this.layerInfo,aa=wa[sa],ca;this.editOn===x&&l(Z,"pointerdown",m.hitch(this,function(ka){ka.preventDefault()}));l(Z,this.editOn,m.hitch(this,function(){var ka=p.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:V});if(this.editable&&ba.editable&&!1!==
ka&&!p.findFirst(this._activeEditors,"cellNode",Z))if(this._lastClickedCell!==Z&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==Z)this._lastClickedCell=Z;else{ma.innerHTML="";ka=p.isValueEmpty(p.getTypeValueFromRow({layerInfo:this.layerInfo,fieldInfo:ba,row:V,typesProperty:sa,typeIdProperty:Ea}));var qa=ba.name,da=V[qa],ia=[];n.forEach(aa,function(Fa){ia.push({label:Fa.name,value:String(Fa[Ea]),selected:da===Fa[Ea]})});p.isValueEmpty(da)?ia.push({label:this._i18nStrings.empty,value:this._nullConstant,
selected:!0,disabled:!0}):ka&&ia.push({label:String(da),value:String(da),selected:!0,disabled:!0});var ra=new E({options:ia,"class":this.css.select,style:{width:"100%"}});ra.placeAt(ma);ra.focus();this.emit("editor-show",{cell:Z,editor:ra,grid:this});ra.on("blur",m.hitch(this,function(){var Fa=p.getTypeValueFromRow({layerInfo:wa,fieldInfo:ba,row:V,typesProperty:sa,typeIdProperty:Ea});ma.innerHTML=this._formatStringCellContent({fieldInfo:ba,value:Fa||da});this.emit("editor-hide",{cell:Z,editor:ra,
grid:this.grid});this._activeEditors.pop()}));ra.on("keydown",function(Fa){Fa.keyCode===d.ENTER&&ra.focusNode.blur()});ra.on("change",m.hitch(this,function(Fa){ca={fieldName:qa,oldValue:da,rowId:V[ya],row:V};Fa===this._nullConstant?Fa=null:p.isNumericFieldType(ba.type)&&(Fa=Number(Fa));V[qa]=Fa;ra.onBlur();this._applyEdits({row:V,rollbackInfo:ca});ra.destroy();ra=null}));this._activeEditors.push({cellNode:Z,id:V[ya],widget:ra})}}))},_setUpSubtypeDomainCell:function(N){var V=N.cellNode;this.editOn===
x&&l(V,"pointerdown",m.hitch(this,function(Z){Z.preventDefault()}));l(V,this.editOn,m.hitch(this,function(){var Z=this.layerInfo,ba=N.fieldInfo,ma=N.row,sa=p.isFeatureEditable({layer:this.layer,layerInfo:Z,attributes:ma});if(this.editable&&ba.editable&&!1!==sa&&!p.findFirst(this._activeEditors,"cellNode",V))if(this._lastClickedCell!==V&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==V)this._lastClickedCell=V;else{var Ea=ma[this.idProperty],ya=ba.name;Z=p.findFirst(Z.types,"id",
ma[Z.typeIdField]);var wa=N.container,aa={},ca;wa.innerHTML="";Z&&Z.domains&&(ca=Z.domains[ya]);if(ca&&"inherited"===ca.type||!ca&&ba.domain)ca=ba.domain;if(ca&&ca.codedValues){var ka=ca.codedValues,qa=p.findFirst(ka,"code",ma[ya]),da=!1,ia=[];n.forEach(ka,function(ea){ia.push({label:ea.name,value:String(ea.code),selected:ma[ya]===ea.code});ea.code===qa&&(da=!0)});p.isValueEmpty(ma[ya])&&ba.nullable?ia.push({label:this._i18nStrings.empty,value:this._nullConstant,selected:!0}):p.isValueEmpty(ma[ya])&&
!ba.nullable?ia.push({label:this._i18nStrings.empty,value:this._nullConstant,selected:!0,disabled:!0}):ba.nullable&&ia.push({label:this._i18nStrings.empty,value:this._nullConstant});da||qa||null===ma[ya]||ia.push({label:ma[ya].toString(),value:"N/A",selected:!0,disabled:!0});var ra=new E({options:ia,"class":this.css.select,style:{width:"100%"}});ra.placeAt(wa);ra.focus();this.emit("editor-show",{cell:V,editor:ra,grid:this});ra.on("blur",m.hitch(this,function(){var ea=p.findFirst(ka,"code",ma[ya]);
wa.innerHTML=ea?this._formatStringCellContent({fieldInfo:ba,value:ea.name}):this._formatStringCellContent({fieldInfo:ba,value:ma[ya]});this.emit("editor-hide",{cell:V,editor:ra,grid:this});this._activeEditors.pop()}));ra.on("keydown",function(ea){ea.keyCode===d.ENTER&&ra.focusNode.blur()});ra.on("change",m.hitch(this,function(ea){aa={fieldName:ya,oldValue:ma[ya],rowId:Ea,row:ma};ea===this._nullConstant?ea=null:p.isNumericFieldType(ba.type)&&(ea=Number(ea));ma[ya]=ea;ra.onBlur();this._applyEdits({row:ma,
rollbackInfo:aa});ra.destroy();ra=null}));this._activeEditors.push({cellNode:V,id:Ea,widget:ra})}else{var Fa=new T({value:ma[ya],required:!ba.nullable});ca&&"range"===ca.type&&(Fa.constraints={min:ca.minValue,max:ca.maxValue,places:p.isIntegerFieldType(ba.type)?0:"0,20"});Fa.placeAt(wa);Fa.focus();Fa.textbox.select();this.emit("editor-show",{cell:V,editor:Fa,grid:this});Fa.on("blur",m.hitch(this,function(){wa.innerHTML=ma[ya];this.emit("editor-hide",{cell:V,editor:Fa,grid:this});this._activeEditors.pop()}));
Fa.on("keydown",function(ea){ea.keyCode===d.ENTER&&Fa.isValid()&&Fa.focusNode.blur()});Fa.on("change",m.hitch(this,function(ea){aa={fieldName:ya,oldValue:ma[ya],rowId:Ea,row:ma};if(""===ea||isNaN(ea))ea=null;Fa.isValid()&&(ma[ya]=ea,this._applyEdits({row:ma,rollbackInfo:aa}));Fa.onBlur();Fa.destroy();Fa=null}));this._activeEditors.push({cellNode:V,id:Ea,widget:Fa})}}}))},_setUpStringCell:function(N){var V=N.row,Z=N.cellNode,ba=N.fieldInfo,ma=N.container,sa=this.idProperty;this.editOn===x&&l(Z,"pointerdown",
m.hitch(this,function(Ea){Ea.preventDefault()}));l(Z,this.editOn,m.hitch(this,function(){var Ea=p.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:V});if(this.editable&&ba.editable&&!1!==Ea&&!p.findFirst(this._activeEditors,"cellNode",Z))if(this._lastClickedCell!==Z&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==Z)this._lastClickedCell=Z;else{ma.innerHTML="";Ea=ba.stringOptions;var ya=Ea&&Ea.input&&"textarea"===Ea.input?new I({value:V[ba.name],required:!ba.nullable,
maxLength:ba.length?ba.length:null,trim:!0}):new D({value:V[ba.name],required:!ba.nullable,maxLength:ba.length?ba.length:null});ya.placeAt(ma);ya.focus();ya.textbox.select();this.emit("editor-show",{cell:Z,editor:ya,grid:this});ya.on("blur",m.hitch(this,function(){ma.innerHTML=this._formatStringCellContent({fieldInfo:ba,value:V[ba.name]});Z.focus();this.emit("editor-hide",{cell:Z,editor:ya,grid:this});this._activeEditors.pop()}));ya.on("keydown",function(wa){wa.keyCode===d.ENTER&&ya instanceof D&&
ya.isValid()&&ya.focusNode.blur()});ya.on("change",m.hitch(this,function(wa){var aa={fieldName:ba.name,oldValue:V[ba.name],rowId:V[sa],row:V};""===wa&&(wa=null);ya instanceof D&&ya.isValid()?(V[ba.name]=wa,this._applyEdits({row:V,rollbackInfo:aa})):ya instanceof I&&(!p.isValueEmpty(wa)||p.isValueEmpty(wa)&&ba.nullable)&&(V[ba.name]=wa,this._applyEdits({row:V,rollbackInfo:aa}));ma.innerHTML=this._formatStringCellContent({fieldInfo:ba,value:V[ba.name]});ya.destroy();ya=null}));this._activeEditors.push({cellNode:Z,
id:V[sa],widget:ya})}}))},_formatStringCellContent:function(N){var V=N.value;N=N.fieldInfo?N.fieldInfo.format:null;return p.isValueEmpty(V)?"":N?N.embeddedHTML||!1===N.link?V:N.template?h.substitute(N.template,{value:V}):V:p.generateLinkFromString(V)},_formatNumberCellContent:function(N){var V=N.fieldInfo?N.fieldInfo.format:null;N=N.value;if(p.isValueEmpty(N))return"";N=p.formatNumberForLocale(N,V);V&&V.template&&(N=h.substitute(V.template,{value:N}));this.isLeftToRight()||(N='\x3cspan dir\x3d"ltr"\x3e'+
N+"\x3c/span\x3e");return N},_generateAttachmentsCell:function(N){if(this.layerInfo){var V=N.row,Z=N.cellValue,ba=N.cellNode,ma=N.fieldInfo;N=this.layerInfo;var sa=this.css,Ea=this._i18nStrings;var ya=p.isValueEmpty(Z)?"":h.substitute(Ea.parenValue,{value:Z});var wa=r.create("div",{innerHTML:ya,className:sa.attachmentsCell},ba);r.create("span",{innerHTML:0<Z||!N.queryAttachmentsSupported?" "+Ea.show:this.editable&&N.editable?" "+Ea.add:"",className:sa.attachmentsLink},wa);l(wa,x,m.hitch(this,function(){this._showAttachmentsHandler({row:V,
fieldInfo:ma,cellValue:Z,cellNode:ba,textContainer:wa})}))}},_generateRelatedRecordsCell:function(N){var V=N.row,Z=N.cellValue,ba=N.cellNode,ma=N.fieldInfo;N=this.css;var sa=this._i18nStrings;var Ea=p.isValueEmpty(Z)?"":h.substitute(sa.parenValue,{value:Z})+" ";Ea=r.create("div",{innerHTML:Ea,className:N.relatedRecordsCell},ba);r.create("span",{innerHTML:0<Z?sa.show:"",className:N.relatedRecordsLink},Ea);l(ba,x,m.hitch(this,function(ya){0<Z&&(ya=this.dGrid.cell(ya).column,this._showRelatedRecordsHandler({row:V,
fieldInfo:ma,column:ya,count:Z}))}))},_generateExpressionCell:function(N){var V=N.row,Z=N.cellValue,ba=N.fieldInfo,ma=r.create("div",{className:this.css.expressionsCell},N.cellNode);if(ba.hasFeatureSetOperations)var sa=r.create("span",{innerHTML:this._i18nStrings.show,className:this.css.expressionsLink},ma),Ea=l(ma,x,m.hitch(this,function(){var ya=r.create("div",{className:this.css.cellLoadingIndicator});r.place(ya,sa,"replace");(ya=this._getExpressionValueForField(ba.name,V))&&ya.then?ya.then(m.hitch(this,
function(wa){ma.innerHTML=this._formatExpressionCellContent(ba,wa)})).otherwise(m.hitch(this,function(wa){ma.innerHTML=this._i18nStrings.dataError})):ma.innerHTML="";Ea.remove()}));else ma.innerHTML=this._formatExpressionCellContent(ba,Z)},updateHeaderText:function(N){var V=N?N.count:null,Z=N?N.selectedCount:null,ba=N?N.title:null;N=N?N.showFilterCount:!0;ba=p.isValueEmpty(ba)?this._tableTitle||this.layer.name||this._i18nStrings.untitled:ba;V=p.isValueEmpty(V)?this.featureCount:V;Z=p.isValueEmpty(Z)?
this.selectedFeatureCount:Z;this.filterIds&&0<this.filterIds.length&&N&&(V=this.filterIds.length);this.showFeatureCount?this.setHeaderTitle(h.substitute(this._i18nStrings.gridHeader,{gridTitle:ba,featureCount:V,featureSelectedCount:Z})):this.setHeaderTitle(ba)},_generateOptionsMenu:function(){var N=this.css,V=this._i18nStrings;N=r.create("div",{className:N.menuItem+" "+N.button+" "+N.menuIcon,title:V.options,"aria-label":V.options,tabIndex:0},this._gridMenuNode);l(N,[x,"keydown"],m.hitch(this,function(Z){"Tab"!==
Z.key&&this._showOptionsMenu(Z)}));this.optionsMenuAnchor=N},_showOptionsMenu:function(N){var V=this.optionsMenuAnchor,Z=this.css;this.optionsMenu&&(this.optionsMenu.destroy(),this.optionsMenu=null);var ba=V.getBoundingClientRect();var ma=ba.top+ba.height;var sa=this.isLeftToRight()?ba.left+ba.width:ba.right-ba.width;var Ea=new A({className:Z.optionsMenu});ba=this._generateOptionsMenuItems();n.forEach(ba,function(ya){ya=new B({label:ya.label,baseClass:Z.menuItem,onClick:m.hitch(this,ya.callback)});
Ea.addChild(ya)},this);Ea._openMyself({target:N.target,delegatedTarget:V,iframe:null,coords:{x:sa,y:ma}});this.optionsMenu=Ea},_generateOptionsMenuItems:function(){var N=[];this.showDefaultSortMenuItem&&N.push({label:this._i18nStrings.defaultSort,callback:this._sortFieldDefaultCallback});this.showFilterMenuItems?N.push({label:this._i18nStrings.showSelected,callback:this._showSelectedRecordsCallback},{label:this._i18nStrings.clearSelection,callback:this._clearFilterCallback}):N.push({label:this._i18nStrings.clearSelection,
callback:this.clearSelection});this.gridOptions.columnHider&&N.push({label:this._i18nStrings.toggleColumns,callback:this.showColumnToggleMenu});this.map&&this.syncSelection&&N.push({label:this._i18nStrings.centerOnSelection,callback:this.centerOnSelection});this.menuFunctions&&0<this.menuFunctions.length&&n.forEach(this.menuFunctions,function(V){N.push({label:V.label,callback:V.callback})},this);return N},_sortFieldDefaultCallback:function(){var N=this.defaultSort.attribute,V=this.defaultSort.descending;
this.set("sort",{field:N,descending:V});this.emit("sort",{field:N,descending:V,orderByFields:[p.getOrderByString(N,V)]})},_showSelectedRecordsCallback:function(){0!==this.selectedRowIds.length&&this.emit("show-selected-records",{ids:this.selectedRowIds})},_clearFilterCallback:function(){this.emit("clear-selection");this.emit("clear-filter")},showColumnToggleMenu:function(){this.dGrid._toggleColumnHiderMenu()},_generateColumnMenu:function(N){var V=this.dGrid.cell(N),Z=V?V.column:null;if(Z){var ba=
this.columnMenu,ma=this.css,sa=this.columnMenuFunctions;Z=Z.id;var Ea=this.dGrid.columns[Z],ya=p.findFirst(this.fieldInfos,"name",Ea.field);ba&&this.set("columnMenu",null);if(!1!==Ea.sortable){var wa=new A({className:ma.columnMenu});this._generateSortMenuItems({menu:wa,columnId:Z});this._generateStatisticsMenuItem({menu:wa,fieldInfo:ya,columnId:Z});this._generateFieldDetailsMenuItem({menu:wa,fieldInfo:ya,column:Ea});sa&&0<sa.length&&n.forEach(sa,function(aa){wa.addChild(new B({label:aa.label,iconClass:aa.iconClass||
"",baseClass:aa.baseClass||"",onClick:m.hitch(this,aa.callback,ya)}))});wa.startup();this._showColumnMenu({menu:wa,cell:V,evt:N,fieldInfo:ya,previousMenu:ba});this.set("columnMenu",wa)}}},_showColumnMenu:function(N){var V=N.menu,Z=N.cell,ba=N.evt,ma=N.previousMenu;var sa=Z.element.getBoundingClientRect();N=sa.top+sa.height;sa=this.isLeftToRight()?sa.right-sa.width:sa.right;V._openMyself({target:ba.target,delegatedTarget:Z,iframe:null,coords:{x:sa,y:N}});l(V,"close",function(){ma&&(ma.destroyRecursive(),
ma=null)})},_generateSortMenuItems:function(N){var V=N.menu;N=N.columnId;var Z=this.css;V.addChild(new B({label:this._i18nStrings.sortAsc,iconClass:Z.sortAscendingIcon,baseClass:Z.menuItem,onClick:m.hitch(this,this._sortFieldAscendingHandler,N)}));V.addChild(new B({label:this._i18nStrings.sortDesc,iconClass:Z.sortDescendingIcon,baseClass:Z.menuItem,onClick:m.hitch(this,this._sortFieldDescendingHandler,N)}))},_sortFieldAscendingHandler:function(N){var V=this.dGrid.columns[N];this.emit("sort",{column:V,
id:N,field:V.field,descending:!1,orderByFields:[p.getOrderByString(V.field,!1)]})},_sortFieldDescendingHandler:function(N){var V=this.dGrid.columns[N];this.emit("sort",{column:V,id:N,field:V.field,descending:!0,orderByFields:[p.getOrderByString(V.field,!0)]})},_generateStatisticsMenuItem:function(N){var V=N.menu,Z=N.fieldInfo,ba=this.css,ma=this.layer,sa=!!this.layerInfo.isFeatureCollection;ma=ma.advancedQueryCapabilities.supportsStatistics||ma.supportsStatistics;!this.showStatistics||!ma||!Z||Z.domain&&
Z.domain.codedValues||Z.subtypeDomain||Z.typeId||Z.subtypeField||sa||p.isNumericFieldType(Z.type)&&V.addChild(new B({label:this._i18nStrings.statistics,iconClass:ba.statisticsIcon,baseClass:ba.menuItem,onClick:m.hitch(this,this._showStatisticsHandler,N)}))},_generateFieldDetailsMenuItem:function(N){if(this.showFieldDetails){var V=N.menu,Z=N.fieldInfo,ba=parseInt(N.column.id,10);N=this.css;"esriFieldTypeOID"!==Z.type&&"esriFieldTypeGlobalID"!==Z.type&&-1===n.indexOf(this._unsupportedFieldTypes,Z.type)&&
V.addChild(new B({label:this._i18nStrings.showDetailedView,iconClass:N.propertiesIcon,baseClass:N.menuItem,onClick:m.hitch(this,function(){this.emit("show-detailed-field-view",{columnId:ba,fieldInfo:Z})})}))}},_fetchAttachments:function(N){return p.queryLayerForAttachments({layer:this.layer,ids:N||null})},_showAttachmentsHandler:function(N){var V=N.row,Z=N.fieldInfo,ba=N.cellValue,ma=N.cellNode,sa=this.layerInfo,Ea=V[this.idProperty];if(0!==ba||sa.editCapabilities.canCreate){N=a.generateAttachmentsDialog({layer:this.layer,
featureId:Ea,attachments:this.attachmentInfos[Ea]?this.attachmentInfos[Ea].attachments:[],editable:this.editable&&sa.editable,css:this.css});var ya=N.featureAttachments;var wa=ya.attachments;this.own(ya.on("add-complete",m.hitch(this,function(aa){this.attachmentInfos[Ea]||(this.attachmentInfos[Ea]={attachments:[]});this.attachmentInfos[Ea].attachments=aa.attachments;sa.queryAttachmentsSupported&&(ba+=1);ma.innerHTML="";this._generateAttachmentsCell({row:V,fieldInfo:Z,cellValue:ba,cellNode:ma});this.emit("add-attachment-complete",
aa)})),ya.on("delete-complete",m.hitch(this,function(aa){this.attachmentInfos[Ea]||(this.attachmentInfos[Ea]={attachments:[]});this.attachmentInfos[Ea].attachments=aa.attachments;sa.queryAttachmentsSupported&&--ba;ma.innerHTML="";this._generateAttachmentsCell({row:V,fieldInfo:Z,cellValue:ba,cellNode:ma});this.emit("delete-attachment-complete",aa)})));this.emit("show-attachments",{featureId:Ea,attachments:wa,dialog:N.dialog})}},_updateAttachmentInfos:function(N){return m.mixin(this.attachmentInfos,
N)},_fetchRelatedRecords:function(N){return p.queryLayerForRelatedRecords({layer:this.layer,ids:N.ids||null,relationship:N.relationship,outFields:N.outFields||["*"]})},_showRelatedRecordsHandler:function(N){var V=N.row,Z=this.idProperty,ba=V[Z],ma=N.fieldInfo.relationship;N=N.count;var sa=this.columns,Ea=this.layer,ya=Ea.getField(ma.keyField),wa=(ya=ya?ya.name:null)?V[ya]:null,aa;var ca=n.filter(sa,function(ka){return!ka.hidden});Z=[p.findFirst(ca,"field",Ea.displayField),p.findFirst(ca,"field",ya),
p.findFirst(ca,"type","esriFieldTypeString"),p.findFirstNumberColumn(sa,Z),p.findFirst(ca,"type","esriFieldTypeDate")];n.some(Z,function(ka){if(this._validateRelatedColumnDisplay(ka))return aa=n.indexOf(sa,ka),!0},this);p.isValueEmpty(aa)&&(aa=0);this.emit("show-related-records",{row:V,featureId:ba,keyField:ya,keyFieldValue:wa,columnId:aa,relationship:ma,count:N})},_setUpRelatedRecordInfos:function(N){var V=N.records,Z=this.relatedRecordInfos;n.forEach(N.relationships,function(ba,ma){Z[ba.id]=V[ma]});
return Z},_updateRelatedRecordInfos:function(N){this.relatedRecordInfos=p.mergeDictionaries(this.relatedRecordInfos,N)},_updateRelatedRecordCounts:function(N){var V=this.relatedRecordCounts,Z={};n.forEach(this.layer.relationships,function(ba){var ma=N[ba.id];if(ma){ma=ma.relatedRecordGroups;var sa=ba.id;Z[sa]={};n.forEach(ma,function(Ea){Z[sa][Ea.objectId]={count:Ea.count}})}});this.relatedRecordCounts=p.mergeDictionaries(V,Z)},_getRelatedRecordsById:function(N){var V=N.featureId;N=N.relationshipId;
return this.relatedRecordInfos[N]?this.relatedRecordInfos[N][V]:[]},_getRelatedRecordsCount:function(N){var V=N.featureId;N=N.relationshipId;return this.layerInfo.supportsAdvancedQueryRelated?(V=this.relatedRecordCounts[N]?this.relatedRecordCounts[N][V]:{})?V.count:0:(V=this._getRelatedRecordsById({featureId:V,relationshipId:N}))&&V.features?V.features.length:0},_generateRelatedRecordFieldInfos:function(N){var V=[],Z=this.visibleLayerIds,ba=!1,ma,sa;n.some(N.relationships,function(Ea,ya){ya===this._relationshipColumnLimit&&
(ba=!0);sa=p.isCyclicalRelationship(Ea);(ma=Z?Z[Z.length-1]===Ea.relatedTableId:!1)&&sa&&!this.showCyclicalRelationships||V.push({alias:Ea.name,name:Ea.name,type:"esriRelatedRecords",hidden:ba,relatedIndex:ya,relationship:Ea})},this);return V},_validateRelatedColumnDisplay:function(N){return!(!N||N.hidden||-1===n.indexOf(this.columns,N)||"esriFieldTypeOID"===N.type||"esriFieldTypeGlobalID"===N.type)},_getExpressionValueForField:function(N,V){var Z=V[this.idProperty];N=this.expressionCache[N];V=this.layerInfo.isFeatureCollection?
p.findFirst(this.layer.graphics,"attributes",V):this.store.data[Z];return p.getExpressionValue(V,N)},_formatExpressionCellContent:function(N,V){if(p.isValueEmpty(V))return"";"number"==N.type?V=this._formatNumberCellContent({fieldInfo:N,value:V}):(V=String(V),V=t.encode(V),V=this._formatStringCellContent({fieldInfo:N,value:V}),V=V.replace(/(\n)/ig,"\x3cspan class\x3d'charNewLine'\x3e$1\x3c/span\x3e"));return V},_showStatisticsHandler:function(N){var V=N.columnId,Z=N.fieldInfo,ba;N=this.where||this.layer.getDefinitionExpression?
this.layer.getDefinitionExpression():"1\x3d1";p.getFieldStatistics({grid:this.dGrid,layer:this.layer,fieldInfo:Z,idProperty:this.idProperty,filterIds:this.filterIds,where:N,columnId:V}).then(m.hitch(this,function(ma){ba=a.generateStatisticsDialog({data:ma,fieldInfo:Z,css:this.css});this.emit("show-statistics",ba)}))},_addGridListeners:function(){this._setUpRowSelectListener();this._setUpRowDeselectListener();this._setUpDataChangeListener();this._setUpRefreshListener();this._setUpColumnClickListener();
this._setUpColumnStateChangeListener();this._setUpColumnResizeListener();this._setUpErrorListener();this._setUpSortListener();this._setUpFilterListener();this._setUpEditorShowListener();this._setUpEditorHideListener();this.own(this._setUpStoreLoadListener(),this._setUpLayerClickListener(),this._setUpLayerSelectionCompleteListener(),this._setUpLayerSelectionClearListener(),this._setUpLayerUpdateEndListener(),this._setUpLayerRefreshTickListener(),this._setUpLayerFeaturesUpdatesListener())},_setUpStoreLoadListener:function(){var N=
this.watch("store",m.hitch(this,function(V,Z,ba){null===Z&&ba&&(this.set("loaded",!0),this.emit("load",{loaded:!0}),N.remove())}));return N},_setUpRowSelectListener:function(){return this.dGrid.on("dgrid-select",m.hitch(this,function(N){this._updateSelection().then(m.hitch(this,function(){this.updateHeaderText();this.emit("row-select",N)}))}))},_setUpRowDeselectListener:function(){return this.dGrid.on("dgrid-deselect",m.hitch(this,function(N){this._previousSelectedRowIds=this.selectedRowIds;this._updateSelection().then(m.hitch(this,
function(){this.updateHeaderText();this.emit("row-deselect",N)}))}))},_setUpDataChangeListener:function(){return this.dGrid.on("dgrid-datachange",m.hitch(this,function(N){var V=N.cell.column.field,Z=p.findFirst(this.fieldInfos,"name",V),ba=N.cell.row.data,ma=ba[this.idProperty],sa=N.value;N=N.oldValue;var Ea=p.isIntegerFieldType(Z.type);Z=p.isFloatFieldType(Z.type);var ya={oldValue:N,fieldName:V,rowId:ma,row:ba};""===sa&&(sa=null);Ea&&null!==sa&&(sa=parseInt(sa,10));Z&&null!==sa&&(sa=parseFloat(sa));
sa&&sa.getTime&&sa.getTime()?ba[V]=sa.getTime():ba[V]=sa;this.showLoadingIndicator();this._updateSelection().then(m.hitch(this,function(){this.updateHeaderText();this._applyEdits({row:ba,rollbackInfo:ya})}));this.emit("data-change",{row:ba,rollbackInfo:ya})}))},_setUpRefreshListener:function(){return this.dGrid.on("dgrid-refresh-complete",m.hitch(this,function(N){this._lastClickedCell=null;this.dGrid.columns[0]&&this.emit("refresh",N)}))},_setUpColumnClickListener:function(){return this.dGrid.on(".dgrid-header .dgrid-cell:click",
m.hitch(this,this._generateColumnMenu))},_setUpColumnStateChangeListener:function(){return this.dGrid.on("dgrid-columnstatechange",m.hitch(this,function(N){this.emit("column-state-change",N)}))},_setUpColumnResizeListener:function(){return this.dGrid.on("dgrid-columnresize",m.hitch(this,function(N){this.emit("column-resize",N)}))},_setUpErrorListener:function(){return this.dGrid.on("dgrid-error",m.hitch(this,function(N){this.emit("error",N)}))},_setUpSortListener:function(){return this.dGrid.on("dgrid-sort",
m.hitch(this,function(N){this.emit("sort",N)}))},_setUpFilterListener:function(){return this.dGrid.on("dgrid-filter",m.hitch(this,function(N){this.emit("filter",N)}))},_setUpEditorShowListener:function(){return this.dGrid.on("dgrid-editor-show",m.hitch(this,function(N){this.emit("editor-show",N)}))},_setUpEditorHideListener:function(){return this.dGrid.on("dgrid-editor-hide",m.hitch(this,function(N){this.emit("editor-hide",N)}))},_setUpLayerClickListener:function(){return l(this.layer,"click",m.hitch(this,
function(N){this.emit("layer-click",N)}))},_setUpLayerSelectionCompleteListener:function(){return l(this.layer,"selection-complete",m.hitch(this,function(N){this.emit("layer-selection-complete",N)}))},_setUpLayerSelectionClearListener:function(){return l(this.layer,"selection-clear",m.hitch(this,function(N){this.emit("layer-selection-clear",N)}))},_setUpLayerUpdateEndListener:function(){return l(this.layer,"update-end",m.hitch(this,function(N){this.emit("layer-update-end",N)}))},_setUpLayerRefreshTickListener:function(){return l(this.layer,
"refresh-tick",m.hitch(this,function(N){this.layer.isFeatureUpdatesCheckActive()||this.emit("layer-refresh-tick",N)}))},_setUpLayerFeaturesUpdatesListener:function(){return l(this.layer,"feature-updates-result",m.hitch(this,function(N){(N.hasUpdates||this.layer.hasDefinitionExpressionWithCurrentTimestamp())&&this.emit("layer-refresh-tick",N)}))}});m.setObject("dijit.Grid",c,e);return c})},"esri/dijit/FeatureTable/dataUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/Deferred dojo/number dojo/string dojo/date/locale dojo/promise/all ../../libs/sanitizer/Sanitizer ../../config ../../graphic ../../numberUtils ../../request ../../ArcadeExpression ../../arcadeProfiles/popupProfile ../../layers/FeatureLayer ../../geometry/Extent ../../tasks/query ../../tasks/StatisticDefinition ../../tasks/QueryTask ../../tasks/RelationshipQuery dojo/i18n dojo/i18n!../../nls/jsapi".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A){return{i18nStrings:A.widgets.FeatureTable,numericFieldTypes:["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeSmallInteger"],statisticDefinitions:[{type:"count",name:"countField"},{type:"sum",name:"sumField"},{type:"min",name:"minField"},{type:"max",name:"maxField"},{type:"avg",name:"avgField"},{type:"stddev",name:"stddevField"}],_reExprField:/^\s*expression\//i,sanitizer:new b({whiteList:{dd:[],dl:[],dt:[],h1:[],
h2:[],h3:[],h4:[],h5:[],h6:[],sub:[],sup:[],animate:[],animatetransform:[],circle:[],clippath:[],defs:[],ellipse:[],g:[],image:[],line:[],lineargradient:[],marker:[],mask:[],path:[],pattern:[],polygon:[],polyline:[],radialgradient:[],rect:[],stop:[],svg:[],"switch":[],symbol:[],text:[],textpath:[],tspan:[],use:[]}},!0),getOrderByString:function(B,J){return B+(J?" DESC":" ASC")},getWhereString:function(B,J){return B+"\x3d'"+J+"'"},getRelationshipWhereClause:function(B){var J=B.layer,P=B.originRelationship,
R=B.destinationRelationship,S=P.relationshipTableId||P.relatedTableId;P=P.keyFieldInRelationshipTable||P.keyField;var T=R.keyFieldInRelationshipTable||R.keyField,E=J.layerId==S?T:P;B=this.getWhereString(E,B.keyValue);P=J._url.path;P=P.substring(0,P.lastIndexOf("/")+1);return h({url:P+S+"/query",content:{f:"json",outFields:["*"],returnGeometry:!1,where:B},handleAs:"json",callbackParamName:"callback"}).then(K.hitch(this,function(I){if(I&&I.features&&I.features.length){var F=I.features,D=[],C="",y;e.forEach(F,
function(G,L){if(G.attributes&&G.attributes[T])y=G.attributes[T];else{var O=J.getField(E)?J.getField(E).name:null;if(this.isValueEmpty(O)){O=T.toUpperCase();var U=T.toLowerCase();y=G.attributes[O]||G.attributes[U]||null}else y=G.attributes[O]}-1===e.indexOf(D,y)&&(0<D.length&&L<F.length&&(C=C.concat(" OR ")),D.push(y),C=C.concat(this.getWhereString(R.keyField,y)))},this);return C}return null}))},isValueEmpty:function(B){return null===B||" "===B||""===B||"undefined"===typeof B},findFirst:function(B,
J,P){return e.filter(B,function(R){return R.hasOwnProperty(J)&&R[J]===P})[0]||null},compareIntArrays:function(B,J){B.sort();J.sort();var P=e.every(J,function(S){return-1!==e.indexOf(B,S)},this),R=e.every(B,function(S){return-1!==e.indexOf(J,S)},this);return P&&R},findFirstNumberColumn:function(B,J){var P;e.some(B,function(R,S){if(-1!==e.indexOf(this.numericFieldTypes,R.type)&&R.field!==J&&!R.hidden)return P=R,!0},this);return P},getRoundingPrecision:function(B){return 1E3<=B?0:10<=B?2:0<=B?4:6},generateLinkFromString:function(B){var J=
/^\s*(http?:\/\/([^\s]+))\s*$/i,P=/^\s*(https?:\/\/([^\s]+))\s*$/i;if("string"===typeof B){var R;J.test(B)?R=B.indexOf("http:"):P.test(B)&&(R=B.indexOf("https:"));-1<R&&-1===B.indexOf("href\x3d")?(J=B.indexOf(" ",R),-1===J&&(J=B.length),P=B.substring(R,J),B=B.substring(0,R)+"\x3ca href\x3d'"+P+"' target\x3d'_blank'\x3e"+P+"\x3c/a\x3e"+B.substring(J,B.length)):B=this.sanitizer.sanitize(B)}return this.isValueEmpty(B)?"":B},isNumericFieldType:function(B){return-1!==e.indexOf(this.numericFieldTypes,B)},
isIntegerFieldType:function(B){return"esriFieldTypeInteger"===B||"esriFieldTypeSmallInteger"===B},isFloatFieldType:function(B){return"esriFieldTypeDouble"===B||"esriFieldTypeSingle"===B},getDomainValueFromRow:function(B){var J=B.fieldInfo.name,P=B.fieldInfo.domain,R=B.row;if("range"===P.type)return R[J];B=e.filter(P.codedValues,function(S){return S.hasOwnProperty("code")&&S.code==R[J]});return B[0]&&!this.isValueEmpty(B[0].name)?B[0].name:R[J]},getTypeValueFromRow:function(B){var J=B.layerInfo[B.typesProperty],
P=B.typeIdProperty,R=B.fieldInfo,S=B.row;B=J&&J[0];if(B){var T=S[R.name];R=this.isNumericFieldType(R.type);R=(B="string"===typeof B[P])&&R?T.toString():T;T=(T=this.findFirst(J,P,R))?T.name:null}return T},getSubtypeDomainValue:function(B){var J=B.layerInfo,P=B.fieldInfo.name,R=B.row,S;B=(J=this.findFirst(J.types,"id",R[J.typeIdField]))?J.domains:null;if(!J||!B)return R[P];B[P]&&B[P].codedValues&&(S=e.filter(B[P].codedValues,function(T){return T.hasOwnProperty("code")&&T.code==R[P]}));return S&&S[0]&&
!this.isValueEmpty(S[0].name)?S[0].name:R[P]},mergeDictionaries:function(B,J){if(null===B||null===J)return B;for(var P in J){B[P]||(B[P]={});for(var R in J[P])B[P][R]=J[P][R]}return B},isCyclicalRelationship:function(B){return"esriRelCardinalityOneToOne"===B.cardinality||"esriRelCardinalityOneToMany"===B.cardinality&&"esriRelRoleDestination"===B.role},getColumnFromFieldName:function(B){return this.findFirst(B.grid.columns,"field",B.fieldName)},isDateFieldWithStringDataValue:function(B){return"esriFieldTypeDateOnly"===
B||"esriFieldTypeTimeOnly"===B||"esriFieldTypeTimestampOffset"===B},formatNumberForLocale:function(B,J){if(J){var P=z.getLocalization("dojo.cldr","number");if(J.digitSeparator||!P||this.isValueEmpty(B))return isNaN(B)||null===B?null:a.format(B,J);B=isNaN(B)||null===B?null:a.format(B,J);return B.replace(new RegExp("\\"+P.group,"g"),"")}return isNaN(B)||null===B?null:l.format(B,J)},getCombinedDateTime:function(B,J){return new Date(B.getFullYear(),B.getMonth(),B.getDate(),J.getHours(),J.getMinutes(),
J.getSeconds())},formatDateForLocale:function(B){var J=B.dateOptions||{},P=B.timestamp,R=B.fieldInfo,S=!1,T=!1;B={};J=(S=R&&R.dateOptions?R.dateOptions:!1)||J;S=S&&this.isValueEmpty(J.dateEnabled)?!0:!!J.dateEnabled;T=!!J.timeEnabled;this.isValueEmpty(J.datePattern)||(B.datePattern=J.datePattern);this.isValueEmpty(J.timeEnabled)||this.isValueEmpty(J.timePattern)||(B.timePattern=J.timePattern);B.selector=S&&T?"date and time":S&&!T?"date":!S&&T?"time":"date";return m.format(new Date(P),B)},calculateExtentFromFeatures:function(B){var J=
B[0].geometry,P;if(null===J&&1===B.length)return null;for(J=B.length-1;0<=J;J--)null===B[J].geometry&&B.splice(J,1);J=B[0].geometry;var R=J.getExtent();var S=B.length;null===R&&(R=new t(J.x,J.y,J.x,J.y,J.spatialReference));for(P=1;P<S;P++){J=B[P].geometry;var T=J.getExtent();null===T&&(T=new t(J.x,J.y,J.x,J.y,J.spatialReference));R=R.union(T)}return R},initFeatureLayer:function(B,J){B=B._url.path;B=B.substring(0,B.lastIndexOf("/")+1);return new q(B+J,{mode:q.MODE_ONDEMAND,outFields:["*"],visible:!0})},
applyEdits:function(B){var J=[],P=new p;if(!B||0>=B.length)return P.reject(),P;e.forEach(B,function(R){R.layer&&J.push(R.layer.applyEdits(R.adds,R.updates,R.deletes,function(S,T,E){P.resolve({adds:S,updates:T,deletes:E})},function(S){P.reject(S)}))});0<J.length?n(J):P.reject();return P},applyEditsFromRow:function(B){var J=B.layer,P=new d;P.setAttributes(B.row);return this.applyEdits([{layer:J,updates:[P]}],null)},queryLayer:function(B){var J=B.layer;B=B.ids||null;var P=new w;P.where="1\x3d1";P.returnGeometry=
!1;P.objectIds=B;return J.queryFeatures(P)},queryLayerForFeature:function(B){return this.queryLayerForFeatures({layer:B.layer,ids:[B.id]})},queryLayerForFeatures:function(B){var J=B.layer,P=J.advancedQueryCapabilities;P=P&&P.supportsQueryWithCacheHint;B=B.ids;var R=new w;R.objectIds=B;R.outFields=["*"];P&&(R.cacheHint=!0);return J.queryFeatures(R,function(S){return S.features})},queryLayerForCount:function(B){var J=B.layer,P=J.advancedQueryCapabilities;P=P&&P.supportsQueryWithCacheHint;if(J.queryCount){var R=
new w,S=B.layerInfo;B=B.where||"1\x3d1";R.returnGeometry=!1;R.returnCountOnly=!0;R.where=B;P&&(R.cacheHint=!0);return J.queryCount(R).then(function(T){return T}).otherwise(function(){return S.isFeatureCollection?J.graphics.length:2E3}).always(function(T){return T})}return this.queryLayerCustom({layer:J,returnCountOnly:!0,cacheHint:P}).then(function(T){return T&&T.features?T.features.length:0}).otherwise(function(){return J.maxRecordCount||2E3}).always(function(T){return T})},queryLayerCustom:function(B){var J=
new w,P=B.returnCountOnly||!1,R=B.where||"1\x3d1",S=B.returnGeometry||!1,T=B.outFields||["*"],E=B.cacheHint||!1;B=new v(B.layer.url);J.returnGeometry=S;J.outFields=T;J.where=R;J.returnCountOnly=P;E&&(J.cacheHint=!0);return B.execute(J)},queryLayerForIds:function(B){var J=B.layer,P=J.advancedQueryCapabilities;P=P&&P.supportsQueryWithCacheHint;var R=B.idProperty;B=B.where||"1\x3d1";var S=new w;S.returnGeometry=!1;S.outFields=[R];S.where=B;S.returnIdsOnly=!0;P&&(S.cacheHint=!0);return J.queryIds(S)},
queryLayerForAttachments:function(B){return h({url:B.layer._url.path+"/queryAttachments",content:{f:"json",objectIds:B.ids},handleAs:"json",callbackParamName:"callback"})},queryLayerForAttachmentById:function(B){return B.layer.queryAttachmentInfos(B.id||0)},addAttachmentToLayer:function(B){return B.layer.addAttachment(B.featureId,B.formData)},deleteAttachmentFromLayer:function(B){return B.layer.deleteAttachments(B.featureId,[B.attachmentId])},queryLayerForRelatedRecords:function(B){var J=B.layer,
P=B.ids,R=B.outFields||["*"],S=B.relationship;B=B.returnCountOnly||!1;var T=new x;T.outFields=R;T.returnGeometry=!1;T.relationshipId=S.id;T.returnCountOnly=B;T.objectIds=P;return J.queryRelatedFeatures(T)},queryLayerForRelatedRecordCount:function(B){return h({url:B.layer._url.path+"/queryRelatedRecords",content:{f:"json",objectIds:B.objectIds.toString(),outFields:B.outFields,returnGeometry:!1,relationshipId:B.relationship.id,returnCountOnly:!0},handleAs:"json",callbackParamName:"callback"})},getFieldStatistics:function(B){var J=
new p,P=B.layer,R=P.advancedQueryCapabilities;R=R&&R.supportsQueryWithCacheHint;var S=B.idProperty,T=B.where||"1\x3d1",E=B.filterIds,I=B.grid.columns[B.columnId].field;B=P.url;var F=[];var D=e.map(this.statisticDefinitions,function(y){var G=new u;G.onStatisticField=I;G.displayFieldName=I;G.outStatisticFieldName=y.name;G.statisticType=y.type;return G});var C=new w;C.outFields=[I];C.outStatistics=[];C.where=T;C.outStatistics=D;R&&(C.cacheHint=!0);E&&0<E.length&&(F=E);C.where&&0<F.length&&(C.where="("+
C.where+") AND ("+S+" IN ("+F.toString()+"))");P.source&&!this.isValueEmpty(P.source.mapLayerId)&&B.endsWith("/dynamicLayer")&&(B=B.slice(0,-13),B=B+"/"+P.source.mapLayerId);(new v(B)).execute(C).then(function(y){J.resolve(y)}).otherwise(function(){J.reject()});return J},selectFeaturesById:function(B){var J=B.grid,P=J.layer;J=J.layerInfo;var R=B.map,S=B.ids;B=B.id;var T=new w;T.returnGeometry=!!R;T.objectIds=S||[B];J.isFeatureCollection||(T.where="1\x3d1");return P.selectFeatures(T,q.SELECTION_NEW)},
isFeatureEditable:function(B){var J=B.layerInfo;return!!B.layer.getEditCapabilities({userId:J.userIds[J.layerId]||null,feature:{attributes:B.attributes}}).canUpdate},isExpressionField:function(B){return this._reExprField.test(B)},getExpressionInfo:function(B,J){if(this.isExpressionField(J)){var P;J=J.replace(this._reExprField,"");J=J.toLowerCase();e.some(B,function(R){R.name.toLowerCase()===J&&(P=R);return!!P});return P}},compileExpressions:function(B){var J={};e.forEach(B,function(P){var R=P.returnType&&
P.returnType.toLowerCase();J[P.name]=new f({expression:P.expression,returnType:"number"===R?"number":"string",profile:r})});return J},getExpressionValue:function(B,J){var P=B.getLayer(),R=P&&P.getMap();return J?B.evaluateExpression(J,r.getEvalOptions({expression:J,feature:B,layer:P,map:R,spatialReference:R&&R.spatialReference})):null}}})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(e,K,p,a){var g=function(n,b){return n-b},m=
{_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(n){var b=String(n),c=b.match(m._reNumber);n={integer:0,fractional:0};c&&c[1]?(n.integer=c[1].split("").length,n.fractional=c[3]?c[3].split("").length:0):-1<b.toLowerCase().indexOf("e")&&(c=b.split("e"),b=c[0],c=c[1],b&&c&&(b=Number(b),c=Number(c),(n=0<c)||(c=Math.abs(c)),b=m.getDigits(b),n?(b.integer+=c,b.fractional=c>b.fractional?0:b.fractional-c):(b.fractional+=c,b.integer=c>b.integer?1:b.integer-c),n=b));return n},getFixedNumbers:function(n,
b){var c=Number(n.toFixed(b));c<n?n=c+1/Math.pow(10,b):(n=c,c-=1/Math.pow(10,b));c=Number(c.toFixed(b));n=Number(n.toFixed(b));return[c,n]},getPctChange:function(n,b,c,d){var l={prev:null,next:null};if(null!=c){var h=n-c;l.prev=Math.floor(Math.abs(100*(b-c-h)/h))}null!=d&&(h=d-n,l.next=Math.floor(Math.abs(100*(d-b-h)/h)));return l},round:function(n,b){n=n.slice(0);var c,d,l=b&&null!=b.tolerance?b.tolerance:2,h=b&&b.indexes,f=b&&null!=b.strictBounds?b.strictBounds:!1;if(h)h.sort(g);else for(h=[],c=
0;c<n.length;c++)h.push(c);for(c=0;c<h.length;c++){var r=h[c];b=n[r];var q=0===r?null:n[r-1];var t=r===n.length-1?null:n[r+1];var w=m.getDigits(b);if(w=w.fractional){var u=0;for(d=!1;u<=w&&!d;){var v=m.getFixedNumbers(b,u);v=f&&0===c?v[1]:v[0];d=m.hasMinimalChange(b,v,q,t,l);u++}d&&(n[r]=v)}}return n},hasMinimalChange:function(n,b,c,d,l){n=m.getPctChange(n,b,c,d);b=null==n.prev||n.prev<=l;c=null==n.next||n.next<=l;return b&&c||n.prev+n.next<=2*l},_reAllZeros:new RegExp("\\"+p.decimal+"0+$","g"),_reSomeZeros:RegExp("(\\d)0*$",
"g"),format:function(n,b){b=b||{places:20,round:-1};(n=K.format(n,b))&&(n=n.replace(m._reSomeZeros,"$1").replace(m._reAllZeros,""));return n}};return a.numberUtils=m})},"esri/dijit/FeatureTable/dialogUtils":function(){define("../../lang ../FeatureAttachments ./dataUtils dojo/_base/array dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-style dojo/io-query dojo/number dojo/on dojo/string dijit/Dialog dijit/form/Button dijit/layout/BorderContainer dijit/layout/TabContainer dijit/layout/ContentPane dojo/i18n!../../nls/jsapi".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u){return{i18nStrings:u.widgets.FeatureTable,generateDialog:function(v){v=new f({title:v.title,content:v.content,baseClass:v.css.dialog});n.create("div",{className:"break"},v.containerNode);return v},hideDialog:function(v){v&&v.hide()},destroyDialog:function(v){v&&v.destroy()},generateAttachmentsDialog:function(v){var x=this.i18nStrings,z=v.layer,A=v.featureId,B=v.attachments||null,J=v.editable;v=v.css;var P=n.create("div");var R=this.generateDialog({title:x.photosAndFiles,
content:P,css:v});var S=new K({layer:z,featureId:A,attachments:B,editable:J},P);l(R,"hide",function(T){S.destroy()});x=new r({label:x.close,"class":v.closeButton});l(x,"click",function(){R.hide()});x.placeAt(S._uploadButton.domNode,"after");S.startup();R.show();return{dialog:R,featureAttachments:S}},generateStatisticsDialog:function(v){var x=this.i18nStrings,z=v.css,A=v.fieldInfo;A=A.alias||A.name;v=v.data.features[0].attributes;var B={pattern:"#,###,###,##0.########"},J={},P;for(R in v)v.hasOwnProperty(R)&&
(J[R.toLowerCase()]=v[R]);var R=[{title:x.numberOfValues,value:e.isDefined(J.countfield)?d.format(J.countfield,B):""},{title:x.sumOfValues,value:e.isDefined(J.sumfield)?d.format(J.sumfield,B):""},{title:x.minimum,value:e.isDefined(J.minfield)?d.format(J.minfield,B):""},{title:x.maximum,value:e.isDefined(J.maxfield)?d.format(J.maxfield,B):""},{title:x.average,value:e.isDefined(J.avgfield)?d.format(d.round(J.avgfield,p.getRoundingPrecision(J.avgfield)),B):""},{title:x.standardDeviation,value:e.isDefined(J.stddevfield)?
d.format(d.round(J.stddevfield,p.getRoundingPrecision(J.stddevfield)),B):""}];B=n.create("div",{className:z.statisticsTableContainer});n.create("div",{className:z.statisticsHeader,innerHTML:h.substitute(x.fieldLabel,{fieldName:A})},B);n.create("div",{className:z.statisticsHorizontalBreak},B);A=n.create("table",{className:z.statisticsAttrTable,style:{cellpadding:0,cellspacing:0}},B);var S=n.create("tbody",{},A);a.forEach(R,function(I){P=n.create("tr",{valign:"top"},S);n.create("td",{className:z.statisticsAttrName,
innerHTML:I.title},P);n.create("td",{className:z.statisticsAttrValue,innerHTML:I.value},P)});n.create("div",{className:z.statisticsBreak},B);var T=new r({label:x.close,baseClass:z.closeButton});l(T,"click",function(){var I=E;I.hide().then(function(){I.destroyRecursive();T=null})});T.placeAt(B);var E=this.generateDialog({title:x.statistics,content:B,css:z});E.show();return{dialog:E,statistics:v}}}})},"esri/dijit/FeatureAttachments":function(){define("../kernel ../lang dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-class dojo/dom-construct dojo/has dojo/io-query dojo/on dojo/string dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_WidgetBase dojo/i18n!../nls/jsapi dojo/text!./FeatureAttachments/templates/FeatureAttachments.html dijit/form/Button dijit/layout/BorderContainer dijit/layout/TabContainer dijit/layout/ContentPane".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z){a=a([q,f,r],{declaredClass:"esri.dijit.FeatureAttachments",baseClass:"esri-feature-attachments",templateString:w,layer:null,featureId:null,attachments:null,editable:!1,_editable:!1,_i18nStrings:t.widgets.FeatureAttachments,_css:{contentContainer:"esri-feature-attachments-container",menuContainer:"esri-feature-attachments-menu-container",tabContainer:"esri-feature-attachments-tab-container",formButton:"esri-feature-attachments-button dijitButton",
uploadButton:"esri-feature-attachments-upload-button",deleteButton:"icon-ui-close-circled",feedbackNode:"esri-feature-attachments-feedback",dragDrop:"esri-drag-drop",loadingIndicator:"esri-feature-attachments-loading-indicator",viewPane:"esri-feature-attachments-view-pane",viewPaneContent:"esri-feature-attachments-view-pane-content",addPane:"esri-feature-attachments-add-pane",addPaneContent:"esri-feature-attachments-add-pane-content",attachmentNode:"esri-attachment-node",attachmentNodeTextContainer:"esri-attachment-node-text-container",
attachmentNodeTextName:"esri-attachment-node-text-name",attachmentNodeTextSize:"esri-attachment-node-text-size",attachmentNodeDelete:"esri-attachment-node-delete",attachmentNodeIcon:"esri-attachment-node-icon",iconArchive:"esri-attachment-node-icon-archive",iconAudioVideo:"esri-attachment-node-icon-audiovideo",iconDocument:"esri-attachment-node-icon-document",iconImage:"esri-attachment-node-icon-image",iconOther:"esri-attachment-node-icon-other",hidden:"esri-feature-attachments-hidden"},_filetypeInfos:{categories:["archive",
"audioVideo","document","image","other"],groups:["zip 7z gz gtar tar tgz".split(" "),"wmf wps avi mpg mpe mpeg mov wmv aif mid rmi mp2 mp3 mp4 mpa mpv2 qt ra ram wav wma".split(" "),"doc docx dot xls xlsx xlt pdf ppt pptx txt".split(" "),"bmp ecw emf eps ps gif img jp2 jpc j2k jpf jpg jpeg jpe png psd raw sid tif tiff".split(" "),"vrml gml json xml mdb gdb geodatabase".split(" ")],styles:null},constructor:function(){this._updateViewContent=g.hitch(this,this._updateViewContent)},postMixInProperties:function(){this.inherited(arguments);
var A=this._css;this._filetypeInfos.styles={archive:A.iconArchive,audioVideo:A.iconAudioVideo,document:A.iconDocument,image:A.iconImage,other:A.iconOther};this.attachments&&Array.isArray(this.attachments)||this.set("attachments",[])},startup:function(){this.inherited(arguments);var A=this.layer;A&&A.loaded?this._setUpWidget():this.own(l.once(A,"load",g.hitch(this,this._setUpWidget)),l(A,"error",g.hitch(this,this._showError)))},destroy:function(){this.inherited(arguments)},resize:function(){this._tabContainer.resize()},
refresh:function(){this._updateFeedback();this._getAttachments().then(this._updateViewContent)},showAddPane:function(){this._tabContainer.selectChild(this._addPane)},showViewPane:function(){this._tabContainer.selectChild(this._viewPane)},_setUpWidget:function(){this._wireUpEvents();this._checkEditability();this.attachments&&0!==this.attachments.length?this._updateViewContent():this._getAttachments().then(this._updateViewContent)},_wireUpEvents:function(){this.own(l(this._uploadButton,"click",g.hitch(this,
this._addAttachment)),l(this._fileInput,"change",g.hitch(this,this._updateUploadButtonState)),this.watch("featureId",g.hitch(this,this._updateFeatureId)),this._tabContainer.watch("selectedChildWidget",g.hitch(this,this._updateUploadButtonDisplay)))},_checkEditability:function(){this.editable&&this.layer.isEditable&&(this.set("_editable",this.layer.isEditable()),this._addPane.set("disabled",!1))},_getAttachments:function(){this._showLoadingIndicator();return this._queryLayerForAttachments().then(g.hitch(this,
function(A){this.set("attachments",A);return A})).otherwise(g.hitch(this,function(A){this.set("attachements",[]);return[]}))},_updateFeatureId:function(){this.refresh()},_updateFeedback:function(A){this._feedbackNode.textContent=A||""},_showError:function(A){msg=A&&K.isDefined(A.code)&&400===A.code?this._i18nStrings.fileNotSupported:this._i18nStrings.uploadFail;this.emit("error",{message:msg});this._updateFeedback(msg);this._hideLoadingIndicator()},_addAttachment:function(){if(this._fileInput.files&&
this._fileInput.files[0]){this._showLoadingIndicator();this._updateFeedback(this._i18nStrings.uploading);this._uploadButton.setDisabled(!0);var A=this._fileInput.files[0],B=new FormData;B.append("attachment",A,A.name);this._addAttachmentToLayer(B).then(g.hitch(this,this._addAttachmentCallback)).otherwise(g.hitch(this,this._showError))}},_addAttachmentCallback:function(A){this._fileInput.value="";A.success?(!0===this._viewPane.disabled&&this._viewPane.set("disabled",!1),this._getAttachments().then(g.hitch(this,
function(){this._updateViewContent();this.emit("add-complete",{attachments:this.attachments,featureId:A.objectId,attachmentId:A.attachmentId})})),this._updateFeedback(this._i18nStrings.uploadSuccess),this._hideLoadingIndicator()):(this._updateFeedback(this._i18nStrings.uploadFail),this._hideLoadingIndicator(),this._showError(A.error))},_deleteAttachment:function(A,B){this._showLoadingIndicator();this._updateFeedback(this._i18nStrings.deleting);this._deleteAttachmentFromLayer(A).then(g.hitch(this,
this._deleteAttachmentCallback)).otherwise(g.hitch(this,this._showError,null))},_deleteAttachmentCallback:function(A){A[0]&&A[0].success?(this._getAttachments().then(g.hitch(this,function(){this._updateViewContent();this.emit("delete-complete",{attachments:this.attachments,featureId:A[0].objectId,attachmentId:A[0].attachmentId})})),this._updateFeedback(this._i18nStrings.deleteSuccess),this._hideLoadingIndicator()):(this._hideLoadingIndicator(),this._updateFeedback(this._i18nStrings.deleteFail),this._showError(A[0].error))},
_updateViewContent:function(){if(this.layer&&!isNaN(this.featureId)&&this.attachments){this.editable&&0===this.attachments.length&&this.showAddPane();var A=this._generateViewContent();this._viewPane.setContent(A);this._hideLoadingIndicator()}},_generateViewContent:function(){var A=this.attachments;var B=this.layer._url.path+"/"+this.featureId+"/attachments/";var J=this._getQueryString();var P=b.create("div",{className:this._css.viewPaneContent});p.forEach(A,function(R){this._generateViewNode({attachment:R,
baseUrl:B,queryUrl:J,contentNode:P})},this);return P},_generateViewNode:function(A){var B=A.attachment,J=B.id,P=B.name,R=B.size;B=A.contentNode;var S=this._css;var T=A.baseUrl+J+A.queryUrl;A=b.create("div",{className:S.attachmentNode});b.create("div",{className:S.attachmentNodeIcon+" "+this._getIconClass(P)},A);var E=b.create("div",{className:S.attachmentNodeTextContainer},A);var I=b.create("span",{className:S.attachmentNodeTextName},E);b.create("a",{href:T,title:P,innerHTML:P,target:"_blank"},I);
b.create("span",{className:S.attachmentNodeTextSize,innerHTML:this._parseFileSize(R)},E);this._editable&&(P=b.create("div",{className:S.attachmentNodeDelete},A),b.create("span",{className:S.deleteButton},P),this.own(l(P,"click",this._deleteAttachment.bind(this,J))));b.place(A,B)},_showLoadingIndicator:function(){n.remove(this._loadingIndicator,this._css.hidden)},_hideLoadingIndicator:function(){n.add(this._loadingIndicator,this._css.hidden)},_showUploadButton:function(){n.remove(this._uploadButton.domNode,
this._css.hidden)},_hideUploadButton:function(){n.add(this._uploadButton.domNode,this._css.hidden)},_updateUploadButtonState:function(){this._updateFeedback();this._uploadButton.setDisabled(0===this._fileInput.value.length)},_updateUploadButtonDisplay:function(A,B,J){this._updateFeedback();J===this._addPane?this._showUploadButton():this._hideUploadButton()},_queryLayerForAttachments:function(){return this.layer.queryAttachmentInfos(this.featureId||0)},_addAttachmentToLayer:function(A){return this.layer.addAttachment(this.featureId,
A)},_deleteAttachmentFromLayer:function(A){return this.layer.deleteAttachments(this.featureId,[A])},_getIconClass:function(A){var B=A.substr(A.lastIndexOf(".")+1);A=this._filetypeInfos;var J=A.categories,P=-1;p.some(A.groups,function(R,S){if(-1!==R.indexOf(B.toLowerCase()))return P=S,!0});return A.styles[J[P]?J[P]:J[4]]},_parseFileSize:function(A){var B=this._i18nStrings,J=[B.kB,B.MB,B.GB,B.TB],P=-1;if(1E3>Math.abs(A))return h.substitute(B.B,{fileSize:A});do A/=1E3,++P;while(1E3<=Math.abs(A)&&P<J.length-
1);return h.substitute(J[P],{fileSize:A.toFixed(1)})},_getQueryString:function(){var A=d.objectToQuery({gdbVersion:this.layer.gdbVersion,token:this.layer._getToken()});return A?"?"+A:""}});g.setObject("dijit.FeatureAttachments",a,e);return a})},"dijit/layout/TabContainer":function(){define(["dojo/_base/lang","dojo/_base/declare","./_TabContainerBase","./TabController","./ScrollingTabController"],function(e,K,p,a,g){return K("dijit.layout.TabContainer",p,{useMenu:!0,useSlider:!0,controllerWidget:"",
_makeController:function(m){var n=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout");return new ("string"==typeof this.controllerWidget?e.getObject(this.controllerWidget):this.controllerWidget)({id:this.id+"_tablist",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,"class":n,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?
"":"No")+"Strip":null},m)},postMixInProperties:function(){this.inherited(arguments);this.controllerWidget||(this.controllerWidget="top"!=this.tabPosition&&"bottom"!=this.tabPosition||this.nested?a:g)}})})},"dijit/layout/_TabContainerBase":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style ./StackContainer ./utils ../_TemplatedMixin dojo/text!./templates/TabContainer.html".split(" "),function(e,K,p,a,g,m,n,b){return e("dijit.layout._TabContainerBase",[g,n],{tabPosition:"top",
baseClass:"dijitTabContainer",tabStrip:!1,nested:!1,templateString:b,postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&a.set(this.srcNodeRef,"visibility","hidden");this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);this.doLayout||K.add(this.domNode,"dijitTabContainerNoLayout");this.nested?(K.add(this.domNode,"dijitTabContainerNested"),
K.add(this.tablist.containerNode,"dijitTabContainerTabListNested"),K.add(this.tablistSpacer,"dijitTabContainerSpacerNested"),K.add(this.containerNode,"dijitTabPaneWrapperNested")):K.add(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"))},_setupChild:function(c){K.add(c.domNode,"dijitTabPane");this.inherited(arguments)},removeChild:function(c){K.remove(c.domNode,"dijitTabPane");this.inherited(arguments)},startup:function(){this._started||(this.tablist.startup(),this.inherited(arguments))},
layout:function(){if(this._contentBox&&"undefined"!=typeof this._contentBox.l){var c=this.selectedChildWidget;if(this.doLayout){var d=this.tabPosition.replace(/-h/,"");this.tablist.region=d;d=[this.tablist,{domNode:this.tablistSpacer,region:d},{domNode:this.containerNode,region:"center"}];m.layoutChildren(this.domNode,this._contentBox,d);this._containerContentBox=m.marginBox2contentBox(this.containerNode,d[2]);c&&c.resize&&c.resize(this._containerContentBox)}else{if(this.tablist.resize){d=this.tablist.domNode.style;
d.width="0";var l=p.getContentBox(this.domNode).w;d.width="";this.tablist.resize({w:l})}c&&c.resize&&c.resize()}}},destroy:function(c){this.tablist&&this.tablist.destroy(c);this.inherited(arguments)}})})},"dijit/layout/TabController":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/has dojo/i18n dojo/_base/lang ./StackController ../registry ../Menu ../MenuItem dojo/text!./templates/_TabButton.html dojo/i18n!../nls/common".split(" "),function(e,K,p,a,g,m,n,b,c,d,l,h){h=
e("dijit.layout._TabButton"+(g("dojo-bidi")?"_NoBidi":""),b.StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},templateString:h,_setNameAttr:"focusNode",scrollOnFocus:!1,buildRendering:function(){this.inherited(arguments);K.setSelectable(this.containerNode,!1)},startup:function(){this.inherited(arguments);var f=this.domNode;this.defer(function(){f.className=f.className},1)},_setCloseButtonAttr:function(f){this._set("closeButton",f);a.toggle(this.domNode,"dijitClosable",
f);this.closeNode.style.display=f?"":"none";f&&(f=m.getLocalization("dijit","common"),this.closeNode&&p.set(this.closeNode,"title",f.itemClose))},_setDisabledAttr:function(f){this.inherited(arguments);if(this.closeNode)if(f)p.remove(this.closeNode,"title");else{var r=m.getLocalization("dijit","common");p.set(this.closeNode,"title",r.itemClose)}},_setLabelAttr:function(f){this.inherited(arguments);this.showLabel||this.params.title||(this.iconNode.alt=n.trim(this.containerNode.innerText||this.containerNode.textContent||
""))}});g("dojo-bidi")&&(h=e("dijit.layout._TabButton",h,{_setLabelAttr:function(f){this.inherited(arguments);this.applyTextDir(this.iconNode,this.iconNode.alt)}}));e=e("dijit.layout.TabController",b,{baseClass:"dijitTabController",templateString:"\x3cdiv role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown:onkeydown'\x3e\x3c/div\x3e",tabPosition:"top",buttonWidget:h,buttonWidgetCloseClass:"dijitTabCloseButton",postCreate:function(){this.inherited(arguments);var f=new d({id:this.id+"_Menu",ownerDocument:this.ownerDocument,
dir:this.dir,lang:this.lang,textDir:this.textDir,targetNodeIds:[this.domNode],selector:function(t){return a.contains(t,"dijitClosable")&&!a.contains(t,"dijitTabDisabled")}});this.own(f);var r=m.getLocalization("dijit","common"),q=this;f.addChild(new l({label:r.itemClose,ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,onClick:function(t){t=c.byNode(this.getParent().currentTarget);q.onCloseButtonClick(t.page)}}))}});e.TabButton=h;return e})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t){l("dijit-legacy-requires")&&t(0,function(){e(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return p("dijit.Menu",q,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):K.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(w){return f.get(this._iframeContentDocument(w))||
this._iframeContentDocument(w).__parent__||w.name&&document.frames[w.name]||null},_iframeContentDocument:function(w){return w.contentDocument||w.contentWindow&&w.contentWindow.document||w.name&&document.frames[w.name]&&document.frames[w.name].document||null},bindDomNode:function(w){w=a.byId(w,this.ownerDocument);if("iframe"==w.tagName.toLowerCase()){var u=w;var v=this._iframeContentWindow(u);v=h.body(v.document)}else v=w==h.body(this.ownerDocument)?this.ownerDocument.documentElement:w;var x={node:w,
iframe:u};g.set(w,"_dijitMenu"+this.id,this._bindings.push(x));var z=c.hitch(this,function(A){var B=this.selector,J=B?function(R){return d.selector(B,R)}:function(R){return R},P=this;return[d(A,J(this.leftClickToOpen?"click":"contextmenu"),function(R){R.stopPropagation();R.preventDefault();(new Date).getTime()<P._lastKeyDown+500||P._scheduleOpen(this,u,{x:R.pageX,y:R.pageY},R.target)}),d(A,J("keydown"),function(R){if(93==R.keyCode||R.shiftKey&&R.keyCode==b.F10||P.leftClickToOpen&&R.keyCode==b.SPACE)R.stopPropagation(),
R.preventDefault(),P._scheduleOpen(this,u,null,R.target),P._lastKeyDown=(new Date).getTime()})]});x.connects=v?z(v):[];u&&(x.onloadHandler=c.hitch(this,function(){var A=this._iframeContentWindow(u);A=h.body(A.document);x.connects=z(A)}),u.addEventListener?u.addEventListener("load",x.onloadHandler,!1):u.attachEvent("onload",x.onloadHandler))},unBindDomNode:function(w){try{var u=a.byId(w,this.ownerDocument)}catch(A){return}w="_dijitMenu"+this.id;if(u&&g.has(u,w)){for(var v=g.get(u,w)-1,x=this._bindings[v],
z;z=x.connects.pop();)z.remove();(z=x.iframe)&&(z.removeEventListener?z.removeEventListener("load",x.onloadHandler,!1):z.detachEvent("onload",x.onloadHandler));g.remove(u,w);delete this._bindings[v]}},_scheduleOpen:function(w,u,v,x){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:x,delegatedTarget:w,iframe:u,coords:v})},1))},_openMyself:function(w){function u(){R.refocus&&S&&S.focus();r.close(R)}var v=w.target,x=w.iframe,z=w.coords,A=!z;this.currentTarget=
w.delegatedTarget;if(z){if(x){w=m.position(x,!0);v=this._iframeContentWindow(x);v=m.docScroll(v.document);var B=n.getComputedStyle(x),J=n.toPixelValue,P=(l("ie")&&l("quirks")?0:J(x,B.paddingLeft))+(l("ie")&&l("quirks")?J(x,B.borderLeftWidth):0);x=(l("ie")&&l("quirks")?0:J(x,B.paddingTop))+(l("ie")&&l("quirks")?J(x,B.borderTopWidth):0);z.x+=w.x+P-v.x;z.y+=w.y+x-v.y}}else z=m.position(v,!0),z.x+=10,z.y+=10;var R=this;x=this._focusManager.get("prevNode");w=this._focusManager.get("curNode");var S=!w||
a.isDescendant(w,this.domNode)?x:w;r.open({popup:this,x:z.x,y:z.y,onExecute:u,onCancel:u,orient:this.isLeftToRight()?"L":"R"});this.focus();A||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);r.close(this)}},destroy:function(){K.forEach(this._bindings,function(w){w&&this.unBindDomNode(w.node)},this);this.inherited(arguments)}})})},"dijit/layout/ScrollingTabController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/_base/lang dojo/on dojo/query dojo/sniff ../registry dojo/text!./templates/ScrollingTabController.html dojo/text!./templates/_ScrollingTabControllerButton.html ./TabController ./utils ../_WidgetsInTemplateMixin ../Menu ../MenuItem ../form/Button ../_HasDropDown dojo/NodeList-dom ../a11yclick".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x){h=K("dijit.layout.ScrollingTabController",[r,t],{baseClass:"dijitTabController dijitScrollingTabController",templateString:h,useMenu:!0,useSlider:!0,tabStripClass:"",_minScroll:5,_setClassAttr:{node:"containerNode",type:"class"},buildRendering:function(){this.inherited(arguments);var z=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+
this.tabPosition.substr(1).replace(/-.*/,"")+"None",p.add(z,"tabStrip-disabled"));p.add(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments);g.set(this.domNode,"visibility","");this._postStartup=!0;this.own(b(this.containerNode,"attrmodified-label, attrmodified-iconclass",n.hitch(this,function(z){this._dim&&this.resize(this._dim)})))},onAddChild:function(z,A){this.inherited(arguments);g.set(this.containerNode,"width",g.get(this.containerNode,"width")+200+"px")},
onRemoveChild:function(z,A){var B=this.pane2button(z.id);this._selectedTab===B.domNode&&(this._selectedTab=null);this.inherited(arguments)},_initButtons:function(){this._btnWidth=0;this._buttons=c("\x3e .tabStripButton",this.domNode).filter(function(z){if(this.useMenu&&z==this._menuBtn.domNode||this.useSlider&&(z==this._rightBtn.domNode||z==this._leftBtn.domNode))return this._btnWidth+=a.getMarginSize(z).w,!0;g.set(z,"display","none");return!1},this)},_getTabsWidth:function(){var z=this.getChildren();
if(z.length){var A=z[this.isLeftToRight()?0:z.length-1].domNode;z=z[this.isLeftToRight()?z.length-1:0].domNode;return z.offsetLeft+z.offsetWidth-A.offsetLeft}return 0},_enableBtn:function(z){var A=this._getTabsWidth();z=z||g.get(this.scrollNode,"width");return 0<A&&z<A},resize:function(z){this._dim=z;this.scrollNode.style.height="auto";var A=this._contentBox=q.marginBox2contentBox(this.domNode,{h:0,w:z.w});A.h=this.scrollNode.offsetHeight;a.setContentSize(this.domNode,A);A=this._enableBtn(this._contentBox.w);
this._buttons.style("display",A?"":"none");this._leftBtn.region="left";this._rightBtn.region="right";this._menuBtn.region=this.isLeftToRight()?"right":"left";q.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,region:"center"}]);this._selectedTab&&(this._anim&&"playing"==this._anim.status()&&this._anim.stop(),this.scrollNode.scrollLeft=this._convertToScrollLeft(this._getScrollForSelectedTab()));this._setButtonClass(this._getScroll());
this._postResize=!0;return{h:this._contentBox.h,w:z.w}},_getScroll:function(){return this.isLeftToRight()||8>d("ie")||d("trident")&&d("quirks")||d("webkit")?this.scrollNode.scrollLeft:g.get(this.containerNode,"width")-g.get(this.scrollNode,"width")+(d("trident")||d("edge")?-1:1)*this.scrollNode.scrollLeft},_convertToScrollLeft:function(z){if(this.isLeftToRight()||8>d("ie")||d("trident")&&d("quirks")||d("webkit"))return z;var A=g.get(this.containerNode,"width")-g.get(this.scrollNode,"width");return(d("trident")||
d("edge")?-1:1)*(z-A)},onSelectChild:function(z,A){var B=this.pane2button(z.id);if(B){var J=B.domNode;if(J!=this._selectedTab&&(this._selectedTab=J,this._postResize)){var P=this._getScroll();P>J.offsetLeft||P+g.get(this.scrollNode,"width")<J.offsetLeft+g.get(J,"width")?(J=this.createSmoothScroll(),A&&(J.onEnd=function(){B.focus()}),J.play()):A&&B.focus()}this.inherited(arguments)}},_getScrollBounds:function(){var z=this.getChildren(),A=g.get(this.scrollNode,"width"),B=g.get(this.containerNode,"width")-
A,J=this._getTabsWidth();if(z.length&&J>A)return{min:this.isLeftToRight()?0:z[z.length-1].domNode.offsetLeft,max:this.isLeftToRight()?z[z.length-1].domNode.offsetLeft+z[z.length-1].domNode.offsetWidth-A:B};z=this.isLeftToRight()?0:B;return{min:z,max:z}},_getScrollForSelectedTab:function(){var z=this._selectedTab,A=g.get(this.scrollNode,"width"),B=this._getScrollBounds();z=z.offsetLeft+g.get(z,"width")/2-A/2;return z=Math.min(Math.max(z,B.min),B.max)},createSmoothScroll:function(z){if(0<arguments.length){var A=
this._getScrollBounds();z=Math.min(Math.max(z,A.min),A.max)}else z=this._getScrollForSelectedTab();this._anim&&"playing"==this._anim.status()&&this._anim.stop();var B=this,J=this.scrollNode,P=new m.Animation({beforeBegin:function(){this.curve&&delete this.curve;var R=J.scrollLeft,S=B._convertToScrollLeft(z);P.curve=new m._Line(R,S)},onAnimate:function(R){J.scrollLeft=R}});this._anim=P;this._setButtonClass(z);return P},_getBtnNode:function(z){for(z=z.target;z&&!p.contains(z,"tabStripButton");)z=z.parentNode;
return z},doSlideRight:function(z){this.doSlide(1,this._getBtnNode(z))},doSlideLeft:function(z){this.doSlide(-1,this._getBtnNode(z))},doSlide:function(z,A){A&&p.contains(A,"dijitTabDisabled")||(z*=.75*g.get(this.scrollNode,"width"),z=this._getScroll()+z,this._setButtonClass(z),this.createSmoothScroll(z).play())},_setButtonClass:function(z){var A=this._getScrollBounds();this._leftBtn.set("disabled",z<=A.min);this._rightBtn.set("disabled",z>=A.max)}});f=K("dijit.layout._ScrollingTabControllerButtonMixin",
null,{baseClass:"dijitTab tabStripButton",templateString:f,tabIndex:"",isFocusable:function(){return!1}});K("dijit.layout._ScrollingTabControllerButton",[v,f]);K("dijit.layout._ScrollingTabControllerMenuButton",[v,x,f],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(z){this.dropDown=new w({id:this.containerId+"_menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir});var A=l.byId(this.containerId);e.forEach(A.getChildren(),function(B){var J=
new u({id:B.id+"_stcMi",label:B.title,iconClass:B.iconClass,disabled:B.disabled,ownerDocument:this.ownerDocument,dir:B.dir,lang:B.lang,textDir:B.textDir||A.textDir,onClick:function(){A.selectChild(B)}});this.dropDown.addChild(J)},this);z()},closeDropDown:function(z){this.inherited(arguments);this.dropDown&&(this._popupStateNode.removeAttribute("aria-owns"),this.dropDown.destroyRecursive(),delete this.dropDown)}});return h})},"dgrid/extensions/ColumnHider":function(){define("dojo/_base/declare dojo/has dojo/on ../util/misc put-selector/put dojo/i18n!./nls/columnHider xstyle/css!../css/extensions/ColumnHider.css".split(" "),
function(e,K,p,a,g,m){var n,b,c=K("ie"),d=c&&K("quirks"),l=8>c||d?"htmlFor":"for";return e("dgrid.extensions.ColumnHider",null,{hiderMenuNode:null,hiderToggleNode:null,i18nColumnHider:m,_hiderMenuOpened:!1,_columnHiderRules:null,_columnHiderCheckboxes:null,_renderHiderMenuEntries:function(){var h=this.subRows,f=!0,r,q;delete this._columnHiderFirstCheckbox;var t=0;for(r=h.length;t<r;t++){var w=0;for(q=h[t].length;w<q;w++)this._renderHiderMenuEntry(h[t][w]),f&&(f=!1,this._columnHiderFirstCheckbox=this._columnHiderCheckboxes[h[t][w].id])}},
_renderHiderMenuEntry:function(h){var f=h.id,r=a.escapeCssIdentifier(f,"-");h.hidden&&(h.hidden=!1,this._hideColumn(f),h.hidden=!0);if(!h.unhidable){var q=g("div.dgrid-hider-menu-row");var t=this.domNode.id+"-hider-menu-check-"+r;f=this._columnHiderCheckboxes[f]=g(q,"input.dgrid-hider-menu-check.hider-menu-check-"+r+"[type\x3dcheckbox]");f.id=t;g(q,"label.dgrid-hider-menu-label.hider-menu-label-"+r+"["+l+"\x3d"+t+"]",h.label||h.field||"");g(this.hiderMenuNode,q);h.hidden||(f.checked=!0)}},renderHeader:function(){function h(w){w.stopPropagation()}
var f=this,r=this.hiderMenuNode,q=this.hiderToggleNode,t;this.inherited(arguments);if(r){for(t in this._columnHiderRules)this._columnHiderRules[t].remove();r.innerHTML=""}else q=this.hiderToggleNode=g(this.domNode,"button.ui-icon.dgrid-hider-toggle[type\x3dbutton][aria-label\x3d"+this.i18nColumnHider.popupTriggerLabel+"]"),this._listeners.push(p(q,"click",function(w){f._toggleColumnHiderMenu(w)})),r=this.hiderMenuNode=g("div.dgrid-hider-menu[role\x3ddialog][aria-label\x3d"+this.i18nColumnHider.popupLabel+
"]"),r.id=this.id+"-hider-menu",this._listeners.push(p(r,"keyup",function(w){27===(w.charCode||w.keyCode)&&(f._toggleColumnHiderMenu(w),q.focus())})),r.style.display="none",g(this.domNode,r),this._listeners.push(p(r,".dgrid-hider-menu-check:"+(9>c||d?"click":"change"),function(w){f._updateColumnHiddenState(w.target.id.substr(f.id.length+18),!w.target.checked)})),this._listeners.push(p(r,"mousedown",h),p(q,"mousedown",h)),b||(b=p.pausable(document,"mousedown",function(w){n&&n._toggleColumnHiderMenu(w)}),
b.pause());this._columnHiderCheckboxes={};this._columnHiderRules={};this._renderHiderMenuEntries()},destroy:function(){this.inherited(arguments);for(var h in this._columnHiderRules)this._columnHiderRules[h].remove()},left:function(h,f){return this.right(h,-f)},right:function(h,f){h.element||(h=this.cell(h));for(var r=this.inherited(arguments),q=h;r.column.hidden;){r=this.inherited(arguments,[r,0<f?1:-1]);if(q.element===r.element)return h;q=r}return r},isColumnHidden:function(h){return!!this._columnHiderRules[h]},
_toggleColumnHiderMenu:function(){var h=this._hiderMenuOpened,f=this.hiderMenuNode,r=this.domNode,q;f.style.display=h?"none":"";h?f.style.height="":(f.offsetHeight>r.offsetHeight-12&&(f.style.height=r.offsetHeight-12+"px"),(q=this._columnHiderFirstCheckbox)&&q.focus());b[h?"pause":"resume"]();n=h?null:this;this._hiderMenuOpened=!h},_hideColumn:function(h){var f=this,r="#"+a.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-";if(!(this._columnHiderRules[h]||(this._columnHiderRules[h]=a.addCssRule(r+
a.escapeCssIdentifier(h,"-"),"display: none;"),8!==K("ie")&&10!==K("ie")||K("quirks")))){var q=a.addCssRule(".dgrid-row-table","display: inline-table;");window.setTimeout(function(){q.remove();f.resize()},0)}},_showColumn:function(h){this._columnHiderRules[h]&&(this._columnHiderRules[h].remove(),delete this._columnHiderRules[h])},_updateColumnHiddenState:function(h,f){this[f?"_hideColumn":"_showColumn"](h);this.columns[h].hidden=f;p.emit(this.domNode,"dgrid-columnstatechange",{grid:this,column:this.columns[h],
hidden:f,bubbles:!0});this.resize()},toggleColumnHiddenState:function(h,f){"undefined"===typeof f&&(f=!this._columnHiderRules[h]);this._updateColumnHiddenState(h,f);this._columnHiderCheckboxes[h].checked=!f}})})},"esri/dijit/FeatureTable/storeUtils":function(){define("./dataUtils dojo/_base/array dojo/_base/lang dojo/store/Cache dojo/store/Memory dojo/store/Observable dojo/store/util/QueryResults ../FeatureLayerQueryStore".split(" "),function(e,K,p,a,g,m,n,b){return{generateMemoryStore:function(c){var d=
c.idProperty;c=K.map(c.features,function(l){return l.attributes});return new m(new g({data:c,idProperty:d}))},generateCacheStore:function(c){var d=c.grid,l=c.layer,h=c.ids||null,f=h&&h.length?h.length:d.featureCount,r=c.orderByFields,q=c.where||null,t=c.batchCount||25,w=c.getAttachments||!1;c=c.getRelatedRecords||!1;d=new g({idProperty:d.idProperty});l=new b({layer:l,objectIds:h,totalCount:f,batchCount:t,where:q||"1\x3d1",orderByFields:r,getAttachments:w,getRelatedRecords:c});return new a(l,d)},generateSort:function(c,
d,l,h){var f=function(){return function(q,t){var w=r[0],u=parseInt(w.columnId,10),v=w.attribute;"esriAttachments"!==v&&"esriRelatedRecords"!==w.fieldType||"undefined"===typeof u?(q=q[v]&&q[v].toLowerCase?q[v].toLowerCase():q[v],t=t[v]&&t[v].toLowerCase?t[v].toLowerCase():t[v]):(q=c.columns[u].get(q),t=c.columns[u].get(t));q=e.isValueEmpty(q)?null:q.valueOf();t=e.isValueEmpty(t)?null:t.valueOf();return null===q&&null!==t?w.descending?-1:1:null!==q&&null===t?w.descending?1:-1:q===t?0:(q>t?1:-1)*(w.descending?
-1:1)}},r=h&&h.sort;r&&"function"!==typeof r&&(h.sort=f());return new n(d.queryEngine(l,h)(d.data))}}})},"dojo/store/Cache":function(){define(["../_base/lang","../when"],function(e,K){var p=function(a,g,m){m=m||{};return e.delegate(a,{query:function(n,b){n=a.query(n,b);n.forEach(function(c){m.isLoaded&&!m.isLoaded(c)||g.put(c)});return n},queryEngine:a.queryEngine||g.queryEngine,get:function(n,b){return K(g.get(n),function(c){return c||K(a.get(n,b),function(d){d&&g.put(d,{id:n});return d})})},add:function(n,
b){return K(a.add(n,b),function(c){g.add(c&&"object"==typeof c?c:n,b);return c})},put:function(n,b){g.remove(b&&b.id||this.getIdentity(n));return K(a.put(n,b),function(c){g.put(c&&"object"==typeof c?c:n,b);return c})},remove:function(n,b){return K(a.remove(n,b),function(c){return g.remove(n,b)})},evict:function(n){return g.remove(n)}})};e.setObject("dojo.store.Cache",p);return p})},"esri/dijit/FeatureLayerQueryStore":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/promise/all dojo/Deferred ../request ../tasks/query ../tasks/RelationshipQuery ../dijit/FeatureLayerQueryResult dojo/i18n!../nls/jsapi".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l){a=e(null,{layer:null,data:null,objectIds:null,idProperty:"id",totalCount:0,batchCount:25,where:null,orderByFields:null,getAttachments:!1,getRelatedRecords:!1,constructor:function(h){e.safeMixin(this,h);this.data=[];this.idProperty=this.layer.objectIdField;this.idProperty||(h=JSON.parse(this.layer._json),h.uniqueIdField&&h.uniqueIdField.name&&(this.idProperty=h.uniqueIdField.name))},get:function(h){return this.data[h]},getIdentity:function(h){return h[this.idProperty]},
query:function(h,f){var r=new m,q=new b;h=f.start||0;var t=f.count||this.batchCount,w=this.layer.relationships,u=this.layer.advancedQueryCapabilities;f=f.objectIds||this.objectIds;var v={fields:[],features:[],attachmentInfos:{},relatedRecordInfos:{},count:0,total:this.totalCount,exceededTransferLimit:!1};f&&f.length?q.objectIds=f.length>=h+this.batchCount?f.slice(h,h+t):f.slice(h):(q.start=h,q.num=t,q.where=this.where);var x=u&&u.supportsOrderBy&&this.orderByFields&&this.orderByFields.length;x&&(q.orderByFields=
this.orderByFields);u&&u.supportsQueryWithCacheHint&&(q.cacheHint=!0);q.returnGeometry=!1;q.outFields=["*"];this.layer.queryFeatures(q).then(K.hitch(this,function(z){if(z.features&&z.features.length){var A=z.objectIdFieldName;A||(p.some(z.fields,function(S,T){if("esriFieldTypeOID"===S.type)return A=S.name,!1}),!A&&z.uniqueIdField&&(A=z.uniqueIdField.name),A||(A=this.idProperty));var B=[],J=[],P={};this.objectIds&&!x&&(p.forEach(z.features,function(S,T){P[S.attributes[A]]=S}),z.features=p.map(q.objectIds,
function(S){return P[S]}));var R=p.map(z.features,function(S){var T=S.attributes,E=T[A];B.push(E);this.data[E]=S;return T},this);v.exceededTransferLimit=!!z.exceededTransferLimit;v.count=z.features.length;v.features=R;v.fields=z.fields;this.getAttachments&&this.getRelatedRecords?(J.push(this._queryAttachments(B)),p.forEach(w,function(S){J.push(this._queryRelatedRecords(B,S))},this),g(J).then(K.hitch(this,function(S){v.attachmentInfos=this._createAttachmentInfoLookup(S.shift());v.relatedRecordInfos=
this._createRelatedRecordInfoLookup(S);r.resolve(v)})).otherwise(function(){r.resolve(v)})):this.getRelatedRecords?(p.forEach(w,function(S){J.push(this._queryRelatedRecords(B,S))},this),g(J).then(K.hitch(this,function(S){v.relatedRecordInfos=this._createRelatedRecordInfoLookup(S);r.resolve(v)})).otherwise(function(){r.resolve(v)})):this.getAttachments?this._queryAttachments(B).then(K.hitch(this,function(S){v.attachmentInfos=this._createAttachmentInfoLookup(S);r.resolve(v)})).otherwise(function(){r.resolve(v)}):
r.resolve(v)}else r.resolve(v)})).otherwise(function(z){r.reject(v)});return new d(r)},_queryRelatedRecords:function(h,f){var r=this.layer,q=r.advancedQueryCapabilities;if(q&&q.supportsAdvancedQueryRelated)return this._queryRelatedRecordCount(h,f);q=new c;q.outFields=["*"];q.returnGeometry=!1;q.relationshipId=f.id;q.objectIds=h;return r.queryRelatedFeatures(q)},_queryRelatedRecordCount:function(h,f){return n({url:this.layer._url.path+"/queryRelatedRecords",content:{f:"json",objectIds:h.toString(),
outFields:["*"],returnGeometry:!1,relationshipId:f.id,returnCountOnly:!0},handleAs:"json",callbackParamName:"callback"})},_createRelatedRecordInfoLookup:function(h){var f=this.layer.relationships,r={};p.forEach(h,function(q,t){r[f[t].id]=q});return r},_queryAttachments:function(h){return n({url:this.layer._url.path+"/queryAttachments",content:{f:"json",objectIds:h.toString()},handleAs:"json",callbackParamName:"callback"})},_createAttachmentInfoLookup:function(h){var f={};p.forEach(h.attachmentGroups,
function(r){f[r.parentObjectId]={attachments:r.attachmentInfos}});return f}});K.setObject("dijit.FeatureLayerQueryStore",a,l);return a})},"esri/dijit/FeatureLayerQueryResult":function(){define(["../lang","dojo/_base/lang","dojo/_base/kernel","dojo/_base/Deferred"],function(e,K,p,a){var g=function(m){function n(b){m[b]||(m[b]=function(){var c=arguments;return a.when(m,function(d){Array.prototype.unshift.call(c,d.features||d);return new g(p[b].apply(p,c))})})}if(!m)return m;m.then&&(m=K.delegate(m));
m.total||(m.total=a.when(m,function(b){return e.isDefined(b.total)?b.total:b.length||0}));n("forEach");n("filter");n("map");n("some");n("every");return m};K.setObject("dijit.FeatureLayerQueryResult",g);return g})},"esri/dijit/Histogram":function(){define("require ../kernel dijit/_TemplatedMixin dijit/_WidgetBase dijit/Tooltip dojo/has dojo/on dojo/string dojo/number dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/date/locale dojox/gfx dojo/i18n!../nls/jsapi dojo/text!./Histogram/templates/Histogram.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z){p=l([a,p],{declaredClass:"esri.dijit.Histogram",baseClass:"esri-histogram",templateString:z,data:null,statistics:null,isDate:!1,css:{container:"esri-histogram-container",topLabel:"esri-histogram-top-label",svgContainer:"esri-histogram-svg-container",bottomLabel:"esri-histogram-bottom-label",surface:"esri-histogram-surface",group:"esri-histogram-group",bar:"esri-histogram-bar"},_surface:null,_countTooltips:null,_barsGroup:null,_defaultImagePadding:30,
_defaultBarPadding:40,_i18n:x.widgets.histogram,constructor:function(A,B){this._countTooltips=[]},startup:function(){this.inherited(arguments);this._syncContainerSizes();this._surface=this._generateSurface();this._barsGroup=this._generateBarsGroup();this.statistics&&(this._generateLines(),this._generateCountTooltips());this._updateLabels()},_syncContainerSizes:function(){this._nodeDimensions=w.getMarginBox(this.domNode);this._topLabelHeight=w.getMarginBox(this._topLabelNode).h;this._bottomLabelHeight=
w.getMarginBox(this._bottomLabelNode).h;this._svgContainer.setAttribute("style","height: "+(this._nodeDimensions.h-(this._topLabelHeight+this._bottomLabelHeight)-1)+"px;");this._svgContainerDimensions=w.getMarginBox(this._svgContainer)},_updateLabels:function(){var A=this.data.maxValue,B=this.data.minValue;this._topLabelNode.innerHTML=this.isDate?this._getFormattedDate(A):this._getLocaleFormattedNumber(A);this._bottomLabelNode.innerHTML=this.isDate?this._getFormattedDate(B):this._getLocaleFormattedNumber(B)},
_generateSurface:function(){var A=v.createSurface(this._svgContainer,"100%","100%");A.rawNode.setAttribute("class",this.css.surface);return A},_generateBarsGroup:function(){var A=this.data,B=this._defaultBarPadding,J;var P=this._surface.createGroup();P.rawNode.setAttribute("class",this.css.group);var R=d.map(A.bins,function(T){return"object"===typeof T?T.count:T});R.reverse();var S=(this._svgContainerDimensions.h-1)/R.length;d.forEach(R,function(T,E){J=Math.round(0<T?(this._svgContainerDimensions.w-
B)*(T/Math.max.apply(Math,R)):0);T=P.createRect({width:J,height:S}).setFill("#aaa").setTransform(v.matrix.translate(1,S*E-1)).setStroke({color:"#FFF",width:2});T.rawNode.setAttribute("class",this.css.bar);T.rawNode.setAttribute("shape-rendering","crispEdges")},this);return P},_generateLines:function(){var A=this.statistics,B=this._svgContainerDimensions.h;var J=this.isDate?this._getFormattedDate(A.avg):this._getLocaleFormattedNumber(this._roundValueForLabel(A.avg));J=b.substitute(this._i18n.statsAvg,
{avg:J});var P=this._getLocaleFormattedNumber(this._roundValueForLabel(A.stddev));P=b.substitute(this._i18n.statsSD,{sd:P});var R={color:"#667",style:"Dot"};this._generateLine({label:J,lineStroke:{color:"#667"},imageURL:"esri/dijit/Histogram/images/xAvg.png",yAxisAlignment:B*(A.max-A.avg)/(A.max-A.min),imagePadding:this._defaultImagePadding});this._generateLine({label:P,lineStroke:R,imageURL:"esri/dijit/Histogram/images/sd.png",yAxisAlignment:B*(A.max-A.avg-A.stddev)/(A.max-A.min),imagePadding:this._defaultImagePadding+
10});this._generateLine({label:P,lineStroke:R,imageURL:"esri/dijit/Histogram/images/sd.png",yAxisAlignment:B*(A.max-A.avg+A.stddev)/(A.max-A.min),imagePadding:this._defaultImagePadding+10})},_generateLine:function(A){var B=this._surface,J=this._svgContainerDimensions.h,P=A.yAxisAlignment,R=A.imageURL,S=A.lineStroke,T=A.label;A=A.imagePadding;S=B.createLine({x1:0,x2:this._svgContainerDimensions.w-A,y1:P,y2:P}).setStroke(S);S.rawNode.setAttribute("shape-rendering","crispEdges");B=B.createImage({x:this._svgContainerDimensions.w-
A,y:P-6,width:12,height:14,src:e.toUrl(R)});new g({connectId:[B.rawNode],label:T});J=P>J||0>P?"none":"block";q.set(S.rawNode,"display",J);q.set(B.rawNode,"display",J)},_generateCountTooltips:function(){var A=d.map(this.data.bins,function(B){return"object"===typeof B?B.count:B});A.reverse();d.forEach(A,function(B,J){B=b.substitute(this._i18n.count,{count:B});this._countTooltips.push(new g({connectId:[this._barsGroup.children[J].rawNode],label:B}))},this)},_getLocaleFormattedNumber:function(A){return isNaN(A)?
null:c.format(A)},_getFormattedDate:function(A){return u.format(new Date(A))},_roundValueForLabel:function(A){return c.round(A,this._getRoundingPrecision(A))},_getRoundingPrecision:function(A){return 1E3<=A?0:10<=A?2:0<=A?4:6}});h.setObject("dijit.Histogram",p,K);return p})},"arcgisonline/map/itemData":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/map/main,arcgisonline/map/popup,arcgisonline/map/mapUtil,arcgisonline/map/featColl,arcgisonline/map/labels"],
function(e,K,p){e.provide("arcgisonline.map.itemData");e.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");e.require("arcgisonline.map.main");e.require("arcgisonline.map.popup");e.require("arcgisonline.map.mapUtil");e.require("arcgisonline.map.featColl");e.require("arcgisonline.map.labels");arcgisonline.map.itemData={itemDataContents:{},deletedFSItemSubLayers:{},checkItemDataContent:function(a,g){var m=function(){g&&g()};if(a.itemId&&a.featureCollection)g&&g();else if(a.itemId&&"esri.layers.FeatureLayer"===
a.layer.declaredClass){var n=function(b){var c=!1;if(b.origItemLayers){b.__createDefaultPopup&&(arcgisonline.map.popup.removePopup(b),b.popupChanged=!1,delete b.popupInfo,delete b.__createDefaultPopup);for(var d=parseInt(b.layer.url.substring(b.layer.url.lastIndexOf("/")+1)),l=!1,h=0;h<b.origItemLayers.length;h++){var f=b.origItemLayers[h];if(f.id===d){l=!0;!f.popupInfo||f.disablePopup||b.popupInfo||b.disablePopup?f.popupInfo||b.popupInfo||(b.disablePopup=!0):(b.popupInfo=f.popupInfo,arcgisonline.map.popup.addPopupLayer(b,
null),b.popupChanged=!1,arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.popupChanged=!0));!esri.isDefined(b.showLabels)&&f.showLabels&&(b.showLabels=!0);d=b.rendererChanged||b.featureReductionChanged||b.scaleChanged||b.defExpChanged||b.spatialFilterChanged||b.maximumTrackPointsChanged;f.layerDefinition&&f.layerDefinition.drawingInfo&&(f.layerDefinition.drawingInfo.renderer||f.layerDefinition.drawingInfo.labelingInfo||f.layerDefinition.featureReduction)?(b.layerDefinition&&arcgisonline.isEmpty(b.layerDefinition)&&
(d=b.rendererChanged=!0),d||(b.layerDefinition=b.layerDefinition||{},b.layerDefinition.drawingInfo=e.clone(f.layerDefinition.drawingInfo),f.layerDefinition.drawingInfo&&f.layerDefinition.drawingInfo.renderer&&(h=esri.renderer.fromJson(e.clone(f.layerDefinition.drawingInfo.renderer),{geometryType:b.layer.geometryType}),"esri.renderer.ClassBreaksRenderer"===h.declaredClass&&h.setMaxInclusive(!0),arcgisonline.map.mapUtil.setRenderer(b.layer,h),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||
(b.rendererChanged=!0),arcgisonline.map.mapUtil.checkHostedFSAccess(b,e.hitch(this,function(t){if(!t.layer.templates.length&&("esri.renderer.SimpleRenderer"==t.layer.renderer.declaredClass||"esri.renderer.ClassBreaksRenderer"==t.layer.renderer.declaredClass||"esri.renderer.HeatmapRenderer"==t.layer.renderer.declaredClass)||!t.layer.types.length&&"esri.renderer.UniqueValueRenderer"==t.layer.renderer.declaredClass)arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(t.layer),arcgisonline.map.edit.createTypesAndTemplatesOnLayer(t.layer),
t.featureTemplatesChanged=!0},b))),f.layerDefinition.drawingInfo&&f.layerDefinition.drawingInfo.labelingInfo&&(h=e.map(f.layerDefinition.drawingInfo.labelingInfo,function(t){return new esri.layers.LabelClass(t)}),arcgisonline.map.mapUtil.setLabelingInfo(b.layer,h,b.showLabels),b.showLabels&&arcgisonline.map.labels.addLabelsForLayer(b.layer),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.rendererChanged=!0)),f.layerDefinition.featureReduction&&(b.layerDefinition.featureReduction=e.clone(f.layerDefinition.featureReduction),
h=e.clone(f.layerDefinition.featureReduction),h.clusterRadius=p.gfx.pt2px(h.clusterRadius||h.clusterSize),h.popupInfo&&h.disablePopup&&(delete h.popupInfo,delete h.disablePopup),h.popupInfo?(h.infoTemplate=new esri.dijit.PopupTemplate(h.popupInfo),delete h.popupInfo):h.disablePopup=!0,b.layer.setFeatureReduction(h),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.featureReductionChanged=!0)))):!d&&!1!==b.showLabels&&f.showLabels&&b.layer.labelingInfo&&(b.showLabels=!0,arcgisonline.map.labels.addLabelsForLayer(b.layer));
f.showLabels&&b.showLabels&&!arcgisonline.map.main.isItemFromSamePortal(b.itemCard)&&(b.rendererChanged=!0);!d&&f.layerDefinition&&f.layerDefinition.definitionExpression&&(b.layer.setDefinitionExpression(f.layerDefinition.definitionExpression),b.layerDefinition=b.layerDefinition||{},b.layerDefinition.definitionExpression=f.layerDefinition.definitionExpression,f.definitionEditor&&(b.definitionEditor=f.definitionEditor),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.defExpChanged=!0));!d&&
f.layerDefinition&&(esri.isDefined(f.layerDefinition.minScale)||esri.isDefined(f.layerDefinition.maxScale))&&(b.layer.setScaleRange(esri.isDefined(f.layerDefinition.minScale)?f.layerDefinition.minScale:b.layer.minScale,esri.isDefined(f.layerDefinition.maxScale)?f.layerDefinition.maxScale:b.layer.maxScale),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.scaleChanged=!0));b.legendChanged||(!1===f.showLegend?(b.showLegend=!1,arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.legendChanged=
!0)):delete b.showLegend);!b.refreshIntervalChanged&&esri.isDefined(f.refreshInterval)&&(b.layer.setRefreshInterval(f.refreshInterval),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.refreshIntervalChanged=!0));if(esri.isDefined(f.timeAnimation)){var r=!1;arcgisonline.map.save_open.openedWebMap&&(d=arcgisonline.map.save_open.openedWebMap,d=d.operationalLayers.concat(d.baseMap.baseMapLayers),e.forEach(d,function(t){t.id===b.id&&esri.isDefined(t.timeAnimation)&&(r=!0)}));r||(b.layer.setUseMapTime(f.timeAnimation),
arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.timeChanged=!0))}if(f.layerDefinition&&(f.layerDefinition.drawingInfo&&esri.isDefined(f.layerDefinition.drawingInfo.transparency)||esri.isDefined(f.layerDefinition.defaultVisibility)))if(arcgisonline.map.main.isWebMapLayer(b)){var q=!1;arcgisonline.map.save_open.openedWebMap&&(d=arcgisonline.map.save_open.openedWebMap,d=d.operationalLayers.concat(d.baseMap.baseMapLayers),e.forEach(d,function(t){t.id===b.id&&esri.isDefined(t.opacity)&&(q=!0)}));
!q&&f.layerDefinition.drawingInfo&&esri.isDefined(f.layerDefinition.drawingInfo.transparency)&&b.layer.setOpacity(1-f.layerDefinition.drawingInfo.transparency/100)}else f.layerDefinition.drawingInfo&&esri.isDefined(f.layerDefinition.drawingInfo.transparency)&&b.layer.setOpacity(1-f.layerDefinition.drawingInfo.transparency/100),esri.isDefined(f.layerDefinition.defaultVisibility)&&(f.layerDefinition.defaultVisibility?(b.layer.show(),b.visibility=!0):(b.layer.hide(),b.visibility=!1));!b.rendererChanged&&
!b.scaleChanged&&f.layerDefinition&&(f.layerDefinition.drawingInfo&&(f.layerDefinition.drawingInfo.renderer||f.layerDefinition.drawingInfo.labelingInfo)&&!f.layerDefinition.featureReduction||esri.isDefined(f.layerDefinition.minScale)||esri.isDefined(f.layerDefinition.maxScale))&&arcgisonline.map.mapUtil.checkHostedFSAccess(b,e.hitch(this,function(t,w){t.layerDefinition.drawingInfo&&(t.layerDefinition.drawingInfo.renderer||t.layerDefinition.drawingInfo.labelingInfo)&&(w.rendererChanged=!0);if(esri.isDefined(t.layerDefinition.minScale)||
esri.isDefined(t.layerDefinition.maxScale))w.scaleChanged=!0},f));break}}l||(c=!0)}g&&g(c)};arcgisonline.map.itemData.getItemLayerInfos(a,e.hitch(this,n,a),e.hitch(this,m))}else a.itemId&&"esri.layers.StreamLayer"===a.layer.declaredClass?(n=function(b){var c=arcgisonline.map.itemData.itemDataContents[b.itemId],d=arcgisonline.map.main.isItemFromSamePortal(b.itemCard);!c.empty&&b.__createDefaultPopup&&(arcgisonline.map.popup.removePopup(b),b.popupChanged=!1,delete b.popupInfo,delete b.__createDefaultPopup);
!c.popupInfo||b.popupInfo||b.disablePopup?c.popupInfo||b.popupInfo||(b.disablePopup=!0):(b.popupInfo=c.popupInfo,arcgisonline.map.popup.addPopupLayer(b,null),b.popupChanged=!1,d||(b.popupChanged=!0));var l=b.rendererChanged||b.scaleChanged||b.defExpChanged||b.spatialFilterChanged||b.maximumTrackPointsChanged||b.opacityChanged||b.featureReductionChanged;if(c.layerDefinition&&c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.renderer&&(b.layerDefinition&&arcgisonline.isEmpty(b.layerDefinition)&&
(l=b.rendererChanged=!0),!l)){b.layerDefinition=b.layerDefinition||{};b.layerDefinition.drawingInfo=e.clone(c.layerDefinition.drawingInfo);var h=esri.renderer.fromJson(e.clone(c.layerDefinition.drawingInfo.renderer),{geometryType:b.layer.geometryType});"esri.renderer.ClassBreaksRenderer"===h.declaredClass&&h.setMaxInclusive(!0);arcgisonline.map.mapUtil.setRenderer(b.layer,h);d||(b.rendererChanged=!0);c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.labelingInfo&&(h=e.map(c.layerDefinition.drawingInfo.labelingInfo,
function(f){return new esri.layers.LabelClass(f)}),arcgisonline.map.mapUtil.setLabelingInfo(b.layer,h,c.showLabels),(b.showLabels=c.showLabels)&&arcgisonline.map.labels.addLabelsForLayer(b.layer),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.rendererChanged=!0));c.layerDefinition.featureReduction&&(b.layerDefinition.featureReduction=e.clone(c.layerDefinition.featureReduction),h=e.clone(c.layerDefinition.featureReduction),h.clusterRadius=p.gfx.pt2px(h.clusterRadius||h.clusterSize),h.popupInfo&&
h.disablePopup&&(delete h.popupInfo,delete h.disablePopup),h.popupInfo?(h.infoTemplate=new esri.dijit.PopupTemplate(h.popupInfo),delete h.popupInfo):h.disablePopup=!0,b.layer.setFeatureReduction(h),d||(b.featureReductionChanged=!0))}!l&&c.layerDefinition&&(esri.isDefined(c.layerDefinition.minScale)||esri.isDefined(c.layerDefinition.maxScale))&&(b.layer.setScaleRange(esri.isDefined(c.layerDefinition.minScale)?c.layerDefinition.minScale:b.layer.minScale,esri.isDefined(c.layerDefinition.maxScale)?c.layerDefinition.maxScale:
b.layer.maxScale),d||(b.scaleChanged=!0));!l&&c.layerDefinition&&c.layerDefinition.definitionExpression&&(b.layer.setDefinitionExpression(c.layerDefinition.definitionExpression),b.layerDefinition=b.layerDefinition||{},b.layerDefinition.definitionExpression=c.layerDefinition.definitionExpression,c.definitionEditor&&(b.definitionEditor=c.definitionEditor),d||(b.scaleChanged=!0));l&&!b.spatialFilterChanged&&c.layerDefinition&&c.layerDefinition.definitionGeometry?b.spatialFilterChanged=!0:!l&&c.layerDefinition&&
c.layerDefinition.definitionGeometry&&(b.layer.setFilter({geometry:new esri.geometry.Extent(c.layerDefinition.definitionGeometry)}),d||(b.spatialFilterChanged=!0));!l&&c.layerDefinition&&esri.isDefined(c.layerDefinition.maximumTrackPoints)&&(b.layer.setMaximumTrackPoints(c.layerDefinition.maximumTrackPoints),d||(b.maximumTrackPointsChanged=!0));b.legendChanged||(!1===c.showLegend?(b.showLegend=!1,d||(b.legendChanged=!0)):delete b.showLegend);!esri.isDefined(c.opacity)&&!esri.isDefined(c.visibility)||
arcgisonline.map.main.isWebMapLayer(b)||(esri.isDefined(c.opacity)&&(b.layer.setOpacity(c.opacity),b.defaultOpacity=c.opacity),esri.isDefined(c.visibility)&&(c.visibility?(b.layer.show(),b.visibility=!0,b.defaultVisibility=!0):(b.layer.hide(),b.visibility=!1,b.defaultVisibility=!1)));g&&g()},arcgisonline.map.itemData.getItemLayerInfos(a,e.hitch(this,n,a),e.hitch(this,m))):a.itemId?(n=function(b){b.itemLayers||(b.itemLayers=e.clone(b.origItemLayers));var c=arcgisonline.map.itemData.itemDataContents[b.itemId];
if(c){var d=!1;if(arcgisonline.map.save_open.openedWebMap){var l=arcgisonline.map.save_open.openedWebMap;l=l.operationalLayers.concat(l.baseMap.baseMapLayers);e.forEach(l,function(r){r.id===b.id&&esri.isDefined(r.minScale)&&esri.isDefined(r.maxScale)&&(d=!0)})}d||((esri.isDefined(c.minScale)||esri.isDefined(c.maxScale))&&b.layer.setScaleRange(esri.isDefined(c.minScale)?c.minScale:b.layer.minScale,esri.isDefined(c.maxScale)?c.maxScale:b.layer.maxScale),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||
(b.scaleChanged=!0));!b.refreshIntervalChanged&&esri.isDefined(c.refreshInterval)&&(b.layer.setRefreshInterval(c.refreshInterval),delete b.refreshInterval,arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.refreshIntervalChanged=!0));!b.timeChanged&&esri.isDefined(c.timeAnimation)&&(b.layer.setUseMapTime(!1),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.timeChanged=!0));!esri.isDefined(c.opacity)&&!esri.isDefined(c.visibility)||arcgisonline.map.main.isWebMapLayer(b)||(esri.isDefined(c.opacity)&&
1===b.layer.opacity&&b.layer.setOpacity(c.opacity),esri.isDefined(c.visibility)&&(c.visibility?(b.layer.show(),b.visibility=!0,b.defaultVisibility=!0):(b.layer.hide(),b.visibility=!1,b.defaultVisibility=!1)));if("esri.layers.RasterXLayer"===b.layer.declaredClass||"esri.layers.ArcGISImageServiceLayer"===b.layer.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===b.layer.declaredClass){!b.defaultBandIds&&c.bandIds&&(b.layer.setBandIds(c.bandIds),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||
(b.renderingRuleChanged=!0));!b.renderingRule&&c.renderingRule&&(l=new esri.layers.RasterFunction(c.renderingRule),b.layer.setRenderingRule(l,!0),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.renderingRuleChanged=!0));if(!b.layerDefinition&&c.layerDefinition&&c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.renderer){l=c.layerDefinition.drawingInfo.renderer;var h=esri.renderer.fromJson(e.clone(l));b.layer.setRenderer(h,!0);arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||
(b.rendererChanged=!0);!b.symbolTileSize&&c.symbolTileSize&&(b.layer.symbolTileSize=c.symbolTileSize);h=b.layer.vectorFieldPixelFilter||new esri.layers.pixelFilters.VectorFieldPixelFilter;if(l.outputUnit||l.inputUnit)h.setUnits(l.inputUnit,l.outputUnit),b.layer.vectorFieldPixelFilter=h}!b.mosaicRule&&c.mosaicRule&&(l=new esri.layers.MosaicRule(c.mosaicRule),b.layer.setMosaicRule(l,!0),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.mosaicRuleChanged=!0));!b.mosaicRule&&c.multidimensionalDefinition&&
"esri.layers.RasterXLayer"===b.layer.declaredClass&&(l=new esri.layers.MosaicRule,l.multidimensionalDefinition=c.multidimensionalDefinition.map(function(r){return new esri.layers.DimensionalDefinition(r)}),b.layer.setMosaicRule(l,!0),b.layer.setMultiDimensionalDefinition(l),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.mosaicRuleChanged=!0));!b.format&&c.format&&(b.layer.setImageFormat(c.format,!0),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.imageQualityChanged=!0));!b.compressionQuality&&
c.compressionQuality&&(b.layer.setCompressionQuality(c.compressionQuality,!0),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.imageQualityChanged=!0));!b.interpolation&&c.interpolation&&b.layer.setInterpolation(c.interpolation,!0);b.popupInfo||b.disablePopup||!c.popupInfo?c.popupInfo||b.popupInfo||(b.disablePopup=!0):(b.popupInfo=c.popupInfo,arcgisonline.map.popup.addPopupLayer(b,null),b.popupChanged=!1,arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.popupChanged=!0));(!b.layerDefinition||
b.layerDefinition&&arcgisonline.isEmpty(b.layerDefinition.definitionExpression))&&c.layerDefinition&&esri.isDefined(c.layerDefinition.definitionExpression)&&(b.layer.setDefinitionExpression(c.layerDefinition.definitionExpression),b.layerDefinition=c.layerDefinition||{},b.layerDefinition.definitionExpression=c.layerDefinition.definitionExpression,c.definitionEditor&&(b.definitionEditor=c.definitionEditor),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.defExpChanged=!0));b.legendChanged||
(!1===c.showLegend?(b.showLegend=!1,arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.legendChanged=!0)):delete b.showLegend)}}if(b.itemLayers&&0<b.itemLayers.length){var f=[];e.forEach(b.itemLayers,function(r){r.layerDefinition&&r.layerDefinition.definitionExpression&&(b.layer.setLayerDefinitions?f[r.id]=r.layerDefinition.definitionExpression:delete r.layerDefinition.definitionExpression)},this);f.length&&(b.layer.setLayerDefinitions(f),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||
(b.defExpChanged=!0));arcgisonline.map.main.hasDynamicLayers(b)&&b.origItemLayers&&!b.layersChanged&&arcgisonline.map.dynLayer.updateDynamicLayers(b)}!b.visibleLayersChanged&&c.visibleLayers&&(b.layer.setVisibleLayers?(b.visibleLayers=c.visibleLayers.toString(),l=b.layer.layerInfos,arcgisonline.map.main.hasDynamicLayers(b)&&(l=b.itemLayers),c=arcgisonline.map.main.filterSubLayers(l,c.visibleLayers.toString()),b.layer.setVisibleLayers(c),arcgisonline.map.main.isItemFromSamePortal(b.itemCard)||(b.visibleLayersChanged=
!0)):delete c.visibleLayers);b.popupChanged||arcgisonline.map.main.isMapFullyLoaded&&(arcgisonline.map.main.hasDynamicLayers(b)?arcgisonline.map.main.getLayersInfo(b,e.hitch(this,function(){e.forEach(b.layer.dynamicLayerInfos,function(r,q){arcgisonline.map.popup.addPopupLayer(b,r.id)},this)})):arcgisonline.map.main.getLayersInfo(b,e.hitch(this,function(){e.forEach(b.layer.layerInfos,function(r){arcgisonline.map.popup.addPopupLayer(b,r.id)},this)})));g&&g()},arcgisonline.map.itemData.getItemLayerInfos(a,
e.hitch(this,n,a),e.hitch(this,m))):g&&g()},getItemLayerInfos:function(a,g,m){var n=function(){var b=arcgisonline.map.itemData.itemDataContents[a.itemId];b.error||b.message&&!esri.isDefined(b.layers)?m&&m():(b.layers&&(a.origItemLayers=b.layers,a.thematicGroup=b.thematicGroup),esri.isDefined(b.refreshInterval)&&!esri.isDefined(a.refreshInterval)&&(a.refreshInterval=b.refreshInterval),b.visibleLayers&&!esri.isDefined(a.visibleLayers)&&(a.visibleLayers=b.visibleLayers.toString()),g())};arcgisonline.map.itemData.itemDataContents[a.itemId]?
arcgisonline.map.itemData.itemDataContents[a.itemId].loading?a.intervalHandler||(a.intervalHandler=setInterval(e.hitch(this,function(){!0!==arcgisonline.map.itemData.itemDataContents[a.itemId].loading&&(clearInterval(a.intervalHandler),delete a.intervalHandler,n())}),500)):n():(arcgisonline.map.itemData.itemDataContents[a.itemId]={loading:!0},arcgisonline.sharing.util.request({url:(a.itemCard&&a.itemCard.restBaseUrl||esriGeowConfig.restBaseUrl)+"content/items/"+a.itemId+"/data"},{disableIdentityLookup:!0}).then(e.hitch(this,
function(b){null===b&&a.url&&-1<a.url.toLowerCase().indexOf("/streamserver")&&(b={empty:!0});b=b||{};arcgisonline.map.itemData.itemDataContents[a.itemId]=b;n()}),e.hitch(this,function(b){arcgisonline.map.itemData.itemDataContents[a.itemId]=b;m&&m()})))},uploadItemLayerInfos:function(a,g,m,n){var b=new e.Deferred;if(arcgisonline.sharing.util.isLoggedIn()){var c=function(w,u,v){r?(u=(new Date).getTime()-f.getTime(),setTimeout(function(){t.hide("uploadItemLayerInfos")},6E3>u?6E3-u:0)):t.hide("uploadItemLayerInfos");
a.itemLayers&&a.itemLayers.length?a.origItemLayers=e.clone(a.itemLayers):a.layer&&a.layer.url&&!(a.layer instanceof esri.layers.StreamLayer)&&(a.defExpChanged||a.spatialFilterChanged||a.rendererChanged&&!m||a.renderingRuleChanged||a.featureReductionChanged)&&arcgisonline.map.thumbnail.recreateItemThumbnail(a);arcgisonline.map.itemData.itemDataContents[a.itemId]=w;a.popupInfo&&a.popupChanged&&!q&&delete a.popupChanged;delete a.legendChanged;delete a.scaleChanged;delete a.defExpChanged;delete a.spatialFilterChanged;
delete a.maximumTrackPointsChanged;delete a.renderingRuleChanged;delete a.mosaicRuleChanged;delete a.imageQualityChanged;delete a.refreshIntervalChanged;delete a.visibleLayersChanged;delete a.dataChanged;delete a.editableChanged;delete a.timeChanged;delete a.visibilityChanged;delete a.opacityChanged;delete a.layersChanged;a.featureReductionChanged&&delete a.rendererChanged;delete a.featureReductionChanged;arcgisonline.map.mapUtil.checkHostedFSAccess(a,e.hitch(this,function(x){delete x.rendererChanged}),
e.hitch(this,function(x){m||delete x.rendererChanged}));g&&g();!b.isResolved()&&b.callback()},d=function(w,u){t.hide("uploadItemLayerInfos");n?n(w):arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingPropsFailed,{title:a.itemCard.title})})},l,h=function(){if(!a.layer||"esri.layers.FeatureLayer"!==a.layer.declaredClass||a.origItemLayers||arcgisonline.map.itemData.deletedFSItemSubLayers[a.itemId]){var w=
function(E,I,F){var D={};if(I){if(I.layers){var C=[];e.forEach(I.layers,function(G,L){G[L]&&delete G[L];C.push(G)});I.layers=C}delete I.empty;D.text=e.json.stringify(I)}F&&(D.thumbnailURL=F);if(E.itemCard&&"Feature Service"===E.itemCard.type&&(arcgisonline.sharing.util.isHostedService(E.url)||-1<e.indexOf(E.itemCard.typeKeywords,"providerSDS"))&&(F=E.itemCard.typeKeywords,-1<e.indexOf(F,"webmap_2.1"))){var y=e.indexOf(F,"webmap_2.1");F.splice(y,1);D.typeKeywords=F.toString()}arcgisonline.sharing.util.getUser();
F=esriGeowConfig.restBaseUrl+"content/users/"+E.itemCard.owner;F+=E.itemCard.ownerFolder?"/"+E.itemCard.ownerFolder:"";F+="/items/"+E.itemCard.id+"/update";arcgisonline.sharing.util.postJson(D,F,e.hitch(this,c,I),e.hitch(this,d))},u=arcgisonline.map.itemData.itemDataContents[a.itemId]||{};if(arcgisonline.map.featColl.isFeatureCollection(a)){var v=arcgisonline.map.featColl.buildFeatureCollectionJson(a);m&&(a.layers?e.forEach(v.layers,function(E,I){E.layerDefinition&&E.layerDefinition.drawingInfo&&
(E.layerDefinition.drawingInfo=u.featureCollection?u.featureCollection.layers[I].layerDefinition.drawingInfo:u.layers[I].layerDefinition.drawingInfo)}):v.layers[0].layerDefinition&&u.layers[0].layerDefinition&&(v.layers[0].layerDefinition.drawingInfo=u.layers[0].layerDefinition.drawingInfo));if(a.layers)if(v.opacity=a.layers[0].opacity||0===a.layers[0].opacity?a.layers[0].opacity:1,v.visibility=0==a.visibility?!1:!0,esri.isDefined(a.visibleLayers))if(""===a.visibleLayers)v.visibleLayers=[];else{var x=
a.visibleLayers.split(",");x.length<a.layers.length&&(v.visibleLayers=e.map(x,function(E){return parseInt(E)}))}else delete v.visibleLayers;else v.visibility=a.layer.visible,v.opacity=a.layer.opacity||0===a.layer.opacity?a.layer.opacity:1;delete u.layers;v=e.mixin(u,v);(a.rendererChanged&&!m||a.featureReductionChanged||a.scaleChanged||a.renderingRuleChanged)&&!arcgisonline.map.thumbnail.hasCustomThumbnail(a)&&arcgisonline.map.thumbnail.buildThumbnailURLFromLayerOnMap(a,a.itemCard.extent?a.itemCard.extent.toString():
"").then(function(E){w(a,null,E)});w(a,v)}else if(a.layer&&"esri.layers.FeatureLayer"===a.layer.declaredClass){var z=parseInt(a.layer.url.substring(a.layer.url.lastIndexOf("/")+1)),A=null;if(a.origItemLayers)for(x=0;x<a.origItemLayers.length;x++){if(a.origItemLayers[x].id===z){A=a.origItemLayers[x];break}}else a.origItemLayers=[],arcgisonline.map.main.mapLayers.length?e.forEach(arcgisonline.map.main.mapLayers,function(E){if(E.itemId===a.itemId&&E.popupInfo){for(var I=parseInt(E.layer.url.substring(E.layer.url.lastIndexOf("/")+
1)),F={id:I,popupInfo:E.popupInfo},D=!1,C=0;C<a.origItemLayers.length;C++)a.origItemLayers[C].id===I&&(D=!0,E.id===a.id&&a.origItemLayers.splice(C,1,F));D||a.origItemLayers.push(F);E.id===a.id&&(A=F)}},this):e.forEach(arcgisonline.map.itemData.deletedFSItemSubLayers[a.itemId],function(E){E.id===z&&(A=E)}),arcgisonline.map.itemData.deletedFSItemSubLayers[a.itemId]&&(e.forEach(arcgisonline.map.itemData.deletedFSItemSubLayers[a.itemId],function(E){a.origItemLayers.push(E)}),a.origItemLayers=a.origItemLayers.sort(function(E,
I){return l?(E=e.indexOf(l,E.id),I=e.indexOf(l,I.id),E<I?-1:1):E.id<I.id?-1:1}));A||(A={id:z},a.origItemLayers.push(A));a.popupInfo&&a.popupChanged&&!q?A.popupInfo=a.popupInfo:a.disablePopup&&delete A.popupInfo;a.legendChanged&&(!1===a.showLegend?A.showLegend=!1:delete A.showLegend);a.rendererChanged&&(a.layer.labelingInfo&&arcgisonline.map.labels.hasLayer(a.layer)?A.showLabels=!0:(x=!1,a.serviceInfo&&a.serviceInfo.drawingInfo&&(x=!!a.serviceInfo.drawingInfo.labelingInfo),x?A.showLabels=!1:(delete A.showLabels,
A.layerDefinition&&A.layerDefinition.drawingInfo&&delete A.layerDefinition.drawingInfo.labelingInfo)));a.refreshIntervalChanged&&esri.isDefined(a.layer.refreshInterval)&&(a.layer.refreshInterval?A.refreshInterval=a.layer.refreshInterval:delete A.refreshInterval);a.visibleLayersChanged&&esri.isDefined(a.visibleLayers)&&(A.visibleLayers=a.visibleLayers);a.timeChanged&&!a.layer.useMapTime?A.timeAnimation=!1:delete A.timeAnimation;a.defExpChanged&&(a.layerDefinition&&esri.isDefined(a.layerDefinition.definitionExpression)&&
(a.layerDefinition.definitionExpression.length?(A.layerDefinition=A.layerDefinition||{},A.layerDefinition.definitionExpression=a.layerDefinition.definitionExpression,a.definitionEditor&&(A.definitionEditor=a.definitionEditor)):(delete A.layerDefinition.definitionExpression,delete A.definitionEditor)),a.layerDefinition&&""==a.layerDefinition.definitionExpression&&delete a.layerDefinition.definitionExpression);a.opacityChanged&&(x=a.layer.opacity||0===a.layer.opacity?a.layer.opacity:1,1>x?(A.layerDefinition=
A.layerDefinition||{},A.layerDefinition.drawingInfo=A.layerDefinition.drawingInfo||{},A.layerDefinition.drawingInfo.transparency=100-100*x):A.layerDefinition&&A.layerDefinition.drawingInfo&&esri.isDefined(A.layerDefinition.drawingInfo.transparency)&&(delete A.layerDefinition.drawingInfo.transparency,arcgisonline.isEmpty(A.layerDefinition.drawingInfo)&&(delete A.layerDefinition.drawingInfo,arcgisonline.isEmpty(A.layerDefinition)&&delete A.layerDefinition)));A.layerDefinition=A.layerDefinition||{};
(A.layerDefinition.defaultVisibility=a.layer.visible)&&a.layerVisibleForVizTab&&isEmbedded&&isEmbedded.isItemDetail&&(A.layerDefinition.defaultVisibility=!1);!a.scaleChanged&&A.layerDefinition&&(delete A.layerDefinition.minScale,delete A.layerDefinition.maxScale);var B=function(E,I){I={};I.layers=E.origItemLayers;E.thematicGroup&&(I.thematicGroup=E.thematicGroup);E.analysisInfo&&(I.analysisInfo=E.analysisInfo);delete u.layers;delete u.thematicGroup;delete u.analysisInfo;I=e.mixin(u,I);!(E.rendererChanged||
E.featureReductionChanged||E.scaleChanged||E.defExpChanged)||E.layer instanceof esri.layers.StreamLayer||arcgisonline.map.thumbnail.hasCustomThumbnail(E)||arcgisonline.map.thumbnail.recreateItemThumbnail(E);w(E,I)};arcgisonline.map.mapUtil.checkHostedFSAccess(a,e.hitch(this,function(E,I){(I.featureReductionChanged||I.rendererChanged)&&I.layer.getFeatureReduction&&I.layer.getFeatureReduction()?(E.layerDefinition=E.layerDefinition||{},E.layerDefinition.drawingInfo=E.layerDefinition.drawingInfo||{},
E.layerDefinition.drawingInfo.renderer=I.layer.renderer.toJson(),I.layer.labelingInfo&&I.showLabels?(E.layerDefinition.drawingInfo.labelingInfo=e.map(I.layer.labelingInfo,function(F){return F.toJson()}),E.showLabels=!0):(delete E.layerDefinition.drawingInfo.labelingInfo,E.showLabels=!1),E.layerDefinition.featureReduction=I.layer.getFeatureReduction(),E.layerDefinition.featureReduction.clusterRadius=p.gfx.px2pt(E.layerDefinition.featureReduction.clusterRadius),E.layerDefinition.featureReduction.infoTemplate&&
(E.layerDefinition.featureReduction.popupInfo=E.layerDefinition.featureReduction.infoTemplate.toJson(),delete E.layerDefinition.featureReduction.infoTemplate)):E.layerDefinition&&(delete E.layerDefinition.drawingInfo,delete E.layerDefinition.featureReduction,delete E.layerDefinition.minScale,delete E.layerDefinition.maxScale,I.layer.labelingInfo&&(arcgisonline.map.labels.hasLayer(I.layer)?E.showLabels=!0:E.showLabels=!1));arcgisonline.isEmpty(E.layerDefinition)&&delete E.layerDefinition;B(I,E)},A),
e.hitch(this,function(E,I){if(I.rendererChanged&&!m||I.featureReductionChanged)if(E.layerDefinition=E.layerDefinition||{},E.layerDefinition.drawingInfo||(E.layerDefinition.drawingInfo={}),E.layerDefinition.drawingInfo.renderer=I.layer.renderer.toJson(),I.layer.labelingInfo&&I.showLabels)E.layerDefinition.drawingInfo.labelingInfo=e.map(I.layer.labelingInfo,function(C){return C.toJson()}),E.showLabels=!0;else{delete E.layerDefinition.drawingInfo.labelingInfo;var F=!1;I.serviceInfo&&I.serviceInfo.drawingInfo&&
(F=!!I.serviceInfo.drawingInfo.labelingInfo);F?E.showLabels=!1:(delete E.showLabels,E.layerDefinition&&E.layerDefinition.drawingInfo&&delete E.layerDefinition.drawingInfo.labelingInfo)}I.featureReductionChanged&&(I.layer.getFeatureReduction()?(E.layerDefinition=E.layerDefinition||{},E.layerDefinition.featureReduction=I.layer.getFeatureReduction(),E.layerDefinition.featureReduction.clusterRadius=p.gfx.px2pt(E.layerDefinition.featureReduction.clusterRadius),E.layerDefinition.featureReduction.infoTemplate&&
(E.layerDefinition.featureReduction.popupInfo=E.layerDefinition.featureReduction.infoTemplate.toJson(),delete E.layerDefinition.featureReduction.infoTemplate)):delete E.layerDefinition.featureReduction);if(I.scaleChanged){F=I.layer.minScale?I.layer.minScale:0;var D=I.layer.maxScale?I.layer.maxScale:0;1===D&&(D=0);E.layerDefinition=E.layerDefinition||{};E.layerDefinition.minScale=F;E.layerDefinition.maxScale=D;0===F&&0===D&&(F=I.serviceInfo,F&&esri.isDefined(F.minScale)&&esri.isDefined(F.maxScale)&&
(0!==F.minScale||0!==F.maxScale)||!E.layerDefinition||(delete E.layerDefinition.minScale,delete E.layerDefinition.maxScale,arcgisonline.isEmpty(E.layerDefinition)&&delete E.layerDefinition))}B(I,E)},A))}else{if(a.layer&&"esri.layers.StreamLayer"===a.layer.declaredClass){v={};a.popupInfo&&(v.popupInfo=a.popupInfo);!1===a.showLegend&&(v.showLegend=!1);v.visibility=a.layer.visible;v.opacity=a.layer.opacity||0===a.layer.opacity?a.layer.opacity:1;if(a.rendererChanged||a.featureReductionChanged||a.scaleChanged||
a.defExpChanged||a.spatialFilterChanged||a.maximumTrackPointsChanged){v.layerDefinition=arcgisonline.map.itemData.itemDataContents[a.itemId].layerDefinition||{};a.layerDefinition&&esri.isDefined(a.layerDefinition.definitionExpression)&&a.layerDefinition.definitionExpression.length&&(v.layerDefinition.definitionExpression=a.layerDefinition.definitionExpression,a.definitionEditor&&(v.definitionEditor=a.definitionEditor));a.layerDefinition&&a.layerDefinition.definitionGeometry&&(v.layerDefinition.definitionGeometry=
a.layerDefinition.definitionGeometry);v.layerDefinition.drawingInfo=v.layerDefinition.drawingInfo||{};v.layerDefinition.drawingInfo.renderer=a.layer.renderer.toJson();a.layer.labelingInfo&&a.showLabels?(v.layerDefinition.drawingInfo.labelingInfo=e.map(a.layer.labelingInfo,function(E){return E.toJson()}),v.showLabels=!0):(delete v.layerDefinition.drawingInfo.labelingInfo,v.showLabels=!1);a.layer.getFeatureReduction&&a.layer.getFeatureReduction()?(v.layerDefinition.featureReduction=a.layer.getFeatureReduction(),
v.layerDefinition.featureReduction.clusterRadius=p.gfx.px2pt(v.layerDefinition.featureReduction.clusterRadius),v.layerDefinition.featureReduction.infoTemplate&&(v.layerDefinition.featureReduction.popupInfo=v.layerDefinition.featureReduction.infoTemplate.toJson(),delete v.layerDefinition.featureReduction.infoTemplate)):delete v.layerDefinition.featureReduction;a.layerDefinition&&esri.isDefined(a.layerDefinition.maximumTrackPoints)&&(v.layerDefinition.maximumTrackPoints=a.layerDefinition.maximumTrackPoints);
x=a.layer.minScale?a.layer.minScale:0;var J=a.layer.maxScale&&1!==a.layer.maxScale?a.layer.maxScale:0;0===x&&0===J&&a.serviceInfo&&!a.serviceInfo.minScale&&!a.serviceInfo.maxScale||a.serviceInfo&&a.serviceInfo.minScale===x&&a.serviceInfo.maxScale===J?(delete v.layerDefinition.minScale,delete v.layerDefinition.maxScale):(v.layerDefinition.minScale=x,v.layerDefinition.maxScale=1===J?0:J)}else v.layerDefinition=u.layerDefinition,v.definitionEditor=u.definitionEditor;delete u.popupInfo;delete u.showLegend;
delete u.layerDefinition;delete u.definitionEditor;v=e.mixin(u,v)}else if(a.layer&&"esri.layers.WFSLayer"===a.layer.declaredClass){v=arcgisonline.map.wfs.buildConfig(a,!0);if(a.layer.minScale||a.layer.maxScale)v.minScale=a.layer.minScale,v.maxScale=a.layer.maxScale;!1===a.showLegend&&(v.showLegend=!1);a.popupInfo&&(v.popupInfo=a.popupInfo);a.opacityChanged&&(x=a.layer.opacity||0===a.layer.opacity?a.layer.opacity:1,1>x&&(v.opacity=x));(a.rendererChanged&&!m||a.featureReductionChanged||a.scaleChanged)&&
!arcgisonline.map.thumbnail.hasCustomThumbnail(a)&&arcgisonline.map.thumbnail.buildThumbnailURLFromLayerOnMap(a,a.itemCard.extent?a.itemCard.extent.toString():"").then(function(E){E&&w(a,null,E)})}else{v={};if(u)v=u;else{t.hide("uploadItemLayerInfos");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingPropsFailed,{title:a.itemCard.title})});return}if(a.itemLayers&&
a.itemLayers.length){for(x=a.itemLayers.length-1;0<=x;x--)J=a.itemLayers[x],J.layerDefinition&&""==J.layerDefinition.definitionExpression&&(delete J.layerDefinition.definitionExpression,arcgisonline.isEmpty(J.layerDefinition)&&delete J.layerDefinition);if(a.itemLayers){var P=[];e.forEach(a.layer.layerInfos,function(E){P.push({id:E.id})});e.json.stringify(P)===e.json.stringify(a.itemLayers)&&(delete a.itemLayers,delete v.layers)}a.itemLayers&&(a.itemLayers.length?v.layers=e.map(e.clone(a.itemLayers),
function(E){delete E._layerInfo;return E}):(delete a.itemLayers,delete v.layers))}else!v.layers||"esri.layers.ArcGISDynamicMapServiceLayer"!==a.layer.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==a.layer.declaredClass||delete v.layers;a.scaleChanged&&(0!==a.layer.minScale||0!==a.layer.maxScale?(v.minScale=a.layer.minScale?a.layer.minScale:0,v.maxScale=a.layer.maxScale&&1!==a.layer.maxScale?a.layer.maxScale:0):(delete v.minScale,delete v.maxScale));a.refreshIntervalChanged&&(a.layer.refreshInterval?
v.refreshInterval=a.layer.refreshInterval:delete v.refreshInterval);if(a.visibleLayersChanged&&esri.isDefined(a.visibleLayers)){J=x="";var R=a.layer.layerInfos;arcgisonline.map.main.hasDynamicLayers(a)&&(R=a.itemLayers);for(var S=0;S<R.length;S++)1!=R[S].defaultVisibility&&esri.isDefined(R[S].defaultVisibility)||(J+=x+(R[S].id||R[S].name),x=",");J==a.visibleLayers?delete v.visibleLayers:""===a.visibleLayers?v.visibleLayers=[]:a.layer instanceof esri.layers.WMSLayer?v.visibleLayers=a.visibleLayers.split(","):
(x=a.visibleLayers.split(","),v.visibleLayers=e.map(x,function(E){return parseInt(E)}))}a.timeChanged&&(0==a.layer.useMapTime?v.timeAnimation=!1:delete v.timeAnimation);a.layer instanceof esri.layers.WMSLayer&&a.popupChanged&&(v.layers=[],e.forEach(a.layer.layerInfos,function(E){var I={name:E.name,title:E.title};E.legendURL&&(I.legendURL=E.legendURL);E.queryable&&(I.queryable=!0,E.showPopup&&(I.showPopup=!0));v.layers.push(I)}));a.layer instanceof esri.layers.WMSLayer&&(a.layer.customParameters?v.customParameters=
a.layer.customParameters:delete v.customParameters,a.layer.customLayerParameters?v.customLayerParameters=a.layer.customLayerParameters:delete v.customLayerParameters);a.layer instanceof esri.layers.WebTiledLayer&&a.layer._wmtsInfo&&(v.wmtsInfo=v.wmtsInfo||{},a.layer._wmtsInfo.customParameters?v.wmtsInfo.customParameters=a.layer._wmtsInfo.customParameters:delete v.wmtsInfo.customParameters,a.layer._wmtsInfo.customLayerParameters?v.wmtsInfo.customLayerParameters=a.layer._wmtsInfo.customLayerParameters:
delete v.wmtsInfo.customLayerParameters);v.visibility=a.layer.visible;v.opacity=a.layer.opacity||0===a.layer.opacity?a.layer.opacity:1;if("esri.layers.RasterXLayer"===a.layer.declaredClass||"esri.layers.ArcGISImageServiceLayer"===a.layer.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.layer.declaredClass)a.renderingRuleChanged&&(a.layer.bandIds?v.bandIds=a.layer.bandIds:delete v.bandIds,a.layer.renderingRule?v.renderingRule=a.layer.renderingRule.toJson():delete v.renderingRule),v.layerType||
("esri.layers.RasterXLayer"===a.layer.declaredClass?v.layerType="ArcGISTiledImageServiceLayer":"esri.layers.ArcGISImageServiceLayer"===a.layer.declaredClass?v.layerType="ArcGISImageServiceLayer":"esri.layers.ArcGISImageServiceVectorLayer"===a.layer.declaredClass&&(v.layerType="ArcGISImageServiceVectorLayer")),a.mosaicRuleChanged&&(a.layer.mosaicRule?"esri.layers.RasterXLayer"===a.layer.declaredClass&&a.layer.mosaicRule.multidimensionalDefinition?(v.multidimensionalDefinition=a.layer.mosaicRule.multidimensionalDefinition.map(function(E){return E.toJson?
E.toJson():E}),delete v.mosaicRule):v.mosaicRule=a.layer.mosaicRule.toJson():delete v.mosaicRule),(x=a.layer.multidimensionalSubset)&&(x.subsetDefinitions||x.areaOfInterest)&&(v.multidimensionalSubset=x),a.rendererChanged&&(a.layer.renderer?(v.layerDefinition=v.layerDefinition||{},v.layerDefinition.drawingInfo=v.layerDefinition.drawingInfo||{},v.layerDefinition.drawingInfo.renderer=a.layer.renderer.toJson()):v.layerDefinition&&v.layerDefinition.drawingInfo&&v.layerDefinition.drawingInfo.renderer&&
delete v.layerDefinition.drawingInfo.renderer,"esri.layers.ArcGISImageServiceVectorLayer"===a.layer.declaredClass&&a.layer.symbolTileSize&&(v.symbolTileSize=a.layer.symbolTileSize)),a.imageQualityChanged&&(a.layer.format?v.format=a.layer.format:delete v.format,a.layer.compressionQuality?v.compressionQuality=a.layer.compressionQuality:delete v.compressionQuality),a.popupInfo&&a.popupChanged?v.popupInfo=a.popupInfo:a.disablePopup&&delete v.popupInfo,a.defExpChanged&&(a.layerDefinition&&esri.isDefined(a.layerDefinition.definitionExpression)?
(v.layerDefinition=v.layerDefinition||{},v.layerDefinition.definitionExpression=a.layerDefinition.definitionExpression,esri.isDefined(a.definitionEditor)&&(v.definitionEditor=a.definitionEditor)):(v.layerDefinition&&v.layerDefinition.definitionExpression&&delete v.layerDefinition.definitionExpression,delete a.layerDefinition.definitionExpression,delete a.definitionEditor)),a.legendChanged&&(!1===a.showLegend?v.showLegend=!1:delete v.showLegend)}w(a,v)}}else{arcgisonline.map.itemData.deletedFSItemSubLayers[a.itemId]=
[];var T=a.url.substring(0,a.url.lastIndexOf("/"));esri.request({url:T+"?f\x3djson"}).then(function(E){var I=[];E.layers&&(e.forEach(E.layers,function(D){I[D.id]={}}),l=e.map(E.layers,function(D){return D.id}));e.forEach(arcgisonline.map.main.mapLayers,function(D){D.itemId===a.itemId&&(D=parseInt(D.layer.url.substring(D.layer.url.lastIndexOf("/")+1)),delete I[D])});if(arcgisonline.isEmpty(I))h();else{E=[];for(subId in I){var F=new e.Deferred;E.push(F);esri.request({url:T+"/"+subId+"?f\x3djson"}).then(e.hitch(this,
function(D,C){arcgisonline.map.itemData.deletedFSItemSubLayers[a.itemId].push({id:C.id,popupInfo:arcgisonline.map.popup.getDefaultPopupInfo(C)});D.callback()},F),e.hitch(this,function(D,C){D.callback()},F))}(new e.DeferredList(E)).addCallback(function(D){h()})}},function(E){h()})}},f=new Date,r="",q=arcgisonline.map.popup.hasFeatureSetMapExpression(a);a.popupInfo&&a.popupChanged&&q&&(r='\x3c/br\x3e\x3c/br\x3e\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\x3cdiv class\x3d"alertIconMsg"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd valign\x3d"top"\x3e'+
esri.i18nBundle.viewer.error.cantSaveItem_PopupArcadeMap+"\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e");var t=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();t.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:a.itemCard.title})+r,reference:"uploadItemLayerInfos"});arcgisonline.map.itemData.getItemLayerInfos(a,e.hitch(this,h),e.hitch(this,h));return b}arcgisonline.map.main.requireAuthentication()},
editFS:function(a,g){var m=new e.Deferred;if(arcgisonline.sharing.util.isLoggedIn()){var n=[];n.push(arcgisonline.map.itemData._editFSItem(a,g));n.push(arcgisonline.map.itemData._editFSService(a,g));a=new e.DeferredList(n);a.addCallback(function(b){m.callback()});a.addErrback(function(b){m.errback()});return m}arcgisonline.map.main.requireAuthentication()},_editFSItem:function(a,g){var m=new e.Deferred,n=function(b,c,d){if(b.layers&&0!==b.layers.length){var l=parseInt(c.url.substring(c.url.lastIndexOf("/")+
1)),h=!1;e.forEach(b.layers,function(f){if(f.id===l){var r=!1;g.addField&&f.popupInfo?r=!0:g.deleteField&&f.popupInfo&&(r=!0);r?(arcgisonline.map.itemData.itemDataContents[c.itemCard.id]=b,f={text:e.json.stringify(b)},r=esriGeowConfig.restBaseUrl+"content/users/"+c.itemCard.owner,r+=c.itemCard.ownerFolder?"/"+c.itemCard.ownerFolder:"",r+="/items/"+c.itemCard.id+"/update",arcgisonline.sharing.util.postJson(f,r).then(function(q){d.callback()},function(q){d.errback()})):d.callback();h=!0}});h||d.callback()}else d.callback()};
arcgisonline.map.itemData.itemDataContents[a.itemCard.id]?n(arcgisonline.map.itemData.itemDataContents[a.itemCard.id],a,m):arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a.itemCard.id+"/data"}).then(function(b){b=b||{};b.layers&&0==b.layers.length&&delete b.layers;arcgisonline.map.itemData.itemDataContents[a.itemCard.id]=b;n(b,a,m)},function(b){arcgisonline.map.itemData.itemDataContents[a.itemCard.itemId]=b;m.errback()});return m},_editFSService:function(a,g){var m=
new e.Deferred,n=function(b,c,d){c.serviceInfo=b;var l={};l.typeIdField=b.typeIdField;l.types=b.types;l.templates=b.templates;var h={f:"json",updateDefinition:e.json.stringify(l)},f=c.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition";arcgisonline.map.itemData.getServerToken(c).then(e.hitch(this,function(r){h.token=r;arcgisonline.sharing.util.postJson(h,f).then(function(q){arcgisonline.map.main.ignoreCache(c);d.callback()},function(q){d.errback()})}),function(){d.errback()})};
a.serviceInfo?n(a.serviceInfo,a,m):arcgisonline.sharing.util.request({url:a.url}).then(function(b,c){a.serviceInfo=b;n(b,a,m)},function(b){m.errback()});return m},updateFeatureService:function(a,g,m){a.layer.renderer.toJson();var n=[];a.layer.types&&e.forEach(a.layer.types,function(q){n.push(q.toJson())});var b=null;a.layer.labelingInfo&&a.showLabels&&(b=e.map(a.layer.labelingInfo,function(q){return q.toJson()}));var c={};if(a.rendererChanged||a.featureTemplatesChanged||a.opacityChanged)c.drawingInfo=
{renderer:a.layer.renderer.toJson()},b&&(c.drawingInfo.labelingInfo=b),c.typeIdField=a.layer.typeIdField,c.types=n,c.templates=a.layer.templates,c.drawingInfo.transparency=100-100*a.layer.opacity;a.scaleChanged&&(b=a.layer.maxScale?a.layer.maxScale:0,c.minScale=a.layer.minScale?a.layer.minScale:0,c.maxScale=1===b?0:b);if(!(a.itemCard&&a.itemCard.typeKeywords&&-1<e.indexOf(a.itemCard.typeKeywords,"View Service"))&&a.popupInfo&&!0===a.serviceInfo.sourceSchemaChangesAllowed){var d=[];e.forEach(a.popupInfo.fieldInfos,
function(q){e.forEach(a.layer.fields,function(t){q.fieldName===t.name&&q.label!==t.alias&&d.push({name:q.fieldName,alias:q.label})})});d.length&&(c.fields=d)}var l={f:"json",updateDefinition:e.json.stringify(c)},h=a.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",f=!1;b="";a.popupInfo&&a.popupChanged&&(f=arcgisonline.map.popup.hasFeatureSetMapExpression(a))&&(b='\x3c/br\x3e\x3c/br\x3e\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\x3cdiv class\x3d"alertIconMsg"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd valign\x3d"top"\x3e'+
esri.i18nBundle.viewer.error.cantSaveItem_PopupArcadeMap+"\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e");var r=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();r.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:a.itemCard.title})+b,reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,function(q){l.token=q;esri.request({url:h,content:l,callbackParamName:"callback",
load:e.hitch(this,function(t){setTimeout(e.hitch(this,function(){r.hide("updateFeatureService")}),1);if(t.success){if(a.rendererChanged||a.featureTemplatesChanged||a.opacityChanged)a.serviceInfo.drawingInfo=c.drawingInfo,a.serviceInfo.typeIdField=c.typeIdField||a.serviceInfo.typeIdField,a.serviceInfo.types=c.types||a.serviceInfo.types,a.serviceInfo.templates=c.templates||a.serviceInfo.templates;arcgisonline.map.main.ignoreCache(a);delete a.featureTemplatesChanged;delete a.opacityChanged;a.layerDefinition&&
(delete a.layerDefinition.drawingInfo,delete a.layerDefinition.minScale,delete a.layerDefinition.maxScale,arcgisonline.isEmpty(a.layerDefinition)&&delete a.layerDefinition,a.layerDefinition&&a.layerDefinition.featureReduction||delete a.rendererChanged);delete a.scaleChanged;arcgisonline.map.main.mapLayers.length&&arcgisonline.map.thumbnail.recreateItemThumbnail(a);arcgisonline.map.itemData.getItemLayerInfos(a,e.hitch(this,function(){var w=null;if(a.origItemLayers)for(var u=parseInt(a.layer.url.substring(a.layer.url.lastIndexOf("/")+
1)),v=0;v<a.origItemLayers.length;v++)if(a.origItemLayers[v].id===u){w=a.origItemLayers[v];break}u=!1;a.itemCard&&"Feature Service"===a.itemCard.type&&(arcgisonline.sharing.util.isHostedService(a.url)||-1<e.indexOf(a.itemCard.typeKeywords,"providerSDS"))&&-1<e.indexOf(a.itemCard.typeKeywords,"webmap_2.1")&&(u=!0);u||w&&w.layerDefinition||a.popupChanged&&!f||a.legendChanged||a.featureReductionChanged||a.layer.labelingInfo&&a.showLabels&&(!w||!w.showLabels)||(!a.layer.labelingInfo||!a.showLabels)&&
w&&w.showLabels?arcgisonline.map.itemData.uploadItemLayerInfos(a,e.hitch(this,function(){g&&g()}),null,m):g&&g()}),e.hitch(this,function(){g&&g()}))}}),error:function(t){r.hide("updateFeatureService");m?m():arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:t.message?"("+t.message+")":""})})}},{usePost:!0,addToken:!0})}),function(q){r.hide("updateFeatureService");
m?m():arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:q&&q.message?"("+q.message+")":""})})})},updateFeatureServiceAfterAddRemoveField:function(a,g,m){var n={};n.types=a.serviceInfo.types;n.templates=a.serviceInfo.templates;if(a.popupInfo){var b=[];e.forEach(a.popupInfo.fieldInfos,function(h){e.forEach(a.layer.fields,function(f){h.fieldName===
f.name&&h.label!==f.alias&&b.push({name:h.fieldName,alias:h.label})})});b.length&&(n.fields=b)}var c={f:"json",updateDefinition:e.json.stringify(n)},d=a.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",l=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();l.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:a.itemCard.title}),reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,
function(h){c.token=h;esri.request({url:d,content:c,callbackParamName:"callback",load:e.hitch(this,function(f){setTimeout(e.hitch(this,function(){l.hide("updateFeatureService")}),1);f.success&&(arcgisonline.map.main.ignoreCache(a),arcgisonline.map.itemData.getItemLayerInfos(a,e.hitch(this,function(){if(a.origItemLayers)for(var r=parseInt(a.layer.url.substring(a.layer.url.lastIndexOf("/")+1)),q=0;q<a.origItemLayers.length&&a.origItemLayers[q].id!==r;q++);r=!1;a.itemCard&&"Feature Service"===a.itemCard.type&&
(arcgisonline.sharing.util.isHostedService(a.url)||-1<e.indexOf(a.itemCard.typeKeywords,"providerSDS"))&&-1<e.indexOf(a.itemCard.typeKeywords,"webmap_2.1")&&(r=!0);r||a.popupChanged?arcgisonline.map.itemData.uploadItemLayerInfos(a,e.hitch(this,function(){g&&g()}),null,m):g&&g()}),e.hitch(this,function(){g&&g()})))}),error:function(f){l.hide("updateFeatureService");m?m():arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:f.message?"("+f.message+")":""})})}},{usePost:!0,addToken:!0})}),function(h){l.hide("updateFeatureService");m?m():arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:h.message?"("+h.message+")":""})})})},updateServiceDefinitionWithFilter:function(a,
g){var m={};a.serviceInfo.isView?m.viewDefinitionQuery=g:m.definitionQuery=g;var n={f:"json",updateDefinition:e.json.stringify(m)},b=a.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",c=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();c.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:a.itemCard.title}),reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,
function(d){n.token=d;esri.request({url:b,content:n,callbackParamName:"callback",load:e.hitch(this,function(l){setTimeout(e.hitch(this,function(){c.hide("updateFeatureService")}),1);l.success&&(arcgisonline.map.main.ignoreCache(a),a.serviceInfo.isView?a.serviceInfo.viewDefinitionQuery=g:a.serviceInfo.definitionQuery=g,a.layer.defaultDefinitionExpression=g,a.layer.clearSelection(),a.layer.refresh(),a.layer.statisticsPlugin&&a.layer.statisticsPlugin.clearFeaturesCache(),arcgisonline.map.thumbnail.recreateItemThumbnail(a))}),
error:function(l){c.hide("updateFeatureService");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:l.message?"("+l.message+")":""})})}},{usePost:!0,addToken:!0})}),function(d){c.hide("updateFeatureService");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:d.message?"("+d.message+")":""})})})},updateServiceFields:function(a,g,m){var n=[],b=[];e.forEach(g,function(r){n.push({name:r.name,visible:!1===r.visible?!1:!0});!1!==r.visible&&b.push(r)});var c={fields:n};if(m){var d=a.url.substring(a.url.lastIndexOf("/")+1);-1<d.indexOf("?")&&(d=d.substring(0,d.indexOf("?")));d=parseInt(d);c.layers=[{adminLayerInfo:{viewLayerDefinition:{sourceServiceName:a.serviceInfo.name,
sourceLayerId:d,sourceLayerFields:"*"}}}]}var l={f:"json",updateDefinition:e.json.stringify(c)},h=a.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",f=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();f.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:a.itemCard.title}),reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,function(r){l.token=
r;esri.request({url:h,content:l,callbackParamName:"callback",load:e.hitch(this,function(q){setTimeout(e.hitch(this,function(){f.hide("updateFeatureService")}),1);if(q.success){arcgisonline.map.main.ignoreCache(a);q=a.layer.fields=[];for(i=0;i<b.length;i++)q.push(new esri.layers.Field(b[i]));a.serviceInfo.fields=b;a.serviceInfo.adminFields=g;a.layer.clearSelection();a.layer.refresh();a.layer.statisticsPlugin&&a.layer.statisticsPlugin.clearFeaturesCache();arcgisonline.map.itemData.updatePopupAfterFieldDefinitionChange(a);
m&&(delete a.serviceInfo.adminFields,arcgisonline.map.main.openFieldsDlg(a))}}),error:function(q){f.hide("updateFeatureService");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:q.message?"("+q.message+")":""})})}},{usePost:!0,addToken:!0})}),function(r){f.hide("updateFeatureService");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:r.message?"("+r.message+")":""})})})},updateServiceAreaOfInterest:function(a,g,m,n){var b=new e.Deferred;g?(g="polygon"===g.type?{geometryType:"esriGeometryPolygon",geometry:g.toJson()}:{geometryType:"esriGeometryEnvelope",geometry:g.toJson()},g={viewLayerDefinition:{filter:{operator:"esriSpatialRelIntersects",value:g}}}):g={viewLayerDefinition:{filter:null}};var c={f:"json",updateDefinition:e.json.stringify(g)},
d=a.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",l=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();l.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:a.itemCard.title}),reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,function(h){c.token=h;esri.request({url:d,content:c,callbackParamName:"callback",load:e.hitch(this,function(f){if(f.success)if(arcgisonline.map.main.ignoreCache(a),
m&&n){var r=d.indexOf("/updateDefinition"),q=d.substring(0,r).lastIndexOf("/"),t=parseInt(d.substring(q+1,r));if(arcgisonline.sharing.util.isPortal()){var w=function(v,x,z,A){var B=n.layers[v];B.id!==A?(r=x.indexOf("/updateDefinition"),x=x.substring(0,q+1)+B.id+x.substring(r),esri.request({url:x,content:z,callbackParamName:"callback",load:e.hitch(this,function(J){v<n.layers.length-1?w(v+1,x,z,A):(setTimeout(e.hitch(this,function(){l.hide("updateFeatureService")}),1),b.resolve())}),error:e.hitch(this,
function(J){v<n.layers.length-1?w(v+1,x,z,A):(setTimeout(e.hitch(this,function(){l.hide("updateFeatureService")}),1),b.resolve())})},{usePost:!0})):v<n.layers.length-1?w(v+1,x,z,A):(setTimeout(e.hitch(this,function(){l.hide("updateFeatureService")}),1),b.resolve())};w(0,d,c,t)}else{var u=[];e.forEach(n.layers,function(v){v.id!==t&&(r=d.indexOf("/updateDefinition"),d=d.substring(0,q+1)+v.id+d.substring(r),u.push(esri.request({url:d,content:c,callbackParamName:"callback"},{usePost:!0})))});u.length?
(new e.DeferredList(u)).addCallback(function(v){setTimeout(e.hitch(this,function(){l.hide("updateFeatureService")}),1);b.resolve()}):(setTimeout(e.hitch(this,function(){l.hide("updateFeatureService")}),1),b.resolve())}}else setTimeout(e.hitch(this,function(){l.hide("updateFeatureService")}),1),b.resolve();else setTimeout(e.hitch(this,function(){l.hide("updateFeatureService")}),1),b.reject()}),error:function(f){l.hide("updateFeatureService");b.reject();arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:f.message?"("+f.message+")":""})})}},{usePost:!0,addToken:!0})}),function(h){l.hide("updateFeatureService");b.reject();arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:h.message?"("+h.message+")":""})})});return b},updatePopupAfterFieldDefinitionChange:function(a){if(a.popupInfo&&
a.popupInfo.fieldInfos){var g=a.popupInfo.fieldInfos,m=[],n=arcgisonline.map.popup.getDefaultPopupInfo(a.serviceInfo,a.layer.isEditable(),a.layer);e.forEach(n.fieldInfos,function(b){var c;e.forEach(g,function(d){d.fieldName===b.fieldName&&(c=d)});c?m.push(c):m.push(b)});e.forEach(g,function(b){(b.fieldName.startsWith("relationships/")||b.fieldName.startsWith("expression/")||b.fieldName.startsWith("Raster."))&&m.push(b)});e.json.stringify(a.popupInfo.fieldInfos)!==e.json.stringify(m)&&(a.popupInfo.fieldInfos=
m,arcgisonline.map.mapUtil.setInfoTemplate(a.layer,a.popupInfo),a.popupChanged=!0,a.origItemLayers&&(n=function(){for(var b=arcgisonline.map.itemData.itemDataContents[a.itemId]||{},c=parseInt(a.layer.url.substring(a.layer.url.lastIndexOf("/")+1)),d=null,l=0;l<a.origItemLayers.length;l++)if(a.origItemLayers[l].id===c){d=a.origItemLayers[l];break}d&&(d.popupInfo=a.popupInfo,c={layers:a.origItemLayers},delete b.layers,c=e.mixin(b,c),b={text:e.json.stringify(c)},arcgisonline.sharing.util.getUser(),c=
esriGeowConfig.restBaseUrl+"content/users/"+a.itemCard.owner,c+=a.itemCard.ownerFolder?"/"+a.itemCard.ownerFolder:"",c+="/items/"+a.itemCard.id+"/update",arcgisonline.sharing.util.postJson(b,c,e.hitch(this,function(){delete a.popupChanged})))},arcgisonline.map.itemData.getItemLayerInfos(a,e.hitch(this,n),e.hitch(this,n))))}},getRelatedTSForFS:function(a){var g=new e.Deferred;if(!a.itemId)return g.errback(),g;if(a.relatedTileLayerItems)return g.callback(a.relatedTileLayerItems.length?a.relatedTileLayerItems:
null),g;if(!a.itemCard)if(arcgisonline.map.save_open.itemCards[a.itemId])a.itemCard=arcgisonline.map.save_open.itemCards[a.itemId];else return arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a.itemId,e.hitch(this,function(n,b){arcgisonline.map.save_open.itemCards[b.id]=b;n.itemCard=b;g=arcgisonline.map.itemData.getRelatedTSForFS(n)},a),function(){g.errback()}),g;var m;-1<e.indexOf(a.itemCard.typeKeywords,"View Service")?m=esriGeowConfig.restBaseUrl+"content/items/"+a.itemId+
"/relatedItems?relationshipType\x3dService2Service\x26direction\x3dforward":-1<e.indexOf(a.itemCard.typeKeywords,"Hosted Service")&&(m=esriGeowConfig.restBaseUrl+"content/items/"+a.itemId+"/relatedItems?relationshipType\x3dService2Data\x26direction\x3dreverse");arcgisonline.sharing.util.getJson(m,e.hitch(this,function(n){if(n&&n.total){var b=null;e.forEach(n.relatedItems,function(c){"Map Service"===c.type&&(b=b||[],b.push(c))});a.relatedTileLayerItems=b||[];g.callback(b)}else a.relatedTileLayerItems=
[],g.callback(null)}),e.hitch(this,function(){g.errback()}));return g},renameTiledSublayer:function(a,g,m){var n={f:"json",layerDefinition:e.toJson({name:m})},b=a.layer.url.replace("/rest/services","/rest/admin/services")+"/"+g+"/edit",c=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();c.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:a.itemCard.title}),reference:"renameTiledSublayer"});arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,
function(d){n.token=d;esri.request({url:b,content:n,callbackParamName:"callback",load:e.hitch(this,function(l){setTimeout(e.hitch(this,function(){c.hide("renameTiledSublayer")}),1);l.success&&(a.layer.layerInfos[g].name=m,e.publish("onLayerUpdate",["reopen"]),leftPanel&&leftPanel.deleteLegendStack())}),error:function(l){c.hide("renameTiledSublayer");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,
{msg:l.message?"("+l.message+")":""})})}},{usePost:!0,addToken:!0})}),function(d){c.hide("renameTiledSublayer");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:d.message?"("+d.message+")":""})})})},getServerToken:function(a,g){var m=g||a.url;g=m.toLowerCase().indexOf("/featureserver");-1<g&&(m=m.substring(0,g+14));var n=new e.Deferred;
if(m)if(a&&a.serverToken)n.resolve(a.serverToken);else if(arcgisonline.map.main.serverTokens=arcgisonline.map.main.serverTokens||[],arcgisonline.map.main.serverTokens[m]){var b=function(c){var d=arcgisonline.map.main.serverTokens[m];"failed"===d?c.reject():"inProgress"===d?setTimeout(e.hitch(this,function(){b(c)}),1E3):(a&&(a.serverToken=d.token),c.resolve(d.token))};b(n)}else arcgisonline.map.main.serverTokens[m]="inProgress",esri.request({url:esriGeowConfig.restBaseUrl.replace("http:","https:")+
"generateToken",content:{f:"json",serverUrl:m,token:arcgisonline.sharing.util.getToken()}},{usePost:!0}).then(e.hitch(this,function(c){arcgisonline.map.main.serverTokens[m]=c;a&&(a.serverToken=c.token);n.resolve(c.token)}),e.hitch(this,function(){arcgisonline.map.main.serverTokens[m]="failed";n.reject()}));else n.reject();return n},createDefaultOrigItemLayers:function(a){var g=new e.Deferred;if(a.layer&&a.layer.url&&"esri.layers.FeatureLayer"===a.layer.declaredClass&&!a.origItemLayers&&a.itemId){var m=
a.layer.url.substring(0,a.layer.url.lastIndexOf("/"))+"/layers";esri.request({url:m,content:{f:"json"},callbackParamName:"callback",load:function(n){a.origItemLayers=[];e.forEach(n.layers,function(b){a.origItemLayers.push({id:b.id,popupInfo:arcgisonline.map.popup.getDefaultPopupInfo(b)})});g.resolve()},error:function(){g.resolve()}})}else g.resolve();return g}}})},"arcgisonline/map/main":function(){define(["dojo","dijit","dojox"],function(e,K,p){function a(b,c,d){if(b.removeEventListener)return b.removeEventListener(c,
d,!1);if(b.detachEvent)return b.detachEvent("on"+c,d)}function g(b,c){for(c=c.parentNode;null!=c;){if(c==b)return!0;c=c.parentNode}return!1}e.provide("arcgisonline.map.main");String.prototype.startsWith=function(b){return 0==this.indexOf(b)};String.prototype.endsWith=function(b){return this.substring(this.length-b.length)===b};String.prototype.count=function(b){return this.split(b).length-1};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,
"")});arcgisonline.isEmpty=function(b){return b?e.json.stringify(b)===e.json.stringify({}):!1};var m=function(b){b.preventDefault();var c=e.hasClass(this,"is-active");e.query(".dropdown").removeClass("is-active");if(!c){e.addClass(this,"is-active");e.stopEvent(b);b={btn:b.target||b.srcElement,dropdown:this};arcgisonline.map.main.dropdownHandlers&&e.forEach(arcgisonline.map.main.dropdownHandlers,function(l){e.disconnect(l);l=null});arcgisonline.map.main.dropdownHandlers=[];arcgisonline.map.main.dropdownHandlers.push(e.connect(document.body,
"click",e.hitch(b,n)));c="click";e.has("esri-touch")&&!e.has("ff")&&(c="touchstart",arcgisonline.map.main.map&&arcgisonline.map.main.dropdownHandlers.push(e.connect(arcgisonline.map.main.map.container,c,e.hitch(b,n))));var d=e.query(".esriSimpleSliderIncrementButton");d&&d.length&&arcgisonline.map.main.dropdownHandlers.push(e.connect(d[0],c,e.hitch(b,n)));(d=e.query(".esriSimpleSliderDecrementButton"))&&d.length&&arcgisonline.map.main.dropdownHandlers.push(e.connect(d[0],c,e.hitch(b,n)))}},n=function(b){var c=
e.query(".dropdown-menu",this.dropdown)[0];g(c,b.target||b.srcElement)||(e.removeClass(this.dropdown,"is-active"),a(document.body,"click",n),(b=e.query(".esriSimpleSliderIncrementButton"))&&b.length&&a(b[0],"click",n),(b=e.query(".esriSimpleSliderDecrementButton"))&&b.length&&a(b[0],"click",n),arcgisonline.map.main.dropdownHandlers&&e.forEach(arcgisonline.map.main.dropdownHandlers,function(d){e.disconnect(d);d=null}),arcgisonline.map.main.dropdownHandlers=[])};arcgisonline.map.main={defaultBaseLayer:null,
defaultBaseLayerMapLods:null,scaleBarUnits:"metric",mapLods:null,baseTilingSchemeScales:"",selfCallResult:null,map:null,overviewMap:null,scalebar:null,measureTool:null,measureActivated:!1,bookmarksTool:null,homeButton:null,locateButton:null,defaultExtent:null,initialExtent:null,lastExtent:null,defaultService:null,currentBaseService:"",isUserBaseService:!1,allLegendInfos:[],basemapTitle:"",queryLimitExceededLayers:[],mapLayers:[],mapTables:[],geometryService:null,mapInitialized:!1,startup:!0,isMapFullyLoaded:!1,
mapHasChanged:!1,mapFullyLoadedTimer:null,noDataDisplayTimer:null,analysisProps:{},esriIdCredential:null,init:function(b){arcgisonline.map.embedded.doEmbeddedCheck(b).then(function(c){if(c){if(!esri.isTouchEnabled&&(e.has("edge")||4<e.has("trident")))var d=e.connect(document,"touchstart",function(){esri.isTouchEnabled||(esri.isTouchEnabled=!0,e.disconnect(d),e.disconnect(l),e.disconnect(h),"contentStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&e.publish("onLayerUpdate",[""]))}),l=
document.addEventListener("MSPointerDown",function(r){"touch"!==r.pointerType||esri.isTouchEnabled||(esri.isTouchEnabled=!0,e.disconnect(d),e.disconnect(l),e.disconnect(h),"contentStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&e.publish("onLayerUpdate",[""]))}),h=document.addEventListener("pointerdown",function(r){"touch"!==r.pointerType||esri.isTouchEnabled||(esri.isTouchEnabled=!0,e.disconnect(d),e.disconnect(l),e.disconnect(h),"contentStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&
e.publish("onLayerUpdate",[""]))});esri.arcgis.utils.arcgisUrl=esriGeowConfig.restBaseUrl+"content/items";arcgisonline.sharing.geow.Account.loadMapSettings(e.hitch(this,arcgisonline.map.main.initMapProperties));e.query("#home-navigation-dropdown-link").onclick(e.hitch(e.byId("home-navigation-dropdown"),m));e.query("#webmap-recentMaps").onclick(e.hitch(e.byId("recentMaps-navigation"),m));e.query("#logged-in-navigation-link").onclick(e.hitch(e.byId("logged-in-navigation"),m));9>e.isIE&&e.style(e.byId("locationDiv"),
"right","8px");e.byId("headerBanner")&&(c=e.coords(e.byId("headerBanner")),0<c.h&&e.style(e.query(".header-map-home")[0],"marginTop",c.h+"px"));arcgisonline.map.table.hideAttributeTable();e.connect(K.byId("leftContentPanel"),"resize",arcgisonline.map.leftPanel,"checkLeftPanelButtonLabels");arcgisonline.map.main.dojoPatch();9>e.isIE&&e.style(e.byId("locationDiv"),"right","8px");if(navigator.userAgent.match(/iPad;.*CPU.*OS 7_\d/i)&&window.innerHeight!=document.documentElement.clientHeight){var f=function(){e.style(document.getElementById("page-border"),
"height",window.innerHeight+"px");K.byId("page-border").resize();0===document.body.scrollTop&&0===document.body.scrollLeft||window.scrollTo(0,0)};setTimeout(function(){f()},1);window.addEventListener("orientationchange",f,!1)}e.subscribe("onUTCOffsetChange",e.hitch(arcgisonline.map.main,"onUTCOffsetChange"))}})},initMapProperties:function(b){arcgisonline.map.main.selfCallResult=b;esriGeowConfig.userInfo=b.user;esriGeowConfig.userInfo&&(esriGeowConfig.userInfo.credential=arcgisonline.map.main.esriIdCredential,
esriGeowConfig.userInfo.token=arcgisonline.map.main.esriIdCredential.token);arcgisonline.map.vectorTile.checkFallBackVectorTileLayers().then(function(c){c=c.baseMap;var d=c.baseMapLayers[0];(esriGeowConfig.allSSL||"https:"==location.protocol)&&d.url&&(arcgisonline.sharing.util.isHostedService(d.url)||arcgisonline.sharing.util.supportsHttps(d.url))&&(d.url=d.url.replace("http:","https:"),d.resourceInfo&&d.resourceInfo.tileServers&&d.resourceInfo.tileServers.length&&e.forEach(d.resourceInfo.tileServers,
function(q,t){if(arcgisonline.sharing.util.isHostedService(q)||arcgisonline.sharing.util.supportsHttps(q))d.resourceInfo.tileServers[t]=q.replace("http:","https:")}));arcgisonline.map.main.basemapTitle=c.title;arcgisonline.map.main.defaultBaseLayer={layer:null,layers:d.layers,id:d.id||"defaultBasemap",type:"base",title:d.title||arcgisonline.map.main.getSpecialTitle(d)||c.title,itemId:d.itemId,url:d.url?d.url:null,templateUrl:d.templateUrl?d.templateUrl:null,styleUrl:d.styleUrl,identify:!1,serviceInfo:d.resourceInfo,
copyright:d.copyright,fullExtent:d.fullExtent instanceof esri.geometry.Extent?d.fullExtent:d.fullExtent?esri.geometry.Extent(d.fullExtent):null,subDomains:d.subDomains,tileInfo:d.tileInfo?esri.layers.TileInfo(d.tileInfo):null,tileServers:d.tileServers,wmtsInfo:d.wmtsInfo,refreshInterval:d.refreshInterval};arcgisonline.map.main.defaultBaseLayer.url||(arcgisonline.map.main.defaultBaseLayer._layerType=c.baseMapLayers[0].type||c.baseMapLayers[0].layerType);if(d.resourceInfo&&d.resourceInfo.tileInfo)arcgisonline.map.main.defaultBaseLayerMapLods=
d.resourceInfo.tileInfo.lods;else if("WMS"==d.type||"WMS"==d.layerType)arcgisonline.map.main.defaultBaseLayer=e.mixin(arcgisonline.map.main.defaultBaseLayer,{_layerType:"WMS",extent:esri.geometry.Extent(d.extent),layers:d.layers,mapUrl:d.mapUrl,maxHeight:d.maxHeight,maxWidth:d.maxWidth,opacity:d.opacity,spatialReferences:d.spatialReferences,version:d.version,visibility:d.visibility,visibleLayers:d.visibleLayers.toString()});else if("OpenStreetMap"==d.type||"OpenStreetMap"==d.layerType)c=new esri.layers.OpenStreetMapLayer,
arcgisonline.map.main.defaultBaseLayerMapLods=c.tileInfo.lods;else if(d.type&&-1<d.type.indexOf("BingMaps")||d.layerType&&-1<d.layerType.indexOf("BingMaps")){if(!esriGeowConfig.self.bingKey){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.error.basemapTitleNotAvailable2,{title:c.title})});return}arcgisonline.map.main.defaultBaseLayer.bingKey=esriGeowConfig.self.bingKey;
c=new esri.virtualearth.VETiledLayer({bingMapsKey:esriGeowConfig.self.bingKey,mapStyle:esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL});arcgisonline.map.main.defaultBaseLayerMapLods=c.tileInfo.lods}e.connect(document,"onkeypress",e.hitch(arcgisonline.map.main,"onKeyPress"));c=arcgisonline.map.main.buildNewMapViewerUrl();e.byId("webmap-openNewViewer").href=c;e.connect(e.byId("webmap-openNewViewer"),"onclick",e.hitch(arcgisonline.map.main,"openNewMapViewer"));e.connect(e.byId("webmap-newMap"),"onclick",
e.hitch(arcgisonline.map.main,"openNewMap"));e.connect(e.byId("webmap-modifyMap"),"onclick",e.hitch(arcgisonline.map.role,"updateUserActionAfterModify"));e.connect(e.byId("webmap-details"),"onclick",e.hitch(arcgisonline.map.leftPanel,"openLeftDetailsPanel"));e.connect(e.byId("webmap-basemap"),"onclick",e.hitch(arcgisonline.map.main,"showBasemapGallery"));arcgisonline.map.main.isReadOnlyMode()||e.connect(e.byId("webmap-edit"),"onclick",e.hitch(arcgisonline.map.leftPanel,"openLeftEditPanel"));esriGeowConfig.showAnalysisHistory&&
!arcgisonline.map.main.isReadOnlyMode()?(e.connect(K.byId("webmap-analysis-analysis"),"onClick",e.hitch(this,function(q){arcgisonline.map.dijit.toc.analysis.configureAnalysis(q,{isMenu:!0})})),e.connect(K.byId("webmap-analysis-history"),"onClick",e.hitch(this,function(q){arcgisonline.map.dijit.toc.analysis.configureAnalysisHistory(q,{isMenu:!0})}))):(K.byId("webmap-analysis").destroy(),c=e.create("div",{id:"webmap-analysis"}),e.place(c,e.byId("webmap-spacer2"),"after"),new K.form.ToggleButton({iconClass:"menuIconPerformAnalysis",
style:"margin-top:2px;"},c),arcgisonline.map.main.isReadOnlyMode()||e.connect(e.byId("webmap-analysis"),"onclick",e.hitch(this,function(q){"analysisStack"==arcgisonline.map.leftPanel.getLeftContentPanelStack()||"toolStack"==arcgisonline.map.leftPanel.getLeftContentPanelStack()?arcgisonline.map.leftPanel.openLeftTOCPanel():arcgisonline.map.dijit.toc.analysis.configureAnalysis(q,{isMenu:!0})})));arcgisonline.map.main.isReadOnlyMode()||(e.connect(e.byId("webmap-share"),"onclick",e.hitch(arcgisonline.map.main,
"linkToMap",!1)),e.connect(e.byId("webmap-directions"),"onclick",e.hitch(arcgisonline.map.leftPanel,"openLeftDirectionsPanel")));e.connect(e.byId("webmap-measure"),"onclick",e.hitch(arcgisonline.map.main,"showMeasureTool"));e.connect(e.byId("webmap-bookmarks"),"onclick",e.hitch(arcgisonline.map.main,"showBookmarksTool"));if(esriGeowConfig.self.helperServices.printTask.templates&&1<esriGeowConfig.self.helperServices.printTask.templates.length){var l=K.byId("webmap-print-templates-menu");e.forEach(esriGeowConfig.self.helperServices.printTask.templates,
function(q){q=new K.MenuItem({label:q.label,onClick:e.hitch(arcgisonline.map.print,"printMap",q)});l.addChild(q)})}else l=K.byId("webmap-print-templates-menu"),c=new K.MenuItem({label:esri.i18nBundle.viewer.map,onClick:e.hitch(arcgisonline.map.print,"printMap",esriGeowConfig.self.helperServices.printTask.templates&&esriGeowConfig.self.helperServices.printTask.templates[0]||null,!1)}),l.addChild(c),c=new K.MenuItem({label:esri.i18nBundle.viewer.mapWithLegend,onClick:e.hitch(arcgisonline.map.print,
"printMap",esriGeowConfig.self.helperServices.printTask.templates&&esriGeowConfig.self.helperServices.printTask.templates[0]||null,!0)}),l.addChild(c);e.style(K.byId("webmap-print-templates").domNode,"display","");e.style(K.byId("webmap-print").domNode,"display","none");arcgisonline.map.main.checkReadOnly();arcgisonline.map.embedded.adjustUIForEmbedded();e.subscribe("onLayerVisibilityChange",e.hitch(arcgisonline.map.main,"onLayerVisibilityChange"));e.subscribe("onDefExprChanged",e.hitch(arcgisonline.map.main,
"markMapAsChanged","onFilterApply"));e.subscribe("onServiceDefExprChanged",e.hitch(arcgisonline.map.itemData,"updateServiceDefinitionWithFilter"));e.subscribe("onServiceFieldsChanged",e.hitch(arcgisonline.map.itemData,"updateServiceFields"));arcgisonline.map.role.setupUserActions();arcgisonline.map.main.updateHeaderLinks();esriGeowConfig.self.helperServices&&esriGeowConfig.self.helperServices.geometry&&esriGeowConfig.self.helperServices.geometry.url?esri.config.defaults.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url):
console.err("No Geometry Service defined.",esriGeowConfig.self);esri.config.defaults.kmlService=esriGeowConfig.kmlService;esri.config.defaults.geoRSSService=esriGeowConfig.geoRSSService;esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;esri.isDefined(esriGeowConfig.isMultiTenant)&&!1===esriGeowConfig.isMultiTenant?(esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getHttpUrl(location.host).replace(/:80$/,"")),esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getSecureUrl(location.host).replace(/:443$/,
""))):(esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getHttpUrl(location.host)),esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getSecureUrl(location.host)));esriGeowConfig.self.authorizedCrossOriginDomains&&esriGeowConfig.self.authorizedCrossOriginDomains.length&&e.forEach(esriGeowConfig.self.authorizedCrossOriginDomains,function(q){esri.config.defaults.io.corsEnabledServers.push({host:q,withCredentials:!0})});c=arcgisonline.sharing.util.getUser();
arcgisonline.map.main.scaleBarUnits="metric";if(esriGeowConfig.self.user&&esriGeowConfig.self.user.units)arcgisonline.map.main.scaleBarUnits=esriGeowConfig.self.user.units;else if(esriGeowConfig.self.units)arcgisonline.map.main.scaleBarUnits=esriGeowConfig.self.units;else if(c&&c.region&&"US"===c.region||c&&!c.region&&"US"===esriGeowConfig.self.region||c&&!c.region&&!esriGeowConfig.self.region||!c&&"US"===esriGeowConfig.self.ipCntryCode||!c&&!esriGeowConfig.self.ipCntryCode&&"en-us"===e.locale)arcgisonline.map.main.scaleBarUnits=
"english";c&&c.accountId||(arcgisonline.map.main.appAccess=!0);e.config.deferredOnError=function(q,t){};e.mixin(esri.symbol.defaultSimpleMarkerSymbol,{style:"circle",color:[0,0,0,1],outline:null,size:4,angle:0,xoffset:0,yoffset:0});var h=esri.dijit.Popup.prototype._zoomToFeature;esri.dijit.Popup.prototype._zoomToFeature=function(){var q=this.getSelectedFeature(),t=q.getLayer();if(t&&t.__isFootprintLayer&&q.attributes.xmin&&q.attributes.ymin&&q.attributes.xmax&&q.attributes.ymax)q=new esri.geometry.Extent(q.attributes.xmin,
q.attributes.ymin,q.attributes.xmax,q.attributes.ymax,t.fullExtent.spatialReference),arcgisonline.map.main.map.setExtent(q,!0);else return h.apply(this,arguments)};c=arcgisonline.sharing.util.getUser();arcgisonline.map.main.loggedIn();arcgisonline.map.leftPanel.initSettings();c=arcgisonline.sharing.util.urlToObject(document.URL);c.query=c.query||{};c.query.folder&&(arcgisonline.map.save_open.folderId=c.query.folder,arcgisonline.map.save_open.folderTitle="dummy");c.query.useExisting||arcgisonline.map.storage.deleteMapCookie();
if(c.query.useExisting)arcgisonline.map.storage.openWebMapFromCookie();else if(c.query.webmap)arcgisonline.map.save_open.openWebMapItemCard(c.query.webmap);else if(c.query.basemapUrl){var f=arcgisonline.map.main.decodeUrl(c.query.basemapUrl),r=arcgisonline.map.main.getTitleFromUrl(f);arcgisonline.map.main.basemapTitle=r;-1<c.query.basemapUrl.indexOf("/VectorTileServer")?(-1===f.indexOf("root.json")&&(f+=(f.endsWith("/")?"":"/")+"resources/styles/root.json"),arcgisonline.map.vectorTile.addVectorTileAsBaseLayer({id:"VectorTile_"+
Math.floor(10001*Math.random()),type:"VectorTileLayer",layerType:"VectorTileLayer",title:r,styleUrl:f},null,e.hitch(this,function(){arcgisonline.map.layer.loadMoreLayers()}))):arcgisonline.map.layer.addUserBaseLayer({url:f})}else arcgisonline.map.layer.addDefaultBaseLayers();window.onresize=9>e.isIE?function(){K.byId("page-border").resize();arcgisonline.map.main.checkTitleDiv();arcgisonline.map.main.checkMinWidthOfPage()}:function(){arcgisonline.map.main.checkTitleDiv();arcgisonline.map.main.checkMinWidthOfPage()}})},
updateHeaderLinks:function(){var b=esriGeowConfig.baseUrl,c=esriGeowConfig.self,d=arcgisonline.sharing.util.getUser();arcgisonline.sharing.util.isPortal()&&"7443"===location.port&&(b=arcgisonline.sharing.util.getSecureUrl(b));arcgisonline.sharing.util.isPortal()||(d&&(e.attr(e.byId("accountSwitcher-link"),"innerHTML",esri.i18nBundle.siteHeader.switchAccounts+"\x26nbsp;\x26nbsp;"),e.query("#accountSwitcher-link").removeClass("hide"),e.connect(e.byId("accountSwitcher-link"),"onclick",e.hitch(this,function(q){q.preventDefault();
window.open("https://"+window.location.host+"/home/pages/Account/manage_accounts.html#client_id\x3darcgisonline")}))),esriGeowConfig.self&&esriGeowConfig.self.subscriptionInfo&&("Trial"===esriGeowConfig.self.subscriptionInfo.type||"Trial Press"===esriGeowConfig.self.subscriptionInfo.type)&&(e.attr(e.byId("trial-download-link"),"innerHTML",esri.i18nBundle.siteHeader.trialDownload+"\x26nbsp;\x26nbsp;"),e.query("#trial-download-link").removeClass("hide"),e.connect(e.byId("trial-download-link"),"onclick",
e.hitch(this,function(q){q.preventDefault();q=(esriGeowConfig.self&&esriGeowConfig.self.user&&esriGeowConfig.self.user.culture||esriGeowConfig.self&&esriGeowConfig.self.culture||dojoConfig.locale||"en").toLowerCase();q=esriGeowConfig.learnArcGIS+"/"+(q in{"pt-br":1,"pt-pt":1,"zh-cn":1}?q:q.split("-")[0].toLowerCase())+"/trial";window.open(q)}))));e.attr(e.byId("home-navigation-dropdown-link"),"innerHTML",'\x3cdiv id\x3d"site_logo"\x3eArc\x3cspan\x3eGIS\x3c/span\x3e\x3c/div\x3e');e.addClass(e.byId("home-navigation-dropdown-link"),
"site_logo");var l=esriGeowConfig.self&&esriGeowConfig.self.portalProperties&&esriGeowConfig.self.portalProperties.topNav||{},h=esriGeowConfig.self&&d&&d.accountId&&d.accountId===esriGeowConfig.self.id,f=c.helpBase+(c.isPortal&&"ArcGISEnterpriseOnKubernetes"!==c.portalDeploymentType?esriGeowConfig.helpMap["120001577"]||"":"");e.query(".homeHelp").attr("href",f);e.query(".homeHelp",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();window.open(f,"_blank")}));e.query(".homeScene",
this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();window.location="../webscene/viewer.html"}));var r=l.scene;(!r||"all"===r||"members"===r&&h||"sceneCreators"===r&&h&&esriGeowConfig.userRole&&esriGeowConfig.userRole.canCreateItem())&&e.query(".homeScene",this.domNode).removeClass("hide");d?(e.query("#profileLink",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"user.html")})),e.query(".loggedInSignout",this.domNode).connect("onclick",
e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.logOut()})),e.query(".homeHome",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"index.html")})),e.query(".homeHome",this.domNode).removeClass("hide"),arcgisonline.map.role.isAllowed("header_myContent")&&(e.query(".homeMyContent",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"content.html")})),e.query(".homeMyContent",
this.domNode).removeClass("hide")),e.query(".homeGroups",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"groups.html")})),r=l.groups,(!r||"all"===r||"members"===r&&h)&&e.query(".homeGroups",this.domNode).removeClass("hide"),r=l.notebook||"members",arcgisonline.pages.utils.notebook.notebookServerConfigured()&&("members"===r&&h||"notebookCreators"===r&&h&&esriGeowConfig.userRole&&esriGeowConfig.userRole.canCreateNotebooks())&&e.query(".homeNotebook",
this.domNode).removeClass("hide"),arcgisonline.sharing.util.isPortal()?e.query(".loggedInHelp",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.openHelp()})):e.query(".loggedInHelp",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();window.open(c.helpBase,"_blank")})),e.style(e.query(".homeHelp",this.domNode)[0],"display","none"),d.accountId?(e.attr(e.byId("home-navigation-dropdown-link"),"innerHTML",esri.i18nBundle.siteHeader.simpleHome),
e.query("#home-navigation-dropdown-link").removeClass("site_logo top-nav-title").addClass("top-nav-link"),e.query(".homeGallery",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"gallery.html")})),l=l.gallery,"noOne"!==l&&(!l||"all"===l||"members"===l&&h)&&e.query(".homeGallery",this.domNode).removeClass("hide"),e.query(".homeMyOrg",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+
"organization.html")})),arcgisonline.sharing.util.isPortal()&&esriGeowConfig.restrictOrganizationPageToAdmin&&(!esriGeowConfig.userRole||esriGeowConfig.userRole&&!esriGeowConfig.userRole.isAdmin())?e.query(".homeMyOrg",this.domNode).addClass("hide"):e.query(".homeMyOrg",this.domNode).removeClass("hide")):(e.query("#home-navigation-dropdown-link").removeClass("top-nav-link").addClass("top-nav-title site_logo"),e.query(".homeOverview",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();
arcgisonline.map.main.goToPage(b+"../features/features.html")})),e.query(".homeOverview").removeClass("hide"),e.query(".homePricing",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"../features/plans/pricing.html")})),e.query(".homePricing").removeClass("hide")),h=e.byId("my-settings"),h.classList.remove("hide"),h.innerHTML='\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.mySettings,
e.connect(h,"onclick",e.hitch(this,function(q){q.preventDefault();window.open(esriGeowConfig.baseUrl+"user.html#settings","_blank")})),!arcgisonline.sharing.util.isPortal()&&d&&"both"===d.userType&&(e.query("#training-link").removeClass("hide"),e.attr(e.byId("training-link"),"innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.training),e.connect(e.byId("training-link"),"onclick",e.hitch(this,function(q){q.preventDefault();
q={administrator:"//www.esri.com/training/main/arcgis-online-administrators",publisher:"//www.esri.com/training/main/arcgis-online-publishers",user:"//www.esri.com/training/main/arcgis-online-users","public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"};var t=esriGeowConfig.userRole,w;t?t.isAdmin()||t.isBasedOnAdmin()?w=q.administrator:t.isPublisher()||t.isBasedOnPublisher()?w=q.publisher:t.isUser()||t.isBasedOnUser()?w=q.user:
t.isCustom()&&(w=q.custom):w=q["public"];window.open(w)})),e.query("#esri-community-link").removeClass("hide"),e.attr(e.byId("esri-community-link"),"innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.esriCommunity),e.connect(e.byId("esri-community-link"),"onclick",e.hitch(this,function(q){q.preventDefault();window.open(esriGeowConfig.esriCommunityLink,"_blank")})),e.query("#my-esri-link").removeClass("hide"),e.attr(e.byId("my-esri-link"),
"innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.myEsri),e.connect(e.byId("my-esri-link"),"onclick",e.hitch(this,function(q){q.preventDefault();window.open(esriGeowConfig.myEsriLink,"_blank")})),e.query("#arcgis-blog-link").removeClass("hide"),e.attr(e.byId("arcgis-blog-link"),"innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.arcgisBlog),e.connect(e.byId("arcgis-blog-link"),
"onclick",e.hitch(this,function(q){q.preventDefault();window.open("https://www.esri.com/arcgis-blog/arcgis-online/","_blank")})))):(e.query(".signin",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.signIn()})),esriGeowConfig.self.urlKey||arcgisonline.sharing.util.isPortal()?(e.attr(e.byId("home-navigation-dropdown-link"),"innerHTML",esri.i18nBundle.siteHeader.simpleHome),e.query(".homeHome",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();
arcgisonline.map.main.goToPage(b+"index.html")})),e.query(".homeHome",this.domNode).removeClass("hide"),e.query(".homeGallery",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"gallery.html")})),(l=l&&l.gallery)&&"all"!==l||e.query(".homeGallery",this.domNode).removeClass("hide")):(e.query(".homeOverview",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"../features/features.html")})),
e.query(".homeOverview",this.domNode).removeClass("hide"),e.query(".homePricing",this.domNode).connect("onclick",e.hitch(this,function(q){q.preventDefault();arcgisonline.map.main.goToPage(b+"../features/plans/pricing.html")})),e.query(".homePricing",this.domNode).removeClass("hide")));(!esriGeowConfig.self.isPortal||esriGeowConfig.self.livingAtlasGroupQuery&&esriGeowConfig.self.livingAtlasGroupQuery.length)&&e.style(e.byId("webmap-add-esri-maplayers"),"display","block");d&&d.accountId&&!esriGeowConfig.self.isPortal&&
arcgisonline.map.vectorTile.checkSupport().then(e.hitch(this,function(q){var t=q?"Map Service;Image Service;Feature Service;WMS;WFS;WMTS;KML;Vector Tile Service".split(";"):"Map Service;Image Service;Feature Service;WMS;WFS;WMTS;KML".split(";");esri.request({url:esriGeowConfig.restBaseUrl+"community/users/"+d.username+"/provisionedListings",content:{f:"json",start:1,num:100},callbackParamName:"callback",load:function(w){if(w&&w.provisionedListings){for(var u=!1,v=0;v<w.provisionedListings.length;v++){var x=
w.provisionedListings[v];if(-1<e.indexOf(t,x.type)&&-1===e.indexOf(x.typeKeywords,"Elevation 3D Layer")&&-1===e.indexOf(x.tags,"mature support")){e.style(e.byId("webmap-add-provisionedListings"),"display","block");u=!0;break}}if(!u)for(v=0;v<w.provisionedListings.length&&!u;v++)x=w.provisionedListings[v],u||-1!==x.type.indexOf("Application")||"Web Map"===x.type||esri.request({url:esriGeowConfig.restBaseUrl+"content/items/"+this.mapLayer.oldItemCard.id+"/relatedItems?relationshipType\x3dService2Style\x26direction\x3dreverse\x26f\x3djson",
callbackParamName:"callback",load:e.hitch(this,function(z,A){if(z&&z.relatedItems&&z.relatedItems.length)for(A=0;A<z.relatedItems.length;A++){var B=z.relatedItems[A];-1<e.indexOf(t,B.type)&&-1===e.indexOf(B.typeKeywords,"Elevation 3D Layer")&&-1===e.indexOf(B.tags,"mature support")&&(e.style(e.byId("webmap-add-provisionedListings"),"display","block"),u=!0)}}),error:e.hitch(this,function(z){})})}},error:function(w){}})}));arcgisonline.map.main.updateRecentWebMaps()},initMap:function(b){arcgisonline.map.main.mapInitialized=
!0;e.connect(arcgisonline.map.main.map,"onDblClick",e.hitch(arcgisonline.map.main,"onDblClick"));e.connect(arcgisonline.map.main.map,"onExtentChange",e.hitch(arcgisonline.map.main,"onExtentChange"));e.connect(arcgisonline.map.main.map,"onPanStart",e.hitch(arcgisonline.map.main,"onPanStart"));e.connect(arcgisonline.map.main.map,"onPanEnd",e.hitch(arcgisonline.map.main,"onPanEnd"));e.connect(arcgisonline.map.main.map,"onZoomEnd",e.hitch(arcgisonline.map.main,"onZoomEnd"));e.subscribe("_onRendererUpdate",
e.hitch(arcgisonline.map.main,"onRendererUpdate"));arcgisonline.map.main.setHandCursor();arcgisonline.map.main.initialExtent=b;arcgisonline.map.main.setMapExtent(b);if(arcgisonline.map.main.defaultService.layer.loaded)arcgisonline.map.main.onDefaultServiceLoad(arcgisonline.map.main.defaultService.layer);else e.connect(arcgisonline.map.main.defaultService.layer,"onLoad",e.hitch(arcgisonline.map.main,"onDefaultServiceLoad"));arcgisonline.map.main.map.disableClickRecenter()},createOverviewMap:function(){if(!isEmbedded||
!isEmbedded.isItemDetail){var b=arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService);if(!b||!arcgisonline.map.main.mapInitialized)setTimeout(e.hitch(arcgisonline.map.main,"createOverviewMap"),1E3);else if(!arcgisonline.map.main.overviewMap){var c=!1;e.forEach(arcgisonline.map.main.mapLayers,function(l){"base"===l.type&&l.layer&&"esri.layers.VectorTileLayer"===l.layer.declaredClass&&(c=!0)});if(c){var d=esriGeowConfig.extentService;if(4326===b.spatialReference.wkid)d=esriGeowConfig.gcsBasemapService;
else if(!arcgisonline.map.main.map.spatialReference.isWebMercator())return;if(esriGeowConfig.allSSL||"https:"==location.protocol)d=d.replace("http:","https:");b=new esri.layers.ArcGISTiledMapServiceLayer(d,{});e.connect(b,"onLoad",function(){arcgisonline.map.main.overviewMap=new esri.dijit.OverviewMap({id:"overviewMap",baseLayer:b,map:arcgisonline.map.main.map,opacity:.45,width:200,height:200});arcgisonline.map.main.overviewMap.startup()})}else arcgisonline.map.main.overviewMap||"esri.layers.WMSLayer"===
b.declaredClass||(arcgisonline.map.main.overviewMap=new esri.dijit.OverviewMap({id:"overviewMap",map:arcgisonline.map.main.map,opacity:.45,width:200,height:200}),arcgisonline.map.main.overviewMap.startup())}}},destroyOverviewMap:function(){arcgisonline.map.main.overviewMap&&(arcgisonline.map.main.overviewMap.destroy(),arcgisonline.map.main.overviewMap=null)},recreateOverviewMap:function(){arcgisonline.map.main.destroyOverviewMap();arcgisonline.map.main.createOverviewMap()},createHomeButton:function(){arcgisonline.map.main.destroyHomeButton();
var b=e.byId("map_zoom_slider"),c=e.create("div",{id:"homeButtonDiv"});e.place(c,b,1);arcgisonline.map.main.homeButton=new esri.dijit.HomeButton({map:arcgisonline.map.main.map,theme:"homeButton",extent:arcgisonline.map.main.map.extent},"homeButtonDiv");arcgisonline.map.main.homeButton.startup()},destroyHomeButton:function(){arcgisonline.map.main.homeButton&&(arcgisonline.map.main.homeButton.destroy(),arcgisonline.map.main.homeButton=null,e.byId("homeButtonDiv")&&document.body.removeChild(e.byId("homeButtonDiv")))},
recreateHomeButton:function(){arcgisonline.map.main.destroyHomeButton();arcgisonline.map.main.createHomeButton()},createLocateButton:function(){if(!isEmbedded||!isEmbedded.isItemDetail){arcgisonline.map.main.destroyLocateButton();var b=e.byId("map_zoom_slider"),c=e.create("div",{id:"locateButtonDiv"});e.place(c,b,"after");arcgisonline.map.main.locateButton=new esri.dijit.LocateButton({map:arcgisonline.map.main.map,theme:"locateButton"},"locateButtonDiv");arcgisonline.map.main.locateButton.startup();
arcgisonline.map.main.locateButton.on("locate",function(d){d.error?arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.unableToLocate}):setTimeout(function(){arcgisonline.map.main.locateButton.clear()},5E3)})}},destroyLocateButton:function(){arcgisonline.map.main.locateButton&&(arcgisonline.map.main.locateButton.destroy(),arcgisonline.map.main.locateButton=null,e.byId("locateButtonDiv")&&
document.body.removeChild(e.byId("locateButtonDiv")))},recreateLocateButton:function(){arcgisonline.map.main.destroyLocateButton();arcgisonline.map.main.createLocateButton()},onMapLoad:function(){arcgisonline.map.main.map&&(e.publish("onMapLoad"),e.connect(K.byId("map"),"resize",e.hitch(arcgisonline.map.main,"resizeMap")),setTimeout("arcgisonline.map.main.map.reposition()",1E3),arcgisonline.map.main.createOverviewMap(),arcgisonline.map.main.resizeNoDataDiv(),arcgisonline.map.fileImport.setupDragDrop(),
esriGeowConfig.usageTrackingEnabled&&!arcgisonline.sharing.util.isPortal()&&(arcgisonline.map.main.onLayerAddCorsCheckHandler&&e.disconnect(arcgisonline.map.main.onLayerAddCorsCheckHandler),arcgisonline.map.main.onLayerAddCorsCheckHandler=e.connect(arcgisonline.map.main.map,"onLayerAdd",e.hitch(arcgisonline.map.main,"corsCheck"))),arcgisonline.map.main.setupMapAlert(),arcgisonline.map.main.setupHandlerForCache(),esri.id.setProtocolErrorHandler(function(b){arcgisonline.map.main.reloadViewerSecureIdMgr(b);
return!1}),arcgisonline.map.main.map.infoWindow.resize(300,250),arcgisonline.map.geocode.createWidget())},onDefaultServiceLoad:function(b){b=1E3;arcgisonline.map.save_open.openedWebMap&&(b=3E3);arcgisonline.map.main.mapFullyLoadedTimer=setTimeout("arcgisonline.map.main.mapFullyLoaded()",b)},mapFullyLoaded:function(){var b=!0;for(l=0;l<arcgisonline.map.main.mapLayers.length;l++){var c=arcgisonline.map.main.mapLayers[l];c&&c.layer&&"esri.layers.KMLLayer"==c.layer.declaredClass?c.layer.loaded||(b=!1):
c&&!c.layers&&null==arcgisonline.map.main.map.getLayer(c.id)?b=!1:c&&c.layers&&"mapNotes"==!c.type&&null==arcgisonline.map.main.map.getLayer(c.id+"_0")&&(b=!1)}if(b){clearTimeout(arcgisonline.map.main.mapFullyLoadedTimer);arcgisonline.map.main.cleanUpFailedServices();arcgisonline.map.main.onLayerAddHandler=e.connect(arcgisonline.map.main.map,"onLayerAdd",e.hitch(arcgisonline.map.main,"onLayerAddedOrRemoved"));setTimeout(function(){arcgisonline.map.main.onLayerRemoveHandler=e.connect(arcgisonline.map.main.map,
"onLayerRemove",e.hitch(arcgisonline.map.main,"onLayerAddedOrRemoved"));arcgisonline.map.main.onLayerReorderHandler=e.connect(arcgisonline.map.main.map,"onLayerReorder",e.hitch(arcgisonline.map.main,"onLayerReordered"))},5E3);e.connect(arcgisonline.map.main.map,"onBeforeUnload",function(){e.disconnect(arcgisonline.map.main.onLayerAddHandler);e.disconnect(arcgisonline.map.main.onLayerRemoveHandler);e.disconnect(arcgisonline.map.main.onLayerReorderHandler)});e.publish("onLayerUpdate",[""]);arcgisonline.map.main.scalebar||
(arcgisonline.map.main.scalebar=new esri.dijit.Scalebar({map:arcgisonline.map.main.map,scalebarUnit:arcgisonline.map.main.scaleBarUnits}));var d=arcgisonline.sharing.util.getUser();d&&arcgisonline.map.save_open.webMapInfo&&arcgisonline.map.save_open.webMapInfo.owner!==d.username&&"admin"!==arcgisonline.map.save_open.webMapInfo.itemControl&&"update"!==arcgisonline.map.save_open.webMapInfo.itemControl?K.byId("webmap-save-save").set("disabled",!0):K.byId("webmap-save-save").set("disabled",!1);arcgisonline.map.main.createHomeButton();
arcgisonline.map.main.createLocateButton();arcgisonline.map.time.checkTimeSliderProperties(!0);arcgisonline.map.main.isMapFullyLoaded=!0;arcgisonline.map.role.updateUserActionWithWebmap();arcgisonline.map.popup.addPopupLayers();b=(b=arcgisonline.sharing.util.urlToObject(document.URL).query)?b.timeExtent:null;!b&&arcgisonline.map.save_open.openedWebMap&&(b=arcgisonline.map.save_open.openedWebMap.timeExtent);b?(b=b.split(","),2==b.length&&(c=new esri.TimeExtent,c.startTime=new Date(parseInt(b[0])),
c.endTime=new Date(parseInt(b[1])),arcgisonline.map.main.map.setTimeExtent(c))):arcgisonline.map.time.checkOnTimeButton();arcgisonline.map.multiDimensions.checkOnMdSliderButton();arcgisonline.map.popup.setupPopupHandler();arcgisonline.map.main.initBookmarks();arcgisonline.map.main.updateHeaderPresentationLink();for(var l=0;l<arcgisonline.map.main.mapLayers.length;l++)"base"==arcgisonline.map.main.mapLayers[l].type&&(arcgisonline.map.main.mapLayers[l].successfulDraw=!0);arcgisonline.map.leftPanel.mapLoadedSettings();
var h=arcgisonline.sharing.util.urlToObject(document.URL);h.query=h.query||{};h.query.mapNotes&&arcgisonline.map.mapNotes.addMapNotesLayer();arcgisonline.map.main.checkLayerOrder();arcgisonline.map.main.refreshMapTables();arcgisonline.map.main.checkMinWidthOfPage();arcgisonline.map.main.checkTitleDiv();arcgisonline.map.main.createUrlMarker();h.query.showPublish&&arcgisonline.map.main.linkToMap(!0);h.query.defExt&&arcgisonline.map.main.displayDefaultExtent();if(h.query.panel&&"gallery"===h.query.panel&&
(h.query.layers||h.query.url)&&!h.query.webmap&&!h.query.review){arcgisonline.map.role.isAnonymous()&&arcgisonline.map.role.updateUserActionAfterModify();var f=h.query.layers&&h.query.layers.split(",")[0],r=h.query.url,q=null,t=setInterval(function(){for(var u=1;u<arcgisonline.map.main.mapLayers.length;u++){var v=arcgisonline.map.main.mapLayers[u];if((f&&v.itemId===f||r&&v.layer.url===r)&&v.layer instanceof esri.layers.FeatureLayer)if(h.query.id&&v.layer.url&&-1<v.layer.url.indexOf("/"+h.query.id)){q=
v;break}else if(!h.query.id){q=v;break}}q&&(u=arcgisonline.map.itemData.itemDataContents[q.itemId],v=q.origItemLayers,u&&u.layers&&!v||(clearInterval(t),arcgisonline.map.leftPanel.openLeftRendererPanel(q.id,-1,!0,!0,"true"===h.query.suggestField?!0:!1,h.query.showField,h.query.style)))},200)}if((d=arcgisonline.sharing.util.getUser())&&h.query.review&&(h.query.layers||h.query.services)){f=(h.query.layers||h.query.services).split(",")[0];var w=0;t=setInterval(function(){e.forEach(arcgisonline.map.main.mapLayers,
function(u){u.itemId===f&&"base"!=u.type&&u.itemCard&&u.url&&(u.itemCard.owner===d.username||"update"===u.itemCard.itemControl||"admin"===u.itemCard.itemControl)&&-1<e.indexOf(u.itemCard.typeKeywords,"Involved Lookup")&&(clearInterval(t),arcgisonline.map.leftPanel.openLeftGeocodePanel(null,{parameterList:u}))});20<w&&clearInterval(t);w++},1E3)}e.publish("onMapFullyLoaded");h.query.find&&arcgisonline.map.geocode.doSearch(decodeURIComponent(h.query.find));arcgisonline.map.main.checkUnsupported4xFeatures();
arcgisonline.map.main.checkAccessToViewer();r=arcgisonline.map.main.buildNewMapViewerUrl();e.byId("webmap-openNewViewer").href=r}else arcgisonline.map.main.mapFullyLoadedTimer=setTimeout("arcgisonline.map.main.mapFullyLoaded()",1E3)},buildNewMapViewerUrl:function(){var b=esriGeowConfig.newMapViewerUrl,c=arcgisonline.sharing.util.urlToObject(document.URL),d="url urls webmap layers layerId basemapUrl basemapReferenceUrl center extent level find marker".split(" "),l=["Feature Service","Map Service",
"Image Service","KML","Vector Tile Service"];c.query=c.query||{};var h="?";for(key in c.query)if("layers"===key){var f=c.query[key].split(","),r=!1;e.forEach(f,function(q){var t=arcgisonline.map.save_open.itemCards[q];t&&-1<e.indexOf(l,t.type)&&(r?b+=","+q:(b+=h+"layers\x3d"+q,h="\x26",r=!0))})}else-1<e.indexOf(d,key)&&(b+=h+key+"\x3d"+c.query[key],h="\x26");return b},openNewMapViewer:function(b){b&&b.preventDefault();b=arcgisonline.map.main.buildNewMapViewerUrl();1==arcgisonline.map.main.mapHasChanged?
arcgisonline.sharing.dijit.dialog.OpenNewViewerDlg.prototype.statics.getInstance().show(b):arcgisonline.map.main.goToPage(b)},checkUnsupported4xFeatures:function(){-1<window.navigator.userAgent.indexOf("Trident/")||isEmbedded||!esriGeowConfig.newMapViewerEnabled||arcgisonline.map.utils.getUnsupported4xFeatures(arcgisonline.map.save_open.originalWebMap||arcgisonline.map.save_open.openedWebMap,arcgisonline.map.save_open.webMapItemCard).then(function(b){if(b.anyUnsupportedFeatures){var c="";b.unsupportedWebmapFeatures&&
b.unsupportedWebmapFeatures.length?c=esri.i18nBundle.viewer.error.openInNewMapViewerMsg1+" "+esri.i18nBundle.viewer.error.openInNewMapViewerMsg2:(e.forEach(b.layers,function(l){c+="\x3cli\x3e"+l.title+"\x3c/li\x3e"}),c=esri.i18nBundle.viewer.error.openInNewMapViewerMsg1ForLayers+"\x3c/br\x3e\x3cul\x3e"+c+"\x3c/ul\x3e"+esri.i18nBundle.viewer.error.openInNewMapViewerMsg2);b="\x26nbsp;\x3ca class\x3d'esriHelpIcon esriFloatTrailing'title\x3d'"+esri.i18nBundle.common.help+"' href\x3d'"+(esriGeowConfig.helpBase+
esriGeowConfig.helpMap["120002712"])+"' target\x3d'_blank' /\x3e";var d=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();d.show({title:esri.i18nBundle.viewer.error.openInNewMapViewerTitle+b,message:c,choiceOneTitle:esri.i18nBundle.viewer.error.openInNewMapViewerYes,choiceOneHandler:e.hitch(this,function(){var l=esriGeowConfig.newMapViewerUrl+document.location.href.substring(document.location.href.indexOf("?"));window.open(l,"_blank")}),choiceTwoTitle:esri.i18nBundle.viewer.main.notRightNow,
choiceTwoHandler:function(){}});e.style(d._dialog.domNode,"width","600px")}})},checkUnsupported4xItem:function(b,c){if(!(-1<window.navigator.userAgent.indexOf("Trident/"))&&esriGeowConfig.newMapViewerEnabled&&-1<b.typeKeywords.indexOf("ArcGIS API for JavaScript"))if(isEmbedded){var d="update"===b.itemControl||"admin"===b.itemControl,l=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d=d?esri.i18nBundle.viewer.error.openInNewMapViewerLayerOwner:esri.i18nBundle.viewer.error.openInNewMapViewerLayerNotOwner;
l.setButtonLabel(esri.i18nBundle.viewer.error.openInNewMapViewerYes);l.show({title:esri.i18nBundle.viewer.error.openInNewMapViewerTitle,message:d});e.aspect.after(l,"onOkClick",e.hitch(this,function(){var f=arcgisonline.sharing.util.urlToObject(document.URL);window.open(esriGeowConfig.newMapViewerUrl+"?layers\x3d"+f.query.layers+"\x26layerId\x3d"+f.query.layerId,"_blank")}))}else{d=esri.i18nBundle.viewer.error.openInNewMapViewerLayerMsg1.replace("${title}",b.title)+"\x3cbr/\x3e\x3cbr/\x3e"+esri.i18nBundle.viewer.error.openInNewMapViewerLayerMsg2;
var h="\x26nbsp;\x3ca class\x3d'esriHelpIcon esriFloatTrailing'title\x3d'"+esri.i18nBundle.common.help+"' href\x3d'"+(esriGeowConfig.helpBase+esriGeowConfig.helpMap["120002712"])+"' target\x3d'_blank' /\x3e";l=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();l.show({title:esri.i18nBundle.viewer.error.openInNewMapViewerTitle+h,message:d,choiceOneTitle:esri.i18nBundle.viewer.error.openInNewMapViewerYes,choiceOneHandler:e.hitch(this,function(){var f=arcgisonline.sharing.util.urlToObject(document.URL),
r=esriGeowConfig.newMapViewerUrl;r="itemBrowser"===c?r+("?layers\x3d"+b.id):"layers"===c?r+("?layers\x3d"+f.query.layers):r+("?webmap\x3d"+f.query.webmap);window.open(r,"_blank")}),choiceTwoTitle:esri.i18nBundle.viewer.main.notRightNow,choiceTwoHandler:function(){}});e.style(l._dialog.domNode,"width","600px")}},checkLayerOrder:function(){if(arcgisonline.map.save_open.basemapWebMap){var b=arcgisonline.map.save_open.basemapWebMap;b.operationalLayers=[]}else arcgisonline.map.save_open.openedWebMap?b=
arcgisonline.map.save_open.openedWebMap:(b=esriGeowConfig.self.defaultBasemap,b.operationalLayers=[]);var c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,"LabelLayer");-1<c&&arcgisonline.map.main.map.reorderLayer("LabelLayer",arcgisonline.map.main.map.graphicsLayerIds.length);var d=[];e.forEach(b.baseMapLayers||b.baseMap.baseMapLayers,function(x){d.push(x.id)});e.forEach(b.operationalLayers,function(x){d.push(x.id)});var l=[];e.forEach(arcgisonline.map.main.mapLayers,function(x){l.push(x.id)});
for(var h=!1,f=1;f<arcgisonline.map.main.mapLayers.length-1;){var r=arcgisonline.map.main.mapLayers[f],q=arcgisonline.map.main.mapLayers[f+1],t=e.indexOf(d,r.id),w=e.indexOf(d,q.id);if(-1!==t&&-1!==w)if("user"!=r.type&&"mapNotes"!=r.type||"user"!=q.type&&"mapNotes"!=q.type||!(r.layers||r.layer instanceof esri.layers.FeatureLayer||r.layer instanceof esri.layers.GeoRSSLayer)||!(q.layers||q.layer instanceof esri.layers.FeatureLayer||q.layer instanceof esri.layers.GeoRSSLayer))if("user"===r.type&&"base"===
q.type||"labels"===r.type&&"labels"!==q.type)u=1,arcgisonline.map.main.mapLayers[f+1]=r,arcgisonline.map.main.mapLayers[f]=q,c=e.indexOf(arcgisonline.map.main.map.layerIds,r.id),h=e.indexOf(arcgisonline.map.main.map.layerIds,q.id),-1<c&&-1<h&&c<h&&arcgisonline.map.main.map.reorderLayer(r.id,c+u),l=[],e.forEach(arcgisonline.map.main.mapLayers,function(x){l.push(x.id)}),f=0,h=!0;else if("base"===r.type&&"base"===q.type||"labels"===r.type&&"labels"===q.type){var v=[];e.forEach(b.baseMapLayers||b.baseMap.baseMapLayers,
function(x){("base"===r.type&&!x.isReference||"labels"===r.type&&x.isReference)&&v.push(x.id)});t=e.indexOf(v,r.id);w=e.indexOf(v,q.id);t>w&&(u=1,arcgisonline.map.main.mapLayers[f+1]=r,arcgisonline.map.main.mapLayers[f]=q,c=e.indexOf(arcgisonline.map.main.map.layerIds,r.id),h=e.indexOf(arcgisonline.map.main.map.layerIds,q.id),-1<c&&-1<h&&c<h&&arcgisonline.map.main.map.reorderLayer(r.id,c+u),l=[],e.forEach(arcgisonline.map.main.mapLayers,function(x){l.push(x.id)}),f=0,h=!0)}else"user"==r.type&&"user"==
q.type&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,r.id)&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,q.id)?(t=e.indexOf(d,r.id),w=e.indexOf(d,q.id),t>w?(arcgisonline.map.main.mapLayers[f+1]=r,arcgisonline.map.main.mapLayers[f]=q,c=e.indexOf(arcgisonline.map.main.map.layerIds,r.id),h=e.indexOf(arcgisonline.map.main.map.layerIds,q.id),-1<c&&-1<h&&c<h&&arcgisonline.map.main.map.reorderLayer(r.id,c+1),l=[],e.forEach(arcgisonline.map.main.mapLayers,function(x){l.push(x.id)}),f=0,h=!0):(t=e.indexOf(arcgisonline.map.main.map.layerIds,
r.id),w=e.indexOf(arcgisonline.map.main.map.layerIds,q.id),t>w&&arcgisonline.map.main.map.reorderLayer(q.id,t+1))):"user"==r.type&&"user"==q.type&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,r.id)&&(q.layers||q.layer instanceof esri.layers.FeatureLayer||q.layer instanceof esri.layers.GeoRSSLayer)||("user"==r.type&&"user"==q.type&&(r.layers||r.layer instanceof esri.layers.FeatureLayer||r.layer instanceof esri.layers.GeoRSSLayer)&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,q.id)?(u=1,arcgisonline.map.main.mapLayers[f+
1]=r,arcgisonline.map.main.mapLayers[f]=q,r.layers?(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,r.layers[r.layers.length-1].id),-1<c&&e.forEach(r.layers,function(x,z){arcgisonline.map.main.map.reorderLayer(x.id,c+u)},this)):r.layer instanceof esri.layers.GeoRSSLayer?(h=r.layer.getFeatureLayers(),h.length&&(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,h[h.length-1].id),-1<c&&e.forEach(h,function(x,z){arcgisonline.map.main.map.reorderLayer(x.id,c+u)},this))):(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,
r.id),h=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,q.id),-1<c&&-1<h&&c<h&&arcgisonline.map.main.map.reorderLayer(r.id,c+u)),l=[],e.forEach(arcgisonline.map.main.mapLayers,function(x){l.push(x.id)}),f=0,h=!0):"labels"==q.type&&(w=e.indexOf(arcgisonline.map.main.map.layerIds,q.id),-1<w&&w<arcgisonline.map.main.map.layerIds.length-1&&arcgisonline.map.main.map.reorderLayer(q.id,arcgisonline.map.main.map.layerIds.length-1)));else if(t=e.indexOf(d,r.id),w=e.indexOf(d,q.id),t>w){var u=1;q.layers?
u=q.layers.length:q.layer instanceof esri.layers.GeoRSSLayer&&(u=q.layer.getFeatureLayers().length);arcgisonline.map.main.mapLayers[f+1]=r;arcgisonline.map.main.mapLayers[f]=q;r.layers?(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,r.layers[r.layers.length-1].id),-1<c&&e.forEach(r.layers,function(x,z){arcgisonline.map.main.map.reorderLayer(x.id,c+u)},this)):r.layer instanceof esri.layers.GeoRSSLayer?(h=r.layer.getFeatureLayers(),c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,h[h.length-
1].id),-1<c&&e.forEach(h,function(x,z){arcgisonline.map.main.map.reorderLayer(x.id,c+u)},this)):(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,r.id),h=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,q.id),-1<c&&-1<h&&c<h&&arcgisonline.map.main.map.reorderLayer(r.id,c+u));l=[];e.forEach(arcgisonline.map.main.mapLayers,function(x){l.push(x.id)});f=0;h=!0}f++}for(f=b=0;f<arcgisonline.map.main.mapLayers.length;f++)if(q=arcgisonline.map.main.mapLayers[f],("user"==q.type||"mapNotes"==q.type)&&
(q.layers||q.layer instanceof esri.layers.FeatureLayer||q.layer instanceof esri.layers.GraphicsLayer||q.layer instanceof esri.layers.GeoRSSLayer))if(q.layers||q.layer instanceof esri.layers.GeoRSSLayer)for(q=q.layers?q.layers:q.layer.getFeatureLayers(),t=0;t<q.length;t++)w=q[t].id,-1<e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,w)&&arcgisonline.map.main.map.reorderLayer(w,b++);else w=q.id,-1<e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,w)&&arcgisonline.map.main.map.reorderLayer(w,
b++);for(f=b=0;f<arcgisonline.map.main.mapLayers.length;f++)q=arcgisonline.map.main.mapLayers[f],q.layer&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,q.layer.id)&&arcgisonline.map.main.map.reorderLayer(q.layer.id,b++);h&&leftPanel&&leftPanel.reloadVisibleTOC();arcgisonline.map.labels.orderLayers()},onDblClick:function(b){if(!arcgisonline.map.edit.editActivated&&!arcgisonline.map.main.measureActivated&&!arcgisonline.map.edit.analysisDrawActivated){var c=.5;null!=arcgisonline.map.main.mapLods&&
(c=arcgisonline.map.main.map.getLevel()+1);arcgisonline.map.main.map.centerAndZoom(new esri.geometry.Point(b.mapPoint.x,b.mapPoint.y,arcgisonline.map.main.map.extent.spatialReference),c)}},onExtentChange:function(b,c,d,l){if(arcgisonline.map.main.startup){if(arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService)){null!=arcgisonline.map.main.defaultService.layer&&1==arcgisonline.map.main.defaultService.defaultVisibility&&arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService).show();
for(c=0;c<arcgisonline.map.main.mapLayers.length;c++)(d=arcgisonline.map.main.mapLayers[c])&&("user"==d.type||"labels"==d.type)&&d.defaultVisibility&&arcgisonline.map.main.showLayerOnceLoaded(d.id,0);arcgisonline.map.main.startup=!1}}else!arcgisonline.map.main.isUserBaseService&&l&&(arcgisonline.map.main.hideNoDataDisplay(),arcgisonline.map.main.displayNoData(l.level)),arcgisonline.map.main.lastExtent&&(c=arcgisonline.map.main.lastExtent.getWidth()*arcgisonline.map.main.lastExtent.getHeight(),d=b.getWidth()*
b.getHeight(),1.3<Math.max(c,d)/Math.min(c,d)&&arcgisonline.map.main.markMapAsChangedIfOwner("onExtentChange")),isEmbedded&&arcgisonline.map.main.markMapAsChangedIfOwner("onExtentChange"),c=Math.round(arcgisonline.map.main.map.getScale()),c=e.number.format(c,{pattern:"#,###,###,##0"}),e.byId("layerMenu.scaleCurrent")&&(e.byId("layerMenu.scaleCurrent").innerHTML=e.string.substitute(esri.i18nBundle.tocPanel.mapScale,{scale:c})),e.byId("subLayerMenu.scaleCurrent")&&(e.byId("subLayerMenu.scaleCurrent").innerHTML=
e.string.substitute(esri.i18nBundle.tocPanel.mapScale,{scale:c}));arcgisonline.map.dijit.toc.scale.checkLayersInMapScale();arcgisonline.map.main.lastExtent=e.clone(b)},showLayerOnceLoaded:function(b,c){for(var d=0;d<arcgisonline.map.main.mapLayers.length;d++){var l=arcgisonline.map.main.mapLayers[d];if(l.id==b){null==l.layer&&50>c?setTimeout(function(){arcgisonline.map.main.showLayerOnceLoaded(b,c+1)},100):null!=l.layer&&1==l.defaultVisibility&&l.layer.show();break}}},onLayerAddResult:function(b,
c){if(c&&c.message&&-1<c.message.indexOf("Too many WebGL contexts.")){var d=arcgisonline.map.main.getItemWithId(arcgisonline.map.main.mapLayers,b.id);arcgisonline.map.layer.removeLayer(d);e.publish("layerAddFailed",[d.itemId?{itemId:d.itemId,id:d.id}:d.id]);c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();b=e.string.substitute(esri.i18nBundle.viewer.error.layerNotAddedOutOfWebGL,{layer:d&&d.title||b.url});c.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:b})}},
onLayerAddedOrRemoved:function(b){"esri.layers.GraphicsLayer"===b.declaredClass||b.__tempTableLayer||null==arcgisonline.map.main.mapLayers[0]||null==arcgisonline.map.main.mapLayers[0].layer||"base"!=arcgisonline.map.main.mapLayers[0].type||(b.timeInfo&&b.useMapTime&&(arcgisonline.map.time.timeSliderProperties=null),arcgisonline.map.edit.checkOnEditButton(),arcgisonline.map.time.checkOnTimeButton(),arcgisonline.map.dijit.toc.analysis.checkOnAnalysisButton(),arcgisonline.map.multiDimensions.checkOnMdSliderButton(),
null!=arcgisonline.map.save_open.webMapInfo&&(arcgisonline.map.save_open.webMapInfo.deleteExplorerSlides=!0),e.publish("onLayerUpdate",["reopen"]),leftPanel&&leftPanel.checkLegendStack(),arcgisonline.map.main.isMapFullyLoaded&&"editStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&b instanceof esri.layers.FeatureLayer&&b.isEditable()&&setTimeout(function(){K.byId("editPanel").recreateEditor()},0))},onLayerReordered:function(b){"esri.layers.GraphicsLayer"===b.declaredClass||"esri.layers.FeatureLayer"===
b.declaredClass&&b.mode===esri.layers.FeatureLayer.MODE_SELECTION||(null!=arcgisonline.map.save_open.webMapInfo&&(arcgisonline.map.save_open.webMapInfo.deleteExplorerSlides=!0),leftPanel&&leftPanel.checkLegendStack())},resizeMap:function(){if(arcgisonline.map.main.map&&arcgisonline.map.main.map.extent&&arcgisonline.map.main.map.extent.xmin){try{arcgisonline.map.main.map.resize()}catch(b){}arcgisonline.map.main.map.reposition();arcgisonline.map.main.resizeNoDataDiv()}arcgisonline.map.table.featureTable&&
e.isIE&&arcgisonline.map.table.featureTable.resize()},onLayerVisibilityChange:function(){arcgisonline.map.edit.checkOnEditButton();arcgisonline.map.time.checkOnTimeButton();arcgisonline.map.multiDimensions.checkOnMdSliderButton();arcgisonline.map.main.checkMapAlert();arcgisonline.map.main.markMapAsChangedIfOwner("onLayerVisibilityChange");leftPanel&&leftPanel.checkLegendStack()},onPanStart:function(){arcgisonline.map.edit.editActivated||(9>e.isIE?arcgisonline.map.main.map.setMapCursor("url(images/close_hand_cursor.cur),auto"):
arcgisonline.map.main.map.setMapCursor("url(images/close_hand_cursor.png),auto"))},onPanEnd:function(){arcgisonline.map.edit.editActivated||arcgisonline.map.main.setHandCursor()},onZoomEnd:function(){},onRendererUpdate:function(){leftPanel&&(leftPanel.deleteLegendStack(),"contentStack"==arcgisonline.map.leftPanel.getLeftContentPanelStack()?e.publish("onLayerUpdate",["reopen"]):leftPanel.deleteContentStack());arcgisonline.map.main.markMapAsChanged("onRendererUpdate")},setHandCursor:function(){null!=
arcgisonline.map.main.map&&arcgisonline.map.main.map.setMapCursor("default")},displayNoData:function(b){arcgisonline.map.main.noDataDisplayTimer=setTimeout("arcgisonline.map.main.displayNoDataDelay("+b+")",2500)},displayNoDataDelay:function(b){clearTimeout(arcgisonline.map.main.noDataDisplayTimer);if(null!=arcgisonline.map.main.mapLods){b=arcgisonline.map.main.mapLods[b].resolution;var c=arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService);if(c.tileInfo){c=c.tileInfo.lods;
var d=c[0].resolution;if(b<c[c.length-1].resolution||b>d)e.style(e.byId("noData1"),"display","block"),e.style(e.byId("noData2"),"display","block"),e.style(e.byId("noData3"),"display","block"),e.style(e.byId("noData4"),"display","block")}}},hideNoDataDisplay:function(){e.style(e.byId("noData1"),"display","none");e.style(e.byId("noData2"),"display","none");e.style(e.byId("noData3"),"display","none");e.style(e.byId("noData4"),"display","none")},resizeNoDataDiv:function(){arcgisonline.map.main.hideNoDataDisplay();
e.style(e.byId("noDataDiv"),"width",""+e.style(e.byId("mapDiv"),"width")+"px");e.style(e.byId("noDataDiv"),"height",""+e.style(e.byId("mapDiv"),"height")+"px");e.style(e.byId("noDataDiv"),"left",""+e.style(e.byId("mapDiv"),"left")+"px");e.style(e.byId("noDataDiv"),"top",""+e.style(e.byId("mapDiv"),"top")+"px");var b=arcgisonline.map.main.map.height/4-25;e.style(e.byId("noData1"),"margin",""+b+"px 0 "+b+"px 0");e.style(e.byId("noData2"),"margin",""+b+"px 0 "+b+"px 0");e.style(e.byId("noData3"),"margin",
""+b+"px 0 "+b+"px 0");e.style(e.byId("noData4"),"margin",""+b+"px 0 "+b+"px 0")},setDefaultTitle:function(){arcgisonline.map.main.setTitle(esri.i18nBundle.viewer.defaultMapTitle)},setTitle:function(b){e.byId("webmap-title-text").innerHTML=b;arcgisonline.map.main.checkTitleDiv();e.doc.title=esriGeowConfig.urlKey?b:(esriGeowConfig.portalName?esriGeowConfig.portalName:"ArcGIS")+" - "+b},checkTitleDiv:function(){if(arcgisonline.map.main.isMapFullyLoaded){var b=e.coords(e.byId("webmap-header")).w,c=e.coords(e.byId("home-navigation-dropdown")).w,
d=e.coords(e.byId("header-controls")).w;d=b-c-d-45;0>d&&(e.style(e.byId("header-controls"),"width","300px"),d=b-c-300-30);e.style(e.byId("webmap-title-text"),"visibility","visible");if(arcgisonline.map.save_open.webMapInfo&&(b=arcgisonline.sharing.util.getUser())&&(arcgisonline.map.save_open.webMapInfo.owner===b.username||"admin"===arcgisonline.map.save_open.webMapInfo.itemControl||"update"===arcgisonline.map.save_open.webMapInfo.itemControl)){b=e.coords(e.byId("webmap-title-edit-save")).w;var l=
e.coords(e.byId("webmap-title-edit-cancel")).w;0<b||0<l?e.style("webmap-title-edit-input","width",d-b-l-10+"px"):e.style("webmap-title-edit-input","width",d-10*esri.i18nBundle.common.save.length-10*esri.i18nBundle.common.cancel.length-50+"px");e.style(e.byId("webmap-title-edit"),"visibility","visible");arcgisonline.map.main.titleEditHandler||(arcgisonline.map.main.titleEditHandler=e.query("#webmap-title-edit").onclick(e.hitch(arcgisonline.map.main,"editTitle")),e.query("#webmap-title-edit-save").onclick(e.hitch(arcgisonline.map.main,
"saveTitle")),e.query("#webmap-title-edit-cancel").onclick(e.hitch(arcgisonline.map.main,"cancelTitle")))}e.style(e.byId("webmap-title"),"width",d+"px");e.style(e.byId("webmap-title-tableDiv"),"width",d+"px");e.style(e.byId("webmap-title-table"),"width",d+"px");e.byId("webmap-title-sizing").innerHTML=esri.i18nBundle.common.edit;b=e.coords(e.byId("webmap-title-edit")).w;d=d-b-10;e.byId("webmap-title-sizing").innerHTML=e.byId("webmap-title-text").innerHTML;b=e.coords(e.byId("webmap-title-sizing")).w+
10;e.style(e.byId("webmap-title-text"),"width",(d>b?b:d)+"px");esriGeowConfig.isRightToLeft?e.style(e.byId("webmap-title"),"paddingRight",c+18+"px"):e.style(e.byId("webmap-title"),"paddingLeft",c+18+"px")}},editTitle:function(){e.style(e.byId("webmap-title-text"),"display","none");e.style(e.byId("webmap-title-edit"),"display","none");e.style(e.byId("webmap-title-edit-inputGrp"),"display","");arcgisonline.map.main.checkTitleDiv();e.byId("webmap-title-edit-input").value=arcgisonline.map.save_open.webMapInfo?
arcgisonline.map.save_open.webMapInfo.title:esri.i18nBundle.viewer.defaultMapTitle},saveTitle:function(){var b=e.byId("webmap-title-edit-input").value;if(b&&b.length)if(-1<b.indexOf("\x3c")||-1<b.indexOf("\x3e"))e.byId("webmap-title-edit-input").value=arcgisonline.map.save_open.webMapInfo.title,d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.saveWebMapDlg.error.specialCharaters});else{250<
b.length&&(b=b.substring(0,250));d={title:b};var c=esriGeowConfig.restBaseUrl+"content/users/"+arcgisonline.map.save_open.webMapInfo.owner;c+=arcgisonline.map.save_open.webMapInfo.ownerFolder?"/"+arcgisonline.map.save_open.webMapInfo.ownerFolder:"";c+="/items/"+arcgisonline.map.save_open.webMapInfo.id+"/update";arcgisonline.sharing.util.postJson(d,c).then(function(l){arcgisonline.map.save_open.webMapInfo.title=b;arcgisonline.map.main.setTitle(b);e.style(e.byId("webmap-title-text"),"display","");e.style(e.byId("webmap-title-edit"),
"display","");e.style(e.byId("webmap-title-edit-inputGrp"),"display","none")},function(l){e.style(e.byId("webmap-title-text"),"display","");e.style(e.byId("webmap-title-edit"),"display","");e.style(e.byId("webmap-title-edit-inputGrp"),"display","none");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.save_open.mapNotSaved,{title:b})})})}else{e.byId("webmap-title-edit-input").value=
arcgisonline.map.save_open.webMapInfo.title;var d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.saveWebMapDlg.error.provideTitle})}},cancelTitle:function(){e.style(e.byId("webmap-title-text"),"display","");e.style(e.byId("webmap-title-edit"),"display","");e.style(e.byId("webmap-title-edit-inputGrp"),"display","none")},setMapExtent:function(b){null==b&&(b=arcgisonline.map.main.defaultExtent);
arcgisonline.map.main.initialExtent=new esri.geometry.Extent(b.xmin,b.ymin,b.xmax,b.ymax,b.spatialReference);var c=arcgisonline.map.main.map.spatialReference;null==c&&(c=arcgisonline.map.main.defaultExtent.spatialReference);var d=arcgisonline.sharing.util.urlToObject(document.URL);d.query=d.query||{};if(d.query.extent)if(b=decodeURIComponent(d.query.extent).split(";"),1===b.length&&(b=decodeURIComponent(d.query.extent).split(",")),4==b.length||5==b.length){var l=e.number.parse(b[0]),h=e.number.parse(b[1]),
f=e.number.parse(b[2]),r=e.number.parse(b[3]);if(isNaN(l)||isNaN(l)||isNaN(l)||isNaN(l))l=parseFloat(b[0]),h=parseFloat(b[1]),f=parseFloat(b[2]),r=parseFloat(b[3]);if(isNaN(l)||isNaN(h)||isNaN(f)||isNaN(r))arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1);else{var q=4326;5!=b.length||isNaN(b[4])||(q=parseInt(b[4]));h=new esri.geometry.Extent(l,h,f,r,new esri.SpatialReference({wkid:q}));arcgisonline.map.main.sameSpatialReference(c,new esri.SpatialReference({wkid:q}))?(arcgisonline.map.main.initialExtent=
h,arcgisonline.map.main.map.setExtent(h,!1)):(b=function(v,x){arcgisonline.map.main.initialExtent=v[0];arcgisonline.map.main.map.setExtent(v[0],!1)},l=function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1)},arcgisonline.map.main.projectToMapSpatialReference(h,e.hitch(this,b),e.hitch(this,l)))}}else arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1);else if(d.query.center){if(b=decodeURIComponent(d.query.center).split(";"),1===b.length&&(b=
decodeURIComponent(d.query.center).split(",")),2==b.length||3==b.length){h=e.number.parse(b[0]);f=e.number.parse(b[1]);if(isNaN(h)||isNaN(f))h=parseFloat(b[0]),f=parseFloat(b[1]);if(!isNaN(h)&&!isNaN(f)){q=4326;3!=b.length||isNaN(b[2])||(q=parseInt(b[2]));var t=function(v,x){var z=0,A=0;null!=arcgisonline.map.main.mapLods&&d.query.level?(A=parseInt(d.query.level),z=arcgisonline.map.main.mapLods[A].resolution*arcgisonline.map.main.map.width/2,A=arcgisonline.map.main.mapLods[A].resolution*arcgisonline.map.main.map.height/
2):d.query.resolution?(A=parseFloat(d.query.resolution),z=A*arcgisonline.map.main.map.width/2,A=A*arcgisonline.map.main.map.height/2):(z=arcgisonline.map.main.defaultExtent.getWidth()/2,A=arcgisonline.map.main.defaultExtent.getHeight()/2);v=new esri.geometry.Extent(v-z,x-A,v+z,x+A,c);arcgisonline.map.main.initialExtent=v;arcgisonline.map.main.map.setExtent(v)};arcgisonline.map.main.sameSpatialReference(c,new esri.SpatialReference({wkid:q}))?t(h,f):(b=function(v,x){t(v[0].x,v[0].y)},l=function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,
!1)},arcgisonline.map.main.projectPointToMapSpatialReference(h,f,new esri.SpatialReference({wkid:q}),e.hitch(this,b),e.hitch(this,l)))}}}else if(arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.initialState&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.targetGeometry&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.scale){h=new esri.geometry.Extent(arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.targetGeometry);
var w=h.getCenter(),u=arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.scale;h=w.x;f=w.y;t=function(v,x){v=arcgisonline.map.main.getExtentFromCenter(w,arcgisonline.map.main.map.width,u);arcgisonline.map.main.initialExtent=v;arcgisonline.map.main.map.setExtent(v)};arcgisonline.map.main.sameSpatialReference(c,w.spatialReference)?t(h,f):(b=function(v,x){t(v[0].x,v[0].y)},l=function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1)},arcgisonline.map.main.projectPointToMapSpatialReference(h,
f,new esri.SpatialReference({wkid:q}),e.hitch(this,b),e.hitch(this,l)))}else arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.initialState&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.targetGeometry?(h=new esri.geometry.Extent(arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.targetGeometry),arcgisonline.map.main.sameSpatialReference(c,h.spatialReference)?(arcgisonline.map.main.initialExtent=
h,arcgisonline.map.main.map.setExtent(h,!1)):(b=function(v,x){arcgisonline.map.main.initialExtent=v[0];arcgisonline.map.main.map.setExtent(v[0],!1)},l=function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1)},arcgisonline.map.main.projectToMapSpatialReference(h,e.hitch(this,b),e.hitch(this,l)))):(arcgisonline.map.main.map.spatialReference||(q=new esri.SpatialReference(b.spatialReference.toJson()),arcgisonline.map.main.map.spatialReference=q),arcgisonline.map.main.map.setExtent(b,
!1))},createUrlMarker:function(){var b=arcgisonline.sharing.util.urlToObject(document.URL);b.query=b.query||{};if(b.query.marker){var c=decodeURIComponent(b.query.marker).split(";");1===c.length&&(c=decodeURIComponent(b.query.marker).split(","));var d={TITLE:"",DESCRIPTION:"",IMAGE_URL:null,IMAGE_LINK_URL:null},l={VISIBLE:1,TYPEID:0,OBJECTID:0};if(2<=c.length&&6>=c.length&&!isNaN(c[0])&&!isNaN(c[1])){var h=parseFloat(c[0]),f=parseFloat(c[1]),r=4326;3<=c.length&&c[2].length&&!isNaN(c[2])&&(r=parseInt(c[2]));
var q="";4<=c.length&&(q=c[3],d.TITLE=q);var t=null;5<=c.length&&0===c[4].indexOf("http")&&(t=c[4]);q=null;6===c.length&&(q=c[5]);var w=function(v,x){var z=0,A=0;null!=arcgisonline.map.main.mapLods&&b.query.level?(A=parseInt(b.query.level),z=arcgisonline.map.main.mapLods[A].resolution*arcgisonline.map.main.map.width/2,A=arcgisonline.map.main.mapLods[A].resolution*arcgisonline.map.main.map.height/2):b.query.resolution?(A=parseFloat(b.query.resolution),z=A*arcgisonline.map.main.map.width/2,A=A*arcgisonline.map.main.map.height/
2):(z=arcgisonline.map.main.defaultExtent.getWidth()/2,A=arcgisonline.map.main.defaultExtent.getHeight()/2);v=new esri.geometry.Extent(v-z,x-A,v+z,x+A,arcgisonline.map.main.map.spatialReference);arcgisonline.map.main.initialExtent=v;arcgisonline.map.main.map.setExtent(v)};c=new esri.geometry.Point(h,f,new esri.SpatialReference({wkid:r}));t=esri.symbol.fromJson({type:"esriPMS",url:t,contentType:"image/png"});var u=null;q&&(u=esri.symbol.fromJson({color:[0,0,0,255],type:"esriTS",verticalAlignment:"baseline",
horizontalAlignment:"left",angle:0,xoffset:0,yoffset:0,rotated:!1,kerning:!0,font:{size:12,style:"normal",weight:"bold",family:"Arial"},text:q}));arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"community/groups?q\x3d"+esriGeowConfig.layerTemplatesGroupQuery).then(e.hitch(this,function(v,x,z,A,B,J){arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"search?num\x3d50\x26q\x3dgroup:"+J.results[0].id+' AND type:"Feature Collection Template"').then(e.hitch(this,function(P,R,S,T,
E,I){if(I.results&&0!==I.results.length){I.results.sort(function(D,C){return D.name==C.name?0:D.name<C.name?-1:1});arcgisonline.map.mapNotes.getMapNotesConfig(I.results[0].id,esri.i18nBundle.mapNotesDlg.mapNotes,!0);var F=e.connect(arcgisonline.map.main.map,"onLayersAddResult",e.hitch(this,function(D,C,y,G,L,O){for(var U=0;U<O.length;U++){var M=arcgisonline.map.main.getParameterList(O[U].layer);if(M.title===esri.i18nBundle.mapNotesDlg.mapNotes){e.disconnect(F);arcgisonline.map.main.projectPointToMapSpatialReference(D.x,
D.y,new esri.SpatialReference({wkid:D.spatialReference.wkid}),e.hitch(this,function(Q,Y,fa,va,Aa){D=new esri.geometry.Point(Aa[0].x,Aa[0].y,Aa[0].spatialReference);Q.url?arcgisonline.map.main.getPictureMarkerSize(Q.url).then(function(pa){Q.width=pa[0];Q.height=pa[1];M.layers[3].applyEdits([new esri.Graphic(D,Q,fa)]);Y&&(Y.xoffset=Q.width/2,Y.yoffset=Q.height/2,M.layers[2].applyEdits([new esri.Graphic(new esri.geometry.Point(D.toJson()),Y,va)]))},function(){var pa=window.location.href.substring(0,
window.location.href.indexOf(window.location.pathname)+window.location.pathname.lastIndexOf("/"))+"/images/EsriBluePinCircle26.png";Q=esri.symbol.fromJson({type:"esriPMS",url:pa,imageData:"iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDMjdDMDU2RTdEM0ExMUUzOTkyRUU3OTg1MDdCQzMzRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDMjdDMDU2RjdEM0ExMUUzOTkyRUU3OTg1MDdCQzMzRSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMyN0MwNTZDN0QzQTExRTM5OTJFRTc5ODUwN0JDMzNFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMyN0MwNTZEN0QzQTExRTM5OTJFRTc5ODUwN0JDMzNFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+aJP1/QAAAeNJREFUeNpi/P//PwM+IOdS4gCkEoA4AIj50aQ/AvEGIF7waE/PAXzmMOKzCGjJBGY2rnxeKQ0GNl5hBiAbRf7vr28Mvz6/Zfj87AaIPRFoWQHJFgEtKWDl4u8XVrNmYGRmRZH79uE1RDMTMwMLGzsDCysbw9tbRxl+f/tYCLRsAjbzmPD4toBfwRDDEmTw/99fht8/gL768Z0BpBakB5daFjwWybNyokYJLycLg6okN8PPLwwMN558YPj87TckCH//ZGAXEGVgYmaVJ8ciFOBjIs5Q6KvEwMMB0fLl+2+GjlWXGDYee0iUfiZiFBkp8TPUhqrBLQEBHk5WhpZ4YwZTNVG42L+/vymzKNJWGqdcrIsK9XyE7BN0wMvJSj2Lvvz4g1Pu8/ff1LNo+eGnOOUW77lDPYvO3fvI0Lz6ForPQKmuZuFZhtO3XhNlEdHJe8uZlwwHr76F5qOPKPmIqhZB4uMP2HewIogUwMRAJzBq0cBaxMjISJFFFz88OE/YAGYWBg4+YQao2ovkWOTw/e0jvJaBLGHnEWD4+PACA0gtSA/JFgGr5A/4LMNmCVQP6XGEyzJSLSHYCkJqqAgAqQOcwnL6AsC2AUgPKZYQbRG6ZSA+KZaQZBGyZbDEQqwlIAAQYACcTOWIFuSO8AAAAABJRU5ErkJggg\x3d\x3d",
width:26,height:26,yoffset:13,contentType:"image/png"});M.layers[3].applyEdits([new esri.Graphic(D,Q,fa)]);Y&&(Y.xoffset=13,Y.yoffset=13,M.layers[2].applyEdits([new esri.Graphic(new esri.geometry.Point(D.toJson()),Y,va)]))}):(Aa=window.location.href.substring(0,window.location.href.indexOf(window.location.pathname)+window.location.pathname.lastIndexOf("/"))+"/images/EsriBluePinCircle26.png",Q=esri.symbol.fromJson({type:"esriPMS",url:Aa,imageData:"iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDMjdDMDU2RTdEM0ExMUUzOTkyRUU3OTg1MDdCQzMzRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDMjdDMDU2RjdEM0ExMUUzOTkyRUU3OTg1MDdCQzMzRSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMyN0MwNTZDN0QzQTExRTM5OTJFRTc5ODUwN0JDMzNFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMyN0MwNTZEN0QzQTExRTM5OTJFRTc5ODUwN0JDMzNFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+aJP1/QAAAeNJREFUeNpi/P//PwM+IOdS4gCkEoA4AIj50aQ/AvEGIF7waE/PAXzmMOKzCGjJBGY2rnxeKQ0GNl5hBiAbRf7vr28Mvz6/Zfj87AaIPRFoWQHJFgEtKWDl4u8XVrNmYGRmRZH79uE1RDMTMwMLGzsDCysbw9tbRxl+f/tYCLRsAjbzmPD4toBfwRDDEmTw/99fht8/gL768Z0BpBakB5daFjwWybNyokYJLycLg6okN8PPLwwMN558YPj87TckCH//ZGAXEGVgYmaVJ8ciFOBjIs5Q6KvEwMMB0fLl+2+GjlWXGDYee0iUfiZiFBkp8TPUhqrBLQEBHk5WhpZ4YwZTNVG42L+/vymzKNJWGqdcrIsK9XyE7BN0wMvJSj2Lvvz4g1Pu8/ff1LNo+eGnOOUW77lDPYvO3fvI0Lz6ForPQKmuZuFZhtO3XhNlEdHJe8uZlwwHr76F5qOPKPmIqhZB4uMP2HewIogUwMRAJzBq0cBaxMjISJFFFz88OE/YAGYWBg4+YQao2ovkWOTw/e0jvJaBLGHnEWD4+PACA0gtSA/JFgGr5A/4LMNmCVQP6XGEyzJSLSHYCkJqqAgAqQOcwnL6AsC2AUgPKZYQbRG6ZSA+KZaQZBGyZbDEQqwlIAAQYACcTOWIFuSO8AAAAABJRU5ErkJggg\x3d\x3d",
width:26,height:26,yoffset:13,contentType:"image/png"}),M.layers[3].applyEdits([new esri.Graphic(D,Q,fa)]),Y&&(Y.xoffset=13,Y.yoffset=13,M.layers[2].applyEdits([new esri.Graphic(new esri.geometry.Point(D.toJson()),Y,va)])))},C,y,G,L));break}}},P,R,S,T,E))}},v,x,z,A,B))},c,t,u,d,l));arcgisonline.map.main.sameSpatialReference(arcgisonline.map.main.map.spatialReference,new esri.SpatialReference({wkid:r}))?w(h,f):arcgisonline.map.main.projectPointToMapSpatialReference(h,f,new esri.SpatialReference({wkid:r}),
e.hitch(this,function(v,x){w(v[0].x,v[0].y)}),e.hitch(this,function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,fitExtentCompletely)}))}}},cleanUpFailedServices:function(){for(var b=0;0<arcgisonline.map.main.mapLayers.length;){if(null==arcgisonline.map.main.mapLayers[b]){for(k=b;k<arcgisonline.map.main.mapLayers.length-1;k++)arcgisonline.map.main.mapLayers[k]=arcgisonline.map.main.mapLayers[k+1];--arcgisonline.map.main.mapLayers.length}if(b>=arcgisonline.map.main.mapLayers.length-
1)break;b++}},getNewMapExtent:function(b){var c=arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService),d=c?new esri.geometry.Extent(arcgisonline.map.main.map.extent.toJson()):arcgisonline.map.main.defaultExtent,l=b.intersects(d);if(l){var h=l.getWidth()*l.getHeight(),f=d.getWidth()*d.getHeight();h<f/200?l=!1:b.getWidth()*b.getHeight()<f/1E3&&(l=!1)}l&&arcgisonline.map.main.mapInitialized?b=arcgisonline.map.main.map.extent&&isNaN(arcgisonline.map.main.map.extent.xmin)?{extent:b,
zoomMap:!0}:{extent:d,zoomMap:!1}:(c?c=c.fullExtent:(l=arcgisonline.map.main.mapLayers[0],c=l.serviceInfo?arcgisonline.map.layer.parseServiceInfo(l.serviceInfo,l.url).extent:l.fullExtent),(l=b.intersects(c))?(arcgisonline.map.main.map&&arcgisonline.map.main.map.wrapAround180||(b.xmin<c.xmin&&(b=b.update(c.xmin,b.ymin,b.xmax,b.ymax,b.spatialReference)),b.xmax>c.xmax&&(b=b.update(b.xmin,b.ymin,c.xmax,b.ymax,b.spatialReference))),b.ymin<c.ymin&&(b=b.update(b.xmin,c.ymin,b.xmax,b.ymax,b.spatialReference)),
b.ymax>c.ymax&&(b=b.update(b.xmin,b.ymin,b.xmax,c.ymax,b.spatialReference)),b={extent:b,zoomMap:!0}):b={extent:d,zoomMap:!1});b.extent=arcgisonline.map.main.fitNewMapExtent(b.extent);return b},fitNewMapExtent:function(b){var c=[102113,102100,3857],d=b.spatialReference.wkid;if(4326!=d&&!e.indexOf(c,d))return b;var l=b;-1<e.indexOf(c,d)&&(l=arcgisonline.map.main.projectGeometries([b],b.spatialReference,new esri.SpatialReference({wkid:4326}))[0]);return-170>l.xmin&&170<l.xmax&&-80>l.ymin&&80<l.ymax?
(b=arcgisonline.map.main.adjustHeightToAspectRatio(b),arcgisonline.map.main.getExtentForNextTileLevel(b,arcgisonline.map.main.map.width,!0)):b},zoomMap:function(b,c,d,l){c=c?c:0;d=d?d:0;var h=e.connect(arcgisonline.map.main.map,"onExtentChange",e.hitch(this,function(){e.disconnect(h);l()})),f=arcgisonline.map.main.getScaleForExtent(b,arcgisonline.map.main.map.width);0<c&&f>c?(b=arcgisonline.map.main.adjustHeightToAspectRatio(b),c=arcgisonline.map.main.getExtentForScale(b,arcgisonline.map.main.map.width,
c),c.getWidth()<b.getWidth()&&(b=c),b=arcgisonline.map.main.getExtentForNextTileLevel(b,arcgisonline.map.main.map.width,!0)):0<d&&f<d&&(b=arcgisonline.map.main.adjustHeightToAspectRatio(b),c=arcgisonline.map.main.getExtentForScale(b,arcgisonline.map.main.map.width,d),c.getWidth()>b.getWidth()&&(b=c),b=arcgisonline.map.main.getExtentForNextTileLevel(b,arcgisonline.map.main.map.width,!1));c=arcgisonline.sharing.util.urlToObject(document.URL);c.query=c.query||{};if(!arcgisonline.map.main.mapInitialized)c.query.layers&&
(b=arcgisonline.map.main.getExtentForNextTileLevel(b,arcgisonline.map.main.map.width,!1)),arcgisonline.map.main.initMap(b);else if(arcgisonline.map.main.isMapFullyLoaded)arcgisonline.map.main.map.setExtent(b);else if(arcgisonline.map.main.isMapFullyLoaded||!c.query.center&&!c.query.extent)var r=0,q=setInterval(function(){arcgisonline.map.main.isMapFullyLoaded&&(clearInterval(q),arcgisonline.map.main.map.setExtent(b));r++;100<r&&clearInterval(q)},100)},projectToMapAndZoom:function(b,c,d,l){if(!b||
isNaN(b.xmin)||isNaN(b.ymin)||isNaN(b.xmax)||isNaN(b.ymax))arcgisonline.map.main.zoomMap(arcgisonline.map.main.defaultExtent,c,d,l);else{var h=arcgisonline.map.main.map.spatialReference;null==h&&(h=arcgisonline.map.main.defaultExtent.spatialReference);arcgisonline.map.main.sameSpatialReference(h,b.spatialReference)?(b=arcgisonline.map.main.getNewMapExtent(b),b.zoomMap?arcgisonline.map.main.zoomMap(b.extent,c,d,l):(arcgisonline.map.main.mapInitialized||arcgisonline.map.main.initMap(),l())):arcgisonline.map.main.projectToMapSpatialReference(b,
e.hitch(this,function(f,r){f=arcgisonline.map.main.getNewMapExtent(f[0]);f.zoomMap?arcgisonline.map.main.zoomMap(f.extent,c,d,l):(arcgisonline.map.main.mapInitialized||arcgisonline.map.main.initMap(),l())}),e.hitch(this,function(f,r){arcgisonline.map.main.zoomMap(arcgisonline.map.main.defaultExtent,c,d,l)}))}},adjustHeightToAspectRatio:function(b){var c=b.getWidth()*(arcgisonline.map.main.map.height/arcgisonline.map.main.map.width)/5;e.mixin(b,{ymin:b.getCenter().y-c,ymax:b.getCenter().y+c});return b},
getExtentForScale:function(b,c,d){var l=20015077/180,h=esri.config.defaults,f=esri.WKIDUnitConversion,r=b.spatialReference;if(r){var q=r.wkid;var t=r.wkt}r=null;q?r=f.values[f[q]]:t&&-1!==t.search(/^PROJCS/i)&&(f=/UNIT\[([^\]]+)\]\]$/i.exec(t))&&f[1]&&(r=parseFloat(f[1].split(",")[1]));return b.expand(d*c/(39.37*(r||l)*h.screenDPI)/b.getWidth())},getExtentFromCenter:function(b,c,d){b=new esri.geometry.Extent(b.x-1,b.y-.5,b.x+1,b.y+.5,b.spatialReference);return arcgisonline.map.main.getExtentForScale(b,
c,d)},getScaleForExtent:function(b,c){var d=20015077/180,l=esri.config.defaults,h=esri.WKIDUnitConversion,f=b.spatialReference;if(f){var r=f.wkid;var q=f.wkt}f=null;r?f=h.values[h[r]]:q&&-1!==q.search(/^PROJCS/i)&&(h=/UNIT\[([^\]]+)\]\]$/i.exec(q))&&h[1]&&(f=parseFloat(h[1].split(",")[1]));return b.getWidth()/c*(f||d)*39.37*l.screenDPI},getExtentForNextTileLevel:function(b,c,d){if(null!=arcgisonline.map.main.mapLods){c=b.getWidth()/c;for(var l=arcgisonline.map.main.mapLods,h=l[l.length-1].resolution,
f=0;f<l.length;f++)if(l[f].resolution<c){h=d?l[f].resolution:0==f?l[0].resolution:l[f-1].resolution;break}return b.expand(h/c*.9)}return b},getExtentForCloseTileLevel:function(b,c){if(null!=arcgisonline.map.main.mapLods){c=b.getWidth()/c;for(var d=arcgisonline.map.main.mapLods,l=0;l<d.length-1;l++)if(d[l].resolution>c&&d[l+1].resolution<c){var h=(d[l].resolution-d[l+1].resolution)/10;if(d[l].resolution<c+h)return b.expand(d[l].resolution/c*.9);if(d[l+1].resolution>c-h)return b.expand(d[l+1].resolution/
c*.9);break}}return b},getIntersectionPercent:function(b,c){var d=new e.Deferred;if(!c)return d.callback(0),d;if(c.spatialReference._isWrappable())esri.geometry.normalizeCentralMeridian([c],null,e.hitch(this,function(f){if(f[0].rings){var r=(new esri.geometry.Polygon(c.spatialReference)).addRing(f[0].rings[0]).getExtent();f=(new esri.geometry.Polygon(c.spatialReference)).addRing(f[0].rings[1]).getExtent();c=r.getWidth()>f.getWidth()?r:f}else c=f[0];(r=c.intersects(b))?(r=r.getWidth()*r.getHeight(),
f=c.getWidth()*c.getHeight(),d.callback(r/f*100)):d.callback(0)}),function(){d.callback(0)});else{var l=c.intersects(b);if(l){l=l.getWidth()*l.getHeight();var h=c.getWidth()*c.getHeight();d.callback(l/h*100)}else d.callback(0)}return d},zoomToLayerScale:function(b){if(b.layers){var c=-1*Number.MAX_VALUE,d=Number.MAX_VALUE;e.forEach(b.layers,e.hitch(this,function(l){var h=l.minScale||0;l=l.maxScale||0;c=0===c||0===h?0:Math.max(c,h);d=Math.min(d,l)}));arcgisonline.map.main.zoomToScale(c,d)}else b.layer&&
arcgisonline.map.main.zoomToScale(b.layer.minScale,b.layer.maxScale)},zoomToScale:function(b,c,d){var l=arcgisonline.map.main.map.getScale();0<b&&l>b?(b=arcgisonline.map.main.getScaleForNextTileLevel(b,!0),d?(c=arcgisonline.map.main.getExtentFromCenter(arcgisonline.map.main.map.extent.getCenter(),arcgisonline.map.main.map.width,b),(c=c.intersects(d))?arcgisonline.map.main.map.setScale(b):(c=arcgisonline.map.main.getExtentFromCenter(d.getCenter(),arcgisonline.map.main.map.width,b),arcgisonline.map.main.map.setExtent(c))):
arcgisonline.map.main.map.setScale(b)):l<c&&(b=arcgisonline.map.main.getScaleForNextTileLevel(c,!1),d?(c=arcgisonline.map.main.getExtentFromCenter(arcgisonline.map.main.map.extent.getCenter(),arcgisonline.map.main.map.width,b),(c=c.intersects(d))?arcgisonline.map.main.map.setScale(b):(c=arcgisonline.map.main.getExtentFromCenter(d.getCenter(),arcgisonline.map.main.map.width,b),arcgisonline.map.main.map.setExtent(c))):arcgisonline.map.main.map.setScale(b))},zoomMapConsiderScale:function(b,c,d){if(b.layers){var l=
-1*Number.MAX_VALUE;var h=Number.MAX_VALUE;e.forEach(b.layers,e.hitch(this,function(f){var r=f.minScale||0;f=f.maxScale||0;l=0===l||0===r?0:Math.max(l,r);h=Math.min(h,f)}))}else b.layer&&(l=b.layer.minScale||0,h=b.layer.maxScale||0,b.layer.dynamicLayerInfos&&arcgisonline.map.main.hasDynamicLayers(b)?(b=arcgisonline.map.dijit.toc.scale.mergeSubLayerScales(b.layer.dynamicLayerInfos,b.layer.layerInfos,b),b=arcgisonline.map.dijit.toc.scale.mergeScale(b.minScale,b.maxScale,l,h),l=b.minScale,h=b.maxScale):
b.layer.layerInfos&&b.layer.layerInfos.length&&(b.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer||b.layer instanceof esri.layers.ArcGISTiledMapServiceLayer)?(b=arcgisonline.map.dijit.toc.scale.mergeSubLayerScales(b.layer.layerInfos,null,b),b=arcgisonline.map.dijit.toc.scale.mergeScale(b.minScale,b.maxScale,l,h),l=b.minScale,h=b.maxScale):b.layer.folders&&(b=arcgisonline.map.dijit.toc.scale.mergeSubLayerScales(b.layer.folders,null,b),b=arcgisonline.map.dijit.toc.scale.mergeScale(b.minScale,
b.maxScale,l,h),l=b.minScale,h=b.maxScale));b=arcgisonline.map.main.map.getScale();0<l&&b>l?(l=arcgisonline.map.main.getScaleForNextTileLevel(l,!0),d=arcgisonline.map.main.adjustHeightToAspectRatio(c),d=arcgisonline.map.main.getExtentForScale(d,arcgisonline.map.main.map.width,l),arcgisonline.map.main.map.setExtent(d)):b<h?(h=arcgisonline.map.main.getScaleForNextTileLevel(h,!1),d=arcgisonline.map.main.adjustHeightToAspectRatio(c),d=arcgisonline.map.main.getExtentForScale(c,arcgisonline.map.main.map.width,
h),arcgisonline.map.main.map.setExtent(d)):d?arcgisonline.map.main.zoomMap(c,l,h,function(){}):(b=arcgisonline.map.main.getNewMapExtent(c),b.zoomMap&&arcgisonline.map.main.zoomMap(c,l,h,function(){}))},getScaleForNextTileLevel:function(b,c){if(null!=arcgisonline.map.main.mapLods){var d=arcgisonline.map.main.mapLods;if(c){for(c=0;c<d.length;c++)if(d[c].scale<b)return d[c].scale-1;return d[d.length-1].scale-1}for(c=d.length-1;0<=c;c--)if(d[c].scale>b)return d[c].scale+1;return d[0].scale+1}return b},
checkSuggestedScaleRangeAndZoom:function(b){return arcgisonline.map.main.checkSuggestedScaleRange(b,!0)},checkSuggestedScaleRange:function(b,c){var d=new e.Deferred;if(b.layer)arcgisonline.map.main.checkSuggestedScaleRangePerLayer(b.layer,c).then(function(h){b.scaleChanged=!0;if(c){var f=arcgisonline.map.featColl.isFeatureCollection(b)?arcgisonline.map.featColl.getLayerFullExtent(b.layer):new esri.geometry.Extent(b.layer.fullExtent.toJson());arcgisonline.map.main.sameSpatialReference(arcgisonline.map.main.map.spatialReference,
f.spatialReference)?(h.scaleAtFullExtent&&(f=arcgisonline.map.main.getExtentFromCenter(f.getCenter(),arcgisonline.map.main.map.width,h.scaleAtFullExtent)),arcgisonline.map.main.map.setExtent(f)):arcgisonline.map.main.projectToMapSpatialReference(f,e.hitch(this,function(r,q){r&&0<r.length&&r[0]&&"extent"==r[0].type&&(f=r[0],h.scaleAtFullExtent&&(f=arcgisonline.map.main.getExtentFromCenter(f.getCenter(),arcgisonline.map.main.map.width,h.scaleAtFullExtent)),arcgisonline.map.main.map.setExtent(f))}))}d.resolve(h)},
function(){if(c){var h=arcgisonline.map.featColl.isFeatureCollection(b)?arcgisonline.map.featColl.getLayerFullExtent(b.layer):new esri.geometry.Extent(b.layer.fullExtent.toJson());arcgisonline.map.main.zoomMapConsiderScale(b,h)}d.resolve()});else if(b.layers){var l;e.forEach(b.layers,function(h,f){arcgisonline.map.main.checkSuggestedScaleRangePerLayer(h,c).then(function(r){b.scaleChanged=!0;r.scaleAtFullExtent&&(!esri.isDefined(l)||l<r.scaleAtFullExtent)&&(l=r.scaleAtFullExtent);if(f===b.layers.length-
1){if(r&&r.center){var q=arcgisonline.map.featColl.getFullExtent(b);esri.isDefined(l)&&(q=arcgisonline.map.main.getExtentFromCenter(q.getCenter(),arcgisonline.map.main.map.width,l));arcgisonline.map.main.map.setExtent(q)}else b.layer&&(q=arcgisonline.map.featColl.getLayerFullExtent(b.layer),arcgisonline.map.main.zoomMapConsiderScale(b,q));r.scaleAtFullExtent=l;d.resolve(r)}},function(){if(c&&0===f){var r=arcgisonline.map.featColl.getLayerFullExtent(b.layers[0]);arcgisonline.map.main.zoomMapConsiderScale(b,
r)}f===b.layers.length-1&&d.resolve()})})}return d},checkSuggestedScaleRangePerLayer:function(b,c){var d=new e.Deferred;if(!(b instanceof esri.layers.FeatureLayer)||b instanceof esri.layers.StreamLayer)d.reject();else return 0===b.minScale&&0===b.maxScale&&b.addPlugin("esri/plugins/FeatureLayerStatistics").then(e.hitch(this,function(){b.statisticsPlugin.getSuggestedScaleRange({map:arcgisonline.map.main.map}).then(function(l){b.setScaleRange(l.relaxedMinScale,l.maxScale);d.resolve(l)},function(l){d.reject()})})),
d},addLayerFromFile:function(){arcgisonline.map.main.isReadOnlyMode()||arcgisonline.sharing.dijit.dialog.AddLayerFromFileDlg.prototype.statics.getInstance().show()},addLayerFromUrl:function(){arcgisonline.map.main.isReadOnlyMode()||arcgisonline.sharing.dijit.dialog.AddLayerFromUrlDlg.prototype.statics.getInstance().show()},openLeftDefaultPanel:function(){arcgisonline.map.main.isReadOnlyMode()||(arcgisonline.sharing.util.isLoggedIn()&&esriGeowConfig.userRole&&!esriGeowConfig.userRole.canCreateItem()?
arcgisonline.map.leftPanel.openLeftAddContentPanel(null,{forceSection:"myOrganization"}):arcgisonline.map.leftPanel.openLeftAddContentPanel())},browseLayers:function(){arcgisonline.map.main.isReadOnlyMode()||arcgisonline.map.leftPanel.openLeftAddContentPanel(null,{forceSection:"livingAtlas"})},browseProvisionedListings:function(){arcgisonline.map.main.isReadOnlyMode()||arcgisonline.map.leftPanel.openLeftAddContentPanel(null,{forceSection:"subscription"})},requireAuthentication:function(b){if(1==arcgisonline.sharing.util.isLoggedIn())return!0;
arcgisonline.map.storage.saveMapInCookie(b,!0,null,null,e.hitch(this,function(){var c="";-1==esriGeowConfig.signin.indexOf("http")&&(c=esriGeowConfig.baseUrl,!1!==esriGeowConfig.useSSL&&(c=arcgisonline.sharing.util.getSecureUrl(c)));c+=esriGeowConfig.signin;c+="?error\x3d403\x26returnUrl\x3d"+esriGeowConfig.baseUrl+esriGeowConfig.webmapViewerPath+"?useExisting\x3d1";window.location=c}));return!1},signInWithPopup:function(){arcgisonline.map.main.signInWithOAuth().then(function(b){var c=b.reloadRequired,
d=b.oAuthInfo;c&&arcgisonline.map.main.mapHasChanged&&arcgisonline.map.role.isAllowed("tool_save")&&arcgisonline.map.main.appAccess?(arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.viewer.webMap,message:esri.i18nBundle.viewer.main.unsavedChangesDoSave,choiceOneTitle:esri.i18nBundle.viewer.main.unsavedChangesYesBtn,choiceOneHandler:e.hitch(this,function(){var l=arcgisonline.sharing.util.getUser();null==arcgisonline.map.save_open.webMapInfo||arcgisonline.map.save_open.webMapInfo.owner!==
l.username&&"admin"!==arcgisonline.map.save_open.webMapInfo.itemControl&&"update"!==arcgisonline.map.save_open.webMapInfo.itemControl?arcgisonline.map.storage.canSaveWithBing()&&(l=arcgisonline.sharing.dijit.dialog.SaveWebMapDlg.prototype.statics.getInstance(),e.subscribe("onWebMapSave",null,e.hitch(arcgisonline.map.storage,"onWebMapSave")),l.addWebMapItem(arcgisonline.map.main.mapLayers,arcgisonline.map.main.map.extent,arcgisonline.map.save_open.folderId,arcgisonline.map.save_open.webMapInfo,function(h){arcgisonline.map.main.redirectToCustomURL(h,
!1,d)},function(){arcgisonline.map.main.redirectToCustomURL(null,!1,d)})):arcgisonline.map.storage.saveExistingWebMap(null,function(h){arcgisonline.map.main.redirectToCustomURL(h,!1,d)},function(){arcgisonline.map.main.redirectToCustomURL(null,!1,d)})}),choiceTwoTitle:esri.i18nBundle.viewer.main.unsavedChangesNoBtn,choiceTwoHandler:e.hitch(this,function(){arcgisonline.map.main.redirectToCustomURL(null,!1,d)})}),b=esri.i18nBundle.viewer.main.unsavedChangesYesBtn.length+esri.i18nBundle.viewer.main.unsavedChangesNoBtn.length,
e.style(e.byId("choice-dialog"),"width",Math.min(10*b+150,650)+"px")):c&&arcgisonline.map.main.redirectToCustomURL(null,!1,d)});return!1},signInWithPopupAndSave:function(b){if(arcgisonline.sharing.util.isLoggedIn())return arcgisonline.map.storage.saveWebMapClick(b),!0;arcgisonline.map.main.signInWithOAuth().then(e.hitch(this,function(c,d){var l=d.oAuthInfo;if(arcgisonline.map.main.appAccess)if(arcgisonline.map.role.isAllowed("tool_save"))arcgisonline.map.storage.saveWebMapClick(c,function(f){arcgisonline.map.main.redirectToCustomURL(f,
!0,l)},function(){arcgisonline.map.main.redirectToCustomURL(null,!1,l)});else{c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.cannotSaveMap});var h=e.connect(c,"onHide",function(){e.disconnect(h);arcgisonline.map.main.redirectToCustomURL(null,!1,l)})}else arcgisonline.map.main.redirectToCustomURL(null,!1,l)},b));return!1},signInWithOAuth:function(b){var c=new e.Deferred;window.checkOAuthResponse=
e.hitch(arcgisonline.map.main,"checkOAuthResponse");var d=esriGeowConfig.restBaseUrl.substring(0,esriGeowConfig.restBaseUrl.indexOf("/",8)).replace("http://","https://");esriGeowConfig.self.portalHostname&&(d="https://"+esriGeowConfig.self.portalHostname);b=new esri.arcgis.OAuthInfo({appId:"arcgisonline",portalUrl:d,minTimeUntilExpiration:525949,forceLogin:!0,showSocialLogins:!0,locale:e.locale,flowType:"authorization-code",popup:!0,popupCallbackUrl:"viewer_oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,resizable,scrollbars",
msg:esri.i18nBundle.viewer.main.oAuthSignInMsg});esri.id.registerOAuthInfos([b]);esri.id.useSignInPage=!1;esri.id.getCredential(d+"/sharing",{oAuthPopupConfirmation:!1}).then(function(l){var h=new esri.arcgis.Portal(d);h.signIn().then(function(f){arcgisonline.sharing.geow.Account.setupAfterSelf(h);esri.id.useSignInPage=!0;arcgisonline.sharing.util.parseUrl(d).host===arcgisonline.sharing.util.parseUrl(esriGeowConfig.restBaseUrl).host||esriGeowConfig.self.urlKey&&esriGeowConfig.self.customBaseUrl&&
arcgisonline.sharing.util.parseUrl(esriGeowConfig.restBaseUrl).host===esriGeowConfig.self.urlKey+"."+esriGeowConfig.self.customBaseUrl||(esriGeowConfig.restBaseUrl=esriGeowConfig.restBaseUrl.replace(arcgisonline.sharing.util.parseUrl(esriGeowConfig.restBaseUrl).host,arcgisonline.sharing.util.parseUrl(d).host));e.topic.publish("onSignIn",[esriGeowConfig.userInfo]);var r=!1;f=arcgisonline.sharing.util.parseUrl(document.location.href).host;var q=esriGeowConfig.self;!q.isPortal&&(f===q.portalHostname||
q.urlKey&&q.customBaseUrl&&f!==q.urlKey+"."+q.customBaseUrl||!q.urlKey&&f!==q.portalHostname)&&(q.urlKey&&q.customBaseUrl?-1===f.indexOf(q.urlKey+"."+q.customBaseUrl)&&(r=!0):q.urlKey||(r=!0));!esriGeowConfig.userInfo.token&&esriGeowConfig.userInfo.credential&&(esriGeowConfig.userInfo.token=esriGeowConfig.userInfo.credential.token);var t=function(u){arcgisonline.map.role.clearUserActions();arcgisonline.map.role.setupUserActions();arcgisonline.map.main.loggedIn();arcgisonline.map.main.updateHeaderLinks();
arcgisonline.map.role.updateUserActionWithWebmap();arcgisonline.map.save_open.webMapInfo||arcgisonline.map.save_open.itemCard||arcgisonline.map.leftPanel.recreateAboutStack();e.forEach(arcgisonline.map.main.mapLayers,function(x){x.layer&&x.serviceInfo&&x.serviceInfo.ownershipBasedAccessControlForFeatures&&!1===x.serviceInfo.ownershipBasedAccessControlForFeatures.allowOthersToQuery&&arcgisonline.map.main.reloadFeatureLayer(x)});var v=arcgisonline.sharing.util.getUser();arcgisonline.map.save_open.webMapInfo&&
arcgisonline.map.save_open.webMapInfo.owner!==v.username?arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+arcgisonline.map.save_open.webMapInfo.id,e.hitch(this,function(x,z){arcgisonline.map.save_open.webMapItemCard=x;arcgisonline.map.save_open.webMapInfo.itemControl=x.itemControl;arcgisonline.map.role.updateUserActionAfterOAuth();u.callback({reloadRequired:r,oAuthInfo:l})}),e.hitch(this,function(x,z){u.callback({reloadRequired:r,oAuthInfo:l})})):(r||("contentStack"==
arcgisonline.map.leftPanel.getLeftContentPanelStack()?leftPanel.reloadVisibleTOC():leftPanel.deleteContentStack()),u.callback({reloadRequired:r,oAuthInfo:l}))},w=arcgisonline.sharing.util.getUser();w.accountId?arcgisonline.map.main.checkAppAccess().then(e.hitch(this,function(){t(c)}),e.hitch(this,function(){if(r)c.callback({reloadRequired:r,oAuthInfo:l});else{arcgisonline.map.main.loggedIn();arcgisonline.map.main.updateHeaderLinks();var u=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
u.show({title:esri.i18nBundle.viewer.error.notLicensedTitle,message:e.string.substitute(esri.i18nBundle.viewer.error.notLicensed,{username:w.username})});var v=e.aspect.before(u._dialog,"hide",e.hitch(this,function(){v.remove();c.callback({reloadRequired:r,oAuthInfo:l})}))}})):t(c)}).otherwise(function(f){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.cannotSignInOAuth});esri.id.useSignInPage=
!0;c.errback()})}).otherwise(function(l){-1<l.message.indexOf("sufficient user license type")?(l=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),l.show({title:esri.i18nBundle.viewer.error.notLicensedTitle,message:esri.i18nBundle.viewer.error.notLicensedMsg}),c.errback()):"ABORTED"!==l.message&&(l=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),l.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.cannotSignInOAuth}),
c.errback())});return c},checkOAuthResponse:function(b){},redirectToCustomURL:function(b,c,d){d=esriGeowConfig.self;c=document.location.href;b?c=esriGeowConfig.baseUrl+esriGeowConfig.webmapViewerPath+"?webmap\x3d"+b:-1<c.indexOf("useExisting\x3d1")&&(b=arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.id:null)&&(c=esriGeowConfig.baseUrl+esriGeowConfig.webmapViewerPath+"?webmap\x3d"+b);b=arcgisonline.sharing.util.parseUrl(c).host;!d.isPortal&&(b===d.portalHostname||d.urlKey&&
d.customBaseUrl&&b!==d.urlKey+"."+d.customBaseUrl||!d.urlKey&&b!==d.portalHostname)&&(d.urlKey&&d.customBaseUrl?-1===b.indexOf(d.urlKey+"."+d.customBaseUrl)&&(arcgisonline.map.storage.deleteMapStorageNoFeedback(),c=c.replace(b,d.urlKey+"."+d.customBaseUrl)):d.urlKey||(arcgisonline.map.storage.deleteMapStorageNoFeedback(),c=c.replace(b,d.portalHostname)));c=d.allSSL?c.replace("http:","https:"):c;b=esriGeowConfig.self.user.culture&&e.locale!==esriGeowConfig.self.user.culture;if(c!==document.location.href||
b)arcgisonline.sharing.util.parseUrl(c).host!==arcgisonline.sharing.util.parseUrl(document.location.href).host||b?window.location=c:"undefined"!==typeof history.pushState?window.history.pushState(null,null,c):window.location.href!==c&&(window.location=c)},checkAppAccess:function(){var b=new e.Deferred;isEmbedded?(arcgisonline.map.main.appAccess=!0,b.callback()):esri.isDefined(arcgisonline.map.main.appAccess)?arcgisonline.map.main.appAccess?b.callback():b.errback():esri.id.checkAppAccess(esriGeowConfig.restBaseUrl,
"arcgisWebApps").then(e.hitch(this,function(){arcgisonline.map.main.appAccess=!0;b.callback()}),e.hitch(this,function(){arcgisonline.map.main.appAccess=!1;b.errback()}));return b},checkAccessToViewer:function(){var b=arcgisonline.sharing.util.getUser();if(b&&b.accountId){var c=arcgisonline.sharing.util.urlToObject(document.URL);!c.query||c.query.layers||c.query.webmap?esri.isDefined(arcgisonline.map.main.appAccess)||arcgisonline.map.main.checkAppAccess():arcgisonline.map.main.checkAppAccess().then(e.hitch(this,
function(){}),e.hitch(this,function(){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.viewer.error.notLicensedTitle,message:e.string.substitute(esri.i18nBundle.viewer.error.notLicensed,{username:b.username})})}))}else arcgisonline.map.main.appAccess=!0},linkToMap:function(b){arcgisonline.map.main.onShareStatusChangeHandler||(arcgisonline.map.main.onShareStatusChangeHandler=e.subscribe("onShareStatusChange",e.hitch(this,function(f){arcgisonline.map.save_open.webMapItemCard.access=
f.access})));if(null==arcgisonline.map.save_open.webMapInfo){var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.show({title:esri.i18nBundle.sharingDlg.sharingDlgTitle,message:esri.i18nBundle.viewer.error.cantShare})}else{var d=!1;arcgisonline.map.main.mapLayers[0].layer instanceof esri.virtualearth.VETiledLayer&&(d=!0);var l=!1;arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.presentation&&arcgisonline.map.save_open.openedWebMap.presentation.slides&&
0<arcgisonline.map.save_open.openedWebMap.presentation.slides.length&&(l=!0);var h=!1;e.forEach(arcgisonline.map.main.mapLayers,function(f){f.itemCard&&(-1<e.indexOf(f.itemCard.typeKeywords,"Requires Credits")||-1<e.indexOf(f.itemCard.typeKeywords,"Requires Subscription"))&&(h=!0)});c=arcgisonline.sharing.util.getUser();!c||arcgisonline.map.save_open.webMapInfo.owner!==c.username&&"admin"!==arcgisonline.map.save_open.webMapInfo.itemControl&&"update"!==arcgisonline.map.save_open.webMapInfo.itemControl?
(c=arcgisonline.sharing.dijit.dialog.ShareMapDlg.prototype.statics.getInstance(),c.show(arcgisonline.map.save_open.webMapInfo.id,arcgisonline.map.save_open.webMapInfo.owner,arcgisonline.map.save_open.folderId,arcgisonline.map.save_open.webMapInfo.title,d,l,b,h)):null==arcgisonline.map.save_open.folderTitle?arcgisonline.map.storage.getItemFolder(e.hitch(this,function(f,r){arcgisonline.sharing.dijit.dialog.ShareMapDlg.prototype.statics.getInstance().show(arcgisonline.map.save_open.webMapInfo.id,arcgisonline.map.save_open.webMapInfo.owner,
arcgisonline.map.save_open.folderId,arcgisonline.map.save_open.webMapInfo.title,d,l,b,h)})):(c=arcgisonline.sharing.dijit.dialog.ShareMapDlg.prototype.statics.getInstance(),c.show(arcgisonline.map.save_open.webMapInfo.id,arcgisonline.map.save_open.webMapInfo.owner,arcgisonline.map.save_open.folderId,arcgisonline.map.save_open.webMapInfo.title,d,l,b,h))}},projectToMapSpatialReference:function(b,c,d){var l=arcgisonline.map.main.map.spatialReference;null==l&&(l=arcgisonline.map.main.defaultExtent.spatialReference);
arcgisonline.map.main.projectExtent(b,l,c,d)},projectWrapAroundExtent:function(b,c,d,l){var h=b.spatialReference.wkid,f=c.wkid;(h||f)&&h!==f||arcgisonline.map.main.doProject(b,c,d,l);var r=h&&4326==h,q=f&&4326==f,t=[102113,102100,3857];h=h&&arcgisonline.map.main.contains(t,h);f=f&&arcgisonline.map.main.contains(t,f);r||h||!q&&!f?arcgisonline.map.main.doProject(b,c,d,l):arcgisonline.map.main.doProjectWrapAround(b,c,d,l)},doProjectWrapAround:function(b,c,d,l){arcgisonline.map.main.geometryService||
(arcgisonline.map.main.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url));var h=new esri.geometry.Polygon(b.spatialReference.toJson());h.addRing([[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]);arcgisonline.map.main.geometryService.project([h],c,function(f,r){var q=f[0];q.rings&&2!==q.rings.length?d([q.getExtent()],r):q.rings&&2==q.rings.length?(f=new esri.geometry.Polygon(q.toJson()),q.removeRing(1),f.removeRing(0),q=
q.getExtent(),f=f.getExtent(),q.getWidth()>f.getWidth()?(q.xmin<f.xmin?q.xmin-=f.getWidth():q.xmax+=f.getWidth(),d([q],r)):(f.xmin<q.xmin?f.xmin-=q.getWidth():f.xmax+=q.getWidth(),d([f],r))):l&&l()},l)},projectExtent:function(b,c,d,l){arcgisonline.map.main.doProject(b,c,d,l)},projectPointToMapSpatialReference:function(b,c,d,l,h){var f=arcgisonline.map.main.map.spatialReference;null==f&&(f=arcgisonline.map.main.defaultExtent.spatialReference);b=new esri.geometry.Point(b,c,d);arcgisonline.map.main.doProject(b,
f,l,h)},doProject:function(b,c,d,l){var h=[102113,102100,3857];if(b.spatialReference.wkid===c.wkid)d([b],null);else if(null!=b.spatialReference.wkid&&4326==b.spatialReference.wkid&&null!=c.wkid&&arcgisonline.map.main.contains(h,c.wkid)){b.ymin=Math.max(b.ymin,-89.99);b.ymax=Math.min(b.ymax,89.99);b=esri.geometry.geographicToWebMercator(b);if((h=b.spatialReference._getInfo())&&b.xmin>b.xmax){var f=h.valid[1]-b.xmin,r=b.xmax-h.valid[0];f>r?b.xmax=h.valid[1]+r:b.xmin=h.valid[0]-f}b.spatialReference.wkid=
c.wkid;d([b],null)}else if(null!=b.spatialReference.wkid&&arcgisonline.map.main.contains(h,b.spatialReference.wkid)&&null!=c.wkid&&4326==c.wkid)b=esri.geometry.webMercatorToGeographic(b),(h=b.spatialReference._getInfo())&&b.xmin>b.xmax&&(f=h.valid[1]-b.xmin,r=b.xmax-h.valid[0],f>r?b.xmax=h.valid[1]+r:b.xmin=h.valid[0]-f),d([b],null);else{arcgisonline.map.main.geometryService||(arcgisonline.map.main.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url));if(arcgisonline.map.main.map&&
arcgisonline.map.main.map.wrapAround180&&"extent"===b.type){var q=b;b=esri.geometry.Polygon.fromExtent(b)}arcgisonline.map.main.geometryService.project([b],c,function(t,w){if(!(t&&0<t.length&&t[0]&&"extent"==t[0].type)||isNaN(t[0].xmin)||isNaN(t[0].ymin)||isNaN(t[0].xmax)||isNaN(t[0].ymax))if(t&&0<t.length&&t[0]&&"point"==t[0].type&&!isNaN(t[0].x)&&!isNaN(t[0].y))d(t,w);else if(q&&"polygon"===t[0].type&&0<t[0].rings.length&&t[0].rings[0]){if(1===t[0].rings.length)t[0]=new esri.geometry.Extent(t[0].getExtent());
else{var u=(new esri.geometry.Polygon(t[0].spatialReference.toJson())).addRing(t[0].rings[0]).getExtent(),v=(new esri.geometry.Polygon(t[0].spatialReference.toJson())).addRing(t[0].rings[1]).getExtent();t[0]=v;t[0].xmin=v.xmin-u.getWidth();t[0].ymin=Math.min(v.ymin,u.ymin);t[0].ymax=Math.max(v.ymax,u.ymax)}d(t,w)}else"polygon"===t[0].type&&0<t[0].rings.length&&t[0].rings[0]?d(t,w):l&&l();else d(t,w)},l)}},projectJsonGeometries:function(b,c,d,l,h,f){0===b.length&&h(null);var r=esri.geometry.getGeometryType(c),
q=[];e.forEach(b,function(t){t=new r(t);t.spatialReference=d;q.push(t)},this);c=[102113,102100,3857];d.wkid&&4326==d.wkid&&l.wkid&&arcgisonline.map.main.contains(c,l.wkid)?(e.forEach(q,function(t){t.xmin?(t.xmin=Math.max(t.xmin,-180),t.xmax=Math.min(t.xmax,180),t.ymin=Math.max(t.ymin,-89.99),t.ymax=Math.min(t.ymax,89.99)):t.rings?e.forEach(t.rings,function(w){e.forEach(w,function(u){u[0]=Math.min(Math.max(u[0],-180),180);u[1]=Math.min(Math.max(u[1],-89.99),89.99)},this)},this):t.paths?e.forEach(t.paths,
function(w){e.forEach(w,function(u){u[0]=Math.min(Math.max(u[0],-180),180);u[1]=Math.min(Math.max(u[1],-89.99),89.99)},this)},this):t.x&&(t.x=Math.min(Math.max(t.x,-180),180),t.y=Math.min(Math.max(t.y,-89.99),89.99))},this),b=[],e.forEach(q,function(t){t=esri.geometry.geographicToWebMercator(t);102100!==l.wkid&&(t.spatialReference=l);b.push(t.toJson())},this),h(b)):null!=d.wkid&&arcgisonline.map.main.contains(c,d.wkid)&&null!=l.wkid&&4326==l.wkid?(b=[],e.forEach(q,function(t){b.push(esri.geometry.webMercatorToGeographic(t).toJson())},
this),h(b)):(arcgisonline.map.main.geometryService||(arcgisonline.map.main.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url)),arcgisonline.map.main.geometryService.project(q,l,e.hitch(this,function(t,w){t&&t.length===b.length?(b=[],e.forEach(t,function(u){u&&(u.rings&&0<u.rings.length&&0<u.rings[0].length&&0<u.rings[0][0].length&&!isNaN(u.rings[0][0][0])&&!isNaN(u.rings[0][0][1])||u.paths&&0<u.paths.length&&0<u.paths[0].length&&0<u.paths[0][0].length&&
!isNaN(u.paths[0][0][0])&&!isNaN(u.paths[0][0][1])||u.xmin&&!isNaN(u.xmin)&&u.ymin&&!isNaN(u.ymin)||u.x&&!isNaN(u.x)&&u.y&&!isNaN(u.y))?b.push(u.toJson()):b.push(null)},this),h(b)):f&&f(t,w)}),f))},projectGeometries:function(b,c,d,l,h){if(0===b.length)if(l)l(null);else return null;var f=[102113,102100,3857];if(c.wkid&&4326==c.wkid&&d.wkid&&arcgisonline.map.main.contains(f,d.wkid)){e.forEach(b,function(q){q.xmin?(q.xmin=Math.max(q.xmin,-180),q.xmax=Math.min(q.xmax,180),q.ymin=Math.max(q.ymin,-89.99),
q.ymax=Math.min(q.ymax,89.99)):q.rings?e.forEach(q.rings,function(t){e.forEach(t,function(w){w[0]=Math.min(Math.max(w[0],-180),180);w[1]=Math.min(Math.max(w[1],-89.99),89.99)},this)},this):q.paths?e.forEach(q.paths,function(t){e.forEach(t,function(w){w[0]=Math.min(Math.max(w[0],-180),180);w[1]=Math.min(Math.max(w[1],-89.99),89.99)},this)},this):q.x&&(q.x=Math.min(Math.max(q.x,-180),180),q.y=Math.min(Math.max(q.y,-89.99),89.99))},this);var r=[];e.forEach(b,function(q){q=esri.geometry.geographicToWebMercator(q);
102100!==d.wkid&&(q.spatialReference=d);r.push(q)},this);if(l)l(r);else return r}else if(null!=c.wkid&&arcgisonline.map.main.contains(f,c.wkid)&&null!=d.wkid&&4326==d.wkid)if(r=[],e.forEach(b,function(q){r.push(esri.geometry.webMercatorToGeographic(q))},this),l)l(r);else return r;else arcgisonline.map.main.geometryService||(arcgisonline.map.main.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url)),arcgisonline.map.main.geometryService.project(b,d,e.hitch(this,
function(q,t,w){if(t&&t.length===q.length){var u=[];e.forEach(t,function(v){v&&(v.rings&&0<v.rings.length&&0<v.rings[0].length&&0<v.rings[0][0].length&&!isNaN(v.rings[0][0][0])&&!isNaN(v.rings[0][0][1])||v.paths&&0<v.paths.length&&0<v.paths[0].length&&0<v.paths[0][0].length&&!isNaN(v.paths[0][0][0])&&!isNaN(v.paths[0][0][1])||v.xmin&&!isNaN(v.xmin)&&v.ymin&&!isNaN(v.ymin)||v.x&&!isNaN(v.x)&&v.y&&!isNaN(v.y))?u.push(v):u.push(null)},this);l&&l(u)}else h&&h&&h(t,w)},b),h)},clipOnHorizon:function(b){arcgisonline.map.main.contains([102113,
102100,3857],b.spatialReference.wkid)&&(b.xmin=Math.max(b.xmin,-20037507),b.xmax=Math.min(b.xmax,20037507),b.ymin=Math.max(b.ymin,-19971868),b.ymax=Math.min(b.ymax,19971868));return b},sameSpatialReference:function(b,c){var d=[102113,102100,3857];return b&&c&&esri.isDefined(b.wkid)&&esri.isDefined(c.wkid)&&arcgisonline.map.main.contains(d,b.wkid)&&arcgisonline.map.main.contains(d,c.wkid)||b&&c&&(esri.isDefined(b.wkid)&&esri.isDefined(c.wkid)&&b.wkid==c.wkid||esri.isDefined(b.latestWkid)&&esri.isDefined(c.wkid)&&
b.latestWkid==c.wkid||esri.isDefined(b.wkid)&&esri.isDefined(c.latestWkid)&&b.wkid==c.latestWkid||esri.isDefined(b.latestWkid)&&esri.isDefined(c.latestWkid)&&b.latestWkid==c.latestWkid)||b&&c&&esri.isDefined(b.wkt)&&esri.isDefined(c.wkt)&&b.wkt===c.wkt?!0:!1},sameTilingScheme:function(b,c){var d=arcgisonline.map.main.map;d=d.width>d.height?d.width:d.height;for(var l=!1,h=!1,f=0;f<b.lods.length;f++){var r=b.lods[f].scale;b.dpi!==c.dpi&&(r=b.lods[f].scale/b.dpi);for(var q=0;q<c.lods.length;q++){var t=
c.lods[q].scale;b.dpi!==c.dpi&&(t=c.lods[q].scale/c.dpi);if(Math.abs(t-r)/t<1/d)if(l){h=!0;break}else l=!0;if(t<r)break}if(h)break}return h||l&&(1===b.lods.length||1===c.lods.length)?!0:!1},sameTilingSchemeUseResolution:function(b,c){for(var d=!1,l=!1,h=0;h<b.lods.length;h++){for(var f=b.lods[h].resolution,r=0;r<c.lods.length;r++){var q=c.lods[r].resolution;if(.01>Math.abs(q-f)/q)if(d){l=!0;break}else d=!0}if(l)break}return l||d&&(1===b.lods.length||1===c.lods.length)?!0:!1},checkMapSpatialReference:function(){var b=
!1,c=!1;if(arcgisonline.map.main.map)var d=arcgisonline.map.main.map.spatialReference;else d=new esri.SpatialReference({wkid:102100}),(b=esriGeowConfig.defaultBasemap.baseMapLayers)&&b.resourceInfo&&b.resourceInfo.spatialReference&&(d=new esri.SpatialReference(b.resourceInfo.spatialReference));b=e.some(arcgisonline.map.wms._WEB_MERCATOR,function(l){return l===d.wkid});c=4326===d.wkid;return{mapIsWebMercator:b,mapIsGCS:c,mapSR:d}},updateTilingScheme:function(b,c){if(b.dpi===c)return b;for(var d=0;d<
b.lods.length;d++)b.lods[d].scale=b.lods[d].scale/b.dpi*c;b.dpi=c;return b},markMapAsChanged:function(b){arcgisonline.map.main.mapHasChanged=!0},markMapAsChangedIfOwner:function(b){b=arcgisonline.sharing.util.getUser();var c=arcgisonline.map.save_open.webMapInfo;b&&c&&(c.owner===b.username||"admin"===c.itemControl||"update"===c.itemControl)&&(arcgisonline.map.main.mapHasChanged=!0)},unmarkMapAsChanged:function(){arcgisonline.map.main.mapHasChanged=!1},signIn:function(b){b&&b.preventDefault();arcgisonline.map.storage.saveMapInCookie(null,
!0,null,null,function(){arcgisonline.map.main.signInWithPopup()})},loggedOut:function(){var b=arcgisonline.sharing.util.getUser();esriGeowConfig.self&&esriGeowConfig.self.isWebTierAuth?b||"7443"===location.port||e.style(e.byId("header_map_signin"),"display","none"):(e.removeClass(e.byId("logged-out-navigation"),"hide"),e.addClass(e.byId("logged-in-navigation"),"hide"),e.connect(e.byId("login-link"),"onclick",e.hitch(arcgisonline.map.main,"signIn")),e.query(".menu-logged-in",this.domNode).style("display",
"none"))},loggedIn:function(){var b=arcgisonline.sharing.util.getUser();esriGeowConfig.self&&esriGeowConfig.self.isWebTierAuth&&(e.style(e.byId("logged-in-signOut"),"display","none"),b&&(b.username=b.username||b.email));if(arcgisonline.sharing.util.isLoggedIn()){if(b){e.addClass(e.byId("logged-out-navigation"),"hide");e.removeClass(e.byId("logged-in-navigation"),"hide");e.attr(e.byId("username"),"innerHTML",arcgisonline.sharing.util.getUserDisplayName(b));e.attr(e.byId("username"),"title",b.fullName);
e.byId("logged-in-myProfile").innerHTML=esri.i18nBundle.siteHeader.myProfile+"\x3cbr/\x3e"+b.username;e.attr("logged-in-myProfile","title",b.fullName);b=this.allSSL||arcgisonline.sharing.util.usePortalSSL()?arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.restBaseUrl):esriGeowConfig.restBaseUrl;var c=esriGeowConfig.userInfo.credential&&esriGeowConfig.userInfo.credential.token||esriGeowConfig.userInfo.token;b=esriGeowConfig.userInfo.thumbnail?b+"community/users/"+esriGeowConfig.userInfo.username+
"/info/"+esriGeowConfig.userInfo.thumbnail+"?token\x3d"+c:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg");e.attr("dropdown-image","src",b);e.attr("profileImgSmall","src",b);e.query(".menu-logged-in").style("visibility","visible")}else arcgisonline.map.main.loggedOut();arcgisonline.map.main.checkTitleDiv()}else arcgisonline.map.main.loggedOut()},logOut:function(){if(arcgisonline.sharing.util.isPortal()){var b=esriGeowConfig.baseUrl+"index.html";arcgisonline.sharing.geow.Geow.signout(b)}else b=
esriGeowConfig.baseUrl+"pages/Account/manage_accounts.html#client_id\x3darcgisonline\x26signout\x3dtrue",window.location=b},openHelp:function(){var b=esriGeowConfig.help;arcgisonline.sharing.util.isPortal()&&!arcgisonline.sharing.util.isArcGISEnterpriseOnKubernetes()&&(b+="portal/");window.open(b,"_blank")},openNewMap:function(b){b&&b.preventDefault();b=esriGeowConfig.baseUrl+"webmap/viewer.html";1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(b,
null,arcgisonline.map.main.mapLayers,arcgisonline.map.main.mapTables,arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.title:null):window.location=b},openMap:function(b){b&&b.preventDefault();b=esriGeowConfig.baseUrl+"webmap/viewer.html";1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(b,null,arcgisonline.map.main.mapLayers,arcgisonline.map.main.mapTables,arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.title:
null):window.location=b},goToPage:function(b){arcgisonline.map.edit.editActivated&&arcgisonline.map.edit.stopEdit();arcgisonline.map.storage.saveMapInCookie(null,!0,null,null,e.hitch(this,function(){"undefined"!==typeof history.pushState&&window.history.pushState(null,null,"?useExisting\x3d1");window.location=b}))},updateHeaderPresentationLink:function(){},checkReadOnly:function(){arcgisonline.map.main.isReadOnlyMode()&&(K.byId("webmap-analysis").dropDown?(e.connect(K.byId("webmap-analysis"),"onClick",
e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-analysis-analysis"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-analysis-history"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow"))):e.connect(K.byId("webmap-analysis"),"onMouseDown",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-edit"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-save"),"onClick",
e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-save-save"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-save-saveas"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-share"),"onMouseDown",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-add"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-search-layers"),"onClick",e.hitch(arcgisonline.map.main,
"readOnlyDontAllow")),e.connect(K.byId("webmap-add-esri-maplayers"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-add-provisionedListings"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-add-layer-url"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-add-layer-file"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(K.byId("webmap-add-mapnotes"),"onClick",e.hitch(arcgisonline.map.main,
"readOnlyDontAllow")),e.connect(K.byId("webmap-directions"),"onMouseDown",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")))},readOnlyDontAllow:function(b){b.stopImmediatePropagation&&b.stopImmediatePropagation();b.stopPropagation&&b.stopPropagation();arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.common.errors.portalInReadOnlyModeMsg})},isReadOnlyMode:function(){return arcgisonline.sharing.util.isPortal()&&
!0===esriGeowConfig.self.isReadOnly},checkMinWidthOfPage:function(){K.byId("webmap-save").set("label",esri.i18nBundle.viewer.saveBtn);K.byId("webmap-print").set("label",esri.i18nBundle.viewer.printBtn);K.byId("webmap-print-templates").set("label",esri.i18nBundle.viewer.printBtn);K.byId("webmap-measure").set("label",esri.i18nBundle.viewer.measureBtn);K.byId("webmap-bookmarks").set("label",esri.i18nBundle.viewer.bookmarksBtn);K.byId("webmap-directions").set("label",esri.i18nBundle.viewer.directionsBtn);
K.byId("webmap-share").set("label",esri.i18nBundle.viewer.shareBtn);K.byId("webmap-basemap").set("label",esri.i18nBundle.viewer.basemapBtn);K.byId("webmap-add").set("label",esri.i18nBundle.viewer.addBtn);K.byId("webmap-details").set("label",esri.i18nBundle.viewer.detailsBtn);K.byId("webmap-edit").set("label",esri.i18nBundle.viewer.editBtn);K.byId("webmap-analysis").set("label",esri.i18nBundle.viewer.analysisBtn);K.byId("webmap-analysis").set("title",esri.i18nBundle.viewer.analysisBtnHover);esriGeowConfig.showAnalysisHistory&&
(K.byId("webmap-analysis-analysis").set("label",esri.i18nBundle.viewer.analysisBtn),K.byId("webmap-analysis-history").set("label",esri.i18nBundle.viewer.analysisHistory));if(!e.isIE||9<=e.isIE)e.byId("webmap-save_label").style.removeProperty("padding"),e.byId("webmap-add_label").style.removeProperty("padding"),e.byId("webmap-print-templates_label").style.removeProperty("padding");var b=function(){var f=e.coords(e.byId("webmap-toolbar-leftCorner")).w,r=e.coords(e.byId("webmap-toolbar-rightCorner")).w,
q=e.coords(e.byId("webmap-toolbar-right")).w,t=e.coords(e.byId("webmap-toolbar-left")).w,w=e.style(e.byId("webmap-save"),"width"),u=e.style(e.byId("webmap-share"),"width");var v="none"!==e.style(K.byId("webmap-print").domNode,"display")?e.style(e.byId("webmap-print"),"width"):e.style(e.byId("webmap-print-templates"),"width");var x=e.style(e.byId("webmap-directions"),"width"),z=e.style(e.byId("webmap-measure"),"width"),A=e.style(e.byId("webmap-bookmarks"),"width");w=w+u+v+x+z+A+75;u=e.style(e.byId("toolbar"),
esriGeowConfig.isRightToLeft?"right":"left");v=0;"auto"!==e.style(e.byId("toolbar"),esriGeowConfig.isRightToLeft?"left":"right")&&(esriGeowConfig.isRightToLeft?u=parseInt(e.style(e.byId("toolbar"),"left")):v=parseInt(e.style(e.byId("toolbar"),"right")));return Math.max(400,u+f+t+w+q+r+v)+15},c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||600,d=56;arcgisonline.map.geocode.geocoder&&arcgisonline.map.geocode.geocoder.sources&&1<arcgisonline.map.geocode.geocoder.sources.length&&
(d+=26);if(e.query(".searchGroup","locationDiv").length){var l=250,h=e.query(".searchGroup","locationDiv")[0];e.style(e.query(".searchGroup input","locationDiv")[0],"width",l-d+"px");e.style(h,"width",l+"px");e.style(e.query(".webmapToolbarRight")[0],"width",l+10+"px");h.style.display="none";h.offsetHeight;h.style.display="block"}l=function(f){9>e.isIE&&(f=e.create("div",{innerHTML:"x",style:"visibility: hidden; height: 1px;"}),e.place(f,"webmap-toolbar-center","first"),setTimeout(e.hitch(this,function(r){e.byId("webmap-toolbar-center").removeChild(r)},
f),1))};h=b();c<h&&("none"!==e.style(K.byId("webmap-print").domNode,"display")?(K.byId("webmap-print").set("label",""),l("webmap-print")):(K.byId("webmap-print-templates").set("label",""),e.style(e.byId("webmap-print-templates_label"),"padding",0),l("webmap-print-templates")),h=b(),c<h&&(K.byId("webmap-save").set("label",""),e.style(e.byId("webmap-save_label"),"padding",0),l("webmap-save"),h=b(),c<h&&(K.byId("webmap-measure").set("label",""),l("webmap-measure"),h=b(),c<h&&(K.byId("webmap-bookmarks").set("label",
""),l("webmap-bookmarks"),h=b(),c<h&&(K.byId("webmap-directions").set("label",""),l("webmap-directions"),h=b(),c<h&&(K.byId("webmap-share").set("label",""),l("webmap-share"),h=b(),c<h&&(K.byId("webmap-basemap").set("label",""),l("webmap-basemap"),h=b(),c<h&&(K.byId("webmap-add").set("label",""),e.style(e.byId("webmap-add_label"),"padding",0),l("webmap-add"),h=b(),c<h&&(K.byId("webmap-details").set("label",""),l("webmap-details"),h=b(),c<h&&(K.byId("webmap-edit").set("label",""),l("webmap-edit"),h=
b(),c<h&&(K.byId("webmap-analysis").set("label",""),l("webmap-analysis"),h=b())))))))))));e.query(".searchGroup","locationDiv").length&&(l=250,150<c-h?l=400:100<c-h?l=350:50<c-h&&(l=300),e.style(e.query(".searchGroup input","locationDiv")[0],"width",l-d+"px"),e.style(e.query(".searchGroup","locationDiv")[0],"width",l+"px"),e.style(e.query(".webmapToolbarRight")[0],"width",l+10+"px"),h=b());e.style(e.byId("page-border"),"minWidth")!=h&&e.style(e.byId("page-border"),"minWidth",h+"px");e.style(e.byId("webmap-toolbar-center"),
"visibility","visible");arcgisonline.map.leftPanel.calculateLeftPanelDefaultWidth();e.style(e.byId("main-content"),"width",c+"px");K.byId("page-border").resize();arcgisonline.map.main.checkTitleDiv()},checkUnsupportedRendererType:function(b){var c={type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}};9>e.isIE&&(b.layerDefinition&&b.layerDefinition.drawingInfo&&
b.layerDefinition.drawingInfo.renderer&&"heatmap"===b.layerDefinition.drawingInfo.renderer.type?b.layerDefinition.drawingInfo.renderer=c:!(b.layerDefinition&&b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer)&&b.serviceInfo&&b.serviceInfo.drawingInfo&&b.serviceInfo.drawingInfo.renderer&&"heatmap"===b.serviceInfo.drawingInfo.renderer.type&&(b.serviceInfo.drawingInfo.renderer=c))},isNewRendererType_2_1:function(b){if(b.layer&&b.layer.renderer){var c=b.layer.renderer;if("esri.renderer.UniqueValueRenderer"==
c.declaredClass&&b.layer.fields&&c.attributeField){b=b.layer.fields;for(var d=0;d<b.length;d++)if(b[d].name===c.attributeField)if("esriFieldTypeDate"!==b[d].type&&(!c.visualVariables||c.visualVariables&&1===c.visualVariables.length&&"sizeInfo"===c.visualVariables[0].type&&"outline"===c.visualVariables[0].target))break;else return!0}else if("esri.renderer.HeatmapRenderer"==c.declaredClass||c.visualVariables)return"esri.renderer.HeatmapRenderer"!==c.declaredClass&&1===c.visualVariables.length&&"sizeInfo"===
c.visualVariables[0].type&&"outline"===c.visualVariables[0].target?!1:!0}return!1},reloadViewerSecureIdMgr:function(b){arcgisonline.map.main.reloadViewerSecure(b.resourceUrl,esri.i18nBundle.viewer.main.reloadForSSLLogin)},reloadViewerSecureSSL:function(b){arcgisonline.map.main.reloadViewerSecure(b,esri.i18nBundle.viewer.main.reloadForSSL)},reloadViewerSecure:function(b,c){if(arcgisonline.map.main.mapHasChanged){var d=function(){window.location=esriGeowConfig.baseUrl.replace("http://","https://")+
esriGeowConfig.webmapViewerPath+"?useExisting\x3d1"};b=function(){arcgisonline.map.storage.saveMapInCookie(null,!0,null,null,e.hitch(this,d))};var l=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();l.show({title:esri.i18nBundle.viewer.main.reload,message:c,choiceOneTitle:esri.i18nBundle.common.yesLabel,choiceOneHandler:e.hitch(this,b),choiceTwoTitle:esri.i18nBundle.common.noLabel,choiceTwoHandler:function(){}})}else b=arcgisonline.sharing.util.urlToObject(document.URL),
b.query=b.query||{},b.query.webmap||b.query.layers||b.query.services||b.query.featurecollection||b.query.url||b.query.urls||b.query.basemapUrl?window.location=window.location.href.replace("http://","https://"):(b=function(){window.location=document.URL.replace("http://","https://")},l=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance(),l.show({title:esri.i18nBundle.viewer.main.reload,message:c,choiceOneTitle:esri.i18nBundle.common.yesLabel,choiceOneHandler:e.hitch(this,b),
choiceTwoTitle:esri.i18nBundle.common.noLabel,choiceTwoHandler:function(){}}))},showBasemapGallery:function(){arcgisonline.map.main.hideDropdowns("basemapGallery");K.byId("basemap-gallery").groupQuery=esriGeowConfig.self.useVectorBasemaps?encodeURIComponent(esriGeowConfig.self.vectorBasemapGalleryGroupQuery):encodeURIComponent(esriGeowConfig.basemapGalleryGroupQuery);K.byId("basemap-gallery").open()},showMeasureTool:function(){arcgisonline.map.popup.disablePopupHandler();e.byId("measureToolDiv")||
e.place(e.create("div",{id:"measureToolDiv"}),"measureDiv","last");if("block"==e.style(e.byId("measureDiv"),"display"))arcgisonline.map.main.hideMeasureTool();else{arcgisonline.map.main.hideDropdowns();arcgisonline.map.main.map.infoWindow.hide();var b=e.coords(e.byId("webmap-measure"));esriGeowConfig.isRightToLeft?e.style(e.byId("measureDiv"),"left",b.x+b.w-318+"px"):e.style(e.byId("measureDiv"),"left",b.x-4+"px");e.style(e.byId("measureDiv"),"display","block");e.style(e.byId("measureDiv"),"top",
b.y+b.h+3+"px");arcgisonline.map.main.measureTool||(b=esri.symbol.fromJson({name:"Circle",type:"esriSMS",style:"esriSMSCircle",color:[255,255,255,204],size:6,outline:{color:[102,102,102,255],width:1}}),arcgisonline.map.main.measureTool=new esri.dijit.Measurement({map:arcgisonline.map.main.map,id:"measureTool",pointSymbol:b,defaultAreaUnit:"english"===arcgisonline.map.main.scaleBarUnits?esri.Units.SQUARE_MILES:esri.Units.SQUARE_KILOMETERS,defaultLengthUnit:"english"===arcgisonline.map.main.scaleBarUnits?
esri.Units.MILES:esri.Units.KILOMETERS},"measureToolDiv"),arcgisonline.map.main.measureTool.startup());arcgisonline.map.main.measureTool.setTool("area",!0);arcgisonline.map.main.measureActivated=!0;arcgisonline.map.geocodeReview.geocodeMatchWidget&&arcgisonline.map.geocodeReview.geocodeMatchWidget.pauseMapEvents();arcgisonline.map.main.map.activeDirectionsWidget&&arcgisonline.map.main.map.activeDirectionsWidget.active?(arcgisonline.map.main.activeDirectionsWidgetIsActive=!0,arcgisonline.map.main.map.activeDirectionsWidget.deactivate()):
arcgisonline.map.main.activeDirectionsWidgetIsActive=!1}},hideMeasureTool:function(b){arcgisonline.map.main.measureTool&&(arcgisonline.map.main.measureTool.clearResult(),e.style(e.byId("measureDiv"),"display","none"),arcgisonline.map.main.measureTool.activeTool&&arcgisonline.map.main.measureTool.setTool(arcgisonline.map.main.measureTool.activeTool,!1),arcgisonline.map.main.measureActivated=!1,arcgisonline.map.popup.setupPopupHandler(),arcgisonline.map.geocodeReview.geocodeMatchWidget&&"geocodeStack"===
arcgisonline.map.leftPanel.getLeftContentPanelStack()&&arcgisonline.map.geocodeReview.geocodeMatchWidget.resumeMapEvents(),arcgisonline.map.main.map.activeDirectionsWidget&&"directionsStack"==arcgisonline.map.leftPanel.getLeftContentPanelStack()&&arcgisonline.map.main.activeDirectionsWidgetIsActive&&arcgisonline.map.main.map.activeDirectionsWidget.activate(),"closeIcon"!==b&&"onOtherOpen"!==b||K.byId("webmap-measure").set("checked",!1))},destroyMeasureTool:function(b){arcgisonline.map.main.measureTool&&
(arcgisonline.map.main.measureTool.destroy(),arcgisonline.map.main.measureTool=null)},initBookmarks:function(){if(!arcgisonline.map.main.bookmarksTool){var b=[];arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.bookmarks&&(b=arcgisonline.map.save_open.openedWebMap.bookmarks);arcgisonline.map.main.bookmarksTool=new esri.dijit.Bookmarks({map:arcgisonline.map.main.map,bookmarks:b,editable:!0,id:"bookmarksTool"},"bookmarksToolDiv");arcgisonline.map.role.checkBookmarksToolOptions();
e.connect(arcgisonline.map.main.bookmarksTool,"onClick",e.hitch(this,arcgisonline.map.main.hideBookmarksTool,"onBookmarkClick"));e.connect(arcgisonline.map.main.bookmarksTool,"onEdit",function(){arcgisonline.map.main.markMapAsChanged("onBookmarkEdit")});e.connect(arcgisonline.map.main.bookmarksTool,"onRemove",function(){arcgisonline.map.main.markMapAsChanged("onBookmarkRemove")})}},showBookmarksTool:function(){if("block"==e.style(e.byId("bookmarksDiv"),"display"))arcgisonline.map.main.hideBookmarksTool();
else{arcgisonline.map.main.hideDropdowns();var b=e.coords(e.byId("webmap-bookmarks"));esriGeowConfig.isRightToLeft?e.style(e.byId("bookmarksDiv"),"left",b.x+b.w-242+"px"):e.style(e.byId("bookmarksDiv"),"left",b.x-4+"px");e.style(e.byId("bookmarksDiv"),"display","block");e.style(e.byId("bookmarksDiv"),"top",b.y+b.h+3+"px")}},hideBookmarksTool:function(b){e.style(e.byId("bookmarksDiv"),"display","none");"closeIcon"!==b&&"onBookmarkClick"!==b&&"onOtherOpen"!==b||K.byId("webmap-bookmarks").set("checked",
!1)},projectBookmarks:function(){if(arcgisonline.map.main.bookmarksTool&&0<arcgisonline.map.main.bookmarksTool.bookmarks.length){var b=arcgisonline.map.main.map.extent.spatialReference,c=arcgisonline.map.main.bookmarksTool.bookmarks[0].extent.spatialReference;if(!arcgisonline.map.main.sameSpatialReference(b,c)){var d=function(f){var r=[];e.forEach(arcgisonline.map.main.bookmarksTool.bookmarks,function(w,u){null!==f[u]&&(w=new esri.dijit.BookmarkItem({name:w.name,extent:f[u]}),r.push(w))});for(var q=
arcgisonline.map.main.bookmarksTool.bookmarks.length-1;0<=q;q--){var t=arcgisonline.map.main.bookmarksTool.bookmarks[q];t&&arcgisonline.map.main.bookmarksTool.removeBookmark(t.name)}e.forEach(r,function(w){arcgisonline.map.main.bookmarksTool.addBookmark(w)})},l=function(f,r){},h=[];e.forEach(arcgisonline.map.main.bookmarksTool.bookmarks,function(f){h.push(f.extent)});arcgisonline.map.main.projectGeometries(h,c,b,e.hitch(this,d),e.hitch(this,function(f,r,q,t,w){arcgisonline.map.main.projectGeometries(f,
r,q,e.hitch(this,d),e.hitch(this,l))},h,c,b))}}},hideDropdowns:function(b){"basemapGallery"!=b&&K.byId("basemap-gallery").hide();"block"==e.style(e.byId("bookmarksDiv"),"display")&&arcgisonline.map.main.hideBookmarksTool("onOtherOpen");"block"==e.style(e.byId("measureDiv"),"display")&&arcgisonline.map.main.hideMeasureTool("onOtherOpen")},truncate:function(b){return Math.round(1E4*b)/1E4},getValue:function(b,c){var d=b.indexOf("\x26"+c+"\x3d",0);-1==d&&(d=b.indexOf("?"+c+"\x3d",0));if(-1==d)return-1;
var l=b.indexOf("\x26",d+2);-1==l&&(l=b.length);return b.substring(d+c.length+2,l)},showObjectProperties:function(b){var c="",d;for(d in b)c+=d+":"+b[d]+"\n";alert(""+c)},getGCSString:function(){var b=new e.Deferred,c=arcgisonline.map.main.map.extent;c.spatialReference._isWrappable()?esri.geometry.normalizeCentralMeridian([c],null,e.hitch(this,function(d){if(d[0].rings){var l=(new esri.geometry.Polygon(c.spatialReference)).addRing(d[0].rings[0]).getExtent();d=(new esri.geometry.Polygon(c.spatialReference)).addRing(d[0].rings[1]).getExtent();
c=l.getWidth()>d.getWidth()?l:d}else c=d[0];arcgisonline.map.main.extentToGCSString(c,function(h){b.callback(h)})})):arcgisonline.map.main.mapExtentToGCSString(function(d){b.callback(d)});return b},mapExtentToGCSString:function(b){arcgisonline.map.main.extentToGCSString(arcgisonline.map.main.map.extent,b)},extentToGCSString:function(b,c){arcgisonline.map.main.sameSpatialReference(b.spatialReference,new esri.SpatialReference({wkid:4326}))?c(arcgisonline.map.main.extentToString(b)):arcgisonline.map.main.projectExtent(b,
new esri.SpatialReference({wkid:4326}),e.hitch(this,function(d,l){if(-180===d[0].xmin&&180===d[0].xmax)if(l=arcgisonline.map.main.checkMapSpatialReference(),l.mapIsWebMercator||l.mapIsGCS)c(arcgisonline.map.main.extentToString(d[0]));else if(b.spatialReference.wkid&&-1<e.indexOf([5936,3031],b.spatialReference.wkid))c(arcgisonline.map.main.extentToString(d[0]));else{l=(d[0].ymin+d[0].ymax)/2;var h=[];h.push(new esri.geometry.Point(-180,l,new esri.SpatialReference({wkid:4326})));h.push(new esri.geometry.Point(180,
l,new esri.SpatialReference({wkid:4326})));var f=function(r,q){c(arcgisonline.map.main.extentToString(d[0]))};arcgisonline.map.main.projectJsonGeometries(h,"esriGeometryPoint",new esri.SpatialReference({wkid:4326}),b.spatialReference,e.hitch(this,function(r,q){if(.001>Math.abs(r[0].x-r[1].x)){var t=r[0].x-arcgisonline.map.main.map.extent.xmin,w=arcgisonline.map.main.map.extent.xmax-r[0].x;r=(b.ymin+b.ymax)/2;h=[];h.push(new esri.geometry.Point(b.xmin,r,b.spatialReference));h.push(new esri.geometry.Point(b.xmax,
r,b.spatialReference));arcgisonline.map.main.projectJsonGeometries(h,"esriGeometryPoint",b.spatialReference,new esri.SpatialReference({wkid:4326}),e.hitch(this,function(u,v){u=t>w?new esri.geometry.Extent(u[0].x,d[0].ymin,d[0].xmax,d[0].ymax,new esri.SpatialReference({wkid:4326})):new esri.geometry.Extent(d[0].xmin,d[0].ymin,u[1].x,d[0].ymax,new esri.SpatialReference({wkid:4326}));c(arcgisonline.map.main.extentToString(u))}),e.hitch(this,f))}else c(arcgisonline.map.main.extentToString(d[0]))}),e.hitch(this,
f))}else c(arcgisonline.map.main.extentToString(d[0]))}),e.hitch(this,function(d,l){c(null)}))},extentToString:function(b){return arcgisonline.map.main.extentToString2(b,1E4)},extentToString2:function(b,c){return null!=b?arcgisonline.map.main.roundValue(b.xmin,c)+","+arcgisonline.map.main.roundValue(b.ymin,c)+","+arcgisonline.map.main.roundValue(b.xmax,c)+","+arcgisonline.map.main.roundValue(b.ymax,c):""},roundExtent:function(b,c){return new esri.geometry.Extent(arcgisonline.map.main.roundValue(b.xmin,
c),arcgisonline.map.main.roundValue(b.ymin,c),arcgisonline.map.main.roundValue(b.xmax,c),arcgisonline.map.main.roundValue(b.ymax,c),new esri.SpatialReference(b.spatialReference.toJson()))},buildExportCall:function(b,c,d,l,h,f,r,q,t){if(!q&&-1<b.indexOf("/MapServer/")){f=b.indexOf("/MapServer/");q=b.indexOf("?");if(-1<q){var w=b.substring(f+11,q);b=b.substring(0,f+10)+b.substring(q)}else w=b.substring(f+11),b=b.substring(0,f+10);q=w}w=-1<b.indexOf("/MapServer");!w&&t&&(w=t.capabilities?-1<t.capabilities.toLowerCase().indexOf("map"):
t.supportedImageFormatTypes);f=b.indexOf("?");if(-1==f)if(w)b+="/export?";else{if("undefined"!==typeof t.currentVersion&&10.1<=t.currentVersion)return b+"/info/thumbnail";b+="/exportImage?"}else if(w)b=b.substring(0,f)+"/export"+b.substring(f,b.length)+"\x26";else{if("undefined"!==typeof t.currentVersion&&10.1<=t.currentVersion)return b=b.substring(0,f)+"/info/thumbnail"+b.substring(f,b.length);b=b.substring(0,f)+"/exportImage"+b.substring(f,b.length)+"\x26"}b+="size\x3d"+h+"\x26bbox\x3d"+c;null!==
d&&0<d.length&&(b+="\x26bboxSR\x3d"+d);null!==l&&0<l.length&&(b+="\x26imageSR\x3d"+l);b=w&&t&&t.supportedImageFormatTypes&&-1<t.supportedImageFormatTypes.indexOf("PNG32")?b+("\x26format\x3dpng32\x26f\x3d"+r):w?b+("\x26format\x3dpng24\x26f\x3d"+r):b+("\x26format\x3djpgpng\x26f\x3d"+r);w?null!==q&&0<q.length&&(b+="\x26layers\x3dshow:"+q):b+="\x26interpolation\x3dRSP_NearestNeighbor\x26bandIds\x3dnull";return b},getPrintExtra:function(b,c,d,l){b=-1<b.indexOf("/MapServer");!b&&l&&(b=l.capabilities?-1<
l.capabilities.toLowerCase().indexOf("map"):l.supportedImageFormatTypes);var h="";b?null!=d&&0<d.length&&(h+="\x26layers\x3dshow:"+d):(h+="\x26pixelType\x3dU8\x26interpolation\x3dRSP_NearestNeighbor",null!=c?h+="\x26bandIds\x3d"+c.toString():l&&l.bandCount&&3<parseInt(l.bandCount)&&(h+="\x26bandIds\x3d0,1,2"));return h},buildExportLayers:function(b){var c=b.layer.layerInfos;arcgisonline.map.main.hasDynamicLayers(b)&&(c=b.itemLayers);return arcgisonline.map.main.filterSubLayers(c,b.visibleLayers)},
buildExportLayersByServiceInfo:function(b,c){return arcgisonline.map.main.filterSubLayers(b.layers,c)},filterSubLayers:function(b,c){if(null==b||null==c||0==c.length)return[];c=","+c+",";for(var d=[],l=",",h=0;h<b.length;h++)if(null!=b[h].subLayerIds){if(-1==c.indexOf(","+b[h].id+",")||-1<l.indexOf(","+b[h].id+","))l+=b[h].subLayerIds.toString()+","}else-1<c.indexOf(","+b[h].id+",")&&-1==l.indexOf(","+b[h].id+",")&&d.push(b[h].id);return d},addGroupLayers:function(b,c){if(null==b||null==c||0==c.length)return[];
var d=function(q,t){for(var w=0;w<q.length;w++)if(q[w].id===t)return{parentLayerId:q[w].parentLayerId,subLayerIds:q[w].subLayerIds};return{parentLayerId:-1,subLayerIds:null}},l=[];""!==c&&(l=c.split(","));l=e.map(l,function(q){return parseInt(q)});c=[];for(var h=0;h<l.length;h++){var f=l[h];-1==e.indexOf(c,f)&&c.push(f);f=d(b,f);for(var r=f.parentLayerId;-1<r;)-1==e.indexOf(c,r)&&c.push(r),r=d(b,r).parentLayerId;(f=f.subLayerIds)&&f.length&&e.forEach(f,function(q){-1==e.indexOf(l,q)&&l.push(q)})}c=
c.sort(function(q,t){return q==t?0:q<t?-1:1});return c.toString()},getParameterList:function(b){for(var c=0;c<arcgisonline.map.main.mapLayers.length;c++){var d=arcgisonline.map.main.mapLayers[c];if(d.layers)for(var l=0;l<d.layers.length;l++){if(b.id==d.layers[l].id)return d}else{if(b.id==d.id)return d;if(d.layer instanceof esri.layers.GeoRSSLayer){var h=d.layer.getFeatureLayers();for(l=0;l<h.length;l++)if(b.id==h[l].id)return d}}}return null},getParameterListById:function(b){for(var c=0;c<arcgisonline.map.main.mapLayers.length;c++){var d=
arcgisonline.map.main.mapLayers[c];if(b==d.id)return d}for(c=0;c<arcgisonline.map.main.mapTables.length;c++)if(d=arcgisonline.map.main.mapTables[c],b==d.id)return d;return null},getParameterListsByUrl:function(b){for(var c=[],d=0;d<arcgisonline.map.main.mapLayers.length;d++){var l=arcgisonline.map.main.mapLayers[d];b==l.url&&c.push(l)}for(d=0;d<arcgisonline.map.main.mapTables.length;d++)l=arcgisonline.map.main.mapTables[d],b==l.url&&c.push(l);return c.length?c:null},isWebMapLayer:function(b){var c=
!1,d=arcgisonline.map.save_open.openedWebMap;d&&(e.forEach(d.operationalLayers,function(l){l.id===b.id&&(c=!0)}),e.forEach(d.baseMap.baseMapLayers,function(l){l.id===b.id&&(c=!0)}));return c},hasMSForFS:function(b){if(!b.url)return!1;var c=b.url,d=c.indexOf("/FeatureServer");if(-1<d&&b.serviceInfo.capabilities&&-1<b.serviceInfo.capabilities.toLowerCase().indexOf("editing")&&(!b.serviceInfo.advancedQueryCapabilities||!b.serviceInfo.advancedQueryCapabilities.supportsLod))for(c=c.substring(0,d+1),d=
0;d<arcgisonline.map.main.mapLayers.length;d++){var l=arcgisonline.map.main.mapLayers[d];if(l.url&&-1<l.url.indexOf(c)&&-1<l.url.indexOf("/MapServer")&&l.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer)return b.showLegend=!1,!0}return!1},getMSForFS:function(b){if(b.url){var c=b.url,d=c.indexOf("/FeatureServer");if(-1<d&&b.serviceInfo.capabilities&&-1<b.serviceInfo.capabilities.toLowerCase().indexOf("editing")&&(!b.serviceInfo.advancedQueryCapabilities||!b.serviceInfo.advancedQueryCapabilities.supportsLod))for(b=
c.substring(0,d+1),c=0;c<arcgisonline.map.main.mapLayers.length;c++)if(d=arcgisonline.map.main.mapLayers[c],d.url&&-1<d.url.indexOf(b)&&-1<d.url.indexOf("/MapServer")&&d.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer)return d}},recreateFLsForMS:function(b,c){if(b.url){b=b.url;var d=b.indexOf("/MapServer");if(-1<d)for(b=b.substring(0,d+1),d=0;d<arcgisonline.map.main.mapLayers.length;d++){var l=arcgisonline.map.main.mapLayers[d];!(l.url&&-1<l.url.indexOf(b)&&-1<l.url.indexOf("/FeatureServer/")&&
l.layer&&l.layer.isEditable())||l.serviceInfo.advancedQueryCapabilities&&l.serviceInfo.advancedQueryCapabilities.supportsLod||l.layer.mode===c||(arcgisonline.map.layer.recreateFL(l,c),c===esri.layers.FeatureLayer.MODE_SELECTION?l.showLegend=!1:delete l.showLegend)}}},switchFlsForMS:function(b){if(b.url){var c=b.url,d=c.indexOf("/MapServer");if(-1<d&&b.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer){c=c.substring(0,d+1);for(var l=0;l<arcgisonline.map.main.mapLayers.length;l++){var h=arcgisonline.map.main.mapLayers[l];
if(h.url&&-1<h.url.indexOf(c)&&-1<h.url.indexOf("/FeatureServer/")&&h.layer&&h.layer instanceof esri.layers.FeatureLayer&&h.layer.mode===esri.layers.FeatureLayer.MODE_SELECTION)if(b.layer.visible){d=h.url.indexOf("/FeatureServer/");var f=h.url.indexOf("?");-1==f&&(f=h.url.lengthl);d=h.url.substring(d+15,f);-1<e.indexOf(b.layer.visibleLayers,d)?h.layer.show():h.layer.hide()}else h.layer.hide()}}}},getFlForMSL:function(b,c){if(b.url){var d=b.url,l=d.indexOf("/MapServer");if(-1<l&&b.layer instanceof
esri.layers.ArcGISDynamicMapServiceLayer)for(b=d.substring(0,l+1),d=0;d<arcgisonline.map.main.mapLayers.length;d++)if(l=arcgisonline.map.main.mapLayers[d],l.url&&-1<l.url.indexOf(b+"FeatureServer/"+c)&&l.layer&&l.layer.mode===esri.layers.FeatureLayer.MODE_SELECTION)return l;return null}},hasMSaFl:function(b){if(b.url){var c=b.url,d=c.indexOf("/MapServer");if(-1<d&&b.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer)for(b=c.substring(0,d+1),c=0;c<arcgisonline.map.main.mapLayers.length;c++)if(d=
arcgisonline.map.main.mapLayers[c],d.url&&-1<d.url.indexOf(b)&&-1<d.url.indexOf("/FeatureServer/")&&d.layer&&d.layer.mode===esri.layers.FeatureLayer.MODE_SELECTION)return!0;return!1}},containsLayerInfo:function(b,c){for(var d=0;d<b.layers.length;d++)if(b.layers[d]&&b.layers[d].id===c)return b.layers[d];return null},getLayerInfoForQuery:function(b,c,d){var l=new e.Deferred;if(arcgisonline.map.featColl.isFeatureCollection(b)&&b.layer instanceof esri.layers.WMSLayer)return l.errback(),l;var h=!1;if(b.queryServiceUrl)if(b.queryLayersInfo)if("Table"===
b.layer.type){var f=b.url.toLowerCase().indexOf("/mapserver/");-1<f&&(c=parseInt(b.url.substring(f+11)));e.forEach(b.queryLayersInfo.tables,function(t){t.id===c&&(t.url=b.queryServiceUrl,l.callback(t))})}else e.forEach(b.queryLayersInfo.layers,function(t){t.id===c&&(t.url=b.queryServiceUrl,l.callback(t))});else f=function(t,w){"Table"===b.layer.type?(t=b.url.toLowerCase().indexOf("/mapserver/"),-1<t&&(c=parseInt(b.url.substring(t+11))),e.forEach(b.queryLayersInfo.tables,function(u){u.id===c&&(u.url=
b.queryServiceUrl,l.callback(u))})):e.forEach(b.queryLayersInfo.layers,function(u){u.id===c&&(u.url=b.queryServiceUrl,l.callback(u))})},arcgisonline.map.main.getQueryLayersInfo(b,e.hitch(this,f));else!b.identify&&b.layer instanceof esri.layers.ArcGISTiledMapServiceLayer&&b.itemLayers&&e.forEach(b.itemLayers,function(t){if(t.id===c)if(t._layerInfo)h=!0,b.layersInfo=b.layersInfo||{},b.layersInfo.layers=b.layersInfo.layers||[],b.layersInfo.layers[c]||(b.layersInfo.layers[c]=t._layerInfo),t._layerInfo.url=
t.layerUrl,l.callback(t._layerInfo);else if(t.layerUrl){h=!0;var w=!1,u;b.layersInfo&&b.layersInfo.layers&&(w=e.some(b.layersInfo.layers,function(v){u=v;return v.id===t.id}));w?(u.url=t.layerUrl,l.callback(u)):arcgisonline.map.main.getJson(t.layerUrl,e.hitch(this,function(v,x){b.layersInfo=b.layersInfo||{};b.layersInfo.layers=b.layersInfo.layers||[];t._layerInfo=v;v.tileSvcLayerId=t.id;b.layersInfo.layers.push(v);v.url=t.layerUrl;l.callback(v)}),e.hitch(this,function(v,x){l.errback()}))}},this);if(!b.queryServiceUrl&&
!h)if(b.layer){f=!1;var r=arcgisonline.map.main.getFlForMSL(b,c);if(r)return f=!0,q=r.serviceInfo,q.url=r.layer.url,l.callback(q),l;if(b.layersInfo&&(b.layersInfo.layers||b.layersInfo.tables)){var q=arcgisonline.map.main.containsLayerInfo(b.layersInfo,c);q&&(f=!0,q.url=b.layer.url,l.callback(q))}f||(10.01<=b.layer.version&&b.itemId&&(b.layer instanceof esri.layers.ArcGISTiledMapServiceLayer||b.layer instanceof esri.layers.FeatureLayer&&"Table"===b.layer.type)&&(arcgisonline.sharing.util.isHostedService(b.url)||
arcgisonline.sharing.util.portalSupportsHostedServices()&&-1<e.indexOf(b.itemCard.typeKeywords,"Hosted Service"))?arcgisonline.map.main.getServiceToServiceFS(b,function(){var t=function(w,u){"Table"===b.layer.type?(w=b.url.toLowerCase().indexOf("/mapserver/"),-1<w&&(c=parseInt(b.url.substring(w+11))),e.forEach(b.queryLayersInfo.tables,function(v){v.id===c&&(v.url=b.layer.url,l.callback(v))})):e.forEach(b.queryLayersInfo.layers,function(v){v.id===c&&(v.url=b.layer.url,l.callback(v))})};b.queryLayersInfo?
t():arcgisonline.map.main.getQueryLayersInfo(b,e.hitch(this,t),e.hitch(this,function(){l.errback()}))},function(){l.errback()}):10<=b.layer.version?b.layersInfo||b.thematicGroup?(d=function(t,w,u){e.filter(b.layersInfo.layers,function(v){return v.id===c}).length||b.layersInfo.layers.push(w);w.url=t;l.callback(w)},r=function(t,w){l.errback()},q=b.url,f=q.indexOf("?"),q=-1==f?q+("/"+c):q.substring(0,f)+"/"+c+layersUrl.substring(f,layersUrl.length),arcgisonline.map.main.getJson(q,e.hitch(this,d,q),e.hitch(this,
r))):b.layer.capabilities.toLowerCase&&-1===b.layer.capabilities.toLowerCase().indexOf("query")?(b.layersInfo={},b.layersInfo.layers=[],l.errback()):(f=function(t,w){e.forEach(b.layersInfo.layers,function(u){u.id===c&&(u.url=b.layer.url,l.callback(u))})},arcgisonline.map.main.getLayersInfo(b,e.hitch(this,f))):!b.identify||d?l.errback():(d=function(t,w,u){b.layersInfo=b.layersInfo||{};b.layersInfo.layers=b.layersInfo.layers||[];b.layersInfo.layers.push(w);e.forEach(b.layersInfo.layers,function(v){v.id===
c&&(v.url=t,l.callback(v))})},r=function(t,w){l.errback()},q=b.url,f=q.indexOf("?"),q=-1==f?q+("/"+c):q.substring(0,f)+"/"+c+layersUrl.substring(f,layersUrl.length),arcgisonline.map.main.getJson(q,e.hitch(this,d,q),e.hitch(this,r))))}else l.errback();return l},getLayerInfoForQueryFromUrl:function(b,c,d,l){if(c&&c.capabilities&&-1<c.capabilities.toLowerCase().indexOf("map"))if(-1===c.capabilities.toLowerCase().indexOf("query"))l({layers:[]});else{var h=b;b=h.indexOf("?");h=-1==b?h+"/layers":h.substring(0,
b)+"/layers"+h.substring(b,h.length);arcgisonline.map.main.getJson(h,e.hitch(this,function(f,r){l(f)}))}else c=b,b=c.indexOf("?"),c=-1==b?c+("/"+d):c.substring(0,b)+"/"+d+h.substring(b,h.length),arcgisonline.map.main.getJson(c,e.hitch(this,function(f,r){r={layers:[]};r.layers.push(f);l&&l(r)}),e.hitch(this,function(f,r){l({layers:[]})}))},getLayersInfo:function(b,c){if(b.layersInfo)c(b.layersInfo);else if(!b.layer||10>b.layer.version||b.thematicGroup)b.layersInfo={layers:[]},c(b.layersInfo);else if(b.layersInfoInProgress)setTimeout(e.hitch(this,
function(h,f){arcgisonline.map.main.getLayersInfo(h,f)},b,c),500);else{b.layersInfoInProgress=!0;var d=b.url,l=d.indexOf("?");d=-1==l?d+"/layers":d.substring(0,l)+"/layers"+d.substring(l,d.length);arcgisonline.map.main.getJson(d,e.hitch(this,function(h,f){delete b.layersInfoInProgress;b.layersInfo=h;c(h)}),e.hitch(this,function(){delete b.layersInfoInProgress;b.layersInfo={layers:[]};c(b.layersInfo)}))}},getQueryLayersInfo:function(b,c,d){d=function(f,r){d()};var l=b.queryServiceUrl,h=l.indexOf("?");
l=-1==h?l+"/layers":l.substring(0,h)+"/layers"+l.substring(h,l.length);arcgisonline.map.main.getJson(l,e.hitch(this,function(f,r){b.queryLayersInfo=f;c(f,r)}),e.hitch(this,d))},getLayerInfo:function(b,c){var d=new e.Deferred,l=null;b.itemLayers&&e.forEach(b.itemLayers,function(w){w.id===c&&w.layerUrl&&(l=w)});if(l){var h=function(w,u,v){b.layersInfo=b.layersInfo||{};b.layersInfo.layers=b.layersInfo.layers||[];b.layersInfo.layers.push(v);w._layerInfo=v;u.callback(v)},f=function(w,u){delete l.layerUrl;
w.errback(Error("Query layer not accessible."))},r=!1;arcgisonline.sharing.util.getUser()||(r=!0);arcgisonline.map.layer.getServiceInfo(l.layerUrl,null,e.hitch(this,h,l,d),e.hitch(this,f,d),r)}else if(b.layersInfo&&b.layersInfo.layers&&!arcgisonline.sharing.util.isHostedService(b.url)){var q=!1;e.forEach(b.layersInfo.layers,function(w){w.id===c&&(d.callback(w),q=!0)});if(!q){h=function(w,u){b.layersInfo=b.layersInfo||{layers:[]};e.filter(b.layersInfo.layers,function(v){return v.id===c}).length||b.layersInfo.layers.push(u);
w.callback(u)};f=function(w,u){w.errback(u)};r=b.url;var t=r.indexOf("?");r=-1==t?r+("/"+c):r.substring(0,t)+"/"+c+r.substring(t,r.length);arcgisonline.map.layer.getServiceInfo(r,null,e.hitch(this,h,d),e.hitch(this,f,d))}}else d.errback();return d},getItemWithId:function(b,c){var d;e.forEach(b,function(l){l&&l.id===c&&(d=l)});return d},getItemWithSourceMapLayerId:function(b,c){var d;e.forEach(b,function(l){l&&l.layerDefinition&&l.layerDefinition.source&&l.layerDefinition.source.mapLayerId===c&&(d=
l)});return d},getServiceToServiceFS:function(b,c,d){b.noQueryServiceUrl?d&&d():b.queryServiceUrlProcessing?setTimeout(e.hitch(arcgisonline.map.main,"getServiceToServiceFS",b,c,d),500):b.queryServiceUrl?c():(b.queryServiceUrlProcessing=!0,arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+b.itemId+"/relatedItems?relationshipType\x3dService2Service\x26direction\x3dreverse",e.hitch(this,function(l){l&&l.total&&e.forEach(l.relatedItems,function(h){"Feature Service"===h.type&&
(b.queryServiceUrl=h.url,!esriGeowConfig.allSSL&&"https:"!=location.protocol||!arcgisonline.sharing.util.isHostedService(b.queryServiceUrl)&&!arcgisonline.sharing.util.supportsHttps(b.queryServiceUrl)||(b.queryServiceUrl=b.queryServiceUrl.replace("http:","https:")),b.queryServiceItemId=h.id,delete b.queryServiceUrlProcessing,c())});b.queryServiceUrl||(b.noQueryServiceUrl=!0,delete b.queryServiceUrlProcessing,d&&d())}),e.hitch(this,function(){b.noQueryServiceUrl=!0;delete b.queryServiceUrlProcessing;
d&&d()})))},hasFullEditingControl:function(b){var c=!1,d=arcgisonline.sharing.util.getUser();if(d&&b.itemId){var l=arcgisonline.sharing.util.urlToObject(document.URL);l.query=l.query||{};var h=l.query.layers||l.query.services,f=[];l.query.webmap&&arcgisonline.map.save_open.openedWebMap&&(f=e.filter(arcgisonline.map.save_open.openedWebMap.operationalLayers,function(r){return r.itemId===b.itemId}));!b.itemCard&&arcgisonline.map.save_open.itemCards[b.itemId]&&(b.itemCard=arcgisonline.map.save_open.itemCards[b.itemId]);
"true"===l.query.isAdmin&&(h&&-1<h.indexOf(b.itemId)||f.length)&&b.itemCard&&-1<e.indexOf(b.itemCard.typeKeywords,"Hosted Service")&&("update"===b.itemCard.itemControl||"admin"===b.itemCard.itemControl?c=!0:d&&esriGeowConfig.userRole&&esriGeowConfig.userRole.isAdmin()&&b.itemCard.isOrgItem?c=!0:d&&b.itemCard.owner&&b.itemCard.owner===d.username?c=!0:esriGeowConfig.userRole&&esriGeowConfig.userRole.canEditFeaturesFullControl()&&esriGeowConfig.userRole.canEditFeatures()&&b.itemCard.isOrgItem&&b.serviceInfo&&
b.serviceInfo.capabilities&&(-1<b.serviceInfo.capabilities.indexOf("Create")||-1<b.serviceInfo.capabilities.indexOf("Update")||-1<b.serviceInfo.capabilities.indexOf("Delete"))&&(c=!0))}return c},hasDynamicLayers:function(b){return b.layer&&b.itemLayers&&b.itemLayers.length&&b.layer.supportsDynamicLayers&&b.itemLayers[0].layerDefinition&&b.itemLayers[0].layerDefinition.source?!0:!1},getMapLayerInfo:function(){for(var b={supportsOffline:!0},c=0;c<arcgisonline.map.main.mapLayers.length;c++){var d=arcgisonline.map.main.mapLayers[c],
l=d.layer;"base"!==d.type&&"labels"!==d.type&&(esri.isDefined(b.allOpLyrsSync)||(b.allOpLyrsSync=!0),b.allOpLyrsSync=!!(b.allOpLyrsSync&&l&&l instanceof esri.layers.FeatureLayer&&l.capabilities&&-1<l.capabilities.indexOf("Sync")&&(arcgisonline.sharing.util.isHostedService(l.url)||10.4<=l.version)));if(l&&l.url&&l instanceof esri.layers.FeatureLayer&&(l.isEditable()||isEmbedded&&isEmbedded.hideEdit)){var h=!1,f=d.serviceInfo&&d.serviceInfo._origCapabilities||l.capabilities;f=f?f.toLowerCase():"";if(-1<
f.indexOf("create")||-1<f.indexOf("edit")||-1<f.indexOf("delete")||-1<f.indexOf("update"))h=!0;h&&(b.hasEditableLayer=!0,d.isTrackingInfoLayer&&!b.trackingLayerId&&(b.trackingLayerId=d.id))}!b.supportsOffline||l&&l instanceof esri.layers.FeatureLayer&&l.url&&l.capabilities&&-1<l.capabilities.indexOf("Sync")||"mapNotes"===d.type&&!d.itemId||arcgisonline.map.featColl.isFeatureCollection(d)&&!d.itemId||l&&l instanceof esri.layers.VectorTileLayer&&l.capabilities&&l.capabilities.exportTilesAllowed||l&&
l instanceof esri.layers.ArcGISTiledMapServiceLayer&&(d.serviceInfo&&d.serviceInfo.exportTilesAllowed||!arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.isAgolService(l.url)&&arcgisonline.map.main.agolServiceWithExportTilesAllowed(l.url))||(b.supportsOffline=!1)}for(c=0;c<arcgisonline.map.main.mapTables.length;c++)d=arcgisonline.map.main.mapTables[c],(l=d.layer)&&l.url&&l instanceof esri.layers.FeatureLayer&&l.isEditable()&&(b.hasEditableLayer=!0),l&&l instanceof esri.layers.FeatureLayer&&
l.url&&l.capabilities&&-1<l.capabilities.indexOf("Sync")||(b.supportsOffline=!1);return b},agolServiceWithExportTilesAllowed:function(b){if(esriGeowConfig.agolServicesWithExportTilesAllowed)for(var c=0;c<esriGeowConfig.agolServicesWithExportTilesAllowed.length;c++)if(-1<b.indexOf("/"+esriGeowConfig.agolServicesWithExportTilesAllowed[c]+"/"))return!0;return!1},adjustWebMapTypeKeywords:function(b){b=b.split(",");var c=arcgisonline.map.main.getMapLayerInfo(),d=e.indexOf(b,"ArcGIS API for JavaScript");
-1<d&&b.splice(d,1);c.hasEditableLayer?(-1===e.indexOf(b,"Data Editing")&&b.push("Data Editing"),-1<e.indexOf(b,"Workforce Project")||-1<e.indexOf(b,"Workforce Worker")||-1<e.indexOf(b,"Workforce Dispatcher")?(d=e.indexOf(b,"Collector"),-1<d&&b.splice(d,1)):(d=arcgisonline.sharing.util.getUser())&&d.accountId&&-1===e.indexOf(b,"CollectorDisabled")&&(-1===e.indexOf(b,"Collector")&&d&&d.accountId?b.push("Collector"):d&&d.accountId||(d=e.indexOf(b,"Collector"),-1<d&&b.splice(d,1)))):(d=e.indexOf(b,"Data Editing"),
-1<d&&b.splice(d,1),d=e.indexOf(b,"Collector"),-1<d&&b.splice(d,1),d=e.indexOf(b,"CollectorDisabled"),-1<d&&b.splice(d,1));(d=arcgisonline.sharing.util.getUser())&&d.accountId&&-1===e.indexOf(b,"OfflineDisabled")&&(c.supportsOffline?-1===e.indexOf(b,"Offline")&&b.push("Offline"):(d=e.indexOf(b,"Offline"),-1<d&&b.splice(d,1)));return b.toString()},reloadFeatureLayer:function(b){arcgisonline.map.main.map.infoWindow.clearFeatures();arcgisonline.map.main.map.infoWindow.hide();delete b.__createDefaultPopup;
var c=!1;e.forEach(arcgisonline.map.geocode.geocoder.sources,function(h){h.layerId===b.layer.id&&(c=!0)});b.scaleChanged&&(b.serviceInfo.minScale=b.layer.minScale,b.serviceInfo.maxScale=b.layer.maxScale);b.rendererChanged&&(b.layerDefinition=b.layerDefinition||{},b.layerDefinition.drawingInfo=b.layerDefinition.drawingInfo||{},b.layerDefinition.drawingInfo.renderer=b.layer.renderer.toJson(),b.layer.labelingInfo&&(b.serviceInfo.drawingInfo.labelingInfo=e.map(b.layer.labelingInfo,function(h){return h.toJson()})));
b.featureTemplatesChanged&&(b.serviceInfo.types=b.layer.types,b.serviceInfo.templates=b.layer.templates,b.serviceInfo.typeIdField=b.layer.typeIdField);!1===b.layer.useMapTime?b.timeAnimation=!1:!0===b.layer.useMapTime&&(b.timeAnimation=!0);b.defaultOpacity=b.layer.opacity;var d=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,b.id),l=e.connect(arcgisonline.map.main.map,"onLayerRemove",function(){e.disconnect(l);arcgisonline.map.labels.removeLabelsForLayer(b.layer);delete b.layer;arcgisonline.map.layer.addLayer(b,
d,function(){e.publish("onLayerUpdate",["reopen"]);c&&arcgisonline.map.geocode.recreateGeocoder()})});arcgisonline.map.main.map.removeLayer(b.layer);arcgisonline.map.labels.removeLabelsForLayer(b.layer)},maxOffset:function(b){return Math.floor(arcgisonline.map.main.map.extent.getWidth()/arcgisonline.map.main.map.width)*b},updateLayerScaleInfo:function(b,c){if(10.1>=c.version&&b.serviceInfo&&b.serviceInfo.layers)for(var d=parseInt(c.url.substring(c.url.lastIndexOf("/")+1,c.url.length)),l=b.serviceInfo.layers.length-
1;0<=l;l--)if(b.serviceInfo.layers[l].id==d)if(0<=b.serviceInfo.layers[l].minScale&&c.setMinScale(Math.min(c.minScale,b.serviceInfo.layers[l].minScale)||b.serviceInfo.layers[l].minScale||c.minScale),0<=b.serviceInfo.layers[l].maxScale&&c.setMaxScale(Math.max(c.maxScale,b.serviceInfo.layers[l].maxScale)),-1<b.serviceInfo.layers[l].parentLayerId)d=b.serviceInfo.layers[l].parentLayerId;else break},removeUrlParameter:function(b,c){-1!=b.indexOf("\x26"+c+"\x3d")?(start=b.indexOf(c),end=b.indexOf("\x26",
start+2),b=-1==end?b.substring(0,start):b.substring(0,start)+b.substring(end,b.length)):-1!=b.indexOf("?"+c+"\x3d")&&(start=b.indexOf(c),end=b.indexOf("\x26",start+2),b=-1==end?b.substring(0,start):b.substring(0,start+1)+b.substring(end+1,b.length));return b},isTextLayer:function(b){return b.renderer&&"esri.renderer.UniqueValueRenderer"===b.renderer.declaredClass&&b.renderer.infos&&b.renderer.infos.length&&b.renderer.infos[0].symbol&&"textsymbol"===b.renderer.infos[0].symbol.type?!0:!1},switchBingToEsriBasemap:function(b){b.baseMap=
"BingMapsAerial"===b.baseMap.baseMapLayers[0].type||"BingMapsAerial"===b.baseMap.baseMapLayers[0].layerType?{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===b.baseMap.baseMapLayers[0].type||"BingMapsRoad"===b.baseMap.baseMapLayers[0].layerType?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:
{title:"Imagery with Labels",baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return b},getJson:function(b,c,d){b=0<=b.indexOf("?")?b+"\x26f\x3djson":b+"?f\x3djson";esri.request({url:b,callbackParamName:"callback",
load:function(l,h){arcgisonline.sharing.util.handler(l,h,b,c,d)},error:function(l,h){arcgisonline.sharing.util.errorHandler(l,h,b,d)}})},roundVal:function(b){return arcgisonline.map.main.roundValue(b,1E4)},roundValue:function(b,c){return Math.round(b*c)/c},onKeyPress:function(b){b.keyCode==e.keys.BACKSPACE&&"INPUT"!==b.currentTarget.activeElement.nodeName&&"TEXTAREA"!==b.currentTarget.activeElement.nodeName&&(b.preventDefault(),b.stopPropagation())},doNothing:function(b){b.preventDefault()},contains:function(b,
c){for(var d=b.length;d--;)if(b[d]===c)return!0;return!1},createMapObject:function(b,c,d){e.style("map","position","relative");var l=new esri.dijit.Popup({visibleWhenEmpty:!1},e.create("div",{"class":"blueTheme"},e.byId("map")));c={nav:!1,lods:arcgisonline.map.main.mapLods,extent:c,wrapAround180:!0,infoWindow:l,showInfoWindowOnClick:!1,sliderStyle:"small"};d&&esri.isDefined(d.minScale)&&esri.isDefined(d.maxScale)&&(c.minScale=d.minScale,c.maxScale=d.maxScale);arcgisonline.map.save_open.openedWebMap&&
arcgisonline.map.save_open.openedWebMap.background&&arcgisonline.map.save_open.openedWebMap.background.color&&esri.isDefined(arcgisonline.map.save_open.openedWebMap.background.color[0])&&(c.backgroundColor=esri.Color.toDojoColor(arcgisonline.map.save_open.openedWebMap.background.color));arcgisonline.map.main.map=new esri.Map("map",c);null==b&&(b=e.hitch(arcgisonline.map.main,"onMapLoad"));e.connect(arcgisonline.map.main.map,"onLoad",b);e.connect(arcgisonline.map.main.map,"onClick",function(){arcgisonline.map.geocode.closeInfoWindow();
document.activeElement&&document.activeElement.blur&&document.activeElement.blur()});arcgisonline.map.main.onLayerAddHandler=e.connect(arcgisonline.map.main.map,"onLayerAddResult",e.hitch(arcgisonline.map.main,"onLayerAddResult"))},destroyMapObject:function(b,c){arcgisonline.map.main.map&&(arcgisonline.map.main.scalebar=null,arcgisonline.map.time.hideTimeSlider(),arcgisonline.map.time.removeTimeSlider(),arcgisonline.map.multiDimensions.removeMdSlider(),arcgisonline.map.main.destroyOverviewMap(),arcgisonline.map.main.destroyMeasureTool(),
arcgisonline.map.geocode.destroyGeocoder(),arcgisonline.map.table.destroyTable(),arcgisonline.map.main.map.destroy(),arcgisonline.map.labels.labelLayer=null,arcgisonline.map.main.map=null,e.byId("map").innerHTML="")},getDirectionsDisplayField:function(b){var c="";if(b.displayField)c=b.displayField;else{for(var d=null,l=null,h=null,f=null,r=null,q=0;q<b.fields.length;q++){var t=b.fields[q];if("name"==t.name.toLowerCase()){c=t.name;break}else"address"==t.name.toLowerCase()?l=t.name:"street"==t.name.toLowerCase()?
h=t.name:"city"==t.name.toLowerCase()?f=t.name:!d&&-1<t.name.toLowerCase().indexOf("name")?d=t.name:r||"esriFieldTypeString"!==t.type||(r=t.name)}c||(d?c=d:l?c=l:h?c=h:f?c=f:r&&(c=r))}return c},numOperationalLayers:function(){for(var b=0,c=0;c<arcgisonline.map.main.mapLayers.length;c++)"user"==arcgisonline.map.main.mapLayers[c].type&&b++;return b},numLabelsLayers:function(){for(var b=0,c=0;c<arcgisonline.map.main.mapLayers.length;c++)"labels"===arcgisonline.map.main.mapLayers[c].type&&b++;return b},
numMapNotesLayers:function(){for(var b=0,c=0;c<arcgisonline.map.main.mapLayers.length;c++)"mapNotes"===arcgisonline.map.main.mapLayers[c].type&&b++;return b},countMapNotesSubLayers:function(){for(var b=0,c=0;c<arcgisonline.map.main.mapLayers.length;c++)"mapNotes"===arcgisonline.map.main.mapLayers[c].type&&arcgisonline.map.main.mapLayers[c].layers&&(b+=arcgisonline.map.main.mapLayers[c].layers.length);return b},itemCardExtentValid:function(b){return!b||2!=b.length||2!=b[0].length||2!=b[1].length||
-90>b[1][1]||90<b[1][1]||-180>b[1][0]||180<b[1][0]||-180>b[0][0]||180<b[0][0]||-90>b[0][1]||90<b[0][1]||b[1][0]<=b[0][0]||b[1][1]<=b[0][1]?!1:!0},getNameFromUrl:function(b){var c=b;-1<b.indexOf("/MapServer")?(c=b.substring(0,b.indexOf("/MapServer")),c=c.substring(c.lastIndexOf("/")+1,c.length)):-1<b.indexOf("/ImageServer")?(c=b.substring(0,b.indexOf("/ImageServer")),c=c.substring(c.lastIndexOf("/")+1,c.length)):-1<b.indexOf("/FeatureServer")&&(c=b.substring(0,b.indexOf("/FeatureServer")),c=c.substring(c.lastIndexOf("/")+
1,c.length));-1<c.indexOf("%")&&(c=arcgisonline.map.main.decodeUrl(c));return c},addLayerId:function(b,c){var d=b.indexOf("?");return b=-1<d?b.substring(0,d)+"/"+c+b.substring(d,b.length):b+("/"+c)},decodeUrl:function(b){try{var c=decodeURIComponent(b)}catch(d){c=b}return c},displayDefaultExtent:function(){var b=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new e.Color([255,0,0]),2);arcgisonline.map.main.map.graphics.add(new esri.Graphic(new esri.geometry.Extent(esriGeowConfig.defaultExtent),
b))},calcFilterDlgWidth:function(){if(!arcgisonline.map.main.filterDlgWidth){var b=e.string.substitute(esri.i18nBundle.FilterDlg.expressionTemplate,{field_dropdown:"",operator_dropdown:"",values_input:esri.i18nBundle.FilterDlg.value+esri.i18nBundle.FilterDlg.field+esri.i18nBundle.FilterDlg.uniqueValues}).replace(/\s/g,"\x26nbsp;"),c=e.create("div",{innerHTML:b,style:{top:-1E3,left:0,position:"absolute"}},document.body);b=e.string.substitute(esri.i18nBundle.FilterDlg.expressionTemplate,{field_dropdown:"",
operator_dropdown:"",values_input:esri.i18nBundle.FilterDlg.andBetweenValues}).replace(/\s/g,"\x26nbsp;");b=e.create("div",{innerHTML:b,style:{top:-1E3,left:0,position:"absolute"}},document.body);var d=e.create("div",{innerHTML:"",style:{top:0,left:0,position:"absolute"},"class":"submitButtons dijitDialogPaneActionBar dijitDialog"},document.body),l=new K.form.Button({label:esri.i18nBundle.FilterDlg.applyFilterBtn,"class":"primary",type:"button"});e.place(l.domNode,d,"last");l=new K.form.Button({label:esri.i18nBundle.FilterDlg.applyFilterAndZoomBtn,
"class":"primary",type:"button"});e.place(l.domNode,d,"last");l=new K.form.Button({label:esri.i18nBundle.common.close,"class":"cancel",type:"button"});e.place(l.domNode,d,"last");l=e.coords(c).w+465;var h=e.coords(b).w+590,f=e.coords(d).w+30;arcgisonline.map.main.filterDlgWidth=Math.max(l,Math.max(h,f));document.body.removeChild(c);document.body.removeChild(b);document.body.removeChild(d)}return arcgisonline.map.main.filterDlgWidth},openFilterDlg:function(b,c,d){var l=arcgisonline.map.main.calcFilterDlgWidth(),
h=(new K.Dialog({"class":"esriAGOFilterDialog",style:"width:"+(l+30)+"px;"})).placeAt(document.body),f=new arcgisonline.sharing.dijit.dialog.FilterDlg({id:"filterDlg",dialog:h,style:"width:"+l+"px;"});l=esri.i18nBundle.FilterDlg.filter+": "+b.title;d&&(l=esri.i18nBundle.FilterDlg.defineFeatures+": "+b.title);b.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer&&(l+=" - "+c.name);h.set({title:l,content:f});h.show();if(d&&!c.adminFields){var r=b.url.replace("/rest/services","/rest/admin/services"),
q={f:"json"};arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,function(t){q.token=t;esri.request({url:r,content:q,callbackParamName:"callback",load:function(w){c.adminFields=w.fields;f.start(b,c,null,d)},error:function(w){f.start(b,c,null,d)}})}),function(t){f.start(b,c,null,d)})}else f.start(b,c,null,d)},openFieldsDlg:function(b){arcgisonline.map.main.map.infoWindow.hide();arcgisonline.map.table.hideAttributeTable();var c=function(h){var f=(new K.Dialog({"class":"esriAGOFieldsDialog",
style:"width: 500px"})).placeAt(document.body),r=new arcgisonline.sharing.dijit.dialog.FieldsDlg({id:"fieldsDlg",dialog:f});f.set({title:esri.i18nBundle.FieldsDlg.defineFields+": "+b.title,content:r});f.show();r.start(b,h)};if(b.serviceInfo.adminFields)c(b.serviceInfo.adminFields);else{var d=b.url.replace("/rest/services","/rest/admin/services"),l={f:"json"};arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,function(h){l.token=h;esri.request({url:d,content:l,callbackParamName:"callback",
load:function(f){b.serviceInfo.adminFields=f.fields;c(b.serviceInfo.adminFields)},error:function(f){c(b.serviceInfo.fields)}})}),function(h){c(b.serviceInfo.fields)})}},openMapSettingsDlg:function(){var b=(new K.Dialog({"class":"esriAGOMapSettingsDialog"})).placeAt(document.body),c=new arcgisonline.sharing.dijit.dialog.MapSettingsDlg({id:"mapSettingsDlg",dialog:b});b.set({title:esri.i18nBundle.MapSettingsDlg.timeSettings,content:c});b.show();c.start()},onUTCOffsetChange:function(){var b=arcgisonline.map.table.openTableMapLayerSubId;
if(arcgisonline.map.table.openTableMapLayerId){var c=arcgisonline.map.main.getParameterListById(arcgisonline.map.table.openTableMapLayerId);arcgisonline.map.table.refreshTablePrep(c,b)}},applyUTCOffsetToMS:function(b){var c=arcgisonline.map.main.map.utcOffset;if(esri.isDefined(c)){var d=-1*(new Date).getTimezoneOffset();b=b-6E4*d+6E4*c}return b},getWebmapId:function(){return arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.id:null},getWebmapTitle:function(){return arcgisonline.map.save_open.webMapInfo?
arcgisonline.map.save_open.webMapInfo.title:null},updateRecentWebMaps:function(b){arcgisonline.map.main.storeRecentMapsHandler||(arcgisonline.map.main.storeRecentMapsHandler=e.subscribe("onSaveExistingWebMap",function(h){arcgisonline.map.main.storeRecentWebMaps()}),e.subscribe("onWebMapSave",function(h,f,r,q,t){arcgisonline.map.main.storeRecentWebMaps(h,f,t,"thumbnail/ago_downloaded.png")}),e.subscribe("onMapFullyLoaded",function(){arcgisonline.map.save_open.webMapInfo&&arcgisonline.map.main.storeRecentWebMaps()}));
if("none"!==e.style(e.byId("header_map_newMap"),"display")||"none"!==e.style(e.byId("header_map_recentMaps"),"display")){arcgisonline.map.main.recentMapsHandlers=arcgisonline.map.main.recentMapsHandlers||[];var c;window.localStorage&&(c=window.localStorage.getItem("Esri_recent_webmaps"))&&(c=e.json.parse(c));var d=arcgisonline.sharing.util.getUser();if((c=c&&c[d?d.username:window.location.host])&&c.length)if(arcgisonline.map.main.didCheckRecentMaps)arcgisonline.map.main.displayRecentMaps(c,b);else{var l=
[];e.forEach(c,function(h,f){f=l.push;h=arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+h.id},{disableIdentityLookup:!0});f.call(l,h)});l.length?(new e.DeferredList(l)).addCallback(function(h){var f=[];e.forEach(h,function(q){(q=q[1])&&q.id&&f.push({id:q.id,title:q.title,owner:q.owner,thumbnail:q.thumbnail})});if(window.localStorage){var r;window.localStorage&&(r=window.localStorage.getItem("Esri_recent_webmaps"))&&(r=e.json.parse(r));r=r||{};f.length?r[d?d.username:
window.location.host]=f:delete r[d?d.username:window.location.host];window.localStorage.setItem("Esri_recent_webmaps",e.json.stringify(r))}arcgisonline.map.main.displayRecentMaps(f,b)}):arcgisonline.map.main.displayRecentMaps([],b);arcgisonline.map.main.didCheckRecentMaps=!0}else arcgisonline.map.main.displayRecentMaps(c,b);arcgisonline.map.main.checkTitleDiv()}},displayRecentMaps:function(b,c){b&&b.length&&(b=e.filter(b,function(h){return esri.isDefined(c)&&c===h.id||!esri.isDefined(c)&&arcgisonline.map.save_open.webMapInfo&&
h.id===arcgisonline.map.save_open.webMapInfo.id?!1:!0}));if(b&&b.length){e.byId("webmap-recentMap-new-link").innerHTML='\x3cspan style\x3d"margin-right: 4px;vertical-align: -4px;" class\x3d"esriPublishIcon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.createNewMap;e.disconnect(arcgisonline.map.main.recentMapsHandlers["new"]);arcgisonline.map.main.recentMapsHandlers["new"]=e.connect(e.byId("webmap-recentMap-new-link"),"onclick",e.hitch(this,function(h){h.preventDefault();arcgisonline.map.main.openNewMap()}));
for(var d=0;5>d;d++)e.style(e.byId("webmap-recentMap-title"),"display","none"),e.style(e.byId("webmap-recentMap-"+d+"-link"),"display","none"),e.disconnect(arcgisonline.map.main.recentMapsHandlers[d]);b.reverse();var l=0;e.forEach(b,function(h){if(!(4<l)){var f='\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:270px;"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"width:77px;" valign\x3d"top"\x3e',r=h.thumbnail||arcgisonline.sharing.util.getStaticImagesUrl()+"/desktopapp.png";-1<r.indexOf("thumbnail/")&&
(r=esriGeowConfig.restBaseUrl+"content/items/"+h.id+"/info/"+r);var q=arcgisonline.sharing.util.getUser();q&&q.token&&(r+="?token\x3d"+q.token);q=h.title;75<q.length&&(q=q.substring(0,72)+"...");f=f+("\x3cimg src\x3d'"+r+"' border\x3d'0' style\x3d'width:67px; height:44px;'/\x3e\x3c/td\x3e\x3ctd style\x3d'width:190px; white-space:normal;' valign\x3d'top'\x3e\x3cspan\x3e")+(q+"\x3c/span\x3e");f+="\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e";e.byId("webmap-recentMap-"+l+"-link").innerHTML=f;e.style(e.byId("webmap-recentMap-"+
l+"-link"),"display","");e.style(e.byId("webmap-recentMap-title"),"display","");arcgisonline.map.main.recentMapsHandlers[l]=e.connect(e.byId("webmap-recentMap-"+l+"-link"),"onclick",e.hitch(this,function(t){t.preventDefault();t=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+h.id;1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(t,null,arcgisonline.map.main.mapLayers,arcgisonline.map.main.mapTables,arcgisonline.map.save_open.webMapInfo?
arcgisonline.map.save_open.webMapInfo.title:null):document.location=t}));l++}});e.style(e.byId("header_map_newMap"),"display","none");e.style(e.byId("header_map_recentMaps"),"display","");esriGeowConfig.isRightToLeft?(b=e.coords(e.byId("header_map_recentMaps")),b=b.x+b.w,d=e.query(".js-dropdown-menu",e.byId("header_map_recentMaps"))[0],310>b?e.style(d,"left","5px"):e.style(d,"left","auto")):(b=window.innerWidth-e.coords(e.byId("header_map_recentMaps")).x,d=e.query(".js-dropdown-menu",e.byId("header_map_recentMaps"))[0])}else e.style(e.byId("header_map_recentMaps"),
"display","none"),e.style(e.byId("header_map_newMap"),"display","")},storeRecentWebMaps:function(b,c,d,l){var h;window.localStorage&&(h=window.localStorage.getItem("Esri_recent_webmaps"))&&(h=e.json.parse(h));h=h||{};var f=arcgisonline.sharing.util.getUser();var r=h[f?f.username:window.location.host]||[];r=e.filter(r,function(q){return q.id!==(b||arcgisonline.map.save_open.webMapInfo.id)});r.push({id:b||arcgisonline.map.save_open.webMapInfo.id,title:d||arcgisonline.map.save_open.webMapInfo.title,
owner:c||arcgisonline.map.save_open.webMapInfo.owner,thumbnail:l||arcgisonline.map.save_open.webMapInfo.thumbnail});10<r.length&&r.splice(0,1);window.localStorage&&(h[f?f.username:window.location.host]=r,window.localStorage.setItem("Esri_recent_webmaps",e.json.stringify(h)));arcgisonline.map.main.updateRecentWebMaps(b)},hideRouteLayer:function(b){arcgisonline.map.main.showRouteLayer();arcgisonline.map.main.hiddenRouteLayers=[];e.forEach(arcgisonline.map.main.mapLayers,function(c){c.itemId===b&&(c.layers?
e.forEach(c.layers,function(d){d.visible&&(d.hide(),arcgisonline.map.main.hiddenRouteLayers.push(d))}):(c.layer.hide(),arcgisonline.map.main.hiddenRouteLayers.push(c.layer)))})},showRouteLayer:function(){arcgisonline.map.main.hiddenRouteLayers=arcgisonline.map.main.hiddenRouteLayers||[];e.forEach(arcgisonline.map.main.hiddenRouteLayers,function(b){b.show()});delete arcgisonline.map.main.hiddenRouteLayers},getPictureMarkerSize:function(b){var c=new e.Deferred;if(!b||10>b.length||0!==b.indexOf("http"))c.errback();
else{arcgisonline.map.main.testImageHandler&&e.disconnect(arcgisonline.map.main.testImageHandler);arcgisonline.map.main.testImageHandler=e.connect(e.byId("viewer_testImage"),"onload",function(){clearTimeout(d);d=null;var l=e.style(e.byId("viewer_testImage"),"width"),h=e.style(e.byId("viewer_testImage"),"height");1==l&&1==h||0===l||0===h?c.errback():c.callback([l,h])},{});var d=setTimeout(e.hitch(this,function(){clearTimeout(d);d=null;c.errback()}),5E3);e.byId("viewer_testImage").src=b;return c}},
getTitleFromUrl:function(b,c){if(!b)return null;var d=null,l=b.toLowerCase();-1<l.indexOf("/mapserver",10)?(d=b.substring(0,l.indexOf("/mapserver",10)),d=d.substring(d.lastIndexOf("/")+1,d.length)):-1<l.indexOf("/vectortileserver")?(d=b.substring(0,l.indexOf("/vectortileserver")),d=d.substring(d.lastIndexOf("/")+1,d.length)):-1<l.indexOf("/imageserver")?(d=b.substring(0,l.indexOf("/imageserver")),d=d.substring(d.lastIndexOf("/")+1,d.length)):-1<l.indexOf("/featureserver")?(d=b.substring(0,l.indexOf("/featureserver")),
d=d.substring(d.lastIndexOf("/")+1,d.length)):c&&c.documentInfo&&c.documentInfo.Title&&0<c.documentInfo.Title.length?d=c.documentInfo.Title:c&&c.mapName&&0<c.mapName.length&&(d=c.mapName);d&&-1<d.indexOf("%")&&(d=arcgisonline.map.main.decodeUrl(d));return d=arcgisonline.sharing.util.stripHTML(d)},getSpecialTitle:function(b){var c=null;if("BingMapsRoad"===b.type||"BingMapsRoad"===b.layerType)c="Bing Maps Road";else if("BingMapsAerial"===b.type||"BingMapsAerial"===b.layerType)c="Bing Maps Aerial";else if("BingMapsHybrid"===
b.type||"BingMapsHybrid"===b.layerType)c="Bing Maps Hybrid";else if("OpenStreetMap"===b.type||"OpenStreetMap"===b.layerType)c="OpenStreetMap";return c},getLayerTitle:function(b,c){var d=b.title;if(b.layer&&b.layer.layerInfos)arcgisonline.map.main.hasDynamicLayers(b)?e.forEach(b.itemLayers,function(h){c===h.id&&h.name&&(d+=" - "+h.name)}):(b=arcgisonline.map.main.getItemWithId(b.layer.layerInfos,c),b.name&&(d+=" - "+b.name));else if(b.layers||b.tables){var l=b.layers;b.tables&&(l=l.concat(b.tables));
b=arcgisonline.map.main.getItemWithId(l,b.id+"_"+c);b.name&&(d+=" - "+b.name)}return d},getTitleForBasemapLayer:function(b){var c=b.title&&b.title!==arcgisonline.map.main.mapLayers[0].title?b.title:null,d=arcgisonline.sharing.util,l=d.stripHTML;if(!(c=b.itemId&&b.itemCard&&b.itemCard.title||c||b.layer&&b.layer.name))if(c=b.url||b.templateUrl,b.layer instanceof esri.layers.VectorTileLayer&&b.itemCard&&(c=b.itemCard.url),c){var h=arcgisonline.map.main.getTitleFromUrl(c,b.serviceInfo);h||(h=c.substring(c.indexOf("://")+
3).replace(/\//g,"-"));c=h}else c=null;return l.call(d,c||b.title||"No Name")},isBlankViewer:function(){if(arcgisonline.map.save_open.webMapItemCard||arcgisonline.map.save_open.itemCard)return!1;var b=arcgisonline.sharing.util.urlToObject(document.URL);b.query=b.query||{};delete b.query.useExisting;return arcgisonline.isEmpty(b.query)?!0:0===arcgisonline.map.main.numOperationalLayers()&&0===arcgisonline.map.main.numMapNotesLayers()?!0:!1},hasMapOnly:function(){var b=arcgisonline.sharing.util.urlToObject(document.URL);
b.query=b.query||{};return b.query.mapOnly&&"true"===b.query.mapOnly?!0:!1},isItemFromSamePortal:function(b){return b&&b.restBaseUrl&&-1===esriGeowConfig.restBaseUrl.indexOf(b.restBaseUrl)?!1:!0},setupMapAlert:function(){arcgisonline.map.main.handlers=arcgisonline.map.main.handlers||{};e.byId("alertDiv")||(e.create("div",{id:"alertDiv","class":"alertIcon",style:"display:none;"},e.byId("map")),arcgisonline.map.main.handlers.onLayerUpdateHandler&&e.unsubscribe(arcgisonline.map.main.handlers.onLayerUpdateHandler),
arcgisonline.map.main.handlers.updateEndHandler&&e.unsubscribe(arcgisonline.map.main.handlers.updateEndHandler),delete arcgisonline.map.main.handlers.onLayerUpdateHandler,delete arcgisonline.map.main.handlers.updateEndHandler);arcgisonline.map.main.handlers.onLayerUpdateHandler=e.subscribe("onLayerUpdate",null,e.hitch(this,function(b){arcgisonline.map.main.checkMapAlert()}));arcgisonline.map.main.handlers.updateEndHandler||(arcgisonline.map.main.handlers.updateEndHandler=arcgisonline.map.main.map.on("update-end",
e.hitch(this,function(){arcgisonline.map.main.checkMapAlert()})));arcgisonline.map.main.handlers.updateStartHandler||(arcgisonline.map.main.handlers.updateStartHandler=arcgisonline.map.main.map.on("update-start",e.hitch(this,function(){})))},checkMapAlert:function(b){arcgisonline.map.main.alertHandler||"execute"===b?b&&(arcgisonline.map.main.queryLimitExceededLayers=[],e.forEach(arcgisonline.map.main.mapLayers,function(c){if(c){var d=c.layer;d&&"esri.layers.FeatureLayer"===d.declaredClass&&!d.hasAllFeatures()&&
arcgisonline.map.main.createMapAlert(c)}}),arcgisonline.map.main.queryLimitExceededLayers.length?e.byId("alertDiv")&&e.style(e.byId("alertDiv"),"display",""):e.byId("alertDiv")&&e.style(e.byId("alertDiv"),"display","none")):arcgisonline.map.main.alertHandler=setTimeout(function(){delete arcgisonline.map.main.alertHandler;arcgisonline.map.main.checkMapAlert("execute")},2E3)},createMapAlert:function(b){if(b.layer&&!b.layer.suspended){-1===e.indexOf(arcgisonline.map.main.queryLimitExceededLayers,b.title)&&
arcgisonline.map.main.queryLimitExceededLayers.push({title:b.title,hasFeatureReduction:b.layer.hasFeatureReduction&&b.layer.hasFeatureReduction(),hasUpdateError:b.layer.hasUpdateError()});if(1===arcgisonline.map.main.queryLimitExceededLayers.length)var c=b.layer.hasFeatureReduction&&b.layer.hasFeatureReduction()?b.layer.hasUpdateError()?e.string.substitute(esri.i18nBundle.viewer.layer.queryLimitExceededSingleMsgCluster,{name:b.title}):e.string.substitute(esri.i18nBundle.viewer.layer.queryLimitExceededSingleMsgCluster,
{name:b.title})+" "+esri.i18nBundle.viewer.layer.queryLimitExceededClusterTooMany:b.layer.hasUpdateError()?e.string.substitute(esri.i18nBundle.viewer.layer.queryLimitExceededSingleMsg,{name:b.title}):e.string.substitute(esri.i18nBundle.viewer.layer.queryLimitExceededSingleMsg,{name:b.title})+" "+esri.i18nBundle.viewer.layer.queryLimitExceededTooMany;else{for(var d=b=!1,l=0;l<arcgisonline.map.main.queryLimitExceededLayers.length;l++)arcgisonline.map.main.queryLimitExceededLayers[l].hasFeatureReduction&&
(b=!0),arcgisonline.map.main.queryLimitExceededLayers[l].hasUpdateError&&(d=!0);c=b?d?esri.i18nBundle.viewer.layer.queryLimitExceededMultipleMsgCluster:esri.i18nBundle.viewer.layer.queryLimitExceededMultipleMsgCluster+" "+esri.i18nBundle.viewer.layer.queryLimitExceededClusterTooMany:d?esri.i18nBundle.viewer.layer.queryLimitExceededMultipleMsg:esri.i18nBundle.viewer.layer.queryLimitExceededMultipleMsg+" "+esri.i18nBundle.viewer.layer.queryLimitExceededTooMany;c+="\x3cul\x3e";e.forEach(arcgisonline.map.main.queryLimitExceededLayers,
function(h){c+="\x3cli\x3e"+h.title+"\x3c/li\x3e"});c+="\x3c/ul\x3e"}arcgisonline.map.layer.tooManyFeaturesTooltip&&arcgisonline.map.layer.tooManyFeaturesTooltip.destroy();arcgisonline.map.layer.tooManyFeaturesTooltip=new K.Tooltip({connectId:e.byId("alertDiv"),label:"\x3cdiv class\x3d'tooManyFeaturesTooltip' style\x3d'width:350px;'\x3e"+c+"\x3c/div\x3e",position:["above","after"]})}},refreshMapTables:function(){var b=arcgisonline.map.storage.buildWebMapText().tables||[];e.forEach(arcgisonline.map.main.mapLayers,
function(c){!c.url&&c.tables&&e.forEach(c.tables,function(d){var l=d.toJson();l.id=d.id;l.title=c.title+" - "+d.name;b.push(l)})});arcgisonline.map.main.map.tables=b},setupHandlerForCache:function(){var b=arcgisonline.sharing.util.getUser();b&&b.accountId&&e.subscribe("layerAdded",e.hitch(this,function(c){(c=arcgisonline.map.main.getParameterListById(c))&&c.url&&c.itemCard&&arcgisonline.sharing.util.isHostedService(c.url)&&-1<c.url.toLowerCase().indexOf("/featureserver")&&(e.connect(c.layer,"onAddAttachmentComplete",
e.hitch(this,function(d){arcgisonline.map.main.ignoreCache(d)},c)),e.connect(c.layer,"onDeleteAttachmentsComplete",e.hitch(this,function(d){arcgisonline.map.main.ignoreCache(d)},c)))}))},initIgnoreCache:function(b){var c=new e.Deferred,d=arcgisonline.sharing.util.getUser();if(!(d&&b.url&&b.itemCard&&arcgisonline.sharing.util.isHostedService(b.url))||-1===e.indexOf(b.itemCard.typeKeywords,"Hosted Service")||-1===b.url.toLowerCase().indexOf("/featureserver")||b.itemCard.owner!==d.username&&"update"!==
b.itemCard.itemControl&&"admin"!==b.itemCard.itemControl)return c.callback(),c;d=b.url.toLowerCase().indexOf("/featureserver");var l=b.url.substring(0,d+14).replace("/rest/services","/rest/admin/services"),h=function(q){if(q.adminServiceInfo&&esri.isDefined(q.adminServiceInfo.cacheMaxAge)&&0<q.adminServiceInfo.cacheMaxAge&&q.layers){var t=0;e.forEach(q.layers,function(w){w.editingInfo&&w.editingInfo.lastEditDate&&(t=Math.max(t,w.editingInfo.lastEditDate))});0<t&&((new Date).getTime()-t)/1E3<q.adminServiceInfo.cacheMaxAge&&
arcgisonline.map.main.ignoreCache(b)}};arcgisonline.map.main.adminLayerInfos=arcgisonline.map.main.adminLayerInfos||{};if(arcgisonline.map.main.adminLayerInfos[l]){var f=function(q){var t=arcgisonline.map.main.adminLayerInfos[l];"failed"===t?q.callback():"inProgress"===t?setTimeout(e.hitch(this,function(){f(q)}),1E3):(h(t),q.callback())};f(c)}else{arcgisonline.map.main.adminLayerInfos[l]="inProgress";var r={f:"json",_ts:Math.round((new Date).getTime()/1E4)};arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,
function(q){r.token=q;esri.request({url:l,content:r,callbackParamName:"callback",load:e.hitch(this,function(t){arcgisonline.map.main.adminLayerInfos[l]=t;h(t);c.callback()}),error:function(t){arcgisonline.map.main.adminLayerInfos[l]="failed";c.callback()}})}),function(){arcgisonline.map.main.adminLayerInfos[l]="failed";c.callback()})}return c},ignoreCache:function(b){if(-1!==document.location.href.indexOf("viewer.html")){var c=arcgisonline.sharing.util.getUser();if(c&&b.url&&b.itemCard&&arcgisonline.sharing.util.isHostedService(b.url)&&
-1!==b.url.toLowerCase().indexOf("/featureserver")&&(b.itemCard.owner===c.username||"update"===b.itemCard.itemControl||"admin"===b.itemCard.itemControl)){c=b.url.toLowerCase().indexOf("/featureserver");var d=b.url.substring(0,c+14),l=d.replace("/rest/services","/rest/admin/services");arcgisonline.map.main.adminLayerInfos=arcgisonline.map.main.adminLayerInfos||{};(b=arcgisonline.map.main.adminLayerInfos[l])&&b.adminServiceInfo&&esri.isDefined(b.adminServiceInfo.cacheMaxAge)&&0!==b.adminServiceInfo.cacheMaxAge&&
(d=d.substring(7),l=l.substring(7),arcgisonline.map.main.cacheTimestamp=(new Date).getTime(),arcgisonline.map.main.requestPreCallbacks=arcgisonline.map.main.requestPreCallbacks||{},arcgisonline.map.main.requestPreCallbacks[d]||(arcgisonline.map.main.requestPreCallbacks[d]=!0,esri.setRequestPreCallback(e.hitch(this,function(h){h.url&&(-1<h.url.indexOf(d)||-1<h.url.indexOf(l))&&(h.content=h.content||{},h.content._ts=arcgisonline.map.main.cacheTimestamp);return h}))))}}},corsCheck:function(b){var c=
b.tileIndexUrl||b.url;!c||arcgisonline.sharing.util.isHostedService(c)||esri.hasSameOrigin(c,window.location.href)||-1===e.indexOf("esri.layers.FeatureLayer esri.layers.StreamLayer esri.layers.MapImageLayer esri.layers.ArcGISDynamicMapServiceLayer esri.layers.ArcGISImageServiceLayer esri.layers.ArcGISImageServiceVectorLayer esri.layers.ArcGISTiledMapServiceLayer".split(" "),b.declaredClass)||(arcgisonline.map.main.telemetry||(arcgisonline.map.main.telemetry=arcgisonline.telemetry.default.init({name:"Map Viewer",
config:esriGeowConfig.self,logPageView:!1})),esri.canUseXhr(c)?arcgisonline.map.main.telemetry.logEvent({eventType:"click",category:"CORS",label:"yes"}):arcgisonline.map.main.telemetry.logEvent({eventType:"click",category:"CORS",label:"no"}))},logFeatureLayerLoadTime:function(b){esriGeowConfig.usageTrackingEnabled&&!arcgisonline.sharing.util.isPortal()&&(arcgisonline.map.main.telemetry||(arcgisonline.map.main.telemetry=arcgisonline.telemetry.default.init({name:"Map Viewer",config:esriGeowConfig.self,
logPageView:!1})),b.onUpdateStartHndl=e.connect(b.layer,"onUpdateStart",function(){b.onUpdateStartTime=(new Date).getTime();e.disconnect(b.onUpdateStartHndl);delete b.onUpdateStartHndl}),b.onUpdateEndHndl=e.connect(b.layer,"onUpdateEnd",function(){var c=(new Date).getTime();if(b.onUpdateStartTime){var d=c-b.onUpdateStartTime;c=arcgisonline.sharing.util.isHostedService(b.url);var l=b.url;switch(b.layer.geometryType){case "esriGeometryPoint":var h="point";break;case "esriGeometryMultiPoint":h="multipoint";
break;case "esriGeometryPolyline":h="line";break;case "esriGeometryPolygon":h="polygon";break;default:h="unknown"}d={eventType:"performance",category:"load",action:"feature layer",label:"initial load",duration:d,attribute:"geometryType: "+h,details:c?"hosted":"not hosted",count:b.layer.graphics?b.layer.graphics.length:0};c&&(c=-1<l.indexOf("://")?l.split("/")[2]:l.split("/")[0],c=c.split(":")[0],d.urlRequested=c);arcgisonline.map.main.telemetry.logEvent(d);delete b.onUpdateStartTime}e.disconnect(b.onUpdateEndHndl);
delete b.onUpdateEndHndl}))},showRFxEditor:function(b){b&&(arcgisonline.map.main.rasterFunctionEditor?(arcgisonline.map.main.rasterFunctionEditor.set("parent",b.parent),arcgisonline.map.main.rasterFunctionEditor.set("item",b.item),arcgisonline.map.main.rasterFunctionEditor.open()):this.loadNewEditor(b))},updateRFxEditor:function(b){b&&arcgisonline.map.main.rasterFunctionEditor&&b.parent&&arcgisonline.map.main.rasterFunctionEditor.set("parent",b.parent)},loadNewEditor:function(b){b=b||{};b.showOnStart=
!0;arcgisonline.map.main.rasterFunctionEditor=null;b=new arcgisonline.sharing.dijit.RasterFunctionEditor(b,e.place(e.create("div"),document.body,"last"));b.startup();e.place(b.domNode,document.body);arcgisonline.map.main.rasterFunctionEditor=b},dojoPatch:function(){e.mixin(K.byId("dijitToolbar"),{_onContainerKeypress:function(b){if(!b.ctrlKey&&!b.altKey&&b.keyCode!=e.keys.HOME&&b.keyCode!=e.keys.END&&b.keyCode!=e.keys.LEFT_ARROW&&b.keyCode!=e.keys.RIGHT_ARROW){var c=this._keyNavCodes[b.charOrCode];
c&&(c(),event.stop(b))}}})}}})},"arcgisonline/map/popup":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/map/main,arcgisonline/map/dijit/StructuredPopupWidget,esri/tasks/RelationshipQuery,esri/ArcadeExpression,esri/arcadeProfiles/popupProfile,dojo/promise/all,dijit/DropDownMenu,dijit/PopupMenuItem,dijit/MenuItem,dojo/aspect,esri/layers/ArcGISImageServiceVectorLayer,esri/layers/ArcGISImageServiceLayer,esri/layers/RasterXLayer"],function(e,K,p){e.provide("arcgisonline.map.popup");
e.require("arcgisonline.map.main");e.require("arcgisonline.map.dijit.StructuredPopupWidget");e.require("esri.tasks.RelationshipQuery");e.require("esri.ArcadeExpression");e.require("esri.arcadeProfiles.popupProfile");e.require("dojo.promise.all");e.require("dijit.DropDownMenu");e.require("dijit.PopupMenuItem");e.require("dijit.MenuItem");e.require("dojo.aspect");e.require("esri.layers.ArcGISImageServiceVectorLayer");e.require("esri.layers.ArcGISImageServiceLayer");e.require("esri.layers.RasterXLayer");
arcgisonline.map.popup={onSelectionChangeHandler:null,feature:null,infoWindowHideHandler:null,footprintGraphic:null,onInfoWindowShowHandle:null,onClickEditLinkHandle:null,addEditLink:function(a,g){if(!isEmbedded||!isEmbedded.hideEdit&&!isEmbedded.isItemDetail){var m=a.getLayer();if(!(m&&m.getFeatureReduction&&m.getFeatureReduction())){m=e.query(".actionList",arcgisonline.map.main.map.infoWindow.domNode)[0];var n=e.query(".zoomTo",m);n&&n.length&&e.style(n[0],"whiteSpace","nowrap");n=e.byId("popupEditLink");
n||(e.create("span",{innerHTML:" "},m),m=e.create("span",{id:"popupEditLink","class":"action",style:"white-space: nowrap"},m),9>e.isIE&&e.create("br",null,m),n=e.create("a",{innerHTML:esri.i18nBundle.common.edit,href:"javascript:void(0);"},m));arcgisonline.map.popup.onClickEditLinkHandle&&(e.disconnect(arcgisonline.map.popup.onClickEditLinkHandle),arcgisonline.map.popup.onClickEditLinkHandle=null);arcgisonline.map.popup.onClickEditLinkHandle=e.connect(n,"onclick",function(b){b.preventDefault();(b=
(b=a.getLayer())&&arcgisonline.map.main.getParameterList(b))&&arcgisonline.map.featColl.isFeatureCollection(b);b&&b.itemId&&b.itemCard&&-1<b.itemCard.typeKeywords.indexOf("Route Layer")?arcgisonline.map.leftPanel.openLeftDirectionsPanel(null,{itemId:b.itemId}):arcgisonline.map.leftPanel.openLeftEditPanel(null,{feature:a,mapPoint:g})})}}},removeEditLink:function(){var a=e.byId("popupEditLink");a&&e.destroy(a)},addAddToMapLink:function(a,g){g=a.attributes.type;arcgisonline.map.popup.infoWindowHideHandler&&
e.disconnect(arcgisonline.map.popup.infoWindowHideHandler);arcgisonline.map.popup.footprintGraphic&&(arcgisonline.map.main.map.graphics.remove(arcgisonline.map.popup.footprintGraphic),arcgisonline.map.popup.footprintGraphic=null);if(a.attributes.xmin&&a.attributes.ymin&&a.attributes.xmax&&a.attributes.ymax){var m=new esri.geometry.Extent(a.attributes.xmin,a.attributes.ymin,a.attributes.xmax,a.attributes.ymax,a.getLayer().fullExtent.spatialReference),n=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,
new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new e.Color([0,0,0]),1),new e.Color([0,0,0,.2]));arcgisonline.map.popup.footprintGraphic=new esri.Graphic(m,n);arcgisonline.map.main.map.graphics.add(arcgisonline.map.popup.footprintGraphic);arcgisonline.map.popup.infoWindowHideHandler=e.connect(arcgisonline.map.main.map.infoWindow,"onHide",e.hitch(this,function(){arcgisonline.map.popup.footprintGraphic&&(arcgisonline.map.main.map.graphics.remove(arcgisonline.map.popup.footprintGraphic),
arcgisonline.map.popup.footprintGraphic=null);e.disconnect(arcgisonline.map.popup.infoWindowHideHandler)}))}m=function(){var d=a.attributes.link;d&&(arcgisonline.map.save_open.addServiceByUrl(d,null),arcgisonline.map.main.map.infoWindow.hide())};n=function(){var d=a.attributes.link;d&&(arcgisonline.map.save_open.switchBaseMapByUrl(d),arcgisonline.map.main.map.infoWindow.hide())};var b=e.query(".actionList",arcgisonline.map.main.map.infoWindow.domNode)[0],c=e.query(".zoomTo",b);c&&c.length&&e.style(c[0],
"whiteSpace","nowrap");c=e.byId("addToMap");c||(e.create("span",{innerHTML:" "},b),c=e.create("span",{id:"addToMap","class":"action",style:"white-space: nowrap"},b),9>e.isIE&&e.create("br",null,c),b=e.create("a",{innerHTML:esri.i18nBundle.arcGISOnlineServices.addToMap,alt:esri.i18nBundle.arcGISOnlineServices.addToMap,title:esri.i18nBundle.arcGISOnlineServices.addToMap,"class":"esriItemLinks",href:"JavaScript:void(0);",onclick:e.hitch(this,m)},c),"MapServer"!=g&&"ImageServer"!=g)||(g=e.create("div",
{innerHTML:"","class":"dijitReset dijitInline esriArrows",title:esri.i18nBundle.siteHeader.moreOptions,alt:esri.i18nBundle.siteHeader.moreOptions,style:{marginLeft:"5px",cursor:"pointer"}},c),new arcgisonline.sharing.dijit.TextMenu({triggerNode:g,labelNode:b,textMenuItems:[{label:esri.i18nBundle.arcGISOnlineServices.addToMap,onClick:e.hitch(this,m)},{label:esri.i18nBundle.arcGISOnlineServices.useAsBasemap,onClick:e.hitch(this,n)}]}))},removeAddToMapLink:function(){arcgisonline.map.popup.footprintGraphic&&
(arcgisonline.map.main.map.graphics.remove(arcgisonline.map.popup.footprintGraphic),arcgisonline.map.popup.footprintGraphic=null);arcgisonline.map.popup.infoWindowHideHandler&&e.disconnect(arcgisonline.map.popup.infoWindowHideHandler);arcgisonline.map.popup.infoWindowZoomToHandler&&e.disconnect(arcgisonline.map.popup.infoWindowZoomToHandler);var a=e.byId("addToMap");a||e.destroy(a)},addDirectionsLink:function(a,g){if(arcgisonline.map.role.canShowDirections()&&(!isEmbedded||!isEmbedded.hideDirections&&
!isEmbedded.isItemDetail)){arcgisonline.map.popup.removeDirectionsLink();var m=a.getLayer();if(!(m instanceof esri.layers.WMSLayer||m&&m.getFeatureReduction&&m.getFeatureReduction())){if(!m.map){var n=arcgisonline.map.main.map.popupManager.getMapLayer(a);if(n){if(n=arcgisonline.map.main.getParameterList(n),!n)return}else return}(n=m&&arcgisonline.map.main.getParameterList(m))&&arcgisonline.map.featColl.isFeatureCollection(n);if(!(n&&n.itemId&&n.itemCard&&-1<n.itemCard.typeKeywords.indexOf("Route Layer"))&&
(m=arcgisonline.sharing.util.getUser())&&m.accountId){m=e.query(".actionList",arcgisonline.map.main.map.infoWindow.domNode)[0];(n=e.query(".zoomTo",m))&&n.length&&e.style(n[0],"whiteSpace","nowrap");var b=a.attributes.RouteLayerItemID||a.attributes.routelayeritemid;n=e.byId("popupDirectionsLink");n||(e.create("span",{innerHTML:" "},m),m=e.create("span",{id:"popupDirectionsLink","class":"action directions",style:"white-space: nowrap"},m),9>e.isIE&&e.create("br",null,m),n=e.create("a",{innerHTML:b?
esri.i18nBundle.viewer.popup.openRoute:esri.i18nBundle.viewer.popup.directions,href:"javascript:void(0);"},m),arcgisonline.map.popup.directionsLinkHandler=e.connect(n,"onclick",e.hitch(this,function(c,d,l){l.preventDefault();(l=c.geometry)?"point"!==l.type&&(l=new esri.geometry.Point(d.x,d.y,c.geometry.spatialReference)):l=new esri.geometry.Point(d.x,d.y,d.spatialReference);d=c.getLayer();var h=d.name;if(!d.map){var f=arcgisonline.map.main.map.popupManager.getMapLayer(c);f&&(f=arcgisonline.map.main.getParameterList(f),
"mapNotes"===f.type&&(h=f.title))}if(b){arcgisonline.map.main.map.infoWindow.hide();var r=e.filter(arcgisonline.map.main.mapLayers,function(w){if(w.itemId===b)return w});if(r.length)r[0].visibility||(r[0].visibility=!0,e.forEach(r[0].visibleLayers.split(","),function(w){r[0].layers[parseInt(w)].visible||r[0].layers[parseInt(w)].show()}),e.publish("onLayerUpdate",["reopen"])),arcgisonline.map.dijit.toc.options.showTocTools(r[0].id);else{var q=e.connect(arcgisonline.map.main.map,"onLayerAdd",e.hitch(this,
function(w){e.disconnect(q);q=null;(w=arcgisonline.map.main.getParameterList(w))&&arcgisonline.map.dijit.toc.options.showTocTools(w.id)}));setTimeout(function(){q&&e.disconnect(q)},3E4);arcgisonline.map.save_open.openServiceItemCards(b,!1)}"contentStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()||arcgisonline.map.main.hasMapOnly()||arcgisonline.map.leftPanel.openLeftTOCPanel()}else{f=arcgisonline.map.main.getDirectionsDisplayField(d);f=c.attributes[f];var t="";d.objectIdField&&esri.isDefined(c.attributes[d.objectIdField])&&
(t=c.attributes[d.objectIdField]);c=new esri.Graphic(l,null,{layerName:h,objectIdInLayer:t,displayName:f});arcgisonline.map.leftPanel.openLeftDirectionsPanel(null,{feature:c})}},a,g)))}}}},removeDirectionsLink:function(){arcgisonline.map.popup.directionsLinkHandler&&(e.disconnect(arcgisonline.map.popup.directionsLinkHandler),arcgisonline.map.popup.directionsLinkHandler=null);var a=e.byId("popupDirectionsLink");a&&e.destroy(a)},setupPopupHandler:function(){arcgisonline.map.popup.onSelectionChangeHandler||
!arcgisonline.map.main.map||arcgisonline.map.edit.editActivated||(arcgisonline.map.main.map.setInfoWindowOnClick(!0),arcgisonline.map.popup.onSelectionChangeHandler=e.connect(arcgisonline.map.main.map.infoWindow,"onSelectionChange",e.hitch(arcgisonline.map.popup,"onPopupSelectionChange")))},disablePopupHandler:function(){arcgisonline.map.popup.onSelectionChangeHandler&&(arcgisonline.map.main.map.infoWindow.clearFeatures(),arcgisonline.map.main.map.infoWindow.hide(),arcgisonline.map.main.map.setInfoWindowOnClick(!1),
e.disconnect(arcgisonline.map.popup.onSelectionChangeHandler),arcgisonline.map.popup.onSelectionChangeHandler=null)},onPopupSelectionChange:function(){arcgisonline.map.geocode.removeAddToLayerLink();var a=arcgisonline.map.main.map.infoWindow.getSelectedFeature();if(a){var g=function(m){var n=arcgisonline.map.main.map.infoWindow.location,b=m.getLayer(),c,d=!0;b&&b.isEditable&&b.isEditable()?((c=arcgisonline.sharing.util.getUser())&&arcgisonline.sharing.util.isHostedService(b.url),c=b.getEditCapabilities({feature:m}),
b.mode!==esri.layers.FeatureLayer.MODE_SELECTION&&(c.canUpdate||c.canDelete)?arcgisonline.map.featColl.isFeatureCollectionLayer(b)||b instanceof esri.layers.CSVLayer?!arcgisonline.map.role.isAllowed("tool_edit_featCol")||!arcgisonline.map.role.isAllowed("tool_edit")||isEmbedded&&isEmbedded.hideEdit?arcgisonline.map.mapNotes.isMapNotesFeatColl(b.toJson())&&arcgisonline.map.role.isAllowed("tool_edit_mapNotes")?arcgisonline.map.popup.addEditLink(m,n):arcgisonline.map.popup.removeEditLink():arcgisonline.map.popup.addEditLink(m,
n):!arcgisonline.map.role.isAllowed("tool_edit")||isEmbedded&&isEmbedded.hideEdit?arcgisonline.map.popup.removeEditLink():arcgisonline.map.popup.addEditLink(m,n):arcgisonline.map.popup.removeEditLink()):arcgisonline.map.popup.removeEditLink();(c=arcgisonline.sharing.util.getUser())&&c.accountId&&esriGeowConfig.self.helperServices.route&&esriGeowConfig.self.helperServices.route.url&&(b?arcgisonline.map.popup.addDirectionsLink(m,n):arcgisonline.map.popup.removeDirectionsLink());b&&b.__isFootprintLayer&&
m.attributes&&m.attributes.link&&("MapServer"==m.attributes.type||"ImageServer"==m.attributes.type||"FeatureServer"==m.attributes.type)?arcgisonline.map.popup.addAddToMapLink(m,n):arcgisonline.map.popup.removeAddToMapLink();if(b&&b.relationships&&0<b.relationships.length){(c=m.getInfoTemplate())&&c.info&&(d=!esri.isDefined(c.info.relatedRecordsInfo)||!esri.isDefined(c.info.relatedRecordsInfo.showRelatedRecords)||c.info.relatedRecordsInfo&&c.info.relatedRecordsInfo.showRelatedRecords);var l=e.some(b.relationships,
function(h){h=arcgisonline.map.popup._getRelatedLayerUrl(b.url,h.relatedTableId);selMapTable=arcgisonline.map.popup._findRelatedTable(h).selMapTable;return esri.isDefined(selMapTable)},this);arcgisonline.map.popup.removeRelatedRecordsLink();d&&l&&arcgisonline.map.popup.addRelatedRecordsLink({feature:m,mapPoint:n,relations:b.relationships,relatedRecordsInfo:c.info.relatedRecordsInfo})}else arcgisonline.map.popup.removeRelatedRecordsLink()};arcgisonline.map.main.map.infoWindow.isShowing?g(a):(arcgisonline.map.popup.onInfoWindowShowHandle&&
(e.disconnect(arcgisonline.map.popup.onInfoWindowShowHandle),arcgisonline.map.popup.onInfoWindowShowHandle=null),arcgisonline.map.popup.onInfoWindowShowHandle=e.connect(arcgisonline.map.main.map.infoWindow,"onShow",e.hitch(this,function(m){e.disconnect(arcgisonline.map.popup.onInfoWindowShowHandle);arcgisonline.map.popup.onInfoWindowShowHandle=null;g(m)},a)))}else arcgisonline.map.popup.removeEditLink(),arcgisonline.map.popup.removeAddToMapLink(),arcgisonline.map.popup.removeDirectionsLink();a=e.query(".esri_matchButton");
a.length&&e.addClass(a[0],"calcite orange");a=e.query(".esri_deleteButton");a.length&&e.addClass(a[0],"calcite")},addPopupLayers:function(a){e.forEach(arcgisonline.map.main.mapLayers,function(g){(!a||a&&("base"===g.type||"labels"===g.type))&&g&&g.layer&&!g.layer.infoTemplates&&!g.disablePopup&&(g.itemLayers&&g.itemLayers.length?arcgisonline.map.main.getLayersInfo(g,e.hitch(this,function(){arcgisonline.map.main.hasDynamicLayers(g)?e.forEach(g.itemLayers,function(m){arcgisonline.map.popup.addPopupLayer(g,
m.id)}):e.forEach(g.layer.layerInfos,function(m){arcgisonline.map.popup.addPopupLayer(g,m.id)})})):g.popupInfo&&arcgisonline.map.popup._isImageServiceLayer(g.layer)&&arcgisonline.map.popup.addPopupLayer(g))})},addPopupLayer:function(a,g){if(a)if(arcgisonline.map.featColl.isFeatureCollection(a)||a.layer instanceof esri.layers.CSVLayer)if(a.layers)for(var m=0;m<a.layers.length;m++){if(m===g){var n=a.layers[m].__popupInfo;n&&arcgisonline.map.mapUtil.setInfoTemplate(a.layers[m],n)}}else(n=a.popupInfo)&&
arcgisonline.map.mapUtil.setInfoTemplate(a.layer,n);else if(a.layer instanceof esri.layers.GeoRSSLayer){var b=a.layer.getFeatureLayers()[g];(n=b.__popupInfo)&&arcgisonline.map.mapUtil.setInfoTemplate(b,n)}else if(a.layer instanceof esri.layers.WFSLayer)a.layer.setInfoTemplate(new esri.dijit.PopupTemplate(a.popupInfo));else if(a.layer instanceof esri.layers.StreamLayer)a.popupInfo&&arcgisonline.map.mapUtil.setInfoTemplate(a.layer,a.popupInfo);else if(!g&&0!==g&&arcgisonline.map.popup._isImageServiceLayer(a.layer))a.popupInfo&&
arcgisonline.map.mapUtil.setInfoTemplate(a.layer,a.popupInfo);else if(!g&&0!==g&&a.layer instanceof esri.layers.FeatureLayer)a.popupInfo&&arcgisonline.map.mapUtil.setInfoTemplate(a.layer,a.popupInfo),arcgisonline.map.main.updateLayerScaleInfo(a,a.layer);else{var c=n=null,d=null;b=g;var l=!1,h=[];if(a.itemLayers&&a.itemLayers.length){for(m=0;m<a.itemLayers.length;m++)if(a.itemLayers[m].id===g){arcgisonline.map.main.hasDynamicLayers(a)&&(b=a.itemLayers[m].layerDefinition.source.mapLayerId);a.itemLayers[m].disablePopup&&
(delete a.itemLayers[m].popupInfo,delete a.itemLayers[m].disablePopup);n=a.itemLayers[m].popupInfo;c=a.itemLayers[m].layerUrl;!esriGeowConfig.allSSL&&"https:"!=location.protocol||!arcgisonline.sharing.util.isHostedService(c)&&!arcgisonline.sharing.util.supportsHttps(c)||(c=c.replace("http:","https:"));d=a.itemLayers[m]._layerInfo;if(n&&!d){l=!0;var f=new e.Deferred;h.push(f);arcgisonline.map.main.getLayerInfo(a,b).then(function(r){d=r;a.layer.infoTemplates=a.layer.infoTemplates||{};a.layer.infoTemplates[g]=
{infoTemplate:new esri.dijit.PopupTemplate(n),layerUrl:c,resourceInfo:d};f.callback()})}break}h.length&&(new e.DeferredList(h)).addCallback(function(r){leftPanel&&leftPanel.checkLegendStack()})}n||(m=arcgisonline.map.main.getFlForMSL(a,g))&&m.popupInfo&&(n=m.popupInfo,c=m.url,d=m.serviceInfo);if(n&&!d&&a.layersInfo&&a.layersInfo.layers)for(m=0;m<a.layersInfo.layers.length;m++)if(a.layersInfo.layers[m].id==b){d=a.layersInfo.layers[m];d||(l=!0,arcgisonline.map.main.getLayerInfo(a,b).then(function(r){d=
r;a.layer.infoTemplates=a.layer.infoTemplates||{};a.layer.infoTemplates[g]={infoTemplate:new esri.dijit.PopupTemplate(n),layerUrl:c,resourceInfo:d}}));break}n&&!l&&(a.layer.infoTemplates=a.layer.infoTemplates||{},a.layer.infoTemplates[g]={infoTemplate:new esri.dijit.PopupTemplate(n),layerUrl:c,resourceInfo:d})}},removePopupLayers:function(a){a&&a.layer&&a.layer.infoTemplates&&e.forEach(a.layer.layerInfos,function(g){a.layer.infoTemplates[g.id]&&(arcgisonline.map.main.map.infoWindow.clearFeatures(),
delete a.layer.infoTemplates[g.id])})},removePopup:function(a,g){arcgisonline.map.main.map&&arcgisonline.map.main.map.infoWindow&&arcgisonline.map.main.map.infoWindow.hide();if(arcgisonline.map.featColl.isFeatureCollection(a)||a.layer instanceof esri.layers.CSVLayer)if(a.layers||a.tables){var m=a.layers;a.tables&&(m=m.concat(a.tables));for(var n=0;n<m.length;n++)m[n].id===g&&(arcgisonline.map.mapUtil.setInfoTemplate(m[n],null),m[n].__popupInfo&&delete m[n].__popupInfo)}else arcgisonline.map.mapUtil.setInfoTemplate(a.layer,
null),a.popupInfo&&delete a.popupInfo,a.layer.__popupInfo&&delete a.layer.__popupInfo;else if(a.layer instanceof esri.layers.GeoRSSLayer)g=g||0,a=a.layer.getFeatureLayers(),arcgisonline.map.mapUtil.setInfoTemplate(a[g],null),a[g].__popupInfo&&delete a[g].__popupInfo;else if(a.layer instanceof esri.layers.WFSLayer)arcgisonline.map.mapUtil.setInfoTemplate(a.layer,null),a.popupInfo&&delete a.popupInfo;else if(!g&&0!==g&&(a.layer instanceof esri.layers.FeatureLayer||arcgisonline.map.popup._isImageServiceLayer(a.layer)))arcgisonline.map.mapUtil.setInfoTemplate(a.layer,
null),delete a.popupInfo;else if(a.layer&&a.layer.infoTemplates){if(a.layer.infoTemplates[g])if(arcgisonline.map.main.map.infoWindow.clearFeatures(),delete a.layer.infoTemplates[g],a.itemLayers&&a.itemLayers.length)for(n=0;n<a.itemLayers.length;n++){if(a.itemLayers[n].id===g){delete a.itemLayers[n].popupInfo;delete a.itemLayers[n].layerUrl;delete a.itemLayers[n].layerItemId;delete a.itemLayers[n]._layerInfo;break}}else(g=arcgisonline.map.main.getFlForMSL(a,g))&&delete g.popupInfo;a.thematicGroup&&
(a.disablePopup=!0)}},hasPopup:function(a,g){if(arcgisonline.map.featColl.isFeatureCollection(a)||a.layer instanceof esri.layers.CSVLayer)if(a.layers||a.tables){var m=a.layers;a.tables&&(m=m.concat(a.tables));for(var n=0;n<m.length;n++)if((m[n].id===g||m[n].id===a.id+"_"+g)&&(m[n].__popupInfo||m[n].infoTemplate))return!0}else{if(a.layer.infoTemplate)return!0}else if(a.layer instanceof esri.layers.GeoRSSLayer){if(esri.isDefined(g)){a=a.layer.getFeatureLayers();var b=!1;e.forEach(a,function(c,d){d==
g&&c.infoTemplate&&(b=!0)});return b}if(a.layer.getFeatureLayers()[0].infoTemplate)return!0}else{if(a.layer instanceof esri.layers.WMSLayer&&esri.isDefined(g))return a.layer.layerInfos[g].showPopup;if(a.layer instanceof esri.layers.WFSLayer)return a.layer.infoTemplate?!0:!1;if(esri.isDefined(g))if(m=arcgisonline.map.main.getFlForMSL(a,g)){if(m.popupInfo)return!0}else{if(a.itemLayers&&a.itemLayers.length)for(n=0;n<a.itemLayers.length;n++)if(a.itemLayers[n].id===g)if(a.itemLayers[n].popupInfo)if(a.itemLayers[n].layerUrl||
a.itemLayers[n].layerItemId){if(a.itemLayers[n]._layerInfo)return!0;break}else return!0;else break}else if((arcgisonline.map.popup._isImageServiceLayer(a.layer)||a.layer instanceof esri.layers.FeatureLayer)&&a.popupInfo)return!0}return!1},getPopupInfo:function(a,g){if(arcgisonline.map.featColl.isFeatureCollection(a)||a.layer instanceof esri.layers.CSVLayer)if(a.layers||a.tables){var m=a.layers;a.tables&&(m=m.concat(a.tables));for(var n=0;n<m.length;n++)if((n===g||m[n].id===g)&&m[n].infoTemplate)return m[n].__popupInfo}else{if(a.layer.infoTemplate)return a.popupInfo}else if(a.layer instanceof
esri.layers.GeoRSSLayer)for(a=a.layer.getFeatureLayers(),n=0;n<a.length;n++){if(m=a[n],m.id===g&&m.infoTemplate)return m.__popupInfo}else{if(a.layer instanceof esri.layers.WFSLayer)return a.popupInfo;if(!g&&0!==g)if(arcgisonline.map.popup._isImageServiceLayer(a.layer)||a.layer instanceof esri.layers.FeatureLayer){if(a.popupInfo)return a.popupInfo}else if(n=arcgisonline.map.main.getFlForMSL(a,g)){if(n.popupInfo)return n.popupInfo}else{if(a.itemLayers&&a.itemLayers.length)for(n=0;n<a.itemLayers.length;n++)if(a.itemLayers[n].id===
g){if(a.itemLayers[n].popupInfo)return a.itemLayers[n].popupInfo;break}}else if((g||0===g)&&a.itemLayers&&a.itemLayers.length)for(n=0;n<a.itemLayers.length;n++)if(a.itemLayers[n].id===g){if(a.itemLayers[n].popupInfo)return a.itemLayers[n].popupInfo;break}}return null},getDefaultPopupInfo:function(a,g,m){var n=arcgisonline.map.popup.getDisplayField(a),b=a.fields;e.some(b,function(t){return t.name===n})||(n=null);g=a.name+(n&&n.length?": {"+n+"}":"");var c=!1,d=!1,l=!1;m&&arcgisonline.map.popup._isImageServiceLayer(m)&&
(b=m.getCustomRasterFields({rasterAttributeTableFieldPrefix:"Raster."}),l=0>e.indexOf(["F32","F64"],m.pixelType),m&&m.capabilities&&(d=(c=m.capabilities&&-1<m.capabilities.toLowerCase().indexOf("catalog")||m.fields&&0<m.fields.length)&&("esriImageServiceDataTypeVector-UV"===m.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===m.serviceDataType)));var h={esriFieldTypeDouble:1,esriFieldTypeSingle:1},f={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},r={esriFieldTypeDate:1},q=",";a.editFieldsInfo&&
(a.editFieldsInfo.creatorField&&(q+=a.editFieldsInfo.creatorField+","),a.editFieldsInfo.creationDateField&&(q+=a.editFieldsInfo.creationDateField+","),a.editFieldsInfo.editorField&&(q+=a.editFieldsInfo.editorField+","),a.editFieldsInfo.editDateField&&(q+=a.editFieldsInfo.editDateField+","),q=q.toLowerCase());b=e.map(b,e.hitch(this,function(t,w){(w="esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type&&"esriFieldTypeGUID"!==t.type&&"esriFieldTypeGeometry"!==t.type)&&a.objectIdField&&(w=t.name!==
a.objectIdField);var u,v=t.editable&&"esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type&&"esriFieldTypeGUID"!==t.type;if(w){var x=t.name.toLowerCase(),z=q+"stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,";c&&(z+="raster.itempixelvalue,",d&&(z+="raster.magnitude,raster.direction,"));if(-1<z.indexOf(","+x+",")||-1<x.indexOf("shape")||-1<x.indexOf("perimeter")||-1<x.indexOf("objectid")||-1<x.indexOf("raster.servicepixelvalue.")||-1<x.indexOf("_i")&&
x.indexOf("_i")==x.length-2||t.name===a.objectIdField)w=!1;t.type in f?u={places:0,digitSeparator:!0}:t.type in h?u={places:l&&(-1<x.indexOf("raster.servicepixelvalue")||-1<x.indexOf("raster.itempixelvalue"))?0:2,digitSeparator:!0}:t.type in r&&(10<=a.currentVersion||m&&10<=m.version)&&(u={dateFormat:"shortDateShortTime"})}v=v?-1===q.indexOf(","+t.name.toLowerCase()+","):v;t=e.mixin({},{fieldName:t.name,label:t.alias,isEditable:v,tooltip:"",visible:w,stringFieldOption:"textbox"});u&&(t.format=u);
return t}));g={title:g,fieldInfos:b,description:null,showAttachments:!0,mediaInfos:[]};!m||!this._isImageServiceLayer(m)||m instanceof esri.layers.RasterXLayer||(g.layerOptions={},g.layerOptions.showNoDataRecords=!0,g.layerOptions.returnTopmostRaster=m&&m.currentVersion?10.8<=m.currentVersion:!1);return g},getDisplayField:function(a){var g=a.displayField?a.displayField.trim():null;if(!g&&a.fields&&(g=arcgisonline.map.popup.getFirstNameOrTitleField(a.fields),!g&&(g=arcgisonline.map.popup.getFirstUniqueIdentifierField(a.fields),
!g&&(g=arcgisonline.map.popup.getFirstTypeOrCategoryField(a.fields),!g))))for(var m=0;m<a.fields.length;m++){var n=a.fields[m];if(-1<n.name.toLowerCase().indexOf("name")||-1<n.name.toLowerCase().indexOf("title"))g=n.name}return g},getFirstNameOrTitleField:function(a){for(var g=0;g<a.length;g++){var m=a[g];if(m.description){var n=e.json.parse(m.description);if(n&&"nameOrTitle"===n.fieldValueType)return m.name}}return null},getFirstUniqueIdentifierField:function(a){for(var g=0;g<a.length;g++){var m=
a[g];if(m.description){var n=e.json.parse(m.description);if(n&&"uniqueIdentifier"===n.fieldValueType)return m.name}}return null},getFirstTypeOrCategoryField:function(a){for(var g=0;g<a.length;g++){var m=a[g];if(m.description){var n=e.json.parse(m.description);if(n&&"typeOrCategory"===n.fieldValueType)return m.name}}return null},updateLayerWithPopupFieldAlias:function(a,g,m){var n=arcgisonline.map.popup.getPopupInfo(a,m);n&&n.fieldInfos?e.forEach(g.fields,e.hitch(this,function(b,c){a:{for(c=0;c<n.fieldInfos.length;c++){var d=
n.fieldInfos[c];if(d.fieldName==b.name){c=d.label;break a}}c=null}b.alias=c||b.alias}),this):e.forEach(g.fields,e.hitch(this,function(b,c){a:{if(a.serviceInfo)for(c=0;c<a.serviceInfo.fields.length;c++){var d=a.serviceInfo.fields[c];if(d.name==b.name){c=d.alias;break a}}c=null}b.alias=c||b.alias}),this)},_extentFromPoint:function(a){var g=arcgisonline.map.main.map.toScreen(a);a=new esri.geometry.Point(g.x-5,g.y+5);g=new esri.geometry.Point(g.x+5,g.y-5);a=arcgisonline.map.main.map.toMap(a);g=arcgisonline.map.main.map.toMap(g);
return new esri.geometry.Extent(a.x,a.y,g.x,g.y,arcgisonline.map.main.map.spatialReference)},_calculateClickTolerance:function(a){var g=6;e.forEach(a,function(m){(m=m.layer.renderer)&&"esri.renderer.SimpleRenderer"===m.declaredClass?(m=m.symbol,m.xoffset&&(g=Math.max(g,Math.abs(m.xoffset))),m.yoffset&&(g=Math.max(g,Math.abs(m.yoffset)))):!m||"esri.renderer.UniqueValueRenderer"!==m.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==m.declaredClass||e.forEach(m.infos,function(n){n=n.symbol;n.xoffset&&
(g=Math.max(g,Math.abs(n.xoffset)));n.yoffset&&(g=Math.max(g,Math.abs(n.yoffset)))})});return g},toc_enablePopup:function(a,g){if(arcgisonline.map.featColl.isFeatureCollection(a)||a.layer instanceof esri.layers.CSVLayer)if(a.layers||a.tables){var m=a.layers;a.tables&&(m=m.concat(a.tables));m=m[g];var n=m.getFeatureReduction&&m.getFeatureReduction();n&&n.disablePopup&&(delete n.disablePopup,m.setFeatureReduction(n));m.__popupInfo=arcgisonline.map.featColl.generateDefaultPopupInfo(m.toJson());arcgisonline.map.mapUtil.setInfoTemplate(m,
m.__popupInfo);a.popupChanged=!0;delete m.__disablePopup}else a.layer&&((n=a.layer.getFeatureReduction&&a.layer.getFeatureReduction())&&n.disablePopup&&(delete n.disablePopup,a.layer.setFeatureReduction(n)),a.popupInfo=arcgisonline.map.featColl.generateDefaultPopupInfo(a.layer.toJson()),arcgisonline.map.mapUtil.setInfoTemplate(a.layer,a.popupInfo),a.popupChanged=!0,delete a.disablePopup);else if(a.layer instanceof esri.layers.GeoRSSLayer)m=a.layer.getFeatureLayers(),e.forEach(m,function(l,h){h===
g&&(l.__popupInfo=arcgisonline.map.featColl.generateDefaultPopupInfo(l.toJson()),arcgisonline.map.mapUtil.setInfoTemplate(l,l.__popupInfo),a.popupChanged=!0,delete l.__disablePopup)},this);else if(a.layer instanceof esri.layers.WMSLayer)a.layer.layerInfos[g].showPopup=!0,a.popupChanged=!0;else if(a.layer instanceof esri.layers.WFSLayer)a.popupInfo=arcgisonline.map.popup.getDefaultPopupInfo({name:a.title,fields:a.layer.fields},!1,a.layer),a.layer.setInfoTemplate(new esri.dijit.PopupTemplate(a.popupInfo)),
a.popupChanged=!0,delete a.disablePopup;else if(a.layer instanceof esri.layers.StreamLayer)a.itemId&&(m=arcgisonline.map.itemData.itemDataContents[a.itemId])&&m.popupInfo&&(a.popupInfo=e.clone(m.popupInfo)),a.popupInfo=a.popupInfo||arcgisonline.map.popup.getDefaultPopupInfo(a.serviceInfo,a.layer.isEditable?a.layer.isEditable():!1,a.layer),arcgisonline.map.mapUtil.setInfoTemplate(a.layer,a.popupInfo),a.popupChanged=!0,delete a.disablePopup;else if(a.layer instanceof esri.layers.FeatureLayer||arcgisonline.map.popup._isImageServiceLayer(a.layer))a.itemId&&
a.origItemLayers&&a.url&&(m=parseInt(a.url.substring(a.url.lastIndexOf("/")+1,a.url.length)),(m=arcgisonline.map.main.getItemWithId(a.origItemLayers,m))&&m.popupInfo&&(a.popupInfo=e.clone(m.popupInfo))),(n=a.layer.getFeatureReduction&&a.layer.getFeatureReduction())&&n.disablePopup&&(delete n.disablePopup,a.layer.setFeatureReduction(n)),a.popupInfo=a.popupInfo||arcgisonline.map.popup.getDefaultPopupInfo(a.serviceInfo,a.layer.isEditable?a.layer.isEditable():!1,a.layer),arcgisonline.map.popup.addPopupLayer(a,
null),a.popupChanged=!0,delete a.disablePopup;else if(a.queryServiceUrl){var b=a.layer.layerInfos[g],c=function(l,h){if(a.itemId&&a.origItemLayers){var f=arcgisonline.map.main.getItemWithId(a.origItemLayers,b.id);f&&f.popupInfo&&f.layerUrl===a.queryServiceUrl+"/"+b.id&&(l=e.clone(f.popupInfo))}if(!a.itemLayers||arcgisonline.isEmpty(a.itemLayers))a.itemLayers=[],e.forEach(a.layer.layerInfos,function(q){a.itemLayers.push({id:q.id})}),f=arcgisonline.map.main.getItemWithId(a.itemLayers,b.id),e.mixin(f,
{layerUrl:a.queryServiceUrl+"/"+b.id,layerItemId:a.queryServiceItemId,popupInfo:l,_layerInfo:h});else{f=!1;for(var r=0;r<a.itemLayers.length;r++)if(a.itemLayers[r].id===b.id){a.itemLayers[r].layerUrl=a.queryServiceUrl+"/"+b.id;a.itemLayers[r].layerItemId=a.queryServiceItemId;a.itemLayers[r].popupInfo=l;a.itemLayers[r]._layerInfo=h;f=!0;break}f||a.itemLayers.push({id:b.id,layerUrl:a.queryServiceUrl+"/"+b.id,layerItemId:a.queryServiceItemId,popupInfo:l,_layerInfo:h})}arcgisonline.map.popup.addPopupLayer(a,
b.id);a.popupChanged=!0},d=function(){arcgisonline.map.main.getLayerInfoForQuery(a,b.id,null).then(function(l){var h=!1,f=l.capabilities?l.capabilities.toLowerCase():"";if(-1<f.indexOf("create")||-1<f.indexOf("edit")||-1<f.indexOf("delete")||-1<f.indexOf("update"))h=!0;var r;a.itemId&&a.origItemLayers&&(f=arcgisonline.map.main.getItemWithId(a.origItemLayers,b.id))&&f.popupInfo&&f.layerUrl===a.queryServiceUrl+"/"+b.id&&(r=e.clone(f.popupInfo));r=r||arcgisonline.map.popup.getDefaultPopupInfo(l,h);c(r,
l)})};a.queryServiceItemId?arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a.queryServiceItemId+"/data"},{disableIdentityLookup:!0}).then(e.hitch(this,function(l){if(l&&l.layers){for(var h=!1,f=0;f<l.layers.length;f++)if(b.id==l.layers[f].id){l.layers[f].popupInfo&&(h=!0,c(l.layers[f].popupInfo));break}h||d()}else d()}),e.hitch(this,function(l){d()})):d()}else a.layer instanceof esri.layers.ArcGISTiledMapServiceLayer&&(!a.layer.capabilities||-1===a.layer.capabilities.toLowerCase().indexOf("query"))?
(b=a.layer.layerInfos[g],m=(new K.Dialog).placeAt(document.body),n=new arcgisonline.sharing.dijit.dialog.QueryLayerDlg({dialog:m}),m.set({title:esri.i18nBundle.QueryLayerDlg.title,content:n}),m.show(),n.start(a,b.id)):(b=arcgisonline.map.main.hasDynamicLayers(a)?a.layer.dynamicLayerInfos[g]:a.layer.layerInfos[g],arcgisonline.map.main.getLayerInfoForQuery(a,b.id).then(function(l){var h;if(a.itemId&&a.origItemLayers){var f=arcgisonline.map.main.getItemWithId(a.origItemLayers,b.id);f&&f.popupInfo&&(h=
e.clone(f.popupInfo))}h=h||arcgisonline.map.popup.getDefaultPopupInfo(l,!1,a.layer);if(l=arcgisonline.map.main.getFlForMSL(a,b.id))l.popupInfo=h,l.popupChanged=!0;else if(a.itemLayers){l=!1;for(f=0;f<a.itemLayers.length;f++)if(a.itemLayers[f].id===b.id){a.itemLayers[f].popupInfo=h;l=!0;break}l||a.itemLayers.push({id:b.id,popupInfo:h})}else a.itemLayers=[],e.forEach(a.layer.layerInfos,function(r){a.itemLayers.push({id:r.id})}),f=arcgisonline.map.main.getItemWithId(a.itemLayers,b.id),f.popupInfo=h;
arcgisonline.map.popup.addPopupLayer(a,b.id);a.popupChanged=!0}));arcgisonline.map.main.markMapAsChanged("enablePopup");e.publish("_onRendererUpdate",[])},toc_removePopup:function(a,g){if(arcgisonline.map.featColl.isFeatureCollection(a)||a.layer instanceof esri.layers.CSVLayer)if(a.layers||a.tables){var m=a.layers;a.tables&&(m=m.concat(a.tables));arcgisonline.map.popup.removePopup(a,m[g].id);a.__disablePopup=!0;a.popupChanged=!0}else a.layer&&(arcgisonline.map.popup.removePopup(a),a.disablePopup=
!0,a.popupChanged=!0);else a.layer instanceof esri.layers.GeoRSSLayer?(m=a.layer.getFeatureLayers(),e.forEach(m,function(n,b){b===g&&(arcgisonline.map.popup.removePopup(a,b),n.__disablePopup=!0,a.popupChanged=!0)},this)):(a.layer instanceof esri.layers.WMSLayer?delete a.layer.layerInfos[g].showPopup:a.layer instanceof esri.layers.WFSLayer?arcgisonline.map.popup.removePopup(a):a.layer instanceof esri.layers.FeatureLayer||arcgisonline.map.popup._isImageServiceLayer(a.layer)?(arcgisonline.map.popup.removePopup(a),
a.disablePopup=!0):-1===g?arcgisonline.map.main.hasDynamicLayers(a)?e.forEach(a.layer.dynamicLayerInfos,function(n){arcgisonline.map.popup.removePopup(a,n.id)}):e.forEach(a.layer.layerInfos,function(n){arcgisonline.map.popup.removePopup(a,n.id)}):(m=arcgisonline.map.main.hasDynamicLayers(a)?a.layer.dynamicLayerInfos[g]:a.layer.layerInfos[g],arcgisonline.map.popup.removePopup(a,m.id)),a.popupChanged=!0);arcgisonline.map.main.markMapAsChanged("removePopup");e.publish("_onRendererUpdate",[])},hasFeatureSetMapExpression:function(a){var g=
!1;(a=a.popupInfo)&&a.expressionInfos&&e.forEach(a.expressionInfos,function(m){m=new esri.ArcadeExpression({expression:m.expression,returnType:m.returnType,profile:esri.arcadeProfiles.popupProfile});esri.support.expressionUtils.hasFeatureSetOperations(m.syntaxTree)&&esri.support.expressionUtils.hasVariable(m.syntaxTree,"$map")&&(g=!0)},this);return g},addRelatedRecordsLink:function(a){if(!a)return!1;var g=a.feature,m=a.relations,n=e.query(".actionList",arcgisonline.map.main.map.infoWindow.domNode)[0],
b=e.byId("popupRelationsLink"),c=e.query(".zoomTo",n);c&&c.length&&e.style(c[0],"whiteSpace","nowrap");(c=e.query(".directions",n))&&c.length&&e.style(c[0],"whiteSpace","nowrap");b&&(arcgisonline.map.popup.removeRelatedRecordsLink(),b=e.byId("popupRelationsLink"));if(!m||0===m.length)return!1;if(1===m.length)b||(e.create("span",{innerHTML:" "},n),b=e.create("a",{id:"popupRelationsLink","class":"action related",innerHTML:esri.i18nBundle.popupBuilder.showRelatedRecords,href:"javascript:void(0);",style:"white-space: nowrap;"},
n)),arcgisonline.map.popup.relationsLinkHandler=e.connect(b,"onclick",e.hitch(this,this._handleRelatedRecordsClick,g,m[0],{relatedRecordsInfo:a.relatedRecordsInfo}));else if(!b){b=new K.DropDownMenu({},e.create("div",{id:"popupRelationsLink"},n));var d=new K.Menu({});var l=g.getSourceLayer();e.forEach(m,function(h){var f=this._getRelatedLayerUrl(l.url,h.relatedTableId);f=this._findRelatedTable(f).selMapTable;h=new K.MenuItem({label:f?f.title?f.title:f.layer.name:h.name,onClick:e.hitch(this,this._handleRelatedRecordsClick,
g,h,{relatedRecordsInfo:a.relatedRecordsInfo})});d.addChild(h)},this);b.addChild(new K.PopupMenuItem({label:esri.i18nBundle.popupBuilder.showRelatedRecords,popup:d}))}},removeRelatedRecordsLink:function(){arcgisonline.map.popup.relationsLinkHandler&&(e.disconnect(arcgisonline.map.popup.relationsLinkHandler),arcgisonline.map.popup.relationsLinkHandler=null);var a=e.byId("popupRelationsLink"),g=K.byId("popupRelationsLink");a&&(g&&g.destroyRecursive(!1),(a=e.byId("popupRelationsLink"))&&e.destroy(a),
a=null)},_getOrderedByFields:function(a,g){if(!a||!a.orderByFields||!g)return null;a=e.map(a.orderByFields,function(m){var n=m.field&&-1!==m.field.indexOf("relationships/")&&m.field.split("/");if(parseInt(n[1],10)===g.id)return n[2]+" "+m.order.toUpperCase()},this);return a=e.filter(a,function(m){return esri.isDefined(m)})},_getRelatedLayerUrl:function(a,g){a=esri.isDefined(a)&&esri.isDefined(g)?a.replace(/[0-9|\w]+$/i,g):"";g=a.lastIndexOf("//");-1!==g&&g!==a.indexOf("//")&&(a=a.substring(0,g)+a.substring(g+
1,a.length));return a},_handleRelatedRecordsClick:function(a,g,m){var n;this._getRelatedRecords(a,g,m).then(e.hitch(this,function(b){n=a.getSourceLayer();if(b&&b[a.attributes[n.objectIdField]]){var c={},d=this._getOrderedByFields(m.relatedRecordsInfo,g);c.relatedFeatures=b[a.attributes[n.objectIdField]].features;c.relatedlayerUrl=this._getRelatedLayerUrl(n.url,g.relatedTableId);c.feature=a;d&&(c.orderByFields=d);this._showRelatedTable(c)}else this._showNoResultsDlg()}),e.hitch(this,function(b){}))},
_getRelatedRecords:function(a,g,m){var n=a.getSourceLayer();var b=new esri.tasks.RelationshipQuery;b.outFields=["*"];b.relationshipId=g.id;b.objectIds=[a.attributes[n.objectIdField]];m.relatedRecordsInfo&&m.relatedRecordsInfo.orderByFields&&(e.map(m.relatedRecordsInfo.orderByFields,function(c){var d=c.field&&-1!==c.field.indexOf("relationships/")&&c.field.split("/");if(parseInt(d[1],10)===g.id)return d[2]+" "+c.order.toUpperCase()}),b.orderByFields=this._getOrderedByFields(m.relatedRecordsInfo,g));
return n.queryRelatedFeatures(b)},_getObjectIDField:function(a){return e.filter(a,function(g){return"esriFieldTypeOID"===g.type})[0]},_showRelatedTable:function(a){if(!a||!a.relatedlayerUrl||!a.relatedFeatures)return!1;var g=a.relatedFeatures,m=this._findRelatedTable(a.relatedlayerUrl),n=m.selMapTable,b=m.tableId,c;n&&n.layer?(g=e.map(g,function(d){var l=d.getLayer(),h;void 0!==b&&l.url.endsWith("/dynamicLayer")&&void 0!==n.layersInfo&&(h=arcgisonline.map.main.getItemWithId([].concat(n.layersInfo.layers,
n.layersInfo.tables),b));if(n.layer.objectIdField)var f=n.layer.objectIdField;else l.url.endsWith("/dynamicLayer")&&void 0!==h&&void 0!==h.fields?(c=this._getObjectIDField(h.fields),void 0!==c&&(f=c.name)):f=l.objectIdField;return d.attributes[f]},this))&&g.length?(g={mapLayer:n,subLayerId:b,ids:g},a.orderByFields&&(g.orderByFields=a.orderByFields),arcgisonline.map.table.popup_showRelatedRecordsTable(g)):this._showNoResultsDlg():this._showNoResultsDlg()},_findRelatedTable:function(a){var g,m;0<arcgisonline.map.main.mapLayers.length&&
e.some(arcgisonline.map.main.mapLayers,function(b,c){c=b.layersInfo&&b.layersInfo.layers?b.layersInfo.layers:b.queryServiceUrl?b.queryLayersInfo.layers:[];if(b.layer&&b.layer.url===a)return g=b,!0;if(c&&0<c.length){var d=parseInt(a.substring(a.lastIndexOf("/")+1),10),l=b.layer instanceof esri.layers.ArcGISTiledMapServiceLayer,h;b.layer.url&&(h=b.layer.url+"/"+d);l&&h&&(h=h.replace("MapServer","FeatureServer"));if(h===a&&c[d])return g=b,m=d,!0}});if(!g&&0<arcgisonline.map.main.mapTables.length){var n=
parseInt(a.substring(a.lastIndexOf("/")+1),10);e.some(arcgisonline.map.main.mapTables,function(b,c){c=b.layer instanceof esri.layers.ArcGISTiledMapServiceLayer;if(b.layer&&b.layer.url===a)return g=b,c&&(m=n),!0})}return{selMapTable:g,tableId:m}},_showNoResultsDlg:function(){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.myOrganization.noData.searchTitle,message:esri.i18nBundle.searchPage.noResultsFound})},_isImageServiceLayer:function(a){return a instanceof
esri.layers.ArcGISImageServiceLayer||a instanceof esri.layers.ArcGISImageServiceVectorLayer||a instanceof esri.layers.RasterXLayer}}})},"arcgisonline/map/dijit/StructuredPopupWidget":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojox/charting/Chart2D,dojox/charting/themes/PlotKit/blue,dojox/charting/action2d/Tooltip,dojox/charting/action2d/Highlight,dojox/charting/widget/Legend"],function(e,K,p){e.provide("arcgisonline.map.dijit.StructuredPopupWidget");e.require("dijit._Widget");
e.require("dijit._Templated");e.require("dojox.charting.Chart2D");e.require("dojox.charting.themes.PlotKit.blue");e.require("dojox.charting.action2d.Tooltip");e.require("dojox.charting.action2d.Highlight");e.require("dojox.charting.widget.Legend");e.declare("arcgisonline.map.dijit.StructuredPopupWidget",[K._Widget,K._Templated],{templateString:"\x3cdiv\x3e\x3cdiv dojoAttachPoint\x3d'_descriptionNode'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_pictureNode'\x3e\x3c/div\x3e\x3c/div\x3e",startup:function(){this.inherited(arguments);
var a=this.definition,g=this.graphic.attributes,m=esri.substitute(g,a.description);this._descriptionNode.innerHTML=m;g.IMAGE_URL&&g.IMAGE_LINK_URL?(m="\x3cA href\x3d'"+esri.substitute(g,a.pictureLink)+"' target\x3d'_blank'\x3e\x3cimg src\x3d'"+esri.substitute(g,a.picture)+"' /\x3e\x3c/A\x3e",e.place(m,this._pictureNode,"only")):g.IMAGE_URL?(m="\x3cimg src\x3d'"+esri.substitute(g,a.picture)+"' /\x3e",e.place(m,this._pictureNode,"only")):g.IMAGE_LINK_URL&&(m="\x3cA href\x3d'"+esri.substitute(g,a.pictureLink)+
"' target\x3d'_blank'\x3e"+esri.substitute(g,a.pictureLink)+"\x3c/A\x3e",e.place(m,this._pictureNode,"only"));if(a.chart){var n=a.chart;m=this._chart=new p.charting.Chart2D(this._chartNode);m.setTheme(p.charting.themes.PlotKit.blue);m.addPlot("default",{type:n.type,font:"14t",fontColor:"white"});m.addSeries("Series A",e.map(n.fields,function(b,c){return{y:g[b],text:esri.substitute(g,n.labels[c]),tooltip:g[b],color:n.colors[c]}}));this._actions=[new p.charting.action2d.Tooltip(m),new p.charting.action2d.Highlight(m)];
m.render();this._legend=new p.charting.widget.Legend({chart:m},this._legendNode)}g.VIDEO_URL&&(a="\x3ciframe frameborder\x3d'0' width\x3d'250' height\x3d'212' src\x3d'"+esri.substitute(g,a.video)+"'\x3e\x3c/iframe\x3e",this._mediaNode.innerHTML=a)},destroy:function(){e.forEach([this._chart,this._legend].concat(this._actions),function(a){a.destroy()});this.definition=this.graphic=this._chart=this._legend=this._actions=null;this.inherited(arguments)}})})},"dojox/charting/themes/PlotKit/blue":function(){define(["./base",
"../../Theme"],function(e,K){e.blue=e.base.clone();e.blue.chart.fill=e.blue.plotarea.fill="#e7eef6";e.blue.colors=K.defineColors({hue:217,saturation:60,low:40,high:88});return e.blue})},"dojox/charting/themes/PlotKit/base":function(){define(["dojo/_base/lang","dojo/_base/Color","../../Theme","../common"],function(e,K,p,a){e=e.getObject("PlotKit",!0,a);e.base=new p({chart:{stroke:null,fill:"yellow"},plotarea:{stroke:null,fill:"yellow"},axis:{stroke:{color:"#fff",width:1},line:{color:"#fff",width:.5},
majorTick:{color:"#fff",width:.5,length:6},minorTick:{color:"#fff",width:.5,length:3},tick:{font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#999"}},series:{stroke:{width:2.5,color:"#fff"},fill:"#666",font:"normal normal normal 7.5pt Helvetica,Arial,sans-serif",fontColor:"#666"},marker:{stroke:{width:2},fill:"#333",font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#666"},colors:["red","green","blue"]});e.base.next=function(g,m,n){var b=p.prototype.next.apply(this,
arguments);"line"==g?(b.marker.outline={width:2,color:"#fff"},b.series.stroke.width=3.5,b.marker.stroke.width=2):"candlestick"==g?b.series.stroke.width=1:b.series.stroke.color&&b.series.stroke.color.toString()==(new K(this.colors[(this._current-1)%this.colors.length])).toString()&&(b.series.stroke.color="#fff");return b};return e})},"dojox/charting/widget/Legend":function(){define("dojo/_base/declare dijit/_WidgetBase dojox/gfx dojo/_base/array dojo/has dojo/has!dojo-bidi?../bidi/widget/Legend dojox/lang/functional dojo/dom dojo/dom-construct dojo/dom-class dijit/registry".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l){K=e(g("dojo-bidi")?"dojox.charting.widget.NonBidiLegend":"dojox.charting.widget.Legend",K,{chartRef:"",horizontal:!0,swatchSize:18,legendBody:null,postCreate:function(){!this.chart&&this.chartRef&&(this.chart=l.byId(this.chartRef)||l.byNode(b.byId(this.chartRef)));this.chart=this.chart.chart||this.chart;this.refresh()},buildRendering:function(){this.domNode=c.create("table",{role:"group","aria-label":"chart legend","class":"dojoxLegendNode"});this.legendBody=c.create("tbody",
null,this.domNode);this.inherited(arguments)},destroy:function(){this._surfaces&&a.forEach(this._surfaces,function(h){h.destroy()});this.inherited(arguments)},refresh:function(){this._surfaces&&a.forEach(this._surfaces,function(r){r.destroy()});for(this._surfaces=[];this.legendBody.lastChild;)c.destroy(this.legendBody.lastChild);this.horizontal&&(d.add(this.domNode,"dojoxLegendHorizontal"),this._tr=c.create("tr",null,this.legendBody),this._inrow=0);var h=this.series||this.chart.series;if(0!=h.length)if("dojox.charting.plot2d.Pie"==
h[0].chart.stack[0].declaredClass){var f=h[0].chart.stack[0];"number"==typeof f.run.data[0]?(h=n.map(f.run.data,"Math.max(x, 0)"),h=n.map(h,"/this",n.foldl(h,"+",0)),a.forEach(h,function(r,q){this._addLabel(f.dyn[q],f._getLabel(100*r)+"%")},this)):a.forEach(f.run.data,function(r,q){this._addLabel(f.dyn[q],r.legend||r.text||r.y)},this)}else a.forEach(h,function(r){this._addLabel(r.dyn,r.legend||r.name)},this)},_addLabel:function(h,f){var r=c.create("td"),q=c.create("div",null,r),t=c.create("label",
null,r),w=c.create("div",{style:{width:this.swatchSize+"px",height:this.swatchSize+"px","float":"left"}},q);d.add(q,"dojoxLegendIcon dijitInline");d.add(t,"dojoxLegendText");this._tr?(this._tr.appendChild(r),++this._inrow===this.horizontal&&(this._tr=c.create("tr",null,this.legendBody),this._inrow=0)):c.create("tr",null,this.legendBody).appendChild(r);this._makeIcon(w,h);t.innerHTML=String(f);g("dojo-bidi")&&(t.dir=this.getTextDir(f,t.dir))},_makeIcon:function(h,f){var r=this.swatchSize,q=this.swatchSize;
h=p.createSurface(h,q,r);this._surfaces.push(h);if(f.fill)h.createRect({x:2,y:2,width:q-4,height:r-4}).setFill(f.fill).setStroke(f.stroke);else if(f.stroke||f.marker){var t={x1:0,y1:r/2,x2:q,y2:r/2};f.stroke&&h.createLine(t).setStroke(f.stroke);f.marker&&h.createPath({path:"M"+q/2+" "+r/2+" "+f.marker}).setFill(f.markerFill).setStroke(f.markerStroke)}else h.createRect({x:2,y:2,width:q-4,height:r-4}).setStroke("black"),h.createLine({x1:2,y1:2,x2:q-2,y2:r-2}).setStroke("black"),h.createLine({x1:2,y1:r-
2,x2:q-2,y2:2}).setStroke("black")}});return g("dojo-bidi")?e("dojox.charting.widget.Legend",[K,m]):K})},"arcgisonline/map/mapUtil":function(){define(["dojo","dijit","dojox","dojo/require!esri/arcadeProfiles/labelingProfile,esri/arcadeProfiles/visualizationProfile,esri/ArcadeExpression,arcgisonline/map/main,esri/support/expressionUtils"],function(e,K,p){e.provide("arcgisonline.map.mapUtil");e.require("esri/arcadeProfiles/labelingProfile");e.require("esri/arcadeProfiles/visualizationProfile");e.require("esri/ArcadeExpression");
e.require("arcgisonline.map.main");e.require("esri.support.expressionUtils");arcgisonline.map.mapUtil={getWebMapAuthoringInfo:function(){return{authoringApp:"WebMapViewer",authoringAppVersion:arcgisonline.sharing.util.isPortal()?"11.2":"2023.3",version:"2.29"}},openBlankMap:function(){var a=esriGeowConfig.baseUrl+"webmap/viewer.html";arcgisonline.map.storage.getMapCookie(function(g){g&&!0===g.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(a,g):document.location=
a})},openOnMap:function(a,g,m){a=e.mixin({layers:a},!0===m?{panel:"gallery",suggestField:!0}:{});var n=esriGeowConfig.baseUrl+"webmap/viewer.html?"+e.objectToQuery(a),b=esriGeowConfig.baseUrl+"signin.html?returnUrl\x3d"+encodeURIComponent(n);g="boolean"===typeof g?g:!1;arcgisonline.map.storage.getMapCookie(function(c){c&&!0===c.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(g?b:n,c):document.location=g?b:n})},openOnGCSMap:function(a){var g=esriGeowConfig.baseUrl+
"webmap/viewer.html?layers\x3d"+a+"\x26basemapUrl\x3d"+esriGeowConfig.gcsBasemapService;arcgisonline.map.storage.getMapCookie(function(m){m&&!0===m.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(g,m):document.location=g})},addToMap:function(a,g,m){a=e.mixin({layers:a,useExisting:1},!0===m?{panel:"gallery",suggestField:!0}:{});a=esriGeowConfig.baseUrl+"webmap/viewer.html?"+e.objectToQuery(a);m=esriGeowConfig.baseUrl+"signin.html?returnUrl\x3d"+encodeURIComponent(a);
document.location="boolean"===typeof g&&g?m:a},openUrlOnMap:function(a){a=esriGeowConfig.baseUrl+"webmap/viewer.html?url\x3d"+a;arcgisonline.map.storage.getMapCookie(function(g){g&&!0===g.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(a,g):document.location=a})},addUrlToMap:function(a){document.location=esriGeowConfig.baseUrl+"webmap/viewer.html?useExisting\x3d1\x26url\x3d"+a},openMap:function(a,g){var m=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+a,
n=esriGeowConfig.baseUrl+"signin.html?returnUrl\x3d"+encodeURIComponent(m);g="boolean"===typeof g?g:!1;arcgisonline.map.storage.getMapCookie(function(b){b&&!0===b.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(g?n:m,b):document.location=g?n:m})},openMapWithBase:function(a,g,m){var n=esriGeowConfig.baseUrl+"webmap/viewer.html";null!=a&&0<a.length&&null!=g&&0<g.length?n+="?basemapType\x3d"+a+"\x26layers\x3d"+g:null!=a&&0<a.length?n+="?basemapType\x3d"+a:null!=g&&
0<g.length&&(n+="?layers\x3d"+g);esri.isDefined(m)&&m.length&&"/"!=m&&(n=-1===n.indexOf("?")?n+("?folder\x3d"+m):n+("\x26folder\x3d"+m));arcgisonline.map.storage.getMapCookie(function(b){b&&!0===b.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(n,b):document.location=n})},previewTemplate:function(a,g,m){m&&m.preventDefault();g=esriGeowConfig.restBaseUrl+"content/items/"+g+"/data";m=arcgisonline.sharing.util.getToken();null!=m&&""!=m&&(g=g+"?token\x3d"+m);esri.request({url:g,
callbackParamName:"callback"});g=a.indexOf("?");m=-1!==g?a.substr(g,a.length):"";m+=m&&m.length?"\x26":"?";m+="webmap\x3d"+arcgisonline.map.save_open.webMapInfo.id;a=a.substr(0,-1!==g?g:a.length)+m;window.open(a)},supportsOffline:function(a){for(var g=new e.Deferred,m=[],n=0;n<a.baseMap.baseMapLayers.length;n++){var b=a.baseMap.baseMapLayers[n];if(!b.url||b.type||b.layers)return g.callback(!1),g;-1==e.indexOf(m,b.url)&&m.push(b.url)}for(n=0;n<a.operationalLayers.length;n++){b=a.operationalLayers[n];
if(!b.url||b.type||b.layers)return g.callback(!1),g;-1==e.indexOf(m,b.url)&&m.push(b.url)}a=[];for(n=0;n<m.length;n++)a.push(arcgisonline.map.mapUtil.getServiceInfoHelper(m[n]));a.length?(new e.DeferredList(a)).addCallback(function(c){var d=null;for(n=0;n<m.length;n++){var l=m[n],h=c[n][1];h?(0===n&&(d=h.spatialReference),h.capabilities&&-1<h.capabilities.indexOf("Sync")||h.exportTilesAllowed||arcgisonline.sharing.util.isAgolService(l)&&arcgisonline.map.main.agolServiceWithExportTilesAllowed(l)?0<
n&&h.singleFusedMapCache&&!arcgisonline.map.main.sameSpatialReference(d,h.spatialReference)&&g.callback(!1):g.callback(!1)):g.callback(!1)}g.callback(!0)}):g.callback(!1);return g},getServiceInfoHelper:function(a){var g=new e.Deferred;arcgisonline.map.layer.getServiceInfo(a,null,function(m){g.callback(m)},function(){g.errback()});return g},checkFSItemAccess:function(a,g){!a.itemOwner&&a.itemCard&&(a.itemOwner=a.itemCard.owner);!a.itemId||a.itemOwner||a._itemNotAccessible?g():arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+
"content/items/"+a.itemId},{disableIdentityLookup:!0}).then(e.hitch(this,function(m){m.id===a.itemId&&(a.itemOwner=m.owner,a.itemCard=m,g())}),e.hitch(this,function(){a._itemNotAccessible=!0;g()}))},checkHostedFSAccess:function(a,g,m){a.layer&&a.layer instanceof esri.layers.FeatureLayer&&a.itemId&&(arcgisonline.sharing.util.isHostedService(a.url)||a.itemCard&&-1<e.indexOf(a.itemCard.typeKeywords,"providerSDS"))?arcgisonline.map.mapUtil.checkFSItemAccess(a,e.hitch(this,function(){if(a.itemCard&&-1<
e.indexOf(a.itemCard.typeKeywords,"Hosted Service")){var n=arcgisonline.sharing.util.getUser();"update"===a.itemCard.itemControl||"admin"===a.itemCard.itemControl?g&&g(a):n&&esriGeowConfig.userRole&&esriGeowConfig.userRole.isAdmin()&&-1<a.url.indexOf("/"+n.accountId+"/")?g&&g(a):n&&a.itemOwner&&a.itemOwner===n.username?g&&g(a):m&&m(a)}else m&&m(a)})):m&&m(a)},setRenderer:function(a,g){a&&g&&g.initializeArcadeEngine().then(function(){a.setRenderer(g);a.redraw()},function(){a.setRenderer(g)})},setLabelingInfo:function(a,
g,m){if(a&&g){for(var n=0;n<g.length;n++){var b=g[n];b.labelExpressionInfo&&b.labelExpressionInfo.expression&&(b=new esri.ArcadeExpression({expression:b.labelExpressionInfo.expression,returnType:b.labelExpressionInfo.returnType,profile:esri.arcadeProfiles.labelingProfile}),esri.arcadeProfiles.labelingProfile.initialize([b]).then(e.hitch(this,function(){a.setLabelingInfo(g);m&&setTimeout(function(){arcgisonline.map.labels.addLabelsForLayer(a)},1)}),e.hitch(this,function(){a.setLabelingInfo(g);m&&setTimeout(function(){arcgisonline.map.labels.addLabelsForLayer(a)},
1)})))}a.setLabelingInfo(g)}},setInfoTemplate:function(a,g){if(a)if(g&&g.expressionInfos&&g.expressionInfos.length){for(var m=[],n=0;n<g.expressionInfos.length;n++){var b=g.expressionInfos[n];b=new esri.ArcadeExpression({expression:b.expression,returnType:b.returnType,profile:esri.arcadeProfiles.popupProfile});m.push(esri.arcadeProfiles.popupProfile.initialize([b]))}(new e.DeferredList(m)).addCallback(e.hitch(this,function(c,d,l){c.setInfoTemplate(new esri.dijit.PopupTemplate(d))},a,g))}else a.setInfoTemplate(g&&
new esri.dijit.PopupTemplate(g))}}})},"arcgisonline/map/featColl":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/map/main"],function(e,K,p){e.provide("arcgisonline.map.featColl");e.require("arcgisonline.map.main");arcgisonline.map.featColl={addFeatureLayers:function(a,g,m){if(!a.itemId||a.featureCollection&&a.featureCollection.layers&&a.featureCollection.layers[0].featureSet){e.forEach(a.featureCollection.layers,function(d){d.layerDefinition.capabilities||(d.layerDefinition.capabilities=
"Query")});var n=Math.floor(10001*Math.random()),b={layer:null,id:a.id?a.id:"featColl_"+n,type:"user",title:g?g:a.title,defaultVisibility:null!=a.visibility?a.visibility:!0,defaultOpacity:null!=a.opacity?a.opacity:1,snippet:"",visibility:null!=a.visibility?a.visibility:!0,identify:!1,timeAnimation:a.timeAnimation};a.featureCollection&&!0!==a.featureCollection.showLegend&&(b.showLegend=!1);a.featureCollection||!1!==a.showLegend||(b.showLegend=!1);a.featureCollectionType&&(b.featureCollectionType=a.featureCollectionType);
if(a.itemId||m&&m.itemId)b.itemId=a.itemId||m.itemId;a.url&&(b.url=a.url);if(a.itemCard||m&&m.itemCard)b.itemCard=a.itemCard||m.itemCard;a.locationInfo&&(b.locationInfo=a.locationInfo);a.columnDelimiter&&(b.columnDelimiter=a.columnDelimiter);esri.isDefined(a.visibleLayers)&&(b.visibleLayers=a.visibleLayers.toString(),0<a.visibleLayers.length&&isNaN(a.visibleLayers[0])&&(visibleLayers=e.map(a.visibleLayers,function(d){return d.substring(d.lastIndexOf("_")+1)}),b.visibleLayers=visibleLayers.toString()));
arcgisonline.map.mapNotes.isMapNotesLayer(a)&&(b.fieldInfos=arcgisonline.map.mapNotes.getFieldInfos(),b.type="mapNotes",b.featureCollectionType="notes");m&&(b=e.mixin(b,m));var c=!1;e.forEach(a.featureCollection.layers,function(d){d.layerDefinition&&"Table"===d.layerDefinition.type||(c=!0)});c?(m=arcgisonline.map.layer.getLayerPosition(b),arcgisonline.map.main.mapLayers.splice(m.list,0,b),arcgisonline.map.featColl.addFeatureLayersfromCollection(b,a.featureCollection,g,m.map)):(arcgisonline.map.featColl.addFeatureLayersfromCollection(b,
a.featureCollection,g,0),arcgisonline.map.main.mapTables=arcgisonline.map.main.mapTables||[],e.forEach(b.tables,function(d,l){d={layer:d,id:d.id,title:1<b.tables.length?b.title+" - "+d.name:b.title,featureCollection:a.featureCollection};b.itemId&&(d.itemId=b.itemId,d.itemCard=b.itemCard);esri.isDefined(b.popupChanged)&&(d.popupChanged=b.popupChanged);arcgisonline.map.main.mapTables.push(d);arcgisonline.map.main.refreshMapTables();e.publish("layerAdded",[b.id])}),e.publish("onLayerUpdate",[""]));return b}arcgisonline.map.featColl.mergeFeatureCollectionItem(a,
g,m,e.hitch(arcgisonline.map.featColl,"addFeatureLayers"))},addFeatureLayersfromCollection:function(a,g,m,n){var b=0,c=0,d=[],l=[];e.forEach(g.layers,function(u){u.layerDefinition&&"Table"===u.layerDefinition.type?(c++,l.push(u)):(b++,d.push(u))});if(1<b+c){a.layers=[];var h=d.concat(l);g.layers=h}arcgisonline.map.featColl.fixCapabilities(g,a.itemCard);for(h=0;h<g.layers.length;h++){var f=g.layers[h],r=a.id+(1<g.layers.length?"_"+h:"");if(f.layerDefinition&&"Table"===f.layerDefinition.type){var q=
new esri.layers.FeatureLayer(e.json.parse(e.json.stringify(f)),{id:r,arcgisProps:{title:a.title+" - "+f.name},outFields:["*"]});q.name=f.layerDefinition.name;f.popupInfo&&(q.__popupInfo=f.popupInfo,arcgisonline.map.mapUtil.setInfoTemplate(q,f.popupInfo));a.tables=a.tables||[];a.tables.push(q);arcgisonline.map.main.refreshMapTables()}else f.layerDefinition.name||(f.layerDefinition.name=a.title),q=null,!1===f.showLegend&&(q=!1),delete f.showLegend,r=arcgisonline.map.featColl.addFeatureLayer(f,a.defaultVisibility,
a.defaultOpacity,r,a),!1===q&&(r.__showLegend=!1),a.layers?((""==a.visibleLayers||a.visibleLayers&&-1==(","+a.visibleLayers+",").indexOf(","+h+","))&&r.hide(),a.layers.push(r)):(a.layer=r,f.popupInfo&&!f.disablePopup&&(a.popupInfo=f.popupInfo))}!a.itemId&&m&&0<m.length&&(a.layer&&a.layer.isEditable()||a.layers&&a.layers[0].isEditable())&&("editStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()?setTimeout(function(){K.byId("editPanel").recreateEditor()},0):("contentStack"!==arcgisonline.map.leftPanel.getLeftContentPanelStack()&&
arcgisonline.map.leftPanel.openLeftTOCPanel(),arcgisonline.map.edit.enableEditButton()));if(a.layers)if(g=arcgisonline.sharing.util.urlToObject(document.URL),g.query&&g.query.layers&&g.query.layerId){var t=parseInt(g.query.layerId),w=t;e.forEach(a.layers,function(u,v){u.layerId===t&&(w=v)});e.forEach(a.layers,function(u){u.id.endsWith("_"+w)&&(arcgisonline.map.main.map.addLayer(u,n),u.show())})}else e.forEach(a.layers,function(u,v){arcgisonline.map.main.map.addLayer(u,n+v)});else arcgisonline.map.main.map.addLayer(a.layer,
n);e.publish("layerAdded",[a.id])},addFeatureLayer:function(a,g,m,n,b){var c=null;a.popupInfo&&(c=new esri.dijit.PopupTemplate(a.popupInfo));arcgisonline.map.main.checkUnsupportedRendererType(a);g=new esri.layers.FeatureLayer(e.json.parse(e.json.stringify(a)),{id:n,infoTemplate:c,outFields:["*"],visible:g,opacity:m,arcgisProps:{title:a.title},displayOnPan:9>e.isIE?!1:!0});g.labelingInfo&&arcgisonline.map.labels.addLabelsForLayer(g);a.popupInfo&&(g.__popupInfo=a.popupInfo);a.layerDefinition&&a.layerDefinition.featureReduction&&
(a=e.clone(a.layerDefinition.featureReduction),a.clusterRadius=p.gfx.pt2px(a.clusterRadius||a.clusterSize),a.popupInfo&&a.disablePopup&&(delete a.popupInfo,delete a.disablePopup),a.popupInfo?(a.infoTemplate=new esri.dijit.PopupTemplate(a.popupInfo),delete a.popupInfo):a.disablePopup=!0,g.setFeatureReduction(a));b&&!1===b.timeAnimation&&g.timeInfo&&(g.useMapTime=!1);return g},addFeatureCollectionByUrl:function(a){if(a.endsWith(".js")||-1<a.indexOf(".js?")||-1<a.indexOf(".js%"))arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.error.layerNotAdded,{layer:a})});else{var g=arcgisonline.sharing.util.urlToObject(document.URL),m=g.query&&g.query.supportsProjection,n=a,b=null;"true"==(g.query&&g.query.supportsJSONP)?b="callback":n=(0===a.indexOf("https://")?esri.config.defaults.io.proxyUrl.replace("http:","https:"):esri.config.defaults.io.proxyUrl)+"?"+a;"true"==m&&(g=arcgisonline.map.main.map&&arcgisonline.map.main.map.spatialReference?arcgisonline.map.main.map.spatialReference:
arcgisonline.map.main.defaultExtent.spatialReference,n+=(-1<a.indexOf("?")?"\x26":"?")+"outsr\x3d"+(g.wkid?g.wkid:g.wkt));var c=a.substring(a.lastIndexOf("/")+1,a.length);-1<c.indexOf("?")&&(c=c.substring(0,c.indexOf("?")));-1<a.indexOf("option\x3dfootprints")&&(-1<a.indexOf("/rest/services?")?(c=a.substring(a.indexOf("://")+3,a.length),c=c.substring(0,c.indexOf("/"))+" - "+esri.i18nBundle.viewer.featColl.footprints):-1<a.indexOf("/rest/services/")&&(-1<a.indexOf("Server?")?(c=a.substring(0,a.indexOf("Server?")),
c=c.substring(0,c.lastIndexOf("/")),c=c.substring(c.lastIndexOf("/")+1,c.length)):(c=a.substring(a.indexOf("/rest/services/")+15,a.indexOf("?")),-1<c.indexOf("/")&&(c=c.substring(c.lastIndexOf("/")+1,c.length))),c+=" - "+esri.i18nBundle.viewer.featColl.footprints));esri.request({url:n,callbackParamName:b,load:function(d){if(d.layerDefinition)d.layerDefinition.name&&(c=d.layerDefinition.name),d.layerDefinition.capabilities?-1===d.layerDefinition.capabilities.indexOf("Editing")&&(d.layerDefinition.capabilities+=
", Editing"):d.layerDefinition.capabilities="Query, Editing",arcgisonline.map.featColl.checkLayerDefinitionSR(d,c,a);else if(d.featureCollection)1==d.featureCollection.layers.length&&d.featureCollection.layers[0].layerDefinition.name&&(c=d.featureCollection.layers[0].layerDefinition.name),e.forEach(d.featureCollection.layers,function(h){h.layerDefinition.capabilities?-1===h.layerDefinition.capabilities.indexOf("Editing")&&(h.layerDefinition.capabilities+=", Editing"):h.layerDefinition.capabilities=
"Query, Editing"}),arcgisonline.map.featColl.checkFeatureCollectionSR(d.featureCollection,c,e.hitch(arcgisonline.map.featColl,"addAndZoom",c,a));else{d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();var l=e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNoLayers,{url:a});d.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:l})}},error:function(d){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNotAccessible,{url:a})})}},{usePost:!1})}},addFeatureCollectionItem:function(a){var g=function(m,n){e.publish("ServiceAnswerReceived",[]);e.publish("layerAddFailed",[{itemId:a.id}]);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.layerFailedToLoad})};esri.request({url:(a.restBaseUrl||esriGeowConfig.restBaseUrl)+
"content/items/"+a.id+"/data?f\x3djson",callbackParamName:"callback",load:e.hitch(this,function(m,n){e.publish("ServiceAnswerReceived",[]);m.featureCollection&&m.featureCollection.layers||m.layers||g(m,n);m.layers&&(m.featureCollection={layers:m.layers},delete m.layers,esri.isDefined(m.showLegend)&&(m.featureCollection.showLegend=m.showLegend,delete m.showLegend));arcgisonline.map.featColl.loadFeatCollFromItemData(m||{},a,e.hitch(this,function(){if(null!=arcgisonline.map.save_open.itemCard&&null!=
a&&arcgisonline.map.save_open.itemCard.id===a.id){null===arcgisonline.map.save_open.webMapInfo&&arcgisonline.map.main.setTitle(a.title);arcgisonline.map.leftPanel.recreateAboutStack();var b=arcgisonline.sharing.util.urlToObject(document.URL);b.query=b.query||{};arcgisonline.map.leftPanel.openLeftTOCPanel()}else null===arcgisonline.map.save_open.webMapInfo&&null===arcgisonline.map.save_open.itemCard&&arcgisonline.map.main.setTitle(esri.i18nBundle.viewer.defaultMapTitle)}))}),error:e.hitch(this,g)})},
loadFeatCollFromItemData:function(a,g,m){arcgisonline.map.featColl.checkFeatureCollectionSR(a.featureCollection,g.title,function(n){arcgisonline.map.save_open.itemCard&&arcgisonline.map.save_open.itemCard.id===g.id?(arcgisonline.map.main.setTitle(g.title),arcgisonline.map.leftPanel.recreateAboutStack()):null===arcgisonline.map.save_open.webMapInfo&&arcgisonline.map.main.setTitle(esri.i18nBundle.viewer.defaultMapTitle);arcgisonline.map.featColl.fixCapabilities(a.featureCollection,g);n=arcgisonline.map.featColl.addFeatureLayers(a,
g.title,{itemId:g.id,itemCard:g});n.itemId&&((n.itemCard=g)&&-1<e.indexOf(g.typeKeywords,"Route Layer")?n.featureCollectionType="route":g&&-1<e.indexOf(g.typeKeywords,"Markup")&&(n.featureCollectionType="markup"),n.origItemDataProps=e.clone(a),e.forEach(n.origItemDataProps.featureCollection.layers,function(b){delete b.featureSet;delete b.nextObjectId}));m()})},addFeatCollByReferenceLayerFromJson:function(a){a&&esri.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a.itemId+"?f\x3djson",callbackParamName:"callback",
load:e.hitch(this,function(g,m){arcgisonline.map.featColl.addFeatureLayers(g,null,{itemId:g.itemId,itemCard:m})},a),error:e.hitch(this,function(g,m){e.publish("layerAddFailed",[a.itemId?{itemId:a.itemId,id:a.id}:a.id]);setTimeout(function(){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.layerFailedToLoad})},5E3)})})},mergeFeatureCollectionItem:function(a,g,m,n){!arcgisonline.sharing.util.getUser()||
a.itemCard?arcgisonline.map.featColl.mergeFeatureCollectionItem_part2(a,g,m,n):esri.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a.itemId+"?f\x3djson",callbackParamName:"callback",load:e.hitch(this,function(b){a.itemCard=b;arcgisonline.map.featColl.mergeFeatureCollectionItem_part2(a,g,m,n)}),error:e.hitch(this,function(b,c){a.itemCard={owner:null};arcgisonline.map.featColl.mergeFeatureCollectionItem_part2(a,g,m,n)})})},mergeFeatureCollectionItem_part2:function(a,g,m,n){var b=function(c,
d){e.publish("layerAddFailed",[a.itemId?{itemId:a.itemId,id:a.id}:a.id]);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.layerFailedToLoad})};esri.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a.itemId+"/data?f\x3djson",callbackParamName:"callback",load:e.hitch(this,function(c,d,l){if(d.featureCollection||d.layers){d.layers&&(d.featureCollection={layers:d.layers},delete d.layers,
esri.isDefined(d.showLegend)&&(d.featureCollection.showLegend=d.showLegend,delete d.showLegend));var h=e.filter(d.featureCollection.layers,function(r){return r.layerDefinition&&"Table"===r.layerDefinition.type?!1:!0}),f=e.filter(d.featureCollection.layers,function(r){return r.layerDefinition&&"Table"===r.layerDefinition.type?!0:!1});d.featureCollection.layers=h.concat(f);a.featureCollection&&a.featureCollection.layers&&d.featureCollection.layers.length!==a.featureCollection.layers.length?b({msg:(g||
a.title)+": FeatureCollection layer in web map has less layers than on item."},l):arcgisonline.map.featColl.checkFeatureCollectionSR(d.featureCollection,g||a.title,e.hitch(this,function(r,q){r=r||{};r.origItemData=e.clone(d);esri.isDefined(a.visibleLayers)?r.visibleLayersChanged=!0:d.visibleLayers&&(a.visibleLayers=d.visibleLayers.toString());d.featureCollection=q;a.featureCollection&&a.featureCollection.layers?(0<h.length&&a.featureCollection.showLegend!==d.featureCollection.showLegend&&(r.legendChanged=
!0),e.forEach(d.featureCollection.layers,function(t,w){w=a.featureCollection.layers[w];w.popupInfo&&w.disablePopup&&(delete w.popupInfo,delete w.disablePopup);t.popupInfo&&t.disablePopup&&(delete t.popupInfo,delete t.disablePopup);if(w.popupInfo&&!t.popupInfo||!w.popupInfo&&t.popupInfo&&!w.disablePopup||w.popupInfo&&t.popupInfo&&e.json.stringify(w.popupInfo)!==e.json.stringify(t.popupInfo))r.popupChanged=!0,delete w.disablePopup;if(w.layerDefinition){if(w.layerDefinition.minScale!==t.layerDefinition.minScale||
w.layerDefinition.maxScale!==t.layerDefinition.maxScale)r.scaleChanged=!0;delete t.layerDefinition.minScale;delete t.layerDefinition.maxScale;w.layerDefinition.drawingInfo&&e.json.stringify(w.layerDefinition.drawingInfo)!==e.json.stringify(t.layerDefinition.drawingInfo)&&(r.rendererChanged=!0,delete t.layerDefinition.drawingInfo);w.layerDefinition.featureReduction&&e.json.stringify(w.layerDefinition.featureReduction)!==e.json.stringify(t.layerDefinition.featureReduction)&&(r.featureReductionChanged=
!0,delete t.layerDefinition.featureReduction);w.layerDefinition.showLegend!==t.layerDefinition.showLegend&&(r.legendChanged=!0,delete t.layerDefinition.showLegend);w.layerDefinition=e.mixin(w.layerDefinition,t.layerDefinition)}else w.layerDefinition=t.layerDefinition;w.featureSet=t.featureSet;w.nextObjectId=t.nextObjectId})):(a.featureCollection=a.featureCollection||{},a.featureCollection=e.mixin(a.featureCollection,d.featureCollection));a.itemCard&&-1<e.indexOf(a.itemCard.typeKeywords,"Route Layer")?
a.featureCollectionType="route":a.itemCard&&-1<e.indexOf(a.itemCard.typeKeywords,"Markup")?a.featureCollectionType="markup":arcgisonline.map.mapNotes.isMapNotesLayer(a)&&(a.featureCollectionType="notes");arcgisonline.map.featColl.fixCapabilities(a.featureCollection,a.itemCard);n(a,g,r)},c))}else b(d,l)},m||{}),error:e.hitch(this,b)})},fixCapabilities:function(a,g){var m=arcgisonline.sharing.util.getUser(),n=!1;g?!m||g.owner!==m.username&&"update"!==g.itemControl&&"admin"!==g.itemControl||(n=!0):m&&
(n=!0);e.forEach(a.layers,function(b){if(n)b.layerDefinition.capabilities?-1===b.layerDefinition.capabilities.indexOf("Editing")&&(b.layerDefinition.capabilities+=", Editing"):b.layerDefinition.capabilities="Query, Editing";else if(b.layerDefinition.capabilities){var c=b.layerDefinition.capabilities.split(","),d=[];e.forEach(c,function(l){var h=l.toLowerCase();"editing"!==h&&"create"!==h&&"update"!==h&&"delete"!==h&&d.push(l)});b.layerDefinition.capabilities=d.toString()}else b.layerDefinition.capabilities=
"Query"})},checkFeatureCollectionSR:function(a,g,m){for(var n=!1,b=[],c=0;c<a.layers.length;c++){var d=a.layers[c];if(d.layerDefinition&&"Table"===d.layerDefinition.type)n=!0;else{var l=arcgisonline.map.featColl.getSR(d);l&&b.push(function(){var h=new e.Deferred;arcgisonline.map.featColl.projectFeatureSet(d,l,e.hitch(this,function(f,r,q){r.layers[f]=q;h.callback()},c,a));return h}())}}b.length?(new e.DeferredList(b)).addCallback(function(){if(arcgisonline.map.main.map.extent&&isNaN(arcgisonline.map.main.map.extent.xmin)){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent);
var h=e.connect(arcgisonline.map.main.map,"onExtentChange",e.hitch(this,function(){e.disconnect(h);m(a)}))}else m(a)}):(b=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),a.layers.length?n?m(a):(g=e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNoSR,{url:g}),b.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:g})):(g=e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNoLayers,{url:g}),b.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:g})))},addAndZoom:function(a,g,m){a=arcgisonline.map.featColl.addFeatureLayers({featureCollection:m},a);a.layer?-1<g.indexOf("option\x3dfootprints")&&-1<g.indexOf("/rest/services")&&(a.layer.__isFootprintLayer=!0):e.forEach(a.layers,function(b){-1<g.indexOf("option\x3dfootprints")&&-1<g.indexOf("/rest/services")&&(b.__isFootprintLayer=!0)});var n=null;e.forEach(m.layers,function(b){b.layerDefinition.extent&&(n=n?n.union(new esri.geometry.Extent(b.layerDefinition.extent)):new esri.geometry.Extent(b.layerDefinition.extent))},
this);n?arcgisonline.map.main.projectToMapSpatialReference(n,function(b){arcgisonline.map.main.map.setExtent(b[0],!0)}):(n=arcgisonline.map.featColl.getFullExtent(a))&&arcgisonline.map.main.map.setExtent(n,!0)},checkLayerDefinitionSR:function(a,g,m){var n=arcgisonline.map.featColl.getSR(a);n?arcgisonline.map.featColl.projectFeatureSet(a,n,e.hitch(this,function(b){if(arcgisonline.map.main.map.extent&&isNaN(arcgisonline.map.main.map.extent.xmin)){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent);
var c=e.connect(arcgisonline.map.main.map,"onExtentChange",e.hitch(this,function(){e.disconnect(c);arcgisonline.map.featColl.addAndLayerDefZoom(b,g,m)}))}else arcgisonline.map.featColl.addAndLayerDefZoom(b,g,m)})):(a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),n=e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNoSR,{url:m}),a.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:n}))},addAndLayerDefZoom:function(a,g,m){a.layerDefinition.capabilities||
(a.layerDefinition.capabilities="Query");var n={layer:null,id:"featColl_"+Math.floor(10001*Math.random()),type:"user",title:g?g:a.name,defaultVisibility:!0,defaultOpacity:1,snippet:"",visibility:!0,identify:!1},b=arcgisonline.map.layer.getLayerPosition(n);arcgisonline.map.main.mapLayers.splice(b.list,0,n);b=b.map;-1<m.indexOf("option\x3dfootprints")&&-1<m.indexOf("/rest/services")&&(n.layer.__isFootprintLayer=!0);a.layerDefinition.name||(a.layerDefinition.name=n.title);m=arcgisonline.map.featColl.addFeatureLayer(a,
n.defaultVisibility,n.defaultOpacity,n.id,n);n.layer=m;a.popupInfo&&(n.popupInfo=a.popupInfo);!n.itemId&&g&&0<g.length&&n.layer&&n.layer.isEditable()&&("editStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()?setTimeout(function(){K.byId("editPanel").recreateEditor()},0):(arcgisonline.map.leftPanel.openLeftTOCPanel(),arcgisonline.map.edit.enableEditButton()));arcgisonline.map.main.map.addLayer(n.layer,b);g=null;a.layerDefinition.extent&&(g=g?g.union(new esri.geometry.Extent(a.layerDefinition.extent)):
new esri.geometry.Extent(a.layerDefinition.extent));g&&arcgisonline.map.main.projectToMapSpatialReference(g,function(c){arcgisonline.map.main.map.setExtent(c[0],!0)})},generateDefaultPopupInfo:function(a){var g={esriFieldTypeDouble:1,esriFieldTypeSingle:1},m={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},n={esriFieldTypeDate:1},b=null;a=e.map(a.layerDefinition.fields,e.hitch(this,function(c){"NAME"===c.name.toUpperCase()&&(b=c.name);var d="esriFieldTypeOID"!==c.type&&"esriFieldTypeGlobalID"!==
c.type&&"esriFieldTypeGeometry"!==c.type,l=null;if(d){var h=c.name.toLowerCase();if(-1<",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,".indexOf(","+h+",")||-1<h.indexOf("shape")||-1<h.indexOf("perimeter")||-1<h.indexOf("objectid")||h.indexOf("_")==h.length-1||h.indexOf("_i")==h.length-2&&1<h.length)d=!1;c.type in m?l={places:0,digitSeparator:!0}:c.type in g?l={places:2,digitSeparator:!0}:c.type in n&&(l={dateFormat:"longMonthDayYear"})}return e.mixin({},
{fieldName:c.name,label:c.alias,isEditable:esri.isDefined(c.editable)?c.editable:!0,tooltip:"",visible:esri.isDefined(c.visible)?c.visible:d,format:l,stringFieldOption:"textbox"})}));return{title:b?"{"+b+"}":"",fieldInfos:a,description:null,showAttachments:!1,mediaInfos:[]}},buildInfoTemplate:function(a){var g={content:"\x3ctable\x3e",title:a.title.replace("{","${")};e.forEach(a.fieldInfos,function(m){-1===a.title.indexOf("{"+m.fieldName+"}")&&m.visible&&(g.content+="\x3ctr\x3e\x3ctd valign\x3d'top'\x3e"+
m.label+": \x3c/td\x3e\x3ctd valign\x3d'top'\x3e${"+m.fieldName+"}\x3c/td\x3e\x3c/tr\x3e")});g.content+="\x3c/table\x3e";return g},getFullExtent:function(a){var g=null;a.layer?g=arcgisonline.map.featColl.getLayerFullExtent(a.layer):e.forEach(a.layers,function(m){(m=arcgisonline.map.featColl.getLayerFullExtent(m))&&(g=g?g.union(m):m)},this);return g},getLayerFullExtent:function(a){var g=null;e.forEach(a.graphics,function(m,n){(m=arcgisonline.map.featColl.getExtent(m.geometry))&&(g=g?g.union(m):m)},
this);return g},getExtent:function(a){if(!a)return null;var g=null;if("esri.geometry.Extent"==a.declaredClass)g=a;else if("esri.geometry.Point"==a.declaredClass)g=new esri.geometry.Extent(a.x-1E-4,a.y-1E-4,a.x+1E-4,a.y+1E-4,a.spatialReference);else if(g=a.getExtent())g.spatialReference=new esri.SpatialReference(a.spatialReference.toJson());return g},getFeatureSetFullExtent:function(a,g){var m=null;if(a&&"esriGeometryPoint"===a.geometryType&&a.features&&1===a.features.length&&g&&g.layerDefinition&&
g.layerDefinition.extent)return g.layerDefinition.extent;e.forEach(a.features,function(n){if(n.geometry){var b=esri.geometry.getGeometryType(a.geometryType),c=n.geometry.spatialReference||a.spatialReference;n=new b(e.mixin(n.geometry,{spatialReference:{wkid:c.wkid,latestWkid:c.latestWkid,wkt:c.wkt}}));(n="esri.geometry.Extent"==n.declaredClass?n:"esri.geometry.Point"==n.declaredClass?new esri.geometry.Extent(n.x-1E-4,n.y-1E-4,n.x+1E-4,n.y+1E-4,n.spatialReference):n.getExtent())&&(m=m?m.union(n):n)}},
this);return m},getLayerSR:function(a){return a.graphics&&a.graphics.length&&a.graphics[0].geometry&&a.graphics[0].geometry.spatialReference?a.graphics[0].geometry.spatialReference:arcgisonline.map.main.map.spatialReference},projectFeatureSet:function(a,g,m){if(a.featureSet&&a.featureSet.features&&0!==a.featureSet.features.length)if(newSpatialReference=arcgisonline.map.main.map.spatialReference,arcgisonline.map.main.sameSpatialReference(newSpatialReference,g))a.layerDefinition.extent=arcgisonline.map.featColl.getFeatureSetFullExtent(a.featureSet,
a),m(a);else{var n=function(l){e.forEach(a.featureSet.features,function(h,f){l[f]&&(h.geometry=l[f])},this);a.layerDefinition.extent=arcgisonline.map.featColl.getFeatureSetFullExtent(a.featureSet,a);m(a)},b=function(l,h){arcgisonline.map.main.projectJsonGeometries(d,a.featureSet.geometryType,g,newSpatialReference,e.hitch(this,n),e.hitch(this,c))},c=function(l,h){m(a)};if(a.featureSet.features&&0<a.featureSet.features.length){var d=[];e.forEach(a.featureSet.features,function(l){d.push(l.geometry)});
arcgisonline.map.main.projectJsonGeometries(d,a.featureSet.geometryType,g,newSpatialReference,e.hitch(this,n),e.hitch(this,b))}else m(a)}else m(a)},roundFeatureSetCoordinates:function(a){e.forEach(a.featureSet.features,function(g){g=g.geometry;g.xmin?(g.xmin=Math.round(100*g.xmin)/100,g.xmax=Math.round(100*g.xmax)/100,g.ymin=Math.round(100*g.ymin)/100,g.ymax=Math.round(100*g.ymax)/100):g.rings?e.forEach(g.rings,function(m){e.forEach(m,function(n){n[0]=Math.round(100*n[0])/100;n[1]=Math.round(100*
n[1])/100},this)},this):g.paths?e.forEach(g.paths,function(m){e.forEach(m,function(n){n[0]=Math.round(100*n[0])/100;n[1]=Math.round(100*n[1])/100},this)},this):g.x&&(g.x=Math.round(100*g.x)/100,g.y=Math.round(100*g.y)/100)});a.layerDefinition.extent&&(a.layerDefinition.extent.xmax=Math.round(100*a.layerDefinition.extent.xmax)/100,a.layerDefinition.extent.xmin=Math.round(100*a.layerDefinition.extent.xmin)/100,a.layerDefinition.extent.ymax=Math.round(100*a.layerDefinition.extent.ymax)/100,a.layerDefinition.extent.ymin=
Math.round(100*a.layerDefinition.extent.ymin)/100)},isFeatureCollection:function(a){return a.layer?arcgisonline.map.featColl.isFeatureCollectionLayer(a.layer):a.layers||a.tables?!0:!1},isFeatureCollectionLayer:function(a){return"esri.layers.FeatureLayer"!=a.declaredClass||a.url?!1:!0},is4xSketchLayer:function(a){var g=!1;if(arcgisonline.map.featColl.isFeatureCollection(a)&&a.layers&&a.layers.length){var m=a.layers[0].fields;m||(m=a.layers[0].layerDefinition&&a.layers[0].layerDefinition.fields);m&&
2===m.length&&-1<["OBJECTID","title"].indexOf(m[0].name)&&-1<["OBJECTID","title"].indexOf(m[1].name)&&(g=!0)}return g},getSR:function(a){var g=null;a.featureSet&&a.featureSet.features&&a.featureSet.features.length&&a.featureSet.features[0].geometry&&a.featureSet.features[0].geometry.spatialReference?g=new esri.SpatialReference(a.featureSet.features[0].geometry.spatialReference):a.featureSet&&a.featureSet.spatialReference?g=new esri.SpatialReference(a.featureSet.spatialReference):a.layerDefinition&&
a.layerDefinition.extent&&a.layerDefinition.extent.spatialReference?g=new esri.SpatialReference(a.layerDefinition.extent.spatialReference):a.featureSet&&a.featureSet.features&&a.featureSet.features.length||a.layerDefinition&&a.layerDefinition.extent&&a.layerDefinition.extent.spatialReference||(g=new esri.SpatialReference({wkid:4326}));return g},getSubLayerById:function(a,g){for(var m=0;m<a.layers.length;m++){var n=a.layers[m];if(n.id===g)return n}if(a.tables)for(m=0;m<a.tables.length;m++)if(n=a.tables[m],
n.id===g)return n;return null},buildConfig:function(a){var g={layerType:"ArcGISFeatureLayer"};a.featureCollectionType&&(g.featureCollectionType=a.featureCollectionType);a.id&&"undefined"!==a.id&&(g.id=a.id);g.title=a.title;g.featureCollection=arcgisonline.map.featColl.buildFeatureCollectionJson(a);a.layers?(g.opacity=a.layers[0].opacity||0===a.layers[0].opacity?a.layers[0].opacity:1,g.visibility=0==a.visibility?!1:!0,""==a.visibleLayers?g.visibleLayers=[]:esri.isDefined(a.visibleLayers)&&(!a.itemId||
a.itemId&&a.visibleLayersChanged)&&(g.visibleLayers=e.map(a.visibleLayers.split(","),function(m){return parseInt(m)}))):(g.visibility=a.layer.visible,g.opacity=a.layer.opacity||0===a.layer.opacity?a.layer.opacity:1);a.url&&(g.type="CSV",g.layerType="CSV",delete g.featureCollectionType,g.url=a.url,g.layerDefinition=g.featureCollection.layers[0].layerDefinition,g.popupInfo=g.featureCollection.layers[0].popupInfo,g.locationInfo=a.locationInfo?a.locationInfo:null,g.columnDelimiter=a.columnDelimiter?a.columnDelimiter:
",",delete g.featureCollection,!1===a.showLegend&&(g.showLegend=!1));a.itemId&&(g.type="Feature Collection",g.layerType="ArcGISFeatureLayer",g.itemId=a.itemId,g.featureCollection.showLegend=!1===a.showLegend?!1:!0,a.popupChanged||a.scaleChanged||a.rendererChanged||a.featureReductionChanged||a.legendChanged?e.forEach(g.featureCollection.layers,function(m){delete m.featureSet;delete m.nextObjectId;if("Table"===m.layerDefinition.type)delete m.layerDefinition;else{var n={drawingInfo:m.layerDefinition.drawingInfo};
esri.isDefined(m.layerDefinition.featureReduction)&&(n.featureReduction=m.layerDefinition.featureReduction);esri.isDefined(m.layerDefinition.minScale)&&(n.minScale=m.layerDefinition.minScale);esri.isDefined(m.layerDefinition.maxScale)&&(n.maxScale=m.layerDefinition.maxScale);!1===m.layerDefinition.showLegend&&(n.showLegend=!1);m.layerDefinition=n}}):delete g.featureCollection,a.timeChanged&&a.layer&&a.layer.timeInfo&&0==a.layer.useMapTime&&(g.timeAnimation=!1),e.json.stringify(a.origItemDataProps)===
e.json.stringify({featureCollection:g.featureCollection})&&delete g.featureCollection);return g},buildFeatureCollectionJson:function(a){var g={layers:[]},m=!1;if("mapNotes"==a.type){var n=[102113,102100,3857],b=arcgisonline.map.main.map.spatialReference.wkid;esri.isDefined(b)&&arcgisonline.map.main.contains(n,b)&&(m=!0)}n=a.layers;a.tables&&(n=n.concat(a.tables));n?(e.forEach(n,function(c){var d=c.toJson();d.featureSet.features=d.featureSet.features||[];c.labelingInfo&&!arcgisonline.map.labels.hasLayer(c)&&
delete d.layerDefinition.drawingInfo.labelingInfo;m&&arcgisonline.map.featColl.roundFeatureSetCoordinates(d);c.__popupInfo?d.popupInfo=c.__popupInfo:delete d.popupInfo;c.minScale||c.maxScale?(d.layerDefinition.minScale=c.minScale?c.minScale:0,d.layerDefinition.maxScale=c.maxScale&&1!==c.maxScale?c.maxScale:0,d.layerDefinition.minScale===Number.POSITIVE_INFINITY&&(d.layerDefinition.minScale=0),0===d.layerDefinition.minScale&&0===d.layerDefinition.maxScale&&(delete d.layerDefinition.minScale,delete d.layerDefinition.maxScale,
arcgisonline.isEmpty(d.layerDefinition)&&delete d.layerDefinition)):(delete d.layerDefinition.minScale,delete d.layerDefinition.maxScale);var l=c.getFeatureReduction();l?(d.layerDefinition=d.layerDefinition||{},d.layerDefinition.featureReduction=l,d.layerDefinition.featureReduction.clusterRadius=p.gfx.px2pt(d.layerDefinition.featureReduction.clusterRadius),d.layerDefinition.featureReduction.infoTemplate&&(d.layerDefinition.featureReduction.popupInfo=d.layerDefinition.featureReduction.infoTemplate.toJson(),
delete d.layerDefinition.featureReduction.infoTemplate)):d.layerDefinition&&delete d.layerDefinition.featureReduction;delete d.showLegend;!1===c.__showLegend?d.showLegend=!1:!0===c.__showLegend&&(d.showLegend=!0);l=arcgisonline.map.featColl.getLayerFullExtent(c);d.layerDefinition.extent=l?l.toJson():null;d.layerDefinition.spatialReference=arcgisonline.map.featColl.getLayerSR(c).toJson();g.layers.push(d)},this),arcgisonline.map.featColl.is4xSketchLayer(a)&&(n=arcgisonline.map.main.getItemWithId((arcgisonline.map.save_open.originalWebMap||
arcgisonline.map.save_open.openedWebMap).operationalLayers||[],a.id))&&(g=e.clone(n.featureCollection))):(n=a.layer.toJson(),a.layer.labelingInfo&&!arcgisonline.map.labels.hasLayer(a.layer)&&delete n.layerDefinition.drawingInfo.labelingInfo,a.popupInfo?n.popupInfo=a.popupInfo:a.layer.__popupInfo?n.popupInfo=a.layer.__popupInfo:delete n.popupInfo,a.layer.minScale||a.layer.maxScale?(n.layerDefinition.minScale=a.layer.minScale,n.layerDefinition.maxScale=a.layer.maxScale,n.layerDefinition.minScale===
Number.POSITIVE_INFINITY&&(n.layerDefinition.minScale=0),n.layerDefinition.minScale||n.layerDefinition.maxScale||(delete n.layerDefinition.minScale,delete n.layerDefinition.maxScale,arcgisonline.isEmpty(n.layerDefinition)&&delete n.layerDefinition)):(delete n.layerDefinition.minScale,delete n.layerDefinition.maxScale,arcgisonline.isEmpty(n.layerDefinition)&&delete n.layerDefinition),(b=a.layer.getFeatureReduction())?(n.layerDefinition=n.layerDefinition||{},n.layerDefinition.featureReduction=b,n.layerDefinition.featureReduction.clusterRadius=
p.gfx.px2pt(n.layerDefinition.featureReduction.clusterRadius),n.layerDefinition.featureReduction.infoTemplate&&(n.layerDefinition.featureReduction.popupInfo=n.layerDefinition.featureReduction.infoTemplate.toJson(),delete n.layerDefinition.featureReduction.infoTemplate)):n.layerDefinition&&delete n.layerDefinition.featureReduction,b=arcgisonline.map.featColl.getLayerFullExtent(a.layer),n.layerDefinition.extent=b?b.toJson():null,n.layerDefinition.spatialReference=arcgisonline.map.featColl.getLayerSR(a.layer).toJson(),
g.layers.push(n));g.showLegend=!1===a.showLegend?!1:!0;return g}}})},"arcgisonline/map/labels":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/map/main,esri/layers/LabelLayer"],function(e,K,p){e.provide("arcgisonline.map.labels");e.require("arcgisonline.map.main");e.require("esri.layers.LabelLayer");arcgisonline.map.labels={labelLayer:null,updateLabelsForLayer:function(a){a.labelingInfo?(arcgisonline.map.labels.createLabelLayer(),arcgisonline.map.labels.hasLayer(a)||(arcgisonline.map.labels.labelLayer.addFeatureLayer(a),
a.setShowLabels&&a.setShowLabels(!0),arcgisonline.map.labels.orderLayers())):arcgisonline.map.labels.hasLayer(a)&&arcgisonline.map.labels.removeLabelsForLayer(a)},addLabelsForLayer:function(a){a.labelingInfo&&(arcgisonline.map.labels.createLabelLayer(),arcgisonline.map.labels.hasLayer(a)||(arcgisonline.map.labels.labelLayer.addFeatureLayer(a),setTimeout(function(){arcgisonline.map.labels.labelLayer.refresh()},2E3)),a.setShowLabels&&a.setShowLabels(!0),arcgisonline.map.labels.orderLayers())},removeLabelsForLayer:function(a){arcgisonline.map.labels.hasLayer(a)&&
(arcgisonline.map.labels.labelLayer.removeFeatureLayer(a.id),a.setShowLabels&&a.setShowLabels(!1))},createLabelLayer:function(){arcgisonline.map.labels.labelLayer||(arcgisonline.map.labels.labelLayer=new esri.layers.LabelLayer({id:"LabelLayer"}),arcgisonline.map.main.map.addLayer(arcgisonline.map.labels.labelLayer))},hasLayer:function(a){return arcgisonline.map.labels.labelLayer&&arcgisonline.map.labels.labelLayer.getFeatureLayer(a.id)?!0:!1},orderLayers:function(){if(arcgisonline.map.labels.labelLayer){-1<
e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,"LabelLayer")&&arcgisonline.map.main.map.reorderLayer("LabelLayer",arcgisonline.map.main.map.graphicsLayerIds.length);var a=!1,g=0;e.forEach(arcgisonline.map.main.map.graphicsLayerIds,function(m){var n=arcgisonline.map.main.map.getLayer(m);if(n.labelingInfo&&arcgisonline.map.labels.hasLayer(n)){var b=0;e.forEach(arcgisonline.map.labels.labelLayer.featureLayers,function(c,d){c.id===n.id&&(b=d)});b!==g&&(m=arcgisonline.map.labels.labelLayer.featureLayers.splice(b,
1)[0],arcgisonline.map.labels.labelLayer.featureLayers.splice(g,0,m),m=arcgisonline.map.labels.labelLayer._featureLayerInfos.splice(b,1)[0],arcgisonline.map.labels.labelLayer._featureLayerInfos.splice(g,0,m),a=!0);g++}});a&&arcgisonline.map.labels.labelLayer.refresh()}},hideAllLabels:function(){arcgisonline.map.labels.labelLayer&&arcgisonline.map.labels.labelLayer.hide()},showAllLabels:function(){arcgisonline.map.labels.labelLayer&&arcgisonline.map.labels.labelLayer.show()}}})},"esri/layers/LabelLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/i18n!dojo/cldr/nls/number dojo/number dojo/has dojox/gfx/_base ../kernel ../lang ../graphic ../PopupInfo ../ArcadeExpression ../core/timerUtils ../symbols/TextSymbol ../symbols/ShieldLabelSymbol ../geometry/Extent ../geometry/Point ../geometry/webMercatorUtils ../renderers/SimpleRenderer ../arcadeProfiles/labelingProfile ./labelLayerUtils/DynamicLabelClass ./labelLayerUtils/StaticLabelClass ./GraphicsLayer ./LabelClass".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P){function R(S){return"sizeInfo"===S.type}e=e(J,{declaredClass:"esri.layers.LabelLayer",constructor:function(S){this._refreshLabels=K.hitch(this,this._refreshLabels);this.id="labels";this.featureLayers=[];this._featureLayerInfos=[];this._preparedLabels=[];this._engineType="STATIC";this._mapEventHandlers=[];S&&(S.id&&(this.id=S.id),S.mode&&(this._engineType="DYNAMIC"===S.mode.toUpperCase()?"DYNAMIC":"STATIC"))},_setMap:function(S){this._mapEventHandlers.push(S.on("extent-change",
K.hitch(this,"_handleLevelChange")));var T=this.inherited(arguments);this.refresh();return T},_unsetMap:function(){var S;for(S=0;S<this._mapEventHandlers.length;S++)a.disconnect(this._mapEventHandlers[S]);this.refresh();r.clearTimeout(this._refreshHandle);this._refreshHandle=null;this.inherited(arguments)},setAlgorithmType:function(S){this._engineType=S&&"DYNAMIC"===S.toUpperCase()?"DYNAMIC":"STATIC";this.refresh()},addFeatureLayer:function(S,T,E,I){if(!this.getFeatureLayer(S.layerId)){var F=[];F.push(S.on("update-end",
K.hitch(this,"refresh")));F.push(S.on("suspend",K.hitch(this,"refresh")));F.push(S.on("resume",K.hitch(this,"refresh")));F.push(S.on("edits-complete",K.hitch(this,"refresh")));F.push(S.on("labeling-info-change",K.hitch(this,"refresh")));F.push(S.on("time-extent-change",K.hitch(this,"refresh")));F.push(S.on("show-labels-change",K.hitch(this,"refresh")));F.push(S.on("feature-reduction-change",K.hitch(this,"refresh")));this._featureLayerInfos.push({FeatureLayer:S,LabelExpressionInfo:E,LabelingOptions:I,
LabelRenderer:T,EventHandlers:F});this.featureLayers.push(S);this.refresh()}},getFeatureLayer:function(S){var T;for(T=0;T<this.featureLayers.length;T++){var E=this.featureLayers[T];if(void 0!==E&&E.id==S)return E}return null},removeFeatureLayer:function(S){S=this.getFeatureLayer(S);if(void 0!==S){var T=p.indexOf(this.featureLayers,S);if(-1<T){this.featureLayers.splice(T,1);for(S=0;S<this._featureLayerInfos[T].EventHandlers.length;S++)a.disconnect(this._featureLayerInfos[T].EventHandlers[S]);this._featureLayerInfos.splice(T,
1);this.refresh()}}},removeAllFeatureLayers:function(){var S;for(S=0;S<this.featureLayers.length;S++){for(var T=0;T<this._featureLayerInfos[S].EventHandlers.length;T++)a.disconnect(this._featureLayerInfos[S].EventHandlers[T]);this.featureLayers=[];this._featureLayerInfos=[]}this.refresh()},getFeatureLayers:function(){return this.featureLayers},getFeatureLayerInfo:function(S){var T;for(T=0;T<this.featureLayers.length;T++){var E=this.featureLayers[T];if(void 0!==E&&E.id==S)return this._featureLayerInfos[T]}return null},
refresh:function(){null==this._refreshHandle&&(this._refreshHandle=r.setTimeout(this._refreshLabels,r.priority.LOW))},_handleLevelChange:function(S){S.levelChange&&this.clear();this.refresh()},_refreshLabels:function(S){this._refreshHandle=null;var T=[],E,I="DYNAMIC"===this._engineType?new A:new B;if(this._map){I.setMap(this._map,this);this._preparedLabels=[];for(S=0;S<this.featureLayers.length;S++){var F=this.featureLayers[S];if(F.visible&&F.showLabels&&F.visibleAtMapScale&&!F._suspended){var D=
this._featureLayerInfos[S];var C=this._convertOptions(null);if(D.LabelRenderer){if(T=F.labelingInfo)if(E=T[0]){var y=this._getLabelExpression(E);C=this._convertOptions(E)}var G=D.LabelRenderer;D.LabelExpressionInfo&&(y=D.LabelExpressionInfo);D.LabelingOptions&&(C=this._convertOptions(null),void 0!==D.LabelingOptions.pointPriorities&&(T=D.LabelingOptions.pointPriorities,C.pointPriorities="above-center"==T||"AboveCenter"==T||"esriServerPointLabelPlacementAboveCenter"==T?"AboveCenter":"above-left"==
T||"AboveLeft"==T||"esriServerPointLabelPlacementAboveLeft"==T?"AboveLeft":"above-right"==T||"AboveRight"==T||"esriServerPointLabelPlacementAboveRight"==T?"AboveRight":"below-center"==T||"BelowCenter"==T||"esriServerPointLabelPlacementBelowCenter"==T?"BelowCenter":"below-left"==T||"BelowLeft"==T||"esriServerPointLabelPlacementBelowLeft"==T?"BelowLeft":"below-right"==T||"BelowRight"==T||"esriServerPointLabelPlacementBelowRight"==T?"BelowRight":"center-center"==T||"CenterCenter"==T||"esriServerPointLabelPlacementCenterCenter"==
T?"CenterCenter":"center-left"==T||"CenterLeft"==T||"esriServerPointLabelPlacementCenterLeft"==T?"CenterLeft":"center-right"==T||"CenterRight"==T||"esriServerPointLabelPlacementCenterRight"==T?"CenterRight":"AboveRight"),void 0!==D.LabelingOptions.lineLabelPlacement&&(C.lineLabelPlacement=D.LabelingOptions.lineLabelPlacement),void 0!==D.LabelingOptions.lineLabelPosition&&(C.lineLabelPosition=D.LabelingOptions.lineLabelPosition),void 0!==D.LabelingOptions.labelRotation&&(C.labelRotation=D.LabelingOptions.labelRotation),
void 0!==D.LabelingOptions.howManyLabels&&(C.howManyLabels=D.LabelingOptions.howManyLabels));G instanceof P&&(y=this._getLabelExpression(G),G=new x(G.symbol),C=this._convertOptions(G));this._addLabels(F,G,y,C)}else if(T=F.labelingInfo)for(D=T.length-1;0<=D;D--)if(E=T[D])G=new P(E instanceof P?E.toJson():E),y=this._getLabelExpression(E),C=this._convertOptions(E),this._addLabels(F,G,y,C)}}y=I._process(this._preparedLabels);this.clear();this.drawLabels(this._map,y)}},drawLabels:function(S,T){this._scale=
(S.extent.xmax-S.extent.xmin)/S.width;var E;for(E=0;E<T.length;E++){var I=T[E],F=I.x,D=I.y,C=I.text,y=I.angle,G=I.layer.labelSymbol;"polyline"==I.layer.geometry.type&&I.layer.options.labelRotation&&G.setAngle(180/Math.PI*y);G.setText(C);G instanceof q&&(C=G.getHeight(),F-=.25*C*this._scale*Math.sin(y),D-=.33*C*this._scale);y=new l(new u(F,D,S.extent.spatialReference));y.setParentGraphic(I.layer.graphic);y.setSymbol(G);this.add(y)}},_addLabels:function(S,T,E,I){var F;if(this._isWithinScaleRange(T.minScale,
T.maxScale)&&E&&""!==E){var D=this._map,C=!S.url&&!D.spatialReference.equals(S.spatialReference);for(F=0;F<S.graphics.length;F++){var y=S.graphics[F];if(!1!==y.visible&&!y._suspended){var G=y.geometry;if(C){if(!v.canProject(G,D))continue;G=v.project(G,D)}if(G&&this._isWhere(T.where,y.attributes)&&this._isWithinScreenArea(G)){var L=this._buildLabelText(E,y,S.fields,I);this._addLabel(L,T,S.renderer,y,I,G,D)}}}}},_isWithinScreenArea:function(S){S="point"===S.type?new w(S.x,S.y,S.x,S.y,S.spatialReference):
S.getExtent();if(void 0===S)return!1;S=this._intersects(this._map,S);return null===S||0===S.length?!1:!0},_isWithinScaleRange:function(S,T){var E=this._map.getScale();return 0<S&&E>=S||0<T&&E<T?!1:!0},_isWhere:function(S,T){try{if(!S)return!0;if(S){var E=S.split(" ");if(3===E.length)return this._sqlEquation(T[this._removeQuotes(E[0])],E[1],this._removeQuotes(E[2]));if(7===E.length){var I=this._sqlEquation(T[this._removeQuotes(E[0])],E[1],this._removeQuotes(E[2])),F=E[3],D=this._sqlEquation(T[this._removeQuotes(E[4])],
E[5],this._removeQuotes(E[6]));switch(F){case "AND":return I&&D;case "OR":return I||D}}}return!1}catch(C){}},_sqlEquation:function(S,T,E){switch(T){case "\x3d":return S==E?!0:!1;case "\x3c\x3e":return S!=E?!0:!1;case "\x3e":return S>E?!0:!1;case "\x3e\x3d":return S>=E?!0:!1;case "\x3c":return S<E?!0:!1;case "\x3c\x3d":return S<=E?!0:!1}return!1},_removeQuotes:function(S){var T=S.indexOf('"'),E=S.lastIndexOf('"');if(-1!=T&&-1!=E)return S.substr(1,S.length-2);T=S.indexOf("'");E=S.lastIndexOf("'");return-1!=
T&&-1!=E?S.substr(1,S.length-2):S},_getSizeInfo:function(S){return S?S.sizeInfo||p.filter(S.visualVariables,R)[0]:null},_addLabel:function(S,T,E,I,F,D,C){var y;if(S&&""!==K.trim(S)&&T){S=S.replace(/[\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/g," ");var G=T.getSymbol(I);G instanceof q?(G=new q(G.toJson()),G.setVerticalAlignment("baseline"),G.setHorizontalAlignment("center")):G=G instanceof t?new t(G.toJson()):new q;G.setText(S);T.symbol=G;if(y=this._getProportionalSize(T.sizeInfo,
I.attributes))G instanceof q?G.setSize(y):G instanceof t&&(G.setWidth(y),G.setHeight(y));var L=y=0;if(E){var O=E.getSymbol(I);var U=this._getSizeInfo(E);if((E=U?E.getSize(I,{sizeInfo:U,resolution:C.getResolutionInMeters()}):I.size)&&null!==E)y=L=E;else if(O)if("simplemarkersymbol"==O.type)L=y=O.size;else if("picturemarkersymbol"==O.type)y=O.width,L=O.height;else if("simplelinesymbol"==O.type||"cartographiclinesymbol"==O.type)y=O.width}E={};E.graphic=I;E.options=F;E.geometry=D;E.labelRenderer=T;E.labelSymbol=
G;E.labelWidth=G.getWidth()/2;E.labelHeight=G.getHeight()/2;E.symbolWidth=b.normalizedLength(y)/2;E.symbolHeight=b.normalizedLength(L)/2;E.text=S;E.angle=G.angle;this._preparedLabels.push(E)}},_buildLabelText:function(S,T,E,I){if(I.hasExpression)return S=z.getEvalOptions({expression:I.arcadeExpr,feature:T,layer:T.getLayer(),spatialReference:this._map.spatialReference}),T=T.evaluateExpression(I.arcadeExpr,S),d.isDefined(T)?""+T:"";var F=T.attributes;return S.replace(/{[^}]*}/g,function(D){var C,y=
D;for(C=0;C<E.length;C++)if("{"+E[C].name+"}"==D){y=F[E[C].name];var G=E[C].domain;if(G&&K.isObject(G)){if("codedValue"==G.type&&I.useCodedValues)for(C=y,D=0;D<G.codedValues.length;D++)if(G.codedValues[D].code==C){y=G.codedValues[D].name;break}break}G=E[C].type;if(I.fieldInfos){var L=I.fieldInfos;for(C=0;C<L.length;C++)if("{"+L[C].fieldName+"}"==D){D=L[C].format;"esriFieldTypeDate"==G?y=d.substitute({myKey:y},"${myKey}",{format:{myKey:K.mixin({formatType:"DateFormat"},h.prototype._dateFormatsJson[D&&
D.dateFormat||"shortDate"])}}):"esriFieldTypeInteger"!=G&&"esriFieldTypeSingle"!=G&&"esriFieldTypeSmallInteger"!=G&&"esriFieldTypeLong"!=G&&"esriFieldTypeDouble"!=G||!D||(y=m.format(y,{places:D.places}),D.digitSeparator||g.group&&(y=y.replace(new RegExp("\\"+g.group,"g"),"")));break}}break}else y="";return null==y?"":y})},_getLabelExpression:function(S){var T="";S.labelExpressionInfo?T=S.labelExpressionInfo.value||S.labelExpressionInfo.expression:this._validSyntax(S.labelExpression)&&(T=this._convertLabelExpression(S.labelExpression));
return T},_validSyntax:function(S){return/^(\s*\[[^\]]+\]\s*)+$/i.test(S)},_convertLabelExpression:function(S){return S.replace(RegExp("\\[","g"),"{").replace(RegExp("\\]","g"),"}")},_getProportionalSize:function(S,T){if(!S)return null;T=d.substitute(T,"${"+S.field+"}",{first:!0});return!(S.minSize&&S.maxSize&&S.minDataValue&&S.maxDataValue&&T)||0>=S.maxDataValue-S.minDataValue?null:(S.maxSize-S.minSize)/(S.maxDataValue-S.minDataValue)*(T-S.minDataValue)+S.minSize},_convertOptions:function(S){var T=
!0,E="shortDate",I=null,F=null,D="",C=!0;if(S&&(S.format&&(E=S.format.dateFormat,I={places:S.format.places,digitSeparator:S.format.digitSeparator}),F=S.fieldInfos,D=S.labelPlacement,null!=S.useCodedValues&&(T=S.useCodedValues),S=S.labelExpressionInfo)){var y=S.expression;if(y&&!S.value){var G=!0;var L=new f({expression:y,returnType:"string",profile:z})}}if("always-horizontal"==D||"esriServerPolygonPlacementAlwaysHorizontal"==D)C=!1;return{useCodedValues:T,dateFormat:E,numberFormat:I,fieldInfos:F,
pointPriorities:"above-center"==D||"esriServerPointLabelPlacementAboveCenter"==D?"AboveCenter":"above-left"==D||"esriServerPointLabelPlacementAboveLeft"==D?"AboveLeft":"above-right"==D||"esriServerPointLabelPlacementAboveRight"==D?"AboveRight":"below-center"==D||"esriServerPointLabelPlacementBelowCenter"==D?"BelowCenter":"below-left"==D||"esriServerPointLabelPlacementBelowLeft"==D?"BelowLeft":"below-right"==D||"esriServerPointLabelPlacementBelowRight"==D?"BelowRight":"center-center"==D||"esriServerPointLabelPlacementCenterCenter"==
D?"CenterCenter":"center-left"==D||"esriServerPointLabelPlacementCenterLeft"==D?"CenterLeft":"center-right"==D||"esriServerPointLabelPlacementCenterRight"==D?"CenterRight":"AboveRight",lineLabelPlacement:"above-start"==D||"below-start"==D||"center-start"==D?"PlaceAtStart":"above-end"==D||"below-end"==D||"center-end"==D?"PlaceAtEnd":"PlaceAtCenter",lineLabelPosition:"above-after"==D||"esriServerLinePlacementAboveAfter"==D||"above-along"==D||"esriServerLinePlacementAboveAlong"==D||"above-before"==D||
"esriServerLinePlacementAboveBefore"==D||"above-start"==D||"esriServerLinePlacementAboveStart"==D||"above-end"==D||"esriServerLinePlacementAboveEnd"==D?"Above":"below-after"==D||"esriServerLinePlacementBelowAfter"==D||"below-along"==D||"esriServerLinePlacementBelowAlong"==D||"below-before"==D||"esriServerLinePlacementBelowBefore"==D||"below-start"==D||"esriServerLinePlacementBelowStart"==D||"below-end"==D||"esriServerLinePlacementBelowEnd"==D?"Below":"center-after"==D||"esriServerLinePlacementCenterAfter"==
D||"center-along"==D||"esriServerLinePlacementCenterAlong"==D||"center-before"==D||"esriServerLinePlacementCenterBefore"==D||"center-start"==D||"esriServerLinePlacementCenterStart"==D||"center-end"==D||"esriServerLinePlacementCenterEnd"==D?"OnLine":"Above",labelRotation:C,howManyLabels:"OneLabel",hasExpression:G,arcadeExpr:L}}});K.setObject("layers.LabelLayer",e,c);return e})},"esri/layers/labelLayerUtils/DynamicLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Polygon".split(" "),
function(e,K,p,a,g,m){e=e(null,{declaredClass:"esri.layers.labelLayerUtils.DynamicLabelClass",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._y1=this._x1=this._y0=this._x0=this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1},setMap:function(n,b){this._labelLayer=b;this._xmin=n.extent.xmin;this._xmax=n.extent.xmax;this._ymin=n.extent.ymin;this._ymax=n.extent.ymax;this._scale=(this._xmax-this._xmin)/n.width},_process:function(n){this._preparedLabels=
n;this._placedLabels=[];var b;for(n=this._preparedLabels.length-1;0<=n;n--){var c=this._preparedLabels[n],d=Math.min(c.labelWidth,c.labelHeight),l=c.labelWidth+0*d;d=c.labelHeight+0*d;var h=(b=c.options)&&void 0!==b.lineLabelPlacement?b.lineLabelPlacement:"PlaceAtCenter",f=b&&void 0!==b.lineLabelPosition?b.lineLabelPosition:"Above",r=b&&void 0!==b.pointPriorities?b.pointPriorities:"AboveRight",q=[2,2,1,3,0,2,3,3,2];"AboveLeft"==r?q=[1,2,2,2,0,3,2,3,3]:"AboveCenter"==r?q=[2,1,2,2,0,2,3,3,3]:"AboveRight"==
r?q=[2,2,1,3,0,2,3,3,2]:"CenterLeft"==r?q=[2,2,3,1,0,3,2,2,3]:"CenterCenter"==r?q=[0,0,0,0,1,0,0,0,0]:"CenterRight"==r?q=[3,2,2,3,0,1,3,2,2]:"BelowLeft"==r?q=[2,3,3,2,0,3,1,2,2]:"BelowCenter"==r?q=[3,3,3,2,0,2,2,1,2]:"BelowRight"==r&&(q=[3,3,2,3,0,2,2,2,1]);var t=b&&void 0!==b.labelRotation?b.labelRotation:!0;r=Math.PI/180*c.angle;b=b&&void 0!==b.howManyLabels?b.howManyLabels:"OneLabel";if("point"==c.geometry.type)this._generatePointPositions(c,c.geometry.x,c.geometry.y,c.text,r,l,d,c.symbolWidth,
c.symbolHeight,q);else if("multipoint"==c.geometry.type)for(h=c.geometry,f=0;f<h.points.length;f++)this._generatePointPositions(c,h.points[f][0],h.points[f][1],c.text,r,l,d,c.symbolWidth,c.symbolHeight,q);else"polyline"==c.geometry.type?this._generateLinePositions(c,c.geometry,c.text,l,d,2*c.symbolHeight+d,h,f,t):"polygon"==c.geometry.type&&this._generatePolygonPositions(c,b,c.geometry,c.text,r,l,d)}return this._placedLabels},_generatePointPositions:function(n,b,c,d,l,h,f,r,q,t){r=(r+h)*this._scale;
q=(q+f)*this._scale;var w,u;for(w=1;3>=w;w++)for(u=1;9>=u;u++)if(t[u-1]==w)switch(u){case 1:if(this._findPlace(n,d,b-r,c+q,l,h,f))return;break;case 2:if(this._findPlace(n,d,b,c+q,l,h,f))return;break;case 3:if(this._findPlace(n,d,b+r,c+q,l,h,f))return;break;case 4:if(this._findPlace(n,d,b-r,c,l,h,f))return;break;case 5:if(this._findPlace(n,d,b,c,l,h,f))return;break;case 6:if(this._findPlace(n,d,b+r,c,l,h,f))return;break;case 7:if(this._findPlace(n,d,b-r,c-q,l,h,f))return;break;case 8:if(this._findPlace(n,
d,b,c-q,l,h,f))return;break;case 9:if(this._findPlace(n,d,b+r,c-q,l,h,f))return}},_generateLinePositions:function(n,b,c,d,l,h,f,r,q){var t=d*this._scale*d*this._scale,w,u;for(w=0;w<b.paths.length;w++){var v=b.paths[w],x=v.length,z=Math.floor((x-1)/2),A=0!==(x-1)%2?1:-1;"PlaceAtStart"==f&&(z=0,A=1);"PlaceAtEnd"==f&&(z=x-2,A=-1);for(;0<=z&&z<x-1;){for(u=z;u<x;u++){var B=v[z][0],J=v[z][1],P=v[u][0]-B,R=v[u][1]-J;if(P*P+R*R>t){for(var S=Math.atan2(R,P);S>Math.PI/2;)S-=Math.PI;for(;S<-(Math.PI/2);)S+=
Math.PI;var T=Math.sin(S),E=Math.cos(S),I=0,F=0;"Above"==r&&(I=h*T*this._scale,F=h*E*this._scale);"Below"==r&&(I=-h*T*this._scale,F=-h*E*this._scale);if(1==u-z){if(this._clipLine(B,J,v[u][0],v[u][1])){B=this._x1-this._x0;var D=this._y1-this._y0;if(B*B+D*D>t&&(u=Math.atan2(D,B),P=d/2+2*l,J=P*this._scale*Math.cos(u),P=P*this._scale*Math.sin(u),"PlaceAtStart"==f?(B=this._x0+J,D=this._y0+P):"PlaceAtEnd"==f?(B=this._x1-J,D=this._y1-P):(B=this._x0+B/2,D=this._y0+D/2),this._findPlace(n,c,B-I,D+F,q?-u:0,
d,l)))return}}else{var C=0;for(D=z;D<=u;D++)C=Math.max(C,Math.abs((v[D][1]-J)*E-(v[D][0]-B)*T));if(C<l&&this._findPlace(n,c,B+P/2-I,J+R/2+F,q?-S:0,d,l))return}break}}z+=A}}},_generatePolygonPositions:function(n,b,c,d,l,h,f){if("ManyLabels"==b)for(b=0;b<c.rings.length;b++){var r=c.rings[b];m.prototype.isClockwise(r)&&(r=this._findCentroid(r,this._xmin,this._ymin,this._xmax,this._ymax),this._findPlace(n,d,r[0],r[1],l,h,f))}else{r=this._findCentroidForFeature(c,this._xmin,this._ymin,this._xmax,this._ymax);
var q=r[1],t=0;for(b=0;10>b;b++){t+=f/4;r=this._findCentroidForFeature(c,this._xmin,q+(t-f/4),this._xmax,q+(t+f/4));if(this._findPlace(n,d,r[0],r[1],l,h,f))break;r=this._findCentroidForFeature(c,this._xmin,q-(t+f/4),this._xmax,q-(t-f/4));if(this._findPlace(n,d,r[0],r[1],l,h,f))break}}},_findCentroid:function(n,b,c,d,l){var h=n.length,f=[0,0],r=0,q=n[0][0],t=n[0][1];q>d&&(q=d);q<b&&(q=b);t>l&&(t=l);t<c&&(t=c);for(var w=1;w<h-1;w++){var u=n[w][0],v=n[w][1],x=n[w+1][0],z=n[w+1][1];u>d&&(u=d);u<b&&(u=
b);v>l&&(v=l);v<c&&(v=c);x>d&&(x=d);x<b&&(x=b);z>l&&(z=l);z<c&&(z=c);var A=(u-q)*(z-t)-(x-q)*(v-t);f[0]+=A*(q+u+x);f[1]+=A*(t+v+z);r+=A}f[0]/=3*r;f[1]/=3*r;if(isNaN(f[0])||isNaN(f[1]))return f;c=[];this._fillBuffer(n,c,f);f[0]=this._sortBuffer(c,f[0],b,d);return f},_findCentroidForFeature:function(n,b,c,d,l){for(var h,f=0,r=[0,0],q=0;q<n.rings.length;q++){var t=n.rings[q],w=t.length,u=t[0][0],v=t[0][1];u>d&&(u=d);u<b&&(u=b);v>l&&(v=l);v<c&&(v=c);for(h=1;h<w-1;h++){var x=t[h][0],z=t[h][1],A=t[h+1][0],
B=t[h+1][1];x>d&&(x=d);x<b&&(x=b);z>l&&(z=l);z<c&&(z=c);A>d&&(A=d);A<b&&(A=b);B>l&&(B=l);B<c&&(B=c);var J=(x-u)*(B-v)-(A-u)*(z-v);r[0]+=J*(u+x+A);r[1]+=J*(v+z+B);f+=J}}r[0]/=3*f;r[1]/=3*f;if(isNaN(r[0])||isNaN(r[1]))return r;c=[];for(h=0;h<n.rings.length;h++)this._fillBuffer(n.rings[h],c,r);r[0]=this._sortBuffer(c,r[0],b,d);return r},_fillBuffer:function(n,b,c){for(var d=n.length-1,l=n[0][1]>=n[d][1]?1:-1,h=0;h<=d;h++){var f=h,r=h+1;h==d&&(r=0);var q=n[f][0];f=n[f][1];var t=n[r][0];r=n[r][1];var w=
r>=f?1:-1;if(f<=c[1]&&c[1]<=r||r<=c[1]&&c[1]<=f)c[1]!=f&&c[1]!=r?(b.push((c[1]-f)*(t-q)/(r-f)+q),l=w):c[1]==f&&c[1]!=r?(l!=w&&b.push(q),l=w):c[1]!=f&&c[1]==r?(b.push(t),l=w):c[1]==f&&c[1]==r&&(1==l&&b.push(q),b.push(t),l=w)}},_sortBuffer:function(n,b,c,d){var l=n.length;n.sort();if(0<l){for(var h=0,f=b=0;f<l-1;f+=2){var r=Math.abs(n[f+1]-n[f]);!(n[f]<=c&&n[f+1]<=c||n[f]>=d&&n[f+1]>=d)&&r>h&&(h=r,b=f)}l=n[b];n=n[b+1];l>d&&(l=d);l<c&&(l=c);n>d&&(n=d);n<c&&(n=c);b=(l+n)/2}return b},_findPlace:function(n,
b,c,d,l,h,f){if(isNaN(c)||isNaN(d))return!1;for(var r=0;r<this._placedLabels.length;r++){var q=this._placedLabels[r].angle,t=this._placedLabels[r].width*this._scale,w=this._placedLabels[r].height*this._scale,u=this._placedLabels[r].x-c,v=this._placedLabels[r].y-d;if(0===l&&0===q){if(this._findPlace2(-h*this._scale,-f*this._scale,h*this._scale,f*this._scale,u-t,v-w,u+t,v+w))return!1}else{var x=new g(-h*this._scale,-f*this._scale,h*this._scale,f*this._scale,null),z=0,A=1;0!==l&&(z=Math.sin(l),A=Math.cos(l));
var B=u*A-v*z;u=u*z+v*A;q-=l;z=Math.sin(q);A=Math.cos(q);var J=-t*A- -w*z;v=-t*z+-w*A;q=+t*A- -w*z;var P=+t*z+-w*A;t=B+J;w=u-v;z=B+q;A=u-P;J=B-J;v=u+v;B-=q;u+=P;q=new m;q.addRing([[t,w],[z,A],[J,v],[B,u],[t,w]]);if(x.intersects(q))return!1}}for(;l>Math.PI/2;)l-=Math.PI;for(;l<-(Math.PI/2);)l+=Math.PI;r={};r.layer=n;r.text=b;r.angle=l;r.x=c;r.y=d;r.width=h;r.height=f;this._placedLabels.push(r);return!0},_findPlace2:function(n,b,c,d,l,h,f,r){return(n>=l&&n<=f||c>=l&&c<=f||n<=l&&c>=f)&&(b>=h&&b<=r||
d>=h&&d<=r||b<=h&&d>=r)?!0:!1},_clipLine:function(n,b,c,d){for(var l=this._code(n,b),h=this._code(c,d);0!==l||0!==h;){if(0!==(l&h))return!1;var f=c-n,r=d-b;0!==l?(n<this._xmin?(b+=r*(this._xmin-n)/f,n=this._xmin):n>this._xmax?(b+=r*(this._xmax-n)/f,n=this._xmax):b<this._ymin?(n+=f*(this._ymin-b)/r,b=this._ymin):b>this._ymax&&(n+=f*(this._ymax-b)/r,b=this._ymax),l=this._code(n,b)):(c<this._xmin?(d+=r*(this._xmin-c)/f,c=this._xmin):c>this._xmax?(d+=r*(this._xmax-c)/f,c=this._xmax):d<this._ymin?(c+=
f*(this._ymin-d)/r,d=this._ymin):d>this._ymax&&(c+=f*(this._ymax-d)/r,d=this._ymax),h=this._code(c,d))}this._x0=n;this._y0=b;this._x1=c;this._y1=d;return!0},_code:function(n,b){var c=0;n<this._xmin&&(c+=8);n>this._xmax&&(c+=4);b<this._ymin&&(c+=2);b>this._ymax&&(c+=1);return c}});K.setObject("layers.labelLayerUtils.DynamicLabelClass",e,a);return e})},"esri/layers/labelLayerUtils/StaticLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Point ../../geometry/Polygon".split(" "),
function(e,K,p,a,g,m,n){return e(null,{declaredClass:"esri.layers.labelLayerUtils.StaticLabel",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1;this._LINE_STEP_CONST=1.5;this._POLYGON_X_STEP_CONST=1;this._POLYGON_Y_STEP_CONST=.75;this._OVERRUN=2},setMap:function(b,c){this._labelLayer=c;this._map=b;this._xmin=b.extent.xmin;this._xmax=b.extent.xmax;this._ymin=b.extent.ymin;this._ymax=b.extent.ymax;this._scale=
(this._xmax-this._xmin)/b.width},_process:function(b){var c;this._preparedLabels=b;this._placedLabels=[];for(b=this._preparedLabels.length-1;0<=b;b--){var d=this._preparedLabels[b];var l=d.labelWidth;var h=d.labelHeight;var f=(c=d.options)&&c.lineLabelPlacement?c.lineLabelPlacement:"PlaceAtCenter";var r=c&&c.lineLabelPosition?c.lineLabelPosition:"Above";var q=c&&c.labelRotation?c.labelRotation:!0;var t=Math.PI/180*d.angle;var w=c&&c.howManyLabels?c.howManyLabels:"OneLabel";var u=[];if("point"===d.geometry.type)this._generatePointPositions(d.geometry.x,
d.geometry.y,d.text,t,l,h,d.symbolWidth,d.symbolHeight,c,u);else if("multipoint"===d.geometry.type)for(q=0;q<d.geometry.points.length;q++)this._generatePointPositions(d.geometry.points[q][0],d.geometry.points[q][1],d.text,t,l,h,d.symbolWidth,d.symbolHeight,c,u);else if("polyline"===d.geometry.type)if("PlaceAtStart"===f)this._generateLinePositionsPlaceAtStart(d.geometry,!0,d.text,l,h,2*d.symbolHeight+h,f,r,q,u);else if("PlaceAtEnd"===f)this._generateLinePositionsPlaceAtEnd(d.geometry,!0,d.text,l,h,
2*d.symbolHeight+h,f,r,q,u);else{c=[];var v=d.geometry.getExtent(),x=this._map.extent;if(v.getWidth()<l*this._scale/this._OVERRUN&&v.getHeight()<l*this._scale/this._OVERRUN)continue;else.5*v.getWidth()<x.getWidth()&&.5*v.getHeight()<x.getHeight()?this._generateLinePositionsPlaceAtCenter(d.geometry,!1,.1*Math.min(this._map.width,this._map.height)*this._scale,d.text,l,h,2*d.symbolHeight+h,f,r,q,c):this._generateLinePositionsPlaceAtCenter(d.geometry,!0,.2*Math.min(this._map.width,this._map.height)*this._scale,
d.text,l,h,2*d.symbolHeight+h,f,r,q,c);this._postSorting(x,c,u)}else if("polygon"===d.geometry.type){f=[];for(q=0;q<d.geometry.rings.length;q++)r=d.geometry.rings[q],1<d.geometry.rings.length&&!n.prototype.isClockwise(r)||(c=this._calcRingExtent(r),c.xmax-c.xmin<4*l*this._scale/this._OVERRUN&&c.ymax-c.ymin<4*h*this._scale/this._OVERRUN||f.push(r));f.sort(function(z,A){return A.length-z.length});for(q=0;q<f.length;q++)this._generatePolygonPositionsForManyLabels(f[q],d.geometry.spatialReference,d.text,
t,l,h,u)}for(q=0;q<u.length&&(f=u[q].x,r=u[q].y,void 0!==u[q].angle&&(t=u[q].angle),c=this._findPlace(d,d.text,f,r,t,l,h),"OneLabel"!==w||!c||!this._labelLayer._isWithinScreenArea(new m(f,r,d.geometry.spatialReference)));q++);}return this._placedLabels},_generatePointPositions:function(b,c,d,l,h,f,r,q,t,w){d=t&&t.pointPriorities?t.pointPriorities:"AboveRight";h=(r+h)*this._scale;f=(q+f)*this._scale;switch(d.toLowerCase()){case "aboveleft":b-=h;c+=f;break;case "abovecenter":c+=f;break;case "aboveright":b+=
h;c+=f;break;case "centerleft":b-=h;break;case "centercenter":break;case "centerright":b+=h;break;case "belowleft":b-=h;c-=f;break;case "belowcenter":c-=f;break;case "belowright":b+=h;c-=f;break;default:return}w.push({x:b,y:c})},_generateLinePositionsPlaceAtStart:function(b,c,d,l,h,f,r,q,t,w){r=l*this._scale;var u=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,v,x;for(v=0;v<b.paths.length;v++){var z=b.paths[v],A=r,B=0;for(x=0;x<z.length-1;x++){var J=z[x][0];var P=z[x][1];
var R=z[x+1][0];var S=z[x+1][1];var T=R-J;var E=S-P;T=Math.sqrt(T*T+E*E);B+T>A?(B=this._generatePositionsOnLine(b.spatialReference,c,A,u,B,J,P,R,S,d,l,h,f,q,t,w),A=u):B+=T}}},_generateLinePositionsPlaceAtEnd:function(b,c,d,l,h,f,r,q,t,w){r=l*this._scale;var u=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,v,x;for(v=0;v<b.paths.length;v++){var z=b.paths[v],A=r,B=0;for(x=z.length-2;0<=x;x--){var J=z[x+1][0];var P=z[x+1][1];var R=z[x][0];var S=z[x][1];var T=R-J;var E=S-
P;T=Math.sqrt(T*T+E*E);B+T>A?(B=this._generatePositionsOnLine(b.spatialReference,c,A,u,B,J,P,R,S,d,l,h,f,q,t,w),A=u):B+=T}}},_generateLinePositionsPlaceAtCenter:function(b,c,d,l,h,f,r,q,t,w,u){var v;for(q=0;q<b.paths.length;q++){var x=b.paths[q];if(!(2>x.length)){if(2==x.length){var z=x[0];var A=x[1];var B=z[0];z=z[1];x=A[0];var J=A[1];var P=(x-B)*(x-B)+(J-z)*(J-z);var R=Math.atan2(J-z,x-B);J=Math.cos(R);R=Math.sin(R);x=[];var S=B;for(var T=z;(S-B)*(S-B)+(T-z)*(T-z)<P;)x.push([S,T]),S+=d/2*J,T+=d/
2*R;x.push(A)}var E=0;for(A=0;A<x.length-1;A++)B=x[A][0],z=x[A][1],P=x[A+1][0],J=x[A+1][1],R=P-B,S=J-z,E+=Math.sqrt(R*R+S*S);for(A=T=0;A<x.length-1;A++){B=x[A][0];z=x[A][1];P=x[A+1][0];J=x[A+1][1];R=P-B;S=J-z;R=Math.sqrt(R*R+S*S);if(T+R>E/2)break;T+=R}A==x.length-1&&A--;B=x[A][0];z=x[A][1];P=x[A+1][0];J=x[A+1][1];R=P-B;S=J-z;T=E/2-T;R=Math.atan2(S,R);S=B+T*Math.cos(R);R=z+T*Math.sin(R);B=this._angleAndShifts(B,z,P,J,r,t,w);u.push({x:S+B.shiftX,y:R+B.shiftY,angle:B.angle});E=S;var I=R;T=0;for(v=A;v<
x.length-1;v++)v==A?(B=E,z=I):(B=x[v][0],z=x[v][1]),P=x[v+1][0],J=x[v+1][1],R=P-B,S=J-z,R=Math.sqrt(R*R+S*S),T=T+R>d?this._generatePositionsOnLine(b.spatialReference,c,d,d,T,B,z,P,J,l,h,f,r,t,w,u):T+R;T=0;for(v=A;0<=v;v--)v==A?(B=E,z=I):(B=x[v+1][0],z=x[v+1][1]),P=x[v][0],J=x[v][1],R=P-B,S=J-z,R=Math.sqrt(R*R+S*S),T=T+R>d?this._generatePositionsOnLine(b.spatialReference,c,d,d,T,B,z,P,J,l,h,f,r,t,w,u):T+R}}},_generatePositionsOnLine:function(b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B){w=Math.atan2(t-r,q-f);u=
f;v=r;var J=u,P=v;do if(h=d-h,u+=h*Math.cos(w),v+=h*Math.sin(w),this._belongs(u,v,f,r,q,t))h=this._angleAndShifts(f,r,q,t,x,z,A),d=u+h.shiftX,P=v+h.shiftY,c?this._labelLayer._isWithinScreenArea(new g(d,P,d,P,b))&&B.push({x:d,y:P,angle:h.angle}):B.push({x:d,y:P,angle:h.angle}),J=u,P=v,h=0,d=l;else return b=q-J,t-=P,Math.sqrt(b*b+t*t);while(1)},_postSorting:function(b,c,d){if(b&&0<c.length){var l=.5*(b.xmin+b.xmax);b=.5*(b.ymin+b.ymax);for(var h=c[0].x,f=c[0].y,r=Math.sqrt((h-l)*(h-l)+(f-b)*(f-b)),
q=c[0].angle,t=0;t<c.length;t++){var w=c[t].x,u=c[t].y,v=Math.sqrt((w-l)*(w-l)+(u-b)*(u-b));v<r&&(h=w,f=u,r=v,q=c[t].angle)}d.push({x:h,y:f,angle:q})}},_belongs:function(b,c,d,l,h,f){if(h==d&&f==l)return!1;if(h>d){if(b>h||b<d)return!1}else if(b<h||b>d)return!1;if(f>l){if(c>f||c<l)return!1}else if(c<f||c>l)return!1;return!0},_angleAndShifts:function(b,c,d,l,h,f,r){for(b=Math.atan2(l-c,d-b);b>Math.PI/2;)b-=Math.PI;for(;b<-(Math.PI/2);)b+=Math.PI;l=Math.sin(b);var q=Math.cos(b);d=c=0;"Above"==f&&(c=
h*l*this._scale,d=h*q*this._scale);"Below"==f&&(c=-h*l*this._scale,d=-h*q*this._scale);h=[];h.angle=r?-b:0;h.shiftX=-c;h.shiftY=d;return h},_generatePolygonPositionsForManyLabels:function(b,c,d,l,h,f,r){h=this._findCentroidForRing(b);l=h[0];var q=h[1],t=this._calcRingExtent(b);h=t.xmin;f=t.ymin;var w=t.xmax;t=t.ymax;var u=(t-f)/(this._map.height*this._scale);if(!(10<(w-h)/(this._map.width*this._scale)&&10<u)){var v=!0;if(w-h>this._map.width*this._scale||t-f>this._map.height*this._scale)v=!1;u=this._map.width*
this._scale*(v?.1875:.5);v=this._map.height*this._scale*(v?.1875:.5);var x=!0,z=!0,A=0;do{q+=(A%2?-1:1)*A*v;if(this._scanRingByX(d,c,b,l,q,h,w,u,r))break;q<f&&(x=!1);q>t&&(z=!1);A++}while(x||z)}},_scanRingByX:function(b,c,d,l,h,f,r,q,t){var w=!0,u=!0,v=0,x=1E3;do{l+=(v%2?-1:1)*v*q;var z=this._movePointInsideRing(d,l,h),A=this._labelLayer._isWithinScreenArea(new g(z,h,z,h,c)),B=this._isPointWithinRing(b,d,z,h);if(A&&B)return t.push({x:z,y:h}),!0;l<f&&(w=!1);l>r&&(u=!1);v++;x--;if(0>=x)return!0}while(w||
u);return!1},_movePointInsideRing:function(b,c,d){for(var l=[],h=b.length-1,f=b[0][1]>=b[h][1]?1:-1,r=0;r<=h;r++){var q=r,t=r+1;r==h&&(t=0);var w=b[q][0];q=b[q][1];var u=b[t][0];t=b[t][1];var v=t>=q?1:-1;if(q<=d&&d<=t||t<=d&&d<=q)d!=q&&d!=t?(l.push((d-q)*(u-w)/(t-q)+w),f=v):d==q&&d!=t?(f!=v&&l.push(w),f=v):d!=q&&d==t?(l.push(u),f=v):d==q&&d==t&&(1==f&&l.push(w),l.push(u),f=v)}l.sort(function(x,z){return x-z});b=l.length;if(0<b){for(r=d=c=0;r<b-1;r+=2)h=Math.abs(l[r+1]-l[r]),h>c&&(c=h,d=r);c=(l[d]+
l[d+1])/2}return c},_calcRingExtent:function(b){var c;var d=new g;for(c=0;c<b.length-1;c++){var l=b[c][0],h=b[c][1];if(void 0===d.xmin||l<d.xmin)d.xmin=l;if(void 0===d.ymin||h<d.ymin)d.ymin=h;if(void 0===d.xmax||l>d.xmax)d.xmax=l;if(void 0===d.ymax||h>d.ymax)d.ymax=h}return d},_isPointWithinPolygon:function(b,c,d,l){var h;for(h=0;h<c.rings.length;h++)if(this._isPointWithinRing(b,c.rings[h],d,l))return!0;return!1},_isPointWithinRing:function(b,c,d,l){var h=[],f=c.length;for(b=0;b<f-1;b++){var r=c[b][0];
var q=c[b][1];var t=c[b+1][0];var w=c[b+1][1];if(r!=t||q!=w){if(q==w)if(l==q)h.push(r);else continue;r==t?(q<w&&l>=q&&l<w&&h.push(r),q>w&&l<=q&&l>w&&h.push(r)):(q=(t-r)/(w-q)*(l-q)+r,r<t&&q>=r&&q<t&&h.push(q),r>t&&q<=r&&q>t&&h.push(q))}}h.sort(function(u,v){return u-v});for(b=0;b<h.length-1;b++)if(r=h[b],t=h[b+1],d>=r&&d<t)if(b%2)break;else return!0;return!1},_findCentroidForRing:function(b){for(var c=b.length,d=[0,0],l=0,h=b[0][0],f=b[0][1],r=1;r<c-1;r++){var q=b[r][0],t=b[r][1],w=b[r+1][0],u=b[r+
1][1],v=(q-h)*(u-f)-(w-h)*(t-f);d[0]+=v*(h+q+w);d[1]+=v*(f+t+u);l+=v}d[0]/=3*l;d[1]/=3*l;return d},_findCentroidForFeature:function(b){for(var c=0,d=[0,0],l=0;l<b.rings.length;l++)for(var h=b.rings[l],f=h.length,r=h[0][0],q=h[0][1],t=1;t<f-1;t++){var w=h[t][0],u=h[t][1],v=h[t+1][0],x=h[t+1][1],z=(w-r)*(x-q)-(v-r)*(u-q);d[0]+=z*(r+w+v);d[1]+=z*(q+u+x);c+=z}d[0]/=3*c;d[1]/=3*c;return d},_findPlace:function(b,c,d,l,h,f,r){if(isNaN(d)||isNaN(l))return!1;for(var q=0;q<this._placedLabels.length;q++){var t=
this._placedLabels[q].angle,w=this._placedLabels[q].width*this._scale,u=this._placedLabels[q].height*this._scale,v=this._placedLabels[q].x-d,x=this._placedLabels[q].y-l;if(0===h&&0===t){if(this._findPlace2(-f*this._scale,-r*this._scale,f*this._scale,r*this._scale,v-w,x-u,v+w,x+u))return!1}else{var z=new g(-f*this._scale,-r*this._scale,f*this._scale,r*this._scale,null),A=0,B=1;0!==h&&(A=Math.sin(h),B=Math.cos(h));var J=v*B-x*A;v=v*A+x*B;t-=h;A=Math.sin(t);B=Math.cos(t);var P=-w*B- -u*A;x=-w*A+-u*B;
t=+w*B- -u*A;var R=+w*A+-u*B;w=J+P;u=v-x;A=J+t;B=v-R;P=J-P;x=v+x;J-=t;v+=R;t=new n;t.addRing([[w,u],[A,B],[P,x],[J,v],[w,u]]);if(z.intersects(t))return!1}}for(;h>Math.PI/2;)h-=Math.PI;for(;h<-(Math.PI/2);)h+=Math.PI;q={};q.layer=b;q.text=c;q.angle=h;q.x=d;q.y=l;q.width=f;q.height=r;this._placedLabels.push(q);return!0},_findPlace2:function(b,c,d,l,h,f,r,q){return(b>=h&&b<=r||d>=h&&d<=r||b<=h&&d>=r)&&(c>=f&&c<=q||l>=f&&l<=q||c<=f&&l>=q)?!0:!1}})})},"arcgisonline/map/edit":function(){define(["dojo",
"dijit","dojox","dojo/require!arcgisonline/map/main"],function(e,K,p){e.provide("arcgisonline.map.edit");e.require("arcgisonline.map.main");arcgisonline.map.edit={editActivated:!1,hasEditableFS:!1,notEditableLayers:[],proxyCheckedServers:[],checkGoingOn:!1,startMsg:null,addPointMsg:null,checkOnEditButton:function(){arcgisonline.map.edit.checkGoingOn||arcgisonline.map.edit.checkInternalLayer()},checkInternalLayer:function(){arcgisonline.map.edit.checkGoingOn=!0;for(var a=!1,g=0;g<arcgisonline.map.main.mapLayers.length;g++){var m=
arcgisonline.map.main.mapLayers[g];if(m&&m.layer&&m.layer.visible&&m.url&&!arcgisonline.map.featColl.isFeatureCollection(m)&&!arcgisonline.sharing.util.isHostedService(m.url)&&m.layer instanceof esri.layers.FeatureLayer&&m.layer.isEditable()&&!m.proxyCheck)if(esri.hasSameOrigin(m.url,window.location.href))m.proxyCheck="sameOrigin";else if(esri.canUseXhr(m.url))m.proxyCheck="cors";else{a=!0;arcgisonline.map.edit.getProxyServiceInfo(g,1);break}}a||(arcgisonline.map.edit.checkGoingOn=!1,arcgisonline.map.edit.hasEditableLayer())},
hasEditableLayer:function(){if(!arcgisonline.map.role.isAllowed("tool_edit")||isEmbedded&&isEmbedded.hideEdit)if(arcgisonline.map.role.isAllowed("tool_edit_mapNotes")){for(var a=!1,g=0;g<arcgisonline.map.main.mapLayers.length;g++){var m=arcgisonline.map.main.mapLayers[g];if("mapNotes"===m.type){for(var n=0;n<m.layers.length;n++){var b=m.layers[n];if(b.visible&&b.isEditable()){a=!0;break}}break}}a?arcgisonline.map.edit.enableEditButton():arcgisonline.map.edit.disableEditButton()}else arcgisonline.map.edit.disableEditButton();
else{a=!1;arcgisonline.map.edit.hasEditableFS=!1;for(g=0;g<arcgisonline.map.main.mapLayers.length;g++)if(m=arcgisonline.map.main.mapLayers[g],n=arcgisonline.map.featColl.isFeatureCollection(m),b=arcgisonline.map.featColl.is4xSketchLayer(m),n&&!b&&arcgisonline.map.role.isAllowed("tool_edit_featCol")||"mapNotes"===m.type&&arcgisonline.map.role.isAllowed("tool_edit_mapNotes"))if(m.layer&&m.layer.visible&&m.layer.isEditable())a=!0;else{if(m.layers&&0<m.layers.length&&(n=!1,"notes"===m.featureCollectionType&&
e.some(m.layers,function(c){c=c.fields;return 1===c.length&&"OBJECTID"===c[0].name})&&(n=!0),!n))for(n=0;n<m.layers.length;n++)if(b=m.layers[n],b.visible&&b.isEditable()){a=!0;break}}else m&&m.layer&&m.layer.visible&&m.layer.url&&m.layer instanceof esri.layers.FeatureLayer&&m.layer.isEditable()&&("success"===m.proxyCheck||"cors"===m.proxyCheck||"sameOrigin"===m.proxyCheck||arcgisonline.sharing.util.isHostedService(m.url)&&m.layer.isEditable()?a=arcgisonline.map.edit.hasEditableFS=!0:m.layer._editable=
!1);a?arcgisonline.map.edit.enableEditButton():arcgisonline.map.edit.disableEditButton()}},getProxyServiceInfo:function(a,g){var m=arcgisonline.map.main.mapLayers[a],n=function(q,t){clearTimeout(r);r=null;if(q){q=m.layer.url;var w=-1<q.indexOf("/FeatureServer")?q.substring(0,q.indexOf("/FeatureServer")+14):null;arcgisonline.map.edit.proxyCheckedServers[d]=arcgisonline.map.edit.proxyCheckedServers[d]||[];e.filter(arcgisonline.map.edit.proxyCheckedServers[d],function(u){return u.service===w}).length||
arcgisonline.map.edit.proxyCheckedServers[d].push({service:w,result:{},proxyCheck:"success"})}m.proxyCheck="success";m.layer._editable=!0;arcgisonline.map.edit.checkInternalLayer()},b=function(q){clearTimeout(r);r=null;if(q||1!==g){m.proxyCheck="failure";arcgisonline.map.edit.checkInternalLayer();arcgisonline.map.edit.notEditableLayers.push(m.title);var t=m.layer.url,w=-1<t.indexOf("/FeatureServer")?t.substring(0,t.indexOf("/FeatureServer")+14):null;arcgisonline.map.edit.proxyCheckedServers[d]=arcgisonline.map.edit.proxyCheckedServers[d]||
[];e.filter(arcgisonline.map.edit.proxyCheckedServers[d],function(u){return u.service===w}).length||(arcgisonline.map.edit.proxyCheckedServers[d].push({service:w,result:q||{},proxyCheck:"failure"}),setTimeout(function(){var u="";u=q&&400===q.status?1<arcgisonline.map.edit.notEditableLayers.length?e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayers,{layers:"\x3cbr/\x3e-\x26nbsp;\x26nbsp;"+arcgisonline.map.edit.notEditableLayers.toString().replace(/,/g,"\x3cbr/\x3e-\x26nbsp;\x26nbsp;")+
"\x3cbr/\x3e\x3cbr/\x3e",appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayer,{layer:arcgisonline.map.edit.notEditableLayers[0],appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):esriGeowConfig.self.isPortal&&q&&(-1===q.code||403===q.code&&2===q.subcode)?1<arcgisonline.map.edit.notEditableLayers.length?e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayersTrusted,
{layers:"\x3cbr/\x3e-\x26nbsp;\x26nbsp;"+arcgisonline.map.edit.notEditableLayers.toString().replace(/,/g,"\x3cbr/\x3e-\x26nbsp;\x26nbsp;")+"\x3cbr/\x3e\x3cbr/\x3e",appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayerTrusted,{layer:arcgisonline.map.edit.notEditableLayers[0],appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):1<arcgisonline.map.edit.notEditableLayers.length?
e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayersGeneric,{layers:"\x3cbr/\x3e-\x26nbsp;\x26nbsp;"+arcgisonline.map.edit.notEditableLayers.toString().replace(/,/g,"\x3cbr/\x3e-\x26nbsp;\x26nbsp;")+"\x3cbr/\x3e\x3cbr/\x3e",appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayerGeneric,{layer:arcgisonline.map.edit.notEditableLayers[0],appName:esriGeowConfig.portalName?esriGeowConfig.portalName:
esri.i18nBundle.common.arcgisCom});var v=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();v.show({title:esri.i18nBundle.viewer.edit.editing,message:u});e.aspect.after(v,"onHide",function(){arcgisonline.map.edit.notEditableLayers=[]})},2E3))}else arcgisonline.map.edit.getProxyServiceInfo(a,2)};if(arcgisonline.map.edit.proxyCheckedServers){var c=m.layer.url,d=c.substring(0,c.indexOf("/",9)),l=arcgisonline.map.edit.proxyCheckedServers[d];if(l){var h=-1<c.indexOf("/FeatureServer")?
c.substring(0,c.indexOf("/FeatureServer")+14):null,f=l[0];h&&e.forEach(l,function(q){q.service===h&&(f=q)});if("success"===f.proxyCheck){if(!esriGeowConfig.self.isPortal||!h||f.service===h){n();return}}else if(403!==f.result.code||2!==f.result.subcode||f.service===h){b(f.result);return}}}var r=setTimeout(function(){b({})},2E4);m.layer._editable=!1;c=m.layer.url+"?f\x3djson";(l=m.layer._getToken())&&(c+="\x26token\x3d"+l);esri.request({url:c,content:null,callbackParamName:"callback",load:function(q,
t){r&&(q.error&&0<q.error.length?b(q):n(q,t))},error:function(q,t){r&&b(q)}},{usePost:!0,useProxy:!0})},enableEditButton:function(){K.byId("webmap-edit")&&"none"===e.style(K.byId("webmap-edit").domNode,"display")&&(K.byId("webmap-edit").set("disabled",!1),10>=e.isIE?e.style(K.byId("webmap-edit").domNode,"display","inline-block"):e.style(K.byId("webmap-edit").domNode,"display",""),isEmbedded&&isEmbedded.hideBasemap&&e.style(e.byId("webmap-spacer2"),"display",""),arcgisonline.map.main.checkMinWidthOfPage())},
disableEditButton:function(){K.byId("webmap-edit")&&"none"!==e.style(K.byId("webmap-edit").domNode,"display")&&(e.style(K.byId("webmap-edit").domNode,"display","none"),isEmbedded&&isEmbedded.hideBasemap&&e.style(e.byId("webmap-spacer2"),"display","none"),arcgisonline.map.main.checkMinWidthOfPage())},clearSelection:function(){arcgisonline.map.edit.editActivated&&leftPanel.editPanel.editorWidget._clearSelection()},activateEdit:function(){arcgisonline.map.main.map.infoWindow.hide();arcgisonline.map.popup.disablePopupHandler();
arcgisonline.map.edit.editActivated=!0;arcgisonline.map.main.map.setMapCursor("default");arcgisonline.map.geocode.geocoder&&e.forEach(arcgisonline.map.geocode.geocoder.sources,function(a){if(a.layerId){var g=arcgisonline.map.main.getParameterListById(a.layerId);g&&g.layer&&g.layer.isEditable()&&(a.showInfoWindowOnSelect=!1)}});arcgisonline.map.edit.createTypesAndTemplatesForAllFeatCollLayers();e.forEach(arcgisonline.map.main.mapLayers,function(a){a.layer&&a.layer instanceof esri.layers.FeatureLayer&&
a.layer.isEditable()?arcgisonline.map.mapUtil.checkHostedFSAccess(a,e.hitch(this,function(g){"esri.renderer.HeatmapRenderer"===g.layer.renderer.declaredClass&&(g.layer.__currentRenderer=g.layer.renderer.toJson(),g.layer.setRenderer(new esri.renderers.SimpleRenderer(new esri.symbols.SimpleMarkerSymbol)),g.layer.redraw())}),e.hitch(this,function(){if(a.serviceInfo&&a.serviceInfo.drawingInfo&&a.serviceInfo.drawingInfo.renderer){var g=a.layer.renderer.toJson();if(e.toJson(a.serviceInfo.drawingInfo.renderer)!==
e.toJson(g)){a.layer.__currentRenderer=a.layer.renderer.toJson();g=esri.renderer.fromJson(a.serviceInfo.drawingInfo.renderer,{geometryType:a.layer.geometryType});if("esri.renderer.HeatmapRenderer"===g.declaredClass)a.layer.setRenderer(new esri.renderers.SimpleRenderer(new esri.symbols.SimpleMarkerSymbol));else if(a.layer.setRenderer(g),9>e.has("ie")){var m=[];g.symbol&&m.push(g.symbol);g.defaultSymbol&&m.push(g.defaultSymbol);g.infos&&e.forEach(g.infos,function(c){c.symbol&&m.push(c.symbol)});var n=
a.layer._url.path+"/images/",b=a.layer._getToken();e.forEach(m,function(c){var d=c.url;d&&(-1===d.search(/https?:/)&&-1===d.indexOf("data:")&&(c.url=n+d),b&&-1!==c.url.search(/https?:/)&&(c.url+="?token\x3d"+b))})}a.layer.redraw()}}else"esri.renderer.HeatmapRenderer"===a.layer.renderer.declaredClass&&(a.layer.__currentRenderer=a.layer.renderer.toJson(),a.layer.setRenderer(new esri.renderers.SimpleRenderer(new esri.symbols.SimpleMarkerSymbol)),a.layer.redraw())})):a.layers&&e.forEach(a.layers,function(g){g&&
g.isEditable()&&"esri.renderer.HeatmapRenderer"===g.renderer.declaredClass&&(g.__currentRenderer=g.renderer.toJson(),g.setRenderer(new esri.renderers.SimpleRenderer(new esri.symbols.SimpleMarkerSymbol)),g.redraw())})});arcgisonline.map.edit.startMsg=esri.bundle.toolbars.draw.start;arcgisonline.map.edit.addPointMsg=esri.bundle.toolbars.draw.addPoint;-1===esri.bundle.toolbars.draw.start.indexOf(esri.i18nBundle.viewer.main.snappingTip)&&(esri.bundle.toolbars.draw.start=esri.bundle.toolbars.draw.start+
"\x3cbr/\x3e"+esri.i18nBundle.viewer.main.snappingTip);-1===esri.bundle.toolbars.draw.addPoint.indexOf(esri.i18nBundle.viewer.main.snappingTip)&&(esri.bundle.toolbars.draw.addPoint=esri.bundle.toolbars.draw.addPoint+"\x3cbr/\x3e"+esri.i18nBundle.viewer.main.snappingTip)},stopEdit:function(){leftPanel&&leftPanel.editPanel&&leftPanel.editPanel.editorWidget&&leftPanel.editPanel.destroyEditor();arcgisonline.map.edit.editActivated=!1;arcgisonline.map.main.map&&arcgisonline.map.main.map.infoWindow.resize(300,
300);arcgisonline.map.main.setHandCursor();arcgisonline.map.popup.setupPopupHandler();arcgisonline.map.edit.removeTypesAndTemplatesForAllFeatCollLayers();arcgisonline.map.geocode.geocoder&&e.forEach(arcgisonline.map.geocode.geocoder.sources,function(a){delete a.showInfoWindowOnSelect});e.forEach(arcgisonline.map.main.mapLayers,function(a){a.layer&&a.layer.__currentRenderer?(a.layer.setRenderer(esri.renderer.fromJson(a.layer.__currentRenderer)),a.layer.redraw(),delete a.layer.__currentRenderer):a.layers&&
e.forEach(a.layers,function(g){g&&g.__currentRenderer&&(g.setRenderer(esri.renderer.fromJson(g.__currentRenderer)),g.redraw(),delete g.__currentRenderer)})});esri.bundle.toolbars.draw.start=arcgisonline.map.edit.startMsg||esri.bundle.toolbars.draw.start;esri.bundle.toolbars.draw.addPoint=arcgisonline.map.edit.addPointMsg||esri.bundle.toolbars.draw.addPoint},createTypesAndTemplatesForAllFeatCollLayers:function(){for(var a=arcgisonline.map.main.mapLayers.length-1;0<=a;a--){var g=arcgisonline.map.main.mapLayers[a];
if(arcgisonline.map.featColl.isFeatureCollection(g)&&!arcgisonline.map.mapNotes.isMapNotesMapLayer(g))if(g.layer)arcgisonline.map.edit.createTypesAndTemplatesOnLayer(g.layer);else if(g.layers)for(var m=g.layers.length-1;0<=m;m--)arcgisonline.map.edit.createTypesAndTemplatesOnLayer(g.layers[m])}},createTypesAndTemplatesOnMapLayer:function(a){if(a.layer&&arcgisonline.map.featColl.isFeatureCollection(a)&&!arcgisonline.map.mapNotes.isMapNotesMapLayer(a))if(a.layer){var g=a.layer;if(g.visible){var m=g.toJson();
m.layerDefinition.types&&0!=m.layerDefinition.types.length||m.layerDefinition.templates&&0!=m.layerDefinition.templates.length||arcgisonline.map.edit.createTypesAndTemplatesOnLayer(g)}}else for(var n=a.layers.length-1;0<=n;n--)g=a.layers[n],g.visible&&(m=g.toJson(),m.layerDefinition.types&&0!=m.layerDefinition.types.length||m.layerDefinition.templates&&0!=m.layerDefinition.templates.length||arcgisonline.map.edit.createTypesAndTemplatesOnLayer(g));else a.layer&&a.layer instanceof esri.layers.FeatureLayer&&
(!a.serviceInfo||a.serviceInfo&&a.serviceInfo.types&&a.serviceInfo.templates)&&(g=a.layer,g.templates.length||g.types.length||arcgisonline.map.edit.createTypesAndTemplatesOnLayer(g))},createTypesAndTemplatesOnLayer:function(a){var g=a.renderer;if("esri.renderer.SimpleRenderer"==g.declaredClass||"esri.renderer.ClassBreaksRenderer"==g.declaredClass||"esri.renderer.HeatmapRenderer"==g.declaredClass||"esri.renderer.UniqueValueRenderer"==g.declaredClass&&!g.attributeField){g=new esri.layers.FeatureTemplate;
g.description="";g.name=esri.i18nBundle.viewer.edit.newFeature;var m={};e.forEach(a.fields,function(f){f.editable&&(m[f.name]=f.defaultValue||null)});var n=new esri.Graphic({attributes:m});g.prototype=n;arcgisonline.map.edit.updateTypeIdField(a,"");arcgisonline.map.edit.updateTemplates(a,[g]);a.__hasTemporaryTypes=!0}else if("esri.renderer.UniqueValueRenderer"==g.declaredClass){var b=g.attributeField,c=["esriFieldTypeDouble","esriFieldTypeSingle"],d=["esriFieldTypeOID","esriFieldTypeInteger","esriFieldTypeSmallInteger"],
l=!1,h=!1;e.forEach(a.fields,function(f){f.name===b&&(fieldType=f.type,-1<e.indexOf(c,fieldType)?h=!0:-1<e.indexOf(d,fieldType)&&(l=!0))});a.types=[];e.forEach(g.infos,function(f,r){var q=f.value;(l||h)&&"string"===typeof q&&(q&&q.length&&"\x3cNull\x3e"!==q&&"Null"!==q?(q=l?parseInt(q):parseFloat(q),isNaN(q)&&(q=null)):q=null);if(esri.isDefined(q)){r=new esri.layers.FeatureType;r.id=q;r.name=f.label||f.value;var t=new esri.layers.FeatureTemplate;t.description="";t.name=f.label||f.value;var w={};w[b]=
q;e.forEach(a.fields,function(u){u.name!==b&&u.editable&&(w[u.name]=u.defaultValue||null)});f=new esri.Graphic(null,null,w,null);t.prototype=f;r.templates=[t];a.addType(r)}});arcgisonline.map.edit.updateTypeIdField(a,b);a.__hasTemporaryTypes=!0}},removeTypesAndTemplatesForAllFeatCollLayers:function(){for(var a=arcgisonline.map.main.mapLayers.length-1;0<=a;a--){var g=arcgisonline.map.main.mapLayers[a];if(arcgisonline.map.featColl.isFeatureCollection(g)&&!arcgisonline.map.mapNotes.isMapNotesMapLayer(g))if(g.layer)arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(g.layer);
else if(g.layers)for(var m=g.layers.length-1;0<=m;m--)arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(g.layers[m])}},removeTypesAndTemplatesOnMapLayer:function(a,g){if(a.layer&&arcgisonline.map.featColl.isFeatureCollection(a)&&!arcgisonline.map.mapNotes.isMapNotesMapLayer(a))if(a.layer)g&&a.layer.__hasTemporaryTypes?(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(a.layer),delete a.layer.__hasTemporaryTypes):g||arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(a.layer);else for(var m=
a.layers.length-1;0<=m;m--){var n=a.layers[m];g&&n.__hasTemporaryTypes?(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(n),delete n.__hasTemporaryTypes):g||arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(n)}},removeTypesAndTemplatesOnLayer:function(a){a.types&&(a.types=[],a._typesDirty=!0,arcgisonline.map.edit.updateTypeIdField(a,""));a.templates&&arcgisonline.map.edit.updateTemplates(a,[])},updateTypesAndTemplatesOnLayer:function(a){var g=function(n,b){var c=[];e.forEach(b,function(d){var l=
new esri.layers.FeatureTemplate;l.description=d.description||"";l.name=d.name||esri.i18nBundle.viewer.edit.newFeature;var h={};e.forEach(n.fields,function(r){var q=!1;for(prototypeAttr in d.prototype.attributes)if(prototypeAttr===r.name){q=!0;h[r.name]=d.prototype.attributes[r.name];break}q||r.editable&&(h[r.name]=r.defaultValue||null)});var f=new esri.Graphic({attributes:h});l.prototype=f;c.push(l)});return c};if(a.templates&&a.templates.length)arcgisonline.map.edit.updateTemplates(a,g(a,a.templates)),
a.__hasTemporaryTypes=!0;else if(a.types){var m=a.types;a.types=[];e.forEach(m,function(n){n.templates=g(a,n.templates);a.addType(n)});a.__hasTemporaryTypes=!0}},checkTypesAndTemplatesOnLayer:function(a){if(a.templates&&a.templates.length&&a.types&&a.types.length){if("esri.renderer.SimpleRenderer"==a.renderer.declaredClass||"esri.renderer.ClassBreaksRenderer"==a.renderer.declaredClass||"esri.renderer.HeatmapRenderer"==a.renderer.declaredClass||"esri.renderer.UniqueValueRenderer"==a.renderer.declaredClass&&
!a.renderer.attributeField)a.types=[],a._typesDirty=!0,arcgisonline.map.edit.updateTypeIdField(a,"");"esri.renderer.UniqueValueRenderer"==a.renderer.declaredClass&&arcgisonline.map.edit.updateTemplates(a,[])}if(!(a.templates&&a.templates.length||"esri.renderer.SimpleRenderer"!=a.renderer.declaredClass&&"esri.renderer.ClassBreaksRenderer"!=a.renderer.declaredClass&&"esri.renderer.HeatmapRenderer"!=a.renderer.declaredClass&&("esri.renderer.UniqueValueRenderer"!=a.renderer.declaredClass||a.renderer.attributeField))||
!(a.types&&a.types.length||"esri.renderer.UniqueValueRenderer"!=a.renderer.declaredClass)&&a.renderer.attributeField)arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(a),arcgisonline.map.edit.createTypesAndTemplatesOnLayer(a);else if(a.types&&a.types.length&&"esri.renderer.UniqueValueRenderer"==a.renderer.declaredClass){var g=a.renderer;g.attributeField!==a.typeIdField?(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(a),arcgisonline.map.edit.createTypesAndTemplatesOnLayer(a)):e.forEach(g.infos,
function(m){var n=!1;e.forEach(a.types,function(b){g.attributeField2?m.value.startsWith(b.id+",")?n=!0:null==b.id&&m.value.startsWith("\x3cNull\x3e,")&&(n=!0):b.id==m.value?n=!0:null==b.id&&"\x3cNull\x3e"==m.value&&(n=!0)});n||(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(a),arcgisonline.map.edit.createTypesAndTemplatesOnLayer(a))})}},updateTypeIdField:function(a,g){a.typeIdField=g;if(a._collection){var m=9>e.isIE?e.json.parse(a._json):JSON.parse(a._json);m.layerDefinition?m.layerDefinition.typeIdField=
g:m.typeIdField=g;a._json=9>e.isIE?e.json.stringify(m):JSON.stringify(m)}},updateTemplates:function(a,g){a.templates=g;if(a._collection){var m=9>e.isIE?e.json.parse(a._json):JSON.parse(a._json);m.layerDefinition?m.layerDefinition.templates=g:m.templates=g;a._json=9>e.isIE?e.json.stringify(m):JSON.stringify(m)}},hasDefaultTypesAndTemplates:function(a){var g=a.renderer;if("esri.renderer.SimpleRenderer"==g.declaredClass||"esri.renderer.ClassBreaksRenderer"==g.declaredClass||"esri.renderer.HeatmapRenderer"==
g.declaredClass||"esri.renderer.UniqueValueRenderer"==g.declaredClass&&!g.attributeField){if(a.templates&&1===a.templates.length){var m=a.templates[0];if(""!==m.description||m.name!==esri.i18nBundle.viewer.edit.newFeature)return!1}else return!1;if(!a.typeIdField&&m.prototype&&m.prototype.attributes){m=m.prototype.attributes;var n=0;for(n=0;n<a.fields.length;n++){var b=a.fields[n];if(b.editable&&m[b.name]!==b.defaultValue&&" "!==m[b.name]&&0!==m[b.name]&&m[b.name])return!1}}else return!1}else if("esri.renderer.UniqueValueRenderer"==
g.declaredClass&&g.infos)if(a.typeIdField===g.attributeField&&a.types&&a.types.length===g.infos.length){var c,d;for(n=0;n<g.infos.length;n++){var l=g.infos[n],h=!1;for(c=0;c<a.types.length;c++)if(m=a.types[c],m.id==l.value&&(m.name==l.label||m.name==l.value))if(h=!0,m.templates&&1===m.templates.length){m=m.templates[0];if(""!=m.description||m.name!=l.label&&m.name!=l.value)return!1;m=m.prototype.attributes;for(d=0;d<a.fields.length;d++)if(b=a.fields[d],b.editable&&(b.name===g.attributeField&&m[g.attributeField]!=
l.value||b.name!==g.attributeField&&m[b.name]!==b.defaultValue&&" "!==m[b.name]&&0!==m[b.name]&&m[b.name]))return!1}else return!1;if(!h)return!1}}else return!1;else return!1;return!0},toc_enableEditing:function(a){if(a.layer){if(a.layer.url)a.serviceInfo&&a.serviceInfo.capabilities&&a.serviceInfo._origCapabilities&&(a.serviceInfo.capabilities=a.serviceInfo._origCapabilities,delete a.serviceInfo._origCapabilities,arcgisonline.map.main.reloadFeatureLayer(a));else{a.layer.setEditable(!0);var g=arcgisonline.sharing.util.getUser();
g&&a.itemCard&&a.itemCard.owner===g.username&&(a.editableChanged=!0)}a.itemCard&&-1<e.indexOf(a.itemCard.typeKeywords,"Location Tracking")&&-1<e.indexOf(a.itemCard.typeKeywords,"Collector")&&(a.isTrackingInfoLayer=!0);a.layer.getFeatureReduction&&a.layer.getFeatureReduction()&&(a.layer.setFeatureReduction(null),a.featureReductionChanged=!0)}else e.forEach(a.layers,function(m){m.setEditable(!0)}),a.editableChanged=!0;arcgisonline.map.edit.createTypesAndTemplatesOnMapLayer(a);arcgisonline.map.edit.checkOnEditButton();
arcgisonline.map.main.markMapAsChanged("enableEditing")},toc_disableEditing:function(a){if(a.layer)if(a.layer.url)a.serviceInfo&&a.serviceInfo.capabilities&&(a.serviceInfo._origCapabilities=a.serviceInfo.capabilities,a.serviceInfo.capabilities=arcgisonline.map.edit.removeEditCapabilities(a.serviceInfo.capabilities),arcgisonline.map.main.reloadFeatureLayer(a));else{a.layer.setEditable(!1);var g=arcgisonline.sharing.util.getUser();g&&a.itemCard&&a.itemCard.owner===g.username&&(a.editableChanged=!0)}else e.forEach(a.layers,
function(m){m.setEditable(!1)}),a.editableChanged=!0;arcgisonline.map.edit.removeTypesAndTemplatesOnMapLayer(a);arcgisonline.map.edit.checkOnEditButton();arcgisonline.map.main.markMapAsChanged("disableEditing")},removeEditCapabilities:function(a){a=a.split(",");a=e.filter(a,function(g){var m=g.toLowerCase();if("create"!==m&&"update"!==m&&"delete"!==m&&"editing"!==m&&"uploads"!==m)return g});return a.toString()}}})},"arcgisonline/pages/utils/data":function(){define("require exports tslib dojo/i18n!../../nls/arcgisonline dojo/_base/lang esri/graphic esri/layers/FeatureTemplate".split(" "),
function(e,K,p,a,g,m,n){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);return function(){function b(){}b.getPopupInfo=function(c){var d;return null!==(d=null===c||void 0===c?void 0:c.popupInfo)&&void 0!==d?d:this._getPopupInfo(c)};b._getPopupInfo=function(c){var d,l,h,f,r=null!==(l=null!==(d=null===c||void 0===c?void 0:c.id)&&void 0!==d?d:null===c||void 0===c?void 0:c.layerId)&&void 0!==l?l:0;d=null===(h=null===c||void 0===c?void 0:c.layerInfos)||void 0===
h?void 0:h[r];return null!==(f=null===d||void 0===d?void 0:d.popupInfo)&&void 0!==f?f:this._getDefaultPopupInfo(c)};b._getDefaultPopupInfo=function(c){var d=c.fields,l=this.getDisplayField(c);l=c.name+((null===l||void 0===l?0:l.length)?": {"+l+"}":"");var h={esriFieldTypeDouble:1,esriFieldTypeSingle:1},f={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},r={esriFieldTypeDate:1},q=",";c.editFieldsInfo&&(c.editFieldsInfo.creatorField&&(q+=c.editFieldsInfo.creatorField+","),c.editFieldsInfo.creationDateField&&
(q+=c.editFieldsInfo.creationDateField+","),c.editFieldsInfo.editorField&&(q+=c.editFieldsInfo.editorField+","),c.editFieldsInfo.editDateField&&(q+=c.editFieldsInfo.editDateField+","),q=q.toLowerCase());d=(d||[]).map(function(t){var w="esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type&&"esriFieldTypeGeometry"!==t.type;w&&c.objectIdField&&(w=t.name!==c.objectIdField);var u=t.editable&&"esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type,v;if(w){var x=q+"stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,",
z=t.name.toLowerCase();if(-1<x.indexOf(","+z+",")||-1<z.indexOf("shape")||-1<z.indexOf("perimeter")||-1<z.indexOf("objectid")||-1<z.indexOf("raster.servicepixelvalue.")||-1<z.indexOf("_i")&&z.indexOf("_i")===z.length-2||t.name===c.objectIdField)w=!1;t.type in f?v={places:0,digitSeparator:!0}:t.type in h?v={places:2,digitSeparator:!0}:t.type in r&&(10<=c.currentVersion||c&&10<=c.version)&&(v={dateFormat:"shortDateShortTime"})}u=u?-1===q.indexOf(","+t.name.toLowerCase()+","):u;t=g.default.mixin({},
{fieldName:t.name,label:t.alias,isEditable:u,tooltip:"",visible:w,stringFieldOption:"textbox"});v&&(t.format=v);return t});return{title:l,fieldInfos:d,description:null,showAttachments:!0,mediaInfos:[]}};b.getDisplayField=function(c){var d,l,h=c.fields;c=null!==(l=null===(d=c.displayField)||void 0===d?void 0:d.trim())&&void 0!==l?l:null;if(!c&&h&&(c=this.getFirstNameOrTitleField(h),!c&&(c=this.getFirstUniqueIdentifierField(h),!c&&(c=this.getFirstTypeOrCategoryField(h),!c))))for(d=0;d<h.length;d++)if(l=
h[d],-1<l.name.toLowerCase().indexOf("name")||-1<l.name.toLowerCase().indexOf("title"))c=l.name;return c};b.getFirstNameOrTitleField=function(c){for(var d=0;d<c.length;d++){var l=c[d];if(l.description){var h=l.description;if("nameOrTitle"===(null===h||void 0===h?void 0:h.fieldValueType))return l.name}}return null};b.getFirstUniqueIdentifierField=function(c){for(var d=0;d<c.length;d++){var l=c[d];if(l.description){var h=l.description;if("uniqueIdentifier"===(null===h||void 0===h?void 0:h.fieldValueType))return l.name}}return null};
b.getFirstTypeOrCategoryField=function(c){for(var d=0;d<c.length;d++){var l=c[d];if(l.description){var h=l.description;if("typeOrCategory"===(null===h||void 0===h?void 0:h.fieldValueType))return l.name}}return null};b.updateTypesAndTemplatesOnLayer=function(c){var d=this,l;if(null===(l=c.templates)||void 0===l?0:l.length){l=this._getUpdatedTemplatesForLayer(c,c.templates);c.templates=l;if(c._collection){var h=JSON.parse(c._json);h.layerDefinition?h.layerDefinition.templates=l:h.templates=l;c._json=
JSON.stringify(h)}c.__hasTemporaryTypes=!0}else c.types&&(l=c.types,c.types=[],l.forEach(function(f){f.templates=d._getUpdatedTemplatesForLayer(c,f.templates);c.addType(f)}),c.__hasTemporaryTypes=!0)};b._getUpdatedTemplatesForLayer=function(c,d){var l=[];(null!==d&&void 0!==d?d:[]).forEach(function(h){var f,r,q=new n.default;q.description=null!==(f=h.description)&&void 0!==f?f:"";q.name=h.name||a.default.viewer.edit.newFeature;var t={};(null!==(r=c.fields)&&void 0!==r?r:[]).forEach(function(w){var u=
!1,v;for(v in h.prototype.attributes)if(v===w.name){u=!0;t[w.name]=h.prototype.attributes[w.name];break}!u&&w.editable&&(t[w.name]=w.defaultValue||null,t[w.name]||!1!==w.nullable||(t[w.name]="esriFieldTypeString"===w.type?" ":0))});f=new m.default({attributes:t});q.prototype=f;l.push(q)});return l};return b}()})},"arcgisonline/pages/item/widgets/AttributesView/_attributesView":function(){define("require exports tslib ../../../_filterStateMixin ../../../pageUtil ../../../dijit/FilterSingle ../../../dijit/FilterStatus ../../../dijit/ControlBar ../../../dijit/View ../../../dijit/AttributeFieldDetails ./_attributeCard ../../../utils/arrays ../../../utils/dom ../../../utils/clone ../../../utils/icons calcite-web/js/calcite-web dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/event dojo/query dojo/topic dojo/Deferred esri/Evented dojo/i18n!../../../../nls/arcgisonline dojo/text!./templates/_attributesViewActions.html dojo/text!./templates/_attributesView.html dojo/text!./templates/tableHead.html dojo/text!./templates/tableRow.html dojo/text!./templates/empty.html dojo/text!./templates/none.html ../../../../tsutils/declareDecorator xstyle/css!./css/attributesView.css".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);return function(){function D(C,y){this.templateString=R.default;this.widgetsInTemplate=!0;this.icons=q.default;this.i18n=J.default;this._selection=[];this._searchTerm="";this._filterState={fieldType:null};this._filters={fieldType:{param:"fieldType",chipText:J.default.attributesView.fieldTypeFilterChipset,
clearText:J.default.attributesView.fieldTypeFilterClear,options:{Number:{value:"Number",label:J.default.attributesView.numberFilter},String:{value:"String",label:J.default.attributesView.stringFilter},Date:{value:"Date",label:J.default.attributesView.datesFilter},Id:{value:"Id",label:J.default.attributesView.OidFilter},Attachment:{value:"Attachment",label:J.default.attributesView.attachmentFilter},Relationship:{value:"Relationship",label:J.default.attributesView.relationshipFilter}}},fieldValueType:{param:"fieldValueType",
chipText:J.default.attributesView.fieldValueTypeFilterChipset,clearText:J.default.attributesView.fieldValueTypeFilterClear,options:{nameOrTitle:{value:"nameOrTitle",label:J.default.attributeFieldDetails.fieldValueTypesList.nameOrTitle},description:{value:"description",label:J.default.attributeFieldDetails.fieldValueTypesList.description},typeOrCategory:{value:"typeOrCategory",label:J.default.attributeFieldDetails.fieldValueTypesList.typeOrCategory},countOrAmount:{value:"countOrAmount",label:J.default.attributeFieldDetails.fieldValueTypesList.countOrAmount},
percentageOrRatio:{value:"percentageOrRatio",label:J.default.attributeFieldDetails.fieldValueTypesList.percentageOrRatio},measurement:{value:"measurement",label:J.default.attributeFieldDetails.fieldValueTypesList.measurement},uniqueIdentifier:{value:"uniqueIdentifier",label:J.default.attributeFieldDetails.fieldValueTypesList.uniqueIdentifier},phoneNumber:{value:"phoneNumber",label:J.default.attributeFieldDetails.fieldValueTypesList.phoneNumber},emailAddress:{value:"emailAddress",label:J.default.attributeFieldDetails.fieldValueTypesList.emailAddress},
orderedOrRanked:{value:"orderedOrRanked",label:J.default.attributeFieldDetails.fieldValueTypesList.orderedOrRanked},binary:{value:"binary",label:J.default.attributeFieldDetails.fieldValueTypesList.binary},locationOrPlaceName:{value:"locationOrPlaceName",label:J.default.attributeFieldDetails.fieldValueTypesList.locationOrPlaceName},coordinate:{value:"coordinate",label:J.default.attributeFieldDetails.fieldValueTypesList.coordinate},currency:{value:"currency",label:J.default.attributeFieldDetails.fieldValueTypesList.currency},
dateAndTime:{value:"dateAndTime",label:J.default.attributeFieldDetails.fieldValueTypesList.dateAndTime}}}};this._sort={property:"defaultFSOrder",label:J.default.attributesView.defaultFSOrder,ascending:!1};this._sortOptions=[{property:"defaultFSOrder",label:J.default.attributesView.defaultFSOrder,ascending:!1,active:!0},{property:"fieldAlias",label:J.default.attributesView.fieldAlias,ascending:!0},{property:"fieldName",label:J.default.attributesView.fieldName,ascending:!0},{property:"fieldType",label:J.default.attributesView.fieldType,
ascending:!0}];this._filtersExpanded=!0;this.delay=function(){var G;return function(L,O){clearTimeout(G);G=setTimeout(L,O)}}()}D.prototype.startup=function(C,y,G,L){this.inherited(arguments);this.item=C;this.layer=y;this.layerInfos=G;this.canAddField=L;this.attributesList=null;this.setAttributesList();this.reset();this.initUI();this.isAdminView()||this.domNode.classList.add("is-consumer-view");this.isHostedServiceView()&&this.domNode.classList.add("is-hosted-service-view");this.setupAttributeViewEvents()};
D.prototype.destroy=function(C){this.inherited(arguments);this.reset()};D.prototype.initUI=function(C){this._sortOptions.dontUpdateQueryParams=!0;this._initialView=this.getInitialView();C=new A.default;var y={select:!0,sortOptions:this._sortOptions,emptyView:E.default,noneView:I.default,tableHead:S.default,tableRow:T.default,mobileView:l.default,listView:l.default,activeView:this._initialView},G={search:{placeholder:this.i18n.attributesView.searchPlaceholder},sort:this._sortOptions,filterContainer:this.domNode.querySelector(".js-filter-wrap"),
viewContainer:this.domNode.querySelector(".js-view-wrap")};this.layer.supportsFieldDescription&&(G.views={activeView:this._initialView,views:["table","list"]});this.isAdminView()&&this.canAddField&&(G.actions=P.default);this._fieldTypeFilter=new m.default(this._filters.fieldType,this.domNode.querySelector(".js-filter-field-type"));this._fieldValueTypeFilter=new m.default(this._filters.fieldValueType,this.domNode.querySelector(".js-filter-field-value-type"));this._filterStatus=new n.default({dontUpdateQueryParams:!0},
this.domNode.querySelector(".js-filter-status"));this._controlBar=new b.default(G,this.domNode.querySelector(".js-control-bar"));this._view=new c.default(y,this.domNode.querySelector(".js-views"));this._totalFields.textContent=g.default.getPageRangeString({start:1,end:this.attributesList.length,total:this.attributesList.length});z.default.publish("view/update",this.attributesList,this._selection,this.hasFilters());z.default.publish("sort/update",(0,r.default)(this._sort));this.addEventListeners();
t.default.init();C.resolve();return C.promise};D.prototype.setAttributesList=function(C){for(var y=this,G,L,O,U=(0,r.default)(this.layer.fields),M=0;M<U.length;M++)U[M].alias||(U[M].alias=U[M].name),U[M].description?(U[M].description.value=(null===(G=U[M].description)||void 0===G?0:G.value)?U[M].description.value:"",U[M].description.fieldValueType=(null===(L=U[M].description)||void 0===L?0:L.fieldValueType)?U[M].description.fieldValueType:""):U[M].description={value:"",fieldValueType:""},U[M].id=
this.layer.fields[M].name,U[M].isViewOverride=this.layer.fields[M].isViewOverride,U[M].disabled="",U[M].fieldType=this.getFieldType(this.layer.fields[M].type),U[M].nullable=this.layer.fields[M].nullable?this.i18n.attributesView.commonYes:this.i18n.attributesView.commonNo,U[M].editable=this.layer.fields[M].editable?this.i18n.attributesView.commonYes:this.i18n.attributesView.commonNo;C||(this.layer.hasAttachments&&(C={id:"".concat(this.layer.name,"__Attach"),alias:this.i18n.attributesView.photosAndFiles,
name:this.i18n.attributesView.photosAndFiles,fieldType:this.i18n.attributesView.attachmentType,type:"Attachment",description:{value:"",fieldValueType:""},disabled:"disabled",canDeleteField:!1},U.push(C)),0<(null===(O=this.layer.relationships)||void 0===O?void 0:O.length)&&this.layer.relationships.forEach(function(Q){Q={id:"".concat(Q.name,"__Relationship"),alias:Q.name,name:Q.name,fieldType:y.i18n.attributesView.relationshipType,type:"Relationship",description:{value:"",fieldValueType:""},disabled:"disabled",
canDeleteField:!1};U.push(Q)}));this.attributesList=U};D.prototype.getFieldType=function(C){C=C||this.i18n.attributesView.commonUndefined;return this.i18n.attributesView.fieldTypes[C]||C};D.prototype.render=function(){var C=this.getFilteredList();this._totalFields.textContent=g.default.getPageRangeString({start:C.length?1:0,end:C.length,total:C.length});z.default.publish("view/update",C,this._selection,this.hasFilters())};D.prototype.getFilteredList=function(){var C=this;this.setAttributesList();
var y=this.attributesList;if(this._filterState.fieldType||this._filterState.fieldValueType||this._searchTerm)y=this.attributesList.filter(function(G){if(-1!==G.alias.toLowerCase().indexOf(C._searchTerm.toLowerCase())||-1!==G.name.toLowerCase().indexOf(C._searchTerm.toLowerCase()))return C._filterState.fieldType&&C._filterState.fieldValueType?C.filterResults(G,C._filterState)&&C.filterFieldValueTypeResults(G,C._filterState):C._filterState.fieldType?C.filterResults(G,C._filterState):C._filterState.fieldValueType?
C.filterFieldValueTypeResults(G,C._filterState):!0});"fieldAlias"===this._sort.property?y=this.sortFieldAlias(y,this._sort.ascending):"fieldName"===this._sort.property?y=this.sortFieldName(y,this._sort.ascending):"fieldType"===this._sort.property?y=this.sortFieldType(y,this._sort.ascending):"editable"===this._sort.property&&(y=this.sortEditable(y,this._sort.ascending));return y};D.prototype.filterResults=function(C,y){var G=["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"],
L=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeBigInteger"];return"Id"!==y.fieldType||"esriFieldTypeOID"!==C.type&&"esriFieldTypeGlobalID"!==C.type?"Number"===y.fieldType&&L.includes(C.type)?!0:"String"===y.fieldType&&"esriFieldTypeString"===C.type?!0:"Date"===y.fieldType&&G.includes(C.type)?!0:"Attachment"===y.fieldType&&"Attachment"===C.type?!0:"Relationship"===y.fieldType&&"Relationship"===C.type?!0:!1:!0};D.prototype.filterFieldValueTypeResults=
function(C,y){return y.fieldValueType===C.description.fieldValueType};D.prototype.reset=function(){this._filterState.fieldType=null;this._selection=[];this._searchTerm="";this._sort={property:"defaultFSOrder",label:J.default.attributesView.defaultFSOrder,ascending:!1}};D.prototype.getInitialView=function(){return this.layer.supportsFieldDescription?this.item.isAdmin&&this.item.isOwner?"table":"list":"table"};D.prototype.isAdminView=function(){var C,y=!1!==(null===(C=this.item.serviceInfo)||void 0===
C?void 0:C.sourceSchemaChangesAllowed);return this.item.isHostedService&&!this.item.isLocationTrackingService&&(this.item.isAdmin||this.item.isOwner||this.item.canUpdate)&&y};D.prototype.isHostedServiceView=function(){return this.item.isHostedService&&h.default.includes(this.item.typeKeywords,"View Service")};D.prototype.sortFieldAlias=function(C,y){return C.sort(function(G,L){return y?G.alias.localeCompare(L.alias):L.alias.localeCompare(G.alias)})};D.prototype.sortFieldName=function(C,y){return C.sort(function(G,
L){return y?G.name.localeCompare(L.name):L.name.localeCompare(G.name)})};D.prototype.sortFieldType=function(C,y){return C.sort(function(G,L){return y?G.fieldType.localeCompare(L.fieldType)||G.name.localeCompare(L.name):L.fieldType.localeCompare(G.fieldType)||L.name.localeCompare(G.name)})};D.prototype.sortNullable=function(C,y){return C.sort(function(G,L){return y?G.nullable.localeCompare(L.nullable):L.nullable.localeCompare(G.nullable)})};D.prototype.sortEditable=function(C,y){return C.sort(function(G,
L){return y?G.editable.localeCompare(L.editable):L.editable.localeCompare(G.editable)})};D.prototype.updateSelectedView=function(){var C;0<this._selection.length?((0,x.default)(".hide-if-selected").addClass("hide"),(0,x.default)(".show-if-selected").removeClass("hide"),null===(C=this.filterSelectedViewActions)||void 0===C?void 0:C.call(this,this._selection)):((0,x.default)(".hide-if-selected").removeClass("hide"),(0,x.default)(".show-if-selected").addClass("hide"));this.selectedCount.innerHTML="".concat(this._selection.length)};
D.prototype.filterSelectedViewActions=function(C){var y=[],G=[];C=h.default.find(C,function(L){return!L.canDeleteField});this.isAdminView()&&!C?G.push(this._deleteFields):y.push(this._deleteFields);f.default.hideNodes(y);f.default.showNodes(G)};D.prototype.hasFilters=function(){var C=this,y=0<Object.keys(this._filterState).filter(function(G){return C._filterState[G]}).length;return""!==this._searchTerm||y};D.prototype.addEventListeners=function(){var C=this;this.own((0,x.default)(".js-deselect",this.domNode).on("click",
this.deselectAll.bind(this)),z.default.subscribe("view/update",this.setupAttributeViewEvents.bind(this)),z.default.subscribe("filter/update",this.filterUpdate.bind(this)),z.default.subscribe("filter/clear",this.filterClear.bind(this)),z.default.subscribe("filter/remove",this.filterRemove.bind(this)),z.default.subscribe("sort/update",this.sortUpdate.bind(this)),z.default.subscribe("view/select",this.viewSelect.bind(this)),z.default.subscribe("view/deselect",this.viewDeselect.bind(this)),z.default.subscribe("search/update",
this.searchUpdate.bind(this)),z.default.subscribe("view/toggle",this.toggleUpdateIfNeeded.bind(this)),z.default.subscribe("attributeCard/fieldName",this.setupAttributeFieldDetails.bind(this)),(0,x.default)(".js-delete-multiple-fields",this.domNode).on("click",function(y){v.default.stop(y);2>C._view._selected.length&&C._view._selected[0].canDeleteField?z.default.publish("attributesView/deleteSingleField",C._view._selected[0]):z.default.publish("attributesView/deleteMultipleFields",C._view._selected)}),
z.default.subscribe("attributeFieldDetails/updateFieldOnlyTable",this.setTableRowsFieldNameOnly.bind(this)),(0,x.default)(".js-field-only-search").on("calciteInputInput",function(y){C.searchFieldResult=y.target.value;C.delay(function(){C.setTableRowsFieldNameOnly()},500)}))};D.prototype.setupAttributeViewEvents=function(){var C=this;this._attributeViewEvents=[];this._attributeFieldsEvents=[(0,x.default)(".js-field-name",this.domNode).on("click",function(y){v.default.stop(y);C.clickedFieldName=y.target.getAttribute("fieldName");
C.setupAttributeFieldDetails()})]};D.prototype.setupAttributeFieldDetails=function(C){C&&(this.clickedFieldName=C);this.setTableRowsFieldNameOnly();this.hideDetailsPage(!1);this.attributeFieldDetails&&(this.attributeFieldDetails.destroy(!0),this.attributeFieldDetails=null);C=new d.default({tab:this.tab},this.domNode.querySelector(".js-attributes-details"));C.startup(this.item,this.layer,this.clickedFieldName,this.layerInfos);this.attributeFieldDetails=C;this.setUpAttributeFieldDetailsEvents()};D.prototype.setUpAttributeFieldDetailsEvents=
function(){this.attributeFieldDetails.own(z.default.subscribe("attributeFieldDetails/closeDetails",this.closeFieldDetails.bind(this)))};D.prototype.closeFieldDetails=function(C){this.hideDetailsPage(!0);this.searchFieldResult="";this.domNode.querySelector(".js-field-only-search").value="";C&&(this.setAttributesList(),this.render())};D.prototype.setTableRowsFieldNameOnly=function(){for(var C=this,y=this.domNode.querySelector(".js-attributes-details-body");0<y.rows.length;)y.deleteRow(0);this.setAttributesList(!0);
var G="fieldAlias"===this._sort.property?this.sortFieldAlias(this.attributesList,this._sort.ascending):"fieldName"===this._sort.property?this.sortFieldName(this.attributesList,this._sort.ascending):"fieldType"===this._sort.property?this.sortFieldType(this.attributesList,this._sort.ascending):this.attributesList;this.searchFieldResult&&(G=G.filter(function(L){return-1!==L.alias.toLowerCase().indexOf(C.searchFieldResult.toLowerCase())}));0<(null===G||void 0===G?void 0:G.length)&&G.reduce(function(L,
O){L=y.insertRow(y.rows.length);L.insertCell(0).innerHTML='\x3cbutton class\x3d"btn btn-transparent btn-small js-field-details-name btn-field-details-name table-select-cell-wrap btn-link-dark-blue" fieldName\x3d"'.concat(O.name,'"\x3e').concat(O.alias,"\x3c/button\x3e");O.name===C.clickedFieldName&&(L.style.backgroundColor="#d2e9f9")},"");this.own((0,x.default)(".js-field-details-name",this.domNode).on("click",function(L){v.default.stop(L);C.clickedFieldName=L.target.getAttribute("fieldName");C.setupAttributeFieldDetails()}))};
D.prototype.collapseDetails=function(){var C=this;this._detailsFiltersExpanded?(this._collapseDetailsBtn.setAttribute("aria-checked","true"),this._collapseDetailsBtn.tabIndex=0,(0,x.default)(".js-attribute-field-only").removeClass("collapsed"),(0,x.default)(".js-attribute-field-details").removeClass("expanded"),this._detailsFiltersExpanded=!1):(this._collapseDetailsBtn.setAttribute("aria-checked","false"),this._collapseDetailsBtn.tabIndex=-1,(0,x.default)(".js-attribute-field-only").addClass("collapsed"),
(0,x.default)(".js-attribute-field-details").addClass("expanded"),this._detailsFiltersExpanded=!0);setTimeout(function(){C._collapseDetailsBtn.blur()},100)};D.prototype.disableScrollOnBody=function(){document.querySelector("body").classList.add("field--no-scroll-on-body")};D.prototype.enableScrollOnBody=function(){document.querySelector("body").classList.remove("field--no-scroll-on-body")};D.prototype.refreshContent=function(){this._selection=[];this.updateSelectedView();this.render()};D.prototype.filterUpdate=
function(C){"fieldType"===C.param?this._filterState.fieldType=C.selected[0].value:"fieldValueType"===C.param?this._filterState.fieldValueType=C.selected[0].value:this._filterState[C.param]=C.selected;this.render()};D.prototype.filterClear=function(){this._filterState.fieldType=null;this._filterState.fieldValueType=null;this.render()};D.prototype.filterRemove=function(C){"fieldType"===C.param&&(this._filterState.fieldType=null);"fieldValueType"===C.param&&(this._filterState.fieldValueType=null);this.render()};
D.prototype.viewSelect=function(C){h.default.find(this._selection,function(y){return y.name===C.name})||(C.isSelected=!0,this._selection.push(C));this.updateSelectedView()};D.prototype.viewDeselect=function(C){C.isSelected=!1;this._selection=this._selection.filter(function(y){return y.name!==C.name});this.updateSelectedView()};D.prototype.deselectAll=function(){this._selection=[];z.default.publish("view/deselectAll");this.updateSelectedView()};D.prototype.searchWait=function(C){z.default.publish("view/loading",
C)};D.prototype.searchUpdate=function(C){this._searchTerm=C;this.render()};D.prototype.sortUpdate=function(C){this._sort.property=C.property;this._sort.ascending=C.ascending;this.render()};D.prototype.toggleUpdateIfNeeded=function(C){this.hideDetailsPage(!0);this.setAttributesList();this.render()};D.prototype.hideDetailsPage=function(C){C?((0,x.default)(".js-attributes-details-info").addClass("hide"),(0,x.default)(".js-field-main-body").removeClass("hide"),(0,x.default)(".js-field-search-bar").removeClass("hide")):
((0,x.default)(".js-attributes-details-info").removeClass("hide"),(0,x.default)(".js-field-main-body").addClass("hide"),(0,x.default)(".js-field-search-bar").addClass("hide"))};return D=p.__decorate([(0,F.default)(w.default,u.default,B.default,a.default)],D)}()})},"arcgisonline/pages/_filterStateMixin":function(){define("require exports tslib ./pageUtil ./utils/arrays ./utils/clone".split(" "),function(e,K,p,a,g,m){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);return function(){function n(){this._initialLoading=
!0;this._initialStart=1;this._initialNum=20;this._initialMembershipRequestToggle=!1}n.prototype._applyQueryParameters=function(){var b=a.default.getQueryParams();this._applySortParameters(b);this._applyViewParameter(b);this._applyPaginationParameter(b);this._applyTypeParameter(b);this._applyMembershipRequestParameter(b);this._applyDateParameter(b);this._applyDateUploadedParameter(b);this._applyDateCreatedParameter(b);this._applyFolderParameter(b);this._applySharingParameter(b);this._applyStatusParameter(b);
this._applyRoleParameter(b);this._applyUserTypeParameter(b);this._applyOwnerParameter(b);this._applySpecialGroupsParameter(b);this._applyCategoriesParameter(b);this._applyLevelParameter(b);this._applyLastLoginParameter(b);this._applySearchInputParameter(b);this._applySearchByParameter(b);this._applyTagsParameter(b);this._applyBBoxParameter(b);this._applyCollaborationParameter(b);this._applyGroupsParameter(b);this._applyAppParameter(b);this._applyCreditsParameter(b)};n.prototype._applyFilters=function(){this._applyPagination();
this._applyItemTypeFilter();this._applySpecialGroupsFilter();this._applyDateFilter();this._applyDateUploadedFilter();this._applyDateCreatedFilter();this._applyFolderFilter();this._applyMembershipRequestFilter();this._applySharingFilter();this._applyStatusFilter();this._applyRoleFilter();this._applyUserTypeFilter();this._applyGroupFilter();this._applyAppFilter();this._applyCreditsFilter();this._applyLastLoginFilter();this._applyOwnerFilter();this._applyCategoryFilter();this._applyLevelFilter();this._applySearchInput();
this._applySearchByDropdown();this._applyTagsFilter();this._applyBBoxFilter();this._applyCollaborationFilter()};n.prototype._applySortParameters=function(b){if(b.sortField){var c=b.sortField;if(c&&this._sortOptions&&this._sortOptions.length){var d=g.default.find(this._sortOptions,function(l){return l.property===c});d&&(this._sort=(0,m.default)(d))}}b.sortOrder&&this._sort&&(this._sort.ascending="asc"===b.sortOrder)};n.prototype._applyViewParameter=function(b){b.view&&(this._initialView=b.view)};n.prototype._applyPaginationParameter=
function(b){if(b.num){var c=parseInt(b.num,10);-1<[20,60,100].indexOf(c)&&(this._initialNum=c,this._page&&this._page.num&&(this._page.num=this._initialNum))}b.start&&this._page&&(this._initialStart=parseInt(b.start,10)||1,0<this._initialStart%this._page.num&&(this._initialStart=Math.floor(this._initialStart/this._page.num)*this._page.num+1,this._page&&this._page.start&&(this._page.start=this._initialStart)))};n.prototype._applyTypeParameter=function(b){b.focus&&(this._initialTypeFilter="layers-weblayers"===
b.focus?"layers":b.focus)};n.prototype._applyDateParameter=function(b){b.modified&&(this._initialDateFilter=b.modified,this._initialDateFilterTo=b.modified_to?b.modified_to:void 0,this._initialDateFilterFrom=b.modified_from?b.modified_from:void 0)};n.prototype._applyDateCreatedParameter=function(b){b.created&&(this._initialDateCreatedFilter=b.created,this._initialDateCreatedFilterTo=b.created_to?b.created_to:void 0,this._initialDateCreatedFilterFrom=b.created_from?b.created_from:void 0)};n.prototype._applyDateUploadedParameter=
function(b){b.uploaded&&(this._initialDateUploadedFilter=b.uploaded,this._initialDateUploadedFilterTo=b.uploaded_to?b.uploaded_to:void 0,this._initialDateUploadedFilterFrom=b.uploaded_from?b.uploaded_from:void 0)};n.prototype._applyFolderParameter=function(b){b.folder&&(this._initialFolderFilter=b.folder)};n.prototype._applyMembershipRequestParameter=function(b){b._membershipRequestToggle&&(this._initialMembershipRequestToggle="true"===b._membershipRequestToggle)};n.prototype._applySharingParameter=
function(b){b.access&&(this._initialSharingFilter=b.access)};n.prototype._applyStatusParameter=function(b){b.contentstatus&&(this._initialStatusFilter=b.contentstatus)};n.prototype._applyRoleParameter=function(b){b.memberType?this._initialRoleFilter=b.memberType:b.role&&(this._initialRoleFilter=b.role)};n.prototype._applyUserTypeParameter=function(b){b.userLicenseType&&(this._initialUserTypeFilter=b.userLicenseType)};n.prototype._applyGroupsParameter=function(b){b.group&&(this._initialGroupFilter=
b.group)};n.prototype._applyAppParameter=function(b){b.app&&(this._initialAppFilter=b.app)};n.prototype._applyCreditsParameter=function(b){b.availablecredits&&(this._initialCreditsFilter=b.availablecredits)};n.prototype._applyOwnerParameter=function(b){b.owner&&(this._initialOwnerFilter=b.owner)};n.prototype._applySpecialGroupsParameter=function(b){b.specialGroups&&(this._initialSpecialGroupsFilter=b.specialGroups)};n.prototype._applyCategoriesParameter=function(b){if(b.categories)try{this._initialCategoryFilter=
JSON.parse(b.categories)}catch(c){}if(b.regions){this._initialCategoryFilter=this._initialCategoryFilter||[];try{this._initialCategoryFilter=this._initialCategoryFilter.concat(JSON.parse(b.regions))}catch(c){}}};n.prototype._applySearchByParameter=function(b){b.searchBy&&(this._initialSearchBy=b.searchBy)};n.prototype._applySearchInputParameter=function(b){b.searchTerm&&(this._initialSearchInput=b.searchTerm)};n.prototype._applyTagsParameter=function(b){b.tags&&(this._initialTagsFilter=b.tags.split(","))};
n.prototype._applyBBoxParameter=function(b){if(b.bbox){b.sortField="bbox";var c=b.bbox.split(",");4===c.length&&(this._initialBBoxFilter=[[c[0],c[1]],[c[2],c[3]]],this._initialBBoxLabel=b.bboxLabel)}};n.prototype._applyCollaborationParameter=function(b){b.origin&&(this._initialCollaborationFilter=b.origin)};n.prototype._applyLevelParameter=function(b){b.level&&(this._initialLevelFilter=b.level)};n.prototype._applyLastLoginParameter=function(b){b.lastlogin&&(this._initialDateFilter=b.lastlogin,this._initialDateFilterTo=
b.lastlogin_to?b.lastlogin_to:void 0,this._initialDateFilterFrom=b.lastlogin_from?b.lastlogin_from:void 0)};n.prototype._applyPagination=function(){this._pagination&&this._pagination.setInitialProperties({num:this._initialNum,start:this._initialStart});this._page&&(this._page.num=this._initialNum,this._page.start=this._initialStart)};n.prototype._applyItemTypeFilter=function(){this._initialTypeFilter&&this._typeFilter&&this._typeFilter.select&&this._typeFilter.select(this._initialTypeFilter)};n.prototype._applyDateFilter=
function(){this._initialDateFilter&&this._dateFilter&&this._dateFilter.select&&this._dateFilter.select(this._initialDateFilter,this._initialDateFilterFrom,this._initialDateFilterTo)};n.prototype._applyDateCreatedFilter=function(){this._initialDateCreatedFilter&&this._dateFilter&&this._dateFilter.select&&this._dateFilter.select(this._initialDateCreatedFilter,this._initialDateCreatedFilterFrom,this._initialDateCreatedFilterTo)};n.prototype._applyFolderFilter=function(){this._initialFolderFilter&&this._folderList&&
(this._folderList.setInitialFolder(this._initialFolderFilter),this._folderListMobile.setInitialFolder(this._initialFolderFilter))};n.prototype._applyMembershipRequestFilter=function(){var b;this._initialMembershipRequestToggle&&(null===(b=this._membershipRequestToggle)||void 0===b?0:b.isChecked)&&this._membershipRequestToggle.setChecked(this._initialMembershipRequestToggle)};n.prototype._applyDateUploadedFilter=function(){this._initialDateUploadedFilter&&this._dateCreatedFilter&&this._dateCreatedFilter.select&&
this._dateCreatedFilter.select(this._initialDateUploadedFilter,this._initialDateUploadedFilterFrom,this._initialDateUploadedFilterTo)};n.prototype._applySharingFilter=function(){this._initialSharingFilter&&this._sharingFilter&&this._sharingFilter.select&&this._sharingFilter.select(this._initialSharingFilter)};n.prototype._applyStatusFilter=function(){this._initialStatusFilter&&this._statusFilter&&this._statusFilter.select&&this._statusFilter.select(this._initialStatusFilter)};n.prototype._applyRoleFilter=
function(){this._initialRoleFilter&&this._roleFilter&&this._roleFilter.select&&this._roleFilter.select(this._initialRoleFilter)};n.prototype._applyUserTypeFilter=function(){this._initialUserTypeFilter&&this._userTypeFilter&&this._userTypeFilter.select&&this._userTypeFilter.select(this._initialUserTypeFilter)};n.prototype._applyGroupFilter=function(){this._initialGroupFilter&&this._groupFilter&&this._groupFilter.select&&this._groupFilter.select(this._initialGroupFilter)};n.prototype._applyAppFilter=
function(){this._initialAppFilter&&this._appFilter&&this._appFilter.select&&this._appFilter.select(this._initialAppFilter)};n.prototype._applyCreditsFilter=function(){this._initialCreditsFilter&&this._creditsFilter&&this._creditsFilter.select&&this._creditsFilter.select(this._initialCreditsFilter)};n.prototype._applyLastLoginFilter=function(){this._initialDateFilter&&this._lastLoginFilter&&this._lastLoginFilter.select&&this._lastLoginFilter.select(this._initialDateFilter,this._initialDateFilterFrom,
this._initialDateFilterTo)};n.prototype._applySpecialGroupsFilter=function(){var b;this._initialSpecialGroupsFilter&&(null===(b=this._specialGroupsFilter)||void 0===b?0:b.select)&&this._specialGroupsFilter.select(this._initialSpecialGroupsFilter)};n.prototype._applyOwnerFilter=function(){this._initialOwnerFilter&&this._ownerFilter&&this._ownerFilter.select&&this._ownerFilter.select(this._initialOwnerFilter)};n.prototype._applyCategoryFilter=function(){this._initialCategoryFilter&&this._categoryFilter&&
this._categoryFilter.select&&this._categoryFilter.select(this._initialCategoryFilter,this._initialLoading)};n.prototype._applyLevelFilter=function(){this._initialLevelFilter&&this._levelFilter&&this._levelFilter.select&&this._levelFilter.select(this._initialLevelFilter)};n.prototype._applySearchInput=function(){var b,c=this._searchInput||(null===(b=this._controlBar)||void 0===b?void 0:b._searchInput);this._initialSearchInput&&(null===c||void 0===c?0:c.setValue)&&c.setValue(this._initialSearchInput)};
n.prototype._applySearchByDropdown=function(){var b=this._searchByDropdown||this._controlBar&&this._controlBar._searchDropdown;this._initialSearchBy&&b&&b.setSelection&&b.setSelection(this._initialSearchBy)};n.prototype._applyTagsFilter=function(){this._initialTagsFilter&&this._tagsFilter&&this._tagsFilter.select&&this._tagsFilter.select(this._initialTagsFilter)};n.prototype._applyBBoxFilter=function(){this._initialBBoxFilter&&this._bBoxFilter&&this._bBoxFilter.addExtentFilter&&this._bBoxFilter.addExtentFilter(this._initialBBoxFilter,
this._initialBBoxLabel)};n.prototype._applyCollaborationFilter=function(){this._initialCollaborationFilter&&this._collaborationFilter&&this._collaborationFilter.select&&this._collaborationFilter.select(this._initialCollaborationFilter)};return n}()})},"arcgisonline/pages/dijit/FilterSingle":function(){define("require exports tslib ../utils/arrays ../../tsutils/declareDecorator dijit/_WidgetBase dojo/_base/event dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/query dojo/string dojo/topic esri/Evented dojo/i18n!../../nls/arcgisonline dojo/text!./FilterSingle/templates/FilterSingle.html dojo/text!./FilterSingle/templates/FilterOption.html dojo/text!./FilterSingle/templates/ClearAll.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);return function(){function v(x,z){this.summedAggregationProperties={}}v.prototype.postMixInProperties=function(){var x;
this.inherited(arguments);this._state=b.default.clone(this.params);this.topicPrefix=null!==(x=this._state.topic||this._state.topicPrefix)&&void 0!==x?x:""};v.prototype.postCreate=function(){this._updateUI();this._attachEvents()};v.prototype.destroy=function(){this._clear();this.inherited(arguments)};v.prototype._attachEvents=function(){var x=(0,l.default)(".js-filter-link",this.domNode),z=(0,l.default)(".js-clear-filter[data-filter-param\x3d'".concat(this._state.param,"']"));this.own(z.on("click",
this._removeFilter.bind(this)),x.on("click",this._clickHandler.bind(this)),f.default.subscribe("".concat(this.topicPrefix,"filter/clear"),this._clear.bind(this)),f.default.subscribe("".concat(this.topicPrefix,"filter/remove"),this._remove.bind(this)),f.default.subscribe("".concat(this.topicPrefix,"aggregations/update"),this._updateCounts.bind(this)))};v.prototype.select=function(x){this._state.options[x]&&(this._clear(),this._state.options[x].active=!0,this.domNode.querySelectorAll('.js-filter-item[data-value\x3d"'.concat(x,
'"]')).forEach(function(z){var A;z.classList.add("is-active");z.setAttribute("aria-current","true");null===(A=z.querySelector(".js-filter-link"))||void 0===A?void 0:A.setAttribute("aria-selected","true")}),this._setSelected(),f.default.publish("".concat(this.topicPrefix,"filter/update"),this._state))};v.prototype.getState=function(){return this._state};v.prototype._clear=function(){var x,z;this.domNode&&(a.default.toArray(this._state.options).forEach(function(A){return A.active=!1}),this.domNode.querySelectorAll(".js-filter-item").forEach(function(A){A.classList.remove("is-active");
A.removeAttribute("aria-current")}),this.domNode.querySelectorAll(".js-filter-link").forEach(function(A){A.setAttribute("aria-selected","false")}),null===(z=null===(x=this.domNode.closest("calcite-accordion-item"))||void 0===x?void 0:x.querySelector(".js-clear-filter[data-filter-param\x3d'".concat(this._state.param,"']")))||void 0===z?void 0:z.classList.add("hide"))};v.prototype._remove=function(x){if(x.param===this._state.param){var z=this._state.options[x.value];z&&(z.active=!1);this._setSelected();
this.domNode.querySelectorAll(".js-filter-item[data-value\x3d'".concat(x.value,"']")).forEach(function(A){A.classList.remove("is-active");A.removeAttribute("aria-current");A.querySelector(".js-filter-link").setAttribute("aria-selected","false")})}};v.prototype._updateUI=function(){var x,z,A=a.default.toArray(this._state.options).reduce(this._renderList.bind(this),"");this.domNode.innerHTML=h.default.substitute(t.default,{list:A});if(A=null===(x=this.domNode.closest("calcite-accordion-item"))||void 0===
x?void 0:x.querySelector(".js-filter-actions-end"))x=0<(null===(z=this._state.selected)||void 0===z?void 0:z.length)?"":"hide",d.default.place(h.default.substitute(u.default,{i18n:q.default,hide:x,param:this._state.param,clearText:this._state.clearText}),A)};v.prototype._renderList=function(x,z,A,B){z.label=z.label.replace(/"/g,"\x26quot;");A=z.active?"is-active":"";B=this.param;A=p.__assign(p.__assign({},b.default.clone(z)),{param:B,selected:A});A=h.default.substitute(w.default,A);z.aggregationFields&&
(this.summedAggregationProperties[z.value]=z.aggregationFields);return x+A};v.prototype._setSelected=function(){var x=[];a.default.toArray(this._state.options).forEach(function(A){A.active&&x.push(A)});this._state.selected=0<x.length?x:!1;var z=(0,l.default)(".js-clear-filter[data-filter-param\x3d'".concat(this._state.param,"']"));this._state.selected?z.removeClass("hide"):z.addClass("hide")};v.prototype._clickHandler=function(x){n.default.stop(x);var z=x.target.parentNode,A=c.default.contains(z,
"is-active"),B=x.target.getAttribute("data-value");A?f.default.publish("".concat(this.topicPrefix,"filter/remove"),{param:this._state.param,value:x.target.getAttribute("data-value")}):(a.default.toArray(this._state.options).forEach(function(J){return J.active=J.value===B}),this.domNode.querySelectorAll(".js-filter-item").forEach(function(J){J.classList.remove("is-active");J.removeAttribute("aria-current")}),c.default.add(z,"is-active"),z.setAttribute("aria-current",!0),this.domNode.querySelectorAll(".js-filter-link").forEach(function(J){J.setAttribute("aria-selected",
x.target===J?"true":"false")}),this._setSelected(),f.default.publish("".concat(this.topicPrefix,"filter/update"),this._state))};v.prototype._removeFilter=function(x){var z;x.stopPropagation();0<(null===(z=this._state.selected)||void 0===z?void 0:z.length)&&f.default.publish("".concat(this.topicPrefix,"filter/remove"),{param:this._state.param,value:this._state.selected[0].value})};v.prototype._getCountForFieldValue=function(x,z){x=a.default.find(x,function(A){return A.value===z});return(null===x||
void 0===x?void 0:x.count)||0};v.prototype._updateCounts=function(x){var z=this;if(x.fieldName===this.param){var A=(0,l.default)(".js-filter-link-count",this.domNode);A.innerHTML("");A.removeClass("hide");x.fieldValues.forEach(function(B){var J=z.domNode.querySelector(".js-filter-link-count[data-value\x3d'".concat(B.value,"']"));J&&(J.innerHTML="(".concat(B.count,")"))});Object.keys(this.summedAggregationProperties).forEach(function(B){var J=z.summedAggregationProperties[B].reduce(function(P,R){return P+
z._getCountForFieldValue(x.fieldValues,R)},0);(B=z.domNode.querySelector(".js-filter-link-count[data-value\x3d'".concat(B,"']")))&&J&&(B.innerHTML="(".concat(J,")"))})}};return v=p.__decorate([(0,g.default)(m.default,r.default)],v)}()})},"arcgisonline/pages/dijit/FilterStatus":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/query dojo/topic dojo/string dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./FilterStatus/templates/FilterStatus.html dojo/text!./FilterStatus/templates/FilterChip.html dojo/i18n!../../nls/arcgisonline ../pageUtil ../utils/icons ../utils/arrays".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);return function(){function x(z,A){this.templateString=r.default;this.i18n=t.default;this._state=
{}}x.prototype.postMixInProperties=function(){var z=this,A;this.inherited(arguments);this._state={};this._dontUpdateQueryParams=this.params.dontUpdateQueryParams;this._topic=null!==(A=this.params.topic)&&void 0!==A?A:"";v.default.toArray(g.default.clone(this.params)).forEach(function(B){var J;0<(null===(J=B.selected)||void 0===J?void 0:J.length)&&(z._state[B.param]=B)})};x.prototype.postCreate=function(){this.inherited(arguments);v.default.toArray(this._state).forEach(g.default.hitch(this,this._update));
this._addEventListeners()};x.prototype.destroy=function(){this.inherited(arguments);this._state={}};x.prototype._addEventListeners=function(){this.own((0,b.default)(this.clearAll,"click",g.default.hitch(this,this._clearHandler)),(0,b.default)(this.filterChips,"click",g.default.hitch(this,this._clickHandler)),d.default.subscribe("".concat(this._topic,"filter/remove"),g.default.hitch(this,this._remove)),d.default.subscribe("".concat(this._topic,"filter/update"),g.default.hitch(this,this._update)),d.default.subscribe("".concat(this._topic,
"filter/clear"),g.default.hitch(this,this._clear)))};x.prototype._clear=function(){this.filterChips.innerHTML="";m.default.add(this.filterChipWrap,"hide");var z=[];v.default.toArray(this._state).forEach(function(A){z.push(A.param)});this._state={};this._topic||w.default.removeQueryParams(z);this._updateMoreChip()};x.prototype._clearHandler=function(z){d.default.publish("".concat(this._topic,"filter/clear"),z)};x.prototype._remove=function(z){var A=this;(0,c.default)(".js-filter-chip[data-filter\x3d'"+
z.param+"']",this.filterChips).forEach(n.default.destroy);if(z.partial){var B=this._state[z.param];B.selected=B.selected.filter(function(J){return J.value!==z.value}).filter(function(J,P,R){return R.indexOf(J)===P});1>B.selected.length?delete this._state[z.param]:B.selected.forEach(function(J){J=l.default.substitute(q.default,{filter:B,i18n:t.default,selected:J,icons:u.default});n.default.place(J,A.filterChips)})}else delete this._state[z.param];1>Object.keys(this._state).length&&m.default.add(this.filterChipWrap,
"hide");this._dontUpdateQueryParams||this._removeQueryString(z);this._updateMoreChip()};x.prototype._updateMoreChip=function(){var z=this,A=-1;Object.keys(this._state).forEach(function(J){z._state[J].selected&&(A+=z._state[J].selected.length)});var B=this.filterChips.querySelector(".js-more-chip");B&&this.filterChips.removeChild(B);0<A&&(B=document.createElement("span"),B.className="filter-chip filter-chip__more js-more-chip",this.filterChips.appendChild(B),B.textContent="+ ".concat(A))};x.prototype._update=
function(z){var A=this;m.default.remove(this.filterChipWrap,"hide");this._state[z.param]=z;(0,c.default)(".js-filter-chip[data-filter\x3d'"+z.param+"']",this.filterChips).forEach(n.default.destroy);z.selected&&(z.selected.forEach(function(B){var J=document.createElement("div");!B.label&&B.simpleLabel&&(B.label=B.simpleLabel);J.innerHTML=B.label;B.simpleLabel=J.textContent||J.innerText||"";B=l.default.substitute(q.default,{filter:z,i18n:t.default,selected:B,icons:u.default});n.default.place(B,A.filterChips)}),
0===z.selected.length&&(delete this._state[z.param],this._topic||w.default.removeQueryParams([z.param])));this._updateMoreChip();1>Object.keys(this._state).length&&m.default.add(this.filterChipWrap,"hide");this._dontUpdateQueryParams||this._topic||this._updateQueryString()};x.prototype._updateQueryString=function(){var z={};v.default.toArray(this._state).forEach(function(A){z[A.param]=A.selected&&A.selected.map(function(B){"custom"===B.value&&B.to&&B.from?(z[A.param+"_to"]=B.to.valueOf(),z[A.param+
"_from"]=B.from.valueOf()):(delete z[A.param+"_to"],delete z[A.param+"_from"]);if(A.isCategory)return JSON.stringify([B.value]);"bbox"===A.param&&(z.bboxLabel=B.label,z.srSort="true");return B.value}).join(",")||""},this);"bbox"in z&&(z.sortField="bbox");this._topic||w.default.updateQueryParams(z)};x.prototype._removeQueryString=function(z){var A=w.default.getQueryParams(),B=[];z.isCategory||"categories"===z.param?A[z.param]=[]:"bbox"===z.param?(A[z.param]=[],B.push("srSort","bboxLabel","sortField")):
(A[z.param]&&(A[z.param]=A[z.param].split(",").filter(function(J){return J!==z.value}).join(",")),w.default.updateQueryParams(A));A=A[z.param];1>(null===A||void 0===A?void 0:A.length)&&(B.push(z.param),"custom"===z.value&&(B.push(z.param+"_to"),B.push(z.param+"_from")));w.default.removeQueryParams(B)};x.prototype._clickHandler=function(z){if(m.default.contains(z.target,"js-filter-chip-remove")){z.preventDefault();var A=z.target.getAttribute("data-filter"),B=z.target.getAttribute("data-value");d.default.publish("".concat(this._topic,
"filter/remove"),{param:A,value:B,partial:1<this._state[A].selected.length,lastFilter:1===Object.keys(this._state).length,evt:z})}};return x=p.__decorate([(0,a.default)(h.default,f.default)],x)}()})},"arcgisonline/pages/dijit/ControlBar":function(){define("require exports tslib calcite-web/js/calcite-web dojo/debounce dojo/dom-construct dojo/string dojo/topic dojo/on dojo/query dijit/_TemplatedMixin dijit/_WidgetBase ./SearchInput ../components/ViewToggle ../components/SortDropdown ../components/Refresh ../organization/widgets/SearchDropdown ../pageUtil ../utils/icons ../utils/productGlyphs ../utils/dom dojo/text!./ControlBar/templates/ControlBar.html dojo/text!./ControlBar/templates/Filters.html dojo/i18n!../../nls/arcgisonline arcgisonline/tsutils/declareDecorator preact preact/compat".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);return function(){function T(E,I){var F=this;this.templateString=A.default;this.i18n=J.default;this.icons=v.default;this.productGlyphs=x.default;this.showOnResize=!0;this.mobileBreakPoint=860;this.screenWidth=1080;this.telemetryOptions=this.telemetry=void 0;this.collapsed=!1;this.hideMobileActions=!0;this.refresh=!1;this.refreshLabel="";this.dontUpdateQueryParams=!1;this.toggleFilterText=function(D){var C=F.domNode.querySelector(".js-toggle-filters-label");
z.default.showHide(C,1080<=D)}}T.prototype.postMixInProperties=function(){this.inherited(arguments);this.showFilters=this.showFilters.bind(this);this.hideFilters=this.hideFilters.bind(this);this.searchActionClass=this.actions?"control-bar__search--has-actions":"";this.filterActiveClass=this.collapsed?"":"is-active";this.hideFilterClass=this.noFilters?"hide":"";this.hideActionClass=this.hideMobileActions?"control-bar--hide-mobile-actions":"";this.positionAbsoluteClass=this.absolute?"control-bar--absolute":
"";this.search.cssTheme="control-bar__search-input flex-1";this.queryParams=u.default.getQueryParams();this.hideRightClass=this.filterContainer||this.views||this.sort?"":"control-bar--hide-right";this.marginClass=this.noMargin?"control-bar--no-margin":""};T.prototype.postCreate=function(){var E=this,I,F,D,C,y;this.inherited(arguments);if(this.filterContainer){var G=m.default.toDom(n.default.substitute(B.default,{i18n:J.default,icons:v.default})),L=this.filterContainer.parentNode;L.insertBefore(G,
this.filterContainer);L.querySelector(".js-filters-insert").appendChild(this.filterContainer);this.filtersWrap=L.querySelector(".js-filters-mobile-wrap");this.filtersWrapParent=L;("false"===this.queryParams.showFilters||this.noFilters||this.collapsed)&&this.filtersWrap.classList.add("is-collapsed")}this.search&&(this.searchDropdown&&(this.search.searchBy=null!==(I=this.queryParams.searchBy)&&void 0!==I?I:"fullname"),this.search.topic=this.topic,this.telemetry&&(null===(F=this.telemetryOptions)||void 0===
F?0:F.search)&&(this.search.telemetry=this.telemetry),this._searchInput=new f.default(this.search,this.domNode.querySelector(".js-control-bar-search")));this.views&&(this.views.topic=this.topic,this.telemetry&&(null===(D=this.telemetryOptions)||void 0===D?0:D.viewToggle)&&(this.views.telemetry=this.telemetry),this._viewToggle=(0,R.render)((0,R.h)(r.default,p.__assign({},this.views)),this.domNode.querySelector(".js-control-bar-view-dropdown")));this.refresh&&(I=this.domNode.querySelector(".js-control-bar-refresh"),
I.classList.remove("hide"),(0,R.render)((0,R.h)(t.default,{topic:this.topic,label:this.refreshLabel}),I));this.sort&&(I={options:this.sort,topic:this.topic,telemetry:this.telemetry&&(null===(C=this.telemetryOptions)||void 0===C?0:C.sortOrderToggle)?this.telemetry:null},this._sortDropdown=(0,R.render)((0,R.h)(q.default,p.__assign({},I)),this.domNode.querySelector(".js-control-bar-sort-dropdown")));this.searchDropdown&&(this._searchDropdown=new w.default({},this.domNode.querySelector(".js-control-bar-search-dropdown")));
this.actions?this.domNode.querySelector(".js-control-bar-actions").innerHTML=n.default.substitute(this.actions,{i18n:J.default,icons:v.default,productGlyphs:x.default}):m.default.destroy(this.domNode.querySelector(".js-control-bar-actions"));this.noFilters&&(null===(y=this.filterContainer)||void 0===y?void 0:y.parentNode.removeChild(this.filterContainer));if(this.sticky)var O=setInterval(function(){var U;0<(null===(U=E.domNode)||void 0===U?void 0:U.clientHeight)&&(clearInterval(O),E.initStickyInterface())},
100);this.filtersWrap&&("false"===this.queryParams.showFilters?(this.hideFilters(),this.showOnResize=!1):this.resizeHandler(),window.innerWidth<this.mobileBreakPoint&&this.insideOverlay&&document.querySelector(".js-overlay-control-bar-filters").appendChild(this.filtersWrap));this.domNode.querySelector(".js-toggle-filters").setAttribute("aria-expanded",this.collapsed?"false":"true");this.toggleFilterText(window.innerWidth);this.own((0,d.default)(".js-toggle-filters",this.domNode).on("click",function(){return E.toggleFilters()}),
(0,c.default)(window,"resize",(0,g.default)(function(){return E.resizeHandler()},30)),(0,d.default)(".js-collapse-filters-button",this.filtersWrap).on("click",function(){return E.hideFilters()}),b.default.subscribe(this.topic+"search/error",this.showSearchError.bind(this)),b.default.subscribe(this.topic+"search/update",this.hideSearchError.bind(this)))};T.prototype.destroy=function(){this.domNode&&(this.sort&&(0,S.unmountComponentAtNode)(this.domNode.querySelector(".js-control-bar-sort-dropdown")),
this.views&&(0,S.unmountComponentAtNode)(this.domNode.querySelector(".js-control-bar-view-dropdown")));this.inherited(arguments)};T.prototype.refreshSort=function(E){var I;if(this.sort=E)E={options:this.sort,topic:this.topic,telemetry:this.telemetry&&(null===(I=this.telemetryOptions)||void 0===I?0:I.sortOrderToggle)?this.telemetry:null},this._sortDropdown=(0,R.render)((0,R.h)(q.default,p.__assign({},E)),this.domNode.querySelector(".js-control-bar-sort-dropdown"))};T.prototype.setSearchValue=function(E){b.default.publish("search/setValue",
E,!0);this._searchInput.setValue(E,!0)};T.prototype.getSearchValue=function(){return this._searchInput.getValue()};T.prototype.toggleFilters=function(){var E,I;if(null===(E=this.telemetryOptions)||void 0===E?0:E.filterToggle)null===(I=this.telemetry)||void 0===I?void 0:I.logEvent({category:"Control Bar Filter Toggle",action:this.collapsed?"show":"hide",pageUrl:window.location.href});this.collapsed?this.showFilters():this.hideFilters();this.screenWidth>this.mobileBreakPoint&&(this.showOnResize=!this.collapsed)};
T.prototype.showFilters=function(){var E=window.document.documentElement;this.collapsed=!1;this.dontUpdateQueryParams||u.default.updateQueryParams({showFilters:!0});this.filtersWrap&&this.filtersWrap.classList.remove("is-collapsed");var I=this.domNode.querySelector(".js-toggle-filters");I.classList.add("is-active");I.setAttribute("aria-expanded","true");this.screenWidth<this.mobileBreakPoint&&E.classList.add("filters-open");b.default.publish("control-bar/filters-toggle")};T.prototype.hideFilters=
function(){var E=window.document.documentElement;this.collapsed=!0;this.dontUpdateQueryParams||u.default.updateQueryParams({showFilters:!1});this.filtersWrap&&this.filtersWrap.classList.add("is-collapsed");var I=this.domNode.querySelector(".js-toggle-filters");I.classList.remove("is-active");I.setAttribute("aria-expanded","false");E.classList.remove("filters-open");b.default.publish("control-bar/filters-toggle")};T.prototype.resizeHandler=function(){var E=window.innerWidth,I=window.document.documentElement;
!this.collapsed&&900<=this.screenWidth&&900>E&&this.hideFilters();this.showOnResize&&this.collapsed&&900>this.screenWidth&&900<=E&&this.showFilters();(720>this.screenWidth&&720<=E||720<=this.screenWidth&&720>E)&&b.default.publish("view/refresh");(1080>this.screenWidth&&1080<=E||1080<=this.screenWidth&&1080>E)&&this.toggleFilterText(E);this._searchInput&&480<=this.screenWidth&&480>E&&b.default.publish("search/setPlaceholder",J.default.common.search);this._searchInput&&480>this.screenWidth&&480<=E&&
this._searchInput.setPlaceholder();E>this.mobileBreakPoint&&I.classList.remove("filters-open");this.moveFilters(E);this.screenWidth=E};T.prototype.setPlaceholder=function(E){this._searchInput.setPlaceholder(E)};T.prototype.focus=function(){var E;null===(E=this._searchInput)||void 0===E?void 0:E.focus()};T.prototype.initStickyInterface=function(){window.scrollTo(0,0);a.default.sticky();this._scrollingSideMenu=this.filterContainer.querySelector(".js-scrolling-side-menu");this._scrollingMenusStart=this.domNode.getBoundingClientRect().top;
this._scrollingOptionsMenuPlaceHolder=m.default.create("div",{class:"js-scrolling-top-menu-placeholder hide",style:"height:\n          ".concat(this.domNode.clientHeight+Number(getComputedStyle(this.domNode)["margin-bottom"].split("px")[0]),"px;")},this.domNode,"before");this.own(a.default.bus.on("scrolling:at",this.stickyCallback?this._handlePageScrollWithCallback.bind(this):this.handlePageScroll.bind(this)))};T.prototype.showSearchError=function(E,I){var F;(null===(F=this._searchInput)||void 0===
F?void 0:F.id)===I&&(I=this.domNode.querySelector(".js-control-bar-search-error"),I.innerHTML=E,I.classList.add("is-active"),this.domNode.querySelector("js-control-bar-search-wrap").classList.add("ontrol-bar__search--error"))};T.prototype.hideSearchError=function(E){this._searchInput&&this._searchInput.id===E&&(E=this.domNode.querySelector(".js-control-bar-search-error"),E.innerHTML="",E.classList.remove("is-active"),this.domNode.querySelector(".js-control-bar-search-wrap").classList.remove("control-bar__search--error"))};
T.prototype._handlePageScrollWithCallback=function(E,I){this.handlePageScroll();this.stickyCallback(E,I)};T.prototype.handlePageScroll=function(){var E=document.documentElement,I=this.domNode.clientHeight;(window.pageYOffset||E.scrollTop)>=this._scrollingMenusStart?(this._scrollingOptionsMenuPlaceHolder.classList.remove("hide"),this.domNode.classList.add("fixed-to"),window.innerWidth>this.mobileBreakPoint?(this._scrollingSideMenu.classList.add("fixed-to"),this._scrollingSideMenu.style.top="".concat(I,
"px")):this._scrollingSideMenu.style.top="0"):(this._scrollingOptionsMenuPlaceHolder.classList.add("hide"),this.domNode.classList.remove("fixed-to"),this._scrollingSideMenu.classList.remove("fixed-to"),this._scrollingSideMenu.style.top="0")};T.prototype.moveFilters=function(E){this.insideOverlay&&this.filtersWrap&&(this.screenWidth<this.mobileBreakPoint&&E>=this.mobileBreakPoint&&m.default.place(this.filtersWrap,this.filtersWrapParent,"first"),this.screenWidth>=this.mobileBreakPoint&&E<this.mobileBreakPoint&&
document.querySelector(".js-overlay-control-bar-filters").appendChild(this.filtersWrap))};return T=p.__decorate([(0,P.default)(h.default,l.default)],T)}()})},"arcgisonline/pages/dijit/SearchInput":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/topic dojo/debounce dojo/dom-class dojo/on dojo/i18n!../../nls/arcgisonline dojo/text!./SearchInput/SearchInput.html dijit/_TemplatedMixin dijit/_WidgetBase esri/libs/sanitizer/Sanitizer ../utils/icons ../utils/dom ../utils/strings".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);return function(){function w(u,v){var x=this;this.templateString=d.default;this.i18n=c.default;this.icons=r.default;this.queryParam=this.cssTheme=this.searchTerm=
"";this.hasSearchBy=!1;this.topic=this.searchBy="";this.dontDebounce=!1;this.screenReadersLabel="";this.sanitizer=new f.default;this.searchStarted=this.cancelDebounce=!1;this._searchWithDebounce=(0,m.default)(function(z){x.cancelDebounce||x._search(z);x.cancelDebounce=!1},1E3)}w.prototype.postMixInProperties=function(){this.inherited(arguments);this.searchTerm=this.params.searchTerm||"";this.cssTheme=this.cssTheme||"";this.queryParam=this.params.queryParam||"searchTerm";this.searchBy=this.params.searchBy||
"";this.topic=this.params.topic||"";this.params.validateInput&&(this.validateInput=this.params.validateInput.bind(this));this.params.generateErrorMessage&&(this.generateErrorMessage=this.params.generateErrorMessage.bind(this))};w.prototype.postCreate=function(){var u=this;this.inherited(arguments);this.searchInput.value=this.searchTerm;q.default.showHide(this.clearBtn,!!this.searchTerm);this.clearBtn.innerHTML=r.default.getIconWithTitle("x","16",c.default.manageLicenses.clearLabel,"".concat(this.id,
"_clear_btn"));if(this.screenReadersLabel){var v="search_instruction_".concat(this.id),x=document.createElement("div");x.className="screen-readers-only";x.id=v;x.innerHTML=this.screenReadersLabel;this.searchInput.setAttribute("aria-describedby",v);this.searchInput.insertAdjacentElement("beforebegin",x)}this.own((0,b.default)(this.searchInput,"input",function(z){q.default.showHide(u.clearBtn,!!u.searchInput.value);z=z.target.value;(2<z.length||0===z.length)&&z!==u.searchTerm&&(u.searchTerm=z,g.default.publish("".concat(u.topic,
"search/wait"),u.sanitizer.sanitize(z),u.queryParam),u._testAndSearch(z,!!z))}),(0,b.default)(this.searchInput,"focus",function(z){n.default.add(z.target.parentNode,"control-bar__search--active");u.searchInput.value&&q.default.showNode(u.clearBtn);g.default.publish("search/focus",u.searchTerm)}),(0,b.default)(this.searchInput,"blur",function(z){n.default.remove(z.target.parentNode,"control-bar__search--active");u.searchStarted=!1}),(0,b.default)(this.searchInput,"keydown",function(z){13===z.keyCode&&
u._testAndSearch(z.target.value,!1)}),(0,b.default)(this.clearBtn,"click",function(){u.searchInput.value="";q.default.hideNode(u.clearBtn);u.searchTerm="";g.default.publish("".concat(u.topic,"search/wait"),"",u.queryParam);u._testAndSearch("",!1);u.searchInput.focus()}),g.default.subscribe("membersSearchBy/update",function(z){u.hasSearchBy&&(u.searchBy=z)}))};w.prototype.focus=function(){this.searchInput.focus()};w.prototype.setValue=function(u,v){this.searchTerm=u;this.searchInput.value=u;q.default.showHide(this.clearBtn,
!!this.searchTerm);v||(g.default.publish("".concat(this.topic,"search/wait"),this.sanitizer.sanitize(u),this.queryParam),this._testAndSearch(u,!1))};w.prototype.getValue=function(){return this.searchInput.value};w.prototype.setPlaceholder=function(u,v){u=u||this.placeholder;v||(this.placeholder=u);this.searchInput.placeholder=u;this.searchInput.setAttribute("aria-label",u)};w.prototype.validateInput=function(u,v){return!0};w.prototype.generateErrorMessage=function(u,v){return c.default.controlBar.invalidSyntax};
w.prototype._testAndSearch=function(u,v){void 0===v&&(v=!0);this.validateInput(u,this.searchBy)?(this.cancelDebounce=!1,v&&!this.dontDebounce?this._searchWithDebounce(u):(this._search(u),this.cancelDebounce=!0)):g.default.publish("".concat(this.topic,"search/error"),this.generateErrorMessage(u,this.searchBy),this.id)};w.prototype._search=function(u){var v,x=this.sanitizer.sanitize(u);x=t.default.escapeQuestionMarks(x);g.default.publish("".concat(this.topic,"search/update"),x,this.searchBy,this.id);
null===(v=this.telemetry)||void 0===v?void 0:v.logEvent({category:"Search",action:this.searchStarted?"update":"start",label:u,pageUrl:window.location.href});this.searchStarted=!0};return w=p.__decorate([(0,a.default)(h.default,l.default)],w)}()})},"arcgisonline/pages/components/ViewToggle":function(){define("require exports tslib preact dojo/i18n!../../nls/arcgisonline dojo/topic arcgisonline/pages/pageUtil calcite-web/js/calcite-web".split(" "),function(e,K,p,a,g,m,n,b){Object.defineProperty(K,"__esModule",
{value:!0});g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);e=function(c){function d(){var l=null!==c&&c.apply(this,arguments)||this;l.domNodeRef=(0,a.createRef)();l.updateMobileWidth=function(){l.setState({isMobileWidth:1080>window.innerWidth})};l.toggleView=function(h){var f,r,q,t;h.stopPropagation();h=null===(q=null===(r=null===(f=h.target.selectedItems)||void 0===f?void 0:f[0])||void 0===r?void 0:r.dataset)||void 0===q?void 0:q.view;l.updateUI(h);null===
(t=l.props.telemetry)||void 0===t?void 0:t.logEvent({category:"Control Bar View Selector",action:h,pageUrl:window.location.href});b.default.bus.emit("dropdown:close")};l.updateUI=function(h){l.setState({activeView:h});l.props.topic||n.default.updateQueryParams({view:h});m.default.publish("".concat(l.props.topic,"view/toggle"),h)};return l}p.__extends(d,c);d.prototype.componentDidMount=function(){var l=this;this.updateUI(this.props.activeView);(new ResizeObserver(function(){l.updateMobileWidth()})).observe(document.body)};
d.prototype.render=function(){var l=this,h=this.state,f=h.activeView,r=h.open,q=this.props.views;return(0,a.h)("calcite-dropdown",{width:"m",oncalciteDropdownSelect:function(t){return l.toggleView(t)},oncalciteDropdownOpen:function(){return l.setState({open:!0})},oncalciteDropdownClose:function(){return l.setState({open:!1})},role:"menu","aria-controls":"viewmenu","aria-expanded":r,"aria-haspopup":"true",open:r},(0,a.h)("calcite-button",{slot:"trigger",iconStart:f,iconFlipRtl:"start",appearance:"transparent",
kind:"neutral","aria-label":g.default.viewToggle.selectView},!h.isMobileWidth&&(0,a.h)("span",null,g.default.viewToggle[f])),(0,a.h)("calcite-dropdown-group",{role:"group",id:"viewmenu",groupTitle:g.default.viewToggle.view},q.map(function(t){return(0,a.h)("calcite-dropdown-item",{key:t,role:"menuitemradio",iconStart:t,iconFlipRtl:"start",selected:t===f,"data-view":t,"aria-label":g.default.viewToggle[t]},g.default.viewToggle[t])})))};d.defaultProps={activeView:"grid",views:["table","list","grid"],
topic:""};return d}(a.Component);K.default=e})},"arcgisonline/pages/components/SortDropdown":function(){define("require exports tslib preact ../utils/arrays dojo/i18n!../../nls/arcgisonline dojo/topic ../pageUtil calcite-web/js/calcite-web".split(" "),function(e,K,p,a,g,m,n,b,c){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);var d={title:{asc:"alphabetical",desc:"reverseAlphabetical"},
owner:{asc:"alphabetical",desc:"reverseAlphabetical"},modified:{asc:"leastRecent",desc:"mostRecent"},added:{asc:"leastRecent",desc:"mostRecent"},numviews:{asc:"leastToMost",desc:"mostToLeast"},relevance:{asc:"leastToMost",desc:"mostToLeast",disabled:!0},lastlogin:{asc:"leastRecent",desc:"mostRecent"},name:{asc:"alphabetical",desc:"reverseAlphabetical"},fullname:{asc:"alphabetical",desc:"reverseAlphabetical"},joined:{asc:"leastRecent",desc:"mostRecent"},level:{asc:"alphabetical",desc:"reverseAlphabetical"},
role:{asc:"alphabetical",desc:"reverseAlphabetical"},created:{asc:"leastRecent",desc:"mostRecent"},email:{asc:"alphabetical",desc:"reverseAlphabetical"},fieldAlias:{asc:"alphabetical",desc:"reverseAlphabetical"},fieldName:{asc:"alphabetical",desc:"reverseAlphabetical"},fieldType:{asc:"alphabetical",desc:"reverseAlphabetical"},defaultFSOrder:{asc:"leastToMost",desc:"mostToLeast",disabled:!0},mfaenabled:{asc:"ascending",desc:"descending"},membertype:{asc:"alphabetical",desc:"reverseAlphabetical"},username:{asc:"alphabetical",
desc:"reverseAlphabetical"},layerName:{asc:"alphabetical",desc:"reverseAlphabetical"},layerType:{asc:"alphabetical",desc:"reverseAlphabetical"},datasetName:{asc:"alphabetical",desc:"reverseAlphabetical"},datasetPath:{asc:"alphabetical",desc:"reverseAlphabetical"},machine:{asc:"alphabetical",desc:"reverseAlphabetical"},containerId:{asc:"alphabetical",desc:"reverseAlphabetical"},runtimeName:{asc:"alphabetical",desc:"reverseAlphabetical"},version:{asc:"alphabetical",desc:"reverseAlphabetical"},avgrating:{asc:"highestRated",
desc:"highestRated",disabled:!0},custom:{asc:"mostRecent",desc:"leastRecent",disabled:!0},type:{asc:"alphabetical",desc:"reverseAlphabetical"},size:{asc:"smallestToLargest",desc:"largestToSmallest"}};e=function(l){function h(){var f=null!==l&&l.apply(this,arguments)||this;f.domNodeRef=(0,a.createRef)();f.state={ascending:!0,property:"",label:"",sortEnabled:!0,disabled:!1,showOnlyRelevance:!1,open:!1};f.updateMobileWidth=function(){f.setState({isMobileWidth:1080>window.innerWidth})};f.sortDisable=
function(){f.setState({showOnlyRelevance:!0})};f.sortEnable=function(){f.setState({showOnlyRelevance:!1})};f.handleSortOptionClick=function(r){var q;n.default.publish("".concat(f.props.topic,"sort/update"),r);null===(q=f.props.telemetry)||void 0===q?void 0:q.logEvent({category:"Control Bar Sort Order",action:"".concat(null===r||void 0===r?void 0:r.property," ").concat(r.ascending?"ascending":"descending"),pageUrl:window.location.href});f.setState({open:!1})};f.handleSortClick=function(r){var q;n.default.publish("".concat(f.props.topic,
"sort/update"),p.__assign(p.__assign({},f.state),{ascending:r}));null===(q=f.props.telemetry)||void 0===q?void 0:q.logEvent({category:"Control Bar Sort Order",action:"".concat(f.state.property," ").concat(r?"ascending":"descending"),pageUrl:window.location.href})};f.handleToggle=function(){if(f.domNodeRef.current){var r=f.domNodeRef.current;if(!r.classList.contains("is-active")){var q=r.querySelectorAll(".control-bar__dropdown-item")[0];q&&setTimeout(function(){q.focus()})}}};f.sortUpdate=function(r){var q,
t=f.props,w=t.dontUpdateQueryParams;t=t.topic;var u=r.ascending,v=r.property;r=r.label;f.state.sortEnabled||c.default.bus.emit("dropdown:close");f.setState({ascending:u,property:v,label:r,ascendingLabel:m.default.gallery[d[v].asc],descendingLabel:m.default.gallery[d[v].desc],disabled:!(null===(q=d[v])||void 0===q||!q.disabled)});w||t||b.default.updateQueryParams({sortOrder:u?"asc":"desc",sortField:v})};return f}p.__extends(h,l);h.prototype.componentDidMount=function(){var f=this,r=g.default.find(this.props.options,
function(t){return t.active}),q=d[r.property];this.setState(p.__assign(p.__assign({},r),{ascendingLabel:m.default.gallery[q.asc],descendingLabel:m.default.gallery[q.desc],disabled:null===q||void 0===q?void 0:q.disabled}));this.sortUpdateHandler=n.default.subscribe("".concat(this.props.topic,"sort/update"),function(t){return f.sortUpdate(t)});this.sortDisableHandler=n.default.subscribe("".concat(this.props.topic,"sort/disable"),function(){return f.sortDisable()});this.sortEnableHandler=n.default.subscribe("".concat(this.props.topic,
"sort/enable"),function(){return f.sortEnable()});(new ResizeObserver(function(){f.updateMobileWidth()})).observe(document.body)};h.prototype.componentWillUnmount=function(){[this.sortDisableHandler,this.sortEnableHandler,this.sortUpdateHandler].forEach(function(f){f.remove()})};h.prototype.render=function(){var f=this,r=this.state,q=r.label,t=r.ascendingLabel,w=r.descendingLabel,u=r.ascending,v=r.property,x=r.showOnlyRelevance,z=r.disabled,A=this.props.options;return(0,a.h)("calcite-dropdown",{width:"m",
role:"menu","aria-controls":"sortmenu","aria-expanded":r.open,"aria-haspopup":"true",oncalciteDropdownOpen:function(){return f.setState({open:!0})},oncalciteDropdownClose:function(){return f.setState({open:!1})}},(0,a.h)("calcite-button",{slot:"trigger",iconStart:"sort-descending",iconFlipRtl:"start",appearance:"transparent",kind:"neutral","aria-label":m.default.gallery.changeSortDirection,"aria-haspopup":"true","aria-controls":"sortmenu"},!r.isMobileWidth&&(0,a.h)("span",null,q)),(0,a.h)("calcite-dropdown-group",
{id:"sortmenu"},(0,a.h)("calcite-dropdown-group",{role:"group",groupTitle:m.default.gallery.sortBy},A.map(function(B){var J=B.label;return(0,a.h)("calcite-dropdown-item",{key:B,class:"relevance"===B.property&&x?"hide":"",role:"menuitemradio",selected:v===B.property,"data-property":v,oncalciteDropdownItemSelect:function(){return f.handleSortOptionClick(B)},"aria-label":J},J)})),(0,a.h)("calcite-dropdown-group",{class:z?"hide":"",role:"group",groupTitle:m.default.gallery.sortDirection},(0,a.h)("calcite-dropdown-item",
{role:"menuitemradio",selected:u,"data-value":"asc",oncalciteDropdownItemSelect:function(){return f.handleSortClick(!0)},"aria-label":t},t),(0,a.h)("calcite-dropdown-item",{role:"menuitem",selected:!u,"data-value":"desc",oncalciteDropdownItemSelect:function(){return f.handleSortClick(!1)},"aria-label":w},w))))};h.defaultProps={topic:""};return h}(a.Component);K.default=e})},"arcgisonline/pages/components/Refresh":function(){define(["require","exports","tslib","dojo/topic","preact"],function(e,K,p,
a,g){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);e=function(m){function n(){return null!==m&&m.apply(this,arguments)||this}p.__extends(n,m);n.prototype.onRefresh=function(){a.default.publish("".concat(this.props.topic,"refresh"))};n.prototype.render=function(){var b=this;return(0,g.h)("div",null,(0,g.h)("calcite-button",{label:this.props.label,onClick:function(){return b.onRefresh()},appearance:"transparent",kind:"neutral",iconStart:"refresh",scale:"s"}))};n.defaultProps=
{topic:"",label:""};return n}(g.Component);K.default=e})},"arcgisonline/pages/organization/widgets/SearchDropdown":function(){define("require exports tslib ../../utils/icons ../../../tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase dojo/query dojo/dom-class dojo/topic dojo/text!./templates/members/SearchDropdown.html dojo/i18n!../../../nls/arcgisonline".split(" "),function(e,K,p,a,g,m,n,b,c,d,l,h){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);
b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);return function(){function f(r,q){this.templateString=l.default;this.i18n=h.default;this.icons=a.default}f.prototype.setSelection=function(r){var q=(0,b.default)("[data-property*\x3d".concat(r,"]"),this.domNode);0<q.length&&(c.default.remove((0,b.default)(".js-search-dropdown-property.is-active",this.domNode).shift(),"is-active"),q.addClass("is-active"),this._searchLabel.innerHTML=q.innerHTML(),
d.default.publish("membersSearchBy/update",r))};f.prototype.postCreate=function(){this._searchLabel.innerHTML=this.i18n.myOrganization.membersTab.fullName;this._addEventListeners()};f.prototype._addEventListeners=function(){this.own((0,b.default)(".js-search-dropdown-property").on("click",this._optionSelect.bind(this)))};f.prototype._optionSelect=function(r){r.preventDefault();c.default.remove((0,b.default)(".js-search-dropdown-property.is-active",this.domNode).shift(),"is-active");c.default.add(r.target,
"is-active");var q=r.target.getAttribute("data-property");this._searchLabel.innerHTML=r.target.textContent;d.default.publish("membersSearchBy/update",q)};return f=p.__decorate([(0,g.default)(n.default,m.default)],f)}()})},"arcgisonline/pages/dijit/View":function(){define("require exports tslib preact esri/Evented dojo/string dojo/on dojo/query dojo/topic dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin ./Card ./CardMobile ./CardWide ./TableRow ../pageUtil ../utils/arrays ../utils/icons dojo/text!./View/templates/tableHeader.html dojo/text!./View/templates/empty.html dojo/text!./View/templates/none.html dojo/text!./View/templates/loader.html dojo/text!./View/templates/View.html dojo/i18n!../../nls/arcgisonline dojo/i18n!../../nls/notebooks ../../tsutils/declareDecorator ../utils/dropdown ../components/SearchFeedback ../utils/search".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I){g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);B=p.__importDefault(B);
J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);return function(){function F(D,C){this.templateString=J.default;this.i18n=P.default;this.select=!0;this.listTemplate=null;this.tableHead=x.default;this.emptyView=z.default;this.noneView=A.default;this.loaderView=B.default;this.listView=q.default;this.mobileView=r.default;this.tableRowView=t.default;this.showSource=this.fullItemTypes=!1;this.location=P.default.contentPage.searchingFor;this.sortOptions=[];this.showShareGroups=
this.allowShare=this.hasSharedOwnershipGroups=!1;this.searchTerm="";this._shiftPressed=this._hasFilters=this.allowSelectAll=this.showFeedback=this.allowDragAndDrop=this.recordSelection=this.recordSortToggle=!1;this._lastSelected=null;this._items=[];this._selected=[];this._dijits=[];this._itemViews={};this.feedbackSearchTerm="";this.inRecycle=!1}F.prototype.postMixInProperties=function(){this.inherited(arguments);this.i18n.notebookLanding=R.default.notebookLanding;this.i18n.notebookViewer=R.default.notebookViewer;
this.i18n.notebookServerManager=R.default.notebookServerManager};F.prototype.postCreate=function(){this.inherited(arguments);this._view=this.activeView;var D={i18n:this.i18n,location:this.location,searchTerm:""};this.domNode.querySelector(".js-empty-wrap").innerHTML=m.default.substitute(this.emptyView,{i18n:this.i18n});this.domNode.querySelector(".js-none-wrap").innerHTML=m.default.substitute(this.noneView,{i18n:this.i18n});this.domNode.querySelector(".js-loader-wrap").innerHTML=m.default.substitute(this.loaderView,
D);this.domNode.querySelector(".js-table-header").innerHTML=m.default.substitute(this.tableHead,{i18n:this.i18n,icons:v.default,selectClass:this.select?"":"hide"});0<this.sortOptions.length&&(D=u.default.find(this.sortOptions,function(C){return C.active}))&&this._sortUpdate(D);this._itemViews=this.declareItemViews();this._addEventListeners()};F.prototype.destroy=function(){this.inherited(arguments);this._dijits.forEach(function(D){return D.destroy()})};F.prototype.setEmptyView=function(D){this.emptyView=
D;this.domNode.querySelector(".js-empty-wrap").innerHTML=m.default.substitute(this.emptyView,{i18n:this.i18n})};F.prototype.declareItemViews=function(){return{grid:{template:f.default,containerClass:".js-grid-wrap"},mobile:{template:this.mobileView,containerClass:".js-mobile-wrap"},list:{template:this.listView,containerClass:".js-list-wrap"},table:{template:this.tableRowView,containerClass:".js-table-rows"}}};F.prototype.allowCategorization=function(){(0,b.default)(this.domNode).addClass("allow-categorization")};
F.prototype.preventCategorization=function(){(0,b.default)(this.domNode).removeClass("allow-categorization")};F.prototype.updateSearchFeedback=function(D,C,y,G,L,O){var U=this;this.searchTerm=D;var M=this.domNode.querySelector(".js-search-feedback");(0,a.render)((0,a.h)(null,null),M);M.classList.add("hide");C&&this.showFeedback&&this.telemetry&&D&&D!==this.feedbackSearchTerm&&((null===L||void 0===L?0:L.eueiEnabled)||O&&!O.orgId)&&(M.classList.remove("hide"),(0,a.render)((0,a.h)(E.SearchFeedback,{telemetry:this.telemetry,
searchTerm:this.searchTerm,page:y,onlyOrg:G,section:"content",enriched:(0,I.semanticSearchEnabled)(this.portal,this.portalUser),onSubmit:function(){return U.feedbackSearchTerm=D}}),M))};F.prototype._addEventListeners=function(){var D=this;this.own((0,n.default)(window,"keydown",function(C){return D._shiftPressed=C.shiftKey}),(0,n.default)(window,"keyup",function(C){return D._shiftPressed=!1}),(0,b.default)(".js-table-sort-header",this.domNode).on("click",this._sortHeader.bind(this)),(0,n.default)(this.domNode.querySelector(".js-select-all"),
"click",this._toggleAll.bind(this)),c.default.subscribe("view/toggle",this._toggleView.bind(this)),c.default.subscribe("view/update",this._updateView.bind(this)),c.default.subscribe("view/deselect",this._deselectItem.bind(this)),c.default.subscribe("view/deselectAll",this._deselectAll.bind(this)),c.default.subscribe("view/select",this._parseSelect.bind(this)),c.default.subscribe("view/loading",this._showSearchLoadingScreen.bind(this)),c.default.subscribe("view/updateShare",this._updateItemsSharing.bind(this)),
c.default.subscribe("sort/update",this._sortUpdate.bind(this)),c.default.subscribe("pagination/page",this._scrollToTop.bind(this)),c.default.subscribe("item/update",this._updateItem.bind(this)));this.allowDragAndDrop&&(this.domNode.classList.add("drag-and-drop-well"),this.own((0,n.default)(this.domNode,"dragover",function(C){C.preventDefault();D.dragover||(D.dragover=!0,D.domNode.classList.add("drag-and-drop-well--dragging"))}),(0,n.default)(this.domNode,"dragleave",function(C){C.preventDefault();
D.dragover=!1;D.domNode.classList.remove("drag-and-drop-well--dragging")}),(0,n.default)(this.domNode,"drop",function(C){C.preventDefault();D.dragover=!1;D.domNode.classList.remove("drag-and-drop-well--dragging");c.default.publish("view/drop",C.dataTransfer)})))};F.prototype._toggleView=function(D){this._view=D;c.default.publish("view/update",this._items,this._selected,this._hasFilters)};F.prototype._showSearchLoadingScreen=function(D){(0,b.default)(".js-view",this.domNode).addClass("hide");var C=
this.domNode.querySelector(".js-loader-wrap"),y=m.default.substitute(this.location,{term:D});C.innerHTML=m.default.substitute(this.loaderView,{i18n:this.i18n,location:y,searchTerm:D});C.classList.remove("hide")};F.prototype.showLoadingScreen=function(D){(0,b.default)(".js-view",this.domNode).addClass("hide");var C=this.domNode.querySelector(".js-loader-wrap");C.innerHTML=m.default.substitute(this.loaderView,{i18n:this.i18n,location:D});C.classList.remove("hide")};F.prototype._parseSelect=function(D,
C){var y=this._items.indexOf(D);C||!this._lastSelected&&0!==this._lastSelected||!this._shiftPressed?(this._selectItem(D),this._lastSelected=y):this._selectRange(Math.min(this._lastSelected,y),Math.max(this._lastSelected,y))};F.prototype._selectItem=function(D){u.default.find(this._selected,function(C){return C.id===D.id})||(D.isSelected=!0,this._selected.push(D));this._setSelectAllState()};F.prototype._toggleAll=function(D){var C;this._lastSelected=null;this._shiftPressed=!1;D=D.target.checked;this.allowSelectAll?
D?this.selectAll():c.default.publish("view/deselectAll"):(D?this._selectPage():this._deselectPage(),this.recordSelection&&(null===(C=this.telemetry)||void 0===C?void 0:C.logEvent({category:"Select",action:"".concat(D?"Select":"Unselect"," page"),count:this._items.length})))};F.prototype._selectRange=function(D,C){for(this._lastSelected=null;D<=C;D++)c.default.publish("view/select",this._items[D],!0);c.default.publish("view/update",this._items,this._selected,this._hasFilters)};F.prototype.selectAll=
function(){c.default.publish("view/select-all",this._items,p.__spreadArray([],this._items,!0),this._hasFilters);this._items.forEach(function(D){D.isSelected=!0})};F.prototype._selectPage=function(){this._lastSelected=null;this._items.forEach(function(D){return c.default.publish("view/select",D)});c.default.publish("view/update",this._items,this._selected,this._hasFilters,null,null,this.inRecycle)};F.prototype._deselectItem=function(D){this._lastSelected=null;D.isSelected=!1;this._selected=this._selected.filter(function(C){return C.id!==
D.id});this._setSelectAllState()};F.prototype._deselectPage=function(){this._lastSelected=null;this._items.forEach(function(D){return c.default.publish("view/deselect",D)});c.default.publish("view/update",this._items,this._selected,this._hasFilters,null,null,this.inRecycle)};F.prototype._deselectAll=function(){this._lastSelected=null;this._items=this._items.map(function(D){D.isSelected=!1;return D});this._selected=[];this._setSelectAllState()};F.prototype._sortUpdate=function(D){this._currentSort=
D;this._lastSelected=null;if("table"===this._view||this.inRecycle){var C=D.ascending?"is-ascending":"is-descending",y=(0,b.default)(".js-table-sort-header");y.removeClass(["is-descending","is-ascending"]);y.forEach(function(G){G.parentElement.setAttribute("aria-sort","none")});if(y=this.domNode.querySelector(".js-table-sort-header[data-sort\x3d'"+D.property+"']"))y.classList.add(C),y.setAttribute("data-sort-order",D.ascending?"asc":"desc"),y.parentElement.setAttribute("aria-sort",D.ascending?"ascending":
"descending")}};F.prototype._updateItem=function(D){D&&"isFavorite"!==D.name&&this._updateView(this._items,this._selected,this._hasFilters)};F.prototype._updateItemsSharing=function(D){var C=this;(D||[]).forEach(function(y){var G=u.default.find(C._items,function(L){return L.id===y.id});G&&(G.set("access",y.access),G.set("groupData",y.groupData),G.set("sharedGroups",y.sharedGroups))})};F.prototype._sortHeader=function(D){this._lastSelected=null;var C=D.target;if(!C.getAttribute("data-sort")){var y=
(0,b.default)(D.target).closest(".js-table-sort-header")[0];y&&(C=y)}var G=C.getAttribute("data-sort");y=d.default.contains(C,"is-ascending")||d.default.contains(C,"is-descending");C=C.getAttribute("data-sort-order");y&&(C="asc"===C?"desc":"asc");D=(y=u.default.find(this.sortOptions,function(L){return L.property===G}))?y.label:D.target.innerHTML;this.telemetry&&this.recordSortToggle&&this.telemetry.logEvent({category:"Table Sort Order",action:"selected sort order"});c.default.publish("sort/update",
{label:D,property:G,ascending:"asc"===C})};F.prototype._updateView=function(D,C,y,G,L,O){var U=this;void 0===O&&(O=!1);this.inRecycle=O;var M=w.default.getQueryParams();this._lastSelected=null;G=this.domNode.querySelector(".js-content-loader");L=this.domNode.querySelector(".js-table-wrap");null===G||void 0===G?void 0:G.classList.add("is-active");this._dijits.forEach(function(Aa){return Aa.destroy()});(0,b.default)(".js-view",this.domNode).addClass("hide");this._items=D||[];this._selected=C||[];this._hasFilters=
y;var Q=this.mobileView&&720>=window.innerWidth?"mobile":O?"table":this._view;C=this._itemViews[Q];var Y=C.template,fa=this.domNode.querySelector(C.containerClass);C=this.domNode.querySelector(".js-none-wrap");var va=this.domNode.querySelector(".js-empty-wrap");y=y?C:va;0<D.length?(D.forEach(function(Aa,pa){var N=u.default.find(U._selected,function(V){return V.id===Aa.id});pa={item:Aa,options:M,select:U.select,isSelected:N,portalUser:U.portalUser,fullItemTypes:U.fullItemTypes,showSource:U.showSource,
hasSharedOwnershipGroups:U.hasSharedOwnershipGroups,allowShare:U.allowShare,showShareGroups:U.showShareGroups,itemIndex:pa,telemetry:U.telemetry,page:U.page,telemetryOptions:U.telemetryOptions,portal:U.portal,recordSelection:U.recordSelection,searchTerm:U.searchTerm,addSearchTelemetryParams:U.addSearchTelemetryParams};O?pa.template=U.recycleView:U.tableRow&&"table"===Q?pa.template=U.tableRow:U.listTemplate&&"list"===Q&&(pa.template=U.listTemplate);pa=new Y(pa);pa.startup();pa.placeAt(fa);U._dijits.push(pa)}),
d.default.remove(fa,"hide"),c.default.publish("view/show"),"table"===Q&&(L.classList.remove("hide"),this._setSelectAllState(),this._sortUpdate(this._currentSort))):y.classList.remove("hide");null===G||void 0===G?void 0:G.classList.remove("is-active");(0,T.dropdown)()};F.prototype._setSelectAllState=function(){var D=this.domNode.querySelector(".js-select-all"),C=this._items.filter(function(y){return y.isSelected});0===C.length?(D.checked=!1,D.indeterminate=!1):C.length===this._items.length?(D.checked=
!0,D.indeterminate=!1,D.disabled=!1):D.indeterminate=!0};F.prototype._scrollToTop=function(){this._lastSelected=null;var D=this.domNode.getBoundingClientRect().top;0>D&&window.scrollBy(0,D-50)};F.prototype.getItemCount=function(){return this._items.length};F.prototype.getItemsInView=function(){return this._items};return F=p.__decorate([(0,S.default)(l.default,h.default,g.default)],F)}()})},"arcgisonline/pages/dijit/Card":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/string ./Card/_CardBase dojo/text!./Card/Card.html dojo/text!./Card/MinimalCard.html dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);return function(){function d(l,h){this.alwaysShowDrag=this.draggable=!1;this.templateString=l.minimal?b.default:n.default}d.prototype.postMixInProperties=function(){var l,h;this.inherited(arguments);this.item.ownerText=null!==(h=null===(l=this.item.verified)||void 0===l?void 0:l.name)&&void 0!==h?h:this.item.owner;this.item.viewMsg=g.default.substitute(c.default.viewsWidget.universalViewsMsgAlone,
{viewcount:this.item.numViews})};d.prototype.postCreate=function(){this.inherited(arguments);this.draggable&&this.domNode.classList.add("card--draggable");this.alwaysShowDrag&&this.domNode.classList.add("card--show-drag")};d.prototype.setDraggable=function(l){(this.draggable=l)?this.domNode.classList.add("card--draggable"):this.domNode.classList.remove("card--draggable")};return d=p.__decorate([(0,a.default)(m.default)],d)}()})},"arcgisonline/pages/dijit/Card/_CardBase":function(){define("require exports tslib ../../../esriGeowConfig ../../components/Favorite ./_getItemClasses ../OrgPopup/OrgPopup ../../item/_Actions ../../utils/formatters ../../utils/item ../../utils/setItemUrls ../../utils/icons ../../utils/arrays ../../utils/dom ../../utils/notebook ../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin ../ItemShareSummary dojo/dom-construct dojo/query dojo/string dojo/on dojo/topic preact dojo/i18n!../../../nls/arcgisonline dojo/text!./Card.html dojo/text!./OpenDropdown.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);var E;(function(I){I.notebook="notebookViewer";I.map="mapViewer";I.newMap="newMapViewer";I.download="download";I.desktop="openDesktop";I.pro="openPro";I.story="storyMapViewer"})(E||(E={}));return function(){function I(F){this.i18n=R.default;this.template=S.default;this.fullDate=c.default.fullDate;this.completeDate=c.default.completeDate;this.empty=c.default.empty;this.getAccess=c.default.getAccess;
this.getAccessIcon=c.default.getAccessIcon;this.formatNumViews=c.default.formatNumViews;this.formatViewsLabel=c.default.formatViewsLabel;this.selectTitle=c.default.selectTitle;this.moreOptionsTitle=c.default.moreOptionsTitle;this.hasSharedOwnershipGroups=this.fullItemTypes=!1;this.hide=c.default.hide;this.show=c.default.show;this.icons=h.default;this.isImage=!1;this.imageClass="";this.cssClasses=[];this.select=this.favoritesDisabled=!1;this.checked=this.selectedClass="";this.selectItem=R.default.GroupWidget.selectItem;
this.disabled="disabled";this.addSearchTelemetryParams=!1;this.searchTerm="";this.badgeWidth="narrow";this.badgeScale="s";this.canCreateNotebooks=!1}I.prototype.postMixInProperties=function(){var F=this,D,C,y,G,L,O;this.formatDisplayName=c.default.formatDisplayName.bind(this,this.item,this.fullItemTypes);this.favoritesDisabled=!this.portalUser;this.selectCardClass=this.select?"card-select":"";this.isSelected&&(this.selectedClass="card-select-active",this.checked="checked",this.selectItem=R.default.GroupWidget.unselectItem);
this.hasSublayers=!(null===(D=this.item.sublayers)||void 0===D||!D.length);this.removedClass=this.isRemoved?"card-select-removed":"";this.item.canShare=this.allowShare&&d.default.canShareItem(this.item,this.portalUser);this.item.isAdmin=null!==(C=this.item.isAdmin)&&void 0!==C?C:(null===(y=this.portalUser)||void 0===y?void 0:y.isOrgAdmin)&&this.item.portal.id===this.portalUser.orgId;this.item.snippet=250<this.item.snippet.length?this.item.snippet.substring(0,250)+"\u2026":this.item.snippet;this.item.ownerText=
c.default.formatOwnerText(this.item);this.item.accessIcon=c.default.getAccessIcon(this.item.access);this.canCreateNotebooks=(null===(G=this.portalUser)||void 0===G?void 0:G.userRole.canCreateNotebooks())&&q.default.notebookServerConfigured();this.item.openIn.forEach(function(U){return l.default[U](F.item)});l.default.configureStoryMapTheme(this.item);this.item.downloadUrl="file"===this.item.classification?l.default.getItemDataUrl(this.item):"";this.item.defaultOpenUrl=this._getDefaultOpenUrl(this.item);
this.item.defaultOpenIcon=this.item.defaultOpenIcon||"launch";this.item.defaultOpenSvg=null!==(O=null===(L=h.default.inline[this.item.defaultOpenIcon])||void 0===L?void 0:L["16"])&&void 0!==O?O:h.default.inline.launch["16"];this.item.defaultOpenText=this._getDefaultOpenText(this.item);this._setDefaultThumbnail(this.item);this.cssClasses=(0,m.default)(this.item,this.portalUser);"Image"===this.item.type&&(this.isImage=!0,this.imageClass="card--image-item")};I.prototype._setDefaultThumbnail=function(F){var D;
F.thumbnailUrl=null!==(D=this.useMostRecentToken(F.thumbnailUrl))&&void 0!==D?D:"";if("Notebook"===F.type||"Notebook Code Snippets"===F.type||"Notebook Code Snippet Library"===F.type||"Geoprocessing Service"===F.type&&F.typeKeywords.includes("Notebook Web Tool"))D="".concat(a.default.baseUrl,"js/arcgisonline/css/images/").concat("Notebook"===F.type?"notebook-thumb.png":F.typeKeywords.includes("Web Tool")?"notebook-web-tool-thumb.png":"notebook-code-snippet-thumb.png"),F.thumbnailUrl=F.thumbnailUrl||
D;F.largeThumbnailUrl="".concat(F.thumbnailUrl).concat(-1<F.thumbnailUrl.search("\\?token\x3d")?"\x26":"?","w\x3d400")};I.prototype.useMostRecentToken=function(F){var D,C=this.item.portal.getPortalUser(),y=null===(D=null===C||void 0===C?void 0:C.credential)||void 0===D?void 0:D.token;return l.default.swivelToken(F,null===C||void 0===C?void 0:C.token,y)};I.prototype._getDefaultOpenText=function(F){return"Notebook"!==F.type||this.canCreateNotebooks?this.item.defaultOpenText||R.default.itemLinks.viewDetails:
R.default.itemLinks.viewDetails};I.prototype.postCreate=function(){var F=this,D,C;this.inherited(arguments);this.cssClasses.filter(function(Q){return Q}).forEach(function(Q){return F.domNode.classList.add(Q)});var y=this.item,G=this.portalUser,L=this.domNode.querySelector(".js-card-badges"),O=this.domNode.querySelector(".js-favorites-container"),U=this.domNode.querySelector(".js-open-dropdown-container"),M=this.domNode.querySelector(".js-default-open");!this.favoritesDisabled&&O&&(0,P.render)((0,P.h)(g.default,
{item:this.item}),O);U&&(O=this.addSearchTelemetryParams?"\x26fromSearch\x3dtrue\x26searchPosition\x3d".concat(this.itemIndex,"\x26searchTerm\x3d").concat(this.searchTerm,"\x26searchFacet\x3dcard%20dropdown%20item%20details"):"",x.default.place(A.default.substitute(T.default,{item:y,i18n:R.default,icons:h.default,telemetryParams:O},null,this),U),d.default.isHubType(y.type)&&U.querySelector(".js-view-link").classList.add("if-hub-and-not-blocked"));L&&r.default.createElement("arcgis-item-badges",{item:this.item,
user:this.portalUser,width:this.badgeWidth,showTooltips:!0,scale:"s"},L);if("Feature Service"===y.type||"Feature Collection"===y.type)L=this.domNode.querySelector(".js-layers-tables"),U=this.domNode.querySelector(".js-layers-tables-toggle"),L&&U&&a.default.deepLayerSearchEnabled&&r.default.createElement("arcgis-layers-and-tables-summary-popup",{item:y,layers:y.sublayers,portal:y.portal,api:3,user:G,searchTerm:this.searchTerm,config:a.default,telemetry:this.telemetry,border:!0,tooltip:this.formatDisplayName(y.displayName),
i18nNoService:R.default.publishWizard.errors.selectedServiceNotExist.message,i18nNoLayers:R.default.SelectLayersWFS.noLayers},L).appendChild(U);new v.default({item:y,portalUser:G,right:!0,canShare:this.item.canShare,allowShare:this.allowShare,showShareGroups:this.showShareGroups&&this.isWide,telemetry:this.telemetry,portal:this.item.portal},this.domNode.querySelector(".js-share-summary"));if(M){y=this.item.defaultOpenUrl;if(y===E.download||y===E.desktop||y===E.pro)M.classList.add("js-action"),M.setAttribute("data-action",
this.item.defaultOpenUrl);this.item.defaultOpenUrl===E.newMap&&(y="modern"===this.item.portal.defaultMapViewer&&this.item.canOpenInNewMapViewer?this.item.newMapViewerUrl:this.item.mapViewerUrl,M.href=y,M.setAttribute("data-href",y));(y=this.item.openIn)&&y[0]&&y[0]!==E.map&&this.item[y[0]+"Url"]&&M.setAttribute("target","_blank")}this._addEventListeners();(null===(D=this.item.portal)||void 0===D?0:D.isPortal)&&r.default.hideNodes(null===(C=this.domNode)||void 0===C?void 0:C.querySelectorAll(".js-hide-portal"))};
I.prototype.destroy=function(){this.inherited(arguments);this._popup&&this._popup.destroy()};I.prototype._getDefaultOpenUrl=function(F){var D="item.html?id\x3d"+F.id,C=F.openIn&&F.openIn[0];return F.defaultOpenText===R.default.itemLinks.openDesktop?E.desktop:F.defaultOpenText===R.default.itemLinks.openPro?E.pro:F.defaultOpenText===R.default.itemLinks.openVRExperience?F.vrExperienceUrl:!C||C!==E.notebook||this.portalUser&&this.canCreateNotebooks?C&&C!==E.map&&F[C+"Url"]?F[C+"Url"]:"download-to"===
F.defaultOpenIcon||f.default.includes(F.types,"is-pdf")?E.download:C===E.map?E.newMap:C===E.story?E.story:D:D};I.prototype._addEventListeners=function(){var F=this;this.own((0,z.default)(".js-card-select-check-mark-wrap",this.domNode).on("click",function(C){C.stopPropagation()}),(0,z.default)(".js-card-select-check-mark",this.domNode).on("change",function(C){F[C.target.checked?"_select":"_deselect"]()}),(0,z.default)(this.domNode).on("click",this._toggleSelected.bind(this)),(0,z.default)(".js-card-item-owner",
this.domNode).on("click",this._showProfile.bind(this)),(0,z.default)(".js-action",this.domNode).on("click",this._handleAction.bind(this)),J.default.subscribe("view/deselectAll",this._deselect.bind(this)),(0,z.default)(".js-card-image",this.domNode).on("error",this._cardImageError.bind(this)),(0,z.default)(".js-card-title-link",this.domNode).on("click",this._cardOpen.bind(this)),(0,z.default)(".js-item-share-dropdown",this.domNode).on("click",this._shareItemDropdown.bind(this)),(0,z.default)(".js-telemetry-overflow-menu .js-dropdown-toggle",
this.domNode).on("click",function(){return F._logTelementryEvent("more options")}),(0,z.default)(".js-telemetry-categorize",this.domNode).on("click",function(){var C,y;if(null===(C=window.location.pathname)||void 0===C?0:C.includes("content.html"))null===(y=F.telemetry)||void 0===y?void 0:y.logEvent({eventType:"other",pageName:"content",pageUrl:window.location.href,path:window.location.pathname,category:"item action",action:"categorize"})}),(0,z.default)(".js-telemetry-thumbnail-hover",this.domNode).on("mouseover",
function(){return F._logTelementryEvent("thumbnail")}),(0,z.default)(".js-telemetry-title-hover",this.domNode).on("mouseover",function(){return F._logTelementryEvent("title")}),(0,z.default)(".js-item-categorize",this.domNode).on("click",this._categorizeItem.bind(this)),this.item.watch(this._itemUpdate.bind(this)));var D=this.domNode.querySelector(".js-verified-owner-link");D&&this.own((0,B.default)(D,"click",this.showOrgPopup.bind(this)))};I.prototype._telemetryEvent=function(){var F=window.location.href,
D=window.location.hash;D=F.includes("content.html")&&(!D||D.includes("content"));var C=F.includes("gallery.html");if(D||C)return{category:"grid card action",eventType:"other",pageName:D?"my content":"gallery",pageUrl:F}};I.prototype._logTelementryEvent=function(F){var D,C=this._telemetryEvent();C&&(null===(D=this.telemetry)||void 0===D?void 0:D.logEvent(p.__assign({label:F},C)))};I.prototype._handleAction=function(F){var D=this;F.preventDefault();var C=F.currentTarget.getAttribute("data-action"),
y=this.item,G=this.portalUser,L=this.item.portal;if(C&&b.default[C])if("share"!==C||this.item.isOwner)b.default[C]({evt:F,item:y,user:G,portal:L});else this.item.getOwnerProfile(!0,!0).then(function(O){D.item.itemOwner=O;b.default.share({evt:F,item:y,user:G,portal:L})})};I.prototype._select=function(){this.domNode.classList.add("card-select-active");this.item.isSelected=!0;var F=this.domNode.querySelector(".js-card-select-check-mark");F.parentNode.setAttribute("aria-label",R.default.GroupWidget.unselectItem);
F.checked=!0;J.default.publish("view/select",this.item)};I.prototype._deselect=function(){this.domNode.classList.remove("card-select-active");this.item.isSelected=!1;var F=this.domNode.querySelector(".js-card-select-check-mark");F&&(F.parentNode.setAttribute("aria-label",R.default.GroupWidget.selectItem),F.checked=!1);J.default.publish("view/deselect",this.item)};I.prototype._toggleSelected=function(F){"ARCGIS-LAYERS-AND-TABLES-SUMMARY-POPUP"!==F.target.tagName&&this.select&&(this.domNode.classList.contains("card-select-active")?
this._deselect():this._select())};I.prototype._showProfile=function(F){F.stopPropagation();J.default.publish("profile/show",F)};I.prototype.showOrgPopup=function(F){F.stopPropagation();(new n.default({item:this.item,opener:F.target})).open()};I.prototype._cardImageError=function(F){F.preventDefault();F.target.src="js/arcgisonline/css/images/default_thumb.png"};I.prototype._cardOpen=function(F){J.default.publish("card/open",this.itemIndex,F)};I.prototype._itemUpdate=function(F,D,C){J.default.publish("item/update",
{item:this.item,name:F,oldValue:D,value:C})};I.prototype._shareItemDropdown=function(){this.domNode.querySelector(".js-item-share-dropdown").blur()};I.prototype._categorizeItem=function(){J.default.publish("item/categorize",this.item,this.domNode.querySelector(".js-dropdown-toggle"))};return I=p.__decorate([(0,t.default)(w.default,u.default)],I)}()})},"arcgisonline/pages/dijit/Card/_getItemClasses":function(){define("require exports tslib ../../utils/arrays ../../utils/organization dojo/sniff arcgisonline/pages/utils/mapViewer".split(" "),
function(e,K,p,a,g,m,n){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);K.default=function(b,c){var d,l,h,f,r=b.url||"";var q=b.isHostedService;var t=b.serviceInfo||{},w=null!==(h=null===t||void 0===t?void 0:t.capabilities)&&void 0!==h?h:"";h=null===c||void 0===c?void 0:c.userRole;r=c&&-1<r.indexOf(c.orgId);w=-1<w.indexOf("Editing");t=a.default.includes(b.typeKeywords,"Multi Services View")||t.isMultiServicesView;var u=b.isAdminView?
null===h||void 0===h?void 0:h.canUpdateOrgItems():b.canUpdate;h=q&&!t&&(u||w&&(null===h||void 0===h?void 0:h.canEditFeaturesFullControl())&&r);q=null!==(f=b.canEditService)&&void 0!==f?f:h;b.isEditableByUser=q;f=(0,m.default)("trident");q=g.default.isMobile();f=f||q;q="Scene Service"===b.type&&a.default.includes(b.typeKeywords,"Voxel");h="Web Experience"===b.type&&b.origin;t="Web Experience Template"===b.type&&b.origin;t="Dashboard"===b.type&&b.origin||h||t;h=[].concat(b.types);h.push(b.hasResources?
"has-resources":"");h.push(b.hasViewStyle?"has-viewStyle":"");h.push(b.url?"has-url":"");h.push((null===c||void 0===c?0:c.isOrgUser)&&"Form"===b.type?"is-surveyForm":"");h.push(b.portal&&!b.portal.isPortal&&(null===c||void 0===c?0:c.isOrgUser)&&"Form"===b.type?"is-surveyFormBrowser":"");h.push(b.isConfigurableApp?"can-configure":"");h.push(b.typeKeywords.includes("configurableApp")?"is-instant-apps":"");h.push(b.isEditableByUser&&"Feature Service"===b.type?"can-edit-service":"");h.push(q?"is-voxel":
"");h.push(b.isOwner?"is-owner":"");h.push(b.isAdmin?"is-admin":"");h.push((null===c||void 0===c?0:c.isOrgUser)?"":"is-public-user");h.push((null===c||void 0===c?0:c.isOrgAdmin)?"is-admin":"");h.push(b.canUpdate&&!t?"can-update":"is-viewer");h.push(a.default.includes(b.typeKeywords,"Web AppBuilder")&&b.canUpdate&&!b.origin?"can-edit-wab":"");h.push((null===c||void 0===c?0:c.isOrgUser)&&"Notebook"===b.type?"is-notebook":"");q=-1<(null===(d=b.openIn)||void 0===d?void 0:d.indexOf("mapViewer"));h.push(q&&
!f?"is-map-viewer-beta":"");h.push(c&&(null===c||void 0===c?void 0:c.defaultMapViewer)!==n.MapViewerType.Modern?"is-map-viewer-classic":"is-map-viewer-modern");["OGCFeatureServer","Media Layer","Group Layer"].includes(b.type)&&h.push("no-legacy-viewer-support");c=["OGCFeatureServer","Media Layer"].includes(b.type)||"Group Layer"===b.type&&!(null===(l=b.typeKeywords)||void 0===l?0:l.includes("Scene"));h.push(c?"is-only-map-viewer-modern":"is-multiple-map-viewer");b.addBlockClasses(h);return h}})},
"arcgisonline/pages/dijit/CardMobile":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/text!./CardMobile/CardMobile.html ../utils/formatters ./Card/_CardBase".split(" "),function(e,K,p,a,g,m,n){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);return function(){function b(c){this.templateString=g.default;this.alwaysShowDrag=this.draggable=!1}b.prototype.postMixInProperties=function(){this.inherited(arguments);this.item.ownerText=
m.default.formatOwnerText(this.item,!0)};b.prototype.postCreate=function(){this.inherited(arguments);this.draggable&&this.domNode.classList.add("card--draggable");this.alwaysShowDrag&&this.domNode.classList.add("card--show-drag")};b.prototype.setDraggable=function(c){(this.draggable=c)?this.domNode.classList.add("card--draggable"):this.domNode.classList.remove("card--draggable")};return b=p.__decorate([(0,a.default)(n.default)],b)}()})},"arcgisonline/pages/dijit/CardWide":function(){define("require exports tslib ../../tsutils/declareDecorator ./Card/_CardBase dojo/text!./CardWide/CardWide.html".split(" "),
function(e,K,p,a,g,m){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);return function(){function n(){this.isWide=!0;this.templateString=m.default;this.badgeWidth="full"}n.prototype.postCreate=function(){this.inherited(arguments)};return n=p.__decorate([(0,a.default)(g.default)],n)}()})},"arcgisonline/pages/dijit/TableRow":function(){define("require exports tslib dojo/dom-construct dojo/query dojo/string dojo/on dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin ../utils/formatters ../../esriGeowConfig ./ItemShareSummary ../utils/item ../utils/setItemUrls ../utils/icons ../utils/dom ./Card/_getItemClasses ../item/_Actions ./_CheckReadonlyMixin dojo/text!./TableRow/templates/TableRow.html dojo/text!./Card/OpenDropdown.html dojo/text!./Card/RecycleDropdown.html dojo/i18n!../../nls/arcgisonline dojo/i18n!../../nls/notebooks ../../tsutils/declareDecorator ./OrgPopup/OrgPopup preact ../components/Favorite ../content/_ContentActions".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);E=p.__importDefault(E);I=p.__importDefault(I);return function(){function F(D,C){this.template=z.default;this.i18n=J.default;this.selectTitle=l.default.selectTitle;this.moreOptionsTitle=l.default.moreOptionsTitle;this.fullDate=l.default.fullDate;this.completeDate=l.default.completeDate;this.capitalize=l.default.capitalize;this.empty=l.default.empty;this.shortenNumber=l.default.shortenNumber;
this.getAccess=l.default.getAccess;this.getAccessIcon=l.default.getAccessIcon;this.formatRecycleTimeRemaining=l.default.formatRecycleTimeRemaining;this.show=l.default.show;this.hide=l.default.hide;this.icons=t.default;this.cssClasses=[];this.dropdownClass=this.removedRow=this.activeRow=this.selectClass=this.checked="";this.recordSelection=this.favoritesDisabled=this.showShareGroups=this.hasSharedOwnershipGroups=this.showSource=this.fullItemTypes=this.isRemoved=this.isSelected=this.select=this.isUserRecycle=
this.isRecycle=!1}F.prototype.postMixInProperties=function(){var D=this,C,y;this.inherited(arguments);this.formatDisplayName=l.default.formatDisplayName.bind(this,this.item,this.fullItemTypes);this.templateString=this.template||z.default;this.i18n.notebookLanding=P.default.notebookLanding;this.i18n.notebookViewer=P.default.notebookViewer;this.i18n.notebookServerManager=P.default.notebookServerManager;this.checked=this.isSelected?"checked":"";this.selectClass=this.select?"":"hide";this.activeRow=this.isSelected?
"table-select-row-active":"";this.removedRow=this.isRemoved?"table-select-row-removed":"";this.dropdownClass=2<this.itemIndex?"dropdown-up":"";if(null===(C=this.item)||void 0===C?0:C.classification)this.favoritesDisabled=!this.portalUser,this.item.openIn.forEach(function(G){return q.default[G](D.item)}),this.item.premiumClass=this.item.isPremium?"":"hide",this.cssClasses=(0,u.default)(this.item,this.portalUser),this.item.isAdmin=this.item.isAdmin||(null===(y=this.portalUser)||void 0===y?void 0:y.isOrgAdmin)&&
this.item.portal.id===this.portalUser.orgId,this.item.canShare=this.allowShare&&r.default.canShareItem(this.item,this.portalUser),this.item.ownerText=l.default.formatOwnerText(this.item);this.isRecycle="recycle"===this.item.folderId;this.isUserRecycle="recycle"===this.options.folder};F.prototype.postCreate=function(){var D=this,C,y,G,L;this.inherited(arguments);this.cssClasses&&this.cssClasses.forEach(function(Y){return Y&&D.domNode.classList.add(Y)});!this.favoritesDisabled&&0<(0,g.default)(".js-favorites-container",
this.domNode).length&&(this.favorite=(0,T.render)((0,T.h)(E.default,{item:this.item}),this.domNode.querySelector(".js-favorites-container")));this.isUserRecycle&&w.default.hideNodes(this.domNode.querySelectorAll(".js-recycle-owner"));if(0<(0,g.default)(".js-open-dropdown-container",this.domNode).length){var O=this.domNode.querySelector(".js-open-dropdown-container"),U=m.default.substitute(this.isRecycle?B.default:A.default,{item:this.item,i18n:J.default,icons:t.default},null,this);a.default.place(U,
O);r.default.isHubType(this.item.type)&&O.querySelector(".js-view-link").classList.add("if-hub-and-not-blocked");(null===(C=this.item.portal)||void 0===C?0:C.isPortal)&&w.default.hideNodes(O.querySelectorAll(".js-hide-portal"))}(C=this.domNode.querySelector(".js-badges"))&&w.default.createElement("arcgis-item-badges",{item:this.item,user:this.portalUser,width:"narrow",showTooltips:!0,scale:"s"},C);C=this.item;O=this.portalUser;U=this.allowShare;var M=this.telemetry,Q=this.showShareGroups;(null===
(y=this.item)||void 0===y?0:y.classification)&&new f.default({item:C,portalUser:O,showShareGroups:Q,allowShare:U,telemetry:M,portal:this.portal},this.domNode.querySelector(".js-share-summary"));if("Feature Service"===C.type||"Feature Collection"===C.type)y=this.domNode.querySelector(".js-layers-tables"),U=this.domNode.querySelector(".js-layers-tables-toggle"),y&&U&&h.default.deepLayerSearchEnabled&&w.default.createElement("arcgis-layers-and-tables-summary-popup",{item:C,layers:C.sublayers,portal:C.portal,
api:3,user:O,searchTerm:this.searchTerm,config:h.default,telemetry:this.telemetry,tooltip:this.formatDisplayName(C.displayName),i18nNoService:J.default.publishWizard.errors.selectedServiceNotExist.message,i18nNoLayers:J.default.SelectLayersWFS.noLayers},y).appendChild(U);this._addEventListeners();y=this.domNode.querySelector(".js-table-select-checkbox");C=J.default.filters.selectLabel.replace("${itemName}",null!==(L=null===(G=this.item)||void 0===G?void 0:G.name)&&void 0!==L?L:"");null===y||void 0===
y?void 0:y.setAttribute("aria-label",C)};F.prototype.destroy=function(){this.inherited(arguments);this._popup&&this._popup.destroy();this.favorite&&(0,T.render)(null,this.domNode.querySelector(".js-favorites-container"),this.favorite)};F.prototype._addEventListeners=function(){var D=this,C;this.own((0,g.default)(".js-table-select-checkbox",this.domNode).on("change",this._toggleSelected.bind(this)),(0,g.default)(".js-card-item-owner",this.domNode).on("click",this._showProfile.bind(this)),(0,g.default)(".js-action",
this.domNode).on("click",this._handleAction.bind(this)),(0,g.default)(".js-item-share-dropdown",this.domNode).on("click",this._shareItemDropdown.bind(this)),(0,g.default)(".js-item-categorize",this.domNode).on("click",this._categorizeItem.bind(this)),(0,g.default)(".js-telemetry-categorize",this.domNode).on("click",function(){var G,L;if(null===(G=window.location.pathname)||void 0===G?0:G.includes("content.html"))null===(L=D.telemetry)||void 0===L?void 0:L.logEvent({eventType:"other",pageName:"content",
pageUrl:window.location.href,path:window.location.pathname,category:"item action",action:"categorize"})}),(0,g.default)(".js-item-restore",this.domNode).on("click",this._restoreItem.bind(this)),(0,g.default)(".js-inline-restore-container",this.domNode).on("click",this._restoreItem.bind(this)),(0,g.default)(".js-item-permanently-delete",this.domNode).on("click",this._permanentlyDeleteItem.bind(this)),(0,g.default)(".js-inline-permanently-delete-container",this.domNode).on("click",this._permanentlyDeleteItem.bind(this)),
b.default.subscribe("view/deselectAll",this._deselect.bind(this)),b.default.subscribe("view/items/".concat(this.item.id,"/deselect"),this._deselect.bind(this)));var y=this.domNode.querySelector(".js-verified-owner-link");y&&this.own((0,n.default)(y,"click",this.showOrgPopup.bind(this)));(null===(C=this.item)||void 0===C?0:C.watch)&&this.own(this.item.watch(this._itemUpdate.bind(this)))};F.prototype._handleAction=function(D){var C=this;D.preventDefault();var y=D.target.getAttribute("data-action");
if(y&&v.default[y]&&("share"!==y||!this.checkReadonly(this.item.portal))){var G={evt:D,item:this.item,user:this.portalUser,portal:this.item.portal,telemetry:this.telemetry};if("share"!==y||this.item.isOwner)v.default[y](G);else this.item.getOwnerProfile(!0,!0).then(function(L){C.item.itemOwner=L;v.default.share(G)})}};F.prototype.selectItem=function(){this.domNode.classList.add("table-select-row-active");this.item.isSelected=!0;this.domNode.querySelector(".js-table-select-checkbox").checked=!0};F.prototype._select=
function(){this.selectItem();b.default.publish("view/select",this.item)};F.prototype._deselect=function(){this.domNode.classList.remove("table-select-row-active");this.item.isSelected=!1;this.domNode.querySelector(".js-table-select-checkbox").checked=!1;b.default.publish("view/deselect",this.item)};F.prototype._toggleSelected=function(){var D;if(this.domNode.classList.contains("table-select-row-active")){var C="Unselect row";this._deselect()}else C="Select row",this._select();this.recordSelection&&
(null===(D=this.telemetry)||void 0===D?void 0:D.logEvent({category:"Select",action:C,count:1}))};F.prototype._itemUpdate=function(D,C,y){b.default.publish("item/update",{item:this.item,name:D,oldValue:C,value:y})};F.prototype._showProfile=function(D){b.default.publish("profile/show",D)};F.prototype.showOrgPopup=function(D){D.stopPropagation();(new S.default({item:this.item,opener:D.target})).open()};F.prototype._shareItemDropdown=function(D){this.domNode.querySelector(".js-item-share-dropdown").blur()};
F.prototype._categorizeItem=function(D){b.default.publish("item/categorize",this.item,this.domNode.querySelector(".js-dropdown-toggle"))};F.prototype._restoreItem=function(){var D,C=null!==(D=this.portal)&&void 0!==D?D:this.item.portal;I.default.restoreItems({selectedItems:[this.item],portal:C})};F.prototype._permanentlyDeleteItem=function(){var D,C=null!==(D=this.portal)&&void 0!==D?D:this.item.portal;I.default.permanentlyDeleteItems({selectedItems:[this.item],portal:C})};return F=p.__decorate([(0,R.default)(c.default,
d.default,x.default)],F)}()})},"arcgisonline/pages/content/_ContentActions":function(){define("require exports tslib dijit/Dialog dojo/query dojo/on dojo/string dojo/dom-attr dojo/topic dojo/promise/all dojo/dom-construct ../../esriGeowConfig ../utils/item ../utils/alerts ../utils/culture ../utils/storage ../item/_Actions ../utils/channels ../../sharing/dijit/dialog/AddItemDlg ../../sharing/dijit/dialog/CreateAppDlg ../../sharing/dijit/dialog/PublishWizard ../../sharing/dijit/dialog/CreateFolder ../../sharing/dijit/dialog/CreateGeolocatorDlg ../../sharing/dijit/dialog/ConnectDataset ../../sharing/dijit/dialog/AddDatastoreDlg ../../sharing/dijit/dialog/CreateNotebookDlg ../../pages/dijit/CreateImageryContent ../../pages/dijit/CreateRasterFunctionTemplate preact ../components/RestoreItems ../components/DeleteItems ../components/ConfirmDialog dojo/i18n!../../nls/arcgisonline ../utils/dom".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);B=p.__importDefault(B);
J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);D=p.__importDefault(D);C=p.__importDefault(C);y=p.__importDefault(y);return function(){function G(){}G.add=function(L,O){var U,M=L.page;L=M.portal;M=M.telemetry;var Q=L.getPortalUser(),Y=Q.canUserPublish,fa=(null===(U=O.target)||void 0===U?void 0:U.dataset)||{};U=fa.action;O=fa.label;var va=fa.title,Aa=fa.message,pa=null!==U&&void 0!==U?U:"";fa=Q.getCurrentFolder();var N=document.getElementById("add-dropdown");
if(U)if(O&&(null===M||void 0===M?void 0:M.logEvent({label:O,category:"add",eventType:"new item click",pageName:"my content"})),-1<pa.indexOf("connectDataset"))M=new J.default({label:O,telemetry:M}),M.startup(L,fa),M.showModal("true");else if(-1<pa.indexOf("datastore"))(new P.default({portal:L,portalUser:Q})).startup();else{var V=new v.default({id:"addItem_dlg",folder:fa&&fa.id!==Q.username&&"all"!==fa.id?fa.id:"/",allowPublish:Y,selected:U,label:O,telemetry:M,message:Aa});V.showModal({title:va});
m.default.once(V.dialog,"hide",function(){V.dialog.destroyRecursive();null===N||void 0===N?void 0:N.focus()})}};G.create=function(L,O){var U,M,Q,Y,fa=(null===(U=O.target)||void 0===U?void 0:U.dataset)||{};U=fa.action;fa=fa.label;var va=null===(M=L.page)||void 0===M?void 0:M.telemetry;if(U.length&&(fa&&(null===va||void 0===va?void 0:va.logEvent({label:fa,category:"create apps",eventType:"new item click",pageName:"my content"})),!(-1<U.indexOf("dashboard")||-1<U.indexOf("instantapps")||-1<U.indexOf("geobim")))){if(-1<
U.indexOf("app"))return this.createApp(L,O);if(-1<U.indexOf("publish"))return this.publishItem(L,O);if("geolocator"===U)return this.createGeolocator(L,O);if(-1<U.indexOf("notebook"))return this.createNotebook(L,O);if(-1<U.indexOf("storymaps"))return window.open(h.default.storymapsUrl+"/stories/new","_blank");if(-1<U.indexOf("sites")){if(L.page.portal.isPortal)return window.open("".concat(location.protocol,"//").concat(h.default.portalHostname,"/apps/sites/#/home/edit/new"),"_blank");L=h.default.openDataUrl.replace("http://",
"".concat(h.default.urlKey,".")).replace("https://","".concat(h.default.urlKey,"."));return window.open("https://".concat(L.replace("admin","edit"),"new"),"_blank")}return-1<U.indexOf("experience")?window.open(h.default.webExperienceUrl,"_blank"):-1<U.indexOf("urban")?null!==(Y=null===(Q=null===L||void 0===L?void 0:L.page)||void 0===Q?void 0:Q.portalUser)&&void 0!==Y&&Y.canPublishFeatures?window.open("".concat(h.default.urbanUrl,"/new-model-setup"),"_blank"):r.default.showAlert("error",C.default.items.urbanModelPermissionsError):
this.createItem(L,O)}};G.createApp=function(L,O){var U=L.page,M=U.portal;O=O.target.dataset;var Q=O.title,Y=O.message;(new x.default({item:L.item,label:O.label,telemetry:null===U||void 0===U?void 0:U.telemetry,action:O.action})).showWizard({title:Q,message:Y,portal:M})};G.createItem=function(L,O){var U=L.page,M=U.portal,Q=O.target.dataset,Y=Q.action;O=Q.title;var fa=Q.message,va=Q.type;U=new x.default({item:L.item,label:Q.label,telemetry:null===U||void 0===U?void 0:U.telemetry,action:Y});va=va||Y.split("-")[1];
L=L.isWAB||-1<Y.indexOf("wab");L={typeInfo:va,title:O,message:fa,isWAB:L,portal:M};"webscene"===va&&M.isPortal&&(L.typeInfo="webscene_portal");U.showCreateDefaultItem(L)};G.createNotebook=function(L,O){O=L.page.portal;L=L.page.telemetry;var U=O.getPortalUser();(new R.default({portal:O,portalUser:U,telemetry:L})).startup()};G.createGeolocator=function(L,O){var U,M=b.default.get(O.target,"data-title");O=b.default.get(O.target,"data-message");(new B.default({telemetry:null===(U=L.page)||void 0===U?void 0:
U.telemetry})).showModal({title:M,message:O})};G.publishImageryItem=function(L,O){var U=this,M,Q,Y=L.page.portal.getPortalUser();L=null===(M=L.page)||void 0===M?void 0:M.telemetry;M=Y.getCurrentFolder();M=(null===M||void 0===M?0:M.isHome)?"":null!==(Q=null===M||void 0===M?void 0:M.id)&&void 0!==Q?Q:"";this._CreateImageryContentOverlay=new S.default({onClose:function(){U._CreateImageryContentOverlay.scratchFolderId&&(Y.deleteFolder(U._CreateImageryContentOverlay.scratchFolderId),U._CreateImageryContentOverlay=
null)},folderId:M,telemetry:L},l.default.place(l.default.create("div"),document.body,"last"));this._CreateImageryContentOverlay.open()};G.createRasterFunctionTemplate=function(L,O){L=L.page.portal.getPortalUser();this._CreateRasterFunctionTemplateOverlay=new T.default({portalUser:L},l.default.place(l.default.create("div"),document.body,"last"));this._CreateRasterFunctionTemplateOverlay.open()};G.publishItem=function(L,O){var U,M=L.page,Q=null===M||void 0===M?void 0:M.telemetry,Y=((null===(U=O.target)||
void 0===U?void 0:U.dataset)||{}).action;U=M.portal;U=!U.isPortal&&U.subscriptionInfo||{state:"active"};var fa=Y.split("-")[1];Y="features"===fa?"esriFeatureLayers":"esriTileLayers";if("active"===U.state){if("imagery"===fa)return this.publishImageryItem(L,O);var va=new z.default({class:"".concat(Y," esriPublishWizardNode tabs-transparent"),itemType:fa});var Aa=new a.default({title:"features"===fa?C.default.items.newFeatureLayerTitle:C.default.items.newTileLayerTitle,content:va.domNode,class:"esriPublishingWizardDlg esriPublishingWizardDlg--content"});
(0,m.default)(Aa,"hide",function(){var pa;va.destroy();Aa.destroyRecursive();null===(pa=document.getElementById("create-dropdown"))||void 0===pa?void 0:pa.focus()});(0,m.default)(va,"cancel",function(){Aa.hide().then(function(){return!1})});(0,m.default)(va,"done",function(pa,N){var V;(function(Z){Z.features="feature layer";Z.imagery="imagery layer";Z.tiles="tile layer"})(V||(V={}));N=p.__assign({label:"new item",category:"new item",pageName:"my content",details:V[fa]},N&&{attribute:N});null===Q||
void 0===Q?void 0:Q.logEvent(N);Aa.hide().then(function(){var Z=null===pa||void 0===pa?void 0:pa.id;Z&&setTimeout(function(){window.location.href="item.html?id\x3d".concat(Z).concat("tiles"===fa?"#settings/manageTiles":"")},400)})});(0,g.default)(".dojoxWizardButtons",Aa.domNode).addClass("esriFloatTrailing");Aa.show().then(function(){Aa.closeButtonNode.tabIndex=0})}};G.bulkAction=function(L,O){var U,M=null!==(U=L.action)&&void 0!==U?U:b.default.get(O.target,"data-action");if(M&&this[M])this[M](L,
O)};G.share=function(L,O){var U=L.page,M=U.telemetry,Q=U.portal.getPortalUser(),Y=L.selectedItems,fa,va={user:Q,items:Y,item:1===Y.length?Y[0]:null,folder:L.folder||"/",noRedirect:!0,telemetry:M};(0,d.default)(Y.map(function(Aa){return Aa.getOwnerProfile()})).then(function(Aa){var pa=Y[0].access;Y.forEach(function(N,V){N.access!==pa&&(pa="mixed");fa=N.isAdmin||Q.isOrgAdmin&&Aa[V].orgId===Q.orgId;N=N=p.__assign(p.__assign({},N),{isAdmin:fa,canUpdate:fa})});M&&(va.telemetryWorkflow=M.startWorkflow("share",
{details:pa,pageUrl:window.location.href,pagename:"content",count:Y.length}));w.default.share(va,O)})};G.shareOwnership=function(L){var O=L.selectedItems;w.default.shareOwnership({user:L.portalUser||L.page.portalUser,items:O,item:1===O.length?O[0]:null,folder:L.folder||"/",noRedirect:!0,portal:L.page.portal})};G.changeOwner=function(L){var O,U,M=L.page,Q=M.portal,Y=null!==(O=L.currentFolder)&&void 0!==O?O:"";O=null!==(U=L.portalUser)&&void 0!==U?U:Q.getPortalUser();L=L.selectedItems;w.default.reassignItem({owner:O,
items:L,portal:Q,item:1===L.length?L[0]:null,folder:Y,noRedirect:!0,dontRemoveFromList:"organization"===M._currentView,page:M})};G.move=function(L){w.default.moveItem(L)};G.restoreItems=function(L){var O=this,U,M,Q,Y=null!==(U=L.portal)&&void 0!==U?U:null===(M=L.page)||void 0===M?void 0:M.portal,fa=null===(Q=L.page)||void 0===Q?void 0:Q._currentView,va=function(pa,N){return p.__awaiter(O,void 0,void 0,function(){var V,Z,ba,ma;return p.__generator(this,function(sa){V=1<pa.length;Z=pa[0];ba=N.id===
Z.owner;V?(ma=q.default.getString(C.default.itemProperties.itemsRestore,pa.length,{folder:'\x3ccalcite-icon class\x3d"margin-right-quarter" icon\x3d'.concat(ba?"home":"folder",' scale\x3d"s"\x3e\x3c/calcite-icon\x3e ').concat(N.title)}),r.default.showAlert("success",ma,{cssClasses:"inline-flex",textIncludesHTML:!0},"","content"===fa&&{title:C.default.itemProperties.goToFolder,onclick:function(){c.default.publish("folders/refreshAndSelect",N)}})):(ma=q.default.getString(C.default.itemProperties.itemsRestore,
pa.length,{item:Z.title,folder:'\x3ccalcite-icon class\x3d"margin-right-quarter" icon\x3d'.concat(ba?"home":"folder",' scale\x3d"s"\x3e\x3c/calcite-icon\x3e ').concat(N.title)}),r.default.showAlert("success",ma,{cssClasses:"inline-flex",textIncludesHTML:!0},"",{title:C.default.itemLinks.viewDetails,href:"./item.html?id\x3d".concat(Z.id)}));return[2]})})},Aa=l.default.create("div",null,document.body,"last");(0,E.render)((0,E.h)(I.RestoreItems,{items:L.selectedItems,portal:Y,onCancel:function(){y.default.removeComponent(Aa,
document.body);c.default.publish("folders/refresh")},onSubmit:function(pa,N,V){return p.__awaiter(O,void 0,void 0,function(){var Z,ba,ma,sa,Ea,ya,wa,aa=this,ca,ka;return p.__generator(this,function(qa){switch(qa.label){case 0:return[4,f.default.restoreItems(pa,V)];case 1:return Z=qa.sent(),[4,f.default.restoreItems(N,V)];case 2:return ba=qa.sent(),ma=p.__spreadArray(p.__spreadArray([],Z.restored,!0),ba.restored,!0),sa=p.__spreadArray(p.__spreadArray([],Z.errors,!0),ba.errors,!0),Ea=null!==(ca=null===
Z||void 0===Z?void 0:Z.destinationFolder)&&void 0!==ca?ca:null===ba||void 0===ba?void 0:ba.destinationFolder,ma.length&&(ya=null!==(ka=t.default.getCookie("ESRI_Content",!0))&&void 0!==ka?ka:{},ya.defaultRestoreFolderId=Ea.id,t.default.setCookie("ESRI_Content",ya,{path:"/"},!0),c.default.publish("items/refresh"),wa=c.default.subscribe("items/refreshComplete",function(){return p.__awaiter(aa,void 0,void 0,function(){return p.__generator(this,function(da){switch(da.label){case 0:return wa.remove(),
c.default.publish("view/deselectAll"),c.default.publish("aggregations/refresh"),sa.length?[3,3]:[3,1];case 1:return[4,va(p.__spreadArray(p.__spreadArray([],pa,!0),N,!0),V)];case 2:da.sent(),da.label=3;case 3:return[2]}})})})),y.default.removeComponent(Aa,document.body),c.default.publish("folders/refresh"),(0,u.broadcastRecyleUpdate)(),[2]}})})}}),Aa)};G.permanentlyDeleteItems=function(L){var O,U,M=l.default.create("div",null,document.body,"last"),Q=null!==(O=L.portal)&&void 0!==O?O:null===(U=L.page)||
void 0===U?void 0:U.portal;(0,E.render)((0,E.h)(F.DeleteItems,{items:L.selectedItems,portal:Q,onCancel:function(){y.default.removeComponent(M,document.body)},onSubmit:function(fa){f.default.deleteItems(fa,!0).then(function(va){var Aa=va.removed,pa=va.errors;y.default.removeComponent(M,document.body);if(Aa.length){c.default.publish("items/refresh",{removedItems:Aa});(0,u.broadcastRecyleUpdate)();var N=c.default.subscribe("items/refreshComplete",function(){N.remove();c.default.publish("view/deselectAll");
c.default.publish("aggregations/refresh");if(pa.length)Y(pa);else{var V=q.default.getString(C.default.itemProperties.itemsPermanentDelete,fa.length);c.default.publish("alert/show",{type:"success",text:V})}})}else Y(pa)})},inRecycleBin:!0,recycleEnabled:!!Q.recycleBinEnabled}),M);var Y=function(fa){var va=fa.filter(function(pa){return"CONT_00481"===pa.messageCode}),Aa=fa.filter(function(pa){return"uninstallFail"===pa.messageCode});0===fa.filter(function(pa){return!pa.messageCode}).concat(va).length&&
Aa.length?c.default.publish("alert/show",{type:"error",text:C.default.itemProperties.bulkDeepLearningPkgDeletionFailure}):c.default.publish("alert/show",{type:"error",text:C.default.itemProperties.deleteBulkItems})}};G.deleteItems=function(L){var O=this,U=L.page.portal.recycleBinEnabled,M=l.default.create("div",null,document.body,"last");(0,E.render)((0,E.h)(F.DeleteItems,{items:L.selectedItems,portal:L.page.portal,onCancel:function(){y.default.removeComponent(M,document.body)},onSubmit:function(Y,
fa){return p.__awaiter(O,void 0,void 0,function(){var va,Aa,pa,N,V,Z,ba,ma;return p.__generator(this,function(sa){switch(sa.label){case 0:return[4,Promise.all([f.default.deleteItems(Y,!1),f.default.deleteItems(fa,!0)])];case 1:return pa=sa.sent(),N=pa[0],V=pa[1],va=p.__spreadArray(p.__spreadArray([],N.removed,!0),V.removed,!0),Aa=p.__spreadArray(p.__spreadArray([],N.errors,!0),V.errors,!0),Z=va,ba=Aa,y.default.removeComponent(M,document.body),Z.length?(c.default.publish("items/refresh",{removedItems:Z}),
(0,u.broadcastRecyleUpdate)()):Q(ba),ma=c.default.subscribe("items/refreshComplete",function(){ma.remove();c.default.publish("view/deselectAll");c.default.publish("aggregations/refresh");if(ba.length)Q(ba);else{var Ea=N.removed;var ya=V.removed;Ea=U?0<Ea.length&&0<ya.length?C.default.itemProperties.itemsMixedDelete:0<Ea.length?q.default.getString(C.default.itemProperties.itemsRecycle,Ea.length):0<ya.length?q.default.getString(C.default.itemProperties.itemsPermanentDelete,ya.length):q.default.getString(C.default.itemProperties.itemsDelete,
Ea.length):q.default.getString(C.default.itemProperties.itemsDelete,Ea.length);c.default.publish("alert/show",{type:"success",text:Ea})}}),[2]}})})},recycleEnabled:U}),M);var Q=function(Y){var fa=Y.filter(function(Aa){return"CONT_00481"===Aa.messageCode}),va=Y.filter(function(Aa){return"uninstallFail"===Aa.messageCode});0===Y.filter(function(Aa){return!Aa.messageCode}).concat(fa).length&&va.length?c.default.publish("alert/show",{type:"error",text:C.default.itemProperties.bulkDeepLearningPkgDeletionFailure}):
c.default.publish("alert/show",{type:"error",text:C.default.itemProperties.deleteBulkItems})}};G.createFolder=function(L){L=new A.default({portalUser:L.user});L.startup();L.showModal().then(function(O){c.default.publish("folders/refreshAndSelect",O)})};G.deleteFolderWithRecycle=function(L){return p.__awaiter(this,void 0,void 0,function(){var O,U,M,Q,Y,fa,va,Aa,pa,N,V=this;return p.__generator(this,function(Z){switch(Z.label){case 0:return O=L.user,U=O.portal,M=U.recycleBinEnabled,Q=L.folder,Y=O.getCurrentFolder(),
fa=l.default.create("div",null,document.body,"last"),va={q:"ownerfolder:"+Q.id,num:100},[4,U.queryItems(va)];case 1:Aa=Z.sent();pa=null===Aa||void 0===Aa?void 0:Aa.total;if(0===pa)return(0,E.render)((0,E.h)(D.default,{renderHtmlDescription:!0,strings:{title:C.default.common.deleteLabel,ok:C.default.common.deleteLabel,cancel:C.default.common.cancel,description:C.default.folders.deleteMessage.replace("${label}",Q.title),close:C.default.common.close,processing:C.default.folderDlg.deletingFolder},onCancel:function(){y.default.removeComponent(fa,
document.body)},onOk:function(){O.deleteFolder(Q.id).then(function(){Y.id===Q.id&&(O.setCurrentFolder(O.username),c.default.publish("folder/select",{}));c.default.publish("folders/refresh");r.default.showAlert("success",n.default.substitute(C.default.folderDlg.deleteFolder,[Q.title]));y.default.removeComponent(fa,document.body)},function(){c.default.publish("items/refresh");c.default.publish("alert/show",{type:"error",text:C.default.common.errors.deleteProtectedItemsInFolder});y.default.removeComponent(fa,
document.body)})},okColor:"red"}),fa),[2];(0,E.render)((0,E.h)(F.DeleteItems,{items:Aa.items,portal:U,onCancel:function(){y.default.removeComponent(fa,document.body)},onSubmit:function(ba,ma){return p.__awaiter(V,void 0,void 0,function(){var sa,Ea,ya,wa,aa,ca,ka,qa,da;return p.__generator(this,function(ia){switch(ia.label){case 0:return[4,Promise.all([f.default.deleteItems(ba,!1),f.default.deleteItems(ma,!0)])];case 1:return ya=ia.sent(),wa=ya[0],aa=ya[1],sa=p.__spreadArray(p.__spreadArray([],wa.removed,
!0),aa.removed,!0),Ea=p.__spreadArray(p.__spreadArray([],wa.errors,!0),aa.errors,!0),ca=sa,ka=Ea,(qa=Aa.items.length===wa.removed.length+aa.removed.length)?[4,O.deleteFolder(Q.id)]:[3,3];case 2:return ia.sent(),Y.id===Q.id&&(O.setCurrentFolder(O.username),c.default.publish("folder/select",{}),(0,u.broadcastRecyleUpdate)()),c.default.publish("folders/refresh"),r.default.showAlert("success",n.default.substitute(C.default.folderDlg.deleteFolder,[Q.title])),[3,4];case 3:ca.length?(c.default.publish("items/refresh",
{removedItems:ca}),(0,u.broadcastRecyleUpdate)()):N(ka),da=c.default.subscribe("items/refreshComplete",function(){da.remove();c.default.publish("view/deselectAll");c.default.publish("aggregations/refresh");ka.length?N(ka):c.default.publish("alert/show",{type:"error",text:C.default.common.errors.deleteProtectedItemsInFolder})}),ia.label=4;case 4:return y.default.removeComponent(fa,document.body),[2]}})})},recycleEnabled:M,folder:Q}),fa);N=function(ba){var ma=ba.filter(function(Ea){return"CONT_00481"===
Ea.messageCode}),sa=ba.filter(function(Ea){return"uninstallFail"===Ea.messageCode});0===ba.filter(function(Ea){return!Ea.messageCode}).concat(ma).length&&sa.length?c.default.publish("alert/show",{type:"error",text:C.default.itemProperties.bulkDeepLearningPkgDeletionFailure}):c.default.publish("alert/show",{type:"error",text:C.default.itemProperties.deleteBulkItems})};return[2]}})})};G.deleteFolder=function(L){var O=L.user,U=O.portal,M=L.folder,Q=O.getCurrentFolder();U.queryItems({q:"ownerfolder:"+
M.id,num:1}).then(function(Y){Y=null===Y||void 0===Y?void 0:Y.total;var fa={label:M.title,numItems:Y};Y=Y?q.default.getString(C.default.folders.deleteFolderWithItems,Y,fa):n.default.substitute(C.default.folders.deleteMessage,fa);var va=l.default.create("div",null,document.body,"last");(0,E.render)((0,E.h)(D.default,{renderHtmlDescription:!0,strings:{title:C.default.common.deleteLabel,ok:C.default.common.deleteLabel,cancel:C.default.common.cancel,description:Y,close:C.default.common.close,processing:C.default.folderDlg.deletingFolder},
onCancel:function(){y.default.removeComponent(va,document.body)},onOk:function(){O.deleteFolder(M.id).then(function(){Q.id===M.id&&(O.setCurrentFolder(O.username),c.default.publish("folder/select",{}));c.default.publish("folders/refresh");r.default.showAlert("success",n.default.substitute(C.default.folderDlg.deleteFolder,[M.title]));y.default.removeComponent(va,document.body)},function(){c.default.publish("items/refresh");c.default.publish("alert/show",{type:"error",text:C.default.common.errors.deleteProtectedItemsInFolder});
y.default.removeComponent(va,document.body)})},okColor:"red"}),va)})};return G}()})},"arcgisonline/sharing/dijit/dialog/AddItemDlg":function(){define(["dojo","dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/form/Form,dojox/form/Manager,dijit/form/Select,dijit/form/Button,dojox/validate/regexp,dojox/widget/Standby,dojo/i18n,dojo/string,dojo/topic,dojo/promise/all,esri/layers/wms,esri/layers/KMLLayer,esri/layers/WFSLayer,esri/layers/WMTSLayer,arcgisonline/pages/pageUtil,arcgisonline/pages/utils/categories,arcgisonline/pages/utils/dom,arcgisonline/pages/dijit/CategoryPicker,arcgisonline/pages/utils/notebook,arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/_AddItemDlgMixin,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/HelpManager,esri/IdentityManager,arcgisonline/sharing/dijit/ServiceInfo,esri/dijit/Tags,arcgisonline/sharing/dijit/_TimezoneUtils,arcgisonline/sharing/dijit/dialog/getWFSConfig,arcgisonline/sharing/dijit/dialog/getWMTSConfig,arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin,arcgisonline/map/thumbnail/buildThumbnailURLFromKMLItem,arcgisonline/map/thumbnail/buildThumbnailURLFromFSUrl,arcgisonline/map/thumbnail/buildThumbnailURLFromWFSItem,arcgisonline/map/thumbnail/buildThumbnailURLFromWMTSItem,arcgisonline/map/core/buildExportCall,arcgisonline/map/core/projectExtent,arcgisonline/map/core/sameSpatialReference,arcgisonline/sharing/geow/Item,arcgisonline/pages/dijit/InfoTooltip,arcgisonline/pages/dijit/UploadProgressBar,arcgisonline/sharing/dijit/dialog/_PublishImageCollection"],
function(e,K,p){e.provide("arcgisonline.sharing.dijit.dialog.AddItemDlg");e.require("dijit.form.Form");e.require("dojox.form.Manager");e.require("dijit.form.Select");e.require("dijit.form.Button");e.require("dojox.validate.regexp");e.require("dojox.widget.Standby");e.require("dojo.i18n");e.require("dojo.string");e.require("dojo.topic");e.require("dojo.promise.all");e.requireLocalization("arcgisonline","arcgisonline");e.require("esri.layers.wms");e.require("esri.layers.KMLLayer");e.require("esri.layers.WFSLayer");
e.require("esri.layers.WMTSLayer");e.require("arcgisonline.pages.pageUtil");e.require("arcgisonline.pages.utils.categories");e.require("arcgisonline.pages.utils.dom");e.require("arcgisonline.pages.dijit.CategoryPicker");e.require("arcgisonline.pages.utils.notebook");e.require("arcgisonline.sharing.util");e.require("arcgisonline.sharing.dijit.dialog._AddItemDlgMixin");e.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");e.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");e.require("arcgisonline.sharing.dijit.HelpManager");
e.require("esri.IdentityManager");e.require("arcgisonline.sharing.dijit.ServiceInfo");e.require("esri.dijit.Tags");e.require("arcgisonline.sharing.dijit._TimezoneUtils");e.require("arcgisonline.sharing.dijit.dialog.getWFSConfig");e.require("arcgisonline.sharing.dijit.dialog.getWMTSConfig");e.require("arcgisonline.sharing.dijit.dialog._CreateItemUtilMixin");e.require("arcgisonline.map.thumbnail.buildThumbnailURLFromKMLItem");e.require("arcgisonline.map.thumbnail.buildThumbnailURLFromFSUrl");e.require("arcgisonline.map.thumbnail.buildThumbnailURLFromWFSItem");
e.require("arcgisonline.map.thumbnail.buildThumbnailURLFromWMTSItem");e.require("arcgisonline.map.core.buildExportCall");e.require("arcgisonline.map.core.projectExtent");e.require("arcgisonline.map.core.sameSpatialReference");e.require("arcgisonline.sharing.geow.Item");e.require("arcgisonline.pages.dijit.InfoTooltip");e.require("arcgisonline.pages.dijit.UploadProgressBar");e.require("arcgisonline.sharing.dijit.dialog._PublishImageCollection");e.declare("arcgisonline.sharing.dijit.dialog.AddItemDlg",
[K.form.Form,K._WidgetsInTemplateMixin,p.form.manager._Mixin,p.form.manager._NodeMixin,p.form.manager._EnableMixin,p.form.manager._ValueMixin,p.form.manager._DisplayMixin,p.form.manager._ClassMixin,arcgisonline.sharing.dijit.dialog._AddItemDlgMixin],{templateString:e.cache("arcgisonline.sharing.dijit.dialog","templates/AddItemDlg.html",'\x3cform data-dojo-attach-point\x3d"containerNode" enctype\x3d"multipart/form-data" action\x3d"" method\x3d"POST" autocomplete\x3d"off"  data-dojo-attach-event\x3d"onsubmit:onSubmit"\x3e\r\n\x3cdiv data-dojo-attach-point\x3d"formNode" class\x3d"esriItemLinks dijitDialogPaneContentArea"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_instructions" class\x3d"addNew"\x3e${i18n.instructions}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_publishInstructions" class\x3d"publishOld trailer-half" style\x3d"display:none;"\x3e${i18n.publishInstructions}\x3c/div\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv class\x3d"addNew trailer-half"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"addItemLbl" for\x3d"itemType"\x3e${i18n.itemType}\x3c/label\x3e\r\n        \x3cselect id\x3d"itemType" data-dojo-attach-point\x3d"itemType" class\x3d"wideselect"  data-dojo-type\x3d"dijit/form/Select" name\x3d\'itemType\' data-dojo-observer\x3d"changeType, changePlaceholder, deleteGrid"\x3e\r\n          \x3coption value\x3d"file" selected\x3e${i18n.itemTypeCpu}\x3c/option\x3e\r\n          \x3coption value\x3d"url"\x3e${i18n.itemTypeWeb}\x3c/option\x3e\r\n          \x3coption value\x3d"app"\x3e${i18n.itemTypeApp}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n        \x3cdiv class\x3d"type app" style\x3d"display:none;"\x3e\r\n          \x3cfieldset class\x3d"font-size--1"\x3e\r\n            \x3clegend class\x3d"trailer-quarter padding-leader-half font-size-0"\x3e${i18n.type}${i18n.colon}\x3c/legend\x3e\r\n            \x3cdiv class\x3d"indent"\x3e\r\n                \x3cinput id\x3d"apimap" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio" name\x3d"app" value\x3d"apimap" checked data-dojo-observer\x3d"changeApiType, changePlaceholder" /\x3e\r\n                \x3clabel for\x3d"apimap" class\x3d"trailer-0 inline-block"\x3e${i18n.appMap}\x3c/label\x3e\r\n                \x3cinput id\x3d"apimobile" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio margin-left-1" name\x3d"app" value\x3d"apimobile" data-dojo-observer\x3d"changeApiType, changePlaceholder" /\x3e\r\n                \x3clabel for\x3d"apimobile" class\x3d"trailer-0 inline-block"\x3e${i18n.appMobile}\x3c/label\x3e\r\n                \x3cinput id\x3d"app" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" class\x3d"radio orgOnly margin-left-1" name\x3d"app" value\x3d"desktopapplication" data-dojo-observer\x3d"changeApiType"/\x3e\r\n                \x3clabel for\x3d"app" class\x3d"orgOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.desktop}\x3c/label\x3e\r\n                \x3cinput id\x3d"apiapp" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" class\x3d"radio orgOnly margin-left-1" name\x3d"app" value\x3d"apiapp" data-dojo-observer\x3d"changeApiType" /\x3e\r\n                \x3clabel for\x3d"apiapp" class\x3d"orgOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.appApplication}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"indent esriLeadingMargin73 orgOnly adminOnly portalAppExtension" style\x3d"display:none;"\x3e\r\n                \x3cinput id\x3d"appbldrext" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" class\x3d"radio orgOnly adminOnly" name\x3d"app" value\x3d"appbldrext" data-dojo-observer\x3d"changeApiType" /\x3e\r\n                \x3clabel for\x3d"appbldrext" class\x3d"orgOnly adminOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.appBldrExtension}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/fieldset\x3e\r\n        \x3c/div\x3e\r\n        \x3cfieldset class\x3d"type app api leader-half" style\x3d"display:none;"\x3e\r\n          \x3cspan class\x3d"indent esriLeadingMargin73 inline-block left margin-right-1"\x3e\r\n            \x3clabel for\x3d"purpose" class\x3d"trailer-0 font-size--1"\x3e${i18n.itemPurpose}${i18n.colon}\x3c/label\x3e\r\n              \x3cselect id\x3d"purpose" data-dojo-type\x3d"dijit/form/Select" name\x3d"purpose"\x3e\r\n                  \x3coption value\x3d"Ready To Use" selected\x3e${i18n.itemReady}\x3c/option\x3e\r\n                  \x3coption value\x3d"Configurable"\x3e${i18n.itemConfigurable}\x3c/option\x3e\r\n                  \x3coption value\x3d"selfConfigured"\x3e${i18n.itemSelfConfigurable}\x3c/option\x3e\r\n                  \x3coption value\x3d"configurableApp"\x3e${i18n.itemConfigurableApp}\x3c/option\x3e\r\n                  \x3coption value\x3d"Code Sample"\x3e${i18n.itemCode}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan class\x3d"indent esriLeadingMargin73 esriLeadingMargin2 apiType apimap inline-block margin-right-1 left"\x3e\r\n            \x3clabel for\x3d"desktopapi" class\x3d"trailer-0 font-size--1"\x3e${i18n.itemAPI}${i18n.colon}\x3c/label\x3e\r\n              \x3cselect id\x3d"desktopapi" data-dojo-type\x3d"dijit/form/Select" name\x3d"desktopapi"\x3e\r\n                  \x3coption value\x3d"JavaScript" selected\x3e${i18n.itemJS}\x3c/option\x3e\r\n                  \x3coption value\x3d"Flex"\x3e${i18n.itemFlex}\x3c/option\x3e\r\n                  \x3coption value\x3d"Silverlight"\x3e${i18n.itemSL}\x3c/option\x3e\r\n                  \x3coption value\x3d"Web ADF"\x3e${i18n.itemADF}\x3c/option\x3e\r\n                  \x3coption value\x3d"Other"\x3e${i18n.itemOther}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan class\x3d"indent esriLeadingMargin73 esriLeadingMargin2 apiType apimobile inline-block left margin-right-1" style\x3d"display:none;"\x3e\r\n            \x3clabel for\x3d"mobileapi" class\x3d"trailer-0"\x3e${i18n.itemSDK}${i18n.colon}\x3c/label\x3e\r\n              \x3cselect id\x3d"mobileapi" data-dojo-type\x3d"dijit/form/Select" name\x3d"mobileapi"\x3e\r\n                  \x3coption value\x3d"ArcGIS for Android"\x3e${i18n.itemAndroid}\x3c/option\x3e\r\n                  \x3coption value\x3d"ArcGIS for iPhone"\x3e${i18n.itemIOS}\x3c/option\x3e\r\n                  \x3coption value\x3d"JavaScript" selected\x3e${i18n.itemJS}\x3c/option\x3e\r\n                  \x3coption value\x3d"Flex"\x3e${i18n.itemFlex}\x3c/option\x3e\r\n                  \x3coption value\x3d"Windows Mobile"\x3e${i18n.itemMobile}\x3c/option\x3e\r\n                  \x3coption value\x3d"ArcGIS for Windows Phone"\x3e${i18n.itemWindows}\x3c/option\x3e\r\n                  \x3coption value\x3d"ArcGIS for Windows Store"\x3e${i18n.itemWindowsStore}\x3c/option\x3e\r\n                  \x3coption value\x3d"ArcGIS for Windows Universal"\x3e${i18n.itemWindowsUniversal}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan class\x3d"indent esriLeadingMargin73 esriLeadingMargin05 apiType desktopapplication inline-block margin-right-1 left" style\x3d"display:none;"\x3e\r\n            \x3clabel for\x3d"apidesktopapp" class\x3d"trailer-0"\x3e${i18n.itemPlatform}${i18n.colon}\x3c/label\x3e\r\n              \x3cselect id\x3d"apidesktopapp" data-dojo-type\x3d"dijit/form/Select" name\x3d"apidesktopapp"\x3e\r\n                  \x3coption value\x3d"Java"\x3eJava\x3c/option\x3e\r\n                  \x3coption value\x3d".NET\u2013Windows Desktop"\x3e.NET\u2013Windows Desktop\x3c/option\x3e\r\n                  \x3coption value\x3d"OS X" selected\x3eOS X\x3c/option\x3e\r\n                  \x3coption value\x3d"Qt"\x3eQt\x3c/option\x3e\r\n                  \x3coption value\x3d"WPF"\x3eWPF\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/span\x3e\r\n        \x3c/fieldset\x3e\r\n        \x3cdiv class\x3d"type file desktopapplication"\x3e\r\n            \x3clabel for\x3d"file" class\x3d"trailer-quarter leader-half"\x3e${i18n.itemFile}${i18n.colon}\x3c/label\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"fileDiv"\x3e\r\n              \x3cinput id\x3d"file" class\x3d"required" size\x3d"41" type\x3d"file" name\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n            \x3c/span\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"type url trailer-half" style\x3d"display:none;"\x3e\r\n          \x3cfieldset\x3e\r\n            \x3clegend class\x3d"trailer-quarter leader-half"\x3e${i18n.type}${i18n.colon}\x3c/legend\x3e\r\n            \x3cdiv class\x3d"webTypes block-group block-group-2-up"\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"ags" data-dojo-type\x3d"dijit/form/RadioButton" checked value\x3d"ags" class\x3d"radio" name\x3d"web" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"ags" class\x3d"inline-block trailer-0"\x3e${i18n.webService}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"kml" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"kml" name\x3d"web" class\x3d"radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"kml" class\x3d"inline-block trailer-0"\x3e${i18n.webKML}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriLeadingMargin73 webTypes block-group block-group-2-up"\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"ogc" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"ogc" name\x3d"web" class\x3d"radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"ogc" class\x3d"inline-block trailer-0"\x3e${i18n.webOGC}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"webWFS" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"wfs" name\x3d"web" class\x3d"radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"webWFS" class\x3d"inline-block trailer-0"\x3e${i18n.webWFS}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriLeadingMargin73 webTypes block-group block-group-2-up"\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"webWMTS" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"wmts" name\x3d"web" class\x3d"radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"webWMTS" class\x3d"inline-block trailer-0"\x3e${i18n.webWMTS}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"document" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" value\x3d"document" name\x3d"web" class\x3d"orgOnly radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"document" class\x3d"orgOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.webDocument}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/fieldset\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"type url app api opext appbldrext" style\x3d"display:none;"\x3e\r\n          \x3clabel id\x3d"urlLbl" for\x3d"itemUrl" class\x3d"trailer-0 font-size--1"\x3e${i18n.itemURL}\x3c/label\x3e\r\n          \x3cinput dir\x3d"ltr" id\x3d"itemUrl" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" name\x3d"url" data-dojo-observer\x3d"_getUrlAndType" placeHolder\x3d"${i18n.urlRules}" data-dojo-attach-point\x3d"_urlInput"\x3e\r\n          \x3cdiv class\x3d"input-error-message" data-dojo-attach-point\x3d"_inlineError"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--\x3ca data-dojo-attach-point\x3d"supportedItems" class\x3d"indent esriLeadingMargin73 nosvcauth all" target\x3d"_blank" href\x3d""\x3e${i18n.itemSupportedItems}\x3c/a\x3e--\x3e\r\n        \x3c!--\x3cbr /\x3e--\x3e\r\n        \x3cfieldset class\x3d"type svcauth indent esriLeadingMargin73 trailer-0 leader-half" style\x3d"display:none;"\x3e\r\n          \x3cdiv\x3e${i18n.secureservice}\x3c/div\x3e\r\n          \x3cdiv class\x3d"credentials"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"storecredentials"\x3e\r\n            \x3cdiv\x3e\r\n              \x3cinput id\x3d"nostoreauth" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio" checked value\x3d"nostore" name\x3d"storeauth" data-dojo-observer\x3d"changeStoreCredentials" /\x3e\r\n              \x3clabel for\x3d"nostoreauth" class\x3d"wide display-inline"\x3e${!i18n.nostoreauth}\x3c/label\x3e\r\n              \x3cbr /\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv\x3e\r\n              \x3cinput id\x3d"storeauth" data-dojo-attach-point\x3d"_storeAuth" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio" value\x3d"store" name\x3d"storeauth" data-dojo-observer\x3d"changeStoreCredentials"/\x3e\r\n              \x3clabel for\x3d"storeauth" class\x3d"wide display-inline"\x3e${!i18n.storeauth}\x3c/label\x3e\r\n              \x3cbr /\x3e\r\n              \x3ca data-dojo-attach-point\x3d"learnMore" target\x3d"_blank" href\x3d""\x3e${i18n.learnMore}\x3c/a\x3e\r\n              \x3cbr /\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n        \x3cspan class\x3d"indent type zip esriLeadingMargin73 inline-block leader-half" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"archiveSelect" class\x3d"trailer-0"\x3e${i18n.itemContents}\x3c/label\x3e\r\n          \x3cselect data-dojo-type\x3d"dijit/form/Select" id\x3d"archiveSelect" name\x3d"archiveSelect" data-dojo-observer\x3d"changeArchive"\x3e\r\n            \x3coption value\x3d"shapefile" selected\x3e${i18n.typeShapefile}\x3c/option\x3e\r\n            \x3coption value\x3d"filegeodatabase"\x3e${i18n.itemFileGeodatabase}\x3c/option\x3e\r\n            \x3coption value\x3d"dtemp"\x3e${i18n.typeDesktopTemplate}\x3c/option\x3e\r\n            \x3coption value\x3d"mtemp"\x3e${i18n.typeMapTemplate}\x3c/option\x3e\r\n            \x3coption value\x3d"gpsample"\x3e${i18n.typeGPSample}\x3c/option\x3e\r\n            \x3coption value\x3d"codesample"\x3e${i18n.itemCode}\x3c/option\x3e\r\n            \x3coption value\x3d"arcpadpackage"\x3e${i18n.itemArcPadPackage}\x3c/option\x3e\r\n            \x3coption value\x3d"caddrawing"\x3e${i18n.itemCadDrawing}\x3c/option\x3e\r\n            \x3coption value\x3d"csvcollection"\x3e${i18n.itemCsvCollection}\x3c/option\x3e\r\n            \x3coption value\x3d"kmlcollection"\x3e${i18n.itemKmlCollection}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/span\x3e\r\n        \x3cspan class\x3d"indent type codesample esriLeadingMargin73 inline-block leader-half margin-left-1" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"codesample" class\x3d"trailer-0"\x3e${i18n.itemLanguage}${i18n.colon}\x3c/label\x3e\r\n          \x3cselect data-dojo-type\x3d"dijit/form/Select" name\x3d"codesample" id\x3d"codesample" style\x3d"width:120px;"\x3e\r\n            \x3coption value\x3d"C"\x3eC\x3c/option\x3e\r\n            \x3coption value\x3d"C#"\x3eC#\x3c/option\x3e\r\n            \x3coption value\x3d"C++"\x3eC++\x3c/option\x3e\r\n            \x3coption value\x3d"Java" selected\x3eJava\x3c/option\x3e\r\n            \x3coption value\x3d"Perl"\x3ePerl\x3c/option\x3e\r\n            \x3coption value\x3d"PHP"\x3ePHP\x3c/option\x3e\r\n            \x3coption value\x3d"Python"\x3ePython\x3c/option\x3e\r\n            \x3coption value\x3d"Ruby"\x3eRuby\x3c/option\x3e\r\n            \x3coption value\x3d"SQL"\x3eSQL\x3c/option\x3e\r\n            \x3coption value\x3d"VB"\x3eVB\x3c/option\x3e\r\n            \x3coption value\x3d"VB"\x3eWPF\x3c/option\x3e\r\n            \x3coption value\x3d"Other"\x3eOther\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/span\x3e\r\n        \x3cspan class\x3d"indent type arcpadpackage esriLeadingMargin73 inline-block leader-half margin-left-1" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"arcpadpackage" class\x3d"trailer-0"\x3e${i18n.type}${i18n.colon}\x3c/label\x3e\r\n          \x3cselect data-dojo-type\x3d"dijit/form/Select" name\x3d"arcpadpackage" id\x3d"arcpadpackage"\x3e\r\n            \x3coption value\x3d"ArcPad Project"\x3e${i18n.itemArcPadProject}\x3c/option\x3e\r\n            \x3coption value\x3d"ArcPad Template"\x3e${i18n.itemArcPadTemplate}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/span\x3e\r\n        \x3cspan class\x3d"indent type stylx esriLeadingMargin73 inline-block leader-half" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"stylx" class\x3d"trailer-0"\x3e${i18n.type}${i18n.colon}\x3c/label\x3e\r\n          \x3cselect data-dojo-type\x3d"dijit/form/Select" id\x3d"stylx" name\x3d"stylx"\x3e\r\n            \x3coption value\x3d"2d"\x3e${i18n.2d}\x3c/option\x3e\r\n            \x3coption value\x3d"3d"\x3e${i18n.3d}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/span\x3e\r\n        \x3cdiv class\x3d"type imageServiceType" style\x3d"display:none;"\x3e\r\n          \x3cfieldset\x3e\r\n            \x3clegend class\x3d"trailer-quarter leader-half"\x3e\r\n              \x3cspan class\x3d"margin-right-quarter"\x3e${i18n.addLayerFromUrlDlg.addImageryAs}\x3c/span\x3e\x3cspan data-dojo-attach-point\x3d"_imageServiceTypeInfo"\x3e\x3c/span\x3e\r\n            \x3c/legend\x3e\r\n            \x3cdiv class\x3d"block-group block-group-2-up"\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"dynamicImagery" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"ImageServer" class\x3d"radio" name\x3d"imageServiceType" data-dojo-observer\x3d"changeImageServiceType" /\x3e\r\n                \x3clabel for\x3d"dynamicImagery" class\x3d"inline-block trailer-0"\x3e${i18n.addLayerFromUrlDlg.dynamicImagery}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"tiledImagery" data-dojo-attach-point\x3d"_defaultImageServiceTypeNode" data-dojo-type\x3d"dijit/form/RadioButton" checked value\x3d"TiledImageServer" class\x3d"radio" name\x3d"imageServiceType" data-dojo-observer\x3d"changeImageServiceType" /\x3e\r\n                \x3clabel for\x3d"tiledImagery" class\x3d"inline-block trailer-0"\x3e${i18n.addLayerFromUrlDlg.tiledImagery}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/fieldset\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_publishServiceDiv" class\x3d"indent publish type esriLeadingMargin73" style\x3d"display:none;"\x3e\r\n      \x3cfieldset data-dojo-attach-point\x3d"_publishNode" class\x3d"type publish trailer-half"\x3e\r\n        \x3cinput id\x3d"enablePublishing" data-dojo-attach-point\x3d"_enablePublishing" name\x3d"enablePublishing" data-dojo-type\x3d"dijit/form/CheckBox" checked data-dojo-observer\x3d"onPublishCheck"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_enablePublishingLabel" for\x3d"enablePublishing" class\x3d"display-inline"\x3e${i18n.publishService}\x3c/label\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n    \x3cfieldset class\x3d"fieldset-checkbox"\x3e\r\n      \x3cdiv class\x3d"title trailer-1"\x3e\r\n        \x3clabel for\x3d"title"\x3e${i18n.itemTitle}${i18n.colon}\x3c/label\x3e\r\n        \x3cinput id\x3d"title" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" class\x3d"required" name\x3d"title" placeHolder\x3d"${i18n.titleRules}"\x3e\r\n        \x3cbr /\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide categories-container"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_categoriesLbl" class\x3d"trailer-0" for\x3d"addItemCategoryPicker"\x3e\r\n          ${i18n.categories}${i18n.colon}\r\n        \x3c/label\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_categoriesContainer" id\x3d"addItemCategoryPicker"\x3e\x3c/div\x3e\r\n\r\n      \x3c/div\x3e\r\n      \x3cdiv\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_tagsLbl" class\x3d"tagLbl" for\x3d"tags"\x3e${i18n.itemTags}${i18n.colon}\x3c/label\x3e\r\n        \x3cinput id\x3d"tags" data-dojo-attach-point\x3d"_tags" data-dojo-type\x3d"esri/dijit/Tags" name\x3d"tags" data-dojo-props\x3d"minWidth:\'450px\',maxWidth:\'450px\'"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n    \x3cdiv class\x3d\'subtable opextwarning opextwarningmsg esriLeadingMargin73\' style\x3d"display:none;"\x3e\r\n      \x3cdiv\x3e${i18n.opExtensionMsg}\x3c/div\x3e\r\n      \x3cul\x3e\r\n        \x3cli class\x3d"useDataFromView opextwarningmsg" style\x3d"display:none;"\x3e${i18n.manifestWarnings.useDataFromView}\x3c/li\x3e\r\n        \x3cli class\x3d"usePortalServices opextwarningmsg" style\x3d"display:none;"\x3e${i18n.manifestWarnings.usePortalServices}\x3c/li\x3e\r\n        \x3cli class\x3d"useExternalAGSServices opextwarningmsg" style\x3d"display:none;"\x3e${i18n.manifestWarnings.useExternalAGSServices}\x3c/li\x3e\r\n      \x3c/ul\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d\'subtable hosted\' style\x3d"display:none;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_publishCSVDiv" class\x3d"publish type" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"allExcelSheets xlsx trailer-half" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"allExcelSheets" class\x3d"trailer-0"\x3e\x3cspan class\x3d"padding-right-1"\x3e${i18n.allExcelSheets}${i18n.colon}\x3c/span\x3e\r\n            \x3cselect id\x3d"allExcelSheets" data-dojo-attach-point\x3d"_allExcelSheets" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:375px;" maxHeight\x3d"200" name\x3d"allExcelSheets" data-dojo-attach-event\x3d"onChange:onChangeExcelSheet"\x3e\x3c/select\x3e\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d\'csv xlsx trailer-half\' style\x3d"display:none;"\x3e\r\n          \x3cdiv class\x3d"padding-right-1 trailer-0"\x3e${i18nCSV.locateUsing}\x3c/div\x3e\r\n          \x3clabel class\x3d"geocode-input-wrapper csv xlsx portal noGeocode padding-right-1 trailer-0"\x3e\r\n            \x3cinput id\x3d"locationTypes" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx portal noGeocode" name\x3d"geocode" value\x3d"locationTypes" checked data-dojo-observer\x3d"onChangeGeocode" /\x3e\r\n            ${i18n.latLong}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"geocode-input-wrapper csv xlsx portal padding-right-1 trailer-0"\x3e\r\n            \x3cinput id\x3d"addressTypes" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx portal" name\x3d"geocode"     value\x3d"addressTypes" data-dojo-observer\x3d"onChangeGeocode" /\x3e\r\n            ${i18n.address}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"geocode-input-wrapper noGeocode csv xlsx portal tableOnly padding-right-1 trailer-0"\x3e\r\n            \x3cinput id\x3d"tableOnly" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx portal noGeocode tableOnly" name\x3d"geocode"\r\n              value\x3d"none" data-dojo-observer\x3d"onChangeGeocode" /\x3e\r\n            ${i18n.table}\r\n          \x3c/label\x3e\r\n\r\n          \x3cdiv class\x3d"leader-half clearfix flex flex-column"\x3e\r\n            \x3cspan\x3e\r\n              \x3cdiv class\x3d\'multigeocode left\'\x3e\r\n                \x3cspan\x3e\r\n                  \x3clabel for\x3d"geocoderSelect" class\x3d"trailer-0"\x3e${i18nCSV.selectGeocoder}\x3c/label\x3e\r\n                  \x3cselect id\x3d"geocoderSelect" style\x3d"margin-top: 0px; max-width: 75%;" data-dojo-attach-point\x3d"_geocoderSelect" data-dojo-type\x3d"dijit/form/Select" maxHeight\x3d"200" name\x3d"geocodeAddress"\x3e\x3c/select\x3e\x3c!-- data-dojo-observer\x3d"onChangeGeocoder"--\x3e\r\n                \x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d\'csv xlsx geocode\'\x3e\r\n                \x3cspan\x3e\r\n                \x3clabel for\x3d"geocodeAddress" class\x3d"trailer-0"\x3e${i18nCSV.inLabel}\x3c/label\x3e\r\n                \x3cselect id\x3d"geocodeAddress" style\x3d"margin-top: 0px; max-width: 75%;" data-dojo-attach-point\x3d"_countryCodes" data-dojo-type\x3d"dijit/form/Select" maxHeight\x3d"200" name\x3d"geocodeAddress" data-dojo-attach-event\x3d"onChange:onChangeCountry"\x3e\x3c/select\x3e\x3c!-- data-dojo-observer\x3d"onChangeCountry"--\x3e\r\n              \x3c/div\x3e\r\n              \x3c/span\x3e\r\n            \x3c/span\x3e\r\n            \x3cdiv class\x3d\'geocode-output leader-half\'\x3e\r\n              \x3clabel class\x3d"trailer-0 inline-block"\x3e${i18nCSV.outputFields}\x3c/label\x3e\r\n              \x3ca class\x3d"esriHelpIcon" data-dojo-attach-point\x3d"_locatorOutputHelpIcon" title\x3d"${i18n.learnMore}" href\x3d"#" target\x3d"_blank"\x3e\x3c/a\x3e\r\n              \x3cdiv class\x3d\'geocode-output__radio\'\x3e\r\n                \x3clabel class\x3d"geocode-input-wrapper csv xlsx padding-right-1 trailer-0" for\x3d"geometryOutput"\x3e\r\n                  \x3cinput id\x3d"geometryOutput" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx" value\x3d"GeometryOnly" name\x3d"geocodeFields" checked data-dojo-observer\x3d"onChangeFields" /\x3e\r\n                  ${i18nCSV.outputFieldTypes.geometryOnly}\r\n                \x3c/label\x3e\r\n                \x3clabel class\x3d"geocode-input-wrapper csv xlsx padding-right-1 trailer-0" for\x3d"minimalOutput"\x3e\r\n                  \x3cinput id\x3d"minimalOutput" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx portal" value\x3d"Minimal" name\x3d"geocodeFields" data-dojo-observer\x3d"onChangeFields" /\x3e\r\n                  ${i18nCSV.outputFieldTypes.minimal}\r\n                \x3c/label\x3e\r\n                \x3clabel class\x3d"geocode-input-wrapper csv xlsx padding-right-1 trailer-0" for\x3d"allOutput"\x3e\r\n                  \x3cinput id\x3d"allOutput" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx"\r\n                    value\x3d"AllFields" name\x3d"geocodeFields" data-dojo-observer\x3d"onChangeFields" /\x3e\r\n                  ${i18nCSV.outputFieldTypes.allFields}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"geocodeReviewMsg" class\x3d\'csv xlsx font-size--1\' style\x3d"display:none;"\x3e${i18n.review}\x3c/span\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d\'gridNode\' class\x3d"grid leader-quarter add-item-geocode-table"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"timeZones csv xlsx leader-1" style\x3d"display:none;"\x3e\r\n        \x3clabel for\x3d"timeZones" class\x3d"trailer-0"\x3e\x3cspan class\x3d"padding-right-1"\x3e${i18n.timeZone}${i18n.colon}\x3c/span\x3e\r\n          \x3cselect id\x3d"timeZones" data-dojo-attach-point\x3d"_timeZones" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:375px;" maxHeight\x3d"200" name\x3d"timeZone"\x3e\x3c/select\x3e\r\n          \x3ca class\x3d"esriHelpIcon" data-dojo-attach-point\x3d"_timezoneHelpIcon" title\x3d"${i18n.timezoneHelpTip}" href\x3d"#" target\x3d"_blank"\x3e\x3c/a\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"wfsNode" class\x3d"wfs leader-1 trailer-1" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"wfsLayers"\x3e${i18n.addLayerFromUrlDlg.layerLabel}\x3c/label\x3e\r\n          \x3cselect id\x3d"wfsLayers" data-dojo-attach-point\x3d"_wfsLayers" data-dojo-type\x3d"dijit/form/Select" maxHeight\x3d"200" name\x3d"wfsLayers"\x3e\x3c/select\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_wfsComplexOptions" class\x3d"complexOptions esriLeadingMargin7 trailer-1" style\x3d"display:none"\x3e\r\n              \x3clabel for\x3d"wfsGeometryType" data-dojo-attach-point\x3d"_wfsGeometryTypeMsg"\x3e${i18n.addLayerFromUrlDlg.wfsGeometryTypeMsg}\x3c/label\x3e\r\n              \x3cselect id\x3d"wfsGeometryType" data-dojo-attach-point\x3d"_wfsGeometryType" data-dojo-type\x3d"dijit/form/Select" maxHeight\x3d"200" name\x3d"wfsGeometryTypes" aria-label\x3d"${i18n.addLayerFromUrlDlg.wfsGeometryTypeMsg}"\x3e\r\n                  \x3coption value\x3d"none" selected\x3e${i18n.addLayerFromUrlDlg.chooseWFSGeometryType}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriGeometryPoint"\x3e${i18n.addLayerFromUrlDlg.points}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriGeometryPolyline"\x3e${i18n.addLayerFromUrlDlg.lines}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriGeometryPolygon"\x3e${i18n.addLayerFromUrlDlg.polygons}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_tileMatrixSetInfoOptions" class\x3d"tileMatrixSetInfosOptions esriLeadingMargin7 leader-1" style\x3d"display:none"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_tileMatrixSetInfos" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:442px;" maxHeight\x3d"200" name\x3d"tileMatrixInfos"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"selectNotebookRuntimeContainer" class\x3d"hide"\x3e\r\n      \x3clabel for\x3d"selectNotebookRuntime"\x3e\r\n        ${i18n.notebookViewer.runtimeSelectDlg.selectRuntime}\r\n        \x3cselect id\x3d"selectNotebookRuntime" data-dojo-attach-point\x3d"selectNotebookRuntime" class\x3d"full-width"\x3e\r\n        \x3c/select\x3e\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n\x3cdiv class\x3d"submitButtons leader-half trailer-half flex"\x3e\r\n    \x3cdiv class\x3d"flex flex-1"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"spinnerNode" class\x3d"hide flex-column-justify-center"\x3e${i18n.uploadingItem}\x3c/span\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_uploadProgressBar"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cinput data-dojo-type\x3d"dijit/form/Button" class\x3d"primary" id\x3d"addItem-btn" name\x3d"addItem" type\x3d"submit" label\x3d"${i18n.addItem}"\x3e\r\n    \x3cinput data-dojo-type\x3d"dijit/form/Button" class\x3d"cancel" name\x3d"cancel" type\x3d"button" data-dojo-observer\x3d"onCancel" label\x3d"${i18n.cancel}"\x3e\r\n\x3c/div\x3e\r\n\x3c/form\x3e\r\n'),
baseClass:"esriAGOAddItemForm",_requestParams:{f:"json"},_createItemUtil:arcgisonline.sharing.dijit.dialog._CreateItemUtilMixin,_publishPhotoCollection:arcgisonline.sharing.dijit.dialog._PublishImageCollection.PublishImageCollection,_imageryLayersInfoTipTemplate:e.cache("arcgisonline.sharing.dijit.dialog","templates/_ImageryLayersInfoTip.html",'\x3cdiv\x3e\r\n  \x3clabel class\x3d"leader-half trailer-quarter imagery-layer-title"\x3e${dynamicImagery}\x3c/label\x3e\r\n  \x3cdiv class\x3d"trailer-half"\x3e${dynamicImageryDesc}\x3c/div\x3e\r\n  \x3clabel class\x3d"leader-half trailer-quarter imagery-layer-title"\x3e${tiledImagery}\x3c/label\x3e\r\n  \x3cdiv class\x3d"trailer-half"\x3e${tiledImageryDesc}\x3c/div\x3e\r\n\x3c/div\x3e'),
_telemetryURLAttribute:"",_analyzedLocationTypes:[],itemAPI:arcgisonline.sharing.geow.Item,notebookUtil:arcgisonline.pages.utils.notebook,postMixInProperties:function(){this.inherited(arguments);this.i18nCSV=e.mixin({},e.i18n.getLocalization("arcgisonline","arcgisonline").CsvLocationDlg);this.i18nCommon=e.mixin({},e.i18n.getLocalization("arcgisonline","arcgisonline").common);this.i18n=e.mixin({},this.i18nCommon);this.i18n=e.mixin(this.i18n,e.i18n.getLocalization("arcgisonline","arcgisonline").addItemFrm);
this.i18n=e.mixin(this.i18n,{fileZipFormat:e.i18n.getLocalization("arcgisonline","arcgisonline").attachCodeDlg.fileZipFormat});this.i18n=e.mixin(this.i18n,{itemProperties:e.i18n.getLocalization("arcgisonline","arcgisonline").itemProperties});this.i18n=e.mixin(this.i18n,{addLayerFromUrlDlg:e.i18n.getLocalization("arcgisonline","arcgisonline").addLayerFromUrlDlg});this.i18n=e.mixin(this.i18n,{notebookViewer:e.i18n.getLocalization("arcgisonline","notebooks").notebookViewer});this.countryCodes=e.mixin({},
e.i18n.getLocalization("arcgisonline","arcgisonline").countryCodes);this.timeZones=e.mixin({},e.i18n.getLocalization("arcgisonline","arcgisonline").timeZones);this._imageryLayersInfoLabel=e.i18n.getLocalization("arcgisonline","arcgisonline").folders.weblayers.imagery;this._publishTypes={tilepackage:1,csv:1,shapefile:1,servicedefinition:1,filegeodatabase:1,geojson:1,json:1,vectortilepackage:1,scenepackage:1,featurecollection:1,xlsx:1,photocollection:1};this._maxFileSize=536870912E3;this._maxKmlFileSize=
10485760;this.changingGeocodeCountry=!1},startup:function(){this.inherited(arguments);this._loadConnections();this._util=arcgisonline.sharing.util;this._errorDlg=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();this._choiceDlg=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();this._timezoneUtils=arcgisonline.sharing.dijit._TimezoneUtils.TimezoneUtils;this._user=e.mixin(this._util.getUser(),this.overrideUser||{});this._restBaseUrl=esriGeowConfig.allSSL?
esriGeowConfig.restBaseUrl.replace("http:/","https:/"):esriGeowConfig.restBaseUrl;this._restBaseUrl+=this._restBaseUrl.lastIndexOf("/")===this._restBaseUrl.length-1?"":"/";this._portalUrl=this._restBaseUrl+"portals";this._contentUri=this._restBaseUrl+"content";this._publishUri=this._contentUri+"/users/"+this._user.username;this._userContentUri=this._publishUri+(this.folder&&"/"!==this.folder?"/"+this.folder:"");this._geocodeServiceUrl=this._agoGeocodeServiceUrl="arcgis.com/arcgis/rest/services/world/geocodeserver";
this._geocodeServers=(this._helperServices=esriGeowConfig.self&&esriGeowConfig.self.helperServices)&&this._helperServices.geocode;this._rasterAnalyticsServer=this._helperServices&&this._helperServices.rasterAnalytics;this._isPortal=esriGeowConfig.self.isPortal;this._isCustomRole=esriGeowConfig.userRole&&esriGeowConfig.userRole.isCustom();this._isAdmin=esriGeowConfig.userRole&&esriGeowConfig.userRole.isBasedOnAdmin();this._roleCanPublishFeatures=(this._roleCanCreateItem=esriGeowConfig.userRole&&esriGeowConfig.userRole.canCreateItem())&&
esriGeowConfig.userRole.canPublishFeatures();this._roleCanPublishTiles=this._roleCanCreateItem&&esriGeowConfig.userRole.canPublishTiles();this._roleCanUseGeocode=this._roleCanCreateItem&&esriGeowConfig.userRole.canUseGeocode();this._roleCanPublishScenes=this._roleCanCreateItem&&this._roleCanPublishFeatures&&esriGeowConfig.userRole.canPublishScenes();if((this._geocodeServers=this._util.filterBatchGeocoders(this._geocodeServers,!this._roleCanUseGeocode))&&this._geocodeServers.length)this._roleCanUseGeocode=
!0,this._setGeocoder(this._geocodeServers[0].url),this._setGeocoderOptions(),2>this._geocodeServers.length&&e.query(".multigeocode").style("display","none");else{var a=this._util.filterNonWorldGeocoders(this._helperServices&&this._helperServices.geocode);this._geocodeServiceUrl=(a=a&&a.length?a[0]:null)&&a.url||(this._isPortal?null:this._geocodeServiceUrl)}this._isPortal&&this._rasterAnalyticsServer&&esri.isDefined(this._rasterAnalyticsServer.url)&&(this._publishTypes.imagecollection=1);esri.config.defaults.io.proxyUrl=
esriGeowConfig.proxyServer;if(!this.item){a=e.create("a",{className:"icon-ui-question margin-left-half font-size--1 help-icon",title:this.i18n.helpIconSupportedItems,href:esriGeowConfig.self&&esriGeowConfig.self.helpMap?esriGeowConfig.self.helpBase+esriGeowConfig.self.helpMap.m["120000456"]:"",target:"_blank"});var g=e.query(".dijitDialogTitleBar",this.dialog.domNode);e.place(a,g[0],1)}this._requestParams.token=this._user.token;this._basicStandby=new p.widget.Standby({target:this.dialog&&this.dialog.domNode||
this.containerNode,opacity:.45});e.body().appendChild(this._basicStandby.domNode);this._basicStandby.startup();this._serviceInfoPane=new arcgisonline.sharing.dijit.ServiceInfo({},e.query(".credentials")[0]);this._serviceInfoPane.setProtocolErrorHandler(e.hitch(this,"_showReloadDlg"));this._credentialConnect=e.connect(this._serviceInfoPane,"onCredentialChange",e.hitch(this,function(){clearTimeout(this._changeCredentialTimeout);this._changeCredentialTimeout=setTimeout(e.hitch(this,function(){var b=
this._serviceInfoPane.get("userInfo");b&&b.username&&b.password&&(this.disable(!1,this.i18n.fetching),this._getServiceInfo(this.elementValue("url"),this.elementValue("title"),this.item.type))}),250)}));this._fetchCountryCodes();this._fetchTimeZones();if(esriGeowConfig.self.user&&(esriGeowConfig.self.user.accountId||esriGeowConfig.self.user.orgId)){a="PhotoCollection ImageCollection Pages Numbers Keynote DeepLearningPackage GML".split(" ");var m=K.byId("archiveSelect");this.i18n.itemGML="GML";this._isAdmin&&
!this._isPortal&&a.unshift("AppBldrPackage");this.itemInfo=e.mixin(this.itemInfo,this.orgOnly);e.forEach(a,e.hitch(this,function(b){"PhotoCollection"===b&&this._isPortal||m.addOption({value:b.toLowerCase(),label:this.i18n["item"+b]})}));e.query(".orgOnly").style("display","");this._isAdmin?e.query(".adminOnly").style("display",""):e.query(".adminOnly").style("display","none")}this._isPortal||esriGeowConfig.isDebug||e.query(".portalAppExtension").style("display","none");this._util.loadUserTags(this._user.username).then(e.hitch(this,
function(b){this._tags.set("knownTags",b);this._updateUI();this.allowPublish&&this.item&&this._tags.set("tags",this.item.tags)}));this.message?e.attr(this._instructions,"innerHTML",this.message):e.addClass(this._instructions,"hide");if("file"===this.selected||"url"===this.selected||"app"===this.selected)esri.hide(this.itemType.domNode),esri.hide(this.addItemLbl),this.itemType.set("value",this.selected);"url"===this.selected&&(this._telemetryURLAttribute="ags");"app"===this.selected&&(this._telemetryURLAttribute=
"web mapping");this.allowPublish&&this.item&&this.startupForPublish();if(esriGeowConfig.self.hasCategorySchema){var n=function(b){this._categories=new arcgisonline.pages.dijit.CategoryPicker({categories:this.allowPublish&&this.item&&this.item.categories?this.item.categories:[],schema:b},this._categoriesContainer);this._categories.startup();arcgisonline.pages.utils.dom.showNodes(e.query(".categories-container",this.domNode))}.bind(this);this.item&&this.item.portal?this.item.portal.getCategories().then(n):
this._util.request({url:esriGeowConfig.restBaseUrl+"portals/self/categorySchema"}).then(e.hitch(this,function(b){n(b.categorySchema)}))}this._uploadProgressBar=new arcgisonline.pages.dijit.UploadProgressBar({},this._uploadProgressBar);this._uploadProgressBar.startup();this._uploadProgressBar.hide();a=e.string.substitute(this._imageryLayersInfoTipTemplate,this.i18n.addLayerFromUrlDlg);this._imageServiceInfoTooltip=new arcgisonline.pages.dijit.InfoTooltip({title:"",content:a,orient:["below-centered",
"above-centered"],buttonAriaLabel:this._imageryLayersInfoLabel,preventInfoButtonEventDefault:!0,dialogClasses:["info-tooltip"]},this._imageServiceTypeInfo);this.initNotebooks()},_setGeocoderOptions:function(){for(var a=[],g=0;g<this._geocodeServers.length;g++)a.push({label:this._geocodeServers[g].name,value:this._geocodeServers[g].url});this._geocoderSelect.set("options",a);this._geocoderSelect.set("value",this._geocodeServers[0].name,!1)},_setGeocoder:function(a){var g=this._findGeocoder(a);this._geocodeServiceUrl=
a;this._isAgoWorldGeocodeServer=this._util.isEsriWorldGeocoderNoProxy(g);this._isServiceProxyAgoWorldGeocodeServer=this._util.isEsriWorldGeocoderThroughProxy(g);this._isWorldGeocodeServer=this._isAgoWorldGeocodeServer||this._isServiceProxyAgoWorldGeocodeServer;a=!0;this._isAgoWorldGeocodeServer||this._isServiceProxyAgoWorldGeocodeServer||(a=!!g.batch);this._allowGeocode=(!this._isCustomRole||this._roleCanUseGeocode)&&(!this._isPortal&&a||this._isPortal&&(!this._isAgoWorldGeocodeServer||this._isServiceProxyAgoWorldGeocodeServer)&&
a)},_findGeocoder:function(a){var g=this._geocodeServers.filter(function(m){return m.url===a});return g&&g.length?g.shift():null},startupForPublish:function(){this._publishOnly=!0;this.elementValue("title",this.item.title);this.formWidgets.addItem.widget.set("label",this.i18n.publishItem);this.item.type=this.item.type.replace(/\s+/g,"").toLowerCase();this._updateUI("servicedefinition"===this.item.type?"title":null,this.item.type);this._updateUI("addNew","publishOld");this.removeClass("required",["file",
"url"]);"csv"===this.item.type&&this._analyze(this.item).then(e.hitch(this,"_loadCSV"));"xlsx"===this.item.type?this._analyze(this.item).then(e.hitch(this,"_loadExcel")):this.item.publishParameters={}},enable:function(){this.inherited(arguments);e.query("a",this.containerNode).removeClass("disabledLink");arcgisonline.pages.utils.dom.hideNode(this.spinnerNode);this._serviceInfoPane&&this._serviceInfoPane.set("disabled",!1)},disable:function(a,g){this.inherited(arguments);e.attr(this.spinnerNode,"innerHTML",
g||this.i18n.uploadingItem);arcgisonline.pages.utils.dom.showNode(this.spinnerNode);e.query("a",this.containerNode).addClass("disabledLink");this._serviceInfoPane&&this._serviceInfoPane.set("disabled",!0)},isValid:function(a){var g=this.gatherFormValues(this.i18n.errors.required),m=this.gatherClassState("required",this.i18n.errors.required),n=this.item&&this.item.type||null,b=this.elementValue("url");if(!a)for(var c in g)if(m[c]&&this._isEmpty(this.elementValue(c)))return this._showError(this.i18n.errors.required[c]);
if(this.item&&this.item.error)return this._showError(this.item.error);if(m.file||a&&"file"===a){if(window.FileReader){a=e.byId("file").files[0].size;if(!this._isPortal&&"kml"===this.item.type&&a>this._maxKmlFileSize)return this._showError(this.i18n.errors.kmlFileToLarge);if(a>this._maxFileSize)return this._showError(this.i18n.errors.fileToLarge)}b=this.item.name||this.item.url||this.item.title||this.item.item}return"desktopapplication"!==this.item.type||this.item.isZip?this._itemExists({name:b,title:this.elementValue("title"),
type:this.item.type}).then(e.hitch(this,function(d){if(d)return!1;if(!this.itemInfo[n.toLowerCase()])return this._showError({message:this.i18n.errors.unknownType.message});n=n&&n.toLowerCase()||null;if("opdashboardaddin"===n&&this._user&&"account_admin"!==this._user.role&&"account_publisher"!==this._user.role)return this._showError(this.i18n.errors.insuffientPrivs);if("opext"!==n||this._validateOpExtension(this._manifestInfo))if("appbldrext"!==n||this._validateAppBuilderExtension(this._manifestInfo)){if("ipynb"===
n&&!this.selectNotebookRuntime.value)return this._showError({message:this.i18n.notebookViewer.runtimeSelectDlg.selectRuntimeError});if(this.allowPublish&&!1!==this.publish&&n in this._publishTypes)return d=this.value.title.split(" ").join("_"),(this._isPortal?/[.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(d):/[.@#%&*+=\-\\';,\/|\\":<>\?]/g.test(d))||120<d.length?this._showError(this.i18n.errors.invalidServiceTitle):"servicedefinition"!==n?this._serviceNameAvailable(this.item).then(e.hitch(this,
function(h){return h})):!0;d=this.value.title;var l=d.match(/^\d/)?!0:!1;return-1<d.indexOf("\x3c")||-1<d.indexOf("\x3e")?this._showError({message:this.i18n.itemProperties.error.badCharacter}):"wfs"===n&&l?this._showError({message:this.i18n.itemProperties.error.cantStartWithNumber}):this._reload?(this._showReloadDlg(),!1):!0}})):this._showError({message:this.i18n.fileZipFormat})},validate:function(a,g){return(new RegExp("^(?:"+g+")")).test(this.elementValue(a))?!0:this._showError(this.i18n.errors.invalid[a])},
_validateOpExtension:function(a){var g={Widget:1,"Map Tool":1,"Feature Action":1},m=[];if(!a)return this._showError({message:this.i18n.errors.opExtensionNotJson});if(!a.type||!1===a.type in g)return this._showError({message:this.i18n.errors.opExtensionInvalidType});if(!a.runtime||!a.runtime.path)return this._showError({message:this.i18n.errors.opExtensionNoPath});a&&(a.useDataFromView&&m.push(".useDataFromView"),a.usePortalServices&&m.push(".usePortalServices"),a.useExternalAGSServices&&m.push(".useExternalAGSServices"),
m.length&&(m.push(".opextwarning"),e.query(m.join(","),this.domNode).style("display","block")));return!0},_validateAppBuilderExtension:function(a){var g={HTML:1,HTML3D:1};return a?a.name?a.platform&&!1!==a.platform in g?a.version?a.wabVersion?!0:this._showError({message:this.i18n.errors.appBldrExtensionInvalidWabVersion}):this._showError({message:this.i18n.errors.appBldrExtensionInvalidVersion}):this._showError({message:this.i18n.errors.appBldrExtensionInvalidPlatform}):this._showError({message:this.i18n.errors.appBldrExtensionNoName}):
this._showError({message:this.i18n.errors.appBldrExtensionNotJson})},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},changeType:function(a){delete this._reload;this._updateUI("type",a);this._updateUI(null,"title");this._updateUI(null,"all");this.removeClass("required",["file","url"]);"file"!==a?(this.unregisterNode("file"),this.fileDiv.innerHTML=this.fileDiv.innerHTML,this.registerNode(e.byId("file")),e.disconnect(this._fileInputConnect),this._fileInputConnect=e.connect(e.byId("file"),
"onchange",e.hitch(this,"_getFileAndType")),this.addClass("required",["url"])):"url"!==a&&this.addClass("required",["file"]);"app"===a&&(a=this.elementValue("app"),this.changeApiType(a));this.elementValue("title","");this.elementValue("url","")},changeServiceType:function(a){delete this._reload;this._telemetryURLAttribute="ogc"===a?"wms":a;this._updateUI("wfs",null);this._updateUI("imageServiceType",null);esri.hide(this._tileMatrixSetInfoOptions);esri.hide(this._wfsComplexOptions);e.forEach(this._gridConnects,
e.disconnect);this.item=this.item||{};this.item.type=a},changeImageServiceType:function(a){this.item.type=a},changeApiType:function(a){this._telemetryURLAttribute={apimap:"web mapping",apimobile:"mobile",desktopapplication:"desktop",apiapp:"application",appbldrext:"app builder"}[a];var g="opext"===a||"appbldrext"===a;this._manifestInfo=null;this.item=this.item||{};this.item.type=a;this._updateUI("desktopapplication",null);this._updateUI("apiapp"===a||g?"api":null,"apiapp"===a||g?null:"api");g||e.query(".subtable.opextwarning",
this.domNode).style("display","none");this["apiapp"===a||"desktopapplication"===a?"removeClass":"addClass"]("required",["url"]);this["desktopapplication"===a?"addClass":"removeClass"]("required",["file"]);e.attr(e.byId("urlLbl"),"innerHTML",g?this.i18n.urlManifestLbl:this.i18n.itemURL);this._updateUI("apiType",a)},changeArchive:function(a){this.item=this.item||{};this.item.type=a;this._updateUI("publish");this._updateUI("codesample");this._updateUI("arcpadpackage");this._updateUI("shapefile",!this.allowPublish&&
a in this._publishTypes?null:a);this.allowPublish&&a in this._publishTypes&&(this._updateUI(null,"publish"),e.attr(this._enablePublishingLabel,"innerHTML",this.i18n["photocollection"===a?"publishPhotos":"tilepackage"!==a?"publishService":"publishNamedService"]))},changePlaceholder:function(a){this._inlineError.classList.remove("is-active");this.elementValue("title","");this.elementValue("url","");if(esriGeowConfig.isRightToLeft&&(9>e.has("ie")||5>e.has("trident")))this.formWidgets.url.widget.set("placeHolder",
"");else{a="url"===a?this._getRadioButtonValue("web"):a;var g=this.i18n.urlRules;if("ags"===a)g=this.i18n.urlRules;else if("app"===a||"apimobile"===a||"apimap"===a)g=this.i18n.urlRulesApp;else if("opext"===a||"appbldrext"===a)g=this.i18n.urlManifest;this.formWidgets.url.widget.set("placeHolder",g)}},changeStoreCredentials:function(a){},showUserTags:function(){arcgisonline.sharing.dijit.dialog.TagsDlg.prototype.statics.getInstance().show(this._user||null)},onPublishCheck:function(a){"csv"===this.item.type||
"xlsx"===this.item.type?(this._updateUI(a?null:"csv",a?"csv":null),this._updateUI(a?null:"grid",a?"grid":null),a&&"csv"===this.item.type&&"address"!==this.item.publishParameters.locationType&&this._updateUI("geocode",null),"xlsx"===this.item.type&&(this._updateUI(a?null:"xlsx",a?"xlsx":null),a&&"address"!==this.item.publishParameters.layers[0].locationType&&this._updateUI("geocode",null)),a&&this._grid.setStore(this._oStore)):"servicedefinition"===this.item.type&&this._updateUI(a?"title":null,a?null:
"title");this.publish=a},onCancel:function(){this.dialog&&(e.topic.publish("cancel-item-upload"),this.dialog.hide())},onSubmit:function(a){a.preventDefault();this._serviceInfoPane&&this._serviceInfoPane._editingCredential&&this._serviceInfoPane.domNode?K.byId("addItem-btn").focus():e.when(this.isValid(),e.hitch(this,function(g){if(!g)return!1;switch(this.elementValue("itemType")){case "url":this._addService();break;case "app":this._addApplication();break;default:this._addFile()}}))},onChangeGeocoder:function(a){this._setGeocoder(a);
this._analyzedLocationTypes=[];this.onChangeGeocode("addressTypes")},onChangeGeocode:function(a){void 0!==this.item.excelInfo?"none"===a?(this._grid.layout.setColumnVisibility(1,!1),this._grid.layout.setColumnVisibility(2,!1),e.attr(this.geocodeReviewMsg,"innerHTML",this.i18n.reviewTableExcel)):(this._grid.layout.setColumnVisibility("addressTypes"===a?1:2,!0),this._grid.layout.setColumnVisibility("addressTypes"===a?2:1,!1),e.attr(this.geocodeReviewMsg,"innerHTML",this.i18n.reviewExcel)):"none"===
a?(this._grid.layout.setColumnVisibility(2,!1),this._grid.layout.setColumnVisibility(3,!1),e.attr(this.geocodeReviewMsg,"innerHTML",this.i18n.reviewTable)):(this._grid.layout.setColumnVisibility("addressTypes"===a?2:3,!0),this._grid.layout.setColumnVisibility("addressTypes"===a?3:2,!1),e.attr(this.geocodeReviewMsg,"innerHTML",this.i18n.review));this._updateUI("geocode","addressTypes"===a&&(!this._isPortal&&this._isWorldGeocodeServer||this._isPortal&&this._isServiceProxyAgoWorldGeocodeServer)?"geocode":
null);if("none"!==a&&-1===this._analyzedLocationTypes.indexOf(a)&&this._allowGeocode)this.onChangeCountry();else"addressTypes"===a&&void 0!==this.item.excelInfo&&this._checkProxyFilter();"addressTypes"!==a?e.query(".multigeocode").style("display","none"):1<this._geocodeServers.length&&e.query(".multigeocode").style("display","");e.query(".geocode-output").style("display",this._isPortal||"addressTypes"!==a||"csv"!==this.item.type?"none":"");this._currentGeocodeVal=a},onChangeCountry:function(a){this.item&&
(a&&(this._analyzedLocationTypes=[]),this._basicStandby.show(),this.deleteGrid(!0),this._analyze(this.item).then(this._checkProxyFilter.bind(this)).then(e.hitch(this,function(g){if("xlsx"===this.item.type){var m=""===this._allExcelSheets.value?0:this._allExcelSheets.value;g.publishParameters.layers[m].sourceCountry=g.publishParameters.layers[m].sourceCountry||"world";g.publishParameters.layers[m].sourceCountryHint="";this.changingGeocodeCountry=!0;return this._loadExcel(g)}g.publishParameters.sourceCountry=
g.publishParameters.sourceCountry||"world";g.publishParameters.sourceCountryHint="";return this._loadCSV(g)})))},onChangeFields:function(a){this._basicStandby.show();this.deleteGrid(!0);this._geocoderFields=a;this._analyze(this.item).then(this._checkProxyFilter.bind(this)).then(e.hitch(this,function(g){return"xlsx"===this.item.type?this._loadExcel(g):this._loadCSV(g)}))},_checkProxyFilter:function(a){var g=new e.Deferred,m=this._findGeocoder(this._geocodeServiceUrl);m.itemId?this._request(this._contentUri+
"/items/"+m.itemId).then(function(n){n.proxyFilter&&JSON.parse(n.proxyFilter).sourceCountry?(n=JSON.parse(n.proxyFilter).sourceCountry.split(",").reduce(function(b,c){b[c.toLowerCase()]=!0;return b},{world:!0}),this._fetchCountryCodes(n)):this._fetchCountryCodes();g.resolve(a)}.bind(this),function(n){this._fetchCountryCodes();g.resolve(a)}):(this._fetchCountryCodes(),g.resolve(a));return g},_addFile:function(){if(this.item&&(this.item.publishParameters||this._analyzeError)){this.disable(null,this.i18n.updating);
var a=this.gatherFormValues(["title"]),g=this._tags.get("tags")||"",m=this.item.tags?e.isArray(this.item.tags)?this.item.tags:this.item.tags.split(","):[];g=this._unique(m.concat(g.split(","))).join(",");var n=["showUnmatchedAddresses"];a=e.mixin(a,{tags:g});return this._update(this.item,a).then(e.hitch(this,"_publish",this.item)).then(e.hitch(this,function(b){if(b&&b.error)return this._showError(b.error);if(b&&this.item.csvInfo)return this._fetch(b).then(e.hitch(this,function(c){n=n.concat(c&&c.item&&
c.item.typeKeywords||[]);n=this.item.csvInfo.publishParameters&&"none"===this.item.csvInfo.publishParameters.locationType?n.concat("Table"):n;return this._update({id:b.id,type:b.type},{typeKeywords:n.join(",")}).then(e.hitch(this,"_showItem",b))}));if(b&&this.item.excelInfo)return this._fetch(b).then(e.hitch(this,function(c){n=n.concat(c&&c.item&&c.item.typeKeywords||[]);n=this.item.excelInfo.publishParameters&&"none"===this.item.excelInfo.publishParameters.layers[0].locationType?n.concat("Table"):
n;return this._update({id:b.id,type:b.type},{typeKeywords:n.join(","),title:this.elementValue("title")}).then(e.hitch(this,"_showItem",b))}));if("featurecollection"===this.item.type)this._fetchItemData(this.item).then(e.hitch(this,function(c){var d={layers:[]};e.forEach(c.layers||[],e.hitch(this,function(l,h){h={id:h};l&&l.popupInfo&&(h.popupInfo=e.clone(l.popupInfo));l.layerDefinition&&l.layerDefinition.drawingInfo&&l.layerDefinition.drawingInfo.labelingInfo&&(h.showLabels=!0);d.layers.push(h)}));
return d.layers.length?this._update({id:b.id,type:b.type},{text:e.json.stringify(d)}).then(e.hitch(this,"_showItem",b)):this._showItem(b)}));else return this._showItem(b)}))}this._upload().then(e.hitch(this,function(b){this._uploadProgressBar.hide();this.dialog.set("closable",!0);if(!b||!b.id)return!1;var c=new e.Deferred,d={tilepackage:1,vectortilepackage:1,scenepackage:1};b=this.item=e.mixin(this.item||{},b);b=e.mixin(b,{tags:this._tags.get("tags")});this.item=e.mixin(b,this.gatherFormValues(["title"]));
switch(b.type.toLowerCase()){case "servicedefinition":c.then(e.hitch(this,"_publish",b)).then(e.hitch(this,function(f){return this._showItem(f)}));break;case "filegeodatabase":case "tilepackage":case "vectortilepackage":case "scenepackage":case "geojson":case "json":case "shapefile":c.then(e.hitch(this,"_publish",b)).then(e.hitch(this,"_showItem"));break;case "imagecollection":this._isPortal&&this.allowPublish&&this._publishTypes.imagecollection?c.then(e.hitch(this,"_publish",b)).then(e.hitch(this,
"_showItem")):c.then(e.hitch(this,"_showItem",b));break;case "photocollection":c.then(e.hitch(this,"_publishPhotos",b)).then(e.hitch(this,"_showItem"));break;case "xlsx":this.allowPublish&&this._publishTypes.xlsx&&!this._analyzeError?c.then(e.hitch(this,"_analyze",b)).then(e.hitch(this,"_loadExcel")):c.then(e.hitch(this,"_showItem",b));break;case "csv":this.allowPublish&&this._publishTypes.csv&&!this._analyzeError?c.then(function(){return this._analyze(b,this._isPortal)}.bind(this)).then(e.hitch(this,
"_loadCSV")):c.then(e.hitch(this,"_showItem",b));break;case "kml":case "kmz":var l=this._util.parseUrl(this._contentUri),h="http://"+(esriGeowConfig.self&&esriGeowConfig.self.portalHostname||l.host)+"/sharing/rest/content";b.url=this._util.getSecureUrl(h+"/items/"+b.id+"/data?token\x3d"+this._user.token);c.then(e.hitch(this,"_setKmlExtent",b)).then(e.hitch(this,function(f){return this._update(f,{extent:f.extent,url:this._util.getSecureUrl(h+"/items/"+f.id+"/data")},!0).then(e.hitch(this,"_showItem"))}));
break;case "ipynb":b.success&&(c.then(e.hitch(this,"_showItem",b)),c.resolve(b));break;default:c.then(e.hitch(this,"_showItem",b))}this.disable(!1,this.i18n.checkingStatus);this._checkStatus(b,function(f){c.resolve(f)},e.hitch(this,function(f){var r=b.type.toLowerCase();f&&"Error in adding file item"===f.message&&r in d?f.message=this.i18n.errors.invalidPackage.message:f&&-1<f.message.indexOf("already exists")&&(r=this.itemInfo[b.type.toLowerCase()]?this.itemInfo[b.type.toLowerCase()].type:b.type,
f.message=b.isFile?esri.substitute({type:r,item:b.item,name:b.name||b.item,title:b.title},this.i18n.errors.fileNameExists.message):esri.substitute({type:r,item:b.item,title:b.title},this.i18n.errors.itemExists.message),this._itemExistsError=f);return this._showError(f)}))}))},_addService:function(){var a=this._urlInput.value;var g=this.elementValue("type");if(!(a&&-1<a.indexOf("http://"))||esriGeowConfig.self.isPortal||esriGeowConfig.self.allSSL&&"MapServer"===g){this.disable();switch(this._getRadioButtonValue("web")){case "ags":a=
this._addSecureAGSService().then(e.hitch(this,"_showItem"));break;case "kml":a=this._addKMLUrl();break;case "ogc":a=this._addOGCUrl();break;case "wfs":a=this._addWFSUrl();break;case "wmts":a=this._addWMTSUrl();break;default:a=this._addUrl()}return a}K.byId("itemUrl").focus()},_addSecureAGSService:function(){var a=this.item.serviceInfo,g=this._serviceInfoPane.get("userInfo"),m=this.item.type.toLowerCase();m=this._checkThumbnailURL(this.itemInfo[m]);m=e.mixin(m,this.gatherFormValues(["url","title"]));
m=e.mixin(m,{tags:this._tags.get("tags")});if(a&&a.isSecure&&!a.userInfo||this.item.isSecured&&this.item.isSecured.isOverride&&!g||this.item.isSecured&&401!==this.item.isSecured.httpStatusCode&&!g)throw this._showError(this.i18n.errors.invalidCredentials),Error();if(this.item.isSecured&&"store"===this._getRadioButtonValue("storeauth")){if(!this._isPortal||this._isPortal&&this._checkProtocol())m.serviceUsername=this._serviceInfoPane.userInfo.username,m.servicePassword=this._serviceInfoPane.userInfo.password;
else throw this._basicStandby.hide(),this.enable(),Error();if(401===this.item.isSecured.httpStatusCode)return this._add(m).then(e.hitch(this,"_fetch")).then(e.hitch(this,function(n){this.item.id=n.item&&n.item.id;this.item.url=n.item&&n.item.url;this.item.sourceUrl=n.item&&n.item.sourceUrl;return this._addAGSService(!0)}));if(a&&a.isSecure&&!a.userInfo)throw this._showError(this.i18n.errors.invalidCredentials),Error();}return this._addAGSService(!1)},_addAGSService:function(a){var g=this.item.serviceInfo,
m=this.item.type.toLowerCase(),n=this._checkThumbnailURL(this.itemInfo[m]),b=e.mixin(n,this.gatherFormValues(["url","title"])),c={streamserver:1,imageserver:1,workspaceserver:1};b=e.mixin(b,{tags:this._tags.get("tags")});if(!g)throw this._showError({message:esri.substitute({name:b.title},this.i18n.errors.serviceNotExist.message)},null,!0),Error();n=g.documentInfo||{};b=e.mixin(b,{description:g.serviceDescription||g.description||n.Comments||"",snippet:n.Subject||"",accessInformation:g.copyrightText||
n.Credits||"",spatialReference:this._getSpatialReference(this.item),url:this.item.url||this.elementValue("url").split("?")[0]});m&&"mapserver"===m.toLowerCase()&&(b.typeKeywords+=g.singleFusedMapCache?" ,Tiled":" ,Dynamic");g&&g.type&&"Table"===g.type&&(b.typeKeywords+=", Table, Singlelayer");m&&m.toLowerCase()in c?b.typeKeywords+=" ,Singlelayer":g&&(g.layers||g.tables)&&(g.layers&&g.layers.length||!g.tables||!g.tables.length?(n=(g.layers||[]).concat(g.tables||[]),b.typeKeywords+=1<n.length?" ,Multilayer":
" ,Singlelayer"):(-1===b.typeKeywords.indexOf("Table")&&(b.typeKeywords+=" ,Table"),b.typeKeywords+=1<g.tables.length?" ,Multilayer":" ,Singlelayer"));m&&"sceneserver"===m.toLowerCase()&&(m=g.layers||[],g=m.length&&m[0].layerType||g.layerType,b.typeKeywords+=g?" ,"+g:"");return this._projectExtent2WGS84(b).then(e.hitch(this,"_getThumbnail",this.item,b)).then(e.hitch(this,function(d){b.thumbnailURL=d;b.thumbnailURL&&this.item.thumbnailToken&&(b.thumbnailURL+=(-1<b.thumbnailURL.indexOf("?")?"\x26":
"?")+"token\x3d"+this.item.thumbnailToken);return b}),e.hitch(this,function(d){return b})).then(e.hitch(this,function(d){return a?this._update(this.item,e.mixin(d,{url:this.item.sourceUrl}),!0):this._add(d)}))},_addKMLUrl:function(){var a=this.item.type.toLowerCase();a=this._checkThumbnailURL(this.itemInfo[a]);var g=e.mixin(a,this.gatherFormValues(["url","title"]));a=new e.Deferred;g=e.mixin(g,{tags:this._tags.get("tags")});a.then(e.hitch(this,"_setKmlExtent",g)).then(e.hitch(arcgisonline.map.thumbnail,
"buildThumbnailURLFromKMLItem",g,null)).then(e.hitch(this,function(m){g.thumbnailURL=m;return g}),e.hitch(this,function(m){return g})).then(e.hitch(this,"_add",g)).then(e.hitch(this,"_showItem"));a.resolve();return a},_setKmlExtent:function(a){esri.config.defaults.kmlService=esriGeowConfig.kmlService;var g=new e.Deferred,m=new esri.layers.KMLLayer(a.url),n=e.connect(m,"onLoad",e.hitch(this,function(){e.disconnect(n);a.extent=this._extent2String(this._getKmlExtent(m));g.resolve(a)})),b=e.connect(m,
"onError",e.hitch(this,function(c){e.disconnect(b);this._showError({message:c.message});throw c;}));return g},_getKmlExtent:function(a){a=a.getLayers();var g;e.forEach(a,function(m){m.graphics&&0<m.graphics.length&&(m=esri.graphicsExtent(m.graphics),g=g?g.union(m):m)});return g||null},_addOGCUrl:function(){if(this.item&&this.item.ogcInfo){var a=this.item.type.toLowerCase();a=this._checkThumbnailURL(this.itemInfo[a]);var g=e.mixin(a,this.gatherFormValues(["title"]));a=this.item.ogcInfo;var m=new e.Deferred,
n=[],b=!1;g=e.mixin(g,{tags:this._tags.get("tags")});this._grid&&this._grid.edit&&this._grid.edit.apply();var c=this._mStore&&this._mStore.query({visible:!0}).map(function(l){d=d?l.extent?d.union(l.extent):d:l.extent;n.push(l.name);var h={name:l.name,title:l.title};l.legendURL&&(h.legendURL=l.legendURL);l.queryable&&(h.queryable=l.queryable);return h});a.setVisibleLayers(n);var d=d||a.fullExtent;b=!e.some(a.spatialReferences,function(l){return l===d.spatialReference.wkid});g=e.mixin(g,{url:a.url,
description:a.description||"",accessInformation:a.copyright||"",text:this._getWMSData(a,c),extent:d});b&&m.then(e.hitch(this,"_project",d,new esri.SpatialReference({wkid:a.spatialReferences[0]}))).then(e.hitch(this,function(l){g.extent=l;return g}));m.then(e.hitch(this,"_getWMSImageUrl",g,a)).then(e.hitch(this,"_add")).then(e.hitch(this,"_showItem"));m.resolve();return m}this._showError({message:esri.substitute({name:""},this.i18n.errors.serviceNotExist.message)},null,!0)},_addWFSUrl:function(){var a=
this.item.type.toLowerCase(),g=e.mixin(this._wfsLayer||{},{geometryType:this._wfsGeometryType.get("value")}),m=e.mixin({},this.gatherFormValues(["url","title"]),this._checkThumbnailURL(this.itemInfo[a])),n=g.selectedLayer&&g.selectedLayer.fullExtent||[[],[]];this.item&&this._wfsLayer?g.geometryType&&"none"!==g.geometryType?(a=arcgisonline.sharing.dijit.dialog.getWFSConfig(g),m=e.mixin(m,{tags:this._tags.get("tags"),text:e.json.stringify(a),extent:n[0]+","+n[1]+","+n[2]+","+n[3]}),this._add(m).then(e.hitch(this,
function(b){m=e.mixin(m,b,{extent:[[n[0],n[1]],[n[2],n[3]]]});arcgisonline.map.thumbnail.buildThumbnailURLFromWFSItem(m).then(e.hitch(this,function(c){return e.mixin(m,{thumbnailUrl:c})}),e.hitch(this,function(){return m})).then(e.hitch(this,function(c){this._update(c,{thumbnailUrl:c.thumbnailUrl},!0).then(e.hitch(this,"_showItem",c))}))}))):this._showError({message:this.i18n.errors.missingGeometry.message}):this._showError({message:esri.substitute({name:""},this.i18n.errors.serviceNotExist.message)},
null,!0)},_addWMTSUrl:function(){var a=this.item.type.toLowerCase(),g=this._wmtsLayer,m=((g&&g.selectedLayer||{}).tileMatrixSetInfos||[])[this._tileMatrixSetInfos.get("value")],n=e.mixin({},this.gatherFormValues(["url","title"]),this._checkThumbnailURL(this.itemInfo[a])),b,c;this.item?this._wmtsLayer?m?(g=e.mixin(g,{selectedTileInfo:m}),arcgisonline.sharing.dijit.dialog.getWMTSConfig(g).then(e.hitch(this,function(d){c=d&&d.wmtsConfig;b=d&&d.fullExtent?g.selectedLayer.gcsExtent:{xmin:-180,ymin:-90,
xmax:180,ymax:90};n=e.mixin(n,{url:c.wmtsInfo.url,tags:this._tags.get("tags"),text:e.json.stringify(c),extent:b.xmin+","+b.ymin+","+b.xmax+","+b.ymax});this._add(n).then(e.hitch(this,function(l){n=e.mixin(n,l,{extent:[[b.xmin,b.ymin],[b.xmax,b.ymax]]});arcgisonline.map.thumbnail.buildThumbnailURLFromWMTSItem(n).then(e.hitch(this,function(h){return e.mixin(n,{thumbnailUrl:h})}),e.hitch(this,function(){return n})).then(e.hitch(this,function(h){this._update(h,{thumbnailUrl:h.thumbnailUrl},!0).then(e.hitch(this,
"_showItem",h))}))}))}))):this._showError({message:this.i18n.errors.missingGeometry.message}):this._showError({message:this.i18n.layerNotSelected}):this._showError({message:esri.substitute({name:""},this.i18n.errors.serviceNotExist.message)},null,!0)},_getWMSImageUrl:function(a,g){var m=new e.Deferred,n=e.hitch(this,function(b){a.thumbnailURL=b||a.thumbnailURL;a.extent=this._extent2String(a.extent);m.resolve(a)});g.getImageUrl(a.extent,800,532,n,n);return m},_getWMSData:function(a,g){return e.json.stringify({title:a.title||
"",url:a.url,mapUrl:a.getMapURL,version:a.version,layers:g,copyright:a.copyright||"",maxHeight:a.maxHeight,maxWidth:a.maxWidth,spatialReferences:a.spatialReferences,format:"png"!==a.getImageFormat()?a.getImageFormat():null,featureInfoUrl:a.getFeatureInfoURL,featureInfoFormat:a.featureInfoFormat})},_addUrl:function(){var a=this._getRadioButtonValue("web");a=this._checkThumbnailURL(this.itemInfo[a]);a=e.mixin(a,this.gatherFormValues(["url","title"]));a=e.mixin(a,{tags:this._tags.get("tags")});this.disable(["addItem",
"cancel"]);return this._add(a).then(e.hitch(this,"_showItem"))},_addApplication:function(){var a=this._getRadioButtonValue("app"),g=this._checkThumbnailURL(this.itemInfo[a]),m=this.elementValue("purpose"),n=this._manifestInfo,b="opext"===a||"appbldrext"===a;"apiapp"!==a&&("apimobile"===a?g.typeKeywords+=", "+this.elementValue("mobileapi"):"desktopapplication"===a?g.typeKeywords+=", "+this.elementValue("apidesktopapp"):b||(g.typeKeywords+=", "+this.elementValue("desktopapi")),b||(g.typeKeywords+=", "+
m,"selfConfigured"===m&&(g.typeKeywords+=", Configurable"),"configurableApp"===m&&(g.typeKeywords+=", configurableApp")),g=e.mixin(g,this.gatherFormValues(["url"])));m=this.elementValue("title")+"_"+(new Date).getTime();var c=e.mixin(g,this.gatherFormValues(["title"]));c=e.mixin(c,{name:m});c=e.mixin(c,{tags:this._tags.get("tags")});b&&n&&(c.thumbnailURL=n.thumbnailPath?c.url.substring(0,c.url.lastIndexOf("/")+1)+n.thumbnailPath:n.iconUrl||g.thumbnailUrl,c.accessInformation=n.credits||n.author||"",
c.description=n.description||"",c.summary=c.description,n.type&&(c.typeKeywords+=", "+n.type),n.platform&&(c.typeKeywords+=", "+n.platform),c.text=e.json.stringify(n));this.disable(["addItem","cancel"]);if("desktopapplication"!==a)return g=this._add(c),"apiapp"===a?g.then(e.hitch(this,"_registerApp")):g.then(e.hitch(this,"_showItem"));a=e.create("div",null,this.formNode);c.itemType="file";for(m in c)e.place(e.create("input",{name:m,type:"text",value:g[m],style:{display:"none"}}),a);e.place(e.create("input",
{type:"text",name:"overwrite",value:!1,style:{display:"none"}}),a);e.place(e.create("input",{type:"text",name:"async",value:!0,style:{display:"none"}}),a);return this._addItem(this.domNode,a).then(function(d){this._checkStatus(d,function(l){return this._showItem(l)}.bind(this),function(l){this._showError(l)}.bind(this))}.bind(this))},_upload:function(){this._uploadProgressBar.reset();this._uploadProgressBar.show();this.dialog.set("closable",!1);var a=this._checkThumbnailURL(this.itemInfo[this.item.type]),
g=this.item.types&&-1<this.item.types.indexOf("is-compact");if("codesample"===this.item.type||"arcpadpackage"===this.item.type||"stylx"===this.item.type)a.typeKeywords+=", "+this.elementValue(this.item.type);var m=e.create("div",null,this.formNode);"servicedefinition"===this.item.type&&this.elementValue("title",null);a=e.mixin(a,{tags:this._tags.get("tags")});"tilepackage"===this.item.type&&g&&(a.type="Compact Tile Package");"ipynb"===this.item.type&&(a.properties=this.selectNotebookRuntime.value);
for(var n in a)e.place(e.create("input",{name:n,type:"text",value:a[n],style:{display:"none"}}),m);e.place(e.create("input",{type:"text",name:"overwrite",value:!1,style:{display:"none"}}),m);e.place(e.create("input",{type:"text",name:"async",value:!0,style:{display:"none"}}),m);this.disable(["addItem"]);return this._addItem(this.domNode,m)},_add:function(a){return this._request((this._userContentUri+"/addItem").replace("http:/",a.serviceUsername&&a.servicePassword?"https:/":"http:/"),a,{usePost:!0})},
_update:function(a,g,m){var n=m||!1;if(!m)for(var b in g)a[b]&&g[b]===a[b]?delete g[b]:n=!0;if(n)return this._request(this._userContentUri+"/items/"+a.id+"/update",g,{usePost:!0});g=new e.Deferred;g.resolve(a);return g},_delete:function(a){if(!this._publishOnly&&!this._itemExistsError)return this._request(this._userContentUri+"/items/"+a.id+"/delete",{},{usePost:!0},null,function(g){})},_fetch:function(a){return this._request(this._userContentUri+"/items/"+a.id,{},{})},_registerApp:function(a){return this._request(this._restBaseUrl+
"oauth2/registerApp",{itemId:a.id,appType:"multiple",redirect_uris:'["urn:ietf:wg:oauth:2.0:oob"]'},{usePost:!0}).then(e.hitch(this,function(g){return g}),e.hitch(this,function(g){throw Error(g);})).then(e.hitch(this,"_showItem",a))},_publish:function(a){if(!this.allowPublish||!1===this.publish||this._analyzeError){var g=new e.Deferred;g.resolve(a);return g}var m=a.type.toLowerCase();g=this._getDefaultPublishParameters(a);if("servicedefinition"!==m){if("csv"===m){var n=this.item.csvInfo.publishParameters.standardizedFieldNames;
this._grid.edit.apply();var b=this._getRadioButtonValue("geocode");if("addressTypes"===b){var c=0,d={};var l=n||{};g.publishParameters.locationType="address";this._mStore.query(function(f){"unknown"!==f.locationType&&f.locationType in l&&(d[f.locationType]=f.name,c++)});if(1>c)return{error:this.i18n.errors.noAddressFields};g.publishParameters.addressFields=d}else if("locationTypes"===b){var h={locationType:"coordinates",latitudeFieldName:null,longitudeFieldName:null};l=e.mixin({},this.i18n[b]);this._mStore.query(function(f){"mgrs"===
f.locationType?(h.coordinateFieldType="MGRS",h.coordinateFieldName=f.name):"usng"===f.locationType?(h.coordinateFieldType="USNG",h.coordinateFieldName=f.name):"unknown"!==f.locationType&&f.locationType in l&&(h[f.locationType+"FieldName"]=f.name)});if(!(h.latitudeFieldName&&h.longitudeFieldName||h.coordinateFieldType&&h.coordinateFieldName))return{error:this.i18n.errors.noLocationFields};e.mixin(g.publishParameters,h)}else g.publishParameters.locationType="none"}if("xlsx"===m)if(n=this._allExcelSheets&&
this._allExcelSheets.value||0,g.filetype="excel",n=g.publishParameters.layers[n],g.publishParameters.layers.length=1,g.publishParameters.layers[0]=n,n=this.item.excelInfo.publishParameters.layers[0].standardizedFieldNames,this._grid.edit.apply(),b=this._getRadioButtonValue("geocode"),"addressTypes"===b){c=0;d={};l=n||{};g.publishParameters.layers[0].locationType="address";this._mStore.query(function(f){"unknown"!==f.locationType&&f.locationType in l&&(d[f.locationType]=f.name,c++)});if(1>c)return{error:this.i18n.errors.noAddressFields};
g.publishParameters.layers[0].addressFields=d}else if("locationTypes"===b){h={locationType:"coordinates",latitudeFieldName:null,longitudeFieldName:null};l=e.mixin({},this.i18n[b]);this._mStore.query(function(f){"mgrs"===f.locationType?(h.coordinateFieldType="MGRS",h.coordinateFieldName=f.name):"usng"===f.locationType?(h.coordinateFieldType="USNG",h.coordinateFieldName=f.name):"unknown"!==f.locationType&&f.locationType in l&&(h[f.locationType+"FieldName"]=f.name)});if(!(h.latitudeFieldName&&h.longitudeFieldName||
h.coordinateFieldType&&h.coordinateFieldName))return{error:this.i18n.errors.noLocationFields};e.mixin(g.publishParameters.layers[0],h)}else g.publishParameters.layers[0].locationType="none";"addressTypes"===b&&this._geocoderFields&&"GeometryOnly"!==this._geocoderFields?g.publishParameters.candidateFieldsType=this._geocoderFields:g.publishParameters.candidateFieldsType&&delete g.publishParameters.candidateFieldsType;(n=this._timezoneUtils._winZones[this._timeZones.get("value")])&&"UTC"!==n.id&&("xlsx"===
m?g.publishParameters.layers[0]=e.mixin(g.publishParameters.layers[0],{dateFieldsTimeReference:{timeZone:n.id}}):g.publishParameters=e.mixin(g.publishParameters,{dateFieldsTimeReference:{timeZone:n.id}}));g.publishParameters=e.json.stringify(g.publishParameters)}this.disable(null,this.i18n.publishing);this.item.publishParameters={};return this._request(this._publishUri+"/publish",g,{usePost:!0}).then(e.hitch(this,function(f){this.item.publishParameters=a.publishParameters||{};f=e.map(f.services,e.hitch(this,
function(r){var q=e.mixin(r,{id:r.serviceItemId,type:r.type||this.i18n.service,name:"Image Service"!==r.type?this.elementValue("title"):r.name,error:r.error});esri._isDefined(r.success)&&!r.success&&(r.error?r.error.message&&-1<r.error.message.indexOf("already exist")&&(r.error.message=this.i18n.errors.serviceDefinitionExists.message):q.error=this.i18n.errors.publishError);if("tilepackage"===m||"scenepackage"===m)q.buildCache=!0;return q}));return!f||1!==f.length||"Map Service"===f[0].type&&"tilepackage"!==
m?f:f[0]}))},_analyze:function(a,g){var m=this._contentUri+"/features/analyze",n={analyzeParameters:{enableGlobalGeocoding:!0,sourceLocale:e.locale.split("-")[0]},filetype:this.itemInfo[this.item.type.toLowerCase()].type.toLowerCase(),itemid:a.id};this.disable(!1,this.i18n.analyzing);if("microsoft excel"==n.filetype){var b=a.excelInfo;n.filetype="excel"}else b=a.csvInfo;if(this._isPortal&&this._geocodeServiceUrl||!this._isPortal){if(this._isPortal||!this._isPortal&&this._geocodeServers&&this._geocodeServers.length)n.analyzeParameters.geocodeServiceUrl=
encodeURI(this._geocodeServiceUrl);a&&(b||g)&&(a="addressTypes"===this._getRadioButtonValue("geocode")||g?"address":"coordinates",g="address"===a?"addressTypes":"locationTypes",-1===this._analyzedLocationTypes.indexOf(g)&&this._analyzedLocationTypes.push(g),n.analyzeParameters.locationType=a);if(!this._isPortal&&this._isWorldGeocodeServer||this._isPortal&&this._isServiceProxyAgoWorldGeocodeServer)n.analyzeParameters.sourceCountry=b?this._countryCodes.get("value").toLowerCase():"",n.analyzeParameters.sourceCountryHint=
b?"":this._sourceCountry;"addressTypes"===this._getRadioButtonValue("geocode")&&this._geocoderFields&&"GeometryOnly"!==this._geocoderFields?n.analyzeParameters.candidateFieldsType=this._geocoderFields:n.analyzeParameters.candidateFieldsType&&delete n.analyzeParameters.candidateFieldsType;n.analyzeParameters=e.json.stringify(n.analyzeParameters)}else delete n.analyzeParameters;(b=arcgisonline.sharing.util.getToken())&&(m+="?token\x3d"+b);return this._request(m,n,{usePost:!0}).then(null,e.hitch(this,
function(c){this._analyzeError||this.deleteGrid()}))},_publishPhotos:function(a){var g=new e.Deferred,m=a.title.split(" ").join("_");this.allowPublish&&!1!==this.publish?(this.disable(!1,this.i18n.creating),this._publishPhotoCollection.publish(e.mixin(a,{name:m,ownerFolder:this.folder})).then(function(n){g.resolve(n)})):g.resolve(a);return g},onChangeExcelSheet:function(a){a=this.item.excelInfo.publishParameters.layers;var g=this.get("value").allExcelSheets,m=a[g]&&a[g].fields;this.deleteGrid(!0);
this._createGrid(m,g);m="none";"address"===a[g].locationType&&(m="addressTypes");"coordinates"===a[g].locationType&&(m="locationTypes");this.elementValue("geocode",m);this.onChangeGeocode(m)},_createGrid:function(a,g){var m=this.item,n=m.type.toLowerCase(),b=this.gridInfo[n],c;if(m&&(m.csvInfo||m.excelInfo)){var d="xlsx"==m.type?m.excelInfo.publishParameters.layers[g]:m.csvInfo.publishParameters;a=e.map(a,e.hitch(this,function(l){if(d.addressFields&&void 0==d.longitudeFieldName&&void 0==d.latitudeFieldName)for(var h in d.addressFields){if(d.addressFields[h]===
l.name)return e.mixin(l,{locationType:h})}else{if(l.name===d.longitudeFieldName)return e.mixin(l,{locationType:"longitude"});if(l.name===d.latitudeFieldName)return e.mixin(l,{locationType:"latitude"});if(d.coordinateFieldType&&"MGRS"===d.coordinateFieldType.toUpperCase()&&l.name===d.coordinateFieldName)return e.mixin(l,{locationType:"mgrs"});if(d.coordinateFieldType&&"USNG"===d.coordinateFieldType.toUpperCase()&&l.name===d.coordinateFieldName)return e.mixin(l,{locationType:"usng"})}return e.mixin(l,
{locationType:"unknown"})}))}e.forEach(b,function(l){l.name=this.i18n[l.name]||l.name;l.select&&(c="csv"!==n&&"xlsx"!==n||"addressTypes"!==l.select?e.mixin({},this.i18n[l.select]):e.mixin({},e.mixin(e.clone(this.i18n.notUsed),d.standardizedFieldNames||this.i18n[l.select])),e.mixin(l,this._toSelectOptions(c,"unknown")))},this);this._mStore=new e.store.Memory({data:a,idProperty:"name"});this._oStore=new e.data.ObjectStore({objectStore:this._mStore});this._updateUI(null,"hosted");!this._publishOnly||
"csv"!==m.type&&"xlsx"!==m.type||this._updateUI(null,"csv");this._grid=new p.grid.DataGrid({id:"_grid",selectionMode:"none",singleClickEdit:!0},e.create("div",{},this.gridNode));this._grid.setStore(this._oStore);this._grid.set("structure",b);this._grid.startup();this._basicStandby.hide();this.enable();this._publishOnly||"csv"!==m.type&&"xlsx"!==m.type||this._updateUI(null,"publish");this._updateUI(null,n);"xlsx"==m.type&&1==m.excelInfo.publishParameters.layers.length&&this._updateUI("allExcelSheets",
null)},deleteGrid:function(a){!a&&this.item&&this.item.id&&(this._delete(this.item),this.item.id=null);this._grid&&(9>e.isIE&&e.style(this.dialog.domNode,"height","350px"),this._updateUI("csv"),this._updateUI("hosted"),delete this._mStore,delete this._oStore,this._grid.destroy(),delete this._grid,this._mStore=this._oStore=this._grid=null)},_getServiceInfo:function(a,g,m){var n=[499,498],b=this._tags.get("tags"),c,d=this._serviceInfoPane.get("userInfo"),l="FeatureServer"===m&&-1===a.indexOf(".arcgis.com")&&
-1===a.indexOf(".esri.com")?a.replace("FeatureServer","MapServer"):a;!this.item.isSecured||this.item.isSecured&&401!==this.item.isSecured.httpStatusCode&&d&&d.username&&d.password?this._serviceInfoPane.getServiceInfo(l,this.item.isSecured).then(e.hitch(this,function(h){"ImageServer"===this.item.type&&h.tileInfo&&("LERC"===h.tileInfo.format||h.cacheType&&"elevation"===h.cacheType.toLowerCase()?this.item.type="ElevationServer":h.cacheType&&"raster"===h.cacheType.toLowerCase()&&(this.item.type="TiledImageServer",
h.capabilities&&-1===h.capabilities.toLowerCase().indexOf("tilesonly")&&this._updateUI(null,"imageServiceType")));c=h.credential||esri.id.findCredential(a);d=this._serviceInfoPane.get("userInfo");this.item.thumbnailToken=c&&c.token||null;this.item.serviceInfo=h;this.item.serviceInfo.isSecure=d?!0:!1;this.item.serviceInfo.userInfo=d;b=((h.documentInfo||{}).Keywords||"").split(",").concat((b||"").split(","));this._tags.set("tags",this._unique(b).join(","));this.item.extent=h.fullExtent||h.extent;this.enable()}),
e.hitch(this,function(h){this._reload?this.enable():-1!==e.indexOf(n,h.code)?(this.enable(),this._updateUI("nosvcauth","svcauth"),this.item.checkUrlError?this._updateUI("storecredentials",null):this._updateUI(null,"storecredentials"),this.item.serviceInfo={isSecure:!0},this.item.isSecured=!0):h&&403===h.code?(this._showError(h),this.item.serviceInfo={isSecure:!0},this.item.isSecured=!0):h&&this.item.checkUrlError&&this.item.checkUrlError.message?this._showError({message:this.item.checkUrlError.message}):
"FeatureServer"!==m?this._showError(h&&h.message?h:{message:esri.substitute({name:g},this.i18n.errors.serviceNotExist.message)}):this._getServiceInfo(a.replace("MapServer","FeatureServer"),g,null)})):this.item.isSecured&&(this.item.isSecured.isFederatedWithWebTierAuth||401===this.item.isSecured.httpStatusCode)?this._request(this.item.url,{},{addToken:!1}).then(e.hitch(this,function(h){this.item.serviceInfo=h;b=((h.documentInfo||{}).Keywords||"").split(",").concat((b||"").split(","));this._tags.set("tags",
this._unique(b).join(","));this.item.extent=h.fullExtent||h.extent;this.enable()}),e.hitch(this,function(h){this._showError({message:esri.substitute({name:item.title},this.i18n.errors.serviceNotExist.message)},null,!0);throw Error();})):this.enable()},_getOGCServiceInfo:function(a,g){var m=new esri.layers.WMSLayer(this._stripParameters(a,"service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "))),n=new e.Deferred,b=e.connect(m,
"onLoad",e.hitch(this,function(){e.disconnect(b);n.resolve(m)})),c=e.connect(m,"onError",e.hitch(this,function(){e.disconnect(c);this._showError({message:esri.substitute({name:g},this.i18n.errors.serviceNotExist.message)},null,!0);n.cancel()}));return n},_getWFSVersionFromUrl:function(a){var g="2.0.0";a=a.substring(a.indexOf("?")+1,a.length);a=e.queryToObject(a);a.version&&(g=a.version);return g},_getWFSServiceInfo:function(a,g,m){var n=new e.Deferred,b=new esri.layers.WFSLayer,c=this._getWFSVersionFromUrl(a),
d=this._stripParameters(a,["version","service","request","layer","typename"]),l=m||{version:c||"2.0.0",url:d},h=e.connect(b,"onError",e.hitch(this,function(){"2.0.0"===b.toJson().version?this._getWFSServiceInfo(a,g,{version:"1.1.0",url:d}).then(function(f){n.resolve(f)}):"1.1.0"===b.toJson().version?this._getWFSServiceInfo(a,g,{version:"1.0.0",url:d}).then(function(f){n.resolve(f)}):(e.disconnect(h),this._showError({message:esri.substitute({name:g},this.i18n.errors.serviceNotExist.message)},null,
!0),n.cancel())}));b.initialize(l,e.hitch(this,function(f){f&&f.length?(this._wfsLayer=e.mixin(b,{layers:f}),this.elementValue("url",l.url),n.resolve(this._wfsLayer)):(this._showError({message:esri.substitute({name:g},this.i18n.errors.serviceNotExist.message)},null,!0),this._wfsLayer=null,n.cancel())}));return n},_getWMTSOptions:function(a){var g=arcgisonline.sharing.util.urlToObject(a),m={},n=g.query&&g.query.request||"";if("wmts"===(g.query&&g.query.service||"").toLowerCase()&&"getcapabilities"===
n.toLowerCase()||-1<a.toLowerCase().indexOf("/1.0.0/wmtscapabilities.xml"))m=e.mixin(m,{serviceMode:"KVP"});return m},_getWMTSServiceInfo:function(a,g,m){var n=new e.Deferred,b=m||this._getWMTSOptions(a),c=this._stripParameters(a,"version service request layer style format tilematrixset tilematrix tilerow tilecol".split(" ")),d=new esri.layers.WMTSLayer(c,b),l,h=e.connect(d,"onError",e.hitch(this,function(){e.disconnect(h);if(!b.serviceMode)return this._getWMTSServiceInfo(a,g,{serviceMode:"KVP"}).then(e.hitch(this,
function(r){n.resolve(this._wmtsLayer)}));this._wmtsLayer=null;this._showError({message:esri.substitute({name:g},this.i18n.errors.serviceNotExist.message)},null,!0);n.cancel()})),f=e.connect(d,"onLoad",e.hitch(this,function(r){e.disconnect(f);(l=r.layers)&&l.length?(c=c.replace(/\/1.0.0\/wmtscapabilities.xml/i,""),this.elementValue("url",c),this._wmtsLayer=e.mixin(d,{layers:l,wmtsUrl:c}),n.resolve(this._wmtsLayer)):(this._showError({message:esri.substitute({name:g},this.i18n.errors.serviceNotExist.message)},
null,!0),this._wfsLayer=null,n.cancel())}));return n},_loadOGC:function(a){this.item.ogcInfo=a;this.item.url=a.url;this.elementValue("url",a.url);this.elementValue("title",a.title);var g=[];e.forEach(a.layerInfos,e.hitch(this,"_getWMSLayers",g));e.some(g,function(m,n){m.visible=!0;return 9<n});this._createGrid(g);this._grid.canSort=e.hitch(this,function(m){return 1!==Math.abs(m)});this._gridConnects.push(e.connect(this._oStore,"onSet",e.hitch(this,function(m,n){"visible"===n&&(e.byId("_ogcCB").checked=
this._mStore.query({visible:!0}).length===this._mStore.data.length)})));this._gridConnects.push(e.connect(this._grid,"onHeaderCellClick",e.hitch(this,function(m){if(!1!==esri.isDefined(m.target.checked)){var n=m.target.checked;this._mStore.query({visible:!n}).forEach(function(b){b.visible=n;this._mStore.put(b)},this);this._grid._fetch(0,!0)}})))},_loadWFS:function(a){var g=a.layers||[],m,n,b,c=[];e.forEach(this._gridConnects,e.disconnect);this.item.wfsInfo=a;this.elementValue("title",a.title);e.forEach(g,
function(d,l){c.push({label:d.title||d.name,value:l})});this._gridConnects.push(e.connect(this._wfsLayers,"onChange",e.hitch(this,function(d){n=g[d];b={layerName:n.name,mode:"snapshot",title:n.title||n.name,fullExtent:n.extent};a.selectLayer(b,e.hitch(this,function(l){a=e.mixin(a,{selectedLayer:b});(m="esriGeometryComplex"===a.geometryType)?(a.isComplex=!0,this._wfsGeometryType.set("value","none"),esri.show(this._wfsComplexOptions)):(a.isComplex=!1,this._wfsGeometryType.set("value",a.geometryType),
esri.hide(this._wfsComplexOptions))}))})));this._wfsLayers.set("options",c);this._wfsLayers.set("value",0,!1);this._wfsLayers.onChange(0);this._basicStandby.hide();this.enable();this._updateUI(null,"hosted");this._updateUI(null,"wfs")},_loadWMTS:function(a){var g,m=a.layers||[],n,b,c=[{label:this.i18n.addLayerFromUrlDlg.chooseWMTSLayer,value:0}],d=[];e.forEach(this._gridConnects,e.disconnect);this.item.wmtsInfo=a;e.forEach(m,function(l,h){c.push({label:l.title||l.name,value:h+1})});this._gridConnects.push(e.connect(this._wfsLayers,
"onChange",e.hitch(this,function(l){0<l?(n=m[l-1],this._wmtsLayer=e.mixin(this._wmtsLayer,{selectedLayer:n}),d=[],b=n.tileMatrixSetInfos||[],e.forEach(b,function(h,f){d.push({label:h.tileMatrixSet,value:f})}),this._tileMatrixSetInfos.set("options",d),this._tileMatrixSetInfos.set("value",0),g=1<b.length?"show":"hide",esri[g](this._tileMatrixSetInfoOptions)):this._wmtsLayer=null})));a=1<c.length?1:0;this._wfsLayers.set("options",c);this._wfsLayers.set("value",a,!1);this._wfsLayers.onChange(a);this._basicStandby.hide();
this.enable();this._updateUI(null,"hosted");this._updateUI(null,"wfs")},_loadCSV:function(a){if(a){var g=a.publishParameters||{},m="coordinates"===g.locationType?"locationTypes":"addressTypes",n=g.layerInfo&&g.layerInfo.fields||[];this.item.csvInfo=a;this.item.publishParameters=g;if(!this._isPortal&&this._isWorldGeocodeServer||this._isPortal&&this._isServiceProxyAgoWorldGeocodeServer)this._isWorldGeocodeServer=esri._isDefined(a.publishParameters.sourceCountry),a=this._countryCodes.value||a.publishParameters.sourceCountry||
"world",this._countryCodes.set("value","wo"===a?"world":a,!1);this._createGrid(n);this._publishOnly&&this._updateUI(null,"csv");this._allowGeocode||"addressTypes"!==m||(m="none",e.query(".noGeocode").style("display","none"),e.query(".tableOnly").style("display",""));this.elementValue("geocode",m);this.onChangeGeocode(m);e.attr(this._locatorOutputHelpIcon,"href",esriGeowConfig.self&&esriGeowConfig.self.helpMap?esriGeowConfig.self.helpBase+esriGeowConfig.self.helpMap.m["120002541"]:"#");this._gridConnects.push(e.connect(this._oStore,
"onSet",e.hitch(this,function(b,c,d,l){"locationType"===c&&this._mStore.query({locationType:l}).forEach(function(h){h.name!==b.name&&(h=this._mStore.get(h.name),h.locationType="unknown",this._mStore.put(h),this._grid._fetch(0,!0))},this)})));this._gridConnects.push(e.connect(this._grid,"onApplyCellEdit",e.hitch(this,function(b,c,d){"locationType"!==d||b!==(g.standardizedFieldNames&&g.standardizedFieldNames.Postal)&&b!==this.i18n.addressTypes.Postal||(b=this._grid.getItem(c),b.__isTypeUpdatedByUser||
(b.type="esriFieldTypeString",b.__isTypeUpdatedByUser=!0,this._mStore.put(b)))})))}else this._publishOnly&&this._showNoGeocodeDlg()},_loadExcel:function(a){if(a){var g=""===this._allExcelSheets.value?0:this._allExcelSheets.value,m=a.publishParameters||{},n=m.layers[g]&&"coordinates"===m.layers[g].locationType&&!this.changingGeocodeCountry?"locationTypes":"addressTypes";this.changingGeocodeCountry=!1;var b=m.layers&&m.layers[g].fields||[];this.item.excelInfo=a;this.item.publishParameters=m;if(!this._isPortal&&
this._isWorldGeocodeServer||this._isPortal&&this._isServiceProxyAgoWorldGeocodeServer)this._isWorldGeocodeServer=esri._isDefined(a.publishParameters.layers[g].sourceCountry),a=a.publishParameters.layers[g].sourceCountry||"world",this._countryCodes.set("value","wo"===a?"world":a,!1);this._fetchAllExcelLayers(m,g);this._createGrid(b,g);this._publishOnly&&this._updateUI(null,"csv");this._allowGeocode||"addressTypes"!==n||(n="none",e.query(".noGeocode").style("display","none"),e.query(".tableOnly").style("display",
""));this.elementValue("geocode",n);this.onChangeGeocode(n);this._gridConnects.push(e.connect(this._oStore,"onSet",e.hitch(this,function(c,d,l,h){"locationType"===d&&this._mStore.query({locationType:h}).forEach(function(f){f.name!==c.name&&(f=this._mStore.get(f.name),f.locationType="unknown",this._mStore.put(f),this._grid._fetch(0,!0))},this)})));this._gridConnects.push(e.connect(this._grid,"onApplyCellEdit",e.hitch(this,function(c,d,l){"locationType"!==l||c!==(m.standardizedFieldNames&&m.standardizedFieldNames.Postal)&&
c!==this.i18n.addressTypes.Postal||(c=this._grid.getItem(d),c.__isTypeUpdatedByUser||(c.type="esriFieldTypeString",c.__isTypeUpdatedByUser=!0,this._mStore.put(c)))})))}else this._publishOnly&&this._showNoGeocodeDlg()},_getWMSLayers:function(a,g){g.subLayers&&g.subLayers.length?e.forEach(g.subLayers,e.hitch(this,"_getWMSLayers",a)):a.push({name:g.name,visible:!1,title:g.title.replace(/ /g,String.fromCharCode(160)),extent:g.extent,legendURL:g.legendURL,queryable:g.queryable})},_getThumbnail:function(a,
g){var m=new e.Deferred;if(a.thumbnailURL)return m.resolve(a.thumbnailURL),m;if("MapServer"!==a.type&&"FeatureServer"!==a.type&&"ImageServer"!==a.type)return m.resolve(null),m;if("MapServer"===a.type||"ImageServer"===a.type||-1!==a.url.indexOf("MapServer")){var n=a.serviceInfo||{},b=a.extent||{};g=a.url||g.url;a=this._extent2String(a.extent);m.resolve(b?arcgisonline.map.core.buildExportCall(g,a,null,null,"800,532",null,"image",null,n):null);return m}m=g.extent.split(",");return arcgisonline.map.thumbnail.buildThumbnailURLFromFSUrl(a.url,
[[parseFloat(m[0]),parseFloat(m[1])],[parseFloat(m[2]),parseFloat(m[3])]])},_project:function(a,g){var m=new e.Deferred,n=new esri.geometry.Extent({xmax:2E7,xmin:-2E7,ymax:2E7,ymin:-2E7,spatialReference:{wkid:102100}});handler=e.hitch(this,function(b){m.resolve(b&&b.length&&b[0]&&b[0].type&&"extent"===b[0].type?b[0]:n)});a=new esri.geometry.Extent(a);arcgisonline.map.core.projectExtent(a,g,handler,handler);return m},_projectExtent2WGS84:function(a){var g=a&&a.extent||this.item.extent||{},m=g.spatialReference&&
(g.spatialReference.wkid||g.spatialReference.wkt),n=new esri.SpatialReference({wkid:4326}),b=new e.Deferred;if(m&&!arcgisonline.map.core.sameSpatialReference(n,g.spatialReference))return this._project(g,n).then(e.hitch(this,function(c){a.extent=this._extent2String(c);return a}));a.extent=this._extent2String(g);b.resolve(a);return b},_showItem:function(a){if(!a||a.error)return this._showError(a);var g=this.item.type.toLowerCase(),m=a.buildCache&&"scenepackage"!==g,n=[this.item.id],b=this._categories?
this._categories.getCategories(!0):null,c=a.jobId&&(this._isPortal||"scenepackage"!==g)?"\x26jobid\x3d"+a.jobId:"";a.id?n.push(a.id):a&&a.length&&a.forEach(function(d){d.id&&n.push(d.id)});arcgisonline.pages.utils.categories.setItemCategories(n,b).then(function(){esri.hide(this.dialog&&this.dialog.domNode);if(a.id){if(this.params&&this.params.label&&this.params.telemetry){var d={label:"add",category:"new item",pageName:"my content",details:this.params.label};this._telemetryURLAttribute&&(d.attribute=
this._telemetryURLAttribute);this.params.telemetry.logEvent(d)}return setTimeout(function(){window.location="item.html?id\x3d"+a.id+c+(m?"#settings/buildCache":"")},400)}a&&a.length&&this._showServiceResultsDlg(a);this.item&&(this.item.id=null);this.dialog&&this.dialog.hide()}.bind(this))},_showServiceResultsDlg:function(a){var g=e.doc.createDocumentFragment(),m=e.create("div",{"class":"esriAGOServicesDlg esriItemLinks"},g,"first"),n=e.create("ul",null,m),b;e.forEach(a,e.hitch(this,function(d){esri.isDefined(d.error)?
(d.type="Map Service"===d.type?"Tile Layer":"Image Service"===d.type?"Imagery Layer":"Feature Layer",d.error&&d.error.message&&-1<d.error.message.indexOf("already exist")&&(d.error.message=this.i18n.errors.serviceDefinitionExists.message),e.create("li",{innerHTML:esri.substitute(e.mixin(d,{error:d.error.message}),this.i18n.publishServicesError)},n)):(b="item.html?id\x3d"+d.id+(d.jobId?"\x26jobid\x3d"+d.jobId:"")+("Map Service"===d.type?"#settings/manageTiles":""),d=e.mixin(d,{linkTitle:this.i18n["Map Service"!==
d.type?"publishServiceView":"publishServiceBuild"],itemUrl:b}),d.type="Map Service"===d.type?"Tile Layer":"Feature Layer",e.create("li",{innerHTML:esri.substitute(d,this.i18n.publishServicesSuccess)},n))}));a=(new K.Dialog).placeAt(e.body());a.set({title:this.i18n.publishServicesTitle,content:g});a.show();var c=e.connect(a,"onHide",this,function(){e.disconnect(c);e.publish("itemAdded",[])})},_fetchCountryCodes:function(a){var g=[],m=esriGeowConfig.self||{};m=(m=(m.user||{}).region||m.ipCntryCode||
"")&&"wo"===m.toLowerCase()?"world":m;for(var n in this.countryCodes)g.push({label:this.countryCodes[n],value:n.toLowerCase()});a&&(g=g.filter(function(b){return a[b.value]}));g=g.sort(function(b,c){return b.label<c.label?-1:b.label>c.label?1:0});this._countryCodes.set("options",g);if(!this._countryCodes.value||a&&!a[this._countryCodes.value])this.countryCodes[m]&&(a&&a[m]||!a)?this._countryCodes.set("value",m.toLowerCase(),!1):a&&2===Object.keys(a).length?this._countryCodes.set("value",Object.keys(a).filter(function(b){return"world"!==
b})[0],!1):this._countryCodes.set("value","world",!1);this._sourceCountry=m.toLowerCase()},_fetchAllExcelLayers:function(a,g){var m=[];this._updateUI(null,"allExcelSheets");for(var n=0;n<a.layers.length;n++)m.push({label:a.layers[n].name,value:n});this._allExcelSheets.set("options",m);this._allExcelSheets.set("value",g,!1)},_fetchTimeZones:function(){var a=[],g;for(g in this.timeZones)a.push({label:this.timeZones[g],value:"UTC"!==g?parseFloat(g):g});this._timeZones.set("options",a);this._timeZones.set("value",
1230);e.attr(this._timezoneHelpIcon,"href",esriGeowConfig.self&&esriGeowConfig.self.helpMap?esriGeowConfig.self.helpBase+esriGeowConfig.self.helpMap.m["120001098"]:"#")},_fetchItemData:function(a){return this._request(this._contentUri+"/items/"+a.id+"/data")},_fetchManifest:function(a){var g=new e.Deferred;this.disable(null,this.i18n.fetchOpExtension);e.query(".opextwarningmsg",this.domNode).style("display","none");esri.request({url:a,handleAs:"json"},{useProxy:!1}).then(e.hitch(this,function(m){this.enable();
g.resolve(m)}),e.hitch(this,function(m){m&&m.message&&(-1<m.message.indexOf("Unexpected string")||-1<m.message.indexOf("Invalid or unexpected token"))&&(m=this.i18n.errors.opExtensionInvalidJson);this._showError(m);this.enable();g.cancel()}));return g},_request:function(a,g,m,n,b){g=e.mixin(e.mixin({},this._requestParams),g||{});var c=this._util.request({url:a,content:g},m);c.then(e.hitch(this,function(d){return d.error?this._showError(d.error):d}),e.hitch(this,function(d){if(this._isPortal&&d.message&&
-1<d.message.indexOf("ERROR 001551"))throw this._analyzeError=!0,this._basicStandby.hide(),this.enable(),d;b?b(d):this._showError(e.mixin(d,{code:"timeout"===d.dojoType?408:d.code,message:d.message,details:d.details}),c)}));return c},_uploadFile:function(a,g,m){var n=e.mixin({},this._requestParams),b=this._util.request({url:g,content:n,form:a,timeout:0});b.then(e.hitch(this,function(c){e.destroy(m);return c.error?this._showError(c.error):c}),e.hitch(this,function(c){e.destroy(m);return this._showError(c,
b)}));return b},_addItem:function(a,g){var m=this.itemAPI.addItem.call(this.itemAPI,{folderId:"/"!==this.folder?this.folder:void 0},a,e.byId("file").files[0]);m.then(function(n){e.destroy(g);return n.error?this._showError(n.error):n}.bind(this),function(n){e.destroy(g);return"Request canceled"===n.message?!1:this._showError(n,m)}.bind(this));return m},_checkStatus:function(a,g,m,n){a||m();this._request(this._userContentUri+"/items/"+a.id+"/status").then(e.hitch(this,function(b){b=b||{status:"failed"};
if("completed"===b.status)return g(a);if("failed"===b.status||""===b.status)return b&&b.statusMessage&&0<b.statusMessage.indexOf("Invalid Shapefile")?b.statusMessage=esri.substitute({name:a.item},this.i18n.errors.invalidShapefile.message):b&&b.statusMessage&&0<b.statusMessage.indexOf("Invalid File Geodatabase")&&(b.statusMessage=esri.substitute({name:a.item},this.i18n.errors.invalidFileGeodatabase.message)),m({message:b.statusMessage||this.i18n.errors.error});n=(n||500)+250;setTimeout(e.hitch(this,
function(){this._checkStatus(a,g,m,n)}),n)}),m)},_getFileAndType:function(){var a=/(?:\.([^.]+))?$/,g=e.byId("file").value.replace(/^.*(\\|\/|:)/,""),m=g&&a.exec(g)[1]?a.exec(g)[1].toLowerCase():"";a="";g&&(a=-1===g.lastIndexOf(".")?g:g.substring(0,g.lastIndexOf(".")));a=a.replace(/\./g,"_");this._itemExistsError=!1;if(window.FileReader){var n=e.byId("file").files[0].size;if(!this._isPortal&&("kml"===m||"kmz"===m)&&n>this._maxKmlFileSize)return this._showError(this.i18n.errors.kmlFileToLarge);if(n>
this._maxFileSize)return this._showError(this.i18n.errors.fileToLarge)}"xls"===m&&(m="xlsx");if(this.item&&this.item.type&&"desktopapplication"===this.item.type)return this.item.type="desktopapplication",this.item.item=g,this.item.name=g,this.elementValue("title",a),this.item.isZip="zip"===m,"zip"===m?this._itemExists({item:g,title:a,name:g,type:this.item.type}):this._showError({message:this.i18n.fileZipFormat});this._isRasterFunctionTemplate(g)&&(m="rft",a=this._getRasterFunctionTemplateName(g));
if("tpk"===m&&-1<g.indexOf("-"))return this.item={error:this.i18n.errors.invalidFileTitle},this._showError({message:this.i18n.errors.invalidFileTitle.message});this.deleteGrid();this._updateUI("wfs",null);this._updateUI("zip","title");this._updateUI("csv");this._updateUI("shapefile");this._updateUI("servicedefinition");this._updateUI("publish");this._updateUI("codesample");this._updateUI("arcpadpackage");this._updateUI("stylx");this.item={};"tpkx"===m&&(m="tilepackage",this.item.types=(this.item.types||
[]).concat(["is-compact"]));m="sd"===m?"servicedefinition":m;m="tpk"===m?"tilepackage":m;m="spk"===m||"slpk"===m?"scenepackage":m;m="vtpk"===m?"vectortilepackage":m;m="dlpk"===m?"deeplearningpackage":m;this.item.type=m;this.item.item=g;this.item.isFile=!0;this.item.fileExtension=m;this.elementValue("title",a);e.attr(this._enablePublishingLabel,"innerHTML",this.i18n["tilepackage"!==m?"publishService":"publishNamedService"]);var b=n=!0,c=!0,d=!0;if(this.allowPublish||this._allowPublishChanged)this._allowPublishChanged&&
(this.allowPublish=!0,this._allowPublishChanged=!1),"shapefile"!==m&&"csv"!==m&&"xlsx"!==m&&"geojson"!==m&&"json"!==m&&("zip"!==m||"shapefile"!==this.elementValue("archiveSelect")&&"filegeodatabase"!==this.elementValue("archiveSelect"))||this._roleCanPublishFeatures||(this.allowPublish=b=n=!1,this._allowPublishChanged=!0),"tilepackage"!==m||this._roleCanPublishTiles||(this.allowPublish=d=n=!1,this._allowPublishChanged=!0),"scenepackage"!==m||this._roleCanPublishScenes&&(!this._isPortal||esriGeowConfig.self.supportsSceneServices)||
(this.allowPublish=c=n=!1,this._allowPublishChanged=!0),"vectortilepackage"!==m||this._roleCanPublishTiles||(this.allowPublish=d=n=!1,this._allowPublishChanged=!0),"servicedefinition"===m&&(this._roleCanPublishFeatures||this._roleCanPublishTiles?(this._roleCanPublishFeatures||(b=!1),this._roleCanPublishTiles||(d=!1)):(this.allowPublish=d=b=n=!1,this._allowPublishChanged=!0));this._enablePublishing.set("value",n);this._itemExists({item:g,title:a,name:g,type:this.item.type}).then(e.hitch(e.hitch(this,
function(l){if(!l){if("zip"===m)m=this.elementValue("archiveSelect"),this.item.type=m,this.item.fileExtension="ZIP",this._updateUI("app","zip"),this._updateUI(null,this.allowPublish&&m in this._publishTypes&&b?m:null),this._updateUI(null,this.allowPublish&&m in this._publishTypes&&b?"publish":null);else if("csv"===m&&this.allowPublish&&b&&this._publishTypes.csv||"xlsx"===m&&this.allowPublish&&b&&this._publishTypes.xlsx)this._basicStandby.show(),this._addFile();else if("geojson"!==m&&"json"!==m||!this.allowPublish||
!b&&!d)if("servicedefinition"!==m&&"geojson"!==m&&"json"!==m||!this.allowPublish||!b&&!d)if("tilepackage"===m)this.allowPublish&&d&&(this._updateUI(null,"publish"),this._updateUI(null,m));else if("scenepackage"===m)this.allowPublish&&c&&(this._updateUI(null,"publish"),this._updateUI(null,m));else if("vectortilepackage"===m)this.allowPublish&&d&&(this._updateUI(null,"publish"),this._updateUI(null,m));else if("opcenteraddin"===m){if(this._user&&"account_admin"!==this._user.role&&"account_publisher"!==
this._user.role)return this._showError(this.i18n.errors.insuffientPrivs)}else if("stylx"===m)this._updateUI(null,"stylx"),this._updateUI(null,"file");else if(this.itemInfo[m])this._updateUI(null,"file");else return this._showError({message:this.i18n.errors.unknownType.message});else this._updateUI("title","publish"),this._updateUI(null,m);else this._updateUI(null,"publish"),this._updateUI(null,m);return{file:g,type:m}}})));"ipynb"==m&&this.selectNotebookRuntimeContainer.classList.remove("hide")},
_getUrlAndType:function(){this._inlineError.classList.remove("is-active");var a=/http.+\/(arcgis\/rest\/services|\/.*\/rest\/services|arcgis\/services)\/?/ig,g=/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|WMServer|SceneServer|VectorTileServer|StreamServer|WorkspaceServer|GeoenrichmentServer)).*/ig,m=decodeURIComponent(this.elementValue("url")),n=m&&-1<m.indexOf("/dynamicLayer?")?m.substring(0,m.indexOf("/dynamicLayer")):
m.split("?")[0]||m;"/"==n.substr(-1)&&(n=n.substr(0,n.length-1));if("opext"===this._getRadioButtonValue("app")||this._getRadioButtonValue(!1))e.query(".opextwarningmsg",this.domNode).style("display","none"),this.elementValue("title","");this.deleteGrid();this._updateUI("wfs",null);this._updateUI("complexOptions",null);this._updateUI("svcauth","all");this._updateUI(null,"storecredentials");this._updateUI("imageServiceType",null);this.item&&this.item.serviceInfo&&(this.item.serviceInfo=null);if(n){/(http|https|ftp):\/\/?/.exec(n)||
this.elementValue("url",n="https://"+n);this.item=this.item||{};!(-1<n.indexOf("http://"))||esriGeowConfig.self.isPortal||esriGeowConfig.self.allSSL&&"MapServer"===c||this._showError({message:this.i18n.httpNotSupported},null,!0);if("url"===this.elementValue("itemType")){var b=n.replace(/^.*\//,"").replace(/.[^.]*$/,"");var c=this._getRadioButtonValue("web");this.item.type=c;if("ags"===c){b=n.replace(g,"").replace(/^.*\//,"").replace(/\?.*$/,"");c=(a=n.replace(a,"").match(g))&&a.length?a[0].split("/")[1]:
null;if(!c||"SceneServer"===c&&!esriGeowConfig.sceneViewerEnabled)return c=esri.substitute({portalName:esriGeowConfig.portalName||this.i18n.portalName},this.i18n.errors.unknownAGSType.message),this._showError({message:c},null,!0);a=a.length?a[0].split("/")[2]:null;"mapserver"===c&&(c="MapServer");"MapServer"!==c||isNaN(a)||(c="FeatureServer");this.item.type=c;!esriGeowConfig.allSSL&&"https:"!==location.protocol||!this._util.isHostedService(n)&&!this._util.supportsHttps(n)||(n=n.replace("http:/","https:/"));
this.disable(!1,this.i18n.fetching);this._serviceInfoPane.getIsSecured(n).then(e.hitch(this,function(d){if(d.secured)this._serviceInfoPane.isFederatedWithWebTierAuth(n,d).then(e.hitch(this,function(l){if(l||401===d.httpStatusCode)return-1===l?(this.item.isSecured=!1,this.item.checkUrlError=!0,this._storeAuth.set("checked",!1)):this.item=e.mixin(this.item,{isSecured:{httpStatusCode:401,isFederatedWithWebTierAuth:l}}),this._getServiceInfo(n);this.item.isSecured=d;this._updateUI("nosvcauth","svcauth");
this._updateUI(null,"storecredentials");d.isOverride&&this._storeAuth.set("checked",!0);this._serviceInfoPane.get("userInfo")&&this._getServiceInfo(n);this.enable()}));else return this._getServiceInfo(n)}),e.hitch(this,function(d){this.item.isSecured=!1;this.item.checkUrlError=d;this._storeAuth.set("checked",!1);return this._getServiceInfo(n)}))}else{if("ogc"===c)return this._basicStandby.show(),this.disable(!1,this.i18n.fetching),this._getOGCServiceInfo(this.elementValue("url"),b).then(e.hitch(this,
"_loadOGC"));if("wfs"===c)return this._basicStandby.show(),this.disable(!1,this.i18n.fetching),this._getWFSServiceInfo(this.elementValue("url"),b).then(e.hitch(this,"_loadWFS"));if("wmts"===c)return this._basicStandby.show(),this.disable(!1,this.i18n.fetching),this._getWMTSServiceInfo(this.elementValue("url"),b).then(e.hitch(this,"_loadWMTS"))}}else if(b=n.replace(/^.*\//,"").replace(/.[^.]*$/,""),this.item.type=this._getRadioButtonValue("app"),"opext"===this.item.type||"appbldrext"===this.item.type)-1===
n.indexOf(".json",n.length-5)?this._showError({message:this.i18n.errors["opext"===this.item.type?"opExtensionNotJson":"appBldrExtensionNotJson"]}):this._fetchManifest(n).then(e.hitch(this,function(d){this._manifestInfo=d;"opext"===this.item.type?this._validateOpExtension(d)&&(b=d&&(d.name||d.title||b),this.elementValue("title",decodeURI(b))):"appbldrext"===this.item.type&&this._validateAppBuilderExtension(d)&&(b=d&&(d.name||d.title||b),this.elementValue("title",decodeURI(b)))}));this.item.url=n;this.elementValue("title",
decodeURI(b))}},_getDefaultPublishParameters:function(a){var g=a.type.toLowerCase(),m=a.types&&-1<a.types.indexOf("is-compact"),n={itemId:a.id,filetype:g};"servicedefinition"===g?n.filetype="serviceDefinition":"tilepackage"===g?n.filetype=m?"compactTilePackage":"tilePackage":"scenepackage"===g?n.filetype="scenePackage":"json"===g?n.filetype="geojson":"imagecollection"===g?(n.filetype="imagecollection",n.outputType="image service"):n.filetype=g;if("servicedefinition"!==g&&"tilepackage"!==g&&"scenepackage"!==
g&&"vectortilepackage"!==g)n.publishParameters=e.mixin(a.csvInfo&&a.csvInfo.publishParameters||a.publishParameters||{},{hasStaticData:!0,name:this.elementValue("title").replace(/ /g,"_"),maxRecordCount:2E3}),n.publishParameters.layerInfo=e.mixin(n.publishParameters.layerInfo||{},{capabilities:"Query"}),"csv"===g&&(n.publishParameters.persistErrorRecordsForReview=!0);else{if("tilepackage"===g||"scenepackage"===g||"vectortilepackage"===g)n.publishParameters=e.mixin(a.publishParameters||{},{name:this.elementValue("title").replace(/ /g,
"_"),maxRecordCount:2E3}),"scenepackage"===g?n.outputType="sceneService":"vectortilepackage"===g&&(n.outputType="VectorTiles");n.buildInitialCache="tilepackage"===g||("vectortilepackage"===g||"scenepackage"===g)&&!this._isPortal}return n},_getSpatialReference:function(a){var g=a.serviceInfo||{};if(a="ImageServer"!==a.type?g.spatialReference:g.extent&&g.extent.spatialReference){if(a.wkid)return a.wkid;if(a.wkt&&-1!==a.wkt.search(/^PROJCS/i))return/^PROJCS\["[A-Za-z0-9_]*/i.exec(a.wkt)[0].split("[")[1]}return null},
_extent2String:function(a,g){g=g||4;var m="";if(a&&this._isValidNum(a.xmin)&&this._isValidNum(a.ymin)&&this._isValidNum(a.xmax)&&this._isValidNum(a.ymax)){m=e.number.round(a.xmin,g);var n=e.number.round(a.ymin,g),b=e.number.round(a.xmax,g);a=e.number.round(a.ymax,g);m=isNaN(m)||isNaN(n)||isNaN(b)||isNaN(a)?"":m+","+n+","+b+","+a}return m},_checkProtocol:function(){return-1===window.location.protocol.toLowerCase().indexOf("https")&&esriGeowConfig.self&&esriGeowConfig.self.isWebTierAuth?(this._showReloadDlg(),
!1):!0},_isValidNum:function(a){return isNaN(a)||void 0===a||null===a?!1:!0},_isRasterFunctionTemplate:function(a){if(!esri.isDefined(a))return!1;var g=a.substring(a.length-9,a.length).toLowerCase();a=a.substring(a.length-8,a.length).toLowerCase();return".rft.json"==g||".rft.xml"==a},_getRasterFunctionTemplateName:function(a){var g=a&&a.substring(0,a.toLowerCase().lastIndexOf(".rft.json")),m=a&&a.substring(0,a.toLowerCase().lastIndexOf(".rft.xml"));return a?g||m:""},_updateUI:function(a,g){a&&e.query("."+
a).style("display","none");g&&(this._publishOnly||"csv"!==g&&"xlsx"!==g?this._publishOnly||"json"!==g&&"geojson"!==g&&"shapefile"!==g&&"servicedefinition"!==g&&"filegeodatabase"!==g||(e.place(this._publishNode,this._publishServiceDiv,"first"),esri.show(this._publishServiceDiv),esri.hide(this._publishCSVDiv)):(e.place(this._publishNode,this._publishCSVDiv,"first"),esri.show(this._publishCSVDiv),esri.hide(this._publishServiceDiv)),e.query("."+g).style("display",""),"csv"!==g&&"xlsx"!==g||this._allowGeocode||
(e.query(".portal").style("display","none"),e.query(".noGeocode").style("display","")),"imageServiceType"===g&&this._defaultImageServiceTypeNode.set("checked",!0));e.query(".esriAGOAddItemForm").style("height","auto");this.dialog.resize()},_itemExists:function(a){var g=a.title,m=this.folder&&"/"!==this.folder?this.folder:"root",n=this.itemInfo[a.type.toLowerCase()]?this.itemInfo[a.type.toLowerCase()].type:a.type;m={q:'title:"'+g+'" AND type:"'+n+'" AND owner:"'+this._user.username+'" AND ownerfolder:"'+
m+'"',num:1};var b,c=new e.Deferred;this._util.request({url:esriGeowConfig.restBaseUrl+"search",content:m}).then(e.hitch(this,function(d){d&&d.total?(b=d.results&&d.results.shift(),!this._itemExistsError&&(this.item&&this.item.id===b.id||g!==b.title)?c.resolve(!1):(this._itemExistsError=!0,d=this.item.isFile?esri.substitute({type:this.item.fileExtension,item:a.item,name:a.name||a.title,title:a.title},this.i18n.errors.itemExistsFile.message):esri.substitute({type:n,item:a.item,title:g},this.i18n.errors.itemExists.message),
c.resolve(!this._showError({message:d})))):c.resolve(!1)}));return c},_serviceNameAvailable:function(a){a="tilepackage"===a.type?"Map Service":"scenepackage"===a.type?"Scene Service":"vectortilepackage"===a.type?"Vector Tile Service":"imagecollection"===a.type?"Image Service":"Feature Service";a={name:this.elementValue("title").split(" ").join("_"),type:a};var g=esriGeowConfig.self&&esriGeowConfig.self.user&&(esriGeowConfig.self.user.accountId||esriGeowConfig.self.user.orgId);this.disable(["addItem"]);
return this._request(this._portalUrl+"/"+g+"/isServiceNameAvailable",a).then(e.hitch(this,function(m){return m.available?!0:this._showError(this.i18n.errors.serviceNameExists)}))},_loadConnections:function(){esriGeowConfig.isRightToLeft&&(9>e.has("ie")||5>e.has("trident"))&&this._tags._textTags.set("placeHolder","");this.own(e.subscribe("onSelectedTagsUpdate",e.hitch(this,function(m){var n=this._tags.get("tags");m=n?m.split(",").concat(n.split(",")):m.split(",");this._tags.set("tags",this._unique(m).join(","))})));
9>e.isIE&&this.own(e.query(".radio").connect("onclick",e.hitch(this,function(m){(m.focusNode?e.attr(m.focusNode,"checked"):1)&&e.forEach(this.formWidgets[(m.target||m.srcElement).name].widget,e.hitch(this,function(n){e.forEach(n.observer.split(/[ ,]+/),e.hitch(this,function(b){if(!1!==n.get("value"))this[b](n.get("value"))}))}))})));this.own(e.connect(this._tagsLbl,"onclick",e.hitch(this,function(m){this._tags._inputTextBox.focus();e.query(".select2-choices",this._tags.domNode).addClass("focus")})),
e.connect(this._tags.domNode,"onfocusout",e.hitch(this,function(m){e.query(".select2-choices",this._tags.domNode).removeClass("focus")})),e.connect(this._tags.domNode,"onfocusin",e.hitch(this,function(m){e.query(".select2-choices",this._tags.domNode).addClass("focus")})));this._tagsLbl.setAttribute("for",this._tags._filterId);this._dlgConnect=e.connect(this.dialog,"hide",e.hitch(this,function(){this.deleteGrid();e.forEach([this._fileInputConnect,this._dlgConnect,this._credentialConnect].concat(this._gridConnects),
e.disconnect);this._basicStandby.destroy();this.destroy()}));this._dlgConnect=e.connect(this._geocoderSelect,"onChange",e.hitch(this,this.onChangeGeocoder));var a=arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance(),g=setInterval(e.hitch(this,function(){a.isLoaded()&&(clearInterval(g),this.learnMore.href=a.getHelpUrl(this._isPortal?"120001641":"120000597"),a.destroyRecursive())}),200);this._fileInputConnect=e.connect(e.byId("file"),"onchange",e.hitch(this,"_getFileAndType"));this._gridConnects=
[];esri.id.setProtocolErrorHandler(e.hitch(this,"_showReloadDlg"))},_getRadioButtonValue:function(a){var g;return 9>=e.isIE?(e.some(this.formWidgets[a].widget||[],function(m){return m.get("checked")?(g=m,!0):!1}),g?g.get("value"):""):this.elementValue(a)},_unique:function(a){var g={};return e.filter(a,function(m){return!m||g[m]?!1:g[m]=!0})},_stripParameters:function(a,g){a=esri.urlToObject(a);var m=[],n;for(n in a.query)-1===e.indexOf(g,n.toLowerCase())&&m.push(n+"\x3d"+a.query[n]);return a.path+
(m.length?"?"+m.join("\x26"):"")},_checkThumbnailURL:function(a){a.thumbnailURL&&(a.thumbnailURL=this._util.getStaticImagesUrl()+a.thumbnailURL);arcgisonline.sharing.util.isPortal()&&a.thumbnailURL&&0!==a.thumbnailURL.indexOf("http")&&(a.thumbnailURL=window.location.protocol+"//"+window.location.host+a.thumbnailURL);return a},_toSelectOptions:function(a,g){var m=[],n=[],b;for(b in a)m.push(a[b]),n.push(b);return{formatter:function(c){return a[c]||a[g]},options:m,values:n}},elementValue:function(a,
g){a&&"title"===a&&esri.isDefined(g)&&(g=this.elementValue(a)||g);return this.inherited(arguments)},_showReloadDlg:function(){this._reload=!0;if(window.location&&-1===window.location.protocol.indexOf("https:")){var a={title:this.i18n.reloadTitle,message:"\x3cp\x3e"+this.i18n.reloadMessage+"\x3c/p\x3e",choiceOneTitle:this.i18n.yesLabel,choiceTwoTitle:this.i18n.noLabel,choiceOneHandler:e.hitch(this,function(){window.location=window.location.href.replace("http:","https:")}),choiceTwoHandler:e.hitch(this,
function(){this._choiceDlg.hide()})};this._choiceDlg.show(a);return!1}},_showNoGeocodeDlg:function(){var a=e.connect(this._errorDlg,"onHide",e.hitch(this,function(){e.disconnect(a);this.onCancel()})),g=e.mixin({},this.i18n.errors.error,{message:this._roleCanUseGeocode?this.i18nCommon.errors.noBatchGeocoding:this.i18nCommon.errors.noGeocodingRole});this._errorDlg.show(g)},showModal:function(a){var g=new e.Deferred;this.dialog=new K.Dialog({"class":"esriAddItemDlg"});this.dialog.set({title:a.title||
this.i18n.itemProperties.addItemDlgTitle,content:this.domNode});this.dialog.show();return g},_showError:function(a,g,m){g&&g.canceled||(a=a.error||a||{},a.code=a.code||0,a=this.i18n.errors[a.code]||a,a.details=a.details&&e.isArray(a.details)&&a.details.length?e.filter(a.details,"return item !\x3d\x3d null"):null,a.message&&-1<a.message.indexOf("Unable to load")&&(a.code||(a.code=502),a=e.mixin(a,{message:this.i18nCommon.errors.errorUploadingFile})),a.messageCode&&"GWM_0011"===a.messageCode&&(a=e.mixin(a,
{message:this.i18nCommon.errors.spamContentItemCreate})),a.messageCode&&"CONT_0001"===a.messageCode&&(a=e.mixin(a,{message:this.i18nCommon.errors.CONT_0001})),a.messageCode&&"CONT_0027"===a.messageCode&&(g=this.itemInfo[this.item.type.toLowerCase()]?this.itemInfo[this.item.type.toLowerCase()].type:this.item.type,g=this.item.isFile?esri.substitute({type:g,name:this.item.name||this.item.item},this.i18n.errors.fileNameExists.message):esri.substitute({type:g,title:this.item.item},this.i18n.errors.itemExists.message),
a=e.mixin(a,{message:g})),-1<a.message.indexOf("Must specify data to be analyzed")&&(a=e.mixin(a,{message:this.i18nCommon.errors.fileNotValid})),-1<a.message.indexOf("Duplicate field names are not allowed")&&(a=e.mixin(a,{message:this.i18nCommon.errors.duplicateFields})),a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details),g=e.mixin(e.mixin({},this.i18n.errors.error),a),m?(this._inlineError.innerHTML=a.message,this._inlineError.classList.add("is-active")):
this._errorDlg.show(g));this._basicStandby.hide();this.enable();return!1},initNotebooks:function(){esriGeowConfig.userRole.canCreateNotebooks()&&this.notebookUtil.notebookServerConfigured()&&this.notebookUtil.getNotebookServer().then(e.hitch(this,function(a){a&&e.promise.all({runtimeInfo:this.notebookUtil.getNotebookRuntimesBase(a.url),serverInfo:this.notebookUtil.pingNotebookServer(a.url)}).then(e.hitch(this,function(g){g.runtimeInfo.runtimes&&g.runtimeInfo.runtimes.length&&this.notebookUtil.createRuntimeSelect(g.runtimeInfo.runtimes,
g.serverInfo.currentRuntimeVersion,this.selectNotebookRuntime,!0)}))}))}})})},"dojox/form/Manager":function(){define("dijit/_Widget dijit/_AttachMixin dijit/_WidgetsInTemplateMixin ./manager/_Mixin ./manager/_NodeMixin ./manager/_FormMixin ./manager/_ValueMixin ./manager/_EnableMixin ./manager/_DisplayMixin ./manager/_ClassMixin dojo/_base/declare".split(" "),function(e,K,p,a,g,m,n,b,c,d,l){return l("dojox.form.Manager",[e,p,K,a,g,m,n,b,c,d],{searchContainerNode:!0,buildRendering:function(){this.containerNode||
(this.containerNode=this.srcNodeRef);this.inherited(arguments)}})})},"dojox/form/manager/_Mixin":function(){define("dojo/_base/window dojo/_base/lang dojo/_base/array dojo/on dojo/dom-attr dojo/dom-class dijit/_base/manager dijit/_Widget dijit/form/_FormWidget dijit/form/Button dijit/form/CheckBox dojo/_base/declare".split(" "),function(e,K,p,a,g,m,n,b,c,d,l,h){e=K.getObject("dojox.form.manager",!0);var f=e.actionAdapter=function(v){return function(x,z,A){K.isArray(z)?p.forEach(z,function(B){v.call(this,
x,B,A)},this):v.apply(this,arguments)}};e.inspectorAdapter=function(v){return function(x,z,A){return v.call(this,x,K.isArray(z)?z[0]:z,A)}};var r={domNode:1,containerNode:1,srcNodeRef:1,bgIframe:1},q=e._keys=function(v){var x=[],z;for(z in v)v.hasOwnProperty(z)&&x.push(z);return x},t=function(v){var x=v.get("name");if(x&&v.isInstanceOf(c))if(x in this.formWidgets){var z=this.formWidgets[x].widget;K.isArray(z)?z.push(v):this.formWidgets[x].widget=[z,v]}else this.formWidgets[x]={widget:v,connections:[]};
else x=null;return x},w=function(v){var x={};f(function(z,A){(z=A.get("data-dojo-observer")||A.get("observer"))&&"string"==typeof z&&p.forEach(z.split(","),function(B){(B=K.trim(B))&&K.isFunction(this[B])&&(x[B]=1)},this)}).call(this,null,this.formWidgets[v].widget);return q(x)},u=function(v,x){var z=this.formWidgets[v],A=z.widget,B=z.connections;B.length&&(p.forEach(B,function(P){P.remove()}),B=z.connections=[]);if(K.isArray(A))p.forEach(A,function(P){p.forEach(x,function(R){B.push(a(P,"change",
K.hitch(this,function(S){if(this.watching&&g.get(P.focusNode,"checked"))this[R](P.get("value"),v,P,S)})))},this)},this);else{var J=A.isInstanceOf(d)?"click":"change";p.forEach(x,function(P){B.push(a(A,J,K.hitch(this,function(R){if(this.watching)this[P](A.get("value"),v,A,R)})))},this)}};h=h("dojox.form.manager._Mixin",null,{watching:!0,startup:function(){this._started||(this.formWidgets={},this.formNodes={},this.registerWidgetDescendants(this),this.inherited(arguments))},destroy:function(){for(var v in this.formWidgets)p.forEach(this.formWidgets[v].connections,
function(x){x.remove()});this.formWidgets={};this.inherited(arguments)},registerWidget:function(v){"string"==typeof v?v=n.byId(v):v.tagName&&v.cloneNode&&(v=n.byNode(v));(v=t.call(this,v))&&u.call(this,v,w.call(this,v));return this},unregisterWidget:function(v){v in this.formWidgets&&(p.forEach(this.formWidgets[v].connections,function(x){x.remove()}),delete this.formWidgets[v]);return this},registerWidgetDescendants:function(v){"string"==typeof v?v=n.byId(v):v.tagName&&v.cloneNode&&(v=n.byNode(v));
var x=p.map(v.getDescendants(),t,this);p.forEach(x,function(z){z&&u.call(this,z,w.call(this,z))},this);return this.registerNodeDescendants?this.registerNodeDescendants(v.domNode):this},unregisterWidgetDescendants:function(v){"string"==typeof v?v=n.byId(v):v.tagName&&v.cloneNode&&(v=n.byNode(v));p.forEach(p.map(v.getDescendants(),function(x){return x instanceof c&&x.get("name")||null}),function(x){x&&this.unregisterWidget(x)},this);return this.unregisterNodeDescendants?this.unregisterNodeDescendants(v.domNode):
this},formWidgetValue:function(v,x){var z=2==arguments.length&&void 0!==x,A;"string"==typeof v&&(v=this.formWidgets[v])&&(v=v.widget);if(!v)return null;if(K.isArray(v)){if(z)return p.forEach(v,function(B){B.set("checked",!1,!this.watching)},this),p.forEach(v,function(B){B.set("checked",B.value===x,!this.watching)},this),this;p.some(v,function(B){return g.get(B.focusNode,"checked")?(A=B,!0):!1});return A?A.get("value"):""}return v.isInstanceOf&&v.isInstanceOf(l)?z?(v.set("value",!!x,!this.watching),
this):!!v.get("value"):z?(v.set("value",x,!this.watching),this):v.get("value")},formPointValue:function(v,x){v&&"string"==typeof v&&(v=this[v]);return v&&v.tagName&&v.cloneNode&&m.contains(v,"dojoFormValue")?2==arguments.length&&void 0!==x?(v.innerHTML=x,this):v.innerHTML:null},inspectFormWidgets:function(v,x,z){var A,B={};if(x)if(K.isArray(x))p.forEach(x,function(J){J in this.formWidgets&&(B[J]=v.call(this,J,this.formWidgets[J].widget,z))},this);else for(A in x)A in this.formWidgets&&(B[A]=v.call(this,
A,this.formWidgets[A].widget,x[A]));else for(A in this.formWidgets)B[A]=v.call(this,A,this.formWidgets[A].widget,z);return B},inspectAttachedPoints:function(v,x,z){var A,B,J={};if(x)if(K.isArray(x))p.forEach(x,function(P){(B=this[P])&&B.tagName&&B.cloneNode&&(J[P]=v.call(this,P,B,z))},this);else for(A in x)(B=this[A])&&B.tagName&&B.cloneNode&&(J[A]=v.call(this,A,B,x[A]));else for(A in this)A in r||(B=this[A])&&B.tagName&&B.cloneNode&&(J[A]=v.call(this,A,B,z));return J},inspect:function(v,x,z){var A=
this.inspectFormWidgets(function(B,J,P){return K.isArray(J)?v.call(this,B,p.map(J,function(R){return R.domNode}),P):v.call(this,B,J.domNode,P)},x,z);this.inspectFormNodes&&K.mixin(A,this.inspectFormNodes(v,x,z));return K.mixin(A,this.inspectAttachedPoints(v,x,z))}});K.extend(b,{observer:""});return h})},"dojox/form/manager/_NodeMixin":function(){define("dojo/_base/lang dojo/_base/array dojo/on dojo/dom dojo/dom-attr dojo/query ./_Mixin dijit/form/_FormWidget dijit/_base/manager dojo/_base/declare".split(" "),
function(e,K,p,a,g,m,n,b,c,d){n=e.getObject("dojox.form.manager",!0);var l=n.actionAdapter,h=n._keys,f=n.changeEvent=function(w){var u="click";switch(w.tagName.toLowerCase()){case "textarea":u="keyup";break;case "select":u="change";break;case "input":switch(w.type.toLowerCase()){case "text":case "password":u="keyup"}}return u},r=function(w,u){var v=g.get(w,"name");u=u||this.domNode;if(!v||v in this.formWidgets)v=null;else{for(var x=w;x&&x!==u;x=x.parentNode)if(g.get(x,"widgetId")&&c.byNode(x).isInstanceOf(b))return null;
"input"==w.tagName.toLowerCase()&&"radio"==w.type.toLowerCase()?(u=(u=this.formNodes[v])&&u.node)&&e.isArray(u)?u.push(w):this.formNodes[v]={node:[w],connections:[]}:this.formNodes[v]={node:w,connections:[]}}return v},q=function(w){var u={};l(function(v,x){(v=g.get(x,"data-dojo-observer")||g.get(x,"observer"))&&"string"==typeof v&&K.forEach(v.split(","),function(z){(z=e.trim(z))&&e.isFunction(this[z])&&(u[z]=1)},this)}).call(this,null,this.formNodes[w].node);return h(u)},t=function(w,u){var v=this.formNodes[w],
x=v.connections;x.length&&(K.forEach(x,function(z){z.remove()}),x=v.connections=[]);l(function(z,A){var B=f(A);K.forEach(u,function(J){x.push(p(A,B,e.hitch(this,function(P){if(this.watching)this[J](this.formNodeValue(w),w,A,P)})))},this)}).call(this,null,v.node)};return d("dojox.form.manager._NodeMixin",null,{destroy:function(){for(var w in this.formNodes)K.forEach(this.formNodes[w].connections,function(u){u.remove()});this.formNodes={};this.inherited(arguments)},registerNode:function(w){"string"==
typeof w&&(w=a.byId(w));(w=r.call(this,w))&&t.call(this,w,q.call(this,w));return this},unregisterNode:function(w){w in this.formNodes&&(K.forEach(this.formNodes[w].connections,function(u){u.remove()}),delete this.formNodes[w]);return this},registerNodeDescendants:function(w){"string"==typeof w&&(w=a.byId(w));m("input, select, textarea, button",w).map(function(u){return r.call(this,u,w)},this).forEach(function(u){u&&t.call(this,u,q.call(this,u))},this);return this},unregisterNodeDescendants:function(w){"string"==
typeof w&&(w=a.byId(w));m("input, select, textarea, button",w).map(function(u){return g.get(w,"name")||null}).forEach(function(u){u&&this.unregisterNode(u)},this);return this},formNodeValue:function(w,u){var v=2==arguments.length&&void 0!==u;"string"==typeof w&&(w=this.formNodes[w])&&(w=w.node);if(!w)return null;if(e.isArray(w)){if(v)return K.forEach(w,function(A){A.checked=""}),K.forEach(w,function(A){A.checked=A.value===u?"checked":""}),this;K.some(w,function(A){return A.checked?(z=A,!0):!1});return z?
z.value:""}switch(w.tagName.toLowerCase()){case "select":if(w.multiple){if(v){if(e.isArray(u)){var x={};K.forEach(u,function(A){x[A]=1});m("\x3e option",w).forEach(function(A){A.selected=A.value in x});return this}m("\x3e option",w).forEach(function(A){A.selected=A.value===u});return this}var z=m("\x3e option",w).filter(function(A){return A.selected}).map(function(A){return A.value});return 1==z.length?z[0]:z}return v?(m("\x3e option",w).forEach(function(A){A.selected=A.value===u}),this):w.value||
"";case "button":return v?(w.innerHTML=""+u,this):w.innerHTML;case "input":if("checkbox"==w.type.toLowerCase())return v?(w.checked=u?"checked":"",this):!!w.checked}return v?(w.value=""+u,this):w.value},inspectFormNodes:function(w,u,v){var x,z={};if(u)if(e.isArray(u))K.forEach(u,function(A){A in this.formNodes&&(z[A]=w.call(this,A,this.formNodes[A].node,v))},this);else for(x in u)x in this.formNodes&&(z[x]=w.call(this,x,this.formNodes[x].node,u[x]));else for(x in this.formNodes)z[x]=w.call(this,x,
this.formNodes[x].node,v);return z}})})},"dojox/form/manager/_FormMixin":function(){define("dojo/_base/lang dojo/_base/kernel dojo/_base/event dojo/window ./_Mixin dojo/_base/declare".split(" "),function(e,K,p,a,g,m){var n=e.getObject("dojox.form.manager",!0).actionAdapter;return m("dojox.form.manager._FormMixin",null,{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",startup:function(){if(this.isForm="form"==this.domNode.tagName.toLowerCase())this.connect(this.domNode,
"onreset","_onReset"),this.connect(this.domNode,"onsubmit","_onSubmit");this.inherited(arguments)},_onReset:function(b){var c={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:b.currentTarget,target:b.target};!1!==this.onReset(c)&&c.returnValue&&this.reset();p.stop(b);return!1},onReset:function(){return!0},reset:function(){this.inspectFormWidgets(n(function(b,c){c.reset&&c.reset()}));this.isForm&&this.domNode.reset();return this},_onSubmit:function(b){!1===
this.onSubmit(b)&&p.stop(b)},onSubmit:function(){return this.isValid()},submit:function(){this.isForm&&!1!==this.onSubmit()&&this.domNode.submit()},isValid:function(){for(var b in this.formWidgets){var c=!1;n(function(d,l){l.get("disabled")||!l.isValid||l.isValid()||(c=!0)}).call(this,null,this.formWidgets[b].widget);if(c)return!1}return!0},validate:function(){var b=!0,c=this.formWidgets,d=!1,l;for(l in c)n(function(h,f){f._hasBeenBlurred=!0;h=f.disabled||!f.validate||f.validate();h||d||(a.scrollIntoView(f.containerNode||
f.domNode),f.focus(),d=!0);b=b&&h}).call(this,null,c[l].widget);return b}})})},"dojox/form/manager/_ValueMixin":function(){define(["dojo/_base/lang","dojo/_base/kernel","dojo/_base/declare"],function(e,K,p){return p("dojox.form.manager._ValueMixin",null,{elementValue:function(a,g){return a in this.formWidgets?this.formWidgetValue(a,g):this.formNodes&&a in this.formNodes?this.formNodeValue(a,g):this.formPointValue(a,g)},gatherFormValues:function(a){var g=this.inspectFormWidgets(function(m){return this.formWidgetValue(m)},
a);this.inspectFormNodes&&e.mixin(g,this.inspectFormNodes(function(m){return this.formNodeValue(m)},a));e.mixin(g,this.inspectAttachedPoints(function(m){return this.formPointValue(m)},a));return g},setFormValues:function(a){a&&(this.inspectFormWidgets(function(g,m,n){this.formWidgetValue(g,n)},a),this.inspectFormNodes&&this.inspectFormNodes(function(g,m,n){this.formNodeValue(g,n)},a),this.inspectAttachedPoints(function(g,m,n){this.formPointValue(g,n)},a));return this}})})},"dojox/form/manager/_EnableMixin":function(){define(["dojo/_base/lang",
"dojo/_base/kernel","dojo/dom-attr","./_Mixin","dojo/_base/declare"],function(e,K,p,a,g){K=e.getObject("dojox.form.manager",!0);var m=K.actionAdapter,n=K.inspectorAdapter;return g("dojox.form.manager._EnableMixin",null,{gatherEnableState:function(b){var c=this.inspectFormWidgets(n(function(d,l){return!l.get("disabled")}),b);this.inspectFormNodes&&e.mixin(c,this.inspectFormNodes(n(function(d,l){return!p.get(l,"disabled")}),b));return c},enable:function(b,c){if(2>arguments.length||void 0===c)c=!0;this.inspectFormWidgets(m(function(d,
l,h){l.set("disabled",!h)}),b,c);this.inspectFormNodes&&this.inspectFormNodes(m(function(d,l,h){p.set(l,"disabled",!h)}),b,c);return this},disable:function(b){var c=this.gatherEnableState();this.enable(b,!1);return c}})})},"dojox/form/manager/_DisplayMixin":function(){define(["dojo/_base/kernel","dojo/dom-style","dojo/_base/declare"],function(e,K,p){return p("dojox.form.manager._DisplayMixin",null,{gatherDisplayState:function(a){return this.inspectAttachedPoints(function(g,m){return"none"!=K.get(m,
"display")},a)},show:function(a,g){2>arguments.length&&(g=!0);this.inspectAttachedPoints(function(m,n,b){K.set(n,"display",b?"":"none")},a,g);return this},hide:function(a){return this.show(a,!1)}})})},"dojox/form/manager/_ClassMixin":function(){define(["dojo/_base/lang","dojo/_base/kernel","dojo/dom-class","./_Mixin","dojo/_base/declare"],function(e,K,p,a,g){e=e.getObject("dojox.form.manager",!0);var m=e.actionAdapter,n=e.inspectorAdapter;return g("dojox.form.manager._ClassMixin",null,{gatherClassState:function(b,
c){return this.inspect(n(function(d,l){return p.contains(l,b)}),c)},addClass:function(b,c){this.inspect(m(function(d,l){p.add(l,b)}),c);return this},removeClass:function(b,c){this.inspect(m(function(d,l){p.remove(l,b)}),c);return this}})})},"dojox/widget/Standby":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/array dojo/_base/event dojo/_base/sniff dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/window dojo/_base/window dojo/_base/fx dojo/fx dijit/_Widget dijit/_TemplatedMixin dijit/registry".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w){e.experimental("dojox.widget.Standby");return K("dojox.widget.Standby",[q,t],{image:require.toUrl("dojox/widget/Standby/images/loading.gif").toString(),imageText:"Please Wait...",text:"Please wait...",centerIndicator:"image",target:"",color:"#C0C0C0",duration:500,zIndex:"auto",opacity:.75,templateString:'\x3cdiv\x3e\x3cdiv style\x3d"display: none; opacity: 0; z-index: 9999; position: absolute; cursor:wait;" dojoAttachPoint\x3d"_underlayNode"\x3e\x3c/div\x3e\x3cimg src\x3d"${image}" style\x3d"opacity: 0; display: none; z-index: -10000; position: absolute; top: 0px; left: 0px; cursor:wait;" dojoAttachPoint\x3d"_imageNode"\x3e\x3cdiv style\x3d"opacity: 0; display: none; z-index: -10000; position: absolute; top: 0px;" dojoAttachPoint\x3d"_textNode"\x3e\x3c/div\x3e\x3c/div\x3e',
_underlayNode:null,_imageNode:null,_textNode:null,_centerNode:null,_displayed:!1,_resizeCheck:null,_started:!1,_parent:null,startup:function(u){if(!this._started){if("string"===typeof this.target){var v=w.byId(this.target);this.target=v?v.domNode:m.byId(this.target)}this.text&&(this._textNode.innerHTML=this.text);"image"===this.centerIndicator?(this._centerNode=this._imageNode,n.set(this._imageNode,"src",this.image),n.set(this._imageNode,"alt",this.imageText)):this._centerNode=this._textNode;d.set(this._underlayNode,
{display:"none",backgroundColor:this.color});d.set(this._centerNode,"display","none");this.connect(this._underlayNode,"onclick","_ignore");this.domNode.parentNode&&this.domNode.parentNode!=h.body()&&h.body().appendChild(this.domNode);7==g("ie")&&(this._ieFixNode=b.create("div"),d.set(this._ieFixNode,{opacity:"0",zIndex:"-1000",position:"absolute",top:"-1000px"}),h.body().appendChild(this._ieFixNode));this.inherited(arguments)}},show:function(){this._displayed||(this._anim&&(this._anim.stop(),delete this._anim),
this._displayed=!0,this._size(),this._disableOverflow(),this._fadeIn())},hide:function(){if(this._displayed)try{this._anim&&(this._anim.stop(),delete this._anim),this._size()}catch(u){}finally{this._fadeOut(),this._displayed=!1,null!==this._resizeCheck&&(clearInterval(this._resizeCheck),this._resizeCheck=null)}},isVisible:function(){return this._displayed},onShow:function(){},onHide:function(){},uninitialize:function(){this._displayed=!1;this._resizeCheck&&clearInterval(this._resizeCheck);d.set(this._centerNode,
"display","none");d.set(this._underlayNode,"display","none");7==g("ie")&&this._ieFixNode&&(h.body().removeChild(this._ieFixNode),delete this._ieFixNode);this._anim&&(this._anim.stop(),delete this._anim);this._centerNode=this._textNode=this._imageNode=this.target=null;this.inherited(arguments)},_size:function(){if(this._displayed){var u=n.get(h.body(),"dir");u&&(u=u.toLowerCase());var v=this._scrollerWidths(),x=this.target,z=d.get(this._centerNode,"display");d.set(this._centerNode,"display","block");
var A=c.position(x,!0);if(x===h.body()||x===h.doc)A=l.getBox(),A.x=A.l,A.y=A.t;var B=c.getMarginBox(this._centerNode);d.set(this._centerNode,"display",z);if(this._ieFixNode){var J=-this._ieFixNode.offsetTop/1E3;A.x=Math.floor((A.x+.9)/J);A.y=Math.floor((A.y+.9)/J);A.w=Math.floor((A.w+.9)/J);A.h=Math.floor((A.h+.9)/J)}var P=d.get(x,"zIndex"),R=z=P;if("auto"===this.zIndex)if("auto"!=P)z=parseInt(z,10),R=parseInt(R,10);else{var S=x;if(S&&S!==h.body()&&S!==h.doc)for(S=x.parentNode,J=-1E5;S&&S!==h.body();)(P=
d.get(S,"zIndex"))&&"auto"!==P&&(P=parseInt(P,10),J<P&&(J=P,z=P+1,R=P+1)),S=S.parentNode}else z=parseInt(this.zIndex,10),R=parseInt(this.zIndex,10);d.set(this._centerNode,"zIndex",R);d.set(this._underlayNode,"zIndex",z);if((z=x.parentNode)&&z!==h.body()&&x!==h.body()&&x!==h.doc){S=A.h;R=A.w;x=c.position(z,!0);this._ieFixNode&&(J=-this._ieFixNode.offsetTop/1E3,x.x=Math.floor((x.x+.9)/J),x.y=Math.floor((x.y+.9)/J),x.w=Math.floor((x.w+.9)/J),x.h=Math.floor((x.h+.9)/J));x.w-=z.scrollHeight>z.clientHeight&&
0<z.clientHeight?v.v:0;x.h-=z.scrollWidth>z.clientWidth&&0<z.clientWidth?v.h:0;"rtl"===u&&(g("opera")?(A.x+=z.scrollHeight>z.clientHeight&&0<z.clientHeight?v.v:0,x.x+=z.scrollHeight>z.clientHeight&&0<z.clientHeight?v.v:0):g("ie")?x.x+=z.scrollHeight>z.clientHeight&&0<z.clientHeight?v.v:0:g("webkit"));x.w<A.w&&(A.w-=x.w);x.h<A.h&&(A.h-=x.h);var T=x.y,E=x.y+x.h,I=A.y,F=A.y+S;u=x.x;J=x.x+x.w;P=A.x;var D=A.x+R;if(F>T&&I<T)A.y=x.y,S-=T-I,A.h=S<x.h?S:A.h-2*(z.scrollWidth>z.clientWidth&&0<z.clientWidth?
v.h:0);else if(I<E&&F>E)A.h=E-I;else if(F<=T||I>=E)A.h=0;if(D>u&&P<u)A.x=x.x,R-=u-P,A.w=R<x.w?R:A.w-2*(z.scrollHeight>z.clientHeight&&0<z.clientHeight?v.w:0);else if(P<J&&D>J)A.w=J-P;else if(D<=u||P>=J)A.w=0}0<A.h&&0<A.w?(d.set(this._underlayNode,{display:"block",width:A.w+"px",height:A.h+"px",top:A.y+"px",left:A.x+"px"}),v=["borderRadius","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"],this._cloneStyles(v),g("ie")||(v="MozBorderRadius MozBorderRadiusTopleft MozBorderRadiusTopright MozBorderRadiusBottomleft MozBorderRadiusBottomright WebkitBorderRadius WebkitBorderTopLeftRadius WebkitBorderTopRightRadius WebkitBorderBottomLeftRadius WebkitBorderBottomRightRadius".split(" "),
this._cloneStyles(v,this)),v=A.h/2-B.h/2,z=A.w/2-B.w/2,A.h>=B.h&&A.w>=B.w?d.set(this._centerNode,{top:v+A.y+"px",left:z+A.x+"px",display:"block"}):d.set(this._centerNode,"display","none")):(d.set(this._underlayNode,"display","none"),d.set(this._centerNode,"display","none"));if(null===this._resizeCheck){var C=this;this._resizeCheck=setInterval(function(){C._size()},100)}}},_cloneStyles:function(u){p.forEach(u,function(v){d.set(this._underlayNode,v,d.get(this.target,v))},this)},_fadeIn:function(){var u=
this,v=f.animateProperty({duration:u.duration,node:u._underlayNode,properties:{opacity:{start:0,end:u.opacity}}}),x=f.animateProperty({duration:u.duration,node:u._centerNode,properties:{opacity:{start:0,end:1}},onEnd:function(){u.onShow();delete u._anim}});this._anim=r.combine([v,x]);this._anim.play()},_fadeOut:function(){var u=this,v=f.animateProperty({duration:u.duration,node:u._underlayNode,properties:{opacity:{start:u.opacity,end:0}},onEnd:function(){d.set(this.node,{display:"none",zIndex:"-1000"})}}),
x=f.animateProperty({duration:u.duration,node:u._centerNode,properties:{opacity:{start:1,end:0}},onEnd:function(){d.set(this.node,{display:"none",zIndex:"-1000"});u.onHide();u._enableOverflow();delete u._anim}});this._anim=r.combine([v,x]);this._anim.play()},_ignore:function(u){u&&a.stop(u)},_scrollerWidths:function(){var u=b.create("div");d.set(u,{position:"absolute",opacity:0,overflow:"hidden",width:"50px",height:"50px",zIndex:"-100",top:"-200px",padding:"0px",margin:"0px"});var v=b.create("div");
d.set(v,{width:"200px",height:"10px"});u.appendChild(v);h.body().appendChild(u);v=c.getContentBox(u);d.set(u,"overflow","scroll");var x=c.getContentBox(u);h.body().removeChild(u);return{v:v.w-x.w,h:v.h-x.h}},_setTextAttr:function(u){this.text=this._textNode.innerHTML=u},_setColorAttr:function(u){d.set(this._underlayNode,"backgroundColor",u);this.color=u},_setImageTextAttr:function(u){n.set(this._imageNode,"alt",u);this.imageText=u},_setImageAttr:function(u){n.set(this._imageNode,"src",u);this.image=
u},_setCenterIndicatorAttr:function(u){this.centerIndicator=u;"image"===u?(this._centerNode=this._imageNode,d.set(this._textNode,"display","none")):(this._centerNode=this._textNode,d.set(this._imageNode,"display","none"))},_setTargetAttr:function(u){if("string"===typeof u){var v=w.byId(u);this._set("target",v?v.domNode:m.byId(u))}else this._set("target",u)},_disableOverflow:function(){if(this.target===h.body()||this.target===h.doc){this._overflowDisabled=!0;var u=h.body();this._oldOverflow=u.style&&
u.style.overflow?d.get(u,"overflow"):"";if(g("ie")&&!g("quirks")){if(u.parentNode&&u.parentNode.style&&u.parentNode.style.overflow)this._oldBodyParentOverflow=u.parentNode.style.overflow;else try{this._oldBodyParentOverflow=d.get(u.parentNode,"overflow")}catch(v){this._oldBodyParentOverflow="scroll"}d.set(u.parentNode,"overflow","hidden")}d.set(u,"overflow","hidden")}},_enableOverflow:function(){if(this._overflowDisabled){delete this._overflowDisabled;var u=h.body();g("ie")&&!g("quirks")&&(u.parentNode.style.overflow=
this._oldBodyParentOverflow,delete this._oldBodyParentOverflow);d.set(u,"overflow",this._oldOverflow);if(g("webkit")){var v=b.create("div",{style:{height:"2px"}});u.appendChild(v);setTimeout(function(){u.removeChild(v)},0)}delete this._oldOverflow}}})})},"esri/layers/wms":function(){define(["./agscommon","./dynamic","./WMSLayer"],function(){return{}})},"esri/layers/dynamic":function(){define(["../geometry","./DynamicMapServiceLayer"],function(){return{}})},"arcgisonline/sharing/dijit/dialog/ChoiceDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/dom dojo/dom-attr dojo/dom-construct dojo/on dojo/query dojo/aspect dijit/Dialog dijit/form/Button dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/lang ../../../esriGeowConfig dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/ChoiceDlg.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u){var v=K("arcgisonline.sharing.dijit.dialog.ChoiceDlg",[h,f,r],{declaredClass:"arcgisonline.sharing.dijit.dialog.ChoiceDlg",widgetsInTemplate:!0,templateString:u,title:"",message:"",choiceOneButton:null,choiceOneTitle:"",choiceOneHandler:null,choiceTwoButton:null,choiceTwoTitle:"",choiceTwoHandler:null,choiceOneConn:null,choiceTwoConn:null,postCreate:function(){this.choiceOneHandler=n(this.choiceOneButton,"click",p.hitch(this,"onChoiceOneClick"));this.choiceTwoHandler=
n(this.choiceTwoButton,"click",p.hitch(this,"onChoiceTwoClick"))},postMixInProperties:function(){this.inherited(arguments);this.i18n=p.mixin({},w.common);p.mixin(this.i18n,w.choiceDlg);this.choiceOneTitle=this.i18n.ok;this.choiceTwoTitle=this.i18n.cancel},destroy:function(){this.inherited(arguments);q.isDefined(this.choiceOneConn)&&this.choiceOneConn.remove();q.isDefined(this.choiceTwoConn)&&this.choiceTwoConn.remove()},show:function(x){x.title&&""!==x.title&&(this.title=x.title);x.message&&""!==
x.message&&(this.message=x.message);x.choiceOneTitle&&""!==x.choiceOneTitle&&(this.choiceOneTitle=x.choiceOneTitle);x.choiceTwoTitle&&""!==x.choiceTwoTitle&&(this.choiceTwoTitle=x.choiceTwoTitle);x.choiceOneHandler&&(this.choiceOneHandler=x.choiceOneHandler,this.setChoiceOneHandler());x.choiceTwoHandler&&(this.choiceTwoHandler=x.choiceTwoHandler,this.setChoiceTwoHandler());x.closeHandler&&c.after(this._dialog,"onCancel",x.closeHandler);this._dialog.set("title",this.title);g.set(this.choiceContent,
"innerHTML",this.message);this.choiceOneButton.set("label",this.choiceOneTitle);this.choiceTwoButton.set("label",this.choiceTwoTitle);this._dialog.show()},setChoiceOneHandler:function(){q.isDefined(this.choiceOneConn)&&(this.choiceOneConn.remove(),this.choiceOneConn=void 0);this.choiceOneConn=n(this.choiceOneButton,"click",p.hitch(this,function(){this.hide();this.choiceOneHandler()}))},setChoiceTwoHandler:function(){q.isDefined(this.choiceTwoConn)&&(this.choiceTwoConn.remove(),this.choiceTwoConn=
void 0);this.choiceTwoConn=n(this.choiceTwoButton,"click",p.hitch(this,function(){this.hide();this.choiceTwoHandler()}))},onChoiceOneClick:function(){this.hide()},onChoiceTwoClick:function(){this.hide()},hide:function(){this._dialog.hide()}});v.prototype.statics={getInstance:function(){this._instance||(this._instance=new v);return this._instance}};return v})},"arcgisonline/sharing/dijit/ServiceInfo":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_WidgetBase,dijit/registry,arcgisonline/sharing/util,esri/IdentityManagerBase"],
function(e,K,p){e.provide("arcgisonline.sharing.dijit.ServiceInfo");e.require("dijit._WidgetBase");e.require("dijit.registry");e.require("arcgisonline.sharing.util");e.require("esri.IdentityManagerBase");e.declare("arcgisonline.sharing.dijit.ServiceInfo",[K._WidgetBase,esri.IdentityManagerBase],{baseClass:"esriSvcAuth",onCredentialChange:function(){},postMixInProperties:function(){this.inherited(arguments);this._util=arcgisonline.sharing.util;this._isSecuredUrl=esriGeowConfig.restBaseUrl+"portals/checkurl";
this.i18n=e.mixin({},e.i18n.getLocalization("arcgisonline","arcgisonline").common);this.i18n=e.mixin(this.i18n,{addItemFrm:e.i18n.getLocalization("arcgisonline","arcgisonline").addItemFrm});this._tokenAuthentication=[499,498];this._createDefaultOAuthInfo=!1;this._overrideUrls="geocode.arcgis.com geocodedev.arcgis.com geocodeqa.arcgis.com route.arcgis.com routedev.arcgis.com routeqa.arcgis.com geoenrich.arcgis.com geoenrichqa.arcgis.com geoenrichddev.arcgis.com".split(" ")},buildRendering:function(){var a=
document.createDocumentFragment(),g=e.create("form",null,a);g=e.create("fieldset",{"class":"esriSvcAuth"},g);new K.form.TextBox({name:"fakeusernameremembered",type:"text","class":"hide"},e.create("input",{autocomplete:"off"},g));new K.form.TextBox({name:"fakepasswordremembered",type:"password","class":"hide"},e.create("input",{autocomplete:"off"},g));e.create("label",{"for":"proxyUsername",innerHTML:this.i18n.userLabel,"class":"esriUsernameLbl inputLabel trailer-0 leader-half"},g);this._username=
new K.form.TextBox({name:"serviceUsername",trim:"true"},e.create("input",{autocomplete:"off"},g));e.create("br",{},g);e.create("label",{"for":"proxyPassword",innerHTML:this.i18n.passwordLabel,"class":"esriPasswordLbl inputLabel trailer-0 leader-half"},g);this._password=new K.form.TextBox({name:"servicePassword",trim:"true",type:"password"},e.create("input",{autocomplete:"off"},g));this.inherited(arguments);this.domNode.appendChild(a)},postCreate:function(){this.connect(this._password,"onChange",e.hitch(this,
"_onCredential"));this.connect(this._username,"onChange",e.hitch(this,"_onCredential"))},_setDisabledAttr:function(a){e.forEach(K.registry.findWidgets(this.domNode,this.containerNode),function(g){g.set("disabled",a)})},getIsSecured:function(a){a=a.split("?")[0];var g=!1;this.isOverrideUrl=e.some(this._overrideUrls,function(n){return-1!==a.indexOf(n)});g=!this.isOverrideUrl&&-1<a.indexOf("/VectorTileServer");if(this.isOverrideUrl){esri.show(this.domNode);var m=new e.Deferred;m.resolve({secured:!0,
isOverride:!0})}else m=this._util.request({url:this._isSecuredUrl+"?url\x3d"+encodeURIComponent(a+"?f\x3djson")},{addToken:!1}).then(e.hitch(this,function(n){return n.secured?(403===n.httpStatusCode?n.secured=!1:(401===n.httpStatusCode||0<=e.indexOf(this._tokenAuthentication,n.httpStatusCode))&&esri.show(this.domNode),n):g?this.getServiceInfo(a,!1).then(e.hitch(this,function(b){return b&&b.exportTilesAllowed?this.getIsSecured(a+"/exportTiles"):n})):n}));return m},signIn:function(a,g,m){this._pendingDfd=
new e.Deferred;this._serverInfo=g;this.userInfo&&this.userInfo.username&&this.userInfo.password&&this._generateToken();return this._pendingDfd},isFederatedWithWebTierAuth:function(a,g){var m=new e.Deferred,n,b=!1;g&&499===g.httpStatusCode?this._getTokenSvcUrl(a).then(e.hitch(this,function(c){(n=c&&c.authInfo&&c.authInfo.tokenServicesUrl)?this.getIsSecured(n).then(e.hitch(this,function(d){b=d&&d.secured&&401===d.httpStatusCode;m.resolve(b)}),e.hitch(this,function(d){m.resolve(d&&d.message&&-1<d.message.indexOf("Http StatusCode: -1")?
-1:!1)})):m.resolve(!1)})):m.resolve(!1);return m},getServiceInfo:function(a,g){var m=new e.Deferred;m=this.userInfo;var n=this._util.isHostedService(a),b=this._isEsriHostedService(a);n=n||b;var c={useProxy:!1,timeout:!1===esriGeowConfig.isMultiTenant?6E4:5E3,addSSL:n,addToken:g&&n&&!1!==esriGeowConfig.isMultiTenant||!1};m&&m.username&&m.password?(this._prevIdMgr=esri.id,esri.id=this,this._svcUrl=a.split("?")[0],m=this.isOverrideUrl?this._signIn(a,this.userInfo).then(e.hitch(this,function(d){return this._getServiceInfo(a,
c)})):this._getServiceInfo(a,c).then(e.hitch(this,function(d){d.credential=esri.id.findCredential(a);esri.id=this._prevIdMgr;d.credential&&esri.id.registerToken({server:a,token:d.credential.token,userId:d.credential.userId,expires:d.credential.expires,ssl:d.credential.ssl});return d}))):(c.disableIdentityLookup=!0,m=this._getServiceInfo(a,c).then(e.hitch(this,function(d){return d}),e.hitch(this,function(d){esri.show(this.domNode);throw d;})));return m},_isEsriHostedService:function(a){return-1<a.indexOf(".esri.com/server/rest/services")?
!0:!1},_generateToken:function(){return this.generateToken(this._serverInfo,{username:this.userInfo.username,password:this.userInfo.password}).then(e.hitch(this,function(a){if(a)this._pendingDfd.callback(new esri.Credential({userId:this.userInfo.username,server:this._serverInfo.server,token:a.token,expires:esri.isDefined(a.expires)?Number(a.expires):null,ssl:a.ssl,validity:this._serverInfo.shortLivedTokenValidity}));else return null}),e.hitch(this,function(a){a.code=403;this._pendingDfd.errback(a)}))},
getServiceInfoOverProxy:function(a,g){var m=this._util.isHostedService(a)||this._util.isAgolService(a),n={useProxy:!1,timeout:5E3,addSSL:m,addToken:m&&!1!==esriGeowConfig.isMultiTenant};this._svcUrl=a.split("?")[0];return!1===g?this._getServiceInfo(a):this._signIn(this._svcUrl,this.userInfo).then(e.hitch(this,function(b){e.mixin(n,{disableIdentityLookup:b?!1:!0,useProxy:!0});return this._getServiceInfo(a,n)}))},_getServiceInfo:function(a,g){if(esriGeowConfig.allSSL||"https:"===window.location.protocol)if(this._util.isHostedService(a)||
this._util.supportsHttps(a))a=a.replace("http:/","https:/");else if(-1<a.indexOf("http:/"))return a=new e.Deferred,a.reject(this.i18n.addItemFrm.errors.sslError),a;return this._util.request({url:a,content:{}},g).then(e.hitch(this,function(m){this._editingCredential=!1;return this.serviceInfo=m}),e.hitch(this,function(m){this._editingCredential=!1;m&&-1!==e.indexOf(this._tokenAuthentication,m.code)?esri.show(this.domNode):m&&403===m.code?esri.show(this.domNode):esri.hide(this.domNode);throw m;}))},
_onCredential:function(){this.domNode&&null!==this.domNode.offsetParent&&(this.credentials=[],this.userInfo={username:this._username.get("value"),password:this._password.get("value")},this._editingCredential=!0,this.onCredentialChange(this.userInfo))},_onChangeCredential:function(a){this._editingCredential=a},_findServerInfo:function(a){var g=esri.id.findServerInfo(a);g?(a=new e.Deferred,a.resolve(g)):(g=new esri.ServerInfo,g.server=esri.id._getOrigin(a),a=esri.id._getTokenSvcUrl(a).then(e.hitch(this,
function(m){g.tokenServiceUrl=e.getObject("authInfo.tokenServicesUrl",!1,m)||e.getObject("authInfo.tokenServiceUrl",!1,m)||e.getObject("tokenServiceUrl",!1,m);g.currentVersion=m.currentVersion;g.hasServer=!0;esri.id.registerServers([g]);return g})));return a},_signIn:function(a,g){if(g&&g.username&&g.password)var m=this._findServerInfo(a).then(e.hitch(this,function(n){if(esri.id._checkProtocol(a,n,function(b){}))return esri.id.generateToken(n,g).then(e.hitch(this,function(b){var c=esri.isDefined(b.expires)?
Number(b.expires):null;b=new esri.Credential({userId:g.username,server:n.server,token:b.token,expires:c,ssl:!!b.ssl,validity:n.shortLivedTokenValidity,resources:[a],scope:"server"});-1===e.indexOf(esri.id.credentials,b)&&esri.id.credentials.push(b);return g}),e.hitch(this,function(b){b.code=403;throw b;}))}));else m=new e.Deferred,m.resolve(null);return m}})})},"arcgisonline/sharing/dijit/_TimezoneUtils":function(){define(["require","exports"],function(e,K){return{TimezoneUtils:{_winter:new Date("January, 1, 2013"),
_summer:new Date("June, 1, 2013"),_winZones:{0:{offset:-720,id:"Dateline Standard Time",supportsDaylightSavingTime:!1,offsetText:"-12:00"},110:{offset:-660,id:"UTC-11",supportsDaylightSavingTime:!1,offsetText:"-11:00",msid:110},200:{offset:-600,id:"Hawaiian Standard Time",supportsDaylightSavingTime:!1,offsetText:"-10:00"},300:{offset:-540,id:"Alaskan Standard Time",supportsDaylightSavingTime:!0,offsetText:"-9:00"},400:{offset:-480,id:"Pacific Standard Time",supportsDaylightSavingTime:!0,offsetText:"-8:00"},
410:{offset:-480,id:"Pacific Standard Time (Mexico)",supportsDaylightSavingTime:!0,offsetText:"-8:00"},520:{offset:-420,id:"US Mountain Standard Time",supportsDaylightSavingTime:!1,offsetText:"-7:00"},510:{offset:-420,id:"Mountain Standard Time (Mexico)",supportsDaylightSavingTime:!0,offsetText:"-7:00"},500:{offset:-420,id:"Mountain Standard Time",supportsDaylightSavingTime:!0,offsetText:"-7:00"},610:{offset:-360,id:"Central America Standard Time",supportsDaylightSavingTime:!1,offsetText:"-6:00"},
620:{offset:-360,id:"Central Standard Time",supportsDaylightSavingTime:!0,offsetText:"-6:00"},630:{offset:-360,id:"Central Standard Time (Mexico)",supportsDaylightSavingTime:!0,offsetText:"-6:00"},600:{offset:-360,id:"Canada Central Standard Time",supportsDaylightSavingTime:!1,offsetText:"-6:00"},710:{offset:-300,id:"SA Pacific Standard Time",supportsDaylightSavingTime:!1,offsetText:"-5:00"},700:{offset:-300,id:"Eastern Standard Time",supportsDaylightSavingTime:!0,offsetText:"-5:00"},720:{offset:-300,
id:"US Eastern Standard Time",supportsDaylightSavingTime:!0,offsetText:"-5:00"},730:{offset:-270,id:"Venezuela Standard Time",supportsDaylightSavingTime:!1,offsetText:"-4:30"},850:{offset:-240,id:"Paraguay Standard Time",supportsDaylightSavingTime:!0,offsetText:"-4:00"},800:{offset:-240,id:"Atlantic Standard Time",supportsDaylightSavingTime:!0,offsetText:"-4:00"},810:{offset:-240,id:"Central Brazilian Standard Time",supportsDaylightSavingTime:!0,offsetText:"-4:00"},830:{offset:-240,id:"SA Western Standard Time",
supportsDaylightSavingTime:!1,offsetText:"-4:00"},820:{offset:-240,id:"Pacific SA Standard Time",supportsDaylightSavingTime:!0,offsetText:"-4:00"},900:{offset:-210,id:"Newfoundland Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:-30"},910:{offset:-180,id:"E. South America Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:00"},950:{offset:-180,id:"Argentina Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:00"},940:{offset:-180,id:"SA Eastern Standard Time",supportsDaylightSavingTime:!1,
offsetText:"-3:00"},920:{offset:-180,id:"Greenland Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:00"},930:{offset:-180,id:"Montevideo Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:00"},1010:{offset:-120,id:"UTC-02",supportsDaylightSavingTime:!1,offsetText:"-2:00"},1E3:{offset:-120,id:"Mid-Atlantic Standard Time",supportsDaylightSavingTime:!0,offsetText:"-2:00"},1100:{offset:-60,id:"Azores Standard Time",supportsDaylightSavingTime:!0,offsetText:"-1:00"},1110:{offset:-60,
id:"Cape Verde Standard Time",supportsDaylightSavingTime:!1,offsetText:"-1:00"},1220:{offset:0,id:"Morocco Standard Time",supportsDaylightSavingTime:!0,offsetText:"0:00"},1230:{offset:0,id:"UTC",supportsDaylightSavingTime:!1,offsetText:"0:00"},1200:{offset:0,id:"GMT Standard Time",supportsDaylightSavingTime:!0,offsetText:"0:00"},1210:{offset:0,id:"Greenwich Standard Time",supportsDaylightSavingTime:!1,offsetText:"0:00"},1340:{offset:60,id:"W. Europe Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},
1300:{offset:60,id:"Central Europe Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},1320:{offset:60,id:"Romance Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},1310:{offset:60,id:"Central European Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},1330:{offset:60,id:"W. Central Africa Standard Time",supportsDaylightSavingTime:!1,offsetText:"1:00"},1350:{offset:60,id:"Namibia Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},1430:{offset:120,
id:"GTB Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1460:{offset:120,id:"Middle East Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1410:{offset:120,id:"Egypt Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1480:{offset:120,id:"Syria Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1400:{offset:120,id:"E. Europe Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1470:{offset:120,id:"South Africa Standard Time",supportsDaylightSavingTime:!1,
offsetText:"2:00"},1420:{offset:120,id:"FLE Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1490:{offset:120,id:"Turkey Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1440:{offset:120,id:"Israel Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1450:{offset:180,id:"Jordan Standard Time",supportsDaylightSavingTime:!0,offsetText:"3:00"},1510:{offset:180,id:"Arabic Standard Time",supportsDaylightSavingTime:!0,offsetText:"3:00"},1530:{offset:180,id:"Kaliningrad Standard Time",
supportsDaylightSavingTime:!0,offsetText:"3:00"},1500:{offset:180,id:"Arab Standard Time",supportsDaylightSavingTime:!1,offsetText:"3:00"},1520:{offset:180,id:"E. Africa Standard Time",supportsDaylightSavingTime:!1,offsetText:"3:00"},1535:{offset:210,id:"Iran Standard Time",supportsDaylightSavingTime:!0,offsetText:"3:30"},1600:{offset:240,id:"Arabian Standard Time",supportsDaylightSavingTime:!1,offsetText:"4:00"},1610:{offset:240,id:"Azerbaijan Standard Time",supportsDaylightSavingTime:!0,offsetText:"4:00"},
1540:{offset:240,id:"Russian Standard Time",supportsDaylightSavingTime:!0,offsetText:"4:00"},1650:{offset:240,id:"Mauritius Standard Time",supportsDaylightSavingTime:!0,offsetText:"4:00"},1640:{offset:240,id:"Georgian Standard Time",supportsDaylightSavingTime:!1,offsetText:"4:00"},1620:{offset:240,id:"Caucasus Standard Time",supportsDaylightSavingTime:!0,offsetText:"4:00"},1660:{offset:270,id:"Afghanistan Standard Time",supportsDaylightSavingTime:!1,offsetText:"4:30"},1710:{offset:300,id:"West Asia Standard Time",
supportsDaylightSavingTime:!1,offsetText:"5:00"},1715:{offset:300,id:"Pakistan Standard Time",supportsDaylightSavingTime:!0,offsetText:"5:00"},1720:{offset:330,id:"India Standard Time",supportsDaylightSavingTime:!1,offsetText:"5:30"},1730:{offset:330,id:"Sri Lanka Standard Time",supportsDaylightSavingTime:!1,offsetText:"5:30"},1740:{offset:345,id:"Nepal Standard Time",supportsDaylightSavingTime:!1,offsetText:"5:45"},1800:{offset:360,id:"Central Asia Standard Time",supportsDaylightSavingTime:!1,offsetText:"6:00"},
1810:{offset:360,id:"Bangladesh Standard Time",supportsDaylightSavingTime:!0,offsetText:"6:00"},1755:{offset:360,id:"Ekaterinburg Standard Time",supportsDaylightSavingTime:!0,offsetText:"6:00"},1820:{offset:390,id:"Myanmar Standard Time",supportsDaylightSavingTime:!1,offsetText:"6:30"},1900:{offset:420,id:"SE Asia Standard Time",supportsDaylightSavingTime:!1,offsetText:"7:00"},1830:{offset:420,id:"N. Central Asia Standard Time",supportsDaylightSavingTime:!0,offsetText:"7:00"},2E3:{offset:480,id:"China Standard Time",
supportsDaylightSavingTime:!1,offsetText:"8:00"},1910:{offset:480,id:"North Asia Standard Time",supportsDaylightSavingTime:!0,offsetText:"8:00"},2020:{offset:480,id:"Singapore Standard Time",supportsDaylightSavingTime:!1,offsetText:"8:00"},2040:{offset:480,id:"W. Australia Standard Time",supportsDaylightSavingTime:!0,offsetText:"8:00"},2030:{offset:480,id:"Taipei Standard Time",supportsDaylightSavingTime:!1,offsetText:"8:00"},2050:{offset:480,id:"Ulaanbaatar Standard Time",supportsDaylightSavingTime:!1,
offsetText:"8:00"},2060:{offset:540,id:"North Asia East Standard Time",supportsDaylightSavingTime:!0,offsetText:"9:00"},2110:{offset:540,id:"Tokyo Standard Time",supportsDaylightSavingTime:!1,offsetText:"9:00"},2100:{offset:540,id:"Korea Standard Time",supportsDaylightSavingTime:!1,offsetText:"9:00"},2140:{offset:570,id:"Cen. Australia Standard Time",supportsDaylightSavingTime:!0,offsetText:"9:30"},2130:{offset:570,id:"AUS Central Standard Time",supportsDaylightSavingTime:!1,offsetText:"9:30"},2210:{offset:600,
id:"E. Australia Standard Time",supportsDaylightSavingTime:!1,offsetText:"10:00"},2200:{offset:600,id:"AUS Eastern Standard Time",supportsDaylightSavingTime:!0,offsetText:"10:00"},2240:{offset:600,id:"West Pacific Standard Time",supportsDaylightSavingTime:!1,offsetText:"10:00"},2220:{offset:600,id:"Tasmania Standard Time",supportsDaylightSavingTime:!0,offsetText:"10:00"},2150:{offset:600,id:"Yakutsk Standard Time",supportsDaylightSavingTime:!0,offsetText:"10:00"},2300:{offset:660,id:"Central Pacific Standard Time",
supportsDaylightSavingTime:!1,offsetText:"11:00"},2250:{offset:660,id:"Vladivostok Standard Time",supportsDaylightSavingTime:!0,offsetText:"11:00"},2410:{offset:720,id:"New Zealand Standard Time",supportsDaylightSavingTime:!0,offsetText:"12:00"},2430:{offset:720,id:"UTC+12",supportsDaylightSavingTime:!1,offsetText:"12:00"},2400:{offset:720,id:"Fiji Standard Time",supportsDaylightSavingTime:!0,offsetText:"12:00"},2310:{offset:720,id:"Magadan Standard Time",supportsDaylightSavingTime:!0,offsetText:"12:00"},
2500:{offset:780,id:"Tonga Standard Time",supportsDaylightSavingTime:!1,offsetText:"13:00"},120:{offset:780,id:"Samoa Standard Time",supportsDaylightSavingTime:!0,offsetText:"13:00"}},stdTimezoneOffset:function(){return Math.max(this._winter.getTimezoneOffset(),this._summer.getTimezoneOffset())},supportsDaylightSavingTime:function(){return this._winter.getTimezoneOffset()!==this._summer.getTimezoneOffset()},winZone:function(){var p=-this._winter.getTimezoneOffset(),a=[],g;for(g in this._winZones)this._winZones[g].offset===
p&&a.push(this._winZones[g]);if(a.length){var m=this.supportsDaylightSavingTime();p=a.filter(function(n){return n.supportsDaylightSavingTime===m});return(p.length?p[0]:a[0]).id}return null}}}})},"arcgisonline/sharing/dijit/dialog/getWFSConfig":function(){define(["dojo/_base/array","esri/renderers/SimpleRenderer","esri/symbols/jsonUtils","arcgisonline/map/popup/getDefaultPopupInfo"],function(e,K,p,a){function g(c){var d,l=c.fields,h=c.selectedLayer||{},f;l&&l.length&&(f=e.filter(l,function(r){return"esriFieldTypeGeometry"!==
r.type}))&&f.length&&(d=a({name:h.title,fields:l},!1,c));return d}var m={type:"esriSMS",style:"esriSMSCircle",color:[34,114,162,128],size:6,outline:{color:[34,114,162,255],width:1}},n={type:"esriSLS",style:"esriSLSSolid",color:[77,77,77,255],width:2},b={type:"esriSFS",style:"esriSFSSolid",color:[227,139,79,204],outline:{type:"esriSLS",style:"esriSLSSolid",color:[255,255,255,255],width:.75}};return function(c){var d=c.geometryType,l=c.toJson(),h=l.url,f=l.mode;l={version:l.version,name:l.name,wfsNamespace:c.layerNamespace,
featureUrl:c.getFeatureUrl,supportedSpatialReferences:c.spatialReferences};var r;"esriGeometryPoint"===d?r=new K(p.fromJson(m)):"esriGeometryPolyline"===d?r=new K(p.fromJson(n)):"esriGeometryPolygon"===d&&(r=new K(p.fromJson(b)));r=r.toJson();return{url:h,mode:f,wfsInfo:l,layerDefinition:{geometryType:d,drawingInfo:{renderer:r},spatialReference:{wkid:4326},fields:c.fields},popupInfo:g(c)}}})},"arcgisonline/map/popup/getDefaultPopupInfo":function(){define(["./isImageServiceLayer","./isTiledImageServiceLayer",
"dojo/_base/array","dojo/_base/lang"],function(e,K,p,a){return function(g,m,n){m=g.displayField;m=g.name+(m&&m.length?": {"+m+"}":"");var b=g.fields,c=!1,d=!1,l=!1;if(e(n)||K(n))b=n.getCustomRasterFields({rasterAttributeTableFieldPrefix:"Raster."}),l=0>p.indexOf(["F32","F64"],n.pixelType),n&&n.capabilities&&(d=(c=n.capabilities&&-1<n.capabilities.toLowerCase().indexOf("catalog")||n.fields&&0<n.fields.length)&&("esriImageServiceDataTypeVector-UV"===n.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===
n.serviceDataType));var h={esriFieldTypeDouble:1,esriFieldTypeSingle:1},f={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},r={esriFieldTypeDate:1},q=",";g.editFieldsInfo&&(g.editFieldsInfo.creatorField&&(q+=g.editFieldsInfo.creatorField+","),g.editFieldsInfo.creationDateField&&(q+=g.editFieldsInfo.creationDateField+","),g.editFieldsInfo.editorField&&(q+=g.editFieldsInfo.editorField+","),g.editFieldsInfo.editDateField&&(q+=g.editFieldsInfo.editDateField+","),q=q.toLowerCase());b=p.map(b,a.hitch(this,
function(t,w){w="esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type&&"esriFieldTypeGeometry"!==t.type;var u=null,v=t.editable&&"esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type;if(w){var x=t.name.toLowerCase(),z=q+"stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,";c&&(z+="raster.itempixelvalue,",d&&(z+="raster.magnitude,raster.direction,"));if(-1<z.indexOf(","+x+",")||-1<x.indexOf("shape")||-1<x.indexOf("perimeter")||-1<x.indexOf("objectid")||
-1<x.indexOf("raster.servicepixelvalue.")||x.indexOf("_i")==x.length-2)w=!1;t.type in f?u={places:0,digitSeparator:!0}:t.type in h?u={places:l&&(-1<x.indexOf("raster.servicepixelvalue")||-1<x.indexOf("raster.itempixelvalue"))?0:2,digitSeparator:!0}:t.type in r&&(10<=g.currentVersion||n&&10<=n.version)&&(u={dateFormat:"longMonthDayYear"})}v=v?-1===q.indexOf(","+t.name.toLowerCase()+","):v;return a.mixin({},{fieldName:t.name,label:t.alias,isEditable:v,tooltip:"",visible:w,format:u,stringFieldOption:"textbox"})}));
m={title:m,fieldInfos:b,description:null,showAttachments:!0,mediaInfos:[]};e(n)?(m.layerOptions={},m.layerOptions.showNoDataRecords=!0,m.layerOptions.returnTopmostRaster=!0):K(n)&&(m.layerOptions={},m.layerOptions.showNoDataRecords=!0);return m}})},"arcgisonline/map/popup/isImageServiceLayer":function(){define(["esri/layers/ArcGISImageServiceLayer","esri/layers/ArcGISImageServiceVectorLayer"],function(e,K){return function(p){return p instanceof esri.layers.ArcGISImageServiceLayer||p instanceof esri.layers.ArcGISImageServiceVectorLayer}})},
"arcgisonline/map/popup/isTiledImageServiceLayer":function(){define(["esri/layers/RasterXLayer"],function(e){return function(K){return K instanceof esri.layers.RasterXLayer}})},"arcgisonline/sharing/dijit/dialog/getWMTSConfig":function(){define("dojo/Deferred dojo/json dojo/_base/array dojo/_base/lang esri/renderers/SimpleRenderer esri/symbols/jsonUtils esri/SpatialReference esri/geometry/Extent arcgisonline/map/core/sameSpatialReference arcgisonline/map/core/projectExtent".split(" "),function(e,
K,p,a,g,m,n,b,c,d){function l(f){var r=new e;h(f.selectedLayer.gcsExtent,f.selectedTileInfo.fullExtent).then(function(q){r.resolve(q&&q.toJson())});return r}function h(f,r){var q=new e;r=r.spatialReference||new n({wkid:4326});handler=a.hitch(this,function(t){q.resolve(t&&t.length&&t[0]&&t[0].type&&"extent"===t[0].type?t[0]:null)});d(f,r,handler,handler);return q}return function(f){var r=new e,q=f.selectedLayer||{},t=f.selectedTileInfo||{},w;l(f).then(a.hitch(this,function(u){var v=f.selectedLayer;
var x=f.selectedTileInfo,z=-1<dojo.indexOf(v.formats,"image/png")?"image/png":v.formats[0];f.resourceUrls=v.resourceUrls;v=f.getTileUrlTemplate({identifier:v.identifier,tileMatrixSet:x.tileMatrixSet,format:z});(x=f.copyright)&&"none"!==x.toLowerCase()?180<x.length&&(x=x.substring(0,180)+".."):x="";z=u||f.selectedTileInfo.fullExtent;var A=f.selectedTileInfo.tileInfo||{};if(96!==A.dpi){for(var B=0;B<A.lods.length;B++){var J=A.lods[B];J.scale=96*J.scale/A.dpi}A.dpi=96}A=A.toJson();w={templateUrl:v,copyright:x,
fullExtent:z,tileInfo:A,wmtsInfo:{url:f.wmtsUrl,layerIdentifier:q.identifier,tileMatrixSet:t.tileMatrixSet}};r.resolve({wmtsConfig:w,fullExtent:u})}));return r}})},"arcgisonline/map/thumbnail/buildThumbnailURLFromFSUrl":function(){define(["arcgisonline/map/thumbnail/buildThumbnailURLFromFSItem"],function(e){return function(K,p){return e({url:K,extent:p})}})},"arcgisonline/map/thumbnail/buildThumbnailURLFromWFSItem":function(){define(["dojo/Deferred","dojo/_base/lang","./buildThumbnailURLFromWebMap",
"./getItemData","arcgisonline/sharing/util"],function(e,K,p,a,g){return function(m,n){var b={};b.baseMap=esriGeowConfig.defaultBasemap||esriGeowConfig.self.defaultBasemap;b.baseMap.title="basemap";for(var c=b.baseMap.baseMapLayers.length,d=0;d<c;d++){var l=b.baseMap.baseMapLayers[d];if(!l.isReference){!esriGeowConfig.allSSL&&"https:"!=location.protocol||!g.isHostedService(l.url)&&!g.supportsHttps(l.url)||(l.url=l.url.replace("http:","https:"));l.visibility=!1;b.baseMap.baseMapLayers=[l];break}}b.operationalLayers=
[];var h=new e;c=function(f){f.type="WFS";f.layerType="WFS";f.opacity=1;f.visibility=!0;f.id="wfs_xxx";f.wfsInfo.maxFeatures=f.wfsInfo.maxFeatures||100;b.operationalLayers.push(f);p(b,n||m.extent,K.hitch(this,function(r){h.resolve(r)}),K.hitch(this,function(r){h.reject(r)}))};m.id?a(m.id,K.hitch(this,c),K.hitch(this,c)):c();return h}})},"arcgisonline/map/thumbnail/buildThumbnailURLFromWMTSItem":function(){define(["dojo/Deferred","dojo/_base/lang","./buildThumbnailURLFromWebMap","./getItemData"],function(e,
K,p,a){return function(g,m){var n=new e,b=function(c){var d={baseMap:{}};d.baseMap.title="basemap";d.baseMap.baseMapLayers=[];d.operationalLayers=[];c.opacity=1;c.visibility=!0;c.layerType="WebTiledLayer";c.type="WebTiledLayer";d.baseMap.baseMapLayers.push(c);p(d,m||g.extent,K.hitch(this,function(l){n.resolve(l)}),K.hitch(this,function(l){n.reject(l)}))};g.id?a(g.id,K.hitch(this,b),K.hitch(this,b)):b();return n}})},"arcgisonline/sharing/dijit/dialog/_PublishImageCollection":function(){define("require exports tslib ../../../esriGeowConfig ../../util arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin dojo/Deferred dojo/_base/lang".split(" "),
function(e,K,p,a,g,m,n,b){Object.defineProperty(K,"__esModule",{value:!0});K.PublishImageCollection=void 0;a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);e=function(){function c(){}c.findTemplate=function(){var d=a.default.portal,l=new n.default;d.queryGroups({q:'title: "Esri Layer Templates" AND owner: "esri_en"',num:1},!0).then(function(h){return(null===h||void 0===h?0:h.total)?h.results.shift():null}).then(function(h){h={q:'title:"Points" group:"'.concat(h.id,
'" AND type:"Layer Template" -type:"Attachment"'),num:1};return d.queryItems(h,!0).then(function(f){return(null===f||void 0===f?0:f.total)?f.items.shift():null})}).then(function(h){h.getData().then(function(f){l.resolve(f)})});return l};c.createService=function(d){var l=this,h,f,r=new n.default,q=this._item,t=b.default.mixin(b.default.clone(d),{name:q.name}),w=a.default.portal,u=JSON.stringify({layers:null!==(h=t.layers)&&void 0!==h?h:[],tables:null!==(f=t.tables)&&void 0!==f?f:[]});delete t.layers;
delete t.tables;delete t.initialExtent;delete t.fullExtent;delete t._ssl;h={createParameters:JSON.stringify(t),targetType:"featureService"};m.default.createService(q,h,u,w).then(function(v){l._service=b.default.mixin(d,v.createResult,{id:v.createResult.itemId});r.resolve(v)},function(v){r.reject(v)});return r};c.moveService=function(){var d=this._service,l=this._item,h=a.default.portal,f=new n.default;l.ownerFolder&&"/"!==l.ownerFolder&&"root"!==l.ownerFolder?m.default.moveItem(d,l.ownerFolder,h).then(function(){f.resolve(d)},
function(r){f.reject(r)}):f.resolve(d);return f};c.appendPhotos=function(){var d,l=this._service,h=l.layers.shift();h=l.encodedServiceURL+"/"+(null!==(d=h.id)&&void 0!==d?d:0)+"/append";d={appendItemId:this._item.id,appendUploadFormat:"imageCollection",appendAttachmentsInfo:JSON.stringify({ignoreAttachmentsWithoutLocation:!0}),upsert:!1,useGlobalIds:!1,rollbackOnFailure:!0};var f=new n.default;g.default.request({url:h,content:d},{usePost:!0}).then(function(r){f.resolve(b.default.mixin(l,r))},function(r){f.reject(r)});
return f};c.addRelationship=function(){var d,l=this._service,h=this._item,f=(null===(d=a.default.portal)||void 0===d?void 0:d.portalUser).userContentUrl;d={relationshipType:"Service2Data",destinationItemId:h.id,originItemId:l.id};var r=new n.default;g.default.request({url:f+"/addRelationship",content:d},{usePost:!0}).then(function(){r.resolve(l)},function(q){r.reject(q)});return r};c.checkStatus=function(d,l,h){var f=null===d||void 0===d?void 0:d.statusUrl,r=null!==h&&void 0!==h?h:new n.default,q=
null!==l&&void 0!==l?l:500;g.default.request({url:f}).then(function(t){var w,u;t=null!==t&&void 0!==t?t:{status:"completed"};"completed"===(null===(w=t.status)||void 0===w?void 0:w.toLowerCase())?r.resolve(!0):"failed"===(null===(u=t.status)||void 0===u?void 0:u.toLowerCase())||t.error||400<t.code||""===t.status?r.reject(t):(q=(null!==q&&void 0!==q?q:500)+125,setTimeout(function(){c.checkStatus(d,q,r)},l))},function(t){r.reject(t)});return r};c.publish=function(d){var l=this,h=new n.default;c._item=
null!==d&&void 0!==d?d:{};c.findTemplate().then(c.createService.bind(c)).then(c.moveService.bind(c)).then(c.appendPhotos.bind(c)).then(c.addRelationship.bind(c)).then(c.checkStatus.bind(c)).then(function(){h.resolve(l._service)},function(f){h.resolve(b.default.mixin(l._service,{error:f}))});return h};return c}();K.PublishImageCollection=e})},"arcgisonline/sharing/dijit/dialog/PublishWizard":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/cookie dojo/on dojo/json dojo/_base/array dijit/registry dijit/_Widget dijit/_Templated dijit/form/RadioButton dijit/form/Select dijit/form/TextBox dijit/form/NumberTextBox dojo/Deferred dojo/promise/all dojo/aspect dojo/Evented dojo/_base/kernel put-selector/put dgrid/OnDemandGrid dgrid/Selection dgrid/editor dojo/store/Memory dojo/store/Observable dojox/widget/Wizard dojox/widget/WizardPane dojo/_base/event dojo/keys dojo/topic arcgisonline/sharing/geow/Account arcgisonline/sharing/geow/Folder arcgisonline/sharing/util arcgisonline/sharing/dijit/dialog/GeneralDlg arcgisonline/sharing/dijit/dialog/BrowseItemsDlg arcgisonline/sharing/dijit/dialog/ItemPropertiesDlg arcgisonline/sharing/dijit/dialog/PluginLayerTemplates arcgisonline/sharing/dijit/dialog/PluginFeatureServices arcgisonline/sharing/dijit/dialog/PublishTileServiceDlg arcgisonline/sharing/dijit/dialog/_HighAccuracyFields arcgisonline/pages/pageUtil arcgisonline/pages/utils/arrays arcgisonline/pages/utils/categories arcgisonline/pages/utils/number esri/dijit/Tags esri/layers/ArcGISTiledMapServiceLayer esri/layers/ImageParameters esri/map esri/config esri/lang arcgisonline/map/popup/getDefaultPopupInfo esri/geometry/Extent esri/SpatialReference esri/geometry/webMercatorUtils ../../../map/core/sameSpatialReference ../../../map/core/projectExtent ../../../esriGeowConfig dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U,M,Q,Y,fa,va,Aa,pa,N,V,Z,ba,ma,sa,Ea,ya,wa,aa,ca,ka,qa,da,ia,ra,Fa){return e("arcgisonline.sharing.dijit.dialog.PublishWizard",[I],{baseClass:"esriPublishingWizard esriItemLinks",hideDisabled:!0,onDone:function(){},onCancel:function(){},cancelFunction:function(){this.onCancel()},postMixInProperties:function(){this.inherited(arguments);this.i18n=K.mixin({},Fa.common);this.i18n=K.mixin(this.i18n,Fa.publishWizard);this.i18n=
K.mixin(this.i18n,Fa.publishTileServiceDlg);this.i18n2=K.mixin({},Fa.addItemFrm);this.i18n.errors.serviceNameExists=this.i18n2.errors.serviceNameExists;this.i18n.errors.invalidCharactersService=this.i18n2.errors.invalidCharactersService;this.previousButtonLabel=this.i18n.previousButtonLabel;this.nextButtonLabel=this.i18n.nextButtonLabel;this.doneButtonLabel=this.i18n.doneButtonLabel;this.cancelButtonLabel=this.i18n.cancelButtonLabel},postCreate:function(){this._account=G;this._util=O;this._folder=
L;this._errorDlg=U.prototype.statics.getInstance();this._init();p.add(this.nextButton.domNode,["calcite","primary"]);p.add(this.cancelButton.domNode,["calcite","cancel"]);p.add(this.previousButton.domNode,["calcite","default","btn-back"]);p.add(this.doneButton.domNode,["calcite","primary"]);this._spinner=m.create("span",{"class":"spinner hide",innerHTML:this.i18n.pleaseWait},n(".dojoxWizardButtons",this.domNode)[0],"first");document.documentElement.scrollTop=document.body.scrollTop=(document.documentElement.scrollTop||
document.body.scrollTop)+1;this.inherited(arguments)},destroy:function(){for(var ea;ea=this._connects.pop();)ea.remove();for(;ea=this._panes.pop();)this.removeChild(ea),ea.destroyRecursive();this.inherited(arguments)},_init:function(){this._account.getSelf(K.hitch(this,function(){ya.defaults.io.proxyUrl=ra.proxyServer;this._connects=[];this._panes=[];this._loadConnections();this._user=this._util.getUser();this._restBaseUrl=ra.allSSL?ra.restBaseUrl.replace("http:/","https:/"):ra.restBaseUrl;this._restBaseUrl+=
this._restBaseUrl.lastIndexOf("/")===this._restBaseUrl.length-1?"":"/";this._contentUrl=this._restBaseUrl+"content";this._publishUrl=this._contentUrl+"/users/"+this._user.username;this._defaultExtent=ra.self.defaultExtent;this._tileGalleryQueryParams={query:'type:"Feature Service" AND typekeywords:"Hosted Service" AND -typekeywords:"webmap_2.1" AND -typekeywords:"Spatiotemporal" AND orgid:"'+this._user.orgId+'" AND owner:"'+this._user.username+'"'};this._svcQueryParams={q:'type:"Feature Service" AND typekeywords: "Hosted Service" AND orgid:'+
this._user.orgId,num:100,start:0,sortField:"title",sortOrder:"asc"};this._tQueryParams={q:'type:"Layer Template" AND typekeywords: "Service template"',num:100,start:0,sortField:"title",sortOrder:"asc"};this._editingInfo={hasStaticData:!1,capabilities:"Query,Editing,Create,Update,Delete",allowGeometryUpdates:!0};this.addChild(this._galleryPane(this.itemType));"features"===this.itemType?(this.addChild(this._layersPane()),this.addChild(this._extentPane()),this.addChild(this._itemDetailsPane())):this.addChild(this._tilesPane())}),
null)},_loadConnections:function(){this.own(y.subscribe("/esri/disable",K.hitch(this,function(ea,xa){this._disable(ea,xa||Fa.common.pleaseWait)})),y.subscribe("/esri/browseitems/close",K.hitch(this,function(ea){"on-next"===ea?(this._infoPanelShowing=!1,this.nextButton.onClick(),this._showCancelButton(!1)):"on-view-item"===ea&&window.open("item.html?id\x3d"+this._browseDlg.get("selection").id)})),y.subscribe("/esri/browseitems/showInfoTemplate",K.hitch(this,function(ea){this._infoPanelShowing=ea;this._showCancelButton(this._infoPanelShowing)})));
z.after(this,"_checkButtons",function(){this.nextButton.set("disabled",this.selectedChildWidget.isLastChild);this._showCancelButton(this._infoPanelShowing);this._setButtonClass(this.nextButton);this.selectedChildWidget.isFirstChild&&"fromUrl"!==this._selectedTab&&(this.nextButton.domNode.style.display="none")})},_setButtonClass:function(ea){p.contains(ea.domNode,"btn-back")?ea.domNode.style.visibility=this.hideDisabled&&ea.disabled?"hidden":"visible":this.inherited(arguments)},_showCancelButton:function(ea){"features"!==
this.itemType&&(this.cancelButton.domNode.style.display=ea?"none":"")},_galleryPane:function(ea){return"features"===ea?this._galleryPaneFeatures():this._galleryPaneTiles()},_galleryPaneFeatures:function(ea){ea=new F({canGoBack:!1});var xa=document.createDocumentFragment(),ta,Ba={fromExisting:"from existing layer",fromTemplate:"from template",fromUrl:"from url"};this._browseDlg=ta=new M({messageLeft:Fa.browseItemsDlg.instructionsLeft,messageRight:this.i18n.selectFeatureLayerTemplate,item:K.mixin(this.item,
{tags:""}),"class":"esriBrowseItemsDlg"});this._telemetryAttribute=Ba.fromTemplate;this._isTemplateSelected=!0;this._selectedTab="fromTemplate";var Na=m.create("div",{id:"galleryTabs","class":"galleryTabs tabs-transparent tab-nav"},xa);m.create("a",{"class":"esriPublishTab tab-title selected is-active",id:"fromTemplate",href:"#",innerHTML:this.i18n.fromTemplate},Na);m.create("a",{"class":"esriPublishTab tab-title",id:"fromExisting",href:"#",innerHTML:this.i18n.fromLayer},Na);m.create("a",{"class":"esriPublishTab tab-title",
id:"fromUrl",href:"#",innerHTML:this.i18n.fromUrl},Na);var Ra=m.create("div",{id:"templateContent","class":"templateContent withTabs tab-contents padding-leader-quarter"},xa);var Ca=m.create("div",{id:"fromUrlDiv","class":"fromUrl padding-leader-quarter hide"},xa);ta.addPlugin("arcgisonline/sharing/dijit/dialog/PluginLayerTemplates");m.place(ta.domNode,Ra);m.create("p",{innerHTML:this.i18n.chooseUrl},Ca);m.create("label",{"for":"fromUrlInput","class":"esriTrailingMargin1 trailer-0",innerHTML:this.i18n.urlItemLbl},
Ca);var H=new w({id:"fromUrlInput",name:"url",trim:"true",placeHolder:this.i18n.urlItemPlaceHolder},m.create("span",{},Ca));c(Na,"click",K.hitch(this,function(W){W.preventDefault();n("a",Na).forEach(function(ha){p.remove(ha,"selected");p.remove(ha,"is-active")});p.add(W.target,"selected");p.add(W.target,"is-active");p.add(Ra,"hide");p.add(Ca,"hide");this._selectedService=null;this._isTemplateSelected="fromTemplate"===W.target.id;ta&&(ta.destroyRecursive(),ta=null);this._selectedTab=W=W.target.id;
this._telemetryAttribute=Ba[W];this.nextButton.domNode.style.display="fromUrl"!==W?"none":"";"fromExisting"===W?(this._browseDlg=ta=new M({message:this.i18n.selectTemplate,item:K.mixin(this.item,{tags:""}),"class":"esriBrowseItemsDlg"}),ta.addPlugin("arcgisonline/sharing/dijit/dialog/PluginFeatureServices"),m.place(ta.domNode,Ra),p.remove(Ra,"hide"),ta.set("message",this.i18n.selectExistingLayer)):"fromTemplate"===W?(this._browseDlg=ta=new M({messageLeft:Fa.browseItemsDlg.instructionsLeft,messageRight:this.i18n.selectFeatureLayerTemplate,
item:K.mixin(this.item,{tags:""}),"class":"esriBrowseItemsDlg"}),ta.addPlugin("arcgisonline/sharing/dijit/dialog/PluginLayerTemplates"),m.place(ta.domNode,Ra),p.remove(Ra,"hide"),ta.set("messageLeft",Fa.browseItemsDlg.instructionsLeft),ta.set("messageRight",this.i18n.selectTemplate)):(p.remove(Ca,"hide"),H.set("value",""))}));this._connect(H,"change",K.hitch(this,function(W){if(W){var ha=/(\/(FeatureServer)).*/ig;W=W.split("?")[0];var na=W.replace(/http.+\/(arcgis\/rest\/services|arcgis\/services)\/?/ig,
"").match(ha);na=na&&na.length?na[0].split("/")[1]:null;var za=W.toLowerCase().indexOf("/featureserver");na?(W=W.substring(0,za)+"/FeatureServer",/(http|https):\/\/?/.exec(W)||(W="http://"+W),H.set("value",W),this._selectedService={name:W.replace(ha,"").replace(/^.*\//,"").replace(/\?.*$/,""),svcUrl:W}):(this._svcErr={id:W,error:this.i18n.errors.unknownService},this._showError(this.i18n.errors.unknownService))}}));ea.passFunction=K.hitch(this,function(){var W=ta&&ta.get("selection")||this._selectedService;
return W?(this._selectedService=this._isTemplateSelected?K.mixin(W,{svcUrl:this._restBaseUrl+"content/items/"+W.id+"/data"}):K.mixin(W,{svcUrl:W.svcUrl||W.url}),!0):this._showError("fromExisting"===this._selectedTab?this.i18n.errors.noSelectedService:"fromTemplate"===this._selectedTab?this.i18n.errors.noSelectedTemplate:this.i18n.errors.noLayerUrl)});ea.set("content",xa);this._panes.push(ea);return ea},_showHelpLink:function(ea,xa,ta){var Ba=n(".esriBrowseItems .icon-ui-question",this.domNode).shift();
ea=ea?"remove":"show";xa&&g.set(Ba,"title",xa);ta&&g.set(Ba,"href",ta);p[ea](Ba,"hide")},_galleryPaneTiles:function(){var ea=new F({canGoBack:!1}),xa=document.createDocumentFragment(),ta;var Ba=m.create("div",{id:"templateContent","class":"templateContent"},xa);this._browseDlg=ta=new M({message:this.i18n.errors.noSelectedService.message,itemQuery:this._tileGalleryQueryParams,item:K.mixin(this.item,{tags:""}),"class":"esriBrowseItemsDlg"});m.place(ta.domNode,Ba);ta.set("message",this.i18n.errors.noSelectedService.message);
ea.passFunction=K.hitch(this,function(){var Na=ta&&ta.get("selection")||this._selectedService;return Na&&Na.url?(Na.url!==(this._selectedService&&this._selectedService.url)&&(this._featureServiceJson=null,this._isUserDefinedTileInfo=!1,this.userDefinedTileInfo=null,this._selectedService=K.mixin(Na,{svcUrl:Na.svcUrl||Na.url})),!0):Na?this._showError(this.i18n.errors.noItemUrl):this._showError(this.i18n.errors.noSelectedService)});ea.set("content",xa);this._panes.push(ea);return ea},_tilesPane:function(){var ea=
new F({canGoBack:!0}),xa=document.createDocumentFragment(),ta=new va({message:this.i18n.itemDetails,showFolders:!0,type:"tiles"});m.place(ta.domNode,xa);c(ea,"show",K.hitch(this,function(){this._fetchItem(this._selectedService.id).then(K.hitch(this,function(Ba){this._selectedService=K.mixin(this._selectedService,Ba);ta.set("item",this._selectedService);ra.self.hasCategorySchema&&ta.set("categories",this._selectedService.categories)}),K.hitch(this,function(Ba){this._showError(Ba)}))}));c(ta.domNode,
"keyup",K.hitch(this,function(Ba){Ba.keyCode===C.ENTER&&(D.stop(Ba),ea.doneFunction())}));ea.doneFunction=K.hitch(this,function(){this._disable(!0,Fa.publishTileServiceDlg.publishingTileService);ta._validate().then(K.hitch(this,function(){ta.publishService().then(K.hitch(this,function(Ba){this.onDone(Ba,this._telemetryAttribute)}))}))});ea.set("content",xa);this._panes.push(ea);return ea},_setCalculatedScales:function(ea,xa,ta){var Ba=ta.lods,Na=ta.minLevel+2<Ba.length?ta.minLevel+2:Ba.length-1;xa.set("value",
Ba[-1<ta.maxLevel-2?ta.maxLevel-2:0].level);ea.set("value",Ba[Na].level)},_layersPane:function(){var ea=new F({canGoBack:!0}),xa=document.createDocumentFragment(),ta;m.create("div",{innerHTML:this.i18n.details},xa);m.create("br",{},xa);var Ba=m.create("div",{"class":"layerDetails"},xa),Na=m.create("div",{"class":"grid layerGrid table-layout"},Ba);m.create("label",{innerHTML:this.i18n.layersLbl},Na);var Ra=[S({field:"visible",autoSave:!0},"checkbox"),S({field:"name",editOn:"click",autoSave:!0},"text")];
this._layerStore=new E(new T({data:[]}));this._layersGrid=new (e([P,R]))({selectionMode:"none",store:this._layerStore,showHeader:!1,pagingLinks:2,loadingMessage:this.i18n.loadingMessage,columns:Ra},m.create("div",{},Na));this._layersGrid.startup();m.create("br",{},Ba);Na=m.create("label",{innerHTML:this.i18n.gpsMetadataLabel,"class":"hide esriHighAccuracy js-highAccuracy"},Ba);this._highAccuracyCheckbox=m.create("input",{type:"checkbox","class":"hide  js-highAccuracy",checked:!1,disabled:!1},Na,"first");
Ba=m.create("label",{innerHTML:this.i18n.contansZValues,"class":"hide esriContainsZ js-containsZ"},Ba);this._containsZCheckbox=m.create("input",{type:"checkbox","class":"hide  js-containsZ",checked:!1,disabled:!1},Ba,"first");c(ea,"show",K.hitch(this,function(){n(".js-highAccuracy",this.domNode)[this._hasPointLayer?"removeClass":"addClass"]("hide");n(".js-containsZ",this.domNode)[this._isTemplateSelected?"removeClass":"addClass"]("hide");if(this._svcErr||ta!==this._selectedService.svcUrl){this._selectedService.svcUrl=
this._selectedService.svcUrl.replace(/\d+$/,"");if((ta=this._selectedService.svcUrl)&&-1<ta.toLowerCase().indexOf("/mapserver"))return this._showError(this.i18n2.errors.unknownAGSType);setTimeout(K.hitch(this,function(){g.set(this._highAccuracyCheckbox,"checked",!1);g.set(this._containsZCheckbox,"checked",!1);this._updateServiceDetails(ta)}),250)}}));ea.passFunction=K.hitch(this,function(){return this._svcErr||!this._featureServiceJson?this._showError(this.i18n.errors.selectService):this._layerStore&&
0>=this._layerStore.query({visible:!0}).length?this._showError(this.i18n.errors.selectLayers):!0});ea.set("content",xa);this._panes.push(ea);return ea},_showLoadingMessage:function(ea){ea?(this._loadingNode=J(this._layersGrid.preload.node,"-div.dgrid-loading[style\x3dheight:20px]"),J(this._loadingNode,"div.dgrid-below").innerHTML=this._layersGrid.loadingMessage):J(this._loadingNode,"!")},_extentPane:function(){var ea=new F({canGoBack:!0}),xa=document.createDocumentFragment(),ta=m.create("div",{"class":"extentDetails"},
xa);m.create("div",{innerHTML:this.i18n.extentDetails},ta);m.create("br",{},ta);var Ba=m.create("div",{style:{width:"80%",height:"65%"}},ta),Na=m.create("div",{"class":"esriLeadingMargin15",style:{width:"100%",height:"100%"}},Ba);m.create("br",{},ta);ta=m.create("fieldset",{},ta);m.create("label",{"for":"extentLeft",innerHTML:this.i18n.extentLeftLbl},ta);var Ra=new u({name:"extentLeft",trim:"true","class":"extent",constraints:{min:-180,max:180,pattern:"###.###"},invalidMessage:this.i18n.errors.errorLon,
rangeMessage:this.i18n.errors.errorLon,required:!0,placeHolder:this.i18n.extentLeftPlaceHolder},m.create("input",{},ta));m.create("label",{"for":"extentRight",innerHTML:this.i18n.extentRightLbl},ta);var Ca=new u({name:"extentRight",trim:"true","class":"extent",constraints:{min:-180,max:180,pattern:"###.###"},invalidMessage:this.i18n.errors.errorLon,rangeMessage:this.i18n.errors.errorLon,required:!0,placeHolder:this.i18n.extentRightPlaceHolder},m.create("input",{},ta));m.create("br",{},ta);m.create("label",
{"for":"extentTop",innerHTML:this.i18n.extentTopLbl},ta);var H=new u({name:"extentTop",trim:"true",constraints:{min:-90,max:90,pattern:"##.###"},invalidMessage:this.i18n.errors.errorLat,rangeMessage:this.i18n.errors.errorLat,required:!0,"class":"extent",placeHolder:this.i18n.extentTopPlaceHolder},m.create("input",{},ta));m.create("label",{"for":"extentBottom",innerHTML:this.i18n.extentBottomLbl},ta);var W=new u({name:"extentBottom",trim:"true",constraints:{min:-90,max:90,pattern:"##.###"},invalidMessage:this.i18n.errors.errorLat,
rangeMessage:this.i18n.errors.errorLat,required:!0,"class":"extent",placeHolder:this.i18n.extentBottomPlaceHolder},m.create("input",{},ta));ea.passFunction=K.hitch(this,function(){var ha=!1;return(ha=n(".extent").map(h.byNode).every(function(na){return!isNaN(na.get("value"))&&na.isValid()}))?ha:this._showError(this.i18n.errors.invalidExtent)});c(ea,"show",K.hitch(this,function(){if(!this.map){this.map=new Ea(Na,{showAttribution:!1,extent:this._serviceExtent,wrapAround180:!0});this._connect(this.map,
"extent-change",K.hitch(this,function(na){na=this.map.extent;4326!==na.spatialReference.wkid&&(na=this._fixExtent(na));this._serviceExtent=this._clipExtent(na);Ra.set("value",this._serviceExtent.xmin,!1);W.set("value",this._serviceExtent.ymin,!1);Ca.set("value",this._serviceExtent.xmax,!1);H.set("value",this._serviceExtent.ymax,!1)}));var ha=new sa;ha.format="png24";ha=new ma(ra.extentService,{imageParameters:ha});this.map.addLayer(ha);this._connect(ha,"update",K.hitch(this,function(){this.map.reposition()}));
ha=function(na,za,Ga){isNaN(Ga)||!na.isValid()?na.set("value",this._serviceExtent[za]):this._serviceExtent[za]!==Ga&&(this._serviceExtent.update(Ra.get("value"),W.get("value"),Ca.get("value"),H.get("value"),this._serviceExtent.spatialReference),this.map.setExtent(this._serviceExtent))};c(Ra,"change",K.hitch(this,ha,Ra,"xmin"));c(W,"change",K.hitch(this,ha,W,"ymin"));c(Ca,"change",K.hitch(this,ha,Ca,"xmax"));c(H,"change",K.hitch(this,ha,H,"ymax"));Ra.focus()}}));ea.set("content",xa);this._panes.push(ea);
return ea},_itemDetailsPane:function(){var ea=new F({canGoBack:!0}),xa=document.createDocumentFragment(),ta=new Q({message:this.i18n.itemDetails,typeInfo:"featureserver",showFolders:!0,showFile:!1,showUrl:!1,item:{}});m.place(ta.domNode,xa);this.itemPropertiesDlg=ta;c(ta.domNode,"keyup",K.hitch(this,function(Ba){Ba.keyCode===C.ENTER&&Ba.target&&!p.contains(Ba.target,"dijitTextArea")&&Ba.target.id&&-1===Ba.target.id.indexOf("filter-")&&(D.stop(Ba),ea.doneFunction())}));c(ea,"show",K.hitch(this,function(){var Ba=
this._selectedService||{};ta.set("summary","fromUrl"===this._selectedTab?Ba.serviceDescription||"":this._isTemplateSelected?"":Ba.snippet||Ba.description);ta.set("tags",Ba.tags);ra.self.hasCategorySchema&&ta.set("categories",Ba.categories);ta.set("focus","title")}));ea.doneFunction=K.hitch(this,function(){ta._validate().then(K.hitch(this,function(Ba){var Na=ta.get("item");if(/(:|&|<|>|%|#|\?|\\|"|\/|\+)/.test(Na.title))return this._showError(this.i18n.errors.invalidCharactersService);this._content=
{title:Na.title,snippet:Na.snippet,description:"fromUrl"===this._selectedTab?this._selectedService.description:null,tags:Na.tags,folder:Na.folderId,extent:this._extent2String(this._serviceExtent||this._selectedService.extent),thumbnailURL:this._getThumbnailUrl(this._serviceExtent||this._selectedService.extent)};this._itemCategories=ra.self.hasCategorySchema&&ta._categories?ta._categories.getCategories(!0):void 0;Ba=this._selectedService.typeKeywords||null;this._isTableOnlyTemplate=this._isTemplateSelected&&
N.includes(Ba||[],"sourceId#Table")||!1;if(Ba&&Ba.length)for(var Ra=Ba.length-1;Ra--;)Ba[Ra].match(/(sourceId#|Singlelayer|Multilayer|Table).*/ig)&&Ba.splice(Ra,1);!0===this._highAccuracyCheckbox.checked&&(Ba=Ba&&Ba.length?Ba.concat(["gpsMetadataEnabled"]):["gpsMetadataEnabled"],this._isTemplateSelected&&this._selectedService&&this._selectedService.title&&(Ba=N.concatUnique(Ba,[this._selectedService.title])));this._selectedService.typeKeywords=Ba;this._userContentUrl=this._publishUrl+(this._content.folder&&
"/"!==this._content.folder?"/"+this._content.folder:"");"features"===this.itemType&&(this._selectedService&&this._selectedService.typeKeywords&&(this._content.typeKeywords=this._selectedService.typeKeywords.join(","),-1!==l.indexOf(this._selectedService.typeKeywords,"Service Template")||-1!==l.indexOf(this._selectedService.typeKeywords,"Collector"))&&(this._editingInfo=K.mixin(this._editingInfo,{capabilities:"Query,Editing,Create,Update,Delete,Sync",syncEnabled:!0})),this._util.isPortal()&&this._isTemplateSelected&&
(this._content.typeKeywords+=",providerSDS"));this._disable(!0,"features"===this.itemType?this.i18n.pleaseWait:this.i18n.creatingTileLayer);this._serviceNameAvailable(Na.title).then(K.hitch(this,function(){"features"===this.itemType?this._isTemplateSelected?this._publishService():this._getItemData(this._selectedService).then(K.hitch(this,"_publishService")):this._publishService(Na)}))}),K.hitch(this,function(Ba){return this._showError(Ba)}))});ea.set("content",xa);this._panes.push(ea);return ea},
_publishService:function(ea){var xa=new ca(qa.geographicToWebMercator(this._serviceExtent).toJson()),ta=this._featureServiceJson.service.editorTrackingInfo||{},Ba=this._featureServiceJson.service&&this._featureServiceJson.service.spatialReference,Na=this._userContentUrl,Ra=!0===this._highAccuracyCheckbox.checked,Ca=this._unique(this._editingInfo.capabilities.split(",").concat(this._featureServiceJson.service.capabilities.split(",")));this._featureServiceJson.service=K.mixin(this._featureServiceJson.service,
K.mixin(this._editingInfo,{capabilities:Ca.join(",")}));-1!==l.indexOf(this._selectedService.typeKeywords,"Service Template")||-1!==l.indexOf(this._selectedService.typeKeywords,"Collector")?K.mixin(this._featureServiceJson.service.editorTrackingInfo||{},{enableEditorTracking:!0,enableOwnershipAccessControl:!1,allowOthersToUpdate:!0,allowOthersToDelete:!0}):K.mixin(this._featureServiceJson.service.editorTrackingInfo||{},{allowOthersToDelete:wa.isDefined(ta.allowOthersToDelete)?ta.allowOthersToDelete:
!0,allowOthersToUpdate:wa.isDefined(ta.allowOthersToUpdate)?ta.allowOthersToUpdate:!0});this._project(xa,Ba).then(K.hitch(this,function(H){this._selectedLayerIds=[];this._layers=l.map(this._layerStore.query({visible:!0}),K.hitch(this,function(ha){var na=K.mixin({},ha);this._selectedLayerIds.push(na.id);na=K.mixin(na,this._editingInfo);l.forEach(["_ssl","visible","__isDirty"],K.hitch(this,function(za){delete na[za]}));"Feature Layer"===na.type&&(na.extent=H,na.name=this._layerStore.get(ha.id).name,
na.adminLayerInfo={geometryField:{name:"Shape",srid:H.spatialReference.wkid}});Ra&&"esriGeometryPoint"===na.geometryType&&(na.fields=this._getHighAccuracyFieldDefs(na.fields||[]));!0===this._containsZCheckbox.checked&&(na.hasZ=!0,na.enableZDefaults=!0,na.zDefault=0);return na}));Ra&&(ea=this._addHighAccuracyPopups(ea,this._layers));delete this._featureServiceJson.service.fullExtent;delete this._featureServiceJson.service.initialExtent;if(ea){var W=this._fixLayerIds(ea);W&&(W.tables=(W.tables||[]).concat((W.layers||
[]).filter(function(ha){return(ha=this._findLayer(ha.id,this._layers))&&"Table"===ha.type}.bind(this))),W.layers=(W.layers||[]).filter(function(ha){return(ha=this._findLayer(ha.id,this._layers))&&"Table"!==ha.type}.bind(this)),this._content.text=d.stringify(W))}else this._layers=this._fixLayerIds({layers:this._layers}).layers;this._featureServiceJson.service=K.mixin(this._featureServiceJson.service,{name:this._content.title.replace(/ /g,"_")});delete this._featureServiceJson.service.layers;delete this._featureServiceJson.service.tables;
delete this._content.folder;this._disable(!0);this._createService(Na+"/createService",{createParameters:d.stringify(this._featureServiceJson.service),targetType:"featureService"}).then(K.hitch(this,function(ha){ra.self.hasCategorySchema&&this._itemCategories?V.setItemCategories([this._service.id],this._itemCategories).then(K.hitch(this,function(){this._disable(!1);this.onDone(this._service,this._telemetryAttribute)})):(this._disable(!1),this.onDone(this._service,this._telemetryAttribute))}),K.hitch(this,
function(ha){this._deleteService();this._disable(!1);throw ha;}))}))},_findLayer:function(ea,xa){return xa.filter(function(ta){return ta.id===ea}).shift()},_project:function(ea,xa){var ta=new v,Ba=new ca(ea),Na=new ka(Ba.spatialReference);xa=new ka(xa);this._isTableOnlyTemplate||da(Na,xa)?ta.resolve(ea):ia(Ba,xa,function(Ra){Ra[0]?ta.resolve({spatialReference:Ra[0].spatialReference,xmax:Ra[0].xmax,xmin:Ra[0].xmin,ymax:Ra[0].ymax,ymin:Ra[0].ymin}):ta.resolve(ea)});return ta},_addHighAccuracyPopups:function(ea,
xa){var ta,Ba=ea&&ea.layers||xa.map(function(Na){return{id:Na.id}});xa=xa.map(K.hitch(this,function(Na){ta=N.find(Ba,function(Ra){return Ra.id===Na.id});return K.mixin(ta,{popupInfo:this._getPopupInfo(Na,ta)})}));return K.mixin(ea||{},{layers:xa})},_getPopupInfo:function(ea,xa){var ta=this._util.isPortal(),Ba=(xa=xa&&xa.popupInfo)||aa(ea,!1,ea),Na=K.mixin({},Aa.popupInfo),Ra=this._isTemplateSelected?this._selectedService&&(this._selectedService.title||this._selectedService.name):Ba&&Ba.title||ea.name;
ea&&"esriGeometryPoint"===ea.geometryType&&(Ba=K.mixin(Ba,xa||Na,{title:Ra,fieldInfos:this._getPopupFieldInfos(Ba.fieldInfos||[])}));ta&&Ba&&Ba.fieldInfos&&Ba.fieldInfos.forEach(function(Ca){Ca.fieldName=Ca.fieldName.toLowerCase()});return Ba},_getPopupFieldInfos:function(ea){var xa={},ta=Aa.popupInfo.fieldInfos||[];(ea||[]).forEach(function(Ba){xa[Ba.fieldName.toLowerCase()]=Ba});ta.forEach(function(Ba){xa[Ba.fieldName.toLowerCase()]=Ba});return N.toArray(xa)},_getHighAccuracyFieldDefs:function(ea){var xa=
{},ta=Aa.fieldDefs||[];(ea||[]).forEach(function(Ba){xa[Ba.name.toLowerCase()]=Ba});ta.forEach(function(Ba){xa[Ba.name.toLowerCase()]=Ba});return N.toArray(xa)},_createService:function(ea,xa){var ta=this._request(ea,xa,{usePost:!0});return ta.then(K.hitch(this,function(Ba){this._service=K.mixin(Ba,{id:Ba.itemId});return this._addLayers(this._service)}),K.hitch(this,function(Ba){this._showError(Ba,ta);throw Ba;}))},_addLayers:function(ea){var xa=ea.encodedServiceURL.replace("rest/services","rest/admin/services"),
ta=this._layers,Ba=[],Na;l.forEach(this._layers,K.hitch(this,function(Ca){Ca.relationships&&Ca.relationships.length&&(Ba.push({id:Ca.id,relationships:K.clone(Ca.relationships)}),delete Ca.relationships)}));var Ra=l.filter(ta,K.hitch(this,function(Ca){return Ca&&"Table"===Ca.type}));ta=l.filter(ta,K.hitch(this,function(Ca){return Ca&&"Feature Layer"===Ca.type}));return this._updateService(this._service,this._content).then(K.hitch(this,function(){return this._request(xa+"/addToDefinition",{addToDefinition:d.stringify({layers:ta,
tables:Ra})},{usePost:!0}).then(K.hitch(this,function(Ca){return this._enableEditorTracking(ea).then(K.hitch(this,function(){return this._addRelationships(ea,Ba).then(K.hitch(this,function(){this._isTemplateSelected&&-1!==l.indexOf(this._selectedService.typeKeywords,"Location Tracking")&&(Na=l.map(ta,K.hitch(this,function(H){return this._enableTime(ea,H)})));return x(Na||[]).then(K.hitch(this,function(){return Ca}))}))}))}),K.hitch(this,function(Ca){this._showError(Ca);throw Ca;}))}))},_enableEditorTracking:function(ea){var xa=
new v,ta=ea.encodedServiceURL.replace("rest/services","rest/admin/services"),Ba={editorTrackingInfo:{enableEditorTracking:!0}};hasZ=!0===this._containsZCheckbox.checked;this._util.isPortal()&&hasZ&&(Ba.hasZ=!0,Ba.enableZDefaults=!0,Ba.zDefault=0);this._isTemplateSelected?this._request(ta+"/updateDefinition",{updateDefinition:d.stringify(Ba)},{usePost:!0}).then(K.hitch(this,function(Na){xa.resolve(Na)}),K.hitch(this,function(Na){this._showError(Na);xa.cancel()})):xa.resolve(ea);return xa},_enableTime:function(ea,
xa){var ta=new v,Ba=this._util.isPortal();Ba={timeInfo:{startTimeField:Ba?"created_date":"CreationDate",endTimeField:Ba?null:"",trackIdField:Ba?null:"",timeExtent:[],timeReference:{timeZone:"UTC",respectDaylightSaving:!1},timeInterval:0,timeIntervalUnits:Ba?null:"",exportOptions:{useTime:!1,timeDataCumulative:!1,TimeOffset:0,timeOffsetUnits:"esriTimeUnitsCenturies"},hasLiveData:!0}};var Na=ea.encodedServiceURL.replace("rest/services","rest/admin/services");this._isTemplateSelected&&-1!==l.indexOf(this._selectedService.typeKeywords,
"Location Tracking")?this._request(Na+"/"+xa.id+"/updateDefinition",{updateDefinition:d.stringify(Ba)},{usePost:!0}).then(K.hitch(this,function(Ra){ta.resolve(Ra)}),K.hitch(this,function(Ra){this._showError(Ra);ta.cancel()})):ta.resolve(ea);return ta},_addRelationships:function(ea,xa){var ta=new v,Ba=ea.encodedServiceURL.replace("rest/services","rest/admin/services");xa&&xa.length?this._request(Ba+"/addToDefinition",{addToDefinition:d.stringify({layers:xa})},{usePost:!0}).then(K.hitch(this,function(Na){ta.resolve(Na)}),
K.hitch(this,function(Na){this._showError(Na);ta.cancel()})):ta.resolve(ea);return ta},_updateService:function(ea,xa){ea=this._userContentUrl+"/items/"+ea.id+"/update";var ta=new v;this._request(ea,xa,{usePost:!0}).then(K.hitch(this,function(Ba){ta.resolve(Ba)}),K.hitch(this,function(Ba){this._showError(Ba);ta.reject(Ba)}));return ta},_deleteService:function(){var ea=this._service&&this._service.itemId;if(ea)return ea=this._userContentUrl+"/items/"+ea+"/delete",this._request(ea,{},{usePost:!0})},
_fetchItem:function(ea){return this._request(ra.restBaseUrl+"content/items/"+ea)},_serviceNameAvailable:function(ea){ea={name:ea.replace(/ /g,"_"),type:"features"!==this.itemType?"Map Service":"Feature Service"};return this._request(this._restBaseUrl+"portals/"+this._user.accountId+"/isServiceNameAvailable",ea).then(K.hitch(this,function(xa){if(xa.available)return!0;this._showError(this.i18n.errors.serviceNameExists);throw!1;}))},_updateServiceDetails:function(ea){this._hasPointLayer=!1;this._layerStore.setData([]);
this._layersGrid.refresh();this._showLoadingMessage(!0);ea&&"1"!==ea&&this._copyServiceSchema(ea).then(K.hitch(this,function(xa){this._showLoadingMessage(!1);this._featureServiceJson=xa;this._intialExtent=new ca(ra.self.defaultExtent||this._featureServiceJson.service.initialExtent);this._serviceExtent=this._fixExtent(this._intialExtent);n(".js-highAccuracy",this.domNode)[this._hasPointLayer?"removeClass":"addClass"]("hide");n(".js-containsZ",this.domNode)[this._isTemplateSelected?"removeClass":"addClass"]("hide");
this._disable(!1)}))},_fixExtent:function(ea){ea=qa.webMercatorToGeographic(new ca(ea));var xa=ea.spatialReference._getInfo();if(xa&&ea.xmin>ea.xmax){var ta=xa.valid[1]-ea.xmin,Ba=ea.xmax-xa.valid[0];ta>Ba?ea.xmax=xa.valid[1]+Ba:ea.xmin=xa.valid[0]-ta}return this._clipExtent(ea)},_copyServiceSchema:function(ea){var xa=new v,ta={},Ba={addToken:!1};this._util.isHostedService(ea)||this._util.isAgolService(ea)||(Ba.addSSL=!1,Ba.addToken=!1);n(".dijitButton",this.domNode).map(h.byNode).forEach(function(Na){Na.set("disabled",
!0)});this._svcErr=!0;this._request(ea,{},K.mixin({timeout:6E4},Ba)).then(K.hitch(this,function(Na){if(!Na)return this._showError({message:wa.substitute({url:ea},this.i18n.errors.serviceNotExist.message)});this._svcErr=null;ta.service=Na;delete Na.id;this._selectedService=K.mixin(this._selectedService,Na);Na=l.map(Na.layers.concat(Na.tables||[]),K.hitch(this,function(Ra){if(Ra&&Ra.fields){var Ca=new v;Ca.resolve(Ra)}else Ca=this._request(ea+"/"+Ra.id,{},Ba);return Ca}));return x(Na).then(K.hitch(this,
function(Ra){this._layerStore.setData([]);ta.layers=l.map(Ra,K.hitch(this,function(Ca){this._layerStore.add(K.mixin(K.mixin({},Ca),{visible:!0}));this._hasPointLayer=this._hasPointLayer||Ca&&"esriGeometryPoint"===Ca.geometryType;return Ca}))}))}),K.hitch(this,function(Na){this._svcErr={id:ea,error:Na};this._showLoadingMessage(!1);this._showError({message:wa.substitute({url:ea},this.i18n.errors.serviceNotExist.message)});throw Na;})).then(K.hitch(this,function(){xa.resolve(ta)}));return xa},_getThumbnailUrl:function(ea){return"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/export?size\x3d800,532\x26bboxSR\x3d4326\x26format\x3dpng24\x26f\x3dimage\x26bbox\x3d"+
ea.xmin+","+ea.ymin+","+ea.xmax+","+ea.ymax},_getItemData:function(ea){var xa=this._contentUrl+"/items/"+ea.id+"/data";ea&&ea.id?ea=this._request(xa):(ea=new v,ea.resolve(null));return ea},_fixLayerIds:function(ea){var xa={},ta=ea.layers&&ea.layers.length?ea.layers.sort(function(Na,Ra){return parseInt(Na.id,10)-parseInt(Ra.id,10)}):[],Ba=this._selectedLayerIds;ta=l.map(l.filter(ta,function(Na){return 0<=l.indexOf(Ba,Na.id)}),function(Na,Ra){xa[Na.id]=Ra;Na.id=Ra;return Na});return this._fixRelationshipIds(K.mixin(ea,
{layers:ta}),xa)},_fixRelationshipIds:function(ea,xa){l.forEach(ea.layers||[],K.hitch(this,function(ta){ta&&ta.relationships&&ta.relationships.length&&(ta.relationships=l.filter(ta.relationships||[],K.hitch(this,function(Ba){return-1<l.indexOf(this._selectedLayerIds,Ba.relatedTableId)?(Ba.relatedTableId=wa.isDefined(xa[Ba.relatedTableId])?xa[Ba.relatedTableId]:Ba.relatedTableId,wa.isDefined(Ba.relationshipTableId)&&(Ba.relationshipTableId=wa.isDefined(xa[Ba.relationshipTableId])?xa[Ba.relationshipTableId]:
Ba.relationshipTableId),!0):!1})))}));return ea},_disable:function(ea,xa){n(".dijit, .dijitTextArea, .dojoxGrid",this.domNode).map(h.byNode).forEach(function(ta){ta.set("disabled",ea)});n("a",this.domNode)[ea?"addClass":"removeClass"]("disabledLink");n("label",this.domNode)[ea?"addClass":"removeClass"]("disabled");ea&&xa&&g.set(this._spinner,"innerHTML",xa);a.set(this._spinner,"display",ea?"inline-block":"none");this.itemPropertiesDlg&&(ea?this.itemPropertiesDlg.disableTagsAndCategories():this.itemPropertiesDlg.enableTagsAndCategories())},
_unique:function(ea){var xa={};return l.filter(ea,function(ta){return xa[ta]?!1:xa[ta]=!0})},_isEmpty:function(ea){return(this.trim?/^\s*$/:/^$/).test(ea)},_clipExtent:function(ea){ea.ymax=85<ea.ymax?85:+ea.ymax.toFixed(3);ea.ymin=-85>ea.ymin?-85:+ea.ymin.toFixed(3);ea.xmax=180<ea.xmax?180:+ea.xmax.toFixed(3);ea.xmin=-180>ea.xmin?-180:+ea.xmin.toFixed(3);return ea},_checkStatus:function(ea,xa,ta){ea?this._request(this._userContentUrl+"/items/"+ea.id+"/status",{jobId:ea.jobId}).then(K.hitch(this,function(Ba){Ba=
Ba||{status:"failed"};if("completed"===Ba.status)return xa.resolve(ea);if("failed"===Ba.status||""===Ba.status)return xa.reject({message:Ba.statusMessage});ta=(ta||500)+250;setTimeout(K.hitch(this,function(){this._checkStatus(ea,xa,ta)}),ta)}),K.hitch(this,function(Ba){xa.reject(Ba)})):xa.reject()},_request:function(ea,xa,ta){return this._util.request({url:ea,content:xa},ta)},_extent2String:function(ea,xa){xa=xa||4;var ta="";if(ea&&this._isValidNum(ea.xmin)&&this._isValidNum(ea.ymin)&&this._isValidNum(ea.xmax)&&
this._isValidNum(ea.ymax)){ta=ea.xmin.toFixed(xa);var Ba=ea.ymin.toFixed(xa),Na=ea.xmax.toFixed(xa);ea=ea.ymax.toFixed(xa);ta=isNaN(ta)||isNaN(Ba)||isNaN(Na)||isNaN(ea)?"":ta+","+Ba+","+Na+","+ea}return ta},_isValidNum:function(ea){return!isNaN(ea)&&void 0!==ea&&null!==ea},_connect:function(ea,xa,ta){ea=c(ea,xa,K.hitch(this,ta));this._connects.push(ea);return ea},_showError:function(ea,xa){xa&&xa.canceled||(ea&&!ea.message&&(ea=this.i18n.errors.error),ea=ea&&ea.error||ea||this.i18n.errors.error,ea.code=
ea.code||0,ea=this.i18n.errors[ea.code]||ea,-1<ea.message.indexOf("Unable to add feature service definition")&&(ea.message=Fa.publishWizard.errors.unableToAddFeatureServiceDefinition.message),"en"===B.locale&&(ea.details=ea.details&&ea.details.length?l.filter(ea.details,"return item !\x3d\x3d null"):null,ea.details&&ea.details.length&&(ea.details=ea.details.join("\x3cbr /\x3e"),ea.message=ea.message?ea.message+"\x3cbr /\x3e"+ea.details:ea.details)),ea=K.mixin(K.mixin({},this.i18n.errors.error),ea),
this._errorDlg.show(ea));this._disable(!1);return!1}})})},"arcgisonline/sharing/dijit/dialog/PluginLayerTemplates":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","./_LayerTemplateFiltersMixin","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,K,p,a,g){var m=e("arcgisonline.sharing.dijit.dialog.PluginLayerTemplates",null,{filters:a.rootNodes.layer,filterStrings:g.layerTemplateFilters,rowsPerPage:100,constructor:function(n){K.mixin(this,n)},fetchData:function(){this._portal=
this.parent&&this.parent._portal;this._user=this._portal.getPortalUser();var n;return this._fetchGroups().then(K.hitch(this,function(b){n=p.map(b||[],function(c){if(c)return'group:"'+c.id+'"'});return this._fetchGroupItems(n)}))},_fetchGroup:function(n,b){this._groups=this._groups||[];return this._groups[n]||this._portal.queryGroups(b,!0).then(K.hitch(this,function(c){c=c.total&&c.results&&c.results[0]||null;return(this._groups[n]=c)||{}}))},_fetchGroupItems:function(n,b){return this.parent._fetchItems({query:'type:"Layer Template" AND typekeywords: "Service Template" ',
groups:n})},_fetchGroups:function(){return this._fetchEsriLayerTemplates()},_fetchEsriLayerTemplates:function(){return this._fetchGroup("esriLayerTemplates",{q:esriGeowConfig&&esriGeowConfig.self&&esriGeowConfig.self.layerTemplatesGroupQuery,num:100,start:0,sortField:"title",sortOrder:"asc"}).then(K.hitch(this,function(n){return[n]}))}});K.mixin(m,{add:function(n,b){n.plugIn||(b=b||{},b.parent=n,n.plugIn=new m(b))},remove:function(n){n.plugIn&&(n.plugIn.destroy(),delete n.plugIn)}});return m})},"arcgisonline/sharing/dijit/dialog/_LayerTemplateFiltersMixin":function(){define(["dojo/_base/declare"],
function(){return{rootNodes:{layer:{all:{},buildlayer:{typekeywords:["Build a layer"]},agriculture:{typekeywords:["Agriculture"]},electricutil:{typekeywords:["Electric Utilities"]},environment:{typekeywords:["Environment"]},forestry:{typekeywords:["Forestry"]},gasutil:{typekeywords:["Gas Utilities"]},general:{typekeywords:["General"]},natresources:{typekeywords:["Natural Resources"]},petroleum:{typekeywords:["Petroleum"]},pubsafety:{typekeywords:["Public Safety"]},telecommunications:{typekeywords:["Telecommunications"]},
transportation:{typekeywords:["Transportation"]},waterutil:{typekeywords:["Water Utilities"]}}}}})},"arcgisonline/sharing/dijit/dialog/PluginFeatureServices":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/promise/all"],function(e,K,p,a){var g=e("arcgisonline.sharing.dijit.dialog.PluginFeatureServices",null,{rowsPerPage:8,constructor:function(m){K.mixin(this,m)},fetchData:function(){this._portal=this.parent._portal;this._user=this._portal.getPortalUser();return this._fetchServices()},
_fetchServices:function(){return this.parent._fetchItems({query:'type:"Feature Service" AND -owner: "esri_livingatlas" AND -typekeywords: "Spatiotemporal" AND accountid:"'+(this._user&&(this._user.orgId||this._user.accountId))+'"'})}});K.mixin(g,{add:function(m,n){m.plugIn||(n=n||{},n.parent=m,m.plugIn=new g(n))},remove:function(m){m.plugIn&&(m.plugIn.destroy(),delete m.plugIn)}});return g})},"arcgisonline/sharing/dijit/dialog/_HighAccuracyFields":function(){define([],function(){return{fieldDefs:[{name:"esrignss_speed",
type:"esriFieldTypeDouble",alias:"Speed (km/h)",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_direction",type:"esriFieldTypeDouble",alias:"Direction of travel (\u00b0)",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrisnsr_azimuth",type:"esriFieldTypeDouble",alias:"Compass reading (\u00b0)",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_positionsourcetype",type:"esriFieldTypeInteger",
alias:"Position source type",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:{type:"codedValue",name:"Location Tracking_esrignss_positionsourcetype_4bed2279-ed00-43d0-8608-14e188180566",codedValues:[{name:"Unknown",code:0},{name:"User defined",code:1},{name:"Integrated (System) Location Provider",code:2},{name:"External GNSS Receiver",code:3},{name:"Network Location Provider",code:4}]},defaultValue:null},{name:"esrignss_receiver",type:"esriFieldTypeString",alias:"Receiver Name",sqlType:"sqlTypeOther",
length:50,nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_h_rms",type:"esriFieldTypeDouble",alias:"Horizontal Accuracy (m)",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_v_rms",type:"esriFieldTypeDouble",alias:"Vertical Accuracy (m)",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_latitude",type:"esriFieldTypeDouble",alias:"Latitude",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,
defaultValue:null},{name:"esrignss_longitude",type:"esriFieldTypeDouble",alias:"Longitude",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_altitude",type:"esriFieldTypeDouble",alias:"Altitude",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_pdop",type:"esriFieldTypeDouble",alias:"PDOP",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_hdop",type:"esriFieldTypeDouble",
alias:"HDOP",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_vdop",type:"esriFieldTypeDouble",alias:"VDOP",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_fixtype",type:"esriFieldTypeSmallInteger",alias:"Fix Type",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:{type:"codedValue",name:"ESRI_FIX_TYPE_DOMAIN",codedValues:[{name:"NoFix",code:0},{name:"GPS",code:1},{name:"DifferentialGPS",code:2},{name:"PrecisePositioningService",
code:3},{name:"RTKFixed",code:4},{name:"RTKFloat",code:5}]},defaultValue:null},{name:"esrignss_correctionage",type:"esriFieldTypeDouble",alias:"Correction Age",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_stationid",type:"esriFieldTypeSmallInteger",alias:"Station ID",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_numsats",type:"esriFieldTypeSmallInteger",alias:"Number of Satellites",sqlType:"sqlTypeOther",
nullable:!0,editable:!0,domain:{type:"range",name:"ESRI_NUM_SATS_DOMAIN",range:[0,99]},defaultValue:null},{name:"esrignss_fixdatetime",type:"esriFieldTypeDate",alias:"Fix Time",sqlType:"sqlTypeOther",length:8,nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_avg_h_rms",type:"esriFieldTypeDouble",alias:"Average Horizontal Accuracy (m)",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_avg_v_rms",type:"esriFieldTypeDouble",alias:"Average Vertical Accuracy (m)",
sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_avg_positions",type:"esriFieldTypeInteger",alias:"Averaged Positions",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"esrignss_h_stddev",type:"esriFieldTypeDouble",alias:"Standard Deviation (m)",sqlType:"sqlTypeOther",nullable:!0,editable:!0,domain:null,defaultValue:null}],popupInfo:{fieldInfos:[{fieldName:"esrignss_receiver",label:"Receiver Name",isEditable:!1,tooltip:"",
visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_h_rms",label:"Horizontal Accuracy (m)",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_v_rms",label:"Vertical Accuracy (m)",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_latitude",label:"Latitude",isEditable:!1,tooltip:"",visible:!0,
format:{places:8,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_longitude",label:"Longitude",isEditable:!1,tooltip:"",visible:!0,format:{places:8,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_altitude",label:"Altitude",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_pdop",label:"PDOP",isEditable:!1,tooltip:"",visible:!0,
format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_hdop",label:"HDOP",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_vdop",label:"VDOP",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_fixtype",label:"Fix Type",isEditable:!1,tooltip:"",visible:!0,format:{places:0,
digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_correctionage",label:"Correction Age",isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_stationid",label:"Station ID",isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_numsats",label:"Number of Satellites",isEditable:!1,tooltip:"",
visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_fixdatetime",label:"Fix Time",isEditable:!1,tooltip:"",visible:!0,format:{dateFormat:"shortDateLongTime"},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_avg_h_rms",label:"Average Horizontal Accuracy (m)",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_avg_v_rms",label:"Average Vertical Accuracy (m)",
isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_avg_positions",label:"Averaged Positions",isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_h_stddev",label:"Standard Deviation (m)",isEditable:!1,tooltip:"",visible:!0,format:{places:3,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_positionsourcetype",
label:"Position source type",isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_speed",label:"Speed (km/h)",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"esrignss_direction",label:"Direction of travel (\u00b0)",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},
{fieldName:"esrisnsr_azimuth",label:"Compass reading (\u00b0)",isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0}],description:null,showAttachments:!0,mediaInfos:[]}}})},"arcgisonline/sharing/dijit/dialog/CreateFolder":function(){define("require esri/declare esri/Evented esri/kernel esri/lang esri/request esri/arcgis/Portal dojo/_base/lang dojo/_base/window dojo/_base/array dojo/topic dojo/string dojo/query dojo/on dojo/json dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/promise/all dojo/Deferred dojo/when ./ConfirmDialog dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/i18n!../../../nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/CreateFolder.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T){return K([J,P,R,p],{baseClass:"esriCreateFolderDlg",templateString:T,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.mixin({},S)},startup:function(){this.inherited(arguments);this.addEventHandlers()},getFolder:function(){var E=w.get(this._input,"value");return h.trim(E)},showModal:function(){var E=new z,I=new B({title:S.folderDlg.folderDlgTitle,buttonOk:S.common.create,buttonCancel:S.common.cancel,busyMessage:S.folderDlg.creatingFolder,
style:{width:"475px",height:"auto"}});I.setContent(this.domNode);I.show();setTimeout(function(){this._input.focus()}.bind(this),400);this.own(r(I,"ok",b.hitch(this,function(){this._validate(this.getFolder())&&this.createFolder().then(b.hitch(this,function(F){this.set("readOnly",!1);I.hide().then(b.hitch(function(){E.resolve(F)}))}),b.hitch(this,function(F){if(F&&F.messageCode&&"GWM_0021"===F.messageCode)this._showError(F);else{var D=h.substitute(S.folderDlg.invalid[F&&F.messageCode||"sameFolderName"],
[this.getFolder()]);this._showError(b.mixin(F,{message:D}))}E.reject(F);this.set("readOnly",!1)}))})));return E},createFolder:function(){var E=new z,I=this.portalUser,F=this.getFolder();this.set("readOnly",!0,S.folderDlg.creatingFolder);this.bypassApi?E.resolve({title:F,id:F}):I.createFolder(F).then(b.hitch(this,function(D){E.resolve(D)}),b.hitch(this,function(D){E.reject(D)}));return E},addEventHandlers:function(){var E=new z;this.own(r(this._createFolderForm,"submit",b.hitch(this,function(I){I.preventDefault()})));
E.resolve(!0);return E},_validate:function(E){return 0===E.length?this._showError({message:S.folderDlg.invalid.provideName}):-1<E.indexOf("\x3c")||-1<E.indexOf("\x3e")?this._showError({message:S.folderDlg.invalid.invalidCharacters}):this.portalUser&&this.portalUser.username&&this.portalUser.username.toLowerCase()===E.toLowerCase()?this._showError({message:a.substitute([E],S.folderDlg.invalid.sameFolderName)}):!0},_setReadOnlyAttr:function(E){l.publish("/esri/disable",E);w.set(this._input,"readOnly",
E)},_showError:function(E){E=b.mixin(b.mixin({},S.publishWizard.errors.error),E);this._errorDlg=new B({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(E).then(b.hitch(this,function(){this.set("readOnly",!1);this._errorDlg.hide()}));return!1}})})},"arcgisonline/sharing/dijit/dialog/CreateGeolocatorDlg":function(){define("dojo/_base/declare dojo/on dojo/dom-attr dojo/query dojo/dom-style dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/dom-construct dojo/when dojo/Deferred dojo/promise/all dojo/dom-class ./ConfirmDialog dijit/focus dojo/_base/event dojo/keys ./_CreateItemUtilMixin ./ItemPropertiesDlg dojo/topic esri/Evented esri/arcgis/Portal ../../geow/Account ../../util dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/CreateGeolocatorDlg.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S){return e("arcgisonline.sharing.dijit.dialog.CreateGeolocatorDlg",[n,b,c,A],{baseClass:"esriCreateGeolocatorDlg",showFolders:!0,_typeInfo:"geocodeserver",userFolders:"",templateString:S,onDone:function(){},postMixInProperties:function(){this.inherited(arguments);this.i18n=m.mixin({},R);this._portalUser=(this._portal=esriGeowConfig.portal)&&this._portal.getPortalUser()},postCreate:function(){this.inherited(arguments);J.getSelf(m.hitch(this,
function(T){this._portal?this._init():(this._portal=new B.Portal({url:esriGeowConfig.restBaseUrl,self:T}),this._portal.on("load",m.hitch(this,function(){this._connect&&this._connect.remove();this._portalUser=this._portal.getPortalUser();this._init()})))}))},_init:function(){this._restBaseUrl=esriGeowConfig.allSSL?this._portal.portalUrl.replace("http:/","https:/"):this._portal.portalUrl;this._contentUrl=this._restBaseUrl+"content";this._publishUrl=this._contentUrl+"/users/"+this._portalUser.username;
this._itemPropertiesDlg.on("load",m.hitch(this,function(){this._loadData().then(m.hitch(this,function(T){this._itemPropertiesDlg.set("focus","title")}))}))},destroy:function(){a(".dijit",this.contentNode).map(dijit.byNode).forEach(function(E){E.destroyRecursive?E.destroyRecursive():E.destroy&&E.destroy();E=null});this._errorDlg&&(this._errorDlg.destroyRecursive(),this._errorDlg=null);this.inherited(arguments);this._tagsDijit=this._portalUser=this._portal=null;var T=document.getElementById("create-dropdown");
T&&T.focus()},_loadGeocodes:function(){this.own(z.subscribe("dlg/onOk",m.hitch(this,function(){this._focusNode&&setTimeout(m.hitch(this,function(){t.focus(this._focusNode)}),250)})),z.subscribe("/esri/disable",m.hitch(this,function(T,E){this.set("disabled",T,E,!0)})))},_loadData:function(){var T=new h;T.resolve({success:!0});return T},_setMessageAttr:{node:"_message",type:"innerHTML"},_getBusyMessageAttr:function(){return""},_setItemAttr:function(T){if(!this.fsItem||this.fsItem&&T.url!==this.fsItem.url)this.fsItem=
m.mixin({},T),this._created&&this._loadData().then(m.hitch(this,function(E){this._itemPropertiesDlg.set("focus","title")}))},_setFocusAttr:function(T){T=a(T,this.domNode);t.focus(T&&T.length?T[0]:this._title.domNode)},_setDisabledAttr:function(T,E,I){this.set("readOnly",T,E,I)},_setReadOnlyAttr:function(T,E,I){a(".dijit",this.domNode).map(dijit.byNode).forEach(function(F){F.set("disabled",T)});a("a",this.domNode)[T?"addClass":"removeClass"]("disabledLink");a("label",this.domNode)[T?"addClass":"removeClass"]("disabled");
this._itemPropertiesDlg.set("disabled",T);I||(T&&E&&z.publish("/dlg/busyMessage",E),z.publish("/esri/disable",T,E))},_validate:function(){var T=new h;this._focusNode=null;_dfd=this._itemPropertiesDlg._validate();_dfd=_dfd.then(m.hitch(this,function(E){T.resolve(E)}),m.hitch(this,function(E){this._showError(E);T.reject(E)}));return T},_checkRequired:function(){var T=new h;v.serviceNameAvailable(this._itemPropertiesDlg.get("item"),this._portal).then(m.hitch(this,function(E){E&&E.available?T.resolve(!0):
(this._focusNode=a("input",this._itemPropertiesDlg._title.domNode)[0],T.reject(R.addItemFrm.errors.serviceNameExists))}));return T},_addNewItem:function(){return this._getWorldGeocoderUrl().then(function(T){var E=this._itemPropertiesDlg.get("item");E.createAsServiceProxy=!0;E.url=T;E.typeKeywords="Geocoding filter";return v.addItem(E,E.folderId,this._portal)}.bind(this))},_getWorldGeocoderUrl:function(){function T(F){E.resolve(F)}var E=new h;if(this._portal.isPortal)this._getWorldGeocoderUrlFromProxies(this._portal.helperServices.geocode).then(T);
else{var I=this._getDevEnviroment();T("https://geocode"+(I||"")+".arcgis.com/arcgis/rest/services/World/GeocodeServer")}return E},_getDevEnviroment:function(){var T=esriGeowConfig.portalHostname;return-1!==T.indexOf("dev")?"dev":-1!==T.indexOf("qa")?"qa":null},showModal:function(T){var E=new h,I,F=this.dialog=new q({title:T.title,style:{height:"auto"}});this.set("message",T.message);F.setContent(this.domNode);F.show();this.own(K(F.okButton,"click",m.hitch(this,function(){z.publish("/esri/disable",
!0,this.get("busyMessage"));this._validate().then(m.hitch(this,function(){I=this._addNewItem();I.then(m.hitch(this,function(D){this.telemetry&&this.telemetry.logEvent({label:"create apps",category:"new item",pageName:"my content",details:"locator"});D.id&&setTimeout(function(){window.location.href=esriGeowConfig.baseUrl+"item.html?id\x3d"+D.id+"\x26newLocator\x3dtrue#settings"},400);E.resolve(D)}))}))})),K(F,"hide",m.hitch(this,function(){F.destroyRecursive()})));return E},_showError:function(T){T=
m.mixin(m.mixin({},R.publishWizard.errors.error),T);var E=m.hitch(this,function(){this.set("disabled",!1);this._errorDlg.hide();this._focusNode&&setTimeout(m.hitch(this,function(){t.focus(this._focusNode)}),250)});this._errorDlg=new q({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.own(K(this._errorDlg.closeButtonNode,"click",E));this._errorDlg.show(T).then(E);return!1},_getWorldGeocoderUrlFromProxies:function(T){var E=new h;(T=T.filter(function(I){return P.isServiceProxyGeocoder(I.url)}).filter(function(I){return I.isEsriBatchGeocoder})[0])?
this._fetchItem(this._parseGeocoderItemId(T)).then(function(I){E.resolve(I.url)},function(I){E.reject(I)}):E.reject();return E},_fetchItem:function(T){return P.request({url:this._portal.portalUrl+"content/items/"+T})},_parseGeocoderItemId:function(T){return T.url.split("/servers/")[1].split("/rest/services/")[0]}})})},"arcgisonline/sharing/dijit/dialog/ConnectDataset":function(){define("require esri/declare esri/Evented esri/kernel esri/lang esri/request esri/arcgis/Portal dojo/_base/lang dojo/_base/window dojo/_base/array dojo/topic dojo/string dojo/query dojo/on dojo/json dojo/_base/event dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/promise/all dojo/Deferred dojo/when ./ConfirmDialog ./_CreateItemUtilMixin dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog arcgisonline/sharing/dijit/dialog/ItemPropertiesDlg arcgisonline/sharing/dijit/AnalyzeResults arcgisonline/pages/portal/cloudProvider/GoogleConnect arcgisonline/pages/portal/cloudProvider/DropBoxConnect arcgisonline/pages/portal/cloudProvider/BoxConnect arcgisonline/pages/portal/cloudProvider/OneDriveConnect arcgisonline/sharing/util dojo/i18n!../../../nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/ConnectDataset.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U){return K([R,S,T,p],{baseClass:"connectDataset",templateString:U,postMixInProperties:function(){this.inherited(arguments);b.mixin(this,{isBatch:this.items&&1<this.items.length});this.i18n=b.mixin({},O)},destroy:function(){this.inherited(arguments);var M=document.getElementById("add-dropdown");M&&M.focus()},startup:function(M,Q){this.inherited(arguments);this.portal=M;this.folder=Q;this.publishInfo=this.analyzeResults=
this.itemPropertiesDlg=this.publishItem=this.addItem=null;this.currentCloudProvider=this.mimeTypeForFile="";this.cloudConnect={googleConnect:null,dropBoxConnect:null,oneDriveConnect:null,boxConnect:null};this.addToItemResource=null;this.docUrl=esriGeowConfig.self?esriGeowConfig.self.helpBase+esriGeowConfig.self.helpMap.m["120001295"]:"";this.originalDialogTitle=this.i18n.connectDataset.connectToOtherSystems+"\x3ca href\x3d"+this.docUrl+' target\x3d"_blank" title\x3d"'+this.i18n.connectDataset.helpIconOriginalDialogTitle+
'"\x3e\x3ci class\x3d"icon-ui-question margin-left-half font-size--1"\x3e\x3c/i\x3e\x3c/a\x3e';return this._initUI()},showModal:function(M){M=new A;this.dlg=new E({title:this.originalDialogTitle,className:"connectDatasetDlg",style:{width:"750px",height:"auto"}});this.dlg.setContent(this.domNode);this.dlg.show();this.own(r(this.dlg,"cancel",b.hitch(this,function(){this.set("readOnly",!0);this.onCancel()})),l.subscribe("analyzeResults/analyzeError",b.hitch(this,function(Q){this._showError(Q,!1,!0)})));
return M},onCancel:function(){this.dlg&&(this._deleteItem(),this.dlg.destroyRecursive())},_initUI:function(){var M=new A;this._initHandlers();return M},_initHandlers:function(){this.own(f(".googleConnect",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);this.currentCloudProvider="googleConnect";this._telemetryAttribute="google drive";this.cloudConnect[this.currentCloudProvider]=new D;this._oAuthAndDisplayFiles("Google Drive")})),f(".dropBoxConnect",this.domNode).on("click",b.hitch(this,
function(M){t.stop(M);this.currentCloudProvider="dropBoxConnect";this._telemetryAttribute="dropbox";this.cloudConnect[this.currentCloudProvider]=new C;this._oAuthAndDisplayFiles("Dropbox")})),f(".oneDriveConnect",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);this.currentCloudProvider="oneDriveConnect";this._telemetryAttribute="onedrive";this.cloudConnect[this.currentCloudProvider]=new G;this._oAuthAndDisplayFiles("OneDrive")})),f(".boxConnect",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);
this.currentCloudProvider="boxConnect";this._telemetryAttribute="box";this.cloudConnect[this.currentCloudProvider]=new y;this._oAuthAndDisplayFiles("Box")})),f(".page2BackButton",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);this._showHideDiv(".page2",!1);f(".searchCloudDrive",this.domNode).attr("value","");this.dlg.set("title",this.originalDialogTitle);this._showHideDiv(".page1",!0)})),f(".page3BackButton",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);this._deleteItem();
this.itemPropertiesDlg&&this.itemPropertiesDlg.destroyRecursive(!0);this.analyzeResults&&(this.analyzeResults.destroyRecursive(!0),this._showHideDiv(".analyze-results",!1));this._showHideDiv(".page3",!1);this._showHideDiv(".page2",!0)})),f(".searchCloudDrive",this.domNode).on("keyup, search",b.hitch(this,function(M){t.stop(M);M=u.get(M.target,"value");var Q=f(".dropdownCloud",this.domNode).shift().value;this._loaderForPage2(!0,this.i18n.connectDataset.searchingFiles);var Y={searchText:M,dropdownFilter:Q};
this._delay(b.hitch(this,function(){this._browseCloudDrive(Y)}),1E3)})),f(".dropdownCloud",this.domNode).on("change",b.hitch(this,function(M){t.stop(M);this._loaderForPage2(!0,this.i18n.connectDataset.searchingFiles);var Q={searchText:f(".searchCloudDrive",this.domNode).shift().value,dropdownFilter:M.currentTarget.value};this._delay(b.hitch(this,function(){this._browseCloudDrive(Q)}),10)})),f(".previousButton",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);this._loaderForPage2(!0,this.i18n.connectDataset.searchingFiles);
M=f(".searchCloudDrive",this.domNode).shift().value;var Q=f(".dropdownCloud",this.domNode).shift().value,Y={searchText:M,dropdownFilter:Q,previousOrNext:"previous"};this._delay(b.hitch(this,function(){this._browseCloudDrive(Y)}),10)})),f(".nextButton",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);this._loaderForPage2(!0,this.i18n.connectDataset.searchingFiles);M=f(".searchCloudDrive",this.domNode).shift().value;var Q=f(".dropdownCloud",this.domNode).shift().value,Y={searchText:M,dropdownFilter:Q,
previousOrNext:"next"};this._delay(b.hitch(this,function(){this._browseCloudDrive(Y)}),10)})),f(".listExternalItemsTable",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);var Q=u.get(M.target,"externalItemId"),Y=u.get(M.target,"itemName");u.get(M.target,"contructUrl");var fa=u.get(M.target,"downloadUrl");f(".listExternalItems [externalItemId\x3d'"+Q+"']").shift();this.mimeTypeForFile=u.get(M.target,"mimeType");if(Q){this._loaderHelper(!0,this.i18n.connectDataset.addingItem);var va=-1===
Y.lastIndexOf(".")?Y:Y.substring(0,Y.lastIndexOf("."));this.addToItemResource={cloudProvider:this.currentCloudProvider,id:Q,mimeType:this.mimeTypeForFile,cloudDriveFileName:va};this._addExternalItem(fa,Y,this.mimeTypeForFile).then(b.hitch(this,function(Aa){this._loaderHelper(!0,this.i18n.connectDataset.analyzing);this.publishInfo={itemId:this.addItem.id,filetype:this._getNameForMimeType(this.mimeTypeForFile,"publish")};this._showHideDiv(".page2",!1);this._loaderHelper(!1,null);this._showHideDiv(".page3",
!0);this.itemPropertiesDlg=new I({title:va,showFile:!1},w.byId("itemPropertiesDlgAddon"));this.itemPropertiesDlg.startup();if(-1!==this.mimeTypeForFile.indexOf("csv")||-1!==this.mimeTypeForFile.indexOf("excel")||-1!==this.mimeTypeForFile.indexOf("googlesheets"))this.analyzeResults=new F({item:Aa,portal:this.portal},w.byId("analyzeResultsAddon")),this.analyzeResults.startup()}),b.hitch(this,function(Aa){-1!==this.mimeTypeForFile.indexOf("shapeFile")?this._showError(O.connectDataset.errors.invalidShapefile,
!0):-1!==this.mimeTypeForFile.indexOf("fgdb")?this._showError(O.connectDataset.errors.invalidFileGeodatabase,!0):this._showError(O.connectDataset.errors.addItemCheckStatusIssue,!0)}))}})),f(".publishButton",this.domNode).on("click",b.hitch(this,function(M){t.stop(M);this._loaderHelper(!0,this.i18n.connectDataset.publishing);var Q=this.itemPropertiesDlg.get("item");Q.title?Q.tags?1==/[.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(Q.title)||120<Q.title.length?this._showError(O.addItemFrm.errors.invalidServiceTitle,
!0):(-1!==this.mimeTypeForFile.indexOf("csv")||-1!==this.mimeTypeForFile.indexOf("excel")||-1!==this.mimeTypeForFile.indexOf("googlesheets")?this.publishInfo.publishParameters=this.analyzeResults.getPublishParameters():this.publishInfo.publishParameters={name:Q.title,hasStaticData:!0,maxRecordCount:2E3,layerInfo:{capabilities:"Query"}},"noLocationFields"==this.publishInfo.publishParameters?this._showError(O.addItemFrm.errors.noAddressFields,!0):(this.telemetry&&this._telemetryAttribute&&this.telemetry.logEvent({label:"add",
category:"new item",pageName:"my content",details:"from cloud drive",attribute:this._telemetryAttribute}),this._updateExternalItem(Q).then(b.hitch(this,function(){this.publishInfo.item=this.addItem;this.publishInfo.publishParameters.name=Q.title.split(" ").join("_");this.publishInfo.deleteSourceItemUponCompletion=!0;this._checkserviceNameAvailable().then(b.hitch(this,function(){this._publishExternalItem().then(b.hitch(this,function(Y){this._addResourceToItem(Y).then(b.hitch(this,function(){this._updateTypeKeyword(Y,
Q.categories).then(b.hitch(this,function(){window.location="item.html?id\x3d"+Y[0].serviceItemId+"\x26jobid\x3d"+Y[0].jobId}))}))}))}))})))):this._showError(O.connectDataset.errors.required.tags,!0):this._showError(O.connectDataset.errors.required.title,!0)})))},_delay:function(){var M=0;return function(Q,Y){clearTimeout(M);M=setTimeout(Q,Y)}}(),_browseCloudDrive:function(M){this.cloudConnect[this.currentCloudProvider].GetAllFiles(M).then(b.hitch(this,function(Q){this._setupListExternalList(Q).then(b.hitch(this,
function(){this._loaderForPage2(!1,null)}))}),b.hitch(this,function(Q){this._showError(Q)}))},_getNameForMimeType:function(M,Q){var Y="";return Y=-1!==Q.indexOf("addItem")?-1!==M.indexOf("csv")?"CSV":-1!==M.indexOf("excel")?"Microsoft Excel":-1!==M.indexOf("shapeFile")?"Shapefile":-1!==M.indexOf("fgdb")?"File Geodatabase":-1!==M.indexOf("geojson")?"GeoJson":-1!==M.indexOf("sheets")?"Microsoft Excel":"CSV":-1!==M.indexOf("csv")?"csv":-1!==M.indexOf("excel")?"excel":-1!==M.indexOf("shapeFile")?"shapefile":
-1!==M.indexOf("fgdb")?"fileGeodatabase":-1!==M.indexOf("geojson")?"geojson":-1!==M.indexOf("sheets")?"excel":"csv"},_oAuthAndDisplayFiles:function(M){this._loaderHelper(!0,this.i18n.connectDataset.defaultLoading);f(".dropdownCloud",this.domNode).shift().options.length=0;var Q=f(".dropdownCloud",this.domNode).shift(),Y={dropdownFilter:"csv"};Q.options[Q.options.length]=new Option(this.i18n.connectDataset.csvDropdown,"csv");Q.options[Q.options.length]=new Option(this.i18n.connectDataset.excelDropdown,
"excel");Q.options[Q.options.length]=new Option(this.i18n.connectDataset.fgdbDropdown,"fgdb");Q.options[Q.options.length]=new Option(this.i18n.connectDataset.geoJsonDropdown,"geoJson");"googleConnect"===this.currentCloudProvider&&(Q.options[Q.options.length]=new Option(this.i18n.connectDataset.googleSheetDropdown,"sheets"));Q.options[Q.options.length]=new Option(this.i18n.connectDataset.shapeFileDropdown,"shapeFile");this.cloudConnect[this.currentCloudProvider].GetTokenViaOauth("https://"+this.portal.portalHostname).then(b.hitch(this,
function(){this._loaderHelper(!0,this.i18n.connectDataset.loadingFiles);this.cloudConnect[this.currentCloudProvider].GetAllFiles(Y).then(b.hitch(this,function(fa){this._setupListExternalList(fa).then(b.hitch(this,function(){this._showHideDiv(".page1",!1);this._loaderHelper(!1,null);this.dlg.set("title",this.i18n.connectDataset.addItemFrom+M);this._showHideDiv(".page2",!0);this.dlg.resize()}))}),b.hitch(this,function(fa){this._showError(fa)}))}),b.hitch(this,function(fa){"popupBlocked"===fa?this._showError({title:O.overwriteFromCloudDlg.errors.popupIssue.title,
message:O.connectDataset.errors.popupIssue.message}):"InvalidToken"===fa||"windowClosed"===fa?this._loaderHelper(!1,null):this._showError(fa)}))},_setupListExternalList:function(M){var Q=new A;M.previous&&1==M.previous?f(".previousButton",this.domNode).removeAttr("disabled"):f(".previousButton",this.domNode).attr("disabled","true");M.next&&1==M.next?f(".nextButton",this.domNode).removeAttr("disabled"):f(".nextButton",this.domNode).attr("disabled","true");for(var Y=f(".listExternalItemsTable",this.domNode).shift();1<
Y.rows.length;)Y.deleteRow(1);M.files.reduce(b.hitch(this,function(fa,va){fa="";-1!==va.mimeType.indexOf("googlesheets")?fa=this.i18n.connectDataset.tableContentSheets:-1!==va.mimeType.indexOf("csv")?fa=this.i18n.connectDataset.tableContentCsv:-1!==va.mimeType.indexOf("shapeFile")?fa=this.i18n.connectDataset.tableContentZip:-1!==va.mimeType.indexOf("fgdb")?fa=this.i18n.connectDataset.tableContentZip:-1!==va.mimeType.indexOf("geojson")?fa=this.i18n.connectDataset.tableContenGeoJSON:(va.mimeType.indexOf("excel"),
fa=this.i18n.connectDataset.tableContentExcel);var Aa=Y.insertRow(Y.rows.length),pa=Aa.insertCell(0);Aa=Aa.insertCell(1);var N=va.name.split(" ").join("\x26#32;");pa.innerHTML="\x3ci class\x3d'icon-ui-documentation'\x3e\x3c/i\x3e\x3cbutton class\x3d'btn btn-transparent btn-arrow cloudTableList' externalItemId\x3d"+va.id+" itemName\x3d"+N+" downloadUrl\x3d"+va.downloadUrl+" mimeType\x3d"+va.mimeType+"\x3e"+va.name+"\x3c/button\x3e";Aa.innerHTML=fa}),"");Q.resolve();return Q},_addExternalItem:function(M,
Q,Y){var fa=new A;M={dataUrl:M,async:!0,type:this._getNameForMimeType(Y,"addItemType"),typeKeywords:this._getNameForMimeType(Y,"addItemKeywords"),Title:Q,filename:Q};var va=this.portal;P.addItem(M,this.folder.folderId,va).then(b.hitch(this,function(Aa){this.addItem=Aa;P.checkStatus(this.addItem,fa,null,va,function(pa){fa.resolve(pa)})}),b.hitch(this,function(Aa){if("CONT_0027"==Aa.messageCode){var pa=O.connectDataset.errors.itemExistsFile;pa.message=g.substitute({type:this._getNameForMimeType(Y,"addItemType"),
title:Q,name:Q},pa.message);this._showError(pa)}else this._showError(Aa);fa.reject(Aa)}));return fa},_updateExternalItem:function(M){var Q=new A;if(this.addItem.Title===M.title&&this.addItem.Tags===M.tags&&this.addItem.Snippet===M.snippet)Q.resolve();else{var Y={Title:M.title,Tags:M.tags,Snippet:M.snippet,folderId:this.addItem.folderId,folder:this.addItem.folder,id:this.addItem.id};Y.thumbnailURL=L.getStaticImagesUrl()+"/desktopapp.png";this.addItem.Title=M.title;P.updateItem(Y,this.portal).then(b.hitch(this,
function(fa){Q.resolve(fa)}),b.hitch(this,function(fa){this._showError(fa);Q.reject(fa)}))}return Q},_publishExternalItem:function(){var M=new A;P.publishItem(this.publishInfo.item,this.publishInfo,this.portal).then(b.hitch(this,function(Q){this.publishItem=Q.publishResult;M.resolve(Q.publishResult)}),b.hitch(this,function(Q){this._showError(Q);M.reject(Q)}));return M},_checkserviceNameAvailable:function(){var M=new A;P.serviceNameAvailable({title:this.publishInfo.item.Title},this.portal).then(b.hitch(this,
function(Q){Q.available?M.resolve():this._showError(O.connectDataset.errors.serviceNameExists,!0)}));return M},_addResourceToItem:function(M){var Q=new A,Y=this.portal;M={folderId:this.folder.folderId,id:M[0].serviceItemId};var fa={fileName:"cloudProvider.json",text:JSON.stringify(this.addToItemResource),access:"private"};P.addItemResource(M,Y,fa).then(b.hitch(this,function(){Q.resolve()}),b.hitch(this,function(va){this._showError(va);Q.reject(va)}));return Q},_updateTypeKeyword:function(M,Q){var Y=
new A,fa=this.portal,va=this.folder.folderId,Aa="Cloud Drive",pa=JSON.parse(this.publishInfo.publishParameters);if("address"===pa.locationType||pa.layers&&"address"===pa.layers[0].locationType)Aa+=",showUnmatchedAddresses,Involved Lookup";else if("none"===pa.locationType||pa.layers&&"none"===pa.layers[0].locationType)Aa+=",Table";P.updateItem({folderId:va,id:M[0].serviceItemId,typeKeywords:Aa,categories:Q},fa).then(b.hitch(this,function(){Y.resolve()}),b.hitch(this,function(N){this._showError(N);
Y.reject(N)}));return Y},_deleteItem:function(){null!=this.addItem&&P.deleteItem(this.addItem,this.portal);null!=this.publishItem&&P.deleteItem(this.publishItem,this.portal)},_showError:function(M,Q,Y){M=b.mixin(b.mixin({},O.connectDataset.errors.error),M);this._errorDlg=new J({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(M).then(b.hitch(this,function(){this.set("readOnly",!1);Y&&(this.itemPropertiesDlg&&this.itemPropertiesDlg.destroyRecursive(!0),this.analyzeResults&&this.analyzeResults.destroyRecursive(!0),
this._showHideDiv(".page3",!1),this._showHideDiv(".page2",!0));this._errorDlg.hide()}));Q||this._deleteItem();this._loaderHelper(!1,null);this._loaderForPage2(!1,null);return!1},_loaderHelper:function(M,Q){Q=Q?Q:"Loading...";!0===M?(this._showHideDiv(".loader",!0),f(".loader-text",this.domNode).attr("innerHTML",Q),f(".changeOpacity",this.domNode).style("opacity",.5),f(".divClickable",this.domNode).style("pointer-events","none")):(f(".loader-text",this.domNode).attr("innerHTML",Q),this._showHideDiv(".loader",
!1),f(".changeOpacity",this.domNode).style("opacity",1),f(".divClickable",this.domNode).style("pointer-events","auto"))},_loaderForPage2:function(M,Q){Q=Q?Q:"Loading...";!0===M?(this._showHideDiv(".loader",!0),f(".loader-text",this.domNode).attr("innerHTML",Q),f(".listExternalItemsTable",this.domNode).style("opacity",.5),f(".listExternalItemsTable",this.domNode).style("pointer-events","none")):(f(".loader-text",this.domNode).attr("innerHTML",Q),this._showHideDiv(".loader",!1),f(".listExternalItemsTable",
this.domNode).style("opacity",1),f(".listExternalItemsTable",this.domNode).style("pointer-events","auto"))},_showHideDiv:function(M,Q){!0===Q?f(M).removeClass("hide"):f(M).addClass("hide")}})})},"arcgisonline/sharing/dijit/AnalyzeResults":function(){define("require exports tslib ../../esriGeowConfig dijit/_TemplatedMixin dijit/_WidgetBase dojo/topic dojo/query dojo/string dojo/Deferred dojo/promise/all ../../sharing/util ./AnalyzeResults/FieldsTableRow ../../sharing/dijit/dialog/_CreateItemUtilMixin ../../sharing/dijit/_TimezoneUtils ../../pages/utils/clone ../../pages/utils/dom arcgisonline/tsutils/declareDecorator dojo/text!../../pages/dijit/View/templates/loader.html dojo/text!./AnalyzeResults/templates/_analyze-results.html dojo/text!./AnalyzeResults/templates/_table-head.html dojo/text!./AnalyzeResults/templates/_table-row.html dojo/text!./AnalyzeResults/templates/_table-head-no-location.html dojo/text!./AnalyzeResults/templates/_table-row-no-location.html dojo/text!./AnalyzeResults/templates/_table-head-no-type.html dojo/text!./AnalyzeResults/templates/_table-row-no-type.html dojo/text!./AnalyzeResults/templates/_table-head-no-location-no-type.html dojo/text!./AnalyzeResults/templates/_table-row-no-location-no-type.html dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);return function(){function I(){this.templateString=x.default;this.i18n=E.default;this._dijits=[];this._sortOptions=[{property:"field",active:!0,ascending:!0},{property:"type",ascending:!0},{property:"location",ascending:!0}]}I.prototype.postMixInProperties=function(){var F;this.inherited(arguments);this.portal=this.portal||(null===(F=this.item)||
void 0===F?void 0:F.portal)||(null===a.default||void 0===a.default?void 0:a.default.self)||{};this.user=this.user||this.portalUser||this.portal.portalUser||{};this.timeZoneUtil=(0,t.default)(q.default.TimezoneUtils)};I.prototype.postCreate=function(){this.inherited(arguments);this.domNode.querySelector(".js-analyze-loader-wrap").innerHTML=c.default.substitute(v.default,{location:this.i18n.addItemFrm.analyzeCloud})};I.prototype.startup=function(){this.inherited(arguments);this._render().then(this._addEventListeners.bind(this))};
I.prototype.destroy=function(){this.inherited(arguments);this._dijits.forEach(function(F){F.destroy()});this._dijits=[]};I.prototype.showLoader=function(){w.default.showNode((0,b.default)(".analyze-loader-wrap").shift());w.default.activateNode((0,b.default)(".analyze-loader-wrap .loader").shift());(0,b.default)("main",this.domNode).addClass("is-analyzing");(0,b.default)(".js-view",this.domNode).addClass("hide")};I.prototype.hideLoader=function(){w.default.hideNode((0,b.default)(".analyze-loader-wrap").shift());
w.default.deactivateNode((0,b.default)(".analyze-loader-wrap .loader").shift());(0,b.default)(".js-view",this.domNode).removeClass("hide");(0,b.default)("main",this.domNode).removeClass("is-analyzing")};I.prototype.getPublishParameters=function(){var F=this._getFields();this._setLocationParameters(F);if("address"===this.publishParameters.locationType){if(this._isEmptyObject(this.publishParameters.addressFields))return"noLocationFields"}else if("coordinates"===this.publishParameters.locationType&&
!(this.publishParameters.latitudeFieldName&&this.publishParameters.longitudeFieldName||this.publishParameters.coordinateFieldType&&this.publishParameters.coordinateFieldName))return"noLocationFields";var D=this.publishParameters;this.isExcel?(D=p.__assign(p.__assign({},this.analyzeResult.publishParameters||{}),{layers:[this.publishParameters]}),D.hasStaticData=!0,D.maxRecordCount=2E3,D.capabilities="Query",D.layerInfo={capabilities:"Query"}):this.layerInfo.fields=F;return p.__assign(p.__assign({},
D),this._getTimezone())};I.prototype._setLocationParameters=function(F){if("address"===this.publishParameters.locationType){this.publishParameters.addressFields={};for(var D=0;D<F.length;D++)"unknown"!==F[D].locationType&&(this.publishParameters.addressFields[F[D].locationType]=F[D].name)}else if("coordinates"===this.publishParameters.locationType)for(this.publishParameters.latitudeFieldName=null,this.publishParameters.longitudeFieldName=null,this.publishParameters.coordinateFieldType=null,this.publishParameters.coordinateFieldName=
null,D=0;D<F.length;D++)"latitude"===F[D].locationType?this.publishParameters.latitudeFieldName=F[D].name:"longitude"===F[D].locationType?this.publishParameters.longitudeFieldName=F[D].name:"mgrs"===F[D].locationType?(this.publishParameters.coordinateFieldType="MGRS",this.publishParameters.coordinateFieldName=F[D].name):"usng"===F[D].locationType&&(this.publishParameters.coordinateFieldType="USNG",this.publishParameters.coordinateFieldName=F[D].name)};I.prototype._isEmptyObject=function(F){var D=
0,C;for(C in F)F.hasOwnProperty(C)&&D++;return 0===D};I.prototype._setItemAttr=function(F){this.item=F;this.fileType="microsoft excel"===this.item.type.toLowerCase()?"excel":this.item.type.toLowerCase();this.isExcel="excel"===this.fileType;this.item=p.__assign(p.__assign({},this.item),{fileType:this.fileType})};I.prototype._getTimezone=function(){var F=this.timeZoneUtil._winZones[this._timeZones.value];return F&&"UTC"!==F.id?{dateFieldsTimeReference:{timeZone:F.id}}:{}};I.prototype._getAnalyzeParameters=
function(){var F=this._geocoders.value,D=this.user.region||this.portal.ipCntryCode||"",C=this._countries.value,y=(0,b.default)('input[name\x3d"geocode"]:checked').shift();D=D&&"wo"===D.toLowerCase()?"world":D;return{geocodeServiceUrl:F,locationType:(null===y||void 0===y?void 0:y.value)||null,sourceCountry:C,sourceCountryHint:this.analyzeResult?"":D}};I.prototype._getDefaultPublishParameters=function(){var F=this.analyzeResult||{};F=this.isExcel?this._getExcelPublishParameters(F):F.publishParameters;
var D=null;this.isExcel||(this.layerInfo=p.__assign(p.__assign({},this._getLayerInfo(F)),{capabilities:"Query"}),D={capabilities:"Query",hasStaticData:!0,maxRecordCount:2E3,layerInfo:this.layerInfo,addressFields:F.addressFields||{},locationType:"unknown"!==F.locationType?F.locationType:"none",persistErrorRecordsForReview:!0});return p.__assign(p.__assign({},F),{defaults:D})};I.prototype._getLayerInfo=function(F){return(this.isExcel?F:F.layerInfo)||{}};I.prototype._getExcelPublishParameters=function(F){F=
F.publishParameters||{};var D=parseInt(this._allExcelSheets.value,10)||0;D=(F=F.layers&&F.layers[D])&&F.fields||[];this.locateFeaturesUsing&&(F.locationType=this.locateFeaturesUsing);"coordinates"===F.locationType?this._getExcelLayerFieldCoordinateLocationTypes(D,F):"address"===F.locationType&&this._getExcelLayerFieldAddressLocationTypes(D,F);return F||{}};I.prototype._getExcelLayerFieldAddressLocationTypes=function(F,D){var C=D.addressFields;F.forEach(function(y){y.locationType="unknown";for(var G in C)if(y.name===
C[G]){y.locationType=G;break}});return F};I.prototype._getExcelLayerFieldCoordinateLocationTypes=function(F,D){var C=D.latitudeFieldName,y=D.longitudeFieldName,G="unknown";F.forEach(function(L){G="unknown";L.name===C?G="latitude":L.name===y&&(G="longitude");L.locationType=G});return F};I.prototype._getFields=function(){return this._dijits.map(function(F){return F.field})};I.prototype._render=function(){var F=this,D=new d.default,C=this.user;(0,l.default)([this._fetchTimeZones(),this._fetchCountries(),
this._fetchGeocoders(),this._analyze()]).then(function(){F._allowedToGeocode=C.canUseGeocode&&F._supportsBatch&&(!F.portal.isPortal||F.portal.isPortal&&(!F._isAgoWorldGeocodeServer||F._isServiceProxyAgoWorldGeocodeServer));D.resolve(!0)});return D};I.prototype._addEventListeners=function(){var F=new d.default;this.own((0,b.default)(".js-run-analyze",this.domNode).on("change",this._analyze.bind(this)),(0,b.default)(".locate-features-using",this.domNode).on("change",this._updateExcelSheet.bind(this)),
(0,b.default)(".js-excel-sheet",this.domNode).on("change",this._updateExcelSheet.bind(this)));F.resolve();return F};I.prototype._updateView=function(F){var D,C,y;F=new d.default;var G=this.publishParameters.locationType,L=this.isExcel&&1<(null===(y=null===(C=null===(D=this.analyzeResult)||void 0===D?void 0:D.publishParameters)||void 0===C?void 0:C.layers)||void 0===y?void 0:y.length);this.standardizedFieldNames=p.__assign({},this.publishParameters.standardizedFieldNames?p.__assign(p.__assign({},this.publishParameters.standardizedFieldNames),
this.i18n.addItemFrm.notUsed):E.default.addItemFrm.locationTypes);this.locationFieldNames="coordinates"===this.publishParameters.locationType?E.default.addItemFrm.locationTypes:this.standardizedFieldNames;D=L?"removeClass":"addClass";(0,b.default)(".if-excel")[D]("hide");this._reviewLabel.innerHTML=L?"":"none"===G?E.default.addItemFrm.reviewTable:E.default.addItemFrm.review;this["radio-".concat(G)].checked=!0;(0,b.default)(".if-location")["address"===G?"removeClass":"addClass"]("hide");this._reviewLabel.innerHTML=
"none"===G?this.isExcel?E.default.addItemFrm.reviewTableExcel:E.default.addItemFrm.reviewTable:this.isExcel?E.default.addItemFrm.reviewExcel:E.default.addItemFrm.review;D="none"===G?this.isExcel?S.default:B.default:this.isExcel?P.default:z.default;(0,b.default)(".js-table-header",this.domNode).shift().innerHTML=c.default.substitute(D,{i18n:E.default});this._sortUpdate({property:"field",ascending:!0});F.resolve();return F};I.prototype._analyze=function(){var F=this,D=new d.default,C=this.item,y=this._getAnalyzeParameters();
"none"!==(null===y||void 0===y?void 0:y.locationType)?(this.showLoader(),r.default.analyzeItem(C,y,this.portal).then(function(G){F.analyzeResult=(0,t.default)(G);F.publishParameters=F._getDefaultPublishParameters();F.isExcel&&0===F._allExcelSheets.length&&F._createExcelSheetOptions(G);F._updateView().then(function(){F.hideLoader();D.resolve()})},function(G){n.default.publish("analyzeResults/analyzeError",{error:G});F.hideLoader();D.reject(G)})):(this.publishParameters.locationType="none",this._updateView(this.analyzeResult).then(function(){D.resolve(F.analyzeResult)}));
return D};I.prototype._createExcelSheetOptions=function(F){var D=this,C,y=new d.default;((null===(C=null===F||void 0===F?void 0:F.publishParameters)||void 0===C?void 0:C.layers)||[]).forEach(function(G){var L="".concat(parseInt(G.excelSheetId,10)),O=document.createElement("option");O.dataset.value=L;O.value=L;O.innerHTML=G.name;D._allExcelSheets.add(O)});y.resolve(!0);return y};I.prototype._updateExcelSheet=function(F){this.isExcel?(this.locateFeaturesUsing=null,-1!==F.currentTarget.className.indexOf("locate-features-using")&&
(this.locateFeaturesUsing=F.target.defaultValue),this.publishParameters=this._getDefaultPublishParameters(),this._updateView()):this._analyze()};I.prototype._sortHeader=function(F){var D=F.target.getAttribute("data-sort"),C=F.target.classList.contains("is-ascending")||F.target.contains("is-descending");F=F.target.getAttribute("data-sort-order");C&&(F="asc"===F?"desc":"asc");this._sortUpdate({property:D,ascending:"asc"===F})};I.prototype._sortUpdate=function(F){var D=this,C=this.publishParameters,
y=C.locationType,G=C.layerInfo||{};G=this.isExcel?C.fields||[]:G.fields||[];var L=(0,b.default)(".js-table-rows",this.domNode).shift(),O={portalUser:this.user,portal:this.portal,locationFieldNames:this.locationFieldNames,locationType:y,template:"none"===y?this.isExcel?T.default:J.default:this.isExcel?R.default:A.default,publishParameters:C};C=F.ascending?"is-ascending":"is-descending";(0,b.default)(".js-table-sort-header").removeClass("is-descending").removeClass("is-ascending").attr("aria-sort",
"none");y=(0,b.default)('.js-table-sort-header[data-sort\x3d"'.concat(F.property,'"]'));0<y.length&&(y.addClass(C),y.attr("aria-sort",F.ascending?"ascending":"descending"),y.attr("data-sort-order",F.ascending?"asc":"desc"));"type"===F.property?this._sortType(G,F):"location"===F.property?this._sortLocation(G,F):this._sortTitle(G,F);this._sortHandler&&this._sortHandler.remove();this._sortHandler=(0,b.default)(".js-table-sort-header",this.domNode).on("click",this._sortHeader.bind(this));this._dijits.forEach(function(U){U.destroy()});
this._dijits=[];G.forEach(function(U){U=new f.default(p.__assign(p.__assign({},O),{field:U}));U.startup();U.placeAt(L);D._dijits.push(U)})};I.prototype._sortTitle=function(F,D){return F.sort(function(C,y){return D.ascending?C.name.localeCompare(y.name):y.name.localeCompare(C.name)})};I.prototype._sortType=function(F,D){var C=this,y,G;return F.sort(function(L,O){y=C._getFieldType(L.type);G=C._getFieldType(O.type);return D.ascending?y.localeCompare(G):G.localeCompare(y)})};I.prototype._sortLocation=
function(F,D){var C=this,y,G;return F.sort(function(L,O){y=C._getLocationType(L.locationType);G=C._getLocationType(O.locationType);return D.ascending?y.localeCompare(G):G.localeCompare(y)})};I.prototype._getLocationType=function(F){return this.locationFieldNames[F]};I.prototype._getFieldType=function(F){return E.default.addItemFrm.fieldTypes[F]};I.prototype._fetchGeocoders=function(){var F=this,D=new d.default,C=this.user;C=h.default.filterBatchGeocoders(((this.portal||C.portal||{}).helperServices||
{}).geocode||[],!C.canUseGeocode);if(null===C||void 0===C?0:C.length){this._geocodeServiceUrl=C[0].url;this._isAgoWorldGeocodeServer=h.default.isEsriWorldGeocoderNoProxy(this._geocodeServiceUrl);this._isServiceProxyAgoWorldGeocodeServer=h.default.isEsriWorldGeocoderThroughProxy(this._geocodeServiceUrl);this._isWorldGeocodeServer=this._isAgoWorldGeocodeServer||this._isServiceProxyAgoWorldGeocodeServer;this._supportsBatch=!0;if(!this._isAgoWorldGeocodeServer&&!this._isServiceProxyAgoWorldGeocodeServer){var y=
void 0;for(y in C)y.url===this._geocodeServiceUrl&&(this._supportsBatch=!!y.batch)}C.forEach(function(G){var L=document.createElement("option");L.value=G.url;L.text=G.name;L.innerHTML=G.name;F._geocoders.add(L)});this._geocoders.selectedIndex=0}else C=(C=h.default.filterNonWorldGeocoders(C))&&C.length?C[0]:null,this._geocodeServiceUrl=(null===C||void 0===C?void 0:C.url)||this._geocodeServiceUrl;D.resolve(!0);return D};I.prototype._fetchCountries=function(){var F=this,D=new d.default,C=this.i18n.countryCodes,
y=this.portal;y=this.user.region||y.ipCntryCode||"wo";var G=[];y="wo"===(null===y||void 0===y?void 0:y.toLowerCase())?"world":y;for(var L in C)G.push({value:L.toLowerCase(),text:C[L],innerHTML:C[L]});G=G.sort(function(O,U){return O.text.localeCompare(U.text)});G.forEach(function(O){var U=document.createElement("option");U.value=O.value;U.text=O.text;U.innerHTML=O.innerHTML;F._countries.add(U)});this._countries.value=C[y]?y.toLowerCase():"world";this._sourceCountry=this._countries.value;D.resolve(!0);
return D};I.prototype._fetchTimeZones=function(){var F=new d.default,D=this.i18n.timeZones,C;for(C in D){var y=document.createElement("option");y.value="".concat("UTC"!==C?parseFloat(C):C);y.text=D[C];y.innerHTML=D[C];this._timeZones.add(y)}this._timeZones.value="".concat(1230);F.resolve(!0);return F};return I=p.__decorate([(0,u.default)(m.default,g.default)],I)}()})},"arcgisonline/sharing/dijit/AnalyzeResults/FieldsTableRow":function(){define("require exports tslib ../../../esriGeowConfig ../../../pages/utils/dom ../../../pages/utils/formatters ../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/promise/all dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/_table-row.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);return function(){function q(t){this.i18n=f.default;this.formatters=m.default}q.prototype.postMixInProperties=function(){this.inherited(arguments);this.portal=this.portal||(null===a.default||void 0===a.default?
void 0:a.default.self)||{};this.portalUser=this.portalUser||this.user||this.portal.portalUser||{};this.templateString=this.template||r.default;this.locationFieldNames=p.__assign({},this.locationFieldNames)};q.prototype.postCreate=function(){this.inherited(arguments);this.cssClasses&&g.default.addClasses(this.domNode,this.cssClasses);this.addEventListeners=this.addEventListeners.bind(this);this.getLocationType=this.getLocationType.bind(this)};q.prototype.startup=function(){this.inherited(arguments);
this.render().then(this.addEventListeners).then(function(){})};q.prototype.render=function(){var t=new l.default;(0,h.default)([this.createFieldTypeOptions(),this.createLocationFieldOptions()]).then(function(){t.resolve(!0)});return t};q.prototype.addEventListeners=function(){var t=this,w=new l.default;this.fieldTypes&&this.own((0,d.default)(this.fieldTypes,"blur",function(u){t.field.type=t.editEnd({evt:u,getValue:t.getFieldType})}),(0,d.default)(this.fieldTypeContainer,"click",function(u){t.editStart({evt:u,
getValue:t.getFieldType})}));"none"!==this.locationType&&this.own((0,d.default)(this.locationFieldContainer,"click",function(u){t.editStart({evt:u,getValue:t.getLocationType})}),(0,d.default)(this.locationFields,"blur",function(u){u=t.editEnd({evt:u,getValue:t.getLocationType});t.field.locationType=u;"coordinates"===t.locationType?"longitude"===u?t.publishParameters.longitudeFieldName=t.field.name:t.publishParameters.latitudeFieldName=t.field.name:t.publishParameters.addressFields[t.field.locationType]=
t.field.name}));w.resolve();return w};q.prototype.editStart=function(t){var w=t.getValue;t=t.evt.target;var u=t.parentElement.querySelector("select"),v=t.dataset.value;"SPAN"===(null===t||void 0===t?void 0:t.tagName)&&(t.classList.add("hide"),u.classList.remove("hide"),u.value=w(v),u.focus())};q.prototype.editEnd=function(t){var w=t.getValue;t=t.evt.target;var u=t.parentElement.querySelector("span"),v=t.options[t.selectedIndex].dataset.value;w=w(v);u.dataset.value=v;u.innerHTML=w;t.classList.add("hide");
u.classList.remove("hide");return v};q.prototype.getLocationType=function(t){return this.locationFieldNames[t]};q.prototype.getFieldType=function(t){return f.default.addItemFrm.fieldTypes[t]};q.prototype.createFieldTypeOptions=function(){var t=this,w=new l.default,u=p.__assign({},f.default.addItemFrm.fieldTypes);this.fieldTypes&&Object.keys(u).forEach(function(v){var x=document.createElement("option");x.dataset.value=v;x.value=u[v];x.innerHTML=u[v];t.fieldTypes.add(x)});w.resolve(!0);return w};q.prototype.createLocationFieldOptions=
function(){var t=this,w=new l.default,u=p.__assign({},this.locationFieldNames);"none"!==this.locationType&&Object.keys(u).forEach(function(v){var x=document.createElement("option");x.dataset.value=v;x.value=u[v];x.innerHTML=u[v];t.locationFields.add(x)});w.resolve(!0);return w};return q=p.__decorate([(0,n.default)(b.default,c.default)],q)}()})},"arcgisonline/sharing/dijit/dialog/AddDatastoreDlg":function(){define("require esri/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/dijit/Tags arcgisonline/esriGeowConfig arcgisonline/sharing/util arcgisonline/pages/pageUtil arcgisonline/pages/dijit/CategoryPicker arcgisonline/sharing/dijit/DatastoreDatabaseSettings arcgisonline/sharing/dijit/DatastoreFolderSettings arcgisonline/sharing/dijit/DatastoreCloudMenu arcgisonline/sharing/dijit/DatastoreNoSQLMenu arcgisonline/sharing/dijit/DatastoreCloudSettings arcgisonline/sharing/dijit/DatastoreNoSQLSettings arcgisonline/sharing/dijit/DatastoreBDFSSettings arcgisonline/sharing/dijit/DatastoreBDFSFileShareSettings arcgisonline/sharing/dijit/DatastoreBDFSHDFSSettings arcgisonline/sharing/dijit/DatastoreBDFSHiveSettings arcgisonline/sharing/dijit/DatastoreBDFSCloudMenu arcgisonline/sharing/dijit/DatastoreBDFSCloudSettings arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin arcgisonline/sharing/dijit/_federated-servers-table arcgisonline/sharing/dijit/dialog/GeneralDlg dijit/Dialog dijit/form/Textarea dijit/form/Select dojo/cookie dojo/json dojo/Deferred dojo/promise/all dojo/DeferredList dojo/_base/array dojo/topic dojo/on dojo/string dojo/query dojo/dom-class dojo/dom-attr dojo/dom-style dojo/NodeList-dom dojo/text!./templates/AddDatastoreDlg.html arcgisonline/pages/utils/dom dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U,M,Q,Y,fa,va,Aa,pa){return K([p,a,g],{templateString:O.substitute(va,{i18n:pa.AddDatastoreDlg}),dialog:null,federatedServers:null,hostingServer:null,currentStep:null,item:null,isEnableDatastoreBDFSSettings:null,isEnableDatastoreNoSQLSettings:null,cloudStorePath:null,cloudStoreId:null,postCreate:function(){this.inherited(arguments)},constructor:function(N){this.currentStep=1;this.i18n=pa;this.formData=new FormData;
this.item={};this.titleRegex=/\s|\+|\?|&|\/|\(|\)|\\|!|#|"|\||\*|:|<|>|%|\$|@|`|~|'|\^|\[|\]|,|=|;/gi;this.isEnableDatastoreNoSQLSettings=this.isEnableDatastoreBDFSSettings=!1},startup:function(){this.inherited(arguments);this._user=b.getUser();this._loadConnections();D({tags:b.loadUserTags(this._user.username),categories:this.portal.getCategories(),folders:this.portalUser.getFolders(),servers:this.portal.getFederatedServers()}).then(function(N){this._setupTags(N.tags);this._setupCategories(N.categories);
this._setupFolders(N.folders);this._setupFederatedServers(N.servers);this._setupStepSettings();this._showModal()}.bind(this),function(N){})},_setupStepSettings:function(){this.datastoreDatabaseSettings=(new l({hostingServer:this.hostingServer})).placeAt(this.step2databaseContainer);this.datastoreFolderSettings=(new h({})).placeAt(this.step2FolderContainer);this.datastoreCloudMenu=(new f({})).placeAt(this.step2CloudMenuContainer);this.datastoreCloudSettings=(new q({})).placeAt(this.step2CloudContainer);
this.isEnableDatastoreBDFSSettings&&n.bdfsEnabled&&(M.remove(this.bigdataContainerNode.parentElement,"hide"),this.datastoreBDFSSettings=(new w({})).placeAt(this.step2BDSFContainer),this.datastoreBDFSFileShareSettings=(new u({})).placeAt(this.step2FileShareContainer),this.datastoreBDFSHDFSSettings=(new v({})).placeAt(this.step2HDFSContainer),this.datastoreBDFSHiveSettings=(new x({})).placeAt(this.step2HiveContainer),this.datastoreBDFSCloudMenu=(new z({})).placeAt(this.step2BDFSCloudMenuContainer),
this.datastoreBDFSCloudSettings=(new A({})).placeAt(this.step2BDFSCloudContainer));this.isEnableDatastoreNoSQLSettings&&n.noSQLEnabled&&!b.isArcGISEnterpriseOnKubernetes()&&(M.remove(this.noSQLContainerNode.parentElement,"hide"),this.datastoreNoSQLMenu=(new r({})).placeAt(this.step2NoSQLMenuContainer),this.datastoreNoSQLSettings=(new t({})).placeAt(this.step2NoSQLContainer))},_setupFederatedServers:function(N){this.federatedServers=N.servers;N=this.federatedServers.filter(function(V){return"HOSTING_SERVER"===
V.serverRole.toUpperCase()});N.length&&(this.hostingServer=N[0]);this.federatedServers.filter(function(V){return-1<V.serverFunction.toUpperCase().indexOf("GEOANALYTICS")}).length&&(this.isEnableDatastoreBDFSSettings=!0);this.federatedServers.filter(function(V){return-1<V.serverFunction.toUpperCase().indexOf("KNOWLEDGE")}).length&&(this.isEnableDatastoreNoSQLSettings=!0);this.federatedServersTable=(new J({federatedServers:this.federatedServers,filterFederatedServers:!0})).placeAt(this.federatedServersGridContainer)},
_setupFolders:function(N){var V=E("ESRI_Content");V=V?I.parse(V):{};var Z=V.folderId||null;this._selectedFolderId=V.folderId||null;(!N||!N.length||N&&N.length&&N[0].title!==this.portalUser.username)&&N.unshift({title:this.portalUser.username,id:"/"});this._folders=Aa.createElement("arcgis-folder-picker",{api:3,folder:Z||this.portalUser.username,label:pa.saveInFolder},this.domNode.querySelector(".folder-container"))},_setupCategories:function(N){n.self.hasCategorySchema&&(this._categories=new d({categories:[],
schema:N},this._categoriesContainer),this._categories.startup(),U(".categories-container",this.domNode).removeClass("hide"))},_showModal:function(){this.dialog=new R({title:pa.items.addDatastore,content:this.domNode,class:"add-datastore-dlg",onHide:this.destroy.bind(this),closable:!0});this.dialog.show().then(function(){this.addEventListeners();var N=dojo.create("a",{className:"icon-ui-question margin-left-half font-size--1 help-icon",title:this.i18n.AddDatastoreDlg.helpIconDescription,href:n.self&&
n.self.helpMap?n.self.helpBase+n.self.helpMap.m["120001660"]:"",target:"_blank"}),V=dojo.query(".dijitDialogTitleBar",this.dialog.domNode);dojo.place(N,V[0],1)}.bind(this))},_setupTags:function(N){this._tags=Aa.createElement("arcgis-tags-picker",{api:3,knownTags:N.map(function(V){return V.tag}),label:pa.itemTags,scale:"m"},this.domNode.querySelector(".tags-container"))},_loadConnections:function(){this.own(G.subscribe("onSelectedTagsUpdate",function(N){var V=this._tags.get("tags");N=V?N.split(",").concat(V.split(",")):
N.split(",");this._tags.set("tags",this._unique(N).join(","))}.bind(this)),G.subscribe("settings/validationComplete",this._validationComplete.bind(this)))},_processFolderPath:function(N,V,Z){if(!Z||0!==Z.trim().length){var ba;Z.split("\\").some(function(ma){ba=ma;if(0<ma.trim().length)return!0});V.set("value",ba);M.remove(N,"hide")}},addEventListeners:function(){this.own(U("input[name\x3d'datastoreType']").on("change",function(N){U("label.datastore-type").removeClass("active");M.add(N.target.parentElement,
"active")}.bind(this)),U("input[name\x3d'noSQLProvider']").on("change",function(N){U("label.noSQL-type").removeClass("active");M.add(N.target.parentElement,"active")}.bind(this)),U("input[name\x3d'bdfsType']").on("change",function(N){U("label.bdfs-type").removeClass("active");M.add(N.target.parentElement,"active")}.bind(this)),G.subscribe("server/openNFSModal",function(N){N&&M.add(this.nfsModal,"is-active")}.bind(this)),L(this.nfsModalCancelButton,"click",function(N){N.preventDefault();this._goToStep(2);
M.remove(this.nfsModal,"is-active")}.bind(this)),L(this.nfsModalXButton,"click",function(N){N.preventDefault();this._goToStep(2);M.remove(this.nfsModal,"is-active")}.bind(this)),L(this.nfsModalOkButton,"click",function(N){N.preventDefault();this.item.allowServicesRestart=!0;this.federatedServersTable.renderTable(this.item);this.federatedServersTable.validateDatastoreForServers(this._createItemDataObject(this.item).text);M.remove(this.nfsModal,"is-active")}.bind(this)),L(this.cancelButton,"click",
function(N){N.preventDefault();this.dialog.hide()}.bind(this)),L(this.nextButton,"click",function(N){N.preventDefault();this.nextButton.disabled=!0;Y.set(this.nextButton,"opacity",1);if("cloud"===this.item.dataStoreType||"bigdata"===this.item.dataStoreType||"noSQL"===this.item.dataStoreType||"bdfsCloud"===this.item.dataStoreType&&"new"===this.datastoreBDFSCloudSettings.cloudStoreType)this.currentStep--,0===this.currentStep&&this.currentStep++;this._validateStep(this.currentStep).then(function(V){V&&
(2===this.currentStep&&(this.federatedServersTable.renderTable(this.item),this.federatedServersTable.validateDatastoreForServers(this._createItemDataObject(this.item).text)),this._goToStep(this.currentStep+1));this.nextButton.disabled=!1}.bind(this))}.bind(this)),L(this.backButton,"click",function(N){N.preventDefault();"bigdata"===this.item.dataStoreType&&(this.item={},this.bigdataContainerNode.checked=!0,L.emit(this.bigdataContainerNode,"change",{bubbles:!0,cancelable:!0}));"cloud"===this.item.dataStoreType&&
(this.item={},this.cloudContainerNode.checked=!0,L.emit(this.cloudContainerNode,"change",{bubbles:!0,cancelable:!0}));"noSQL"===this.item.dataStoreType&&(this.item={},this.noSQLContainerNode.checked=!0,L.emit(this.noSQLContainerNode,"change",{bubbles:!0,cancelable:!0}));"folder"===this.item.dataStoreType&&"nfsHostAndPath"===this.item.serverFolderPath&&3===this.currentStep&&(delete this.item.allowServicesRestart,delete this.item.servers);3>this.currentStep&&("fileshare"===this.item.dataStoreType||
"hdfs"===this.item.dataStoreType||"hive"===this.item.dataStoreType||"bdfsCloud"===this.item.dataStoreType)&&(this.currentStep++,this.item.dataStoreType="bigdata");3>this.currentStep&&("amazon"===this.item.dataStoreType||"azure"===this.item.dataStoreType||"alibaba"===this.item.dataStoreType||"google"===this.item.dataStoreType)&&(this.currentStep++,this.item.dataStoreType="cloud");3>this.currentStep&&"Neo4j"===this.item.dataStoreType&&(this.currentStep++,this.item.dataStoreType="noSQL");3>this.currentStep&&
("bdfsamazon"===this.item.dataStoreType||"bdfsazure"===this.item.dataStoreType)&&(this.currentStep++,this.item.dataStoreType="bdfsCloud");this._goToStep(this.currentStep-1)}.bind(this)),L(this.addButton,"click",function(N){N.preventDefault();this._validateStep(this.currentStep).then(function(V){V&&this._addDatastore(this.item,this.portal)}.bind(this))}.bind(this)))},_getBDFSParameterItem:function(N,V,Z){var ba=V.split("/")[2].split("_")[0];Z={text:{},type:"Data Store"};Z.title=N||ba;Z.tags=[];Z.categories=
void 0;N={info:{connectionString:JSON.stringify({path:V}),connectionType:"dataStore"},path:"/bigDataFileShares/"+Z.title,type:"bigDataFileShare"};Z.text=JSON.stringify(N);return Z},_addBDFSDatastoreItem:function(N,V,Z){var ba=new F;b.request({url:n.restBaseUrl+"content/items/"+V+"/data"}).then(function(ma){var sa=this._getBDFSParameterItem(N,Z||ma.path,ma.id);this.item.dataStoreType="bdfsDataStore";this._addItemToPortal(sa,null,this.portal);ba.resolve({result:ma})}.bind(this),function(ma){this._showError(ma)}.bind(this));
return ba},_addDatastore:function(N,V){var Z=this._createItemDataObject(N);M.remove(this.errorNode,"is-active");this.errorNode.innerHTML="";M.add(this.addButton,"hide");M.add(this.backButton,"hide");M.add(this.cancelButton,"hide");U(".step-"+this.currentStep).addClass("hide");U(".loader-text",this.domNode).innerHTML(pa.AddDatastoreDlg.addingDataStore);M.add(this.loader,"is-active");"bdfsCloud"===N.dataStoreType&&"existing"===this.datastoreBDFSCloudSettings.cloudStoreType?this._addBDFSDatastoreItem(this.item.title,
this.cloudStoreId,this.cloudStorePath):this._addItemToPortal(Z,N.folderId,V)},_addItemToPortal:function(N,V,Z){B.addItem(N,V,Z).then(function(ba){ba.success?this._addDatastoreToServers(ba.id):this._showError(ba)}.bind(this),function(ba){this._showError(ba)}.bind(this))},_showError:function(N){this.errorNode.innerHTML=this.i18n.AddDatastoreDlg.addDatastoreError+" "+(N.details||[]).join(" ");U(".step-"+this.currentStep).removeClass("hide");M.remove(this.addButton,"hide");M.remove(this.backButton,"hide");
M.remove(this.cancelButton,"hide");M.remove(this.loader,"is-active");M.add(this.errorNode,"is-active")},_updateItemById:function(N){var V=new F;N=n.restBaseUrl+"content/users/"+b.getUser().username+"/items/"+N+"/update";b.request({url:N}).then(function(Z){V.resolve({result:Z})}.bind(this),function(Z){V.resolve({error:Z})}.bind(this));return V},_addDatastoreToServers:function(N){var V=[];this.item.servers.forEach(function(Z){V.push(function(){var ba=new F,ma={serverId:Z.id,datastoreId:N};b.isArcGISEnterpriseOnKubernetes()&&
(ma.options=JSON.stringify({allowServicesRestart:!0}));b.request({url:n.restBaseUrl+"portals/self/datastores/addToServer",content:ma},{usePost:!0}).then(function(sa){ba.resolve({serverId:Z.id,result:sa})}.bind(this),function(sa){ba.resolve({serverId:Z.id,error:sa})}.bind(this));return ba}.call(this))}.bind(this));(new C(V)).then(function(Z){var ba=[];Z.forEach(function(Ea){Ea[0]&&(Ea[1].result||{}).success||ba.push(Ea[1])});Z=n.baseUrl+"item.html?id\x3d"+N;if(ba.length){var ma=ba.map(function(Ea){var ya=
this.federatedServers.filter(function(wa){if(wa.id===Ea.serverId){var aa=wa.url,ca=(Ea.error||{}).message;ca&&(aa+=" - "+ca);wa.errorMessage=aa;return!0}}.bind(this));if(1===ya.length)return ya[0].errorMessage}.bind(this));this.errorNode.innerHTML=this.i18n.AddDatastoreDlg.addToServerError+"\x3cbr\x3e\x3cbr\x3e"+ma.join("\x3cbr\x3e");M.add(this.errorNode,"is-active");M.add(this.federatedServersGridContainer,"hide");M.remove(this.itemButton,"hide");Q.set(this.itemButton,"href",Z);M.remove(this.loader,
"is-active")}else if(["bdfsCloud","bdfsamazon","bdfsazure"].includes(this.item.dataStoreType))this._addBDFSDatastoreItem(this.item.title,N,null);else if(-1<"folder database amazon google azure alibaba huawei Neo4j".split(" ").indexOf(this.item.dataStoreType))location.href=Z;else var sa=setInterval(function(){var Ea=n.restBaseUrl+"content/items/"+N+"/relatedItems",ya=new F;b.request({url:Ea,content:{relationshipType:"BDFSDataStore2BDFSCatalogService",direction:"forward"}}).then(function(wa){wa.total&&
(clearInterval(sa),location.href=n.baseUrl+"item.html?id\x3d"+wa.relatedItems[0].id)},function(wa){ya.reject(wa)});return ya},1E4)}.bind(this))},_createItemDataObject:function(N){var V={text:{info:{isManaged:!1}},type:"Data Store"};V.title=N.title;V.tags=N.tags;V.categories=N.categories;V.snippet=N.summary;switch(N.dataStoreType){case "folder":N=this.datastoreFolderSettings.createFolderDataObject(V.text,N);V.text=N;break;case "database":V.text.type="egdb";V.text.path="/enterpriseDatabases/"+N.title;
V.text.info.dataStoreConnectionType="shared";"newConnection"===N.serverDatabaseOption?(V.text.info.connectionString=N.serverConnectionString,V.text.info.clientConnectionString=N.publisherConnectionString,V.text.info.dataStoreConnectionType="replicated"):V.text.info.connectionString=N.publisherConnectionString;break;case "amazon":case "azure":case "alibaba":case "google":V.text=this.datastoreCloudSettings.createCloudProviderDataObject(V.text,N);break;case "Neo4j":V.text=this.datastoreNoSQLSettings.createNoSQLDataObject(V.text,
N);break;case "fileshare":V.type="Data Store";V.text=this.datastoreBDFSFileShareSettings.createFileShareProviderDataObject(V.text,N);break;case "hdfs":V.type="Data Store";V.text=this.datastoreBDFSHDFSSettings.createHDFSProviderDataObject(V.text,N);break;case "hive":V.type="Data Store";V.text=this.datastoreBDFSHiveSettings.createHiveProviderDataObject(V.text,N);break;case "bdfsCloud":V.type="Data Store";N=this.datastoreBDFSCloudMenu.createBDFSCloudProviderDataObject(V.text,N);"existing"===this.datastoreBDFSCloudSettings.cloudStoreType&&
(V.text=void 0,this.cloudStoreId=this.federatedServersTable.datastoreId=N.cloudStoreId,this.cloudStorePath=N.cloudStorePath);break;case "bdfsamazon":case "bdfsazure":V.type="Data Store",V.text=this.datastoreBDFSCloudSettings.createBDFSCloudProviderDataObject(V.text,N)}V.text=JSON.stringify(V.text);return V},_validateTitle:function(N){var V={valid:!0,errorMessage:""};if(!N)return V.valid=!1,V.message=this.i18n.AddDatastoreDlg.validation.invalidTitle,V;for(var Z=0;Z<N.length;Z++){var ba=N[Z];if(ba.match(this.titleRegex)){V.valid=
!1;V.message=O.substitute(this.i18n.AddDatastoreDlg.validation.invalidTitleCharacter,{character:ba});break}}return V},_validateStep:function(N){var V=new F;this._setStepFormData(this.currentStep);var Z={valid:!0},ba=!1;switch(N){case 1:if(!this.item.dataStoreType){Z=this._generateInvalidResult(this.i18n.AddDatastoreDlg.validation.invalidDataStoreType);break}ba=!0;B.itemExists(this.item,this.portalUser.username,this.item.folderId).then(function(ma){ma.itemExists&&(Z=this._generateInvalidResult(ma.message),
c.createSpecifiedDialog(P).show(Z));V.resolve(Z.valid)}.bind(this));break;case 2:if("folder"===this.item.dataStoreType){(N=this.datastoreFolderSettings.validateFolderInputs(this.item))&&(Z=this._generateInvalidResult(N));break}if("database"===this.item.dataStoreType){if(!this.hostingServer){Z=this._generateInvalidResult(this.i18n.AddDatastoreDlg.hostingServerError);break}if(!this.item.publisherConnectionString){Z=this._generateInvalidResult(this.i18n.AddDatastoreDlg.validation.invalidPublisherConnectionFile);
break}if("newConnection"===this.item.serverDatabaseOption&&!this.item.serverConnectionString){Z=this._generateInvalidResult(this.i18n.AddDatastoreDlg.validation.invalidServerConnectionFile);break}}("amazon"===this.item.dataStoreType||"azure"===this.item.dataStoreType||"alibaba"===this.item.dataStoreType||"google"===this.item.dataStoreType)&&(N=this.datastoreCloudSettings.validateCloudProviderInputs(this.item))&&(Z=this._generateInvalidResult(N));"fileshare"===this.item.dataStoreType&&(N=this.datastoreBDFSFileShareSettings.validateFileShareInputs(this.item))&&
(Z=this._generateInvalidResult(N));"hdfs"===this.item.dataStoreType&&(N=this.datastoreBDFSHDFSSettings.validateHDFSInputs(this.item))&&(Z=this._generateInvalidResult(N));"hive"===this.item.dataStoreType&&(N=this.datastoreBDFSHiveSettings.validateHiveInputs(this.item))&&(Z=this._generateInvalidResult(N));"bdfsCloud"===this.item.dataStoreType&&(this.datastoreBDFSCloudMenu.cloudStoreId||(Z=this._generateInvalidResult(pa.AddDatastoreDlg.validation.invalidDataStore)));("bdfsamazon"===this.item.dataStoreType||
"bdfsazure"===this.item.dataStoreType)&&(N=this.datastoreBDFSCloudSettings.validateBDFSCloudInputs(this.item))&&(Z=this._generateInvalidResult(N));"Neo4j"===this.item.dataStoreType&&(N=this.datastoreNoSQLSettings.validateNoSQLInputs(this.item))&&(Z=this._generateInvalidResult(N));break;case 3:(this.item.servers||[]).length||(Z=this._generateInvalidResult(this.i18n.AddDatastoreDlg.validation.invalidServers));break;case 4:N=this._validateTitle(this.item.title);if(!N.valid){Z=this._generateInvalidResult(N.message);
break}"Neo4j"===this.item.dataStoreType?(ba=!0,B.checkForDuplicateNoSQL(this.item).then(function(ma){ma.itemExists&&(Z=this._generateInvalidResult(this.i18n.AddDatastoreDlg.validation.existingNoSQLItem+"\x3cbr\x3e"+this.getAllServers()),c.createSpecifiedDialog(P).show(Z));V.resolve(Z.valid)}.bind(this))):(ba=!0,B.itemExists(this.item,this.portalUser.username,this.item.folderId).then(function(ma){ma.itemExists&&(Z=this._generateInvalidResult(ma.message),c.createSpecifiedDialog(P).show(Z));V.resolve(Z.valid)}.bind(this)));
break;default:throw"Invalid step";}ba||(V.resolve(Z.valid),Z.valid||c.createSpecifiedDialog(P).show(Z));return V},_generateInvalidResult:function(N){return{title:this.i18n.generalDlg.errorDlgTitle,valid:!1,message:N}},_setStepFormData:function(N){switch(N){case 1:N=(U("input[name\x3d'datastoreType']:checked")[0]||{}).value;var V=(U("input[name\x3d'cloudstoreProvider']:checked")[0]||{}).value,Z=(U("input[name\x3d'bdfsType']:checked")[0]||{}).value,ba=(U("input[name\x3d'bdfsCloudstoreProvider']:checked")[0]||
{}).value,ma=(U("input[name\x3d'noSQLProvider']:checked")[0]||{}).value;this.item.type="Data Store";this.item.dataStoreType="cloud"===this.item.dataStoreType?V||this.item.dataStoreType:"bigdata"===this.item.dataStoreType?Z||this.item.dataStoreType:"bdfsCloud"===this.item.dataStoreType?ba||this.item.dataStoreType:"noSQL"===this.item.dataStoreType?ma||this.item.dataStoreType:N;break;case 2:"folder"===this.item.dataStoreType&&(this.item=this.datastoreFolderSettings.getFolderParamterUpdatedItem(this.item));
"database"===this.item.dataStoreType&&(this.item.publisherConnectionString=M.contains(this.datastoreDatabaseSettings.publisherConnectionContainer,"is-error")?"":this.datastoreDatabaseSettings.publisherConnectionString.value,this.item.serverDatabaseOption=(U("input[name\x3d'serverDatabaseOption']:checked")[0]||{}).value,this.item.serverConnectionString=M.contains(this.datastoreDatabaseSettings.serverConnectionContainer,"is-error")?"":this.datastoreDatabaseSettings.serverConnectionString.value);if("amazon"===
this.item.dataStoreType||"azure"===this.item.dataStoreType||"alibaba"===this.item.dataStoreType||"google"===this.item.dataStoreType)this.item=this.datastoreCloudSettings.getCloudParamterUpdatedItem(this.item);"fileshare"===this.item.dataStoreType&&(this.item=this.datastoreBDFSFileShareSettings.getFileshareParamterUpdatedItem(this.item));"hdfs"===this.item.dataStoreType&&(this.item=this.datastoreBDFSHDFSSettings.getHDFSParamterUpdatedItem(this.item));"hive"===this.item.dataStoreType&&(this.item=this.datastoreBDFSHiveSettings.getHiveParamterUpdatedItem(this.item));
if("bdfsamazon"===this.item.dataStoreType||"bdfsazure"===this.item.dataStoreType)this.item=this.datastoreBDFSCloudSettings.getBDFSCloudParamterUpdatedItem(this.item);"Neo4j"===this.item.dataStoreType&&(this.item=this.datastoreNoSQLSettings.getNoSQLUpdatedItem(this.item));break;case 3:this.item.servers=this.federatedServersTable.selectedServers;break;case 4:this.item.title=this.itemTitle.value;this.item.categories=(this._categories||{}).categories;this.item.tags=this._tags.activeTags.join(",")||null;
this.item.folderId=this._folders.value!==this._user.username?this._folders.value:null;this.item.summary=this.itemSummary.value;break;default:throw"Error setting step data";}},_goToStep:function(N){this.currentStep=N;this._changeStepContent(N);this._changeStepButtons(N)},_changeStepContent:function(N){U(".step-container").addClass("hide");var V=".step-"+N.toString()+(this.item.dataStoreType&&2===N?"-"+this.item.dataStoreType:"");2===N&&["amazon","azure","google","alibaba","huawei"].includes(this.item.dataStoreType)&&
(V=".step-2-cloudItem",this.datastoreCloudSettings._displayCloudStoreItem(this.item.dataStoreType));2===N&&"bdfsCloud"===this.item.dataStoreType&&(V=".step-2-bdfsCloudMenu");2===N&&["bdfsamazon","bdfsazure"].includes(this.item.dataStoreType)&&(V=".step-2-bdfsCloud",this.datastoreBDFSCloudSettings._displayBDFSCloudStoreItem(this.item.dataStoreType));2===N&&["Neo4j"].includes(this.item.dataStoreType)&&(V=".step-2-noSQLItem",this.datastoreNoSQLSettings._displayNoSQLContent(this.item.dataStoreType));
U(V).removeClass("hide");3===N&&(-1<["fileshare","bdfsCloud"].indexOf(this.item.dataStoreType)?U(".step-info-container",this.domNode).innerHTML(pa.AddDatastoreDlg.step3Info):U(".step-info-container",this.domNode).innerHTML(pa.AddDatastoreDlg.configureServersInfo))},_validationComplete:function(N){b.isArcGISEnterpriseOnKubernetes()&&M.remove(this.folderKubernetesWarning,"is-active")},_changeStepButtons:function(N){switch(N){case 1:M.remove(this.nextButton,"hide");M.add(this.addButton,"hide");M.add(this.backButton,
"hide");break;case 2:M.remove(this.backButton,"hide");M.remove(this.nextButton,"hide");M.add(this.addButton,"hide");break;case 3:M.remove(this.backButton,"hide");M.remove(this.nextButton,"hide");M.add(this.addButton,"hide");break;case 4:M.remove(this.backButton,"hide"),M.remove(this.addButton,"hide"),M.add(this.nextButton,"hide")}},onCancel:function(){},onSubmit:function(N){N.preventDefault()},destroy:function(){this._categories&&this._categories.destroyRecursive();this.dialog.destroyRecursive()},
getAllServers:function(){var N="";this.item.servers.map(function(V){N.includes("\x3ca href\x3d"+V.url+"\x3e"+V.url+"\x3c/a\x3e\x3cbr\x3e")||(N+="\x3ca href\x3d"+V.url+"\x3e"+V.url+"\x3c/a\x3e\x3cbr\x3e")});return N}})})},"arcgisonline/sharing/dijit/DatastoreCloudMenu":function(){define("require exports tslib dojo/string dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DatastoreCloudMenu.html dojo/i18n!../../nls/arcgisonline arcgisonline/tsutils/declareDecorator".split(" "),
function(e,K,p,a,g,m,n,b,c,d){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);return function(){function l(h){this.templateString=a.default.substitute(b.default,{i18n:c.default.AddDatastoreDlg});this.settingsMode=h.settingsMode;this.i18n=c.default;this.itemData=h.itemData}l.prototype.startup=function(){this.inherited(arguments);this._populateCloudProviders()};l.prototype._populateCloudProviders=
function(){var h=this;this.settingsMode&&"huawei"===((this.itemData||{}).provider||"").toLowerCase()||delete this.i18n.AddDatastoreDlg.cloudProviders.huawei;var f="";Object.keys(this.i18n.AddDatastoreDlg.cloudProviders).forEach(function(r){var q=h.i18n.AddDatastoreDlg.cloudProviders[r];f+="\n      \x3clabel class\x3d'cloudstore-type'\x3e\n        \x3cinput type\x3d'radio' name\x3d'cloudstoreProvider' value\x3d\"".concat(r,"\"\x3e\n        \x3cspan class\x3d'cloudstore-type-text'\x3e\n          \x3cspan class\x3d'cloudstore-type-label'\x3e\n            ").concat(q,
"\n          \x3c/span\x3e\n        \x3c/span\x3e\n      \x3c/label\x3e")},this);this.cloudStoreContent.innerHTML=f};return l=p.__decorate([(0,d.default)(g.default,m.default,n.default)],l)}()})},"arcgisonline/sharing/dijit/DatastoreNoSQLMenu":function(){define("esri/declare dojo/string dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DataStoreNoSQLMenu.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),function(e,K,p,a,g,m,n){return e([p,a,g],{templateString:K.substitute(m,
{i18n:n.AddDatastoreDlg}),constructor:function(b){this.inherited(arguments);this.settingsMode=b.settingsMode;this.i18n=n;this.itemData=b.itemData},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this._populateNoSQLProviders()},_populateNoSQLProviders:function(){this.noSQLContent.innerHTML="\x3clabel class\x3d'noSQL-type active'\x3e\x3cinput type\x3d'radio' name\x3d'noSQLProvider' value\x3d"+n.AddDatastoreDlg.Neo4j+" checked\x3d'checked'\x3e\x3cspan class\x3d'noSQL-type-text'\x3e\x3cspan class\x3d'noSQL-type-label'\x3e"+
n.AddDatastoreDlg.Neo4j+"\x3c/span\x3e\x3c/span\x3e\x3c/label\x3e"}})})},"arcgisonline/sharing/dijit/DatastoreBDFSSettings":function(){define("esri/declare dojo/string dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DatastoreBDFSSettings.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),function(e,K,p,a,g,m,n){return e([p,a,g],{templateString:K.substitute(m,{i18n:n.AddDatastoreDlg}),constructor:function(b){this.inherited(arguments);this.settingsMode=
b.settingsMode;this.i18n=n},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments)}})})},"arcgisonline/sharing/dijit/DatastoreBDFSCloudMenu":function(){define("esri/declare dojo/string dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin preact arcgisonline/pages/components/SelectCloudStore dojo/text!./templates/DatastoreBDFSCloudMenu.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),function(e,K,p,a,g,m,n,b,c){return e([p,a,g],{templateString:K.substitute(b,
{i18n:c.AddDatastoreDlg}),constructor:function(d){this.inherited(arguments);this.settingsMode=d.settingsMode;this.i18n=c;this.itemData=d.itemData},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this._populateBDFSCloudProviders();this._addCloudStore();this._fetchCloudStore()},_configureCloudStoreParameters:function(d,l){this.cloudStoreId=d;this.cloudStorePath=l},_addCloudStore:function(){m.render(m.h(n.default,{configureCloudStoreParameters:this._configureCloudStoreParameters.bind(this)}),
this.bdfsExistingCloudStoreOption)},_fetchCloudStore:function(){},_populateBDFSCloudProviders:function(){var d="";Object.keys(this.i18n.AddDatastoreDlg.bdfsCloudProviders).forEach(function(l){d+="\x3clabel class\x3d'cloudstore-type bdfs'\x3e\x3cinput type\x3d'radio' name\x3d'bdfsCloudstoreProvider' value\x3dbdfs"+l+" data-dojo-attach-point\x3dbdfs"+l+"ContainerNode\x3e\x3cspan class\x3d'cloudstore-type-text'\x3e\x3cspan class\x3d'cloudstore-type-label'\x3e"+this.i18n.AddDatastoreDlg.bdfsCloudProviders[l]+
"\x3c/span\x3e\x3c/span\x3e\x3c/label\x3e"},this);this.bdfsCloudStoreContent.innerHTML=d},createBDFSCloudProviderDataObject:function(){return{cloudStoreId:this.cloudStoreId,cloudStorePath:this.cloudStorePath}}})})},"arcgisonline/pages/components/SelectCloudStore":function(){define("require exports tslib preact arcgisonline/sharing/util arcgisonline/esriGeowConfig dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),function(e,K,p,a,g,m,n){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);
m=p.__importDefault(m);n=p.__importDefault(n);e=function(b){function c(){var d=null!==b&&b.apply(this,arguments)||this;d.state={cloudStoreListDisplay:[]};return d}p.__extends(c,b);c.prototype.componentDidMount=function(){this.requestCloudStoreID()};c.prototype.requestCloudStoreID=function(){var d=this,l=g.default.getUser().orgId;l={q:"orgid:".concat(l,' type:"').concat("Data Store",'"'),num:1E4};var h="".concat(m.default.restBaseUrl,"search");g.default.request({url:h,content:l},{useProxy:g.default.shouldUseProxy(h)}).then(function(f){f=
f.results;var r=[];f&&(f.forEach(function(q){var t=q.id,w=q.title,u=q.type;q=q.typeKeywords;-1===q.indexOf("bigDataFileShare")&&r.push({id:t,title:w,type:u,typeKeywords:q})}),d.setState({cloudStoreListDisplay:r}))},function(f){})};c.prototype.requestCloudStoreInfo=function(d){var l=this;d="".concat(m.default.restBaseUrl,"content/items/").concat(d,"/data");g.default.request({url:d},{useProxy:g.default.shouldUseProxy(d)}).then(function(h){l.props.configureCloudStoreParameters(h.id,h.path)},function(h){})};
c.prototype.selectCloudStore=function(d){var l=d.target.value[0],h;this.state.cloudStoreListDisplay.forEach(function(f,r){f.title===l&&(h=f.id)});this.requestCloudStoreInfo(h)};c.prototype.createCloudStoreList=function(d){return d.map(function(l){return(0,a.h)("calcite-combobox-item",{key:l.id,id:l.id,textLabel:l.title,value:l.title},l.title)})};c.prototype.render=function(){var d=this.createCloudStoreList(this.state.cloudStoreListDisplay);return(0,a.h)(a.Fragment,null,(0,a.h)("calcite-combobox",
{class:"cloud-ui-select",id:"existingDataStore",scale:"m",label:"Single selection-mode combobox",selectionMode:"single",oncalciteComboboxChange:this.selectCloudStore.bind(this),value:"",placeholder:n.default.AddDatastoreDlg.existingCloudStoreDropdownMenuPlaceholder},d))};return c}(a.Component);K.default=e})},"arcgisonline/sharing/dijit/DatastoreBDFSCloudSettings":function(){define("esri/declare esri/request dojo/string dojo/query dojo/topic dojo/dom-class dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DatastoreBDFSCloudSettings.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h){return e([b,c,d],{templateString:p.substitute(l,{i18n:h.AddDatastoreDlg}),cloudStoreType:"new",cloudStoreId:null,cloudStorePath:null,regionData:{},constructor:function(f){this.inherited(arguments);this.settingsMode=f.settingsMode;this.i18n=h;this.itemData=f.itemData},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this.settingsMode&&m.add(this.stepDescription,"hide");return this._populateFormSelects().then(function(){this._addEventListeners();
this.settingsMode&&this._populateCloudOptions(this.itemData)}.bind(this))},_populateBDFSCloudProviders:function(){var f="";Object.keys(this.i18n.AddDatastoreDlg.bdfsCloudProviders).forEach(function(r){f+="\x3clabel class\x3d'cloudstore-type bdfs'\x3e\x3cinput type\x3d'radio' name\x3d'bdfsCloudstoreProvider' value\x3dbdfs"+r+" data-dojo-attach-point\x3dbdfs"+r+"ContainerNode\x3e\x3cspan class\x3d'cloudstore-type-text'\x3e\x3cspan class\x3d'cloudstore-type-label'\x3e"+this.i18n.AddDatastoreDlg.bdfsCloudProviders[r]+
"\x3c/span\x3e\x3c/span\x3e\x3c/label\x3e"},this);this.bdfsCloudStoreContent.innerHTML=f},_populateFormSelects:function(){this._createOptions(this.i18n.AddDatastoreDlg.credentialTypeValues,this.bdfsCredentialType);return this._fetchRegionInfo()},_fetchRegionInfo:function(){var f=new n;K({url:"https://esriresources.s3.amazonaws.com/1110/regionsforcloudstorage.dat",handleAs:"json"}).then(function(r){this._addOptions(r.Amazon.regions,this.bdfsRegion,!0);this._addOptions(r.environments,this.bdfsEnvironment,
!1,"storageEndpointSuffix");f.resolve()}.bind(this),function(r){f.resolve()});return f},_createOptions:function(f,r){Object.keys(f).forEach(function(q){var t=document.createElement("option");t.label=f[q];t.value=q;r.appendChild(t)},this)},_addOptions:function(f,r,q,t){t=t||"id";r.labelAttr="displayName";r.sortByLabel=!1;q&&(q={},q.displayName=this.i18n.AddDatastoreDlg.custom,q[t]="custom",f.push(q));this._configureRegionSelect(f,r)},_configureRegionSelect:function(f,r){this.regionData[r.id]=f;f.forEach(function(q){var t=
document.createElement("option");t.id=q.id;t.label=q.displayName;t.value=q.id;r.appendChild(t)})},_onCredentialTypeChange:function(f){var r="iamrole"===f?!0:!1;this.bdfsAccessKeyId.disabled=r;a(".credential-type-change-connect").forEach(function(q){this.settingsMode&&this.editing||!this.settingsMode?(q.classList.remove("hide"),r?q.classList.add("grey-out"):q.classList.remove("grey-out")):r?q.classList.add("hide"):q.classList.remove("hide")},this);this.settingsMode&&g.publish("settings/cloudConnectionChange")},
_populateCloudOptions:function(f){this._disableControls(!0);var r=(f.provider||"").toLowerCase(),q=f.info.objectStore;this.bdfsCloudStoreOption.value=r;this._displayCloudStoreContent(r);if(-1<f.info.objectStore.indexOf("/")){var t=f.info.objectStore.indexOf("/");q=f.info.objectStore.substring(0,t);this.bdfsCloudFolder.value=f.info.objectStore.substring(t+1)}else m.add(this.bdfsCloudFolderContainer,"hide");f=JSON.parse(f.info.connectionString);switch(r){case "amazon":this.bdfsCredentialType.value=
f.credentialType;"accesskey"===f.credentialType&&(this.bdfsAccessKeyId.value=f.accessKeyId,this.bdfsSecretKeyId.value=f.secretAccessKey);r=this.getRegionID(this.bdfsRegion.options,f.regionEndpointUrl);this.bdfsRegion.value=r?r:"custom";this.bdfsStorageURL.value=f.regionEndpointUrl;this.bdfsBucketName.value=q;break;case "azure":this.bdfsAccountKey.value=f.accountKey;this.bdfsAccountName.value=f.accountName;this.bdfsEnvironment.value=f.accountEndpoint;this.bdfsContainerName.value=q;break;default:throw"Invalid cloud provider";
}},_showPrivateURL:function(f,r){a(".privateUrl").forEach(function(q){"custom"===f||r?q.classList.remove("hide"):q.classList.add("hide")})},_showCloudTypeUI:function(f){Array.from(this.bdfsCloudStoreRegistrationUI.children).forEach(function(r){r.classList&&r.classList.length&&!r.classList.contains(f)?r.classList.add("hide"):r.classList.remove("hide")})},_addEventListeners:function(){this.own(a("input[name\x3d'cloudStoreType']").on("change",function(f){"new"===f.target.value?(this.cloudStoreType="new",
a(".bdfsNewCloudStoreOptionWrapper").removeClass("hide"),a(".cloudStore-options.bdfs").addClass("hide")):(this.cloudStoreType="existing",a(".cloudStore-options.bdfs").removeClass("hide"),a(".bdfsNewCloudStoreOptionWrapper").addClass("hide"))}.bind(this)),a("input[name\x3d'bdfsCloudstoreProvider']",this.domNode).on("change",function(f){a("label.cloudstore-type.bdfs",this.domNode).removeClass("active");m.add(f.target.parentElement,"active")}.bind(this)))},_disableControls:function(f){this.bdfsCloudStoreOption.disabled=
this.settingsMode||f;this.bdfsStorageURL.readOnly=f;this.bdfsCredentialType.disabled=f;this.bdfsAccountName.readOnly=f;this.bdfsAccountKey.readOnly=f;this.bdfsAccessKeyId.readOnly=f;this.bdfsSecretKeyId.readOnly=f;this.bdfsRegion.disabled=f;this.bdfsEnvironment.disabled=f;this.bdfsContainerName.readOnly=f;this.bdfsBucketName.readOnly=f;this.bdfsCloudFolder.readOnly=f},getRegionID:function(f,r){var q;f.forEach(function(t){t.item.blobStoreEndpoint===r&&(q=t.item.id)});return q},getRegionEndpointURL:function(f,
r){var q;f.forEach(function(t){t.id===r&&(q=t.blobStoreEndpoint||t.storageEndpointSuffix)});return q},getBDFSCloudParamterUpdatedItem:function(f){f||(f={});f.provider=this.getBDFSCloudStoreValue(this.bdfsCloudStoreOption.value);f.storageURL=this.bdfsStorageURL.value;f.credentialType=this.bdfsCredentialType.value;f.accountName=this.bdfsAccountName.value;f.accountKey=this.bdfsAccountKey.value;f.accessKeyId=this.bdfsAccessKeyId.value;f.secretKeyId=this.bdfsSecretKeyId.value;f.region=this.bdfsRegion.value;
f.environment=this.bdfsEnvironment.value;f.containerName=this.bdfsContainerName.value;f.bucketName=this.bdfsBucketName.value;f.cloudFolder=this.bdfsCloudFolder.value;return f},_displayCloudStoreContent:function(f){this.bdfsCloudStoreRegistrationUI.classList.remove("hide");if(this.settingsMode&&this.editing||!this.settingsMode)this.bdfsCredentialType.value="accesskey";this._showCloudTypeUI(f);this.settingsMode&&g.publish("settings/cloudConnectionChange")},_displayBDFSCloudStoreItem:function(f){"bdfsamazon"===
f?this.bdfsCloudStoreOption.value=this.i18n.AddDatastoreDlg.cloudProviders.amazon:"bdfsazure"===f&&(this.bdfsCloudStoreOption.value=this.i18n.AddDatastoreDlg.cloudProviders.azure);this._displayCloudStoreContent(f.substring(4))},createBDFSCloudProviderDataObject:function(f,r){if("new"===this.cloudStoreType){var q=(r.provider||"").toLowerCase(),t=f.info.connectionString={};t.credentialType="accesskey";switch(q){case "amazon":"accesskey"===r.credentialType?(t.accessKeyId=r.accessKeyId,t.secretAccessKey=
r.secretKeyId):t.credentialType=r.credentialType;t.regionEndpointUrl="custom"===r.region?r.storageURL:this.getRegionEndpointURL(this.regionData.bdfsRegion,r.region);f.info.objectStore=r.bucketName;f.provider="amazon";break;case "azure":t.accountKey=r.accountKey;t.accountName=r.accountName;t.accountEndpoint="custom"===r.environment?r.storageURL:this.getRegionEndpointURL(this.regionData.bdfsEnvironment,r.environment);f.info.objectStore=r.containerName;f.provider="azure";break;default:throw"Invalid cloud provider";
}t.defaultEndpointsProtocol="https";r.cloudFolder&&(f.info.objectStore=f.info.objectStore+"/"+r.cloudFolder);f.info.connectionString=JSON.stringify(t);f.type="cloudStore";f.path="/cloudStores/"+r.title;return f}},validateBDFSCloudInputs:function(f){var r=(f.provider||"").toLowerCase();if(!r)return this.i18n.AddDatastoreDlg.validation.invalidCloudProvider;var q=[];switch(r){case "amazon":"accesskey"!==f.credentialType||f.accessKeyId||q.push(this.i18n.AddDatastoreDlg.accessKeyId);"accesskey"!==f.credentialType||
f.secretKeyId||q.push(this.i18n.AddDatastoreDlg.secretKeyId);"amazon"!==r||f.bucketName||q.push(this.i18n.AddDatastoreDlg.bucketName);"custom"!==f.region||f.storageURL||q.push(this.i18n.AddDatastoreDlg.storageURL);break;case "azure":f.accountName||q.push(this.i18n.AddDatastoreDlg.accountName);f.accountKey||q.push(this.i18n.AddDatastoreDlg.accountKey);f.containerName||q.push(this.i18n.AddDatastoreDlg.containerName);"custom"!==f.environment||f.storageURL||q.push(this.i18n.AddDatastoreDlg.storageURL);
break;default:throw"Invalid cloud provider";}f=this.i18n.AddDatastoreDlg.validation.errorInfo.replace("${missingFields}",q.join(", ")).replace(/,([^,]*)$/," "+this.i18n.FilterDlg.and+"$1");f=f.replace(/:/g,"");return q.length?f:!1},getBDFSCloudStoreValue:function(f){var r;Object.keys(this.i18n.AddDatastoreDlg.bdfsCloudProviders).forEach(function(q){f===this.i18n.AddDatastoreDlg.bdfsCloudProviders[q]&&(r=q)},this);return r}})})},"arcgisonline/sharing/dijit/dialog/CreateNotebookDlg":function(){define("require esri/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/dijit/Tags arcgisonline/esriGeowConfig arcgisonline/sharing/util arcgisonline/pages/pageUtil arcgisonline/pages/utils/notebook arcgisonline/pages/dijit/CategoryPicker arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin arcgisonline/sharing/dijit/dialog/_AddItemDlgMixin arcgisonline/sharing/dijit/dialog/GeneralDlg dijit/Dialog dijit/form/Textarea dijit/form/Select dojo/dom-construct dojo/cookie dojo/json dojo/Deferred dojo/promise/all dojo/DeferredList dojo/_base/array dojo/_base/lang dojo/topic dojo/on dojo/string dojo/query dojo/dom-class dojo/dom-attr dojo/NodeList-dom dojo/text!./templates/CreateNotebookDlg.html dojo/i18n!arcgisonline/nls/arcgisonline dojo/i18n!arcgisonline/nls/notebooks dojox/uuid/generateRandomUuid".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L){return K([p,a,g],{templateString:T.substitute(C,{i18n:G.CreateNotebookDlg}),dialog:null,federatedServers:null,hostingServer:null,currentStep:null,item:null,thumbnail:null,postCreate:function(){this.inherited(arguments)},constructor:function(O){this.saveAs=O.saveAs;this.onHide=O.onHide;this.originalItem=O.originalItem;this.currentStep=1;this.formData=new FormData;this.item={}},postMixInProperties:function(){this.inherited(arguments);
this.i18n=y;this.i18n.notebookLanding=G.notebookLanding;this.i18n.notebookViewer=G.notebookViewer;this.i18n.notebookServerManager=G.notebookServerManager;this.i18n.CreateNotebookDlg=G.CreateNotebookDlg},startup:function(){this.inherited(arguments);this._user=b.getUser();this._loadConnections();A({tags:b.loadUserTags(this._user.username),categories:this.portal.getCategories(),folders:this.portalUser.getFolders(),samples:d.getSampleNotebooks(),runtimes:d.getNotebookRuntimes(),info:d.getNotebookServerInfo(),
thumbnail:this._loadNotebookThumbnail(this.originalItem.thumbnailUrl)}).then(function(O){this._setupSamples(O.samples);this._setupTags(O.tags);this._setupCategories(O.categories);this._setupFolders(O.folders);this._setupRuntimes(O.runtimes,O.info.currentRuntimeVersion);this._showModal();this._setThumbnail(O.thumbnail)}.bind(this),function(O){})},_setupRuntimes:function(O,U){this.runtimes=P.clone(O);d.createRuntimeSelect(this.runtimes,U,this.notebookRuntimeSelect)},_setupSamples:function(O){this.samples=
O.items;O.items.unshift({id:"blank",title:this.i18n.CreateNotebookDlg.blankNotebook,snippet:this.i18n.CreateNotebookDlg.blankNotebookSnippet});var U=u.create("div",{class:"sample-template-container"}),M=n.baseUrl+"js/arcgisonline/css/images/notebook-thumb.png";O.items.forEach(function(Q){var Y=n.restBaseUrl+"content/items/"+Q.id+"/info/"+Q.thumbnail+"?token\x3d"+this.portalUser.credential.token,fa=u.create("label",{class:"sample-template-group card"},U);u.create("input",{type:"radio",value:Q.id,name:"sampleTemplate"},
fa);u.create("div",{class:"card-selector"},fa);u.create("img",{src:Q.thumbnail?Y:M},fa);Y=u.create("div",{class:"card-content"},fa);u.create("h5",{innerHTML:Q.title,title:Q.title},Y);u.create("p",{class:"font-size--1 card-last",innerHTML:Q.snippet},Y)}.bind(this));u.place(U,this.templateSelectionContainer)},_setupFolders:function(O){var U=v("ESRI_Content");U=U?x.parse(U):{};var M=U.folderId||null;this._selectedFolderId=U.folderId||null;(!O||!O.length||O&&O.length&&O[0].title!==this.portalUser.username)&&
O.unshift({title:this.portalUser.username,id:"/"});this._folders.options=J.map(O,"return {label:item.title, value:item.id};");this._folders.set("value",M||this.portalUser.username)},_setupCategories:function(O){n.self.hasCategorySchema&&(this._categories=new l({categories:[],schema:O},this._categoriesContainer),this._categories.startup(),E(".categories-container",this.domNode).removeClass("hide"))},_showModal:function(){this.dialog=new q({title:this.saveAs?y.CreateNotebookDlg.saveNotebookAs:y.CreateNotebookDlg.createNotebook,
content:this.domNode,class:"create-notebook-dlg",onHide:function(){this.destroyRecursive();if(this.onHide)this.onHide()}.bind(this),closable:!0});this.dialog.show().then(function(){this.addEventListeners();this.saveAs?(this.item.templateId=this.originalItem.id,this.samples=[this.originalItem],I.add(this.step2Container,"padding-leader-1"),this.addButton.innerText=y.CreateNotebookDlg.saveNotebook,this._goToStep(2)):(I.remove(this.stepIndicatorContainer,"hide"),this._goToStep(1))}.bind(this))},_setupTags:function(O){this._tags.set("knownTags",
O)},_loadConnections:function(){this.own(R.subscribe("onSelectedTagsUpdate",function(O){var U=this._tags.get("tags");O=U?O.split(",").concat(U.split(",")):O.split(",");this._tags.set("tags",this._unique(O).join(","))}.bind(this)));this.own(S(this._tagsLbl,"click",function(O){this._tags._inputTextBox.focus();E(".select2-choices",this._tags.domNode).addClass("focus")}.bind(this)),S(this._tags.domNode,"focusout",function(O){E(".select2-choices",this._tags.domNode).removeClass("focus")}.bind(this)),S(this._tags.domNode,
"focusin",function(O){E(".select2-choices",this._tags.domNode).addClass("focus")}.bind(this)))},_unique:function(O){var U={};return J.filter(O,function(M){return!M||U[M]?!1:U[M]=!0})},_processFolderPath:function(O,U,M){if(!M||0!==M.trim().length){var Q;M.split("\\").some(function(Y){Q=Y;if(0<Y.trim().length)return!0});U.set("value",Q);I.remove(O,"hide")}},addEventListeners:function(){this.own(S(this.cancelButton,"click",function(O){O.preventDefault();this.dialog.hide()}.bind(this)),S(this.nextButton,
"click",function(O){O.preventDefault();this._validateStep(this.currentStep)&&this._goToStep(this.currentStep+1)}.bind(this)),S(this.backButton,"click",function(O){O.preventDefault();this._goToStep(this.currentStep-1)}.bind(this)),S(this.addButton,"click",function(O){O.preventDefault();this._validateStep(this.currentStep)&&this._createNotebook(this.item,this.portal)}.bind(this)))},_showCloudTypeUI:function(O){Array.from(this.cloudStoreRegistrationUI.children).forEach(function(U){U.classList&&U.classList.length&&
!U.classList.contains(O)?U.classList.add("hide"):U.classList.remove("hide")})},_createNotebook:function(O,U){function M(fa){this.errorNode.innerHTML=fa.message;E(".step-"+this.currentStep).removeClass("hide");I.remove(this.addButton,"hide");I.remove(this.backButton,"hide");I.remove(this.cancelButton,"hide");I.remove(this.loader,"is-active");I.add(this.errorNode,"is-active")}var Q=this.telemetry,Y=this._createItemDataObject(O);I.remove(this.errorNode,"is-active");this.errorNode.innerHTML="";I.add(this.addButton,
"hide");I.add(this.backButton,"hide");I.add(this.cancelButton,"hide");E(".step-"+this.currentStep).addClass("hide");I.add(this.loader,"is-active");h.addItem(Y,O.folderId,U).then(function(fa){if(fa.success)if(Q&&Q.logEvent({label:"create apps",category:"new item",pageName:"my content",details:"notebook"}),this.saveAs)R.publish("notebook/itemCreated",fa);else{var va=n.baseUrl+"notebook/notebook.html?id\x3d"+fa.id;va+="blank"!==O.templateId?"\x26templateId\x3d"+O.templateId:"";setTimeout(function(){window.location=
va},400)}else M.call(this,fa)}.bind(this),function(fa){M.call(this,fa)}.bind(this))},_createItemDataObject:function(O){var U=new FormData,M=f().itemInfo.notebook;U.append("type",M.type);U.append("typeKeywords",M.typeKeywords);U.append("snippet",O.summary||"");U.append("title",O.title);U.append("tags",(O.tags||[]).join(","));U.append("categories",O.categories||"");O.properties&&U.append("properties",O.properties);this.thumbnail&&U.append("thumbnail",this.thumbnail);return U},_validateStep:function(O){this._setStepFormData(this.currentStep);
var U={valid:!0};switch(O){case 1:if(!this.item.templateId){U=this._generateInvalidResult(this.i18n.CreateNotebookDlg.validation.invalidTemplate);break}"blank"!==this.item.templateId||(this.runtimes||[]).length||(U=this._generateInvalidResult(this.i18n.CreateNotebookDlg.validation.invalidRuntimes));break;case 2:if(!this.item.title){U=this._generateInvalidResult(this.i18n.CreateNotebookDlg.validation.invalidTitle);break}this._validateTitle(this.item.title)&&(U=this._generateInvalidResult(this.i18n.itemProperties.error.badCharacter));
break;default:throw"Invalid step";}U.valid||c.createSpecifiedDialog(r).show(U);return U.valid},_validateTitle:function(O){return-1<O.indexOf("\x3c")||-1<O.indexOf("\x3e")},_generateInvalidResult:function(O){return{title:this.i18n.generalDlg.errorDlgTitle,valid:!1,message:O}},_setStepFormData:function(O){switch(O){case 1:this.item.templateId=(E("input[name\x3d'sampleTemplate']:checked")[0]||{}).value;break;case 2:this.item.title=this.itemTitle.value;this.item.summary=this._summary.value;this.item.categories=
(this._categories||{}).categories;this.item.tags=(this._tags||{}).values;this.item.folderId=this._folders.value!==this._user.username?this._folders.value:null;this.saveAs||"blank"!==this.item.templateId?this.saveAs&&this.runtimeId&&(this.item.properties=d.createNotebookRuntimeProperties(this.runtimes,null,this.runtimeId)):this.item.properties=d.createNotebookRuntimeProperties(this.runtimes,this.notebookRuntimeSelect);break;default:throw"Error setting step data";}},_goToStep:function(O){this.currentStep=
O;this._changeStepIndicator(O);this._changeStepContent(O);this._changeStepButtons(O)},_changeStepIndicator:function(O){E(".create-step").removeClass("active");E("#step"+O.toString()).addClass("active")},_changeStepContent:function(O){E(".step-container").addClass("hide");var U=".step-"+O.toString();2===O&&(this.saveAs||"blank"!==this.item.templateId||I.remove(this.notebookRuntimeContainer,"hide"),"blank"!==this.item.templateId&&(this.samples||[]).length&&(O=this.samples.filter(function(M){return M.id===
this.item.templateId}.bind(this)).shift()))&&(this._tags.set("tags",(O.tags||[]).join(",")),this._summary.set("value",O.snippet),O.properties&&(this.item.properties=JSON.stringify(O.properties)));E(U).removeClass("hide")},_changeStepButtons:function(O){switch(O){case 1:I.remove(this.nextButton,"hide");I.add(this.addButton,"hide");I.add(this.backButton,"hide");break;case 2:I.add(this.nextButton,"hide"),I.remove(this.addButton,"hide"),this.saveAs||I.remove(this.backButton,"hide")}},hide:function(){this.dialog.hide()},
onSubmit:function(O){O.preventDefault()},destroy:function(){this._tags.destroyRecursive();this._summary.destroyRecursive();this._folders.destroyRecursive();this._categories&&this._categories.destroyRecursive();this.dialog.destroyRecursive()},_loadNotebookThumbnail:function(O){if(!O)return!1;O=new URL(O);O.search="?token\x3d"+this.portalUser.credential.token;return fetch(O.toString()).then(function(U){return U.blob()}).then(function(U){var M=U.type.split("/");M=L()+"."+M[1]||".png";return new File([U],
M,{type:U.type})})},_setThumbnail:function(O){if(O)return this.thumbnail=O;this.thumbnail=null}})})},"arcgisonline/pages/dijit/CreateImageryContent":function(){define("require exports tslib dojo/string dojo/dom-attr dojo/dom-class dojo/_base/kernel dijit/_TemplatedMixin dijit/_WidgetBase dojo/text!./CreateImageryContent/templates/CreateImageryContent.html dojo/i18n!../../nls/arcgisonline ./Overlay ../../esriGeowConfig arcgisonline/tsutils/declareDecorator".split(" "),function(e,K,p,a,g,m,n,b,c,d,
l,h,f,r){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);return function(){function q(t,w){this.overlayContents=a.default.substitute(d.default,{i18n:l.default});this.showActionBar=!1;this.title=l.default.items.createImageryLayer;this.folderId=""}q.prototype.postCreate=function(){this.inherited(arguments);
m.default.add(this.domNode,"overlay--top");var t="".concat(f.default.createImageryContentUrl,"?lang\x3d").concat(n.default.locale,"\x26folderId\x3d").concat(this.folderId);g.default.set(this.domNode.querySelector(".js-iframe"),"src",t);this._evtHandle=this._handleImageryMessage.bind(this);window.addEventListener("message",this._evtHandle)};q.prototype.destroy=function(){window.removeEventListener("message",this._evtHandle);this.inherited(arguments)};q.prototype.handleCancel=function(t){null==this.unsavedChangesText&&
this._redirectItemId?window.location.href="".concat(f.default.baseUrl,"item.html?id\x3d").concat(this._redirectItemId):this.close()};q.prototype._handleImageryMessage=function(t){var w=t.data;"imagery"===w.msgType&&(w.hasDataInPortal?(this.setUnsaved(!0),this.scratchFolderId=w.scratchFolderId,this.unsavedChangesText=w.message,this._redirectItemId=null):(this.setUnsaved(!1),this.unsavedChangesText=this.scratchFolderId=null,this._redirectItemId=w.itemId),w.close&&(w.redirect&&w.itemId?(this.telemetry&&
this.telemetry.logEvent({label:"new item",category:"new item",pageName:"my content",details:"imagery layer",attribute:w.layerType}),setTimeout(function(){return window.location.href="".concat(f.default.baseUrl,"item.html?id\x3d").concat(w.itemId)},500)):this.close()))};return q=p.__decorate([(0,r.default)(c.default,b.default,h.default)],q)}()})},"arcgisonline/pages/dijit/CreateRasterFunctionTemplate":function(){define("require exports tslib dojo/string dojo/dom-class dijit/_TemplatedMixin dijit/_WidgetBase dojo/text!./CreateRasterFunctionTemplate/templates/CreateRasterFunctionTemplate.html dojo/i18n!../../nls/arcgisonline ./Overlay ../../esriGeowConfig arcgisonline/tsutils/declareDecorator ../../sharing/dijit/RasterFunctionEditor".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);return function(){function r(q,t){this.overlayContents=a.default.substitute(b.default,{i18n:c.default});this.showActionBar=!1;this.title=c.default.items.createRasterFunctionTemplate}r.prototype.postCreate=function(){this.inherited(arguments);
g.default.add(this.domNode,"overlay--top");this.domNode.style.display="none";this.openInRFxEditor({user:this.portalUser,parent:this.srcNodeRef,entryPoint:"contentPage"});this._evtHandle=this._handleRFxEditorMessage.bind(this);window.addEventListener("message",this._evtHandle)};r.prototype.destroy=function(){window.removeEventListener("message",this._evtHandle);this.inherited(arguments)};r.prototype.openInRFxEditor=function(q){q=q||{};this._rasterFunctionEditor?(this._rasterFunctionEditor.set("parent",
q.parent),this._rasterFunctionEditor.open()):(q.showOnStart=!0,q=new f.default(q,document.createElement("div")),q.startup(),document.body.appendChild(q.domNode),this._rasterFunctionEditor=q)};r.prototype._handleRFxEditorMessage=function(q){var t=q.data;"string"===typeof t&&(t=JSON.parse(t));null!==t&&void 0!==t&&t.action&&("close"===t.action?this.close():"redirect"===t.action&&t.itemId&&setTimeout(function(){return window.location.href="".concat(l.default.baseUrl,"item.html?id\x3d").concat(t.itemId)},
500))};return r=p.__decorate([(0,h.default)(n.default,m.default,d.default)],r)}()})},"arcgisonline/pages/components/RestoreItems":function(){define("require exports tslib preact dojo/i18n!../../nls/arcgisonline preact/hooks ../utils/timeout ../dijit/ChangeOwner/FolderPicker ../components/DeleteMembers/api ./SummarizedItems ../utils/storage ../utils/recycle".split(" "),function(e,K,p,a,g,m,n,b,c,d,l,h){function f(q){var t=this,w=q.items,u=q.user;q=(0,m.useState)(!0);var v=q[0],x=q[1],z=(0,m.useRef)({restorableItems:[],
sourceItems:[],unrestorableItems:[]});(0,m.useEffect)(function(){u&&(x(!0),function(){return p.__awaiter(t,void 0,void 0,function(){var A,B,J,P=this;return p.__generator(this,function(R){switch(R.label){case 0:return A=function(){return p.__awaiter(P,void 0,void 0,function(){var S,T,E,I;return p.__generator(this,function(F){switch(F.label){case 0:return[4,(0,h.getRestorableItems)(w,u)];case 1:return S=F.sent(),T=S.restorableItems,E=S.sourceItems,I=S.unrestorableItems,[2,p.__assign(p.__assign({},z.current),
{restorableItems:T,sourceItems:E,unrestorableItems:I})]}})})},B=function(){return p.__awaiter(P,void 0,void 0,function(){var S;return p.__generator(this,function(T){switch(T.label){case 0:return S=[p.__assign({},z.current)],[4,A()];case 1:return[2,p.__assign.apply(void 0,S.concat([T.sent()]))]}})})},J=z,[4,B()];case 1:return J.current=R.sent(),x(!1),[2]}})})}())},[w,u]);return{isLoading:v,itemsStatus:z.current}}var r=this;Object.defineProperty(K,"__esModule",{value:!0});K.RestoreItems=K.MAX_BULK_RESTORE_ITEMS_COUNT=
void 0;g=p.__importDefault(g);b=p.__importDefault(b);l=p.__importDefault(l);K.MAX_BULK_RESTORE_ITEMS_COUNT=20;K.RestoreItems=function(q){function t(V){if(T)return T;V=new b.default({portal:v,user:V,initialFolderId:Q},M.current);V.on("cancel",function(){F(!1)});V.on("selectUpdate",function(Z){C(Z);F(!1)});E(V);return V}var w,u=q.items,v=q.portal,x=q.onCancel,z=q.onSubmit,A=(0,m.useState)(!0);q=A[0];var B=A[1],J=(0,m.useState)(!1);A=J[0];var P=J[1];J=(0,m.useState)(null);var R=J[0],S=J[1];J=(0,m.useState)();
var T=J[0],E=J[1];J=(0,m.useState)(!1);var I=J[0],F=J[1];J=(0,m.useState)(null);var D=J[0],C=J[1],y=f({items:u,user:R});J=y.isLoading;y=y.itemsStatus;var G=y.restorableItems,L=y.sourceItems,O=y.unrestorableItems,U=p.__spreadArray(p.__spreadArray([],G,!0),L,!0),M=(0,m.useRef)(null),Q=null===(w=l.default.getCookie("ESRI_Content",!0))||void 0===w?void 0:w.defaultRestoreFolderId;w=A||J;var Y=u.length>K.MAX_BULK_RESTORE_ITEMS_COUNT,fa=u.every(function(V){return V.owner===u[0].owner}),va=0>=U.length;A=
!Y&&fa&&0<U.length;(0,m.useEffect)(function(){(function(){return p.__awaiter(r,void 0,void 0,function(){var V,Z,ba;return p.__generator(this,function(ma){switch(ma.label){case 0:return[4,(0,c.getUser)(u[0].owner,v)];case 1:return V=ma.sent(),[4,V.getFolders()];case 2:return ma.sent(),S(V),Z={username:V.username,id:V.username,title:V.username},V.id===v.portalUser.id?C(null!==(ba=V.folders.find(function(sa){return sa.id===Q}))&&void 0!==ba?ba:Z):C(Z),[2]}})})})()},[u]);(0,m.useEffect)(function(){I&&
!T&&t(R).updateUser(R)},[I]);var Aa=g.default;y=function(){if(fa){if(Y)return(0,a.h)("span",null,Aa.recycle.restore.cannotBulkRestoreXItems.replace("${number}",K.MAX_BULK_RESTORE_ITEMS_COUNT));if(va)return pa()}else return(0,a.h)("span",null,Aa.recycle.restore.cannotBulkRestoreMultipleOwners)};var pa=function(){var V,Z=O.filter(function(ba){var ma,sa;return 0<(null===(sa=null===(ma=ba.error)||void 0===ma?void 0:ma.offendingItems)||void 0===sa?void 0:sa.length)}).map(function(ba){return ba.error.offendingItems})[0];
return(0,a.h)(a.Fragment,null,(0,a.h)(d.SummarizedItems,{id:"cannot-restore-summary",itemSummary:[{itemGroup:O}],title:Aa.recycle.restore.cannotRestore,description:1<O.length&&Aa.recycle.restore.dependentItems.multiple,htmlDescription:1===O.length&&Aa.recycle.restore.dependentItems.single.replace("${parent}",null!==(V=null===Z||void 0===Z?void 0:Z[0].title)&&void 0!==V?V:""),disableLinks:!0}),0<U.length&&(0,a.h)("hr",{class:"leader-half trailer-0"}))},N=function(){return(0,a.h)(a.Fragment,null,(0,a.h)("div",
{class:"content-folder__input-container margin-top-1"},(0,a.h)("div",{class:"".concat(I?"hide":"")},(0,a.h)("span",{class:"summarized-items__label"},Aa.recycle.restore.restoreTo),(0,a.h)("div",{class:"panel panel-white flex flex-align-center selected-folder-tile mt-2",tabIndex:0,onClick:function(){F(!0)},onKeyDown:function(V){["Space","Enter"].includes(V.code)&&F(!0)},role:"button"},(0,a.h)("calcite-icon",{icon:"".concat((null===D||void 0===D?void 0:D.id)===(null===R||void 0===R?void 0:R.username)?
"home":"folder"),scale:"s"}),(0,a.h)("div",{class:"flex-1 flex flex-column margin-left-half break-word"},(0,a.h)("span",{class:"trailer-0 summarized-items__label"},null===D||void 0===D?void 0:D.title)),(0,a.h)("calcite-icon",{icon:"pencil",scale:"s"})))),(0,a.h)("div",{class:"".concat(I?"":"hide")},(0,a.h)("div",{ref:M})))};return(0,a.h)("calcite-modal",{open:q,width:"s",oncalciteModalClose:function(){return x()}},(0,a.h)("h3",{slot:"header",class:"font-size-2 trailer-0"},J?"":1<u.length?Aa.recycle.restore.restoreItems:
Aa.recycle.restore.restoreItem),(0,a.h)("div",{slot:"content",class:"summarized-items__modal"},w&&(0,a.h)("calcite-scrim",{loading:!0}),(0,a.h)("div",{class:"".concat(I?"restore-modal__folder-picker":"")},(0,a.h)("div",{class:"flex-column"},!w&&(A?(0,a.h)(a.Fragment,null,0<O.length&&!I&&pa(),!I&&(0,a.h)(d.SummarizedItems,{id:"restore-summary",itemSummary:[{itemGroup:U}],title:1<U.length?Aa.recycle.restore.toRestore.multiple:Aa.recycle.restore.toRestore.single,disableLinks:!0}),N(),!I&&(0,a.h)("calcite-notice",
{open:!0,class:"leader-1"},(0,a.h)("div",{slot:"message"},Aa.recycle.restore.noticeMessage))):y())))),(0,a.h)("calcite-button",{slot:"secondary",width:"full",appearance:"outline",kind:"brand",onClick:function(){return p.__awaiter(r,void 0,void 0,function(){return p.__generator(this,function(V){switch(V.label){case 0:return[4,(0,n.timeout)(50)];case 1:return V.sent(),B(!1),[2]}})})}},Aa.common.cancel),A&&(0,a.h)("calcite-button",{slot:"primary",width:"full",kind:"brand",appearance:"solid",disabled:I,
onClick:function(){P(!0);z(L,G,D)}},Aa.recycle.restore.restore))}})},"arcgisonline/pages/components/DeleteMembers/api":function(){define("require exports tslib ../../../sharing/util ../../../esriGeowConfig ../../portal/PortalUser ../../pageUtil ../../utils/timeout".split(" "),function(e,K,p,a,g,m,n,b){function c(P){return p.__awaiter(this,void 0,void 0,function(){var R;return p.__generator(this,function(S){switch(S.label){case 0:return S.trys.push([0,5,,6]),[4,a.default.request({url:"".concat(g.default.restBaseUrl,
"portals/self/jobs/").concat(P)})];case 1:return R=S.sent(),"submitted"!==R.status?[3,3]:[4,(0,b.timeout)(1E3)];case 2:return S.sent(),[2,c(P)];case 3:if("succeeded"===R.status||"failed"===R.status)return[2,R];S.label=4;case 4:return[3,6];case 5:return S.sent(),[3,6];case 6:return[2]}})})}function d(P,R,S){return p.__awaiter(this,void 0,void 0,function(){var T,E,I;return p.__generator(this,function(F){switch(F.label){case 0:if(null===P||void 0===P||!P.length)return[2,!0];T=P.splice(0,1)[0];return[4,
r(T)];case 1:return E=F.sent(),E.length?[4,l(E,R,T,0,E.length,S)]:[2,d(P,R)];case 2:return(I=F.sent())?[2,d(P,R)]:[2,!1]}})})}function l(P,R,S,T,E,I){return p.__awaiter(this,void 0,void 0,function(){var F,D;return p.__generator(this,function(C){switch(C.label){case 0:if(null===P||void 0===P||!P.length)return[2,!0];F=P.splice(0,1)[0];return[4,h(F,R,S)];case 1:return(D=C.sent())?(T++,null===I||void 0===I?void 0:I(T,E),[2,l(P,R,S,T,E,I)]):[2,!1]}})})}function h(P,R,S){return p.__awaiter(this,void 0,
void 0,function(){var T,E;return p.__generator(this,function(I){switch(I.label){case 0:return I.trys.push([0,2,,4]),[4,a.default.request({url:"".concat(g.default.restBaseUrl,"community/groups/").concat(P.id,"/reassign"),content:{targetUsername:R}},{usePost:!0})];case 1:return I.sent(),[2,!0];case 2:return T=I.sent(),"COM_0046"!==(null===T||void 0===T?void 0:T.messageCode)?[2,!1]:(E=f(P,S))?[4,(0,b.timeout)(1E3)]:[2,!1];case 3:return I.sent(),[2,h(P,R,S)];case 4:return[2]}})})}function f(P,R){return p.__awaiter(this,
void 0,void 0,function(){var S,T;return p.__generator(this,function(E){switch(E.label){case 0:return E.trys.push([0,2,,3]),S="(".concat(R,")"),T="".concat(P.title," ").concat(P.title.includes(S)?"(1)":S),[4,a.default.request({url:"".concat(g.default.restBaseUrl,"community/groups/").concat(P.id,"/update"),content:{title:T}},{usePost:!0})];case 1:return E.sent(),P.title=T,[2,!0];case 2:return E.sent(),[2,!1];case 3:return[2]}})})}function r(P){return p.__awaiter(this,void 0,void 0,function(){var R;
return p.__generator(this,function(S){switch(S.label){case 0:return S.trys.push([0,2,,3]),[4,n.default.fetchAllResources("".concat(g.default.restBaseUrl,"community/groups"),{q:"owner:".concat(P),sortField:"title",sortOrder:"asc"})];case 1:return R=S.sent(),[2,R];case 2:return S.sent(),[2,[]];case 3:return[2]}})})}function q(P){return p.__awaiter(this,void 0,void 0,function(){var R;return p.__generator(this,function(S){switch(S.label){case 0:return S.trys.push([0,2,,3]),[4,n.default.fetchAllResources("".concat(g.default.restBaseUrl,
"community/users/").concat(P,"/provisionedListings"),{includeExpired:!0},"provisionedListings")];case 1:return R=S.sent(),[2,R];case 2:return S.sent(),[2,[]];case 3:return[2]}})})}function t(P){return p.__awaiter(this,void 0,void 0,function(){var R;return p.__generator(this,function(S){switch(S.label){case 0:return S.trys.push([0,2,,3]),[4,n.default.fetchAllResources("".concat(g.default.restBaseUrl,"content/users/").concat(P),{foldersContent:!0,inRecycleBin:!0,sortField:"modified",sortOrder:"asc"},
"items")];case 1:return R=S.sent(),[2,R];case 2:return S.sent(),[3,3];case 3:return[2]}})})}function w(P){return p.__awaiter(this,void 0,void 0,function(){var R;return p.__generator(this,function(S){switch(S.label){case 0:return S.trys.push([0,2,,3]),[4,n.default.fetchAllResources("".concat(g.default.restBaseUrl,"community/users/").concat(P,"/appBundles"),{num:10},"appBundles")];case 1:return R=S.sent(),[2,R];case 2:return S.sent(),[2,[]];case 3:return[2]}})})}function u(P,R){return p.__awaiter(this,
void 0,void 0,function(){var S;return p.__generator(this,function(T){switch(T.label){case 0:if(null===P||void 0===P||!P.length)return[2,!0];S=P.splice(0,1)[0];return[4,v(S,R)];case 1:return T.sent(),[2,u(P)]}})})}function v(P,R){return p.__awaiter(this,void 0,void 0,function(){var S,T,E,I,F,D;return p.__generator(this,function(C){switch(C.label){case 0:return[4,q(P)];case 1:return S=C.sent(),[4,w(P)];case 2:T=C.sent();if(!((null===S||void 0===S?0:S.length)||(null===T||void 0===T?0:T.length)))return[2,
!0];E=S.length;I=E+T.length;return[4,B(S,{suppressCustomerEmail:!0,userEntitlements:JSON.stringify({users:[P],entitlements:[]})},function(y){return"".concat(g.default.restBaseUrl,"content/listings/").concat(y.itemId,"/provisionUserEntitlements")},0,I,R)];case 3:return F=C.sent(),[4,B(T,{users:[P],revoke:!0},function(y){return"".concat(g.default.restBaseUrl,"/content/listings/").concat(y.id,"/provisionUserAppBundle")},E,I,R)];case 4:return D=C.sent(),[2,F&&D]}})})}function x(P,R,S,T){void 0===S&&(S=
0);return p.__awaiter(this,void 0,void 0,function(){var E,I,F;return p.__generator(this,function(D){switch(D.label){case 0:if(null===P||void 0===P||!P.length)return[2,!0];E=P.splice(0,1)[0];return[4,t(E)];case 1:return I=D.sent(),[4,z(I,E)];case 2:F=D.sent();if(!F)return[2,!1];S++;null===T||void 0===T?void 0:T(S,R);return[2,x(P,R,S,T)]}})})}function z(P,R){return p.__awaiter(this,void 0,void 0,function(){var S;return p.__generator(this,function(T){switch(T.label){case 0:if(null===P||void 0===P||!P.length)return[2,
!0];S=P.splice(0,100);return[4,A(S,R)];case 1:return T.sent(),[2,z(P,R)]}})})}function A(P,R,S){void 0===S&&(S=1);return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(T){switch(T.label){case 0:return T.trys.push([0,2,,3]),[4,a.default.request({url:"".concat(g.default.restBaseUrl,"content/users/").concat(R,"/deleteItems"),content:{items:P.map(function(E){return E.id}).join(","),permanentDelete:!0}},{usePost:!0})];case 1:return T.sent(),[2,!0];case 2:return T.sent(),3>=
S?[2,A(P,R,S+1)]:[2,!1];case 3:return[2]}})})}function B(P,R,S,T,E,I){void 0===T&&(T=0);return p.__awaiter(this,void 0,void 0,function(){var F;return p.__generator(this,function(D){switch(D.label){case 0:if(null===P||void 0===P||!P.length)return[2,!0];F=P.splice(0,1)[0];D.label=1;case 1:return D.trys.push([1,3,,4]),[4,a.default.request({url:S(F),content:R},{usePost:!0})];case 2:return D.sent(),T++,null===I||void 0===I?void 0:I(T,E),[2,B(P,R,S,T,E,I)];case 3:return D.sent(),[2,!1];case 4:return[2]}})})}
function J(P,R){return p.__awaiter(this,void 0,void 0,function(){var S,T,E,I,F;return p.__generator(this,function(D){switch(D.label){case 0:if(null===P||void 0===P||!P.length)return[2,{success:!0}];S=P.splice(0,1)[0];D.label=1;case 1:return D.trys.push([1,3,,4]),[4,a.default.request({url:"".concat(g.default.restBaseUrl,"community/users/").concat(S,"/delete")},{usePost:!0})];case 2:return T=D.sent(),(E=R(T,S))?[2,{error:E}]:[2,J(P,R)];case 3:return I=D.sent(),F=R(I,S),[2,{error:F}];case 4:return[2]}})})}
Object.defineProperty(K,"__esModule",{value:!0});K.disableUsersEsriAccess=K.disableEsriAccess=K.deleteUsers=K.deleteUser=K.postRequestsSerially=K.deleteItemsWithRetries=K.permanentlyDeleteItems=K.emptyUsersRecycleBins=K.revokeAllLicenses=K.revokeUsersLicenses=K.getUserAppBundles=K.getAllRecycleItems=K.getAllProvisionedListings=K.getAllUserGroups=K.reassignGroupsAndRenameIfNeeded=K.reassignUsersGroups=K.checkJobStatus=K.reassignUsersContent=K.getUser=void 0;a=p.__importDefault(a);g=p.__importDefault(g);
m=p.__importDefault(m);n=p.__importDefault(n);K.getUser=function(P,R){return p.__awaiter(this,void 0,void 0,function(){var S;return p.__generator(this,function(T){switch(T.label){case 0:return T.trys.push([0,2,,3]),[4,a.default.request({url:"".concat(g.default.restBaseUrl,"community/users/").concat(P,"/")})];case 1:return S=T.sent(),[2,new m.default(p.__assign(p.__assign({},S),{portal:R}))];case 2:return T.sent(),[3,3];case 3:return[2]}})})};K.reassignUsersContent=function(P){return p.__awaiter(this,
void 0,void 0,function(){var R,S;return p.__generator(this,function(T){switch(T.label){case 0:return T.trys.push([0,2,,3]),[4,a.default.request({url:"".concat(g.default.restBaseUrl,"portals/self/reassignUsersContent"),content:{reassign:JSON.stringify(P)}},{usePost:!0})];case 1:return R=T.sent(),[2,R];case 2:return S=T.sent(),[2,S];case 3:return[2]}})})};K.checkJobStatus=c;K.reassignUsersGroups=d;K.reassignGroupsAndRenameIfNeeded=l;K.getAllUserGroups=r;K.getAllProvisionedListings=q;K.getAllRecycleItems=
t;K.getUserAppBundles=w;K.revokeUsersLicenses=u;K.revokeAllLicenses=v;K.emptyUsersRecycleBins=x;K.permanentlyDeleteItems=z;K.deleteItemsWithRetries=A;K.postRequestsSerially=B;K.deleteUser=function(P){return p.__awaiter(this,void 0,void 0,function(){var R,S;return p.__generator(this,function(T){switch(T.label){case 0:return T.trys.push([0,2,,3]),[4,a.default.request({url:"".concat(g.default.restBaseUrl,"community/users/").concat(P,"/delete")},{usePost:!0})];case 1:return R=T.sent(),[2,R];case 2:return S=
T.sent(),[2,S];case 3:return[2]}})})};K.deleteUsers=J;K.disableEsriAccess=function(P){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(R){switch(R.label){case 0:return R.trys.push([0,2,,3]),[4,a.default.request({url:"".concat(g.default.restBaseUrl,"community/users/").concat(P,"/update"),content:{userType:"arcgisonly"}},{usePost:!0})];case 1:return R.sent(),[3,3];case 2:return R.sent(),[3,3];case 3:return[2]}})})};K.disableUsersEsriAccess=function(P){return p.__awaiter(this,
void 0,void 0,function(){return p.__generator(this,function(R){switch(R.label){case 0:return[4,B(P,{userType:"arcgisonly"},function(S){return"".concat(g.default.restBaseUrl,"community/users/").concat(S,"/update")})];case 1:return[2,R.sent()]}})})}})},"arcgisonline/pages/utils/dropdown":function(){define(["require","exports","tslib","calcite-web/js/calcite-web","dojo/query"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",{value:!0});K.dropdown=void 0;a=p.__importDefault(a);g=p.__importDefault(g);
K.dropdown=function(){a.default.dropdown();(0,g.default)(".dropdown-link").on("mouseover",function(m){var n;null===(n=m.target)||void 0===n?void 0:n.focus()})}})},"arcgisonline/pages/components/SearchFeedback":function(){define("require exports tslib preact dojo/i18n!../../nls/arcgisonline preact/hooks".split(" "),function(e,K,p,a,g,m){Object.defineProperty(K,"__esModule",{value:!0});K.SearchFeedback=void 0;g=p.__importDefault(g);K.SearchFeedback=function(n){var b=n.telemetry,c=n.searchTerm,d=n.page,
l=n.onlyOrg,h=n.section,f=n.enriched,r=n.onSubmit,q=(0,m.useState)(1);n=q[0];var t=q[1];q=(0,m.useState)({dontSee:!1,irrelevant:!1,filters:!1,notEnoughInfo:!1});var w=q[0],u=q[1];l="".concat(h," ").concat(l?"org only":"all");h=(0,m.useState)("");var v=h[0],x=h[1],z={category:"search result page feedback ".concat(1===n?"1":"2"),pageName:l,statusCode:f?"enriched":"not enriched",pageUrl:window.location.href,number:Math.ceil(d.start/d.num),searchquery:c};return(0,a.h)("div",null,1===n&&(0,a.h)("div",
{class:"leader-1 trailer-1 panel panel-white padding-leader-1 padding-trailer-1 padding-left-1 padding-right-1 flex flex-center"},(0,a.h)("div",{class:"flex-1"},(0,a.h)("h4",{class:"font-size-0 text-black avenir-demi trailer-quarter"},g.default.searchFeedback.areTheseResultsHelpful),(0,a.h)("p",{class:"text-off-black font-size--2 trailer-0"},g.default.searchFeedback.helpUsImprove)),(0,a.h)("calcite-button",{"icon-start":"thumbs-up",appearance:"outline",class:"padding-left-1",onClick:function(){b.logEvent(p.__assign(p.__assign({},
z),{label:"yes"}));t(3);r()}},g.default.searchFeedback.helpful),(0,a.h)("calcite-button",{appearance:"outline","icon-start":"thumbs-down",class:"padding-left-1",onClick:function(){b.logEvent(p.__assign(p.__assign({},z),{label:"no"}));t(2)}},g.default.searchFeedback.notHelpful)),2===n&&(0,a.h)("div",{class:"trailer-1 panel panel-white padding-leader-1 padding-trailer-1 padding-left-1 padding-right-1"},(0,a.h)("h4",{class:"font-size-0 text-black avenir-demi trailer-0"},g.default.searchFeedback.whatMakes),
(0,a.h)("p",{class:"text-off-black font-size--2 trailer-half"},g.default.searchFeedback.selectAllThatApply),Object.keys(w).map(function(A){return(0,a.h)("calcite-chip",{class:"margin-right-half trailer-half",value:A,appearance:w[A]?"solid":"outline",kind:w[A]?"brand":"neutral",onClick:function(){var B;u(p.__assign(p.__assign({},w),(B={},B[A]=!w[A],B)))}},g.default.searchFeedback[A])}),(0,a.h)("div",{class:"leader-1"},(0,a.h)("calcite-label",null,(0,a.h)("span",{class:"display-block padding-trailer-half"},
g.default.searchFeedback.tellUsMore),(0,a.h)("calcite-input",{type:"textarea",maxLength:250,oncalciteInputInput:function(A){return x(A.target.value)}})),(0,a.h)("div",{class:"flex flex-end trailer-1"},(0,a.h)("span",{class:"font-size--2 text-darker-gray"},v.length," / ",250))),(0,a.h)("div",{class:"flex flex-end"},(0,a.h)("calcite-button",{appearance:"outline",kind:"brand",onClick:function(){t(3);r()},class:"margin-right-quarter"},g.default.searchFeedback.close),(0,a.h)("calcite-button",{appearance:"solid",
kind:"brand",onClick:function(){t(3);Object.keys(w).filter(function(A){return w[A]}).forEach(function(A){b.logEvent(p.__assign(p.__assign({},z),{label:A}))});v&&b.logEvent(p.__assign(p.__assign({},z),{details:v,label:"other"}));r()}},g.default.searchFeedback.sendFeedback))),3===n&&(0,a.h)("calcite-alert",{label:g.default.searchFeedback.thankYou,open:!0,kind:"success",icon:"check-circle",scale:"m"},(0,a.h)("div",{slot:"title"},g.default.searchFeedback.thankYou)))}})},"arcgisonline/pages/utils/search":function(){define(["require",
"exports","tslib","arcgisonline/esriGeowConfig"],function(e,K,p,a){Object.defineProperty(K,"__esModule",{value:!0});K.separateFilterFromQuery=K.semanticSearchEnabled=void 0;a=p.__importDefault(a);K.semanticSearchEnabled=function(g,m){var n;return!!(a.default.semanticSearchEnabled&&(null===(n=null===g||void 0===g?void 0:g.portalProperties)||void 0===n?0:n.semanticSearchEnabled))||m&&!m.orgId};K.separateFilterFromQuery=function(g){var m=/(tags:".+?")/gi;m=null===g||void 0===g?void 0:g.match(m);null===
m||void 0===m?void 0:m.forEach(function(n){g=g.replace(new RegExp(n),"")});return{q:g,filter:(null===m||void 0===m?void 0:m.join(" "))||""}}})},"arcgisonline/pages/dijit/AttributeFieldDetails":function(){define("require exports tslib ../../esriGeowConfig ./DomainOverlay ./InlineEdit ../utils/arrays ../utils/clone ../utils/dom ../utils/icons ../../sharing/util ../../sharing/dijit/dialog/_CreateItemUtilMixin dijit/_TemplatedMixin dijit/_WidgetBase dijit/registry dojo/_base/event dojo/dom-construct dojo/on dojo/topic dojo/Deferred dojo/dom-form esri/Evented esri/layers/CodedValueDomain esri/layers/RangeDomain dojo/i18n!../../nls/arcgisonline dojo/text!./AttributeFieldDetails/templates/AttributeFieldDetails.html ../../tsutils/declareDecorator".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);return function(){function T(E,I){this.templateString=R.default;this.i18n=P.default;this.icons=d.default;this.fieldValueTypeList={fieldValueType:[{title:"nameOrTitle"},{title:"description"},{title:"typeOrCategory"},{title:"countOrAmount"},{title:"percentageOrRatio"},{title:"measurement"},{title:"currency"},{title:"uniqueIdentifier"},{title:"phoneNumber"},{title:"emailAddress"},{title:"orderedOrRanked"},
{title:"binary"},{title:"locationOrPlaceName"},{title:"coordinate"},{title:"dateAndTime"},{title:"none"}]};this.systemGeneratedFields=[]}T.prototype.startup=function(E,I,F,D){this.inherited(arguments);this.item=E;this.layer=I;this.layerInfos=D;this.clickedFieldName=F;this.currentSettingsField=null;this.updateAttributeView=!1;this.descriptionDocUrl=a.default.self?a.default.self.helpBase+a.default.self.helpMap.m["120001692"]:"";this.fieldValueTypeText.innerHTML="".concat(this.i18n.attributeFieldDetails.fieldValueType,
"\x3ca href\x3d").concat(this.descriptionDocUrl,' target\x3d"_blank" title\x3d"').concat(this.i18n.common.help,'"\x3e\x3ci class\x3d"icon-ui-question margin-left-half font-size--1"\x3e\x3c/i\x3e\x3c/a\x3e');this.initUI()};T.prototype.initUI=function(){this.displayValuesInTable();this.displayIndexValuesInTable();this.addEventListeners()};T.prototype.addEventListeners=function(){var E=this;this.own((0,u.default)(this.domNode.querySelector(".js-close-attribute-details"),"click",function(I){t.default.stop(I);
v.default.publish("attributeFieldDetails/closeDetails",E.updateAttributeView)}),(0,u.default)(this.domNode.querySelector(".js-delete-btn"),"click",function(I){t.default.stop(I);v.default.publish("attributeFieldDetails/deleteField",{name:E.clickedFieldName})}),(0,u.default)(this.domNode.querySelector(".js-domain-btn"),"click",function(I){var F;t.default.stop(I);(null===(F=E.currentSettingsField)||void 0===F?0:F.hasIndex)?v.default.publish("alert/show",{type:"error",text:P.default.attributeFieldDetails.codedValueOnUniqueIndexMessage}):
(new g.default({item:E.item,layer:E.layer,clickedFieldName:E.clickedFieldName,domainType:"Coded"},w.default.place(w.default.create("div"),document.body,"last"))).open()}),(0,u.default)(this.domNode.querySelector(".js-domain-edit"),"click",function(I){t.default.stop(I);(new g.default({item:E.item,layer:E.layer,clickedFieldName:E.clickedFieldName,domainType:"Coded"},w.default.place(w.default.create("div"),document.body,"last"))).open()}),(0,u.default)(this.domNode.querySelector(".js-range-domain-edit"),
"click",function(I){t.default.stop(I);I={item:E.item,layer:E.layer,clickedFieldName:E.clickedFieldName,domainType:"Range"};var F=document.createElement("div");document.body.appendChild(F);(new g.default(I,F)).open()}),v.default.subscribe("domainOverlay/updateDomain",this.displayDomainValues.bind(this)),(0,u.default)(this.domNode.querySelector(".js-index-form"),"change",function(I){t.default.stop(I);I=E.serviceIndexEdit.checked;E.domNode.querySelector(".js-index-form-submit").disabled=E.currentSettingsField.hasIndex&&
!I?!1:!E.currentSettingsField.hasIndex&&I?!1:!0}),(0,u.default)(this.domNode.querySelector(".js-editable-form"),"change",function(I){t.default.stop(I);if(I=E.domNode.querySelector(".js-editable-form-submit"))I.disabled=!1}),(0,u.default)(this.domNode.querySelector(".js-details-reset-btn"),"click",function(I){t.default.stop(I);E.updateStuff(null,"resetToSource").then(function(){E.displayValuesInTable()})}),v.default.subscribe("inlineEdit/submit",function(I){var F=I.prop;delete I.prop;E.updateStuff(I,
F).then(function(){E.showDetailsProperties();v.default.publish("attributeFieldDetails/updateFieldOnlyTable",!0);v.default.publish("inlineEdit/".concat(F,"/done"),I[F])})}));c.default.forEachNode(this.domNode.querySelectorAll(".js-old-inline-edit"),function(I){E.own((0,u.default)(I,"click",function(F){var D,C,y,G;t.default.stop(F);F=F.target.dataset.editId;var L=E.domNode.querySelector("[data-edit-id\x3d'".concat(F,"'].js-inline-edit-form")),O=q.default.findWidgets(L).shift()||(null===(C=null===(D=
L.children)||void 0===D?void 0:D[0])||void 0===C?void 0:C.children[0])&&L.children[0].children[0][0]||(null===(G=null===(y=L.children)||void 0===y?void 0:y[0])||void 0===G?void 0:G.children[0])&&L.children[0][0];c.default.forEachNode(E.domNode.querySelectorAll("[data-edit-id\x3d'".concat(F,"'].js-inline-edit-form")),function(U){U.classList.remove("hide")});c.default.forEachNode(E.domNode.querySelectorAll("[data-edit-id\x3d'".concat(F,"'].js-old-inline-edit")),function(U){U.classList.add("hide")});
O&&O.focus()}))});c.default.forEachNode(this.domNode.querySelectorAll(".js-cancel-inline-edit"),function(I){E.own((0,u.default)(I,"click",function(F){t.default.stop(F);F=(F.target.form||F.target.closest("form").shift()).dataset.editId;E.cancelInlineEdit(F)}))});c.default.forEachNode(this.domNode.querySelectorAll(".js-inline-edit-form"),function(I){E.own((0,u.default)(I,"submit",function(F){t.default.stop(F);F=F.target;var D=z.default.toObject(F),C=F.dataset.editId;(q.default.findWidgets(F)||[]).forEach(function(y){D[C]=
y.get("value")});E.updateStuff(D,C).then(function(){E.displayValuesInTable();E.cancelInlineEdit(C);"serviceIndex"===C&&E.displayIndexValuesInTable()})}))})};T.prototype.updateStuff=function(E,I){var F=this,D,C,y=new x.default,G="".concat(this.item.adminUrl,"/").concat(this.layer.layerId);if("serviceAlias"===I||"description"===I||"fieldValueType"===I||"fieldEditable"===I||"resetToSource"===I){var L={fields:[(0,b.default)(this.currentSettingsField)]};"serviceAlias"===I?L.fields[0].alias=E.serviceAlias:
"fieldEditable"===I?(c.default.forEachNode(this.domNode.querySelectorAll("[data-edit-id\x3d'fieldEditable'].js-inline-edit-form"),function(U){U.classList.add("hide")}),L.fields[0].editable=this.fieldEditableEdit.checked):"resetToSource"===I?L={fields:[{name:this.currentSettingsField.name,isViewOverride:!1}]}:("description"===I?E.fieldValueType=(null===(D=this.currentSettingsField.description)||void 0===D?0:D.fieldValueType)?this.currentSettingsField.description.fieldValueType:"":("fieldValueType"===
I&&"none"===E.fieldValueType&&(E.fieldValueType=""),E.description=(null===(C=this.currentSettingsField.description)||void 0===C?0:C.value)?this.currentSettingsField.description.value:""),L.fields[0].description={value:E.description,fieldValueType:E.fieldValueType});G+="/updateDefinition";D={updateDefinition:JSON.stringify(L),async:!1};l.default.request({url:G,content:D},{usePost:!0}).then(function(){F.item.set("maxAgeCheck",!0);n.default.includes(F.item.typeKeywords,"View Service")&&(F.currentSettingsField.isViewOverride=
!0);"serviceAlias"===I?F.currentSettingsField.alias=E.serviceAlias:"fieldEditable"===I?F.currentSettingsField.editable=F.fieldEditableEdit.checked:"resetToSource"===I?F.currentSettingsField.isViewOverride=!1:(F.currentSettingsField.description={value:E.description,fieldValueType:E.fieldValueType},F.showHideDescriptionAndFieldValueType());F.updateAttributeView=!0;"serviceAlias"===I||"fieldEditable"===I?F.updatePopupData().then(function(){y.resolve()},function(U){y.reject(U)}):"resetToSource"===I?l.default.request({url:F.layer.url}).then(function(U){for(var M=
0;M<U.fields.length;M++){var Q=U.fields[M];if(Q.name===F.currentSettingsField.name){F.currentSettingsField.alias=Q.alias;F.currentSettingsField.editable=Q.editable;if(Q.domain&&"codedValue"===Q.domain.type){var Y=new B.default;Y.type="codedValue";Y.name=Q.domain.name;Y.codedValues=[];for(var fa=0;fa<Q.domain.codedValues.length;fa++)Y.codedValues.push({code:Q.domain.codedValues[fa].code,name:Q.domain.codedValues[fa].name});F.currentSettingsField.domain=Y}else Q.domain&&"range"===Q.domain.type?(Y=new J.default,
Y.type="range",Y.name=Q.domain.name,Y.minValue=Number(Q.domain.range[0]),Y.maxValue=Number(Q.domain.range[1]),F.currentSettingsField.domain=Y):F.currentSettingsField.domain=Q.domain;F.currentSettingsField.description=F.getDescription(Q.description);F.titleEdit.updateValue(F.currentSettingsField.alias||F.currentSettingsField.name);F.descriptionSection.updateValue(F.currentSettingsField.description&&F.currentSettingsField.description.value||"");F.fieldValueTypeSection.updateValue(F.currentSettingsField.description&&
F.currentSettingsField.description.fieldValueType||"");v.default.publish("attributeFieldDetails/updateFieldOnlyTable",!0);F.updateAttributeView=!0;F.updatePopupData().then(function(){y.resolve()},function(va){y.reject(va)})}}},function(U){y.reject(U)}):y.resolve()},function(U){y.reject(U)})}else if("serviceIndex"===I){c.default.forEachNode(this.domNode.querySelectorAll("[data-edit-id\x3d'serviceIndex'].js-inline-edit-form"),function(U){U.classList.add("hide")});var O=this.serviceIndexEdit.checked;
this.serviceIndex.innerHTML=O?this.i18n.itemProperties.createUniqueIndex:this.i18n.itemProperties.deleteUniqueIndex;G=this.generateIndexJsonParameters(O);this.buildOrDeleteIndex(O,G).then(function(){setTimeout(function(){F.item.set("maxAgeCheck",!0);v.default.publish("alert/show",{type:"success",text:F.i18n.itemProperties.createindexSuccess});F.currentSettingsField.hasIndex=O;y.resolve()},1E3)},function(U){setTimeout(function(){v.default.publish("alert/show",{type:"error",text:F.i18n.itemProperties.error.indexFailure});
y.resolve()},1E3)})}return y};T.prototype.getDescription=function(E){return E?(E=JSON.parse(E),{value:E.value||"",fieldValueType:E.fieldValueType||""}):{value:"",fieldValueType:""}};T.prototype.buildOrDeleteIndex=function(E,I){var F=this,D=new x.default,C="".concat(this.item.adminUrl,"/").concat(this.layer.layerId);this.item.portal.isPortal?(E?(C+="/addToDefinition",E={addToDefinition:JSON.stringify(I),async:!1}):(C+="/deleteFromDefinition",E={deleteFromDefinition:JSON.stringify(I),async:!1}),l.default.request({url:C,
content:E},{usePost:!0}).then(function(){F.tab.page.refreshServiceInfo().then(function(){var y;null===(y=F.tab._createLayer)||void 0===y?void 0:y.call(F.tab,F.item,F.layer.layerId).then(function(G){G.layer.indexes&&(F.layer.indexes=G.layer.indexes)});D.resolve()})},function(y){D.reject(y)})):(E?(C+="/addToDefinition",E={addToDefinition:JSON.stringify(I),async:!0}):(C+="/deleteFromDefinition",E={deleteFromDefinition:JSON.stringify(I),async:!0}),l.default.request({url:C,content:E},{usePost:!0}).then(this.checkStatus.bind(this),
function(y){D.reject(y)}).then(function(y){F.tab.page.refreshServiceInfo().then(function(){var G;F.item=F.tab.page._item;null===(G=F.tab._createLayer)||void 0===G?void 0:G.call(F.tab,F.item,F.layer.layerId).then(function(L){L.layer.indexes&&(F.layer.indexes=L.layer.indexes)});D.resolve(y)})}));return D};T.prototype.checkStatus=function(E,I,F){var D=this,C=(null===E||void 0===E?void 0:E.statusURL)||(null===E||void 0===E?void 0:E.statusUrl),y=F||new x.default,G=I||500;l.default.request({url:C}).then(function(L){var O,
U;L=L||{status:"completed"};"completed"===(null===(O=L.status)||void 0===O?void 0:O.toLowerCase())?y.resolve(!0):"failed"===(null===(U=L.status)||void 0===U?void 0:U.toLowerCase())||400<L.code||""===L.status?(D.handleStatusError(),y.reject(L)):(G=(G||500)+250,setTimeout(function(){D.checkStatus(E,G,y)},I))},function(L){setTimeout(function(){D.handleStatusError();y.reject(L)},1E3)});return y};T.prototype.handleStatusError=function(){v.default.publish("alert/show",{type:"error",text:this.i18n.itemProperties.error.indexFailure});
this.displayIndexValuesInTable();this.cancelInlineEdit("serviceIndex")};T.prototype.generateIndexJsonParameters=function(E){var I=this.currentSettingsField,F=this.layer.indexes,D={indexes:[]},C={};if(E)C.fields=I.name,C.isUnique=!0,C.description="Field properties";else for(E=0;E<F.length;E++){if(F[E].fields===I.name){C.name=F[E].name;break}E!==F.length-1||C.name||(C.description="Field properties")}D.indexes[0]=C;return D};T.prototype.showHideDescriptionAndFieldValueType=function(){if(this.currentSettingsField.description){var E=
this.domNode.querySelector(".js-fieldDescription"),I=this.domNode.querySelector(".js-noFieldDescription"),F=this.domNode.querySelector(".js-fieldValueType"),D=this.domNode.querySelector(".js-noFieldValueType");this.currentSettingsField.description.value?(null===E||void 0===E?void 0:E.classList.remove("hide"),null===I||void 0===I?void 0:I.classList.add("hide")):(null===I||void 0===I?void 0:I.classList.remove("hide"),null===E||void 0===E?void 0:E.classList.add("hide"));this.currentSettingsField.description.fieldValueType?
(null===F||void 0===F?void 0:F.classList.remove("hide"),null===D||void 0===D?void 0:D.classList.add("hide")):(null===D||void 0===D?void 0:D.classList.remove("hide"),null===F||void 0===F?void 0:F.classList.add("hide"))}};T.prototype.showDetailsProperties=function(){if(this.item.isHostedService&&(this.item.isAdmin||this.item.isOwner)&&n.default.includes(this.item.typeKeywords,"View Service")){var E=this.domNode.querySelector(".js-details-reset-btn");c.default.forEachNode(this.domNode.querySelectorAll(".js-details-properties"),
function(I){I.classList.remove("hide")});this.currentSettingsField.isViewOverride?(null===E||void 0===E?void 0:E.classList.remove("hide"),this.detailsProperties.innerHTML=P.default.attributeFieldDetails.overridden,this.detailsPropertiesInfo.setAttribute("aria-label",P.default.attributeFieldDetails.overriddenMessage)):(null===E||void 0===E?void 0:E.classList.add("hide"),this.detailsProperties.innerHTML=P.default.attributeFieldDetails.inherited,this.detailsPropertiesInfo.setAttribute("aria-label",P.default.attributeFieldDetails.inheritedMessage))}};
T.prototype.displayValuesInTable=function(){var E=this;this.currentSettingsField=n.default.find(this.layer.fields,function(F){return F.name===E.clickedFieldName});this.showHideDescriptionAndFieldValueType();if(!this.titleEdit){var I=this.currentSettingsField.alias||this.clickedFieldName;this.titleEdit=new m.default({prop:"serviceAlias",value:I,required:!0,pattern:"^[^\x3c|\x3e]+$",emptyText:P.default.itemProperties.error.needTitle,invalidText:P.default.itemProperties.error.badCharacter,inputClass:"input-minimal flex-1 font-size-3",
inputLabel:P.default.itemProperties.editFieldLabel.replace("${fieldName}",I),titleClass:"font-size-3 trailer-0",titleId:"attributeTitle",editButtonClasses:"btn-link-darker-gray focus-inset field-admin-owner-view js-portal-view",cancelButtonClasses:"btn btn-transparent",saveButtonClasses:"btn",showLoader:l.default.isPortal()},w.default.create("div",{},this.domNode.querySelector(".js-attribute-title-edit")))}this.setupAllStuff();this.showDetailsProperties();this.serviceNullable.innerHTML=this.currentSettingsField.nullable?
P.default.attributeFieldDetails.commonYes:P.default.attributeFieldDetails.commonNo;this.fieldEditable.innerHTML=this.currentSettingsField.editable?P.default.attributeFieldDetails.commonYes:P.default.attributeFieldDetails.commonNo;this.serviceDefaultValue.innerHTML=this.getDefaultValue(this.currentSettingsField);this.serviceLength.innerHTML=this.currentSettingsField.length?this.currentSettingsField.length:P.default.attributeFieldDetails.none;this.rangeMinMax.innerHTML=P.default.attributeFieldDetails.none;
this.detailsType.innerHTML=this.getFieldType(this.currentSettingsField.type);this.detailsName.innerHTML=this.currentSettingsField.name;this.currentSettingsField.domain&&this.displayDomainValues()};T.prototype.getDefaultValue=function(E){return E.defaultValue||0===E.defaultValue?"esriFieldTypeDate"===E.type?new Date(E.defaultValue):E.defaultValue:P.default.attributeFieldDetails.none};T.prototype.getFieldType=function(E){E=E||this.i18n.attributesView.commonUndefined;return this.i18n.attributesView.fieldTypes[E]||
E};T.prototype.displayIndexValuesInTable=function(){var E=this;this.domNode.querySelector(".js-index-form-submit").disabled=!0;this.currentSettingsField&&void 0===this.currentSettingsField.hasIndex&&(this.currentSettingsField.hasIndex=!1,this.currentSettingsField.hasIndex=!!n.default.find(this.layer.indexes,function(I){return I.fields===E.clickedFieldName&&I.isUnique}));this.serviceIndex.innerHTML=this.currentSettingsField.hasIndex?P.default.attributeFieldDetails.commonYes:P.default.attributeFieldDetails.commonNo;
this.serviceIndexEdit.checked=this.currentSettingsField.hasIndex};T.prototype.setupAllStuff=function(){var E,I;this.setupDescriptionAndFieldValueType();if(this.layer.geometryProperties){var F=p.__rest(this.layer.geometryProperties,["units"]);this.systemGeneratedFields=Object.values(F)}this.currentSettingsField.canDeleteField||(null===(E=this.domNode.querySelector(".js-delete-btn"))||void 0===E?void 0:E.classList.add("hide"));E=this.domNode.querySelector("[data-edit-id\x3d'serviceIndex'].js-old-inline-edit");
this.currentSettingsField.canDeleteField?null===E||void 0===E?void 0:E.classList.remove("hide"):null===E||void 0===E?void 0:E.classList.add("hide");E=this.domNode.querySelector("[data-edit-id\x3d'fieldEditable'].js-old-inline-edit");this.currentSettingsField.canFieldEditableProp?(null===E||void 0===E?void 0:E.classList.remove("hide"),this.fieldEditableEdit.checked=this.currentSettingsField.editable):null===E||void 0===E?void 0:E.classList.add("hide");E=this.domNode.querySelector("[data-edit-id\x3d'rangeMinMax'].js-range-domain-edit");
if(null===(I=this.systemGeneratedFields)||void 0===I?0:I.includes(this.currentSettingsField.name))null===E||void 0===E?void 0:E.classList.add("hide");this.setupDomains()};T.prototype.setupDescriptionAndFieldValueType=function(){var E;this.layer.supportsFieldDescription?(this.descriptionSection=new m.default({inputType:"textArea",rows:4,maxLength:500,inputLabel:this.i18n.attributeFieldDetails.editDescription,prop:"description",editButtonUpdatePermissionClasses:"field-admin-owner-view js-portal-view",
value:this.currentSettingsField.description&&this.currentSettingsField.description.value||"",pattern:"^[^\x3c\x3e]*$",invalidText:this.i18n.itemProperties.error.badCharacterSnippet,showCharactersLeft:!0,showLoader:l.default.isPortal()},this.domNode.querySelector(".js-description-section")),this.fieldValueTypeSection=new m.default({inputType:"fieldValueType",inputLabel:this.i18n.attributeFieldDetails.editFieldValueType,editButtonUpdatePermissionClasses:"field-admin-owner-view js-portal-view",prop:"fieldValueType",
value:(null===(E=this.currentSettingsField.description)||void 0===E?void 0:E.fieldValueType)||"",fieldValueTypeList:this.fieldValueTypeList,showLoader:l.default.isPortal()},this.domNode.querySelector(".js-fieldValueType-section"))):c.default.forEachNode(this.domNode.querySelectorAll(".js-description-section, .js-fieldValueType-section"),function(I){I.classList.add("hide")})};T.prototype.setupDomains=function(){var E,I;if(this.ifShowDomainEditingButtons()){var F=this.currentSettingsField.type;/string|integer|double|single/g.test(F.toLowerCase())&&
(null===(E=this.domNode.querySelector(".js-domain-btn"))||void 0===E?void 0:E.classList.remove("hide"));/integer|double|single/g.test(F.toLowerCase())&&(null===(I=this.domNode.querySelector(".js-range-field-details"))||void 0===I?void 0:I.classList.remove("hide"))}};T.prototype.ifShowDomainEditingButtons=function(){return this.currentSettingsField.canDeleteField&&!n.default.includes(this.item.typeKeywords,"Spatiotemporal")};T.prototype.displayDomainValues=function(){var E,I,F;if(this.currentSettingsField.domain&&
"range"===this.currentSettingsField.domain.type)c.default.forEachNode(this.domNode.querySelectorAll(".js-domain-btn, .js-coded-value-field-details"),function(C){C.classList.add("hide")}),null===(E=this.domNode.querySelector(".js-range-field-details"))||void 0===E?void 0:E.classList.remove("hide"),this.rangeMinMax.innerHTML=this.currentSettingsField.domain.minValue+" - "+this.currentSettingsField.domain.maxValue;else if(this.currentSettingsField.domain&&"codedValue"===this.currentSettingsField.domain.type){c.default.forEachNode(this.domNode.querySelectorAll(".js-domain-btn, .js-range-field-details"),
function(C){C.classList.add("hide")});null===(I=this.domNode.querySelector(".js-coded-value-field-details"))||void 0===I?void 0:I.classList.remove("hide");this.codedValueDomainText.innerHTML="".concat(P.default.attributeFieldDetails.codedValueDomain," \x3csmall\x3e").concat(P.default.attributeFieldDetails.domainSmall,"\x3c/small\x3e");for(var D=this.domNode.querySelector(".js-coded-value-table");0<D.rows.length;)D.deleteRow(0);this.currentSettingsField.domain.codedValues.forEach(function(C){D.insertRow(D.rows.length).insertCell(0).innerHTML=
C.name})}else this.currentSettingsField.domain||(null===(F=this.domNode.querySelector(".js-coded-value-field-details"))||void 0===F?void 0:F.classList.add("hide"),this.rangeMinMax.innerHTML=P.default.attributeFieldDetails.none,this.setupDomains())};T.prototype.cancelInlineEdit=function(E){E?(c.default.forEachNode(this.domNode.querySelectorAll("[data-edit-id\x3d'".concat(E,"'].js-inline-edit-form")),function(I){I.classList.add("hide")}),c.default.forEachNode(this.domNode.querySelectorAll("[data-edit-id\x3d'".concat(E,
"'].js-old-inline-edit")),function(I){I.classList.remove("hide")})):(c.default.forEachNode(this.domNode.querySelectorAll(".js-inline-edit-form"),function(I){I.classList.add("hide")}),c.default.forEachNode(this.domNode.querySelectorAll(".js-old-inline-edit"),function(I){I.classList.remove("hide")}))};T.prototype.getPopupInfo=function(){var E=this.layer.id||this.layer.layerId;if(this.layerInfos&&0<this.layerInfos.length)for(var I=0;I<this.layerInfos.length;I++)if(E===this.layerInfos[I].id)return this.layerInfos[I].popupInfo;
return null};T.prototype.updatePopupData=function(){var E=this,I=new x.default,F=this.getPopupInfo();if(F){for(var D=0;D<F.fieldInfos.length;D++)if(F.fieldInfos[D].fieldName===this.currentSettingsField.name){F.fieldInfos[D].label=this.currentSettingsField.alias;F.fieldInfos[D].isEditable=this.currentSettingsField.editable;break}F=this.item;F={owner:F.owner,folderId:F.folderId,id:F.id,text:JSON.stringify({layers:this.layerInfos})};h.default.updateItem(F,this.item.portal).then(function(){E.updateItemData().then(function(){I.resolve()})},
function(C){I.reject(C)})}else I.resolve();return I};T.prototype.updateItemData=function(){var E=this,I=new x.default,F="".concat(this.item.itemUrl,"/data");l.default.request({url:F}).then(function(D){E.item.itemData=D;I.resolve()});return I};return T=p.__decorate([(0,S.default)(r.default,f.default,A.default)],T)}()})},"arcgisonline/pages/dijit/DomainOverlay":function(){define("require exports tslib dijit/registry dojo/_base/event dojo/dom-construct dojo/dom-form dojo/Deferred dojo/on dojo/query dojo/string dojo/topic dojox/uuid/generateRandomUuid ./Overlay ../utils/arrays ../utils/clone ../utils/dom ../utils/formatters ../utils/icons ../../sharing/util dragula/dragula esri/layers/CodedValueDomain esri/layers/RangeDomain dojo/i18n!../../nls/arcgisonline dojo/text!./DomainOverlay/templates/DomainOverlay.html dojo/text!./DomainOverlay/templates/CodedValueTemplate.html dojo/text!./DomainOverlay/templates/_generateOrDelete.html ../../tsutils/declareDecorator".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);var E;(function(I){I.Coded="Coded";I.Range="Range"})(E||(E={}));return function(){function I(F,D){this.overlayContents=l.default.substitute(P.default,{i18n:J.default,icons:v.default},null);this.showActionBar=!0;this.i18n=J.default;this.icons=v.default;this.unsavedChangesText=J.default.domainOverlay.errors.unsavedChangesExplain;this.title=J.default.domainOverlay.domainOverlayTitle;
this.validateInputDomainValue=this.validateInputDomainValue.bind(this)}I.prototype.postMixInProperties=function(){var F=this;this.inherited(arguments);this.domainType=this.domainType||E.Coded;this.currentField=q.default.find(this.layer.fields,function(D){return D.name===F.clickedFieldName});this.domainType===E.Coded?this.title="".concat(J.default.domainOverlay.domainOverlayTitle,": ").concat(this.currentField.alias):this.domainType===E.Range&&(this.title="".concat(J.default.domainOverlay.domainRangeOverlayTitle,
": ").concat(this.currentField.alias))};I.prototype.postCreate=function(){var F=this;m.default.place(l.default.substitute(S.default,{i18n:J.default}),this._overlayActionBar);this.inherited(arguments);this.codedValueCount=0;this.codedValueEvents=[];this.codedValueJson=[];this.submitButton=this._primaryBtn;this.submitButton.disabled=!0;this.disableAddButton(!0);this.setupDomainPage();this.domainType===E.Coded?(0,d.default)(".js-domain-explanation",this.domNode).attr("innerHTML",this.currentField.domain?
"".concat(J.default.domainOverlay.editListPart1,"\x3cbr\x3e\x3cbr\x3e").concat(J.default.domainOverlay.editListPart2):"".concat(J.default.domainOverlay.newEmptyListPart1,"\x3cbr\x3e\x3cbr\x3e").concat(J.default.domainOverlay.newEmptyListPart2)):(0,d.default)(".js-domain-explanation",this.domNode).attr("innerHTML","".concat(this.currentField.domain?J.default.domainOverlay.editRange:J.default.domainOverlay.newRange,"\x3cbr\x3e\x3cbr\x3e").concat(J.default.domainOverlay.rangePart2));var D=w.default.nodeListToArray((0,d.default)(".js-manage-domain-coded-value",
this.domNode));this.drag=(0,z.default)(D,{moves:function(C,y,G){return G.classList.contains("js-template-div")||G.classList.contains("js-template-code-value")||G.classList.contains("js-template-code-key")||G.classList.contains("js-template-code-count")},accepts:function(C,y,G,L){return y===G}});this.drag.on("drop",function(){F.setUnsaved(!0);F.validateInputDomainValue()})};I.prototype.render=function(){var F=this,D,C,y=new b.default;(null===(C=null===(D=this.currentField)||void 0===D?void 0:D.domain)||
void 0===C?0:C.codedValues)?(this.loaderHelper(!0),this.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(function(){F.getUniqueValuesData(F.currentField).then(function(G){for(var L=0;L<F.currentField.domain.codedValues.length;L++)for(var O=F.currentField.domain.codedValues[L].count=0;O<G.uniqueValueInfos.length;O++)if(F.currentField.domain.codedValues[L].code===G.uniqueValueInfos[O].value){F.currentField.domain.codedValues[L].count=G.uniqueValueInfos[O].count;break}F.setupInitialDomainForm();
F.setupCodedValueEvents();F.loaderHelper(!1);F.domNode.querySelector(".js-template-code-value").focus();y.resolve()},function(G){F.loaderHelper(!1);h.default.publish("alert/show",{type:"error",text:J.default.domainOverlay.errors.domainRequestFailed});y.reject()})})):(this.setupInitialDomainForm(),this.setupCodedValueEvents(),this.domainType===E.Coded?setTimeout(function(){F.domNode.querySelector(".js-template-code-value").focus()},300):this.domainType===E.Range&&setTimeout(function(){F.domNode.querySelector(".js-template-range-key").focus()},
300),y.resolve());return y};I.prototype.setupDomainPage=function(){var F,D,C,y;this.domainType===E.Coded?(this.domNode.querySelector(".js-domain-generate-button").innerHTML=J.default.domainOverlay.generateList,this.domNode.querySelector(".js-domain-delete-button").innerHTML=J.default.domainOverlay.deleteList):this.domainType===E.Range&&(this.domNode.querySelector(".js-domain-generate-button").innerHTML=J.default.domainOverlay.generateRange,this.domNode.querySelector(".js-domain-delete-button").innerHTML=
J.default.domainOverlay.deleteRange);("range"===(null===(D=null===(F=this.currentField)||void 0===F?void 0:F.domain)||void 0===D?void 0:D.type)||(null===(C=this.currentField.domain)||void 0===C?0:C.codedValues)||"esriFieldTypeBigInteger"===(null===(y=this.currentField)||void 0===y?void 0:y.type)&&this.domainType===E.Range)&&this.domNode.querySelector(".js-domain-generate-button").classList.add("hide");this.currentField.domain||this.domNode.querySelector(".js-domain-delete-button").classList.add("hide")};
I.prototype.getUniqueValuesData=function(F){return this.layer.statisticsPlugin.getUniqueValues({field:F.name})};I.prototype.getFieldStatisticsData=function(F){return this.layer.statisticsPlugin.getFieldStatistics({field:F.name})};I.prototype._addEventListeners=function(){var F=this;this.inherited(arguments);this.own((0,c.default)(this.domNode.querySelector(".js-domain-generate-button"),"click",function(D){g.default.stop(D);F.loaderHelper(!0);var C=(0,t.default)(F.currentField);F.domNode.querySelector(".js-domain-generate-button").disabled=
!0;F.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(function(){F.domainType===E.Coded?F.getUniqueValuesData(F.currentField).then(function(y){var G;y.uniqueValueInfos.sort(function(O,U){return parseFloat(U.count)-parseFloat(O.count)});var L={name:(null===(G=F.currentField.domain)||void 0===G?0:G.name)?F.currentField.domain.name:"".concat(F.currentField.name,"_Domain"),type:"codedValue",codedValues:[]};for(G=0;G<y.uniqueValueInfos.length;G++)null!==y.uniqueValueInfos[G].value&&void 0!==
y.uniqueValueInfos[G].value&&""!==y.uniqueValueInfos[G].value&&L.codedValues.push({code:y.uniqueValueInfos[G].value,name:y.uniqueValueInfos[G].value,count:y.uniqueValueInfos[G].count||0});C.domain=L;F.setupInitialDomainForm(C);F.setupCodedValueEvents();F.setUnsaved(!0);F.validateInputDomainValue();F.loaderHelper(!1);y.partialData&&h.default.publish("alert/show",{type:"warning",text:l.default.substitute(J.default.domainOverlay.ifPartialDataNote,[y.uniqueValueInfos.length])});0!==y.uniqueValueInfos.length&&
(1!==y.uniqueValueInfos.length||null!==y.uniqueValueInfos[0].value&&""!==y.uniqueValueInfos[0].value)||h.default.publish("alert/show",{type:"warning",text:J.default.domainOverlay.generateListNoValues})},function(y){F.loaderHelper(!1);h.default.publish("alert/show",{type:"error",text:J.default.domainOverlay.errors.domainRequestFailed})}):F.getFieldStatisticsData(F.currentField).then(function(y){var G,L={name:(null===(G=F.currentField.domain)||void 0===G?0:G.name)?F.currentField.domain.name:"".concat(F.currentField.name,
"_Domain"),type:"range",minValue:y.min,maxValue:y.max};C.domain=L;F.setupInitialDomainForm(C);F.setupCodedValueEvents();F.setUnsaved(!0);F.validateInputDomainValue();F.loaderHelper(!1)},function(y){F.loaderHelper(!1);h.default.publish("alert/show",{type:"error",text:J.default.domainOverlay.errors.domainRequestFailed})})})}),(0,c.default)(this.domNode.querySelector(".js-domain-delete-button"),"click",function(D){g.default.stop(D);if(confirm(J.default.domainOverlay.errors.deleteExplain)){F.setUnsaved(!1);
F.loaderHelper(!0);var C={fields:[(0,t.default)(F.currentField)]};C.fields[0].domain=null;D=F.item.adminUrl+"/"+F.layer.layerId+"/updateDefinition";C={updateDefinition:JSON.stringify(C)};x.default.request({url:D,content:C},{usePost:!0}).then(function(){F.item.set("maxAgeCheck",!0);F.currentField.domain=null;h.default.publish("domainOverlay/updateDomain");F.loaderHelper(!1);F.close();h.default.publish("alert/show",{type:"success",text:F.domainType===E.Coded?J.default.domainOverlay.deleteSuccessList:
J.default.domainOverlay.deleteSuccessRange})},function(y){F.loaderHelper(!1);h.default.publish("alert/show",{type:"error",text:J.default.domainOverlay.errors.domainRequestFailed})})}}))};I.prototype.handlePrimary=function(F){var D=this;g.default.stop(F);this.setUnsaved(!1);this.loaderHelper(!0,J.default.domainOverlay.saveLoading);F=this.domNode.querySelector(".js-manage-domain-form");var C=F.dataset.editId,y=n.default.toObject(F);(a.default.findWidgets(F)||[]).forEach(function(O){y[C]=O.get("value")});
var G=this.validateDomainAndReturnDomainObject(y);if(G.error)this.loaderHelper(!1),this.domNode.querySelector(".js-domain-validation-message").classList.add("is-active");else{F="".concat(this.item.adminUrl,"/").concat(this.layer.layerId,"/updateDefinition");var L={updateDefinition:JSON.stringify(G)};x.default.request({url:F,content:L},{usePost:!0}).then(function(){D.item.set("maxAgeCheck",!0);D.currentField.domain={};D.currentField.domain=G.fields[0].domain;h.default.publish("domainOverlay/updateDomain");
D.loaderHelper(!1);D.close();h.default.publish("alert/show",{type:"success",text:D.domainType===E.Coded?J.default.domainOverlay.updateSuccessList:J.default.domainOverlay.updateSuccessRange})},function(O){D.loaderHelper(!1);h.default.publish("alert/show",{type:"error",text:J.default.domainOverlay.errors.domainRequestFailed})})}};I.prototype.getCodedValueTree=function(){var F=this,D=this.domNode.querySelector(".js-manage-domain-coded-value"),C=[];Array.prototype.slice.call(D.children).filter(function(y){return y.classList.contains("js-template-div")}).forEach(function(y){var G=
y.querySelector(".js-template-code-key").value;-1===F.currentField.type.toLowerCase().indexOf("integer")&&-1===F.currentField.type.toLowerCase().indexOf("double")&&-1===F.currentField.type.toLowerCase().indexOf("single")||""===G||null===G||void 0===G||(G=Number(G));y=y.querySelector(".js-template-code-value").value;C.push({key:G,value:y})});return C};I.prototype.validateDomainAndReturnDomainObject=function(F){var D={fields:[(0,t.default)(this.currentField)]},C=null,y=this.getDomainName();if(this.domainType===
E.Coded)for(C=new A.default,C.type="codedValue",C.name=y,C.codedValues=[],F=this.getCodedValueTree(),y=0;y<F.length;y++)C.codedValues.push({code:F[y].key,name:F[y].value});else C=new B.default,C.type="range",C.name=y,C.minValue=Number(F.rangeMinimum),C.maxValue=Number(F.rangeMaximum);D.fields[0].domain=C;return D};I.prototype.getDomainName=function(){var F;return(null===(F=this.currentField.domain)||void 0===F?0:F.name)?this.currentField.domain.name==="".concat(this.currentField.name,"_Domain")?"".concat(this.layer.name,
"_").concat(this.currentField.name,"_").concat((0,f.default)()):this.currentField.domain.name:"".concat(this.layer.name,"_").concat(this.currentField.name,"_").concat((0,f.default)())};I.prototype.setupInitialDomainForm=function(F){var D,C=this.domNode.querySelector(".js-manage-domain-coded-value"),y=F?F:this.currentField;if(null===(D=null===y||void 0===y?void 0:y.domain)||void 0===D?0:D.codedValues){this.domNode.querySelector(".js-coded-value").classList.remove("hide");this.domNode.querySelector(".js-coded-range").classList.add("hide");
for(D=0;D<y.domain.codedValues.length;D++){if(0===D&&1===this.codedValueCount&&F){var G=this.getCodedValueTree();1!==G.length||G[0].key||G[0].value||C.removeChild((0,d.default)(".0",this.domNode).shift())}y.domain.codedValues[D].count="(".concat(y.domain.codedValues[D].count||0,")");C.appendChild(this.codedValueTemplate(D,y.domain.codedValues[D]));this.codedValueCount++}this.disableAddButton(!1)}else"range"===(null===(G=null===y||void 0===y?void 0:y.domain)||void 0===G?void 0:G.type)?(this.domNode.querySelector(".js-template-range-key").value=
y.domain.minValue,this.domNode.querySelector(".js-template-range-value").value=y.domain.maxValue,this.domNode.querySelector(".js-coded-range").classList.remove("hide"),this.domNode.querySelector(".js-coded-value").classList.add("hide")):this.domainType===E.Coded?(this.domNode.querySelector(".js-coded-value").classList.remove("hide"),this.domNode.querySelector(".js-coded-range").classList.add("hide"),C.appendChild(this.codedValueTemplate(this.codedValueCount)),this.codedValueCount++):this.domainType===
E.Range?((0,d.default)(".js-coded-range").removeClass("hide"),(0,d.default)(".js-coded-value").addClass("hide")):((0,d.default)(".js-coded-value").removeClass("hide"),(0,d.default)(".js-coded-range").addClass("hide"));this.checkInitialDuplicates()};I.prototype.setupCodedValueEvents=function(){var F=this;this.codedValueEvents&&((this.codedValueEvents||[]).forEach(function(D){D.remove()}),this.codedValueEvents=[]);this.codedValueEvents=[(0,d.default)(".js-template-delete",this.domNode).on("click",function(D){g.default.stop(D);
F.setUnsaved(!0);var C=F.domNode.querySelector(".js-manage-domain-coded-value");D=(0,d.default)(".".concat(D.currentTarget.name),F.domNode).shift();C.removeChild(D);F.validateInputDomainValue()}),(0,d.default)(".js-btn-add-coded-value",this.domNode).on("click",function(D){g.default.stop(D);F.setUnsaved(!0);F.domNode.querySelector(".js-manage-domain-coded-value").appendChild(F.codedValueTemplate(F.codedValueCount));F.domNode.querySelector("[name\x3d'".concat(F.codedValueCount,"'].js-template-code-value")).focus();
F.codedValueCount++;F.setupCodedValueEvents();F.submitButton.disabled=!0;F.disableAddButton(!0)}),(0,d.default)(this.domNode).on("input",function(D){F.setUnsaved(!0);var C=F.validateInputDomainValue;D.target.classList.contains("js-template-code-key")&&C(D);C=F.validateInputDomainValue;D.target.classList.contains("js-template-code-value")&&C(D);C=F.validateInputDomainValue;D.target.classList.contains("js-template-range-key")&&C(D);C=F.validateInputDomainValue;D.target.classList.contains("js-template-range-value")&&
C(D)})]};I.prototype.validateInputDomainValue=function(F){this.submitButton.disabled=!1;var D=this.domNode.querySelector(".js-manage-domain-form"),C=n.default.toObject(D);if(this.domainType===E.Coded){this.disableAddButton(!0);if(null===F||void 0===F?0:F.target){C=(0,d.default)(F.target).closest(".js-template-div").shift();D=C.querySelector(".js-domain-coded-error");C=C.querySelector(".js-domain-coded-error-value");var y=this.checkForInvalidKeyType(),G=this.checkForDuplicates(F.target.value,"key");
-1!==F.target.className.indexOf("js-template-code-key")?F.target.value?G?(F.target.classList.add("input-error"),D.innerHTML=J.default.domainOverlay.errors.duplicateCode,D.classList.add("is-active"),this.submitButton.disabled=!0):y.invalidType?(F.target.classList.add("input-error"),D.innerHTML=y.errorMessage,D.classList.add("is-active"),this.submitButton.disabled=!0):(F.target.classList.remove("input-error"),D.classList.remove("is-active"),this.submitButton.disabled=!1):this.submitButton.disabled=
!0:(D=this.checkForDuplicates(F.target.value,"value"),F.target.value?D?(F.target.classList.add("input-error"),C.innerHTML=J.default.domainOverlay.errors.duplicateCode,C.classList.add("is-active"),this.submitButton.disabled=!0):(F.target.classList.remove("input-error"),C.classList.remove("is-active"),this.submitButton.disabled=!1):this.submitButton.disabled=!0)}if(!this.submitButton.disabled){if(this.checkForGeneralKeyValueDuplicates("key")||this.checkForGeneralKeyValueDuplicates("value")||this.checkForInvalidKeyType().invalidType)this.submitButton.disabled=
!0;F=this.getCodedValueTree();for(D=0;D<F.length;D++)if(!(F[D].key&&F[D].value||0===F[D].key)){this.submitButton.disabled=!0;break}this.submitButton.disabled||(this.disableAddButton(!1),(0,d.default)(".js-template-code-key",this.domNode).removeClass("input-error"),(0,d.default)(".js-template-code-value",this.domNode).removeClass("input-error"),(0,d.default)(".js-domain-coded-error",this.domNode).removeClass("is-active"),(0,d.default)(".js-domain-coded-error-value",this.domNode).removeClass("is-active"))}}else{D=
C.rangeMinimum;C=C.rangeMaximum;if(null===F||void 0===F?0:F.target)y=(0,d.default)(F.target).closest(".js-coded-range-input-wrap").shift().querySelector(".js-domain-range-error"),G=this.checkForRangeDomain(F.target.value),F.target.value?G.invalidDomain?(F.target.classList.add("input-error"),y.innerHTML=G.errorMessage,y.classList.add("is-active"),this.submitButton.disabled=!0):(F.target.classList.remove("input-error"),y.classList.remove("is-active"),this.submitButton.disabled=!1):this.submitButton.disabled=
!0;this.submitButton.disabled||(Number(D)>Number(C)&&(this.submitButton.disabled=!0),this.checkForRangeDomain(D,C).invalidDomain&&(this.submitButton.disabled=!0),D&&C||(this.submitButton.disabled=!0),this.submitButton.disabled||(this.domNode.querySelector(".js-template-range-key").classList.remove("input-error"),this.domNode.querySelector(".js-template-range-value").classList.remove("input-error"),w.default.forEachNode(this.domNode.querySelectorAll(".js-domain-range-error"),function(L){L.classList.remove("is-active")})))}};
I.prototype.checkInitialDuplicates=function(){var F=[];w.default.forEachNode(this.domNode.querySelectorAll(".js-template-code-value"),function(D){-1<F.indexOf(D.value)?(D.classList.add("input-error"),D=D.parentElement.querySelector(".js-domain-coded-error-value"),D.innerHTML=J.default.domainOverlay.errors.duplicateCode,D.classList.add("is-active")):F.push(D.value)})};I.prototype.disableAddButton=function(F){w.default.forEachNode(this.domNode.querySelectorAll(".js-btn-add-coded-value"),function(D){D.disabled=
F})};I.prototype.getKeyOrValueCodedValueTree=function(F){var D=this.domNode.querySelector(".js-manage-domain-coded-value"),C=[];Array.prototype.slice.call(D.children).filter(function(y){return y.classList.contains("js-template-div")}).forEach(function(y){C.push(y.querySelector("value"===F?".js-template-code-value":".js-template-code-key").value)});return C};I.prototype.checkForDuplicates=function(F,D){D=this.getKeyOrValueCodedValueTree(D);D.sort();for(var C=0,y=0;y<D.length;y++)if(D[y]===F){if(0<
C)return!0;C++}return!1};I.prototype.checkForGeneralKeyValueDuplicates=function(F){F=this.getKeyOrValueCodedValueTree(F);F.sort();for(var D=F[0],C=1;C<F.length;C++){if(F[C]===D)return!0;D=F[C]}return!1};I.prototype.checkForInvalidKeyType=function(){for(var F=this.getKeyOrValueCodedValueTree("key"),D=this.currentField.type,C=this.currentField.length?this.currentField.length:null,y=0;y<F.length;y++)if(-1!==D.toLowerCase().indexOf("string")){if(F[y].length>C)return{invalidType:!0,errorMessage:J.default.domainOverlay.errors.stringTooLong}}else if(-1!==
D.toLowerCase().indexOf("integer")){if(!this.isInteger(F[y]))return{invalidType:!0,errorMessage:J.default.domainOverlay.errors.mustBeInteger}}else if(-1!==D.toLowerCase().indexOf("double")||-1!==D.toLowerCase().indexOf("single")){if(isNaN(F[y]))return{invalidType:!0,errorMessage:J.default.domainOverlay.errors.mustBeFloat}}else return{invalidType:!0,errorMessage:J.default.domainOverlay.errors.invalidForCodedDomain};return{invalidType:!1}};I.prototype.checkForRangeDomain=function(F,D){D=D?D:F;var C=
this.currentField.type;if(-1!==C.toLowerCase().indexOf("integer")){if(!this.isInteger(F)||!this.isInteger(D))return{invalidDomain:!0,errorMessage:J.default.domainOverlay.errors.mustBeInteger}}else if(-1!==C.toLowerCase().indexOf("double")||-1!==C.toLowerCase().indexOf("single")){if(isNaN(F)||isNaN(D))return{invalidDomain:!0,errorMessage:J.default.domainOverlay.errors.mustBeFloat}}else return{invalidDomain:!0,errorMessage:J.default.domainOverlay.errors.invalidForRangeDomain};return{invalidDomain:!1}};
I.prototype.codedValueTemplate=function(F,D){D&&(D.name=D.name.toString().replace(/"/g,"\x26quot;"),-1!==this.currentField.type.toLowerCase().indexOf("string")&&(D.code=D.code.toString().replace(/"/g,"\x26quot;")));F=m.default.toDom(l.default.substitute(R.default,{i18n:J.default,id:F,codedValues:D||{name:"",code:"",count:""}},null,u.default));D=(null===D||void 0===D?0:D.name)?D.name:"";F.querySelector(".js-template-delete").setAttribute("aria-label",this.i18n.domainOverlay.codedValueDelete.replace("${name}",
D));return F};I.prototype.showError=function(F){h.default.publish("alert/show",{type:"success",text:J.default.domainOverlay.errors.error})};I.prototype.loaderHelper=function(F,D){D=D?D:J.default.domainOverlay.defaultLoading;var C=this.domNode.querySelector(".js-domain-wrapper");!0===F?(this.showHideDiv(".loader",!0),this.domNode.querySelector(".loader-text").innerHTML=D,C.style.opacity="0.5",C.style.pointerEvents="none"):(this.domNode.querySelector(".loader-text").innerHTML=D,this.showHideDiv(".loader",
!1),C.style.opacity="1",C.style.pointerEvents="auto")};I.prototype.showHideDiv=function(F,D){this.domNode.querySelector(F).classList[D?"add":"remove"]("hide")};I.prototype.isInteger=function(F){return 0===F%1};return I=p.__decorate([(0,T.default)(r.default)],I)}()})},"arcgisonline/pages/item/widgets/AttributesView/_attributeCard":function(){define("require exports tslib ../../../utils/formatters ../../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/dom-class dojo/query dojo/topic dojo/_base/event esri/Evented dojo/text!./templates/attributeCard.html dojo/i18n!../../../../nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);return function(){function t(){this.templateString=r.default;this.i18n=q.default;this.formatters=a.default}t.prototype.postMixInProperties=function(){this.inherited(arguments);this.selectCardClass=
this.select?"card-select":"";this.selectedClass=this.isSelected?"card-select-active":"";this.checked=this.isSelected?"checked":"";this.selectItem=this.isSelected?q.default.GroupWidget.unselectItem:q.default.GroupWidget.selectItem;this.removedClass=this.isRemoved?"card-select-removed":"";this.disabled=this.isRemoved?"disabled":""};t.prototype.postCreate=function(){this.inherited(arguments);this.addEventListeners();this.item.description.fieldValueType?this._fieldValueType.innerHTML=this.i18n.attributeFieldDetails.fieldValueTypesList[this.item.description.fieldValueType]||
this.item.description.fieldValueType:this._fieldValueType.className+=" hide"};t.prototype.addEventListeners=function(){var w=this;this.own((0,b.default)(this._checkboxWrap,"click",function(u){u.stopPropagation()}),(0,b.default)(this._checkboxBtn,"change",function(u){w[u.target.checked?"selectCard":"deselectCard"]()}),(0,b.default)(this.domNode,"click",this.toggleSelected.bind(this)),l.default.subscribe("view/deselectAll",this.deselectCard.bind(this)),(0,d.default)(".js-field-name-card",this.domNode).on("click",
function(u){h.default.stop(u);u=u.target.getAttribute("fieldName");l.default.publish("attributeCard/fieldName",u)}))};t.prototype.toggleSelected=function(){if(this.select)this[c.default.contains(this.domNode,"card-select-active")?"deselectCard":"selectCard"]()};t.prototype.selectCard=function(){this.domNode.classList.add("card-select-active");this.item.isSelected=!0;this._checkboxBtn.setAttribute("aria-label",q.default.GroupWidget.unselectItem);this._checkboxBtn.checked=!0;l.default.publish("view/select",
this.item)};t.prototype.deselectCard=function(){this.domNode.classList.remove("card-select-active");this.item.isSelected=!1;this._checkboxBtn.setAttribute("aria-label",q.default.GroupWidget.selectItem);this._checkboxBtn.checked=!1;l.default.publish("view/deselect",this.item)};return t=p.__decorate([(0,g.default)(m.default,n.default,f.default)],t)}()})},"arcgisonline/pages/dijit/ArcadeCalculatorDlg":function(){define("require exports tslib esri/Evented esri/lang dojo/_base/lang dojo/topic dojo/query dojo/_base/kernel dojo/_base/event dojo/dom-construct dojo/dom-style dojo/_base/json esri/support/expressionUtils esri/tasks/QueryTask esri/tasks/query esri/sniff esri/arcadeProfiles/fieldCalculateProfile esri/ArcadeExpression dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog ./ArcadeFieldValidation arcgisonline/sharing/util dojo/i18n!../../nls/arcgisonline dojo/text!./ArcadeCalculatorDlg/templates/ArcadeCalculatorDlg.html arcgisonline/esriGeowConfig arcgisonline/tsutils/declareDecorator ../pageUtil".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);return function(){function D(C,y){this.baseClass="arcadeCalculatorDlg";this.templateString=T.default;this.MAX_SIZE_FOR_PBF=2E4}D.prototype.postMixInProperties=function(){this.inherited(arguments);this.i18n=m.default.mixin({},S.default);this.whereClause=this.whereClause||"1\x3d1";this.layerUrl=
"".concat(this.item.url,"/").concat(this.layer.layerId);this.localStorageName="Esri_ArcadeCalculator_".concat(this.item.id,"_").concat(this.layer.layerId,"_").concat(this.fieldInfo.name);this.localStorageObject=JSON.parse(window.localStorage.getItem(this.localStorageName));this.startFresh=!0};D.prototype.showModal=function(C){var y=this;this.dlg=new J.default({class:"dijitDialog__arcade-calculator"});this.dlg.setContent(this.domNode);this.dlg.show();this.dlg.titleBar.hidden=!0;this.initHandlers();
this.loaderHelper(!0,S.default.arcadeCalculatorDlg.defaultLoading);this.defaultScript="// ".concat(S.default.arcadeCalculatorDlg.defaultExpressionScript_line1,"\n// ").concat(S.default.arcadeCalculatorDlg.defaultExpressionScript_line2,"$feature.Sales2016 + $feature.Sales2017\n// ").concat(S.default.arcadeCalculatorDlg.defaultExpressionScript_line3,"$feature.TotalPop / Area ($feature, \u2019square-miles\u2019)\n// ").concat(S.default.arcadeCalculatorDlg.defaultExpressionScript_line4,"Geometry($feature).x\n\n");
this.arcadeScript=this.localStorageObject?this.localStorageObject.arcadeScript:this.defaultScript;this.failedObjectId=0;C=new q.default(this.layerUrl);var G=new t.default;G.where=this.whereClause;G.num=1;G.outFields=["*"];G.returnGeometry=!0;C.execute(G).then(function(L){1>(null===L||void 0===L?void 0:L.features.length)?(y.onCancel(),n.default.publish("alert/show",{type:"success",text:y.i18n.arcadeCalculatorDlg.errors.noRecordsExist})):(y.singleFeatureResponse=L,y.initArcadeUI(),y._showContinueMessage())})};
D.prototype.onCancel=function(){var C;null===(C=this.dlg)||void 0===C?void 0:C.destroyRecursive();clearInterval(this.editorFrameListener);window.removeEventListener("message",this.receiveMessageHitch)};D.prototype._setupLocalStorage=function(){var C;if(this.startFresh){this._clearAllLocalStorage();var y={};y.arcadeScript=this._arcadeScript;y.whereClause=this.whereClause;y.timeStamp=null===(C=this.layer.editingInfo)||void 0===C?void 0:C.lastEditDate;y.featureCount=this.totalRecordCount;y.uploadId=
this.registeredResultId;y.partIdDone=null;y.startRecordNumber=null;y.resultRecordCount=null;window.localStorage.setItem(this.localStorageName,JSON.stringify(y))}};D.prototype._clearAllLocalStorage=function(){window.localStorage.removeItem(this.localStorageName)};D.prototype._showContinueMessage=function(){var C=this;this.localStorageObject&&F.default.createConfirmationDialog({strings:{title:S.default.arcadeCalculatorDlg.continueMessageTitle,description:S.default.arcadeCalculatorDlg.continueMessagecontent,
ok:S.default.common.commonYes,cancel:S.default.common.commonNo},autoCloseOnOk:!0,hideClose:!0,onOk:function(){C.checkContinueOrStartFresh().then(function(y){C.whereClause=C.localStorageObject.whereClause||"1\x3d1";C.startFresh=y?!1:!0;C.onSubmit(C.localStorageObject.arcadeScript)})},onCancel:function(){C._clearAllLocalStorage()}})};D.prototype.checkContinueOrStartFresh=function(){var C=this,y=new x.default;this.localStorageObject.timeStamp===this.layer.editingInfo.lastEditDate&&this.localStorageObject.partIdDone&&
this.localStorageObject.startRecordNumber?R.default.request({url:"".concat(this.item.url,"/uploads/").concat(this.localStorageObject.uploadId,"/parts")}).then(function(G){var L;0<(null===(L=null===G||void 0===G?void 0:G.parts)||void 0===L?void 0:L.length)?(C.readjustPartIdAndstartRecordNumberIfNeeded(G.parts.length),y.resolve(!0)):y.resolve(!1)},function(G){y.resolve(!1)}):y.resolve(!1);return y};D.prototype.readjustPartIdAndstartRecordNumberIfNeeded=function(C){this.localStorageObject.partIdDone===
C&&(this.localStorageObject.partIdDone+=1,this.localStorageObject.startRecordNumber+=this.localStorageObject.resultRecordCount)};D.prototype.onSubmit=function(C){var y=this,G=new x.default;this._arcadeScript=C;this.set("readOnly",!0);this.loaderHelper(!0,S.default.arcadeCalculatorDlg.defaultLoadingCalculating);this.showHideDiv(".js-arcade-calculatorDlg",!1);this.showHideDiv(".js-arcade-statusDlg",!0);this.getFeatureCount().then(function(L){1>y.totalRecordCount&&y.showError(S.default.arcadeCalculatorDlg.errors.noRecordsExist);
y.totalRecordCount=L;y.totalRecords.innerHTML=y.totalRecordCount.toString();y.showHideDiv(".js-progress-bar-counts",!0);y.canUsePbf=y.checkIfCanUsePBF();y.setupArcade().then(function(){y.registerUpload().then(function(O){y.registeredResultId=O;y._setupLocalStorage();y.queryAndUploadProcess(y.startFresh?0:y.localStorageObject.startRecordNumber,y.startFresh?1:y.localStorageObject.partIdDone).then(function(U){y.domNode.querySelector(".loader-text").innerHTML=y.i18n.arcadeCalculatorDlg.commitLoading;
var M="".concat(y.item.url,"/uploads/").concat(y.registeredResultId,"/commit");y._clearAllLocalStorage();(0,b.default)(".js-cancel-button",y.domNode).attr("disabled","true");setTimeout(function(){R.default.request({url:M,content:{parts:y.allPartsInString(U),f:"json"}},{usePost:!0}).then(function(Q){(0,b.default)(".loader-text",y.domNode).attr("innerHTML",y.i18n.arcadeCalculatorDlg.appendLoading);y.appendToFS().then(function(Y){y.onCancel();n.default.publish("arcadeCalculatorDlg/done",{type:"success"});
n.default.publish("alert/show",{type:"success",text:g.default.substitute({count:Y},y.i18n.arcadeCalculatorDlg.updateSuccess)});G.resolve()},function(Y){y.showError(Y)})},function(Q){y.showError(Q)})},2E3)},function(U){})},function(O){y.showError(O)})})},function(L){y.showError(L)});return G};D.prototype.initHandlers=function(){var C=this;this.own((0,b.default)(".js-cancel-button",this.domNode).on("click",function(y){d.default.stop(y);C._clearAllLocalStorage();C.onCancel()}),(0,b.default)(".js-review-button",
this.domNode).on("click",function(y){d.default.stop(y);clearInterval(C.editorFrameListener);window.removeEventListener("message",C.receiveMessageHitch);C.loaderHelper(!0,S.default.arcadeCalculatorDlg.defaultLoading);C.showHideDiv(".js-arcade-statusDlg",!1);C.showHideDiv(".js-show-error",!1);C.showHideDiv(".js-review-button",!1);C.showHideDiv(".js-arcade-calculatorDlg",!0);y=new q.default(C.layerUrl);var G=new t.default;G.where="".concat(C.layer.objectIdField,"\x3d").concat(C.failedObjectId);G.num=
1;G.outFields=["*"];G.returnGeometry=!0;y.execute(G).then(function(L){L.features&&1>L.features.length||(C.singleFeatureResponse=L);C.initArcadeUI()})}))};D.prototype.showError=function(C){var y=this,G;-1<(null===(G=null===C||void 0===C?void 0:C.message)||void 0===G?void 0:G.indexOf("Object reference not set to"))&&(C=this.i18n.arcadeCalculatorDlg.errors.error);F.default.createConfirmationDialog({strings:{title:C.title,description:C.description},autoCloseOnOk:!0,hideCancel:!0,onOk:function(){y.set("readOnly",
!1);y._clearAllLocalStorage();y.showHideDiv(".js-arcade-statusDlg",!1);y.showHideDiv(".js-show-error,",!1);y.showHideDiv(".js-arcade-calculatorDlg",!0);(0,b.default)(".js-cancel-button",y.domNode).removeAttr("disabled");y.errorDlg.hide();y.onCancel()}});this.loaderHelper(!1)};D.prototype.loaderHelper=function(C,y){y=y||"Loading...";C?(this.showHideDiv(".loader",!0),this.domNode.querySelector(".loader-text").innerHTML=y,this.domNode.querySelector(".js-arcade-calculatorDlg").style.opacity="0.5",this.domNode.querySelector(".js-arcade-calculatorDlg").style.pointerEvents=
"none"):(this.domNode.querySelector(".loader-text").innerHTML=y,this.showHideDiv(".loader",!1),this.domNode.querySelector(".js-arcade-calculatorDlg").style.opacity="1",this.domNode.querySelector(".js-arcade-calculatorDlg").style.pointerEvents="auto")};D.prototype.showHideDiv=function(C,y){y?(0,b.default)(C).removeClass("hide"):(0,b.default)(C).addClass("hide")};D.prototype.setupArcade=function(){var C=new x.default;this.arcadeExpr=new v.default({expression:this._arcadeScript,returnType:this.getFieldType(),
profile:u.default});this.extractedFieldNames=r.default.extractFieldNames(this.arcadeExpr.syntaxTree);this.requestReturnGeometry=this.arcadeExpr.hasGeometryOperations()||r.default.hasFunction(this.arcadeExpr.syntaxTree,"Geometry")||r.default.hasFunction(this.arcadeExpr.syntaxTree,"Centroid");u.default.initialize([this.arcadeExpr]).then(function(){C.resolve()});return C};D.prototype.getFieldType=function(){return/integer|double|single/g.test(this.fieldInfo.type.toLowerCase())?"number":/date/g.test(this.fieldInfo.type.toLowerCase())?
"date":"string"};D.prototype.updateProgressBar=function(C,y){1>y&&(y=1);var G=C*y>this.totalRecordCount?this.totalRecordCount:C*y;this.progressBar.style.width="".concat(Math.min(100,Math.floor(C/(this.totalRecordCount/y)*100)),"%");this.completedRecords.innerHTML=G.toString()};D.prototype.addToLocalStorage=function(C,y){var G=JSON.parse(window.localStorage.getItem(this.localStorageName));G&&(G[C]=y,window.localStorage.setItem(this.localStorageName,JSON.stringify(G)))};D.prototype.queryAndUploadProcess=
function(C,y,G){var L=this,O=G||new x.default,U=y||1,M=C||0;C=this.getQuery(M);var Q=C.maxSize;y=new q.default(this.layerUrl);y.requestOptions={timeout:3E5};y.execute(C.query,void 0,void 0).then(function(Y){L.runThroughArcadeAndGetCsvToUpload(Y.features,U).then(function(fa){if(null===fa)O.reject(!1);else{var va="".concat(L.item.url,"/uploads/").concat(L.registeredResultId,"/uploadPart");R.default.request({url:va,content:{partId:U,f:"json"},form:fa,timeout:0},{usePost:!0}).then(function(Aa){Y.exceededTransferLimit?
(M+=Q,U++,L.addToLocalStorage("partIdDone",U),L.addToLocalStorage("startRecordNumber",M),L.addToLocalStorage("resultRecordCount",Q),Y=fa=void 0,L.updateProgressBar(U-1,Q),L.queryAndUploadProcess(M,U,O)):(Y=fa=void 0,L.updateProgressBar(U,Q),O.resolve(U))})}})},function(Y){L.showError(Y)});return O};D.prototype.getQuery=function(C){var y=new t.default;y.outFields=[this.layer.objectIdField];this.extractedFieldNames.forEach(function(L){y.outFields.push(L)});y.where=this.whereClause;y.start=C;y.returnGeometry=
this.requestReturnGeometry;C=this.layer.maxRecordCount||1E3;var G={format:"json"};this.canUsePbf&&(G.format="pbf",y.resultType="tile",this.requestReturnGeometry?(C=this.layer.tileMaxRecordCount,y.maxRecordCountFactor=1):(C=this.MAX_SIZE_FOR_PBF,this.layer.tileMaxRecordCount<=C&&(y.maxRecordCountFactor=C/this.layer.tileMaxRecordCount)),this.requestReturnGeometry&&(y.quantizationParameters={mode:"edit"}));y.num=C;return{query:y,options:G,maxSize:C}};D.prototype.checkIfCanUsePBF=function(){var C,y;return(0,w.default)("esri-pbf")&&
(null===(C=this.layer.advancedQueryCapabilities)||void 0===C?void 0:C.supportsQueryWithResultType)&&(null===(y=this.layer.advancedQueryCapabilities)||void 0===y?void 0:y.supportsMaxRecordCountFactor)&&this.layer.supportsFormatPBF&&this.layer.supportsQuantizationEditMode};D.prototype.runThroughArcadeAndGetCsvToUpload=function(C,y){var G=this,L=new x.default;this.getAllFeaturesFromArcade(C,y).then(function(O){null===O&&L.resolve(null);1===y?L.resolve(G.exportCSVFile(O,"uploadFile".concat(y),{FID:G.layer.objectIdField,
ArcadeField:G.fieldInfo.name})):L.resolve(G.exportCSVFile(O,"uploadFile".concat(y)))});return L};D.prototype.getAllFeaturesFromArcade=function(C,y){var G=this,L=new x.default,O=[];if(this.arcadeExpr.async){var U=1;this.reduceArrayWithPromises(C,function(Y,fa,va){var Aa=new x.default;try{var pa=u.default.getEvalOptions({expression:G.arcadeExpr,feature:fa,layer:G.layer,spatialReference:G.layer.spatialReference,portal:E.default.restBaseUrl.substring(0,E.default.restBaseUrl.indexOf("/sharing/rest"))});
pa.strictReturnType=!1;G.arcadeAsyncWithTimeout(fa,G.arcadeExpr,pa,va).then(function(N){try{var V={FID:fa.attributes[G.layer.objectIdField],ArcadeField:N};V=G.validateArcadeResult(V);O.push(V);G.updateProgressBar(y,U++);Aa.resolve(!0)}catch(Z){Aa.reject(Z)}},function(N){G.showError(N)})}catch(N){G.showError(N)}return Aa.promise}).then(function(Y){L.resolve(O)},function(Y){L.reject(Y)})}else{for(var M=0;M<C.length;M++){var Q=u.default.getEvalOptions({expression:this.arcadeExpr,feature:C[M],layer:this.layer,
spatialReference:this.layer.spatialReference,portal:E.default.restBaseUrl.substring(0,E.default.restBaseUrl.indexOf("/sharing/rest"))});Q.strictReturnType=!1;Q={FID:C[M].attributes[this.layer.objectIdField],ArcadeField:C[M].evaluateExpression(this.arcadeExpr,Q)};Q=this.validateArcadeResult(Q);O.push(Q)}L.resolve(O)}return L};D.prototype.arcadeAsyncWithTimeout=function(C,y,G,L){var O=new x.default;0===L%100?setTimeout(function(){C.evaluateExpression(y,G).then(function(U){O.resolve(U)},function(U){O.reject(U)})},
0):C.evaluateExpression(this.arcadeExpr,G).then(function(U){O.resolve(U)},function(U){O.reject(U)});return O};D.prototype.reduceArrayWithPromises=function(C,y,G){var L=new x.default;G=new x.default;G.resolve(!0);C.reduce(function(O,U,M,Q){return O.then(function(Y){try{return y(Y,U,M,Q)}catch(fa){return Y=new x.default,Y.reject(fa),Y.promise}},function(Y){var fa=new x.default;fa.reject(Y);return fa.promise})},G.promise).then(function(O){L.resolve(O)},function(O){L.reject(O)});return L.promise};D.prototype.validateArcadeResult=
function(C){var y=C.ArcadeField,G=C.FID;null===y&&(y="");var L=P.default.arcadeFieldValidation(y,this.fieldInfo);if(L.isFieldValid)-1!==this.fieldInfo.type.toLowerCase().indexOf("string")&&(y=this.sanitizeStringForCsv(y));else throw this.showHideDiv(".js-show-error",!0),this.showHideDiv(".js-review-button",!0),this._clearAllLocalStorage(),this.startFresh=!0,this.reviewErrorHeading.innerHTML=L.errorMessage,this.reviewErrorFid.innerHTML=this.layer.objectIdField,this.reviewErrorFidValue.innerHTML=G,
this.reviewErrorValue.innerHTML=""!==y?y:"",this.failedObjectId=G,this.loaderHelper(!1),L.errorMessage;C.ArcadeField=y;return C};D.prototype.sanitizeStringForCsv=function(C){"string"===typeof C&&(C=C.replace(/"/g,'""'));return'"'+C+'"'};D.prototype.convertToCSV=function(C){C="object"!==typeof C?JSON.parse(C):C;for(var y="",G=0;G<C.length;G++){var L="",O;for(O in C[G])""!==L&&(L+=","),L+=C[G][O];y+=L+"\r\n"}return y};D.prototype.exportCSVFile=function(C,y,G){G&&C.unshift(G);C=JSON.stringify(C);C=this.convertToCSV(C);
y=y+".csv"||"export.csv";C=new Blob([C],{type:"text/csv;charset\x3dutf-8;"});G=l.default.create("form",{enctype:"multipart/form-data"});G=new FormData(G);G.append("file",C,y);return G};D.prototype.allPartsInString=function(C){for(var y="",G=1;G<=C;G++)y=G===C?y+G:y+(G+",");return y};D.prototype.appendToFS=function(){var C=this,y=new x.default,G="".concat(this.item.url,"/").concat(this.layer.layerId,"/append"),L=this.getAppendParams();R.default.request({url:G,content:L},{usePost:!0}).then(function(O){return C.checkStatus(O)},
function(O){y.reject(O)}).then(function(O){y.resolve(O)});return y};D.prototype.checkStatus=function(C,y,G){var L=this,O=null===C||void 0===C?void 0:C.statusUrl,U=G||new x.default,M=y||500;R.default.request({url:O}).then(function(Q){Q=Q||{status:"completed"};Q.status&&"completed"===Q.status.toLowerCase()?U.resolve(Q.recordCount):Q.status&&"failed"===Q.status.toLowerCase()||400<Q.code||""===Q.status?L.showError(Q):(M=(M||500)+250,setTimeout(function(){L.checkStatus(C,M,U)},y))},function(Q){L.showError(Q)});
return U};D.prototype.getAppendParams=function(){var C=[this.fieldInfo.name,this.layer.objectIdField];return{fieldMappings:JSON.stringify([{source:this.fieldInfo.name,name:this.fieldInfo.name},{source:this.layer.objectIdField,name:this.layer.objectIdField}]),upsert:!0,skipUpdates:!1,useGlobalIds:!1,skipInserts:!0,updateGeometry:!1,appendFields:JSON.stringify(C),appendUploadId:this.registeredResultId,appendUploadFormat:"csv",rollbackOnFailure:!0,upsertMatchingField:this.layer.objectIdField,appendSourceInfo:"{}"}};
D.prototype.getFeatureCount=function(){var C=new x.default;if(this.startFresh){var y=new q.default(this.layerUrl),G=new t.default;G.returnGeometry=!1;G.where=this.whereClause;y.executeForCount(G,function(L){C.resolve(L)},function(L){C.reject(L)})}else C.resolve(this.localStorageObject.featureCount);return C};D.prototype.registerUpload=function(){var C=new x.default;if(this.startFresh){var y="".concat(this.item.url,"/uploads/register");R.default.request({url:y,content:{itemName:"".concat(this.item.id,
".csv"),description:"Arcade Calculate"}},{usePost:!0}).then(function(G){G.success&&C.resolve(G.item.itemID)})}else C.resolve(this.localStorageObject.uploadId);return C};D.prototype.initArcadeUI=function(){var C=this,y=0;this.editorFrameLoaded=!1;this.editorUrl="".concat(E.default.arcadeEditor,"?locale\x3d").concat(c.default.locale);this.expressionEditor&&(this.expressionEditor.onload=function(){h.default.set(C.expressionEditor,"visibility","visible")},this.expressionEditor.src=this.editorUrl);this.receiveMessageHitch=
this.receiveMessage.bind(this);window.addEventListener("message",this.receiveMessageHitch,!1);this.editorFrameListener=window.setInterval(function(){C.editorFrameLoaded?(clearInterval(C.editorFrameListener),C.editorFrameListener=null):C.sendPostMessage({type:"isLoaded"});y++;60<y&&C.showError("Arcade time out")},500)};D.prototype.sendPostMessage=function(C){var y,G,L;null===(L=null===(G=null===(y=this.expressionEditor)||void 0===y?void 0:y.contentWindow)||void 0===G?void 0:G.postMessage)||void 0===
L?void 0:L.call(G,f.default.toJson(C),this.editorUrl)};D.prototype.receiveMessage=function(C){if(-1!==this.editorUrl.indexOf(C.origin))switch(C="string"===typeof C.data?f.default.fromJson(C.data):C.data,C.type){case "loaded":(this.editorFrameLoaded=C.value)&&this.sendPostMessage({type:"initializeDialog",title:this.i18n.arcadeCalculatorDlg.arcadeCalculatorDlgTitle+(this.fieldInfo.alias?this.fieldInfo.alias:this.fieldInfo.name),captureTitle:!1,predictOutputType:!0,script:this.arcadeScript,async:!0,
profile:this.makeCurrentProfile(),includeRelationships:!0,includeGeometryWarning:!1,arcadeProfile:"Field Calculation",bannedFunctions:["Length3D"],spatialReference:this.layer.spatialReference.toJson(),portalDefinition:{app_id:"",url:E.default.restBaseUrl,token:R.default.getToken(),expires:E.default.userInfo.expires,userId:E.default.userInfo.username}});break;case "initFinished":this.editorFrameLoaded&&this.loaderHelper(!1,null);break;case "scriptSaveAndClose":if(!C.script||C.script===this.defaultScript)break;
this.arcadeScript=C.script;this.onSubmit(C.script);break;case "scriptClose":this.onCancel()}};D.prototype.makeCurrentProfile=function(){var C=this.layer.fields.map(function(y){var G;-1<(null===(G=y.domain)||void 0===G?void 0:G.type.indexOf(["range","codedValue"]))&&(y=m.default.clone(y));return y});C=[{type:"Feature",dontExpand:!0,value:{attributes:null,geometry:null,_hydrateLayer:{portalItem:{id:this.item.id},layerId:this.layer.layerId,outFields:["*"]},layer:{fields:C,objectIdField:this.layer.objectIdField,
typeIdField:this.layer.typeIdField,types:this.layer.types?this.layer.types.map(function(y){return y.toJson?y.toJson():y}):null,templates:this.layer.templates,relationships:this.layer.relationships}},id:"$feature",displayTitle:""},{type:"Layer",value:{portalItem:{id:this.item.id},layerId:this.layer.layerId,outFields:["*"]},id:"$layer",displayTitle:this.layer.name},{type:"Workspace",value:{portalItem:{id:this.item.id}},id:"$datastore",displayTitle:this.item.title}];C[0].value.attributes=this.singleFeatureResponse.features[0].attributes;
C[0].value.geometry=this.singleFeatureResponse.features[0].geometry;this.layer.displayField&&(C[0].displayTitle=this.singleFeatureResponse.features[0].attributes[this.layer.displayField]);C[0].value._hydrateLayer={url:this.layerUrl};return C};return D=p.__decorate([(0,I.default)(z.default,A.default,B.default,a.default)],D)}()})},"esri/arcadeProfiles/fieldCalculateProfile":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../promiseList ../arcade/Feature ../arcade/featureset/support/RecentlyUsedCache ../support/expressionUtils ./utils".split(" "),
function(e,K,p,a,g,m,n,b,c){e=new (e(null,{declaredClass:"esri.arcadeProfiles.FieldCalculateProfile",defaults:{globals:{featureSet:["$layer","$datastore"],async:["$layer","$datastore"]},context:{vars:{$feature:"any",$layer:"any",$datastore:"any"}}},_lruCache:null,constructor:function(){this._lruCache=new n},initialize:function(d){var l=[];c.hasGeometryOperations(d)&&l.push(b.enableGeometryOperations());(c.hasFeatureSetOperations(d)||c.hasVariables(d,this.defaults.globals.featureSet))&&l.push(b.enableFeatureSetOperations());
c.isAsync(d)&&l.push(b.enableAsyncOperations());return g(l)},isAsync:function(d){d=[d];return c.hasFeatureSetOperations(d)||c.hasVariables(d,this.defaults.globals.async)},parse:function(d){return b.createSyntaxTree(d.expression)},compile:function(d){var l=K.clone(this.defaults.context);l.useAsync=d.async;return d.syntaxTree?b.createFunction(d.syntaxTree,l):null},getEvalOptions:function(d){var l=d.expression,h=d.feature,f=d.layer,r=d.spatialReference;d=d.portal;var q,t,w={spatialReference:r,cache:this._lruCache};
if(f&&(l.hasVariable("$layer")&&(q=t=f.getMap()?b.createFeatureSetFromLayer(f,w):b.createFeatureSetFromLayerUrl(f.url,w)),l.hasVariable("$datastore")))var u=(u=c.getServiceUrl(f.url))?b.createFeatureSetCollectionFromServiceUrl(u,w):null;l=h&&l.hasVariable("$feature")?m.createFromGraphicLikeObject(h.geometry,h.attributes,(l.hasFunction("attachments")||l.hasFunction("featuresetbyrelationship"))&&f&&!f.getMap()?t||b.createFeatureSetFromLayerUrl(f.url,w):f):null;if(d){d=d.replace(/\/+$/ig,"");var v={url:d,
portalUrl:d+"/sharing/rest"}}return{context:{vars:{$feature:l,$layer:q,$datastore:u},services:v?{portal:v}:null,lrucache:this._lruCache,spatialReference:r}}}}));K.setObject("arcadeProfiles.fieldCalculateProfile",e,a);return e})},"arcgisonline/pages/dijit/ArcadeFieldValidation":function(){define(["require","exports","tslib","esri/lang","dojo/i18n!../../nls/arcgisonline"],function(e,K,p,a,g){function m(d,l){return d instanceof Date?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l)},
g.default.arcadeFieldValidation.notValidFieldType)}}function n(d){return"number"===typeof d&&!isNaN(d)&&Infinity!==d&&-Infinity!==d}function b(d){return g.default.arcadeFieldValidation.fieldTypes[d.type]||g.default.arcadeFieldValidation.commonUndefined}function c(d,l){return d.domain&&"range"===d.domain.type?l>=d.domain.minValue&&l<=d.domain.maxValue:!0}Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);g=p.__importDefault(g);K.default={arcadeFieldValidation:function(d,l){var h=
l.type.toLowerCase();if(null===d||""===d||void 0===d)return l.nullable?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:g.default.arcadeFieldValidation.nullNotAllowed};var f=null===d?!1:d instanceof Date?!1:"function"===typeof d||"object"===typeof d;return f?{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l)},g.default.arcadeFieldValidation.cannotInsertObject)}:"esrifieldtypestring"===h?(d=(m(d,l)||n(d))&&d.toString().length<=l.length?{isFieldValid:!0}:"string"===typeof d&&d.length<=
l.length?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:a.default.substitute({maxStringLength:l.length},g.default.arcadeFieldValidation.stringLengthError)},d):d="esrifieldtypedouble"===h?n(d)?-Infinity<=d&&Infinity>=d?c(l,d)?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:a.default.substitute({min:l.domain.minValue,max:l.domain.maxValue},g.default.arcadeFieldValidation.domainOutOfRange)}:{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l),min:-Infinity,max:Infinity},g.default.arcadeFieldValidation.outOfRange)}:
{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l)},g.default.arcadeFieldValidation.notValidFieldType)}:"esrifieldtypesingle"===h?n(d)?-3.402823E38<=d&&3.402823E38>=d?c(l,d)?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:a.default.substitute({min:l.domain.minValue,max:l.domain.maxValue},g.default.arcadeFieldValidation.domainOutOfRange)}:{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l),min:-3.402823E38,max:3.402823E38},g.default.arcadeFieldValidation.outOfRange)}:
{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l)},g.default.arcadeFieldValidation.notValidFieldType)}:"esrifieldtypeinteger"===h?n(d)&&d===parseInt(d,10)?-2147483648<=d&&2147483647>=d?c(l,d)?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:a.default.substitute({min:l.domain.minValue,max:l.domain.maxValue},g.default.arcadeFieldValidation.domainOutOfRange)}:{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l),min:-2147483648,max:2147483647},g.default.arcadeFieldValidation.outOfRange)}:
{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l)},g.default.arcadeFieldValidation.notValidFieldType)}:"esrifieldtypesmallinteger"===h?n(d)&&d===parseInt(d,10)?-32768<=d&&32767>=d?c(l,d)?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:a.default.substitute({min:l.domain.minValue,max:l.domain.maxValue},g.default.arcadeFieldValidation.domainOutOfRange)}:{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l),min:-32768,max:32767},g.default.arcadeFieldValidation.outOfRange)}:
{isFieldValid:!1,errorMessage:a.default.substitute({fieldType:b(l)},g.default.arcadeFieldValidation.notValidFieldType)}:"esrifieldtypedate"===h?m(d,l):{isFieldValid:!1,errorMessage:g.default.arcadeFieldValidation.unexpectedValue}}}})},"arcgisonline/pages/dijit/CalculateWithOptionsDlg":function(){define("require exports tslib ../../esriGeowConfig ../utils/icons ../../sharing/util ../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog dojo/query dojo/on dojo/_base/event dojo/Deferred dojo/topic esri/Evented dojo/i18n!../../nls/arcgisonline dojo/text!./CalculateWithOptionsDlg/templates/CalculateWithOptionsDlg.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);return function(){function x(){this.templateString=v.default;this.baseClass="calculateWithOptions";
this.i18n=u.default;this.icons=g.default}x.prototype.startup=function(z){this.inherited(arguments);this.fieldInfo=null===z||void 0===z?void 0:z.fieldInfo;this.canDoArcadeCalculation=null===z||void 0===z?void 0:z.showArcadeOption;this.arcadeDisabledDescription=null===z||void 0===z?void 0:z.arcadeDisabledDescription;var A=this.domNode.querySelector(".js-disabled-text");this.canDoArcadeCalculation||(this.arcadeDisabledDescription?A.textContent=this.arcadeDisabledDescription:m.default.isPortal()&&(A.textContent=
u.default.calculateSQLArcadeDlg.arcadeDisabledPortal));this.initHandlers()};x.prototype.showModal=function(z){var A=this;z=new q.default;var B="".concat(u.default.calculateSQLArcadeDlg.calculateDlgTitle,' : \x3cmark class\x3d"label calculate-with-options__field-label"\x3e').concat(this.fieldInfo.name,"\x3c/mark\x3e");this.docUrl.href=a.default.self?"".concat(a.default.self.helpBase).concat(a.default.self.helpMap.m["120001514"]):"";this.arcadeDisabledHelpUrl.href=a.default.self?"".concat(a.default.self.helpBase).concat(a.default.self.helpMap.m["120001735"]):
"";this.dlg=new l.default({title:B,class:"dijitDialog__calculate-with-options"});this.dlg.setContent(this.domNode);this.dlg.show();this.canDoArcadeCalculation||((0,h.default)(".js-arcade-button").addClass("hide"),(0,h.default)(".js-panel-arcade-disabled").removeClass("hide"));this.own((0,f.default)(this.dlg,"cancel",function(){A.set("readOnly",!0);A.onCancel()}));return z};x.prototype.onCancel=function(){this.dlg&&this.dlg.destroyRecursive()};x.prototype.initHandlers=function(){var z=this;this.own((0,h.default)(".js-arcade-button",
this.domNode).on("click",function(A){r.default.stop(A);t.default.publish("calculateWithOptionsDlg/arcade",z.fieldInfo);z.onCancel()}),(0,h.default)(".js-sql-button",this.domNode).on("click",function(A){r.default.stop(A);t.default.publish("calculateWithOptionsDlg/sql",z.fieldInfo);z.onCancel()}))};return x=p.__decorate([(0,n.default)(b.default,c.default,d.default,w.default)],x)}()})},"arcgisonline/sharing/dijit/dialog/TableAddFieldDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/on dojo/json dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/dom-class dojo/aspect dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/form/Button dijit/form/Form dijit/form/Select dijit/form/TextBox dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/form/DateTextBox dijit/Dialog esri/kernel esri/lang esri/request esri/tasks/query esri/tasks/QueryTask ../../util dojo/i18n!esri/nls/jsapi dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/TableAddFieldDlg.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L){e=K([q,t,w,u,v],{widgetsInTemplate:!0,declaredClass:"arcgisonline.sharing.dijit.dialog.TableAddFieldDlg",templateString:L,basePath:e.toUrl("."),statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.TableAddFieldDlg);return this._instance}},_css:{table:"esriAddFormTable",container:"esriAddFieldContainer",longInput:"esriLongInput",longLabel:"esriLongLabel",
typeSelect:"esriTypeSelect",buttonContainer:"esriAddButtonContainer",defaultLabelContainer:"esriDefaultLabelContainer",optionLabelContainer:"esriOptionLabelContainer",button:"btn calcite primary tiny",closeButton:"btn calcite cancel tiny",leadingMargin1:"esriLeadingMargin1",trailing:"esriFloatTrailing"},constructor:function(O){this.inherited(arguments);O&&p.mixin(this._css,O.css)},postMixInProperties:function(){this.inherited(arguments);this.i18n={};this.newFieldTypeStrings={};this.timeZones={};this.timeZoneOffset=
null;p.mixin(this.i18n,y.common);p.mixin(this.i18n,y.calculateFields);p.mixin(this.timeZones,G.serviceCapabilityManagement.mapImageLayerParameters.tz);p.mixin(this.newFieldTypeStrings,G.attributesView)},postCreate:function(){this.inherited(arguments);this._typeSelect.set("value","esriFieldTypeString");this._handleTypeChange("esriFieldTypeString");this._nameInput.set("validator",p.hitch(this,this._validateFieldName));this._checkNullable();this._populateTimezones()},_populateTimezones:function(){Object.entries(this.timeZones).filter(function(O){return!["none",
"unknown"].includes(O[0].toLowerCase())}).forEach(function(O){var U=O[0];O=O[1];var M=O.slice(O.indexOf("UTC")+3,O.indexOf("UTC")+9);if("UTC"===U||"Morocco Standard Time"===U||"GMT Standard Time"===U||"Greenwich Standard Time"===U)M="+00:00";this._defaultTimezoneSelect.store.data.push({id:M,value:U,name:O})}.bind(this))},_checkNullable:function(){if(this.params&&this.params.layer){for(var O=document.querySelectorAll(".nullable-row"),U=0;U<O.length;U++)O[U].style.display="none";O=new esri.tasks.Query;
O.where="1\x3d1";this.params.layer.queryCount(O,function(M){if(0===M){M=document.querySelectorAll(".nullable-row");for(var Q=0;Q<M.length;Q++)M[Q].style.display="table-row"}},function(M){})}},_handleTimeZoneChange:function(O){this.timezoneOffset=O},_handleTypeChange:function(O){this._lengthInput.set("required","esriFieldTypeString"===O);this._lengthInput.set("constraints",{min:1,places:0,max:void 0});d.set(this._lengthRow,"display","esriFieldTypeString"!==O?"none":"table-row");var U={esriFieldTypeDouble:1,
esriFieldTypeSingle:1},M={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},Q={esriFieldTypeBigInteger:1}.hasOwnProperty(O),Y={esriFieldTypeDateOnly:1}.hasOwnProperty(O),fa={esriFieldTypeTimeOnly:1}.hasOwnProperty(O),va={esriFieldTypeTimestampOffset:1}.hasOwnProperty(O);Q&&this._lengthInput.set("constraints",{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER});if(O in{esriFieldTypeDate:1})d.set(this._defaultStrInput.domNode,"display","none"),d.set(this._defaultNumInput.domNode,"display","none"),
d.set(this._defaultDblInput.domNode,"display","none"),d.set(this._defaultDateInput.domNode,"display","block"),d.set(this._defaultTimeInput.domNode,"display","block"),d.set(this._defaultTimezoneSelect.domNode,"display","none"),this._defaultTimeInput.on("change",function(N){if(this._defaultTimeInput.get("value")&&!this._defaultDateInput.get("value")){N=new Date;var V=""+(N.getMonth()+1),Z=""+N.getDate(),ba=N.getFullYear(),ma=10>V?"0"+V:V;N=10>Z?"0"+Z:Z;document.getElementById("dijit_form_DateTextBox_0").value=
V+"/"+Z+"/"+ba;this._defaultDateInput.value=ba+"-"+ma+"-"+N}}.bind(this));else if(M.hasOwnProperty(O)||Q)d.set(this._defaultStrInput.domNode,"display","none"),d.set(this._defaultNumInput.domNode,"display","block"),Q?(this._defaultNumInput.constraints.min=Number.MIN_SAFE_INTEGER,this._defaultNumInput.constraints.max=Number.MAX_SAFE_INTEGER):(this._defaultNumInput.constraints.min=void 0,this._defaultNumInput.constraints.max=void 0),d.set(this._defaultDblInput.domNode,"display","none"),d.set(this._defaultDateInput.domNode,
"display","none"),d.set(this._defaultTimeInput.domNode,"display","none"),d.set(this._defaultTimezoneSelect.domNode,"display","none");else if(U.hasOwnProperty(O))d.set(this._defaultStrInput.domNode,"display","none"),d.set(this._defaultNumInput.domNode,"display","none"),d.set(this._defaultDblInput.domNode,"display","block"),d.set(this._defaultDateInput.domNode,"display","none"),d.set(this._defaultTimeInput.domNode,"display","none"),d.set(this._defaultTimezoneSelect.domNode,"display","none");else if(Y)d.set(this._defaultStrInput.domNode,
"display","none"),d.set(this._defaultNumInput.domNode,"display","none"),d.set(this._defaultDblInput.domNode,"display","none"),d.set(this._defaultDateInput.domNode,"display","block"),d.set(this._defaultTimeInput.domNode,"display","none"),d.set(this._defaultTimezoneSelect.domNode,"display","none");else if(fa)d.set(this._defaultStrInput.domNode,"display","none"),d.set(this._defaultNumInput.domNode,"display","none"),d.set(this._defaultDblInput.domNode,"display","none"),d.set(this._defaultDateInput.domNode,
"display","none"),d.set(this._defaultTimeInput.domNode,"display","block"),d.set(this._defaultTimezoneSelect.domNode,"display","none");else if(va){d.set(this._defaultStrInput.domNode,"display","none");d.set(this._defaultNumInput.domNode,"display","none");d.set(this._defaultDblInput.domNode,"display","none");d.set(this._defaultDateInput.domNode,"display","block");d.set(this._defaultTimeInput.domNode,"display","block");d.set(this._defaultTimezoneSelect.domNode,"display","block");var Aa=this._defaultTimeInput.get("value"),
pa=this._defaultDateInput.get("value");this._defaultTimeInput.on("change",function(N){this._defaultTimeInput.get("value")&&(pa||this._defaultDateInput.setAttribute("required",!0),this._defaultTimezoneSelect.value||this._defaultTimezoneSelect.setAttribute("required",!0))}.bind(this));this._defaultTimezoneSelect.on("change",function(N){Aa||this._defaultTimeInput.setAttribute("required",!0);pa||this._defaultDateInput.setAttribute("required",!0)}.bind(this));this._defaultDateInput.on("change",function(N){Aa||
this._defaultTimeInput.setAttribute("required",!0);this._defaultTimezoneSelect.value||this._defaultTimezoneSelect.setAttribute("required",!0)}.bind(this))}else d.set(this._defaultStrInput.domNode,"display","block"),d.set(this._defaultNumInput.domNode,"display","none"),d.set(this._defaultDblInput.domNode,"display","none"),d.set(this._defaultDateInput.domNode,"display","none"),d.set(this._defaultTimeInput.domNode,"display","none"),d.set(this._defaultTimezoneSelect.domNode,"display","none");U=document.querySelector(".js-newFieldTypeWarning");
O=document.querySelector(".bigInteger-text");Q||Y||fa||va?(U.classList.remove("hide"),Q?(Q=O.innerHTML.replace(/\$\{beginSup\}/g,"\x3csup\x3e").replace(/\$\{endSup\}/g,"\x3c/sup\x3e"),O.innerHTML=Q,O.classList.remove("hide")):O.classList.add("hide")):U.classList.add("hide")},_handleAddButtonClick:function(){if(this._addForm.validate()){var O={f:"json"},U=this.params.layer.url.replace("/rest/services","/rest/admin/services")+"/addToDefinition",M=[],Q={esriFieldTypeDate:1},Y={},fa;var va={name:this._nameInput.get("value"),
type:this._typeSelect.get("value"),alias:this._aliasInput.get("value"),nullable:this._nullable.get("checked"),editable:!0};var Aa={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1}.hasOwnProperty(va.type),pa={esriFieldTypeDouble:1,esriFieldTypeSingle:1}.hasOwnProperty(va.type),N={esriFieldTypeDateOnly:1}.hasOwnProperty(va.type),V={esriFieldTypeTimeOnly:1}.hasOwnProperty(va.type),Z={esriFieldTypeBigInteger:1}.hasOwnProperty(va.type),ba={esriFieldTypeTimestampOffset:1}.hasOwnProperty(va.type),ma=
this._defaultDateInput.get("value"),sa=null;if(ma){sa=String(ma.getMonth()+1).padStart(2,"0");var Ea=String(ma.getDate()).padStart(2,"0");sa=ma.getFullYear()+"-"+sa+"-"+Ea}ma=this._defaultTimeInput.get("value");Ea=null;ma&&(Ea=String(ma.getHours()).padStart(2,"0")+":"+String(ma.getMinutes()).padStart(2,"0")+":00");"esriFieldTypeString"===va.type&&(va.length=this._lengthInput.get("value"));if(Aa||Z)var ya=parseInt(this._defaultNumInput.get("value"),10);else pa?ya=parseFloat(this._defaultDblInput.get("value"),
10):Q.hasOwnProperty(va.type)?(Q=this._defaultDateInput.get("value")?this._defaultDateInput.get("value").toDateString():null,null!==Q?(ya=this._defaultTimeInput.get("value")?this._defaultTimeInput.get("value").toTimeString():(new Date(Q)).toTimeString(),ya=(new Date(Q+" "+ya)).getTime()):this._defaultTimeInput.get("value")&&(ya=(new Date).toDateString(),this._defaultDateInput.set("value",ya),ya=ya+" "+this._defaultTimeInput.get("value").toTimeString(),ya=(new Date(ya)).getTime())):ya=N?sa:V?Ea:ba?
sa&&ma&&this.timezoneOffset?sa+"T"+Ea+this.timezoneOffset:null:this._defaultStrInput.get("value");if(ya||(Aa||pa||Z)&&0===ya)va.defaultValue=ya;M.push(va);Y.fields=M;O.addToDefinition=g.toJson(Y);arcgisonline.map.itemData.getServerToken(this.params.mapLayer).then(dojo.hitch(this,function(wa){O.token=wa;fa=I({url:U,content:O},{usePost:!0});this._addBtn.set("disabled",!0);fa.then(p.hitch(this,function(aa){this._dialog.hide();this._addBtn.set("disabled",!1);this.params.popup?arcgisonline.map.main.ignoreCache(this.params.mapLayer):
this.params.mapLayer.itemCard.set("maxAgeCheck",!0);I({url:this.params.layer.url,content:{f:"json",_ts:(new Date).getTime()},callbackParamName:"callback"}).then(p.hitch(this,function(ca){this.params.mapLayer.layer.fields=ca.fields;var ka=a.filter(ca.fields,function(Fa){return Fa.name.toLowerCase()===va.name.toLowerCase()?(Fa.name!==va.name&&(va.name=Fa.name,this._nameInput.set("value",va.name)),!0):!1},this)[0];this.params.mapLayer.serviceInfo=ca;if(this.params.mapLayer.origItemLayers)for(var qa=
parseInt(this.params.mapLayer.layer.url.substring(this.params.mapLayer.layer.url.lastIndexOf("/")+1)),da=0;da<this.params.mapLayer.origItemLayers.length;da++)if(this.params.mapLayer.origItemLayers[da].id===qa){var ia=this.params.mapLayer.origItemLayers[da];break}if(this.params.mapLayer.popupInfo||ia&&ia.popupInfo&&this.params.mapLayer.popupChanged)if(ca=this.params.popup?this.params.popup.getDefaultPopupInfo(ca,this.params.mapLayer.layer.isEditable(),this.params.mapLayer.layer):this.params.table.getDefaultPopupInfo(ca,
this.params.mapLayer.layer.isEditable(),this.params.mapLayer.layer),ca.fieldInfos=a.filter(ca.fieldInfos,function(Fa){return Fa.fieldName!==ka.name}),this.params.mapLayer.popupInfo){qa=this.updatePopupInfo(this.params.mapLayer.popupInfo,ka,ca);arcgisonline.map.popup.removePopup(this.params.mapLayer);this.params.mapLayer.popupInfo=qa;if(this.params.popup){if(ia&&ia.popupInfo&&this.params.mapLayer.popupChanged){var ra=this.updatePopupInfo(ia.popupInfo,ka,ca);ia.popupInfo=ra}this.params.mapLayer.popupChanged=
this.params.mapLayer.popupChanged||(ia&&ia.popupInfo?!0:!1)}else this.params.mapLayer.popupChanged=!0;arcgisonline.map.popup.addPopupLayer(this.params.mapLayer,this.params.subLayerId)}else ra=this.updatePopupInfo(ia.popupInfo,ka,ca),ia.popupInfo=ra;-1!==["Feature Layer","Table"].indexOf(this.params.mapLayer.layer.type)?(arcgisonline.map.edit.updateTypesAndTemplatesOnLayer(this.params.mapLayer.layer),this.params.mapLayer.featureTemplatesChanged=!0,this.params.popup&&arcgisonline.map.main.markMapAsChanged("addField"),
ia={id:this.params.mapLayer.id,itemCard:this.params.mapLayer.itemCard,itemId:this.params.mapLayer.itemId,layer:this.params.mapLayer.layer,origItemlayers:this.params.mapLayer.origItemlayers,popupInfo:ra||this.params.mapLayer.popupInfo,popupChanged:(ra||this.params.mapLayer.popupInfo)&&"Feature Layer"===this.params.mapLayer.layer.type,serverToken:this.params.mapLayer.serverToken,serviceInfo:this.params.mapLayer.serviceInfo,title:this.params.mapLayer.title,type:this.params.mapLayer.type,url:this.params.mapLayer.url},
ia.serviceInfo.templates&&ia.serviceInfo.templates.length?dojo.forEach(ia.serviceInfo.templates,function(Fa){Fa.prototype.attributes[ka.name]=ka.defaultValue||null}):dojo.forEach(ia.serviceInfo.types,function(Fa){dojo.forEach(Fa.templates,function(ea){ea.prototype.attributes[ka.name]=ka.defaultValue||null})}),arcgisonline.map.itemData.updateFeatureServiceAfterAddRemoveField(ia,p.hitch(this,function(Fa){this.params.mapLayer.layer.refresh();this.params.table.refreshTable(this.params.mapLayer,this.params.subLayerId,
"add",ka.name);this.params.table.updateLayerDataOrSchemaUpdatedDate("schema")}))):(this.params.table.refreshTable(this.params.mapLayer,this.params.subLayerId,"add",ka.name),this.params.table.updateLayerDataOrSchemaUpdatedDate("schema"))}),p.hitch(this,function(ca){var ka=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();this._addBtn.set("disabled",!1);ka.show({title:this.i18n.errorTitle,message:ca.details.join("\x3cbr/\x3e")})}))}),p.hitch(this,function(aa){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,
message:aa.details.join("\x3cbr/\x3e")});this._addBtn.set("disabled",!1)}),p.hitch(this,function(aa){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:aa.details.join("\x3cbr/\x3e")});this._addBtn.set("disabled",!1)}))}))}},updatePopupInfo:function(O,U,M){M={esriFieldTypeDouble:1,esriFieldTypeSingle:1};var Q={esriFieldTypeDate:1};if(U.type in{esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1}){var Y={places:0,digitSeparator:!0};
esri.isDefined(U.defaultValue)&&(U.defaultValue=parseInt(U.defaultValue,10))}else U.type in M?(Y={places:2,digitSeparator:!0},esri.isDefined(U.defaultValue)&&(U.defaultValue=parseFloat(U.defaultValue,10))):U.type in Q&&(10<=this.params.mapLayer.layer.version||this.params.layer&&10<=this.params.layer.version)&&(Y={dateFormat:"shortDateLongTime"});var fa=p.mixin({},{fieldName:U.name,label:U.alias,isEditable:U.editable,tooltip:"",visible:!0,format:Y,stringFieldOption:"textbox"});O&&O.fieldInfos&&(a.some(O.fieldInfos,
function(va){return va.fieldName===fa.fieldName},this)||O.fieldInfos.push(fa));return O},_handleCancelButtonClick:function(){this._dialog.hide()},show:function(O){this._dialog.closeButtonNode.tabIndex=0;this._addForm.reset();this._addBtn.set("disabled",!1);this._dialog.show();this.params=O;this._checkNullable()},_validateFieldName:function(O){var U="ABSOLUTE ACCESS ACTION ADD ALL ALLOCATE ALPHANUMERIC ALTER And ANY ARE AS ASC ASSERTION AT AUTHORIZATION AUTOINCREMENT AVG BEGIN Between BINARY BIT BIT_LENGTH BOOLEAN BOTH BY BYTE CASCADE CASCADED CASE CAST CATALOG CHAR CHAR_LENGTH CHARACTER CHARACTER_LENGTH CHECK CLOSE COALESCE COLLATE COLLATION COLUMN COMMENT COMMIT CONNECT CONNECTION CONSTRAINT CONSTRAINTS CONTINUE CONVERT CORRESPONDING COUNT COUNTER CREATE CROSS CURRENCY CURRENT CURRENT_DATE CURRENT_TIME CURRENT_TIMESTAMP CURRENT_USER CURSOR DATABASE DATE DATETIME DAY DEALLOCATE DEC DECIMAL DECLARE DEFAULT DEFERRABLE DEFERRED DELETE DESC DESCRIBE DESCRIPTOR DIAGNOSTICS DISCONNECT DISALLOW DISTINCT DISTINCTROW DOMAIN DOUBLE DROP EQV ELSE END END-EXEC ESCAPE EXCEPT EXCEPTION EXEC EXECUTE EXISTS EXTERNAL EXTRACT FALSE FETCH FIRST FLOAT FLOAT4 FLOAT8 FOR FOREIGN FOUND FROM FULL GENERAL GET GLOBAL GO GOTO GRANT GROUP GUID HAVING HOUR IDENTITY IEEEDOUBLE IEEESINGLE IGNORE IMMEDIATE IMAGE IN IMP INDEX INDICATOR INITIALLY INNER INPUT INSENSITIVE INSERT INT INTEGER INTEGER4 INTEGER1 INTEGER2 INTERSECT INTERVAL INTO IS ISOLATION JOIN KEY LANGUAGE LAST LEADING LEFT LEVEL LIKE LOCAL LOCK LOGICAL LOGICAL1 LONG LONGBINARY LONGTEXT LOWER MATCH MAX MEMO MIN MINUTE MODULE MONTH MOD MONEY NAMES NATIONAL NATURAL NCHAR NEXT NO NOT NULL NULLIF NUMBER NUMERIC OCTET_LENGTH OF OFF OLEOBJECT ON ONLY OPEN OPTION OR ORDER OUTER OUTPUT OWNERACCESS OVERLAPS PAD PARTIAL PARAMETERS PERCENT PIVOT POSITION PRECISION PREPARE PRESERVE PRIMARY PRIOR PRIVILEGES PROCEDURE PUBLIC READ REAL REFERENCES RELATIVE RESTRICT REVOKE RIGHT ROLLBACK ROWID ROWS SCHEMA SCROLL SECOND SECTION SELECT SESSION SESSION_USER SET SHORT SINGLE SIZE SMALLINT SOME SPACE SQL SQLCODE SQLERROR SQLSTATE STDev STDEVP STRING SUBTYPE SUBSTRING SUM SYSTEM_USER TABLE TABLEID TEMPORARY TEXT THEN TIME TIMESTAMP TIMEZONE_HOUR TIMEZONE_MINUTE TO TOP TRAILING TRANSACTION TRANSFORM TRANSLATE TRANSLATION TRIM TRUE TYPE UNION UNIQUE UNKNOWN UPDATE UPPER USAGE USER USING VALUE VALUES VAR VARCHAR VARBINARY VARP VARYING VIEW WHEN WHENEVER WHERE WITH WORK WRITE XOR YEAR YESNO ZONE".split(" ");
if(O){if(128<O.length)return this._nameInput.set("invalidMessage",this.i18n.invalidFieldLengthMsg),!1;if(/[`~@#\$%\^&\*\(\)\\\-\+=\|,<>\?\/\{\}\.!'\[\]:;\n\r\s"]/.test(O)||/[`~@#\$%\^&\*\(\)\\\-\+=\|,<>\?\/\{\}\.!'\[\]:;\n\r\d_"]/.test(O.charAt(0)))return this._nameInput.set("invalidMessage",this.i18n.inValidFielNameCharMsg),!1;if(-1!==a.indexOf(U,O.toUpperCase()))return this._nameInput.set("invalidMessage",this.i18n.invalidSqlkeywordsMsg),!1;if(this.params.layer.fields&&0<this.params.layer.fields.length&&
(U=a.map(this.params.layer.fields,function(M){return M.name.toLowerCase()}),-1!==a.indexOf(U,O.toLowerCase())))return this._nameInput.set("invalidMessage",this.i18n.sameFielNameMsg),!1}else return!1;return!0}});p.setObject("arcgisonline.sharing.dijit.dialog.TableAddFieldDlg",e);return e})},"arcgisonline/sharing/dijit/dialog/WaitingDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated"],function(e,K,p){e.provide("arcgisonline.sharing.dijit.dialog.WaitingDlg");
e.require("dijit.Dialog");e.require("dijit._Widget");e.require("dijit._Templated");e.declare("arcgisonline.sharing.dijit.dialog.WaitingDlg",[K._Widget,K._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"waiting-dialog" title\x3d"Notification" execute\x3d""\x3e\r\n    \x3cdiv id\x3d"waiting-dialog-content"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',reference:null,statics:{_instance:null,getInstance:function(){null==
this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.WaitingDlg);return this._instance}},postCreate:function(){this.loadConnections()},show:function(a){this.clear();this.setTitle(a.title);this.setMessage(a.message);this.reference=a.reference;a.error&&e.addClass("waiting-dialog-content","error");esri.isDefined(a.duration)&&(K.byId("waiting-dialog").duration=a.duration);K.byId("waiting-dialog").show()},clear:function(){e.byId("waiting-dialog_title").innerHTML="";e.byId("waiting-dialog-content").innerHTML=
"";e.removeClass("waiting-dialog-content","error")},loadConnections:function(){},setTitle:function(a){a&&(e.byId("waiting-dialog_title").innerHTML=a)},setMessage:function(a){a&&(e.byId("waiting-dialog-content").innerHTML="\x3cp\x3e"+a+"\x3c/p\x3e")},hide:function(a){K.byId("waiting-dialog")&&(this.reference&&a&&this.reference!==a||K.byId("waiting-dialog").hide())}})})},"arcgisonline/pages/item/widgets/_usage":function(){define("require exports tslib ../../../esriGeowConfig ./_usageTheme ../../utils/arrays ../../utils/date ../../utils/number ../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/Color dojo/_base/fx dojo/_base/kernel dojo/on dojo/dom-construct dojo/dom-style dojo/date dojo/promise/all dojo/Deferred dojo/store/Memory dojox/charting/Chart dojox/charting/plot2d/Grid dojox/charting/action2d/Tooltip dojox/charting/action2d/Highlight dojox/charting/action2d/Magnify esri/Evented esri/request dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/_usage.html dojo/text!./templates/_usage-empty.html".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);
B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);return function(){function D(C){this.i18n=E.default;this.templateString=I.default;this.baseClass="usageDiv";this.totReqCountTitle=this.qDateLbl=this.dateToLbl=this.dateFromLbl=this.custDateRngTitle=this.iuTitle="";this.totReqCountVal="--";this.totBandwidthTitle="";this.totBandwidthVal="--";this.avgCountPerDayTitle=
"";this.avgCountPerDayVal="--";this.avgBandwidthPerDayTitle="";this.avgBandwidthPerDayVal="--";this.chartInGmtMsg=this.bwChartTitle=this.countChartTitle=this.loginsVal=this.loginsTitle=this.creditsUsedVal=this.creditsUsedTitle="";this.showFileTypesAsView="Explorer Map;Explorer Layer;Map Document;Published Map;Scene Document;Document Link".split(";");this.activeItem=C.item}D.prototype.postMixInProperties=function(){this.inherited(arguments);this.portal=this.page.portal;this.i18n=p.__assign(p.__assign(p.__assign({},
this.i18n.MapSettingsDlg),this.i18n),this.i18n.usageView);this.periodParam="1d";this.dRangeObj={};this.itemAgeInDays=0;this.dir="ar"===r.default.locale||"he"===r.default.locale?"rtl":"ltr";this.definedQueryLengths=[{queryId:"last24Hours",queryLength:24,factor:"hour"},{queryId:"last7Days",queryLength:7,factor:"day"},{queryId:"last14Days",queryLength:14,factor:"day"},{queryId:"last30Days",queryLength:30,factor:"day"},{queryId:"last45Days",queryLength:45,factor:"day"},{queryId:"last60Days",queryLength:60,
factor:"day"},{queryId:"last6Months",queryLength:6,factor:"month"},{queryId:"last12Months",queryLength:12,factor:"month"}];this.isCustomRange=!1;this.createLocaleDatePatternsStore();this.writePageElements()};D.prototype.startup=function(){this.inherited(arguments);var C=new x.default;this.initUI();C.resolve(this);return C};D.prototype.initUI=function(){this.itemAgeInDays=u.default.difference(new Date(this.activeItem.created));this.dsStart=this.domNode.querySelector("#dsStart");this.dsEnd=this.domNode.querySelector("#dsEnd");
this.dsStart.flipPlacements=["bottom-start"];this.dsEnd.flipPlacements=["bottom-start"];this.initHandlers()};D.prototype.initHandlers=function(){var C=this;this.createDropSelectElements(this.itemAgeInDays).then(function(){C.fetchUsageInfo()});this.own((0,q.default)(document.getElementById("".concat(this.id,"-dateSelect")),"change",function(){return C.fetchUsageInfo()}),(0,q.default)(window,"resize",function(){var y;(null===(y=C.rChart)||void 0===y?0:y.axes)&&C.rChart.resize()}),(0,q.default)(this.dsStart,
"calciteInputDatePickerChange",this.handleDateSelectorChange.bind(this)),(0,q.default)(this.dsEnd,"calciteInputDatePickerChange",this.handleDateSelectorChange.bind(this)),(0,q.default)(this.qDateRngBtn,"click",function(){return C.handleDateRngBtn()}),(0,q.default)(document.getElementById("cntChartDiv"),"click",function(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}),(0,q.default)(this.dsStart,"calciteInputDatePickerBeforeOpen",function(){900>window.innerHeight&&C.dsStart.scrollIntoView({behavior:"smooth",
block:"start",inline:"nearest"})}),(0,q.default)(this.dsEnd,"calciteInputDatePickerBeforeOpen",function(){900>window.innerHeight&&C.dsEnd.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}))};D.prototype.fetchUsageInfo=function(){this.handleViewLoader();this.resetDateRangeErrorMsg();this.usageDateRangeObj=this.calculateDateRange();this.handleDatePickerVisibility();this.isHosted=this.activeItem.isHostedService;this.isFile="file"===this.activeItem.classification&&!m.default.includes(this.activeItem.types,
"is-views")&&!m.default.includes(this.activeItem.types,"is-pdf");this.isAppProxy=this.activeItem.isAppProxy;this.isRegApp=this.activeItem.isRegisteredApp;this.setCountType();this.resetCountValues();if(null!==this.usageDateRangeObj||void 0!==this.usageDateRangeObj)this.usageParams=this.getItemTypeUsageParams(),this.qDatesArr=this.getQueryDatesArr(this.usageParams),this.isRegApp?this.getRegAppInfos(this.qDatesArr,this.usageParams):this.hideRegAppStats(),this.fetchItemUsage(this.qDatesArr,this.usageParams)};
D.prototype.fetchItemUsage=function(C,y){var G=this,L=[],O=this.getUsageUrl(),U=this.usageDateRangeObj,M="1h"===this.periodParam?"1h":"1d";this.writeDateRangeTitle({start:U.startDate,end:U.endDate});C.forEach(function(Q){y.startTime=Q.startDate;y.endTime=Q.endDate;y.period=M;L.push((0,T.default)({url:O,content:y}))});C=(0,v.default)(L);C.then(function(Q){var Y=0,fa=[];Q.forEach(function(va){va=G.getUsageObject(va);Y+=va.count;va.data.forEach(function(Aa){fa.push(Aa)})});0===Y?(t.default.empty("cntChartEmptyDiv"),
G.setNoUsageValue(),G.handleResultsContainerDisplay(!1),G.writeChartTitle(Y),G.handleViewLoader()):(t.default.empty("cntChartDiv"),fa.sort(function(va,Aa){return va.date-Aa.date}),G.handleResultsContainerDisplay(!0),G.writeChartTitle(Y),G.processResults(fa))});C.otherwise(function(Q){G.writeASMErrorReport(Q);G.handleViewLoader()})};D.prototype.getUsageObject=function(C){var y=this,G=[],L=0;if(0<C.data.length)C.data[0].num.forEach(function(Q){Q={epoch:Number(Q[0]),date:new Date(Number(Q[0])),utc:(new Date(Number(Q[0]))).toUTCString(),
count:Number(Q[1]),lbl:y.createChartLabel(Number(Q[0]))};G.push(Q);L+=Q.count});else{var O=new Date(C.startTime);C=u.default.difference(O,new Date(C.endTime));for(var U=0;U<C;U++){var M=u.default.add(O,"day",U);M={epoch:M.getTime(),date:M,utc:M.toUTCString(),count:0,lbl:this.createChartLabel(M.getTime())};G.push(M)}}return this.responseObj={data:G,count:L}};D.prototype.getRegAppInfos=function(C,y){var G=this,L=[],O="1h"===this.periodParam?"1h":"1d",U=this.getUsageUrl();(0,T.default)({url:this.getRegisteredAppInfoUrl(),
content:{f:"json"}}).then(function(M){y.appId=M.client_id;C.forEach(function(Y){Y=p.__assign(p.__assign({},y),{startTime:Y.startDate,endTime:Y.endDate,period:O,appId:M.client_id,vars:"credits,num",name:void 0,groupby:"etype,stype"});L.push((0,T.default)({url:U,content:Y}))});var Q=(0,v.default)(L);Q.then(function(Y){return G.calculateRegAppUsage(Y)});Q.otherwise(function(){return G.hideRegAppStats()})})};D.prototype.hideRegAppStats=function(){document.getElementById("creditsUsedLbl").classList.add("hide");
document.getElementById("loginsValLbl").classList.add("hide");document.getElementById("creditsUsedVal").innerHTML="";document.getElementById("loginsVal").innerHTML=""};D.prototype.handleDatePickerVisibility=function(){var C=this,y=document.getElementById("".concat(this.id,"-dateSelect")).value,G=document.getElementById("datePickerDiv");"dsCustomRng"===y?setTimeout(function(){C.runNodeAnimation("datePickerDiv",{height:480>window.innerWidth?360:200});G.style.overflow="unset";G.style.display="block";
C.createDateSelectors()},100):(this.runNodeAnimation("datePickerDiv",{height:0}),G.style.overflow="hidden")};D.prototype.runNodeAnimation=function(C,y){f.default.animateProperty({node:document.getElementById(C),duration:350,properties:y,onEnd:function(){document.getElementById("datePickerDiv").style.display=0===y.height?"none":"block"}}).play()};D.prototype.createDateSelectors=function(){var C=u.default.add(new Date,"year",-2);if(this.usageDateRangeObj){var y=this.usageDateRangeObj.startDate;var G=
this.usageDateRangeObj.endDate}else y=u.default.add(new Date,"day",-2),G=new Date;this.dsStart.minAsDate=new Date(C.valueOf());this.dsStart.maxAsDate=new Date;this.dsStart.valueAsDate=y;this.dsEnd.minAsDate=new Date(C.valueOf());this.dsEnd.maxAsDate=new Date;this.dsEnd.valueAsDate=G};D.prototype.handleDateSelectorChange=function(){var C=this.dsStart.valueAsDate,y=this.dsEnd.valueAsDate,G=u.default.difference(C,y),L=u.default.isLeapYear(y)?366:365;C&&y&&(0<=G&&G<=L?(this.qDateRngBtn.disabled=!1,this.resetDateRangeErrorMsg()):
(this.qDateRngBtn.disabled=!0,C=document.getElementById("customDateErrorDiv"),C.innerHTML=G>L?this.i18n.dateRangeErrorMsgLength:this.i18n.dateRangeErrorMsgOrder,C.classList.add("is-active")))};D.prototype.calculateDateRange=function(){var C=document.getElementById("".concat(this.id,"-dateSelect")).value;this.isCustomRange=C&&"dsCustomRng"===C;if(!this.isCustomRange){var y=this.definedQueryLengths.filter(function(G){return G.queryId===C});this.dRangeObj={};this.dRangeObj.endDate=new Date;this.dRangeObj.startDate=
u.default.add(new Date,y[0].factor,-1*y[0].queryLength);this.dRangeObj.diff=u.default.difference(this.dRangeObj.startDate,this.dRangeObj.endDate);this.periodParam=this.getPeriodParamVal(this.dRangeObj.diff)}return this.dRangeObj};D.prototype.clearChartDivs=function(){document.getElementById("cntChartDiv").innerHTML=""};D.prototype.getItemTypeUsageParams=function(){var C,y=this.usageDateRangeObj.endDate;if(this.isCustomRange){y=u.default.add(y,"day",1);var G=new Date;y.getTime()>G.getTime()&&(y=G)}y=
{f:"json",startTime:Math.floor(this.usageDateRangeObj.startDate.getTime()/1E3)+"000",endTime:Math.floor(y.getTime()/1E3)+"000",period:this.periodParam,vars:"num",groupby:"name",etype:"svcusg",name:"",stype:this.getUsageStypeByItemType(this.activeItem.type)};if(this.isHosted){G=/(\/(MapServer|WFSServer|GeocodeServer|SceneServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|WMServer|VectorTileServer)).*/gi;var L=null===(C=this.activeItem.url)||void 0===
C?void 0:C.replace(G,"").replace(/^.*\//,"").replace(/\?.*$/,"");y.etype="svcusg";y.name=L;y.stype=this.getUsageStypeByItemType(this.activeItem.type)}else y.name=this.activeItem.id;return y};D.prototype.getUsageUrl=function(){return"".concat(a.default.restBaseUrl,"portals/").concat(this.portal.id,"/usage")};D.prototype.getRegisteredAppInfoUrl=function(){var C=this.activeItem,y=C.owner,G=C.folderId;C=C.id;var L=a.default.restBaseUrl.split(":");L[0]="https:";L="".concat(L[0]).concat(L[1],"content/users/");
return G&&void 0!==G?"".concat(L).concat(y,"/").concat(G,"/items/").concat(C,"/registeredAppInfo"):"".concat(L).concat(y,"/items/").concat(C,"/registeredAppInfo")};D.prototype.getUsageStypeByItemType=function(C){switch(C){case "Feature Service":var y="features";break;case "Map Service":y="tiles";break;case "WFS":y="wfs";break;case "WMTS":y="wmts";break;case "Scene Service":y="scene";break;case "Vector Tile Service":y="vectortiles"}return y};D.prototype.processResults=function(C){var y=0,G=this.usageDateRangeObj.diff;
this.clearChartDivs();this.createUsageCharts(C);this.createAccessibilityTable(C);C.forEach(function(L){y+=L.count;document.getElementById("totReqCountVal").innerHTML=b.default.format(y,0);document.getElementById("avgCountPerDayVal").innerHTML=1<G?b.default.format(y/G,2):"--"});this.handleViewLoader()};D.prototype.setNoUsageValue=function(){this.clearChartDivs();var C='\x3cdiv class\x3d"emptyChartDiv text-center"\x3e'.concat(F.default,'\x3cp class\x3d"font-size-3 text-gray"\x3e').concat(this.i18n.noUsageMsg,
"\x3c/p\x3e\x3c/div\x3e");document.getElementById("totReqCountVal").innerHTML="0";document.getElementById("avgCountPerDayVal").innerHTML="0";var y=document.getElementById("cntChartDiv");t.default.place(C,y,"last");y.classList.add("hide");y=document.getElementById("cntChartEmptyDiv");y.classList.remove("hide");t.default.place(C,y,"last");this.createAccessibilityTable([])};D.prototype.createAccessibilityTable=function(C){var y;document.getElementById("tzMsg").querySelectorAll(".accessTable").forEach(function(L){L.remove()});
if(0<C.length)C.forEach(function(L){G="\x3ctr\x3e\x3ctd\x3e".concat(L.utc,"\x3c/td\x3e\x3ctd\x3e").concat(L.count,"\x3c/td\x3e\x3c/tr\x3e");y+=G});else{var G="\x3ctr\x3e\x3ctd\x3e".concat(this.i18n.noUsageMsg,"\x3c/td\x3e\x3ctd\x3e0\x3c/td\x3e\x3c/tr\x3e");y+=G}C="\x3ctable\x3e\n      \x3ccaption style\x3d'caption-side: top'\x3e\n        ".concat(this.i18n.uTableCaption,"\n      \x3c/caption\x3e\n      \x3cthead\x3e\n        \x3ctr\x3e\n          \x3cth scope\x3d'column'\x3e\n           ").concat(this.i18n.date,
"\n          \x3c/th\x3e\n          \x3cth scope\x3d'column'\x3e\n            ").concat(this.i18n.cValue,"\n          \x3c/th\x3e\n        \x3c/tr\x3e\n      \x3c/thead\x3e\n        ").concat(y,'\n    \x3c/table\x3e"');C='\x3cdiv class\x3d"accessTable screen-readers-only"\x3e'.concat(C,"\x3c/div\x3e");t.default.place(C,"tzMsg","last")};D.prototype.createUsageCharts=function(C){var y=this;this.getUsageChart(C,"cntChartDiv").then(function(G){y.rChart=G;var L=y.getUsageChartTooltipLabel();y.rChart.axes.y.opt.title=
L;new R.default(y.rChart,"default",{scale:3});new P.default(y.rChart,"default",{highlight:"#fff"});new J.default(y.rChart,"default",{text:function(O){return'\x3cspan style\x3d"text-align: center"\x3e'.concat(L,": ").concat(O.y,"\x3c/span\x3e")}});y.rChart.render()})};D.prototype.getUsageChartTooltipLabel=function(){return this.isHosted?this.i18n.requests:this.isFile?m.default.includes(this.showFileTypesAsView,this.activeItem.type)?this.i18n.views:this.i18n.downloads:"Desktop Application"===this.activeItem.type?
this.i18n.downloads:this.i18n.views};D.prototype.getXAxisTitle=function(){var C;return(null===(C=this.periodParam)||void 0===C?0:C.includes("h"))?"":"".concat(this.i18n.date," - (").concat(this.i18n.utc,")")};D.prototype.getUsageChart=function(C,y){var G=new x.default;y=new A.default(y,{dir:"ltr",textDir:this.dir});var L=[],O=0,U=new h.default({r:246,g:249,b:253,a:.8});C.forEach(function(va){L.push(va.count);O=va.count>O?va.count:O});var M=this.calculateVertTickStep(O),Q=this.calculateHorTickStep(),
Y=this.calculateVertOffset(O),fa=this.calculateHortOffset(L.length);y.setTheme(g.default);y.setDir(this.dir);y.addPlot("default",{type:"Areas",markers:!0,tension:"S"});y.addAxis("x",{includeZero:!1,majorTicks:!0,majorTick:{length:6,color:"#D5D5D5",width:1},minorTicks:!1,majorTickStep:Q,labels:!0,titleFontColor:"#959595",htmlLabels:"rtl"!==this.dir,max:L.length+fa,title:this.getXAxisTitle(),titleOrientation:"away",labelFunc:function(va,Aa){va=Aa-1;return va+1>L.length?" ":C[va].lbl}});y.addAxis("y",
{natural:!0,vertical:!0,majorTicks:!0,majorTick:{length:6,color:"#D5D5D5",width:1},minorTicks:!1,includeZero:!0,majorTickStep:M,titleFontColor:"#959595",fixUpper:"major",max:O+Y,htmlLabels:"rtl"!==this.dir,majorLabels:!0,minorLabels:!1,labelFunc:function(va,Aa){return 0===Aa?" ":va}});y.addSeries("usageseries",L,{stroke:{color:"#0079C1",width:2},fill:"rgba(86,165,219,0.5)",marker:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0"});y.addPlot("grid",{type:B.default,renderOnAxis:!0,hFill:U,vFill:U,hMajorLines:!1,
vMajorLines:!1,hStripes:!0,vStripes:!1});G.resolve(y);return G.promise};D.prototype.writeDateRangeTitle=function(C){var y=new Date(C.end),G="rtl"===this.dir?" \x26#8207;":" ";C=n.default.format(new Date(C.start),"long-month-day-year");y=n.default.format(y,"long-month-day-year");document.getElementById("uTitle").innerHTML="\x3cspan class\x3d'font-size--1'\x3e\n        ".concat(this.i18n.iuTitle,"\n      \x3c/span\x3e\n      \x3cbr/\x3e\n      \x3cspan class\x3d'trailer-half header-light font-size-1 text-darkest-gray'\x3e\n        ").concat(C,
"\n        ").concat(G," - ").concat(G,"\n        ").concat(y,"\n      \x3c/span\x3e");this.setLocalTimeStamp()};D.prototype.writeChartTitle=function(C){document.getElementById("countChartTitle").innerHTML=0===C?"":this.i18n.cTitleCountsRequests};D.prototype.createChartLabel=function(C){C=new Date(C);if("1h"===this.periodParam)C=n.default.format(C,"short-time");else return n.default.getDateTimeFormatter({month:"short",day:"numeric",timeZone:"UTC"}).format(C);return C};D.prototype.writePageElements=
function(){this.totReqCountTitle=this.i18n.totalRequests;this.avgCountPerDayTitle=this.i18n.avgDailyRequests;this.creditsUsedTitle=this.i18n.totalCredits;this.countChartTitle=this.i18n.cTitleCountsRequests;this.custDateRngTitle=this.i18n.custDateRngTitle;this.dateFromLbl=this.i18n.dateFromLbl;this.dateToLbl=this.i18n.dateToLbl;this.qDateLbl=this.i18n.qDateLbl;this.loginsTitle=this.i18n.totalLogins};D.prototype.setCountType=function(){var C=document.getElementById("totReqCountLbl"),y=document.getElementById("avgCountPerDayLbl");
this.isHosted?(C.innerHTML=this.i18n.totalRequests,y.innerHTML=this.i18n.avgDailyRequests):this.isFile?m.default.includes(this.showFileTypesAsView,this.activeItem.type)?(C.innerHTML=this.i18n.totalViews,y.innerHTML=this.i18n.avgDailyViews):(C.innerHTML=this.i18n.totalDownloads,y.innerHTML=this.i18n.avgDailyDownloads):("Desktop Application"===this.activeItem.type&&(C.innerHTML=this.i18n.totalDownloads,y.innerHTML=this.i18n.avgDailyDownloads),C.innerHTML=this.i18n.totalViews,y.innerHTML=this.i18n.avgDailyViews)};
D.prototype.createDropSelectElements=function(C){var y=new x.default,G,L=document.getElementById("".concat(this.id,"-dateSelect")),O=L.options;document.getElementById("last24Hours").innerHTML=this.i18n.dsLast24h;document.getElementById("last7Days").innerHTML=this.i18n.dsLast7d;document.getElementById("last14Days").innerHTML=this.i18n.dsLast14d;document.getElementById("last30Days").innerHTML=this.i18n.dsLast30d;document.getElementById("last45Days").innerHTML=this.i18n.dsLast45d;document.getElementById("last60Days").innerHTML=
this.i18n.dsLast60d;document.getElementById("last6Months").innerHTML=this.i18n.dsLast6m;document.getElementById("last12Months").innerHTML=this.i18n.dsLast12m;document.getElementById("dsCustomRng").innerHTML=this.i18n.dsCustomRng;1>C?G="last24hours":1<C&&8>C?G="last7Days":7<C&&15>C?G="last14Days":14<C&&(G="last30Days");for(C=0;C<O.length;C++)O[0].id===G&&(L.selectedIndex=C);y.resolve();return y.promise};D.prototype.handleDateRngBtn=function(){var C=this.dsStart.valueAsDate,y=this.dsEnd.valueAsDate,
G=u.default.difference(C,y);this.qDateRngBtn.disabled=!0;document.activeElement instanceof HTMLElement&&document.activeElement.blur();this.dRangeObj={endDate:y,startDate:C,diff:G};this.periodParam=this.getPeriodParamVal(G);this.fetchUsageInfo()};D.prototype.getPeriodParamVal=function(C){var y;2>C?y="1h":1<C&&90>C?y="1d":89<C&&180>C?y="1w":181<C&&(y="1m");return y};D.prototype.calculateVertTickStep=function(C){return 9<C?Math.round(1.5*C/5):5<C&&10>C?Math.round(1.5*C/2):2};D.prototype.calculateVertOffset=
function(C){var y=0;1<C?y=.5:50<C?y=1:1E3<C?y=10:5E3<C?y=25:1E4<C&&(y=50);return y};D.prototype.calculateHorTickStep=function(){return Math.ceil(this.dRangeObj.diff/30)||1};D.prototype.calculateHortOffset=function(C){var y=.25;250<C?y=5:175<C?y=2.75:60<C?y=1.25:18<C&&(y=.75);return y};D.prototype.setLocalTimeStamp=function(){b.default.format((new Date).getTimezoneOffset()/60*-1)};D.prototype.calculateRegAppUsage=function(C){var y=0,G=0;null===C||void 0===C?void 0:C.forEach(function(L){null===L||void 0===
L?void 0:L.data.forEach(function(O){"svcusg"===O.etype&&"apploginprovider"===O.stype?O.num.forEach(function(U){G+=Number(U[1])}):O.credits.forEach(function(U){y+=Number(U[1])})})});document.getElementById("creditsUsedVal").innerHTML=b.default.format(y,2);document.getElementById("loginsVal").innerHTML=b.default.format(G,0);this.isAppProxy?(document.getElementById("creditsUsedLbl").classList.remove("hide"),document.getElementById("loginsValLbl").classList.add("hide")):(document.getElementById("loginsValLbl").classList.remove("hide"),
document.getElementById("creditsUsedLbl").classList.add("hide"))};D.prototype.getQueryDatesArr=function(C){var y=[],G=C.period,L=C.startTime;C=C.endTime;var O=new Date(Number(L)),U=new Date(Number(C));"1h"===G||"1d"===G?y.push({startDate:L,endDate:C}):y=this.calculateDatesArr(O,U);return y};D.prototype.calculateDatesArr=function(C,y){function G(U){U>=y?L.push({startDate:String(O.getTime()),endDate:String(y.getTime())}):(L.push({startDate:String(O.getTime()),endDate:String(U.getTime())}),O=U,U=u.default.add(O,
"day",60),G(U))}var L=[],O=C;C=u.default.add(O,"day",60);G(C);return L};D.prototype.resetDateRangeErrorMsg=function(){var C=document.getElementById("customDateErrorDiv");C.classList.remove("is-active");C.innerHTML=""};D.prototype.resetCountValues=function(){document.getElementById("totReqCountVal").innerHTML="--";document.getElementById("avgCountPerDayVal").innerHTML="--";document.getElementById("creditsUsedVal").innerHTML="--";document.getElementById("loginsVal").innerHTML="--"};D.prototype.writeASMErrorReport=
function(C){this.clearChartDivs();document.getElementById("totReqCountVal").innerHTML="--";document.getElementById("avgCountPerDayVal").innerHTML="--";C='\x3cdiv class\x3d"emptyChartDiv text-center"\x3e\n        '.concat(F.default,'\n      \x3cp class\x3d"font-size-3 text-gray"\x3e\n        ').concat(this.i18n.errUsageMsg,"\n      \x3c/p\x3e\n      \x3c/div\x3e");t.default.place(C,"cntChartDiv","last");this.createAccessibilityTable([])};D.prototype.createLocaleDatePatternsStore=function(){this.localeDatePatternsStore=
new z.default({data:[{locale:"en",shortTime:"h:mm a",shortDate:"M/d/yy",shortDateNoYear:"M/d",shortDateNoDay:"M/yy"},{locale:"en-us",shortTime:"h:mm a",shortDate:"M/d/yy",shortDateNoYear:"M/d",shortDateNoDay:"M/yy"},{locale:"ar",shortTime:"h:mm a",shortDate:"d/M/y",shortDateNoYear:"d/M",shortDateNoDay:"M/y"},{locale:"ar",shortTime:"h:mm a",shortDate:"y/M/d",shortDateNoYear:"M/d",shortDateNoDay:"y/M"},{locale:"bs",shortTime:"H:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},
{locale:"cs",shortTime:"H:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},{locale:"da",shortTime:"HH:mm",shortDate:"dd/MM/y",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/y"},{locale:"de",shortTime:"HH:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},{locale:"el",shortTime:"h:mm a",shortDate:"d/MM/yy",shortDateNoYear:"d/MM",shortDateNoDay:"M/yy"},{locale:"es",shortTime:"H:mm",shortDate:"d/MM/yy",shortDateNoYear:"d/MM",shortDateNoDay:"MM/yy"},{locale:"et",
shortTime:"HH:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},{locale:"fi",shortTime:"H.mm",shortDate:"d.M.y",shortDateNoYear:"d.M",shortDateNoDay:"M.y"},{locale:"fr",shortTime:"HH:mm",shortDate:"dd/MM/y",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/y"},{locale:"he",shortTime:"H:mm",shortDate:"d.M.y",shortDateNoYear:"d.M",shortDateNoDay:"M.y"},{locale:"hi",shortTime:"h:mm a",shortDate:"d/M/yy",shortDateNoYear:"d/M",shortDateNoDay:"M/yy"},{locale:"hr",shortTime:"HH:mm",shortDate:"dd.MM.y.",
shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"id",shortTime:"HH:mm",shortDate:"dd/MM/yy",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/yy"},{locale:"it",shortTime:"HH:mm",shortDate:"dd/MM/yy",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/yy"},{locale:"ja",shortTime:"H:mm",shortDate:"y/MM/dd",shortDateNoYear:"MM/dd",shortDateNoDay:"y/MM"},{locale:"ko",shortTime:"a h:mm",shortDate:"yy.M.d.",shortDateNoYear:"M.d.",shortDateNoDay:"yy.M"},{locale:"lt",shortTime:"HH:mm",shortDate:"y-MM-dd",shortDateNoYear:"MM-dd",
shortDateNoDay:"y-MM"},{locale:"lv",shortTime:"HH:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},{locale:"nb",shortTime:"HH:mm",shortDate:"dd.MM.y",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"nl",shortTime:"HH:mm",shortDate:"dd-MM-yy",shortDateNoYear:"dd-MM",shortDateNoDay:"MM-yy"},{locale:"pl",shortTime:"HH:mm",shortDate:"dd.MM.y",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"pt-br",shortTime:"HH:mm",shortDate:"dd/MM/y",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/y"},
{locale:"pt-pt",shortTime:"HH:mm",shortDate:"dd/MM/yy",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/yy"},{locale:"ro",shortTime:"HH:mm",shortDate:"dd.MM.y",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"ru",shortTime:"H:mm",shortDate:"dd.MM.y",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"sr",shortTime:"HH:mm",shortDate:"d.M.yy.",shortDateNoYear:"d.M",shortDateNoDay:"M.yy"},{locale:"sv",shortTime:"HH:mm",shortDate:"y-MM-dd",shortDateNoYear:"MM-dd",shortDateNoDay:"y-MM"},{locale:"th",
shortTime:"HH:mm",shortDate:"d/M/yy",shortDateNoYear:"d/M",shortDateNoDay:"M/yy"},{locale:"tr",shortTime:"HH:mm",shortDate:"d.MM.y",shortDateNoYear:"d.MM",shortDateNoDay:"MM.y"},{locale:"vi",shortTime:"HH:mm",shortDate:"dd/MM/y",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/y"},{locale:"zh-cn",shortTime:"ah:mm",shortDate:"y/M/d",shortDateNoYear:"M/d",shortDateNoDay:"y/M"},{locale:"zh-hk",shortTime:"ah:mm",shortDate:"y/M/d",shortDateNoYear:"M/d",shortDateNoDay:"y/M"},{locale:"zh-tw",shortTime:"ah:mm",
shortDate:"y/M/d",shortDateNoYear:"M/d",shortDateNoDay:"y/M"}],idProperty:"locale"})};D.prototype.getLocaleDatePatternValue=function(C,y){var G="MMM d";C=this.localeDatePatternsStore.query({locale:C});0<C.length&&(G=C[0][y]);return G};D.prototype.handleViewLoader=function(){"none"===w.default.get("chartLoaderDiv","display")?w.default.set("chartLoaderDiv","display","block"):w.default.set("chartLoaderDiv","display","none")};D.prototype.handleResultsContainerDisplay=function(C){var y=document.getElementById("cntChartDiv"),
G=document.getElementById("cntChartEmptyDiv");C?(y.classList.remove("hide"),G.classList.add("hide")):(y.classList.add("hide"),G.classList.remove("hide"))};return D=p.__decorate([(0,c.default)(d.default,l.default,S.default)],D)}()})},"arcgisonline/pages/item/widgets/_usageTheme":function(){define(["require","exports","tslib","dojox/charting/SimpleTheme"],function(e,K,p,a){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);e=new a.default({chart:{stroke:null,fill:"inherit"},plotarea:{stroke:null,
fill:"transparent"},axis:{stroke:{width:1,color:"#CCCCCC"},titleFontColor:"#FF0000",tick:{position:"center",font:"normal normal normal 8pt 'Avenir Next W01', 'Avenir Next W00', 'Avenir Next', 'Avenir', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif",labelGap:4},majorTick:{color:"#959595",width:1,length:5},minorTick:{color:"#D5D5D5",width:1,length:2},title:{gap:10,font:"normal normal normal 11pt 'Avenir Next W01', 'Avenir Next W00', 'Avenir Next', 'Avenir', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif",
fontColor:"#959595",orientation:"axis"}},series:{outline:null,stroke:{width:1,color:"#959595"},fill:"#FF0000",font:"normal normal normal 7pt Arial",fontColor:"#717171"},marker:{stroke:{width:1,color:"#000000"},fill:"#333333",font:"normal normal normal 7pt Arial",fontColor:"#959595"},indicator:{lineStroke:{width:1.5,color:"#959595"},lineOutline:{width:.3,color:"#FFFFFF"},lineShadow:null,lineFill:null,stroke:{width:3,color:"#56A5DB"},outline:{width:3,color:"#56A5DB"},shadow:null,fill:"#56A5DB",radius:0,
font:"normal normal normal 11pt 'Avenir Next W01', 'Avenir Next W00', 'Avenir Next', 'Avenir', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif",fontColor:"#FFFFFF",markerFill:"#FF0000",markerSymbol:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",markerStroke:{width:1,color:"#FF0000"},markerOutline:{width:.1,color:"#959595"},markerShadow:null},title:{style:{color:"#FF0000",font:"bold 16px 'Trebuchet MS', Verdana, sans-serif"}},colors:["#5BAFE8","#8C8B62","#CA8536","#70828C","#BFAF99"]});K.default=e})},
"arcgisonline/pages/item/widgets/_preview":function(){define("require exports tslib dojo/dom dojo/on dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dojo/Deferred dojo/text!./templates/_preview.html arcgisonline/pages/utils/notebook arcgisonline/tsutils/declareDecorator arcgisonline/pages/utils/dom ../../utils/queryHandler".split(" "),function(e,K,p,a,g,m,n,b,c,d,l,h,f,r){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);
d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importStar(r);return function(){function q(t,w){this.templateString=d.default;this.queryObject=r.queryToObject(window.location.search.substring(1))}q.prototype.startup=function(){this.inherited(arguments);return this.initUI()};q.prototype.postCreate=function(){this.inherited(arguments);f.default.hideNode(document.getElementById("footer"))};q.prototype.destroy=function(){this.inherited(arguments);this.page.removeError();
f.default.showNode(a.default.byId("footer"))};q.prototype.setupEventListeners=function(){var t=this;(0,g.default)(this.notebookFrame,"load",function(){t.loader.classList.remove("is-active");t.notebookFrame.style.display="inherit";t.notebookFrame.style.height="".concat(t.notebookFrame.contentWindow.document.body.scrollHeight+50,"px")})};q.prototype.initUI=function(){var t=this,w=new c.default;this.setupEventListeners();l.default.showNotebookPreview(this.notebookFrame,this.queryObject.id,"notebook_preview.json").then(function(u){u.success||
t.showPreviewError();w.resolve(u.success)},function(u){t.showPreviewError(u);w.resolve(!1)});return w};q.prototype.showPreviewError=function(t){var w=this.i18n.itemProperties,u=w.previewError404;w=w.previewError;this.error.innerHTML=404===(null===t||void 0===t?void 0:t.code)?u:w;m.default.add(this.error,"is-active");this.page.hideLoader()};return q=p.__decorate([(0,h.default)(n.default,b.default)],q)}()})},"arcgisonline/pages/item/widgets/_layers":function(){define("require exports tslib dojo/_base/lang dojo/Deferred dojo/dom-class dojo/dom-attr dojo/on dojo/topic dojo/string dojo/promise/all dojo/cookie dijit/_WidgetBase dijit/_TemplatedMixin arcgisonline/pages/item/_Info arcgisonline/pages/pageUtil arcgisonline/pages/utils/alerts arcgisonline/pages/utils/arrays arcgisonline/pages/utils/date arcgisonline/pages/dijit/View arcgisonline/pages/dijit/Pagination arcgisonline/pages/dijit/ControlBar arcgisonline/sharing/dijit/dialog/CreateLayersDlg arcgisonline/sharing/dijit/dialog/SyncLayersDlg arcgisonline/sharing/util arcgisonline/esriGeowConfig dojo/text!./templates/_layers.html dojo/text!./templates/layers/_empty.html dojo/text!./templates/layers/_none.html dojo/text!./templates/layers/_tableHead.html dojo/text!./templates/layers/_tableRow.html dojo/text!./templates/layers/_controlBarActions.html dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/tsutils/declareDecorator arcgisonline/pages/utils/dom preact dojo/dom-construct ../../utils/formatters".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=
p.__importDefault(A);B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);D=p.__importDefault(D);C=p.__importDefault(C);y=p.__importDefault(y);G=p.__importDefault(G);O=p.__importDefault(O);U=p.__importDefault(U);return function(){function M(){this.templateString=d.default.substitute(S.default,{i18n:C.default});this.initialView="table";this.filteredLayers=
[];this.searchTerm="";this.searchBy="layerName";this.folderSvg='\x3csvg viewBox\x3d"0 0 16 16" width\x3d"16" height\x3d"16" class\x3d"folder-icon"\x3e\x3cpath d\x3d"M7.3 3.002L5.98 2H3L1.7 3H0v11h15V3zM14 6H1V4h1.04l1.3-1h2.304l1.319 1H14zm0 7H1V7h13z"\x3e\x3c/path\x3e\x3c/svg\x3e';this.tablePage={start:1,num:20,total:0,nextStart:-1};this._sort={property:"created",label:C.default.itemProperties.layerCreated,ascending:!1};this.sortOptions=[{property:"layerName",label:C.default.itemProperties.layerName1,
ascending:!0},{property:"layerType",label:C.default.itemProperties.layerTypeLabel,ascending:!0},{property:"datasetName",label:C.default.itemProperties.datasetName,ascending:!0},{property:"created",label:C.default.itemProperties.layerCreated,ascending:!1,active:!0}]}M.prototype.postCreate=function(){this.inherited(arguments);this.i18n=C.default;this.sortOptions=a.default.clone(this.sortOptions)};M.prototype.startup=function(){var Q=this;this.inherited(arguments);this.addEventListeners();this.setHelpLinks();
this.syncLayersInfo();var Y=new g.default;this.getLayersAndStatus().then(function(){return Q.initUI(!0)}).then(function(fa){return Y.resolve(fa)},function(fa){return Y.reject(fa)});return Y};M.prototype.setHelpLinks=function(){var Q=R.default.self;this._createLayersMessage.innerHTML=d.default.substitute(this.i18n.itemProperties.createLayersMessage,[(null===Q||void 0===Q?0:Q.helpMap)?Q.helpBase+Q.helpMap.m["120001719"]:""])};M.prototype.getLayersAndStatus=function(){var Q=this,Y=new g.default;(0,l.default)([this.getItemStatus(),
this.getLayers()]).then(function(fa){var va=fa[0];fa=fa[1];va&&fa?(Q.status=va,Q.layers=fa.layerAndDatasets.map(function(Aa){var pa,N,V=Aa.layer;"map service"===(null===(pa=null===V||void 0===V?void 0:V.type)||void 0===pa?void 0:pa.toLowerCase())?(V.iconUrl="/mapimages16.svg",V.layerType="Map Image Layer"):"feature service"===(null===(N=null===V||void 0===V?void 0:V.type)||void 0===N?void 0:N.toLowerCase())?(V.iconUrl="/features16.png",V.layerType="Feature Layer"):(V.iconUrl="/features16.png",V.layerType=
"");pa=V.id;N=V.title;var Z=V.created,ba=V.type,ma=V.url;return{info:q.default.getItemInfo(V),itemUrl:"".concat(R.default.baseUrl,"item.html?id\x3d").concat(pa),layerId:pa,layerName:N,layerType:V.layerType,layerUrl:ma,iconUrl:Aa.layer.svgIconUrl16,createdDisplay:Q.formatDate(parseInt(Z,10),"medium"),created:Z,datasetName:Q.formatPath(Aa.dataset.path),datasetType:ba}})):Q.status={status:"error",message:(null===va||void 0===va?void 0:va.message)||""};Q.checkDeleteJob();Q.checkSyncJob();Q.isDeleteJob||
Q.findPublishedFolder();Y.resolve()});return Y};M.prototype.formatPath=function(Q){return"/"===(null===Q||void 0===Q?void 0:Q[0])?Q.substring(1):Q};M.prototype.findPublishedFolder=function(){var Q=this;this.getFolder().then(function(Y){Y.currentFolder&&(Q.folder=Y.currentFolder,Q._folderContainer.innerHTML=d.default.substitute(Q.i18n.itemProperties.layersFolder,[Q.folderSvg,'\x3ca class\x3d"tooltip tooltip-top" aria-label\x3d"'.concat(Q.i18n.itemProperties.viewLayersFolder,'" href\x3d"').concat(R.default.baseUrl,
"content.html?folder\x3d").concat(Q.folder.id,'"\x3e').concat(Q.folder.title,"\x3c/a\x3e")]))},function(Y){})};M.prototype.checkDeleteJob=function(){var Q,Y;this.isDeleteJob="deleteAllBPLayers"===(null===(Y=null===(Q=this.status)||void 0===Q?void 0:Q.jobInfo)||void 0===Y?void 0:Y.jobType)};M.prototype.formatDate=function(Q,Y){var fa;!1===Q instanceof Date&&(fa=new Date(Q));var va="short-date-numeric";"medium"===Y?va="day-short-month-year":"long"===Y&&(va="long-month-day-year");return Q?v.default.format(fa,
va):""};M.prototype.startDeleteLayers=function(){var Q=this;t.default.createConfirmationDialog({strings:{title:C.default.common.deleteLabel,description:1===this.layers.length?C.default.deleteWarningDlg.confirmDeleteSingleItem:C.default.deleteWarningDlg.confirmDeleteMultipleItems,ok:C.default.common.deleteLabel},okColor:"red",autoCloseOnOk:!0,onOk:function(){Q.handleDelete()}})};M.prototype.handleDelete=function(){var Q=this;this.hidePublishedLayers();G.default.showNode(this.domNode.querySelector(".icon-ui"));
G.default.hideNode(this._dismissBtn);G.default.showNode(this._iconJobRunning);G.default.showNode(this._notificationContainer);G.default.hideNode(this._errorContainer);this._statusTextContainer.innerHTML=this.i18n.itemProperties.deletingLayers;P.default.request({url:"".concat(R.default.restBaseUrl,"portals/self/datastores/allDatasets/deleteLayers"),content:{datastoreId:this.item.id}},{usePost:!0}).then(function(){(0,h.default)("dismissLayersTabNotification".concat(Q.item.id),null,{expires:-1});Q.getLayersAndStatus().then(function(){return Q.initUI()})},
function(){w.default.showAlert("error",Q.i18n.itemProperties.deleteLayersError)})};M.prototype.getFolder=function(){var Q=this,Y,fa=new g.default,va=null;(null===(Y=this.layers)||void 0===Y?0:Y.length)?(va=this.layers[0].layerId,P.default.request({url:"".concat(R.default.restBaseUrl,"content/items/").concat(va)}).then(function(Aa){Aa.ownerFolder&&P.default.request({url:"".concat(R.default.restBaseUrl,"content/users/").concat(Q.portalUser.username,"/").concat(Aa.ownerFolder)}).then(fa.resolve,fa.reject)},
function(Aa){return fa.reject(Aa)})):fa.reject();return fa};M.prototype.getLayers=function(){var Q=this,Y=new g.default;P.default.request({url:"".concat(R.default.restBaseUrl,"portals/self/datastores/allDatasets/getLayers"),content:{datastoreId:this.item.id}},{usePost:!0}).then(function(fa){return Y.resolve(fa)},function(fa){Q.showError(fa);Y.reject(fa)});return Y};M.prototype.getItemStatus=function(){var Q=this,Y=new g.default;P.default.request({url:"".concat(R.default.restBaseUrl,"content/users/").concat(this.item.owner,
"/items/").concat(this.item.id,"/status")}).then(function(fa){Y.resolve(fa)},function(fa){Q.showError(fa);Y.reject(fa)});return Y};M.prototype.initUI=function(Q){var Y=this,fa=new g.default;if(Q){Q=this.i18n;var va=this.page,Aa=va.portalUser,pa=va.portal;va=Q.itemProperties;var N=this.domNode.querySelector(".js-view-wrap");Aa={select:!1,sortOptions:this.sortOptions,emptyView:d.default.substitute(T.default,{i18n:Q}),noneView:E.default,tableHead:I.default,tableRow:F.default,portalUser:Aa,portal:pa,
activeView:this.initialView};Q={search:{placeholder:va.searchLayers,searchTerm:""},views:{activeView:this.initialView,views:["table"]},sort:this.sortOptions,viewContainer:N,actions:d.default.substitute(D.default,{i18n:Q})};this._controlBar=new A.default(Q,this.domNode.querySelector(".js-control-bar"));this._syncLayersBtn=this.domNode.querySelector("#syncLayersBtn");this.domNode.querySelector("#syncTime").innerHTML=this.i18n.itemProperties.lastSynced+U.default.completeDate(this.syncLayersTime);this.item.isOwner?
this.own((0,b.default)(this._syncLayersBtn,"click",function(){return Y.syncLayers()}),(0,b.default)(this._createLayersBtn,"click",function(){return Y.createLayers()})):G.default.disableNodes([this._syncLayersBtn,this._createLayersBtn],!0);this.view=new x.default(Aa,this.domNode.querySelector(".js-views"));this.pagination=new z.default({start:this.initialStart,num:this.tablePage.num},this.domNode.querySelector(".js-pagination"))}this.layers.length||this.status.status&&"error"!==this.status.status&&
"null"!==this.status.status?this.status.status?this.processJobStatus(this.status):this.status.status&&"error"!==this.status.status||!this.layers.length?(this._errorMessage.innerHTML=this.i18n.itemProperties.layersError,G.default.showNode(this._errorContainer),this.page.hideLoader()):(this.showPublishedLayers(),G.default.hideNode(this._notificationContainer),this.domNode.querySelector("syncLayersBtn").removeAttribute("disabled"),m.default.remove(this._deleteBtn,"hide"),m.default.remove(this._folderContainer,
"hide")):G.default.showNode(this._createLayersContainer);this.filteredLayers=a.default.clone(this.layers);this.initLayerGrid();fa.resolve(!0);return fa};M.prototype.render=function(){this.updateView(this.updateState())};M.prototype.showPublishedLayers=function(){G.default.hideNode(this._createLayersContainer);this.layers.length&&G.default.showNodes([this._controlBarContainer,this._layersListContainer])};M.prototype.hidePublishedLayers=function(){G.default.hideNodes([this._controlBarContainer,this._layersListContainer])};
M.prototype.processJobStatus=function(Q){var Y=this,fa=this.i18n.itemProperties,va=fa.bulkPublishSyncJobRunning,Aa=fa.bulkPublishJobRunning,pa=fa.bulkPublishJobNumbers,N=fa.deletingLayers,V=fa.deleteLayersError,Z=fa.bulkPublishSyncJobCompleted,ba=fa.bulkPublishJobCompleted,ma=fa.itemsDeleteSuccess;fa=fa.bulkPublishJobUnknownError;switch(Q.status.toUpperCase()){case "PARTIAL":case "PROCESSING":G.default.hideNodes([this._iconJobUnknownStatus,this._iconJobCompleted,this._dismissBtn]);G.default.showNodes([this._notificationContainer,
this._iconJobRunning]);G.default.disableNode(this._syncLayersBtn,!0);this.isDeleteJob?this._statusTextContainer.innerHTML=N:(this.showPublishedLayers(),this._statusTextContainer.innerHTML=this.isSync?va:Aa,Q.jobProgress&&(Q=Q.jobProgress,va=Q.publishing,this._statusTextContainer.innerHTML+=d.default.substitute(pa,[this.isSync?va:this.layers.length,Q.total])));setTimeout(function(){Y.getLayersAndStatus().then(Y.initUI.bind(Y));Y.syncLayersInfo()},1E4);break;case "COMPLETED":G.default.hideNode(this._iconJobRunning);
G.default.showNodes([this._dismissBtn,this._iconJobCompleted]);this.layers.length?(G.default.showNodes([this._deleteBtn,this._folderContainer]),this.item.isOwner&&this._syncLayersBtn.removeAttribute("disabled"),this.showNotification(),this.showPublishedLayers(),this.isDeleteJob?this._statusTextContainer.innerHTML=V:(this.domNode.querySelector("#syncTime").innerHTML=this.i18n.itemProperties.lastSynced+U.default.completeDate(this.syncLayersTime),this._statusTextContainer.innerHTML="".concat(this.layers.length,
" ").concat(this.isSync?Z:ba))):(this.isDeleteJob&&(this._statusTextContainer.innerHTML=ma,this.showNotification()),G.default.showNode(this._createLayersContainer));break;case "FAILED":G.default.showNodes([this._dismissBtn,this._iconJobUnknownStatus]);G.default.hideNode(this._iconJobRunning);this._statusTextContainer.innerHTML=this.isDeleteJob?V:fa;pa=!this.showNotification();this.layers.length?(G.default.showNodes([this._deleteBtn,this._folderContainer]),this.item.isOwner&&(this._syncLayersBtn.removeAttribute("disabled"),
n.default.remove(this._syncLayersBtn,"disabled")),this.showPublishedLayers()):pa&&G.default.showNode(this._createLayersContainer);break;default:G.default.hideNode(this._iconJobRunning),G.default.showNodes([this._dismissBtn,this._iconJobUnknownStatus,this._deleteBtn,this._folderContainer]),this.item.isOwner&&this._syncLayersBtn.removeAttribute("disabled"),this.showNotification(),this.showPublishedLayers(),this._statusTextContainer.innerHTML=fa}};M.prototype.updateState=function(){var Q=this.pagination.getCurrentPageObj(),
Y=1===this.tablePage.start&&Q.num===this.tablePage.num;this.tablePage.start=Y?this.tablePage.start:Q.start;this.tablePage.total=Y?this.filteredLayers.length:Q.total;this.tablePage.nextStart=Y?this.tablePage.start+this.tablePage.num:Q.nextStart;return this.filteredLayers.slice(this.tablePage.start-1,-1!==this.tablePage.nextStart?this.tablePage.nextStart-1:this.tablePage.total)};M.prototype.initLayerGrid=function(Q){Q&&a.default.mixin(this._sort,Q);c.default.publish("sort/update",a.default.clone(this._sort))};
M.prototype.updateView=function(Q){c.default.publish("view/update",Q);this.pagination.render(this.tablePage);Q=this.pagination.getCurrentPageObj();this._rangeText.textContent=t.default.getPageRangeString({start:0!==Q.total?Q.start:Q.total,end:Q.total<Q.end?Q.total:Q.end,total:Q.total});return!0};M.prototype.addEventListeners=function(){this.own((0,b.default)(this._deleteBtn,"click",this.startDeleteLayers.bind(this)),(0,b.default)(this._dismissBtn,"click",this.dismissNotification.bind(this)),c.default.subscribe("sort/update",
this.sortUpdate.bind(this)),c.default.subscribe("search/update",this.searchUpdate.bind(this)),c.default.subscribe("pagination/page",this.paginationPage.bind(this)))};M.prototype.searchUpdate=function(Q){var Y=this;this.searchTerm=Q;this.tablePage.start=1;c.default.publish("view/loading",Q);this.filteredLayers=Q?this.layers.filter(function(fa){var va;return u.default.includes(null===(va=fa.layerName)||void 0===va?void 0:va.toLowerCase(),Y.searchTerm.toLowerCase())}):a.default.clone(this.layers);c.default.publish("sort/update",
a.default.clone(this._sort))};M.prototype.sortUpdate=function(Q){this.tablePage.start=1;this.filteredLayers=Q.ascending?this.filteredLayers.sort(function(Y,fa){return Y[Q.property]>fa[Q.property]?1:Y[Q.property]<fa[Q.property]?-1:0}):this.filteredLayers.sort(function(Y,fa){return Y[Q.property]<fa[Q.property]?1:Y[Q.property]>fa[Q.property]?-1:0});this.render()};M.prototype.paginationPage=function(Q){this.tablePage.start=Q.start;this.render()};M.prototype.createLayers=function(){var Q=this,Y=this.page,
fa=new B.default({portal:Y.portal,portalUser:Y.portalUser,datastoreId:this.item.id});fa.startup().then(function(){b.default.once(fa.dialog,"hide",function(){(0,h.default)("publishLayersSyncJob".concat(Q.item.id),null,{expires:-1});(0,h.default)("dismissLayersTabNotification".concat(Q.item.id),null,{expires:-1});Q.getLayersAndStatus().then(function(){return Q.initUI()},function(va){return Q.showError(va)})})},function(va){return Q.showError(va)})};M.prototype.showError=function(Q){var Y=this.i18n.itemProperties.error.error;
Q.message&&(Y+=": ".concat(Q.message));w.default.showAlert("error",Y)};M.prototype.syncLayers=function(){var Q=this,Y=document.createElement("div");Y.id="sync-layers-modal";document.body.appendChild(Y);(0,L.render)((0,L.h)(J.default,{openModal:!0,itemId:this.item.id,dateFieldsRespectsDayLightSavingTime:this.dateFieldsRespectsDayLightSavingTime,dateFieldsTimezoneID:this.dateFieldsTimezoneID,preferredTimeZoneID:this.preferredTimeZoneID,preferredTimeZoneRespectsDayLightSavingTime:this.preferredTimeZoneRespectsDayLightSavingTime,
datesInUnknownTimeZone:this.datesInUnknownTimeZone,hasSyncProperties:this.hasSyncProperties}),document.getElementById("sync-layers-modal"));Y.addEventListener("calciteModalClose",function(){O.default.destroy(Y)});document.addEventListener("cancel",function(){O.default.destroy(Y)});document.addEventListener("closeDlg",function(){O.default.destroy(Y);(0,h.default)("publishLayersSyncJob".concat(Q.item.id),"syncing");Q.getLayersAndStatus().then(function(){return Q.domNode.querySelector("#syncTime").innerHTML=
Q.i18n.itemProperties.lastSynced+U.default.completeDate(Q.syncLayersTime),Q.initUI()},function(fa){return Q.showError(fa)})})};M.prototype.checkSyncJob=function(){this.isSync=!!(0,h.default)("publishLayersSyncJob".concat(this.item.id))};M.prototype.dismissNotification=function(){var Q,Y;(0,h.default)("dismissLayersTabNotification".concat(this.item.id),this.item.id);G.default.hideNode(this._notificationContainer);"FAILED"!==((null===(Q=this.status)||void 0===Q?void 0:Q.status)||"").toUpperCase()||
(null===(Y=this.layers)||void 0===Y?0:Y.length)||this.initUI()};M.prototype.showNotification=function(){if((0,h.default)("dismissLayersTabNotification".concat(this.item.id)))return!1;G.default.showNode(this._notificationContainer);return!0};M.prototype.destroy=function(){this.inherited(arguments)};M.prototype.syncLayersInfo=function(){var Q=this;P.default.request({url:"".concat(R.default.restBaseUrl,"content/users/").concat(this.portalUser.username,"/items/").concat(this.item.id,"/resources")}).then(function(Y){var fa;
Q.syncLayersTime=null===(fa=null===Y||void 0===Y?void 0:Y.resources[1])||void 0===fa?void 0:fa.created},function(Y){var fa;(null===(fa=null===Q||void 0===Q?void 0:Q.layers)||void 0===fa?0:fa.length)&&!Q.isDeleteJob&&Q.showError(Y)});P.default.request({url:"".concat(R.default.restBaseUrl,"content/users/").concat(this.portalUser.username,"/items/").concat(this.item.id,"/resources/templateServiceConfiguration.json")}).then(function(Y){Y.properties&&(Q.hasSyncProperties=!0,Q.dateFieldsRespectsDayLightSavingTime=
Y.properties.dateFieldsRespectsDayLightSavingTime,Q.dateFieldsTimezoneID=Y.properties.dateFieldsTimezoneID,Q.preferredTimeZoneID=Y.properties.preferredTimeZoneID,Q.preferredTimeZoneRespectsDayLightSavingTime=Y.properties.preferredTimeZoneRespectsDayLightSavingTime,Q.datesInUnknownTimeZone=Y.properties.datesInUnknownTimeZone)},function(Y){var fa;(null===(fa=null===Q||void 0===Q?void 0:Q.layers)||void 0===fa?0:fa.length)&&!Q.isDeleteJob&&Q.showError(Y)})};return M=p.__decorate([(0,y.default)(f.default,
r.default)],M)}()})},"arcgisonline/pages/dijit/Pagination":function(){define("require exports tslib dojo/on dojo/topic dojo/query dojo/string dojo/dom-attr dojo/dom-class dojo/_base/event dijit/_TemplatedMixin dijit/_WidgetBase calcite-web/js/calcite-web ../pageUtil ../utils/dom ../utils/icons dojo/text!./Pagination/templates/Number.html dojo/text!./Pagination/templates/Ellipsis.html dojo/text!./Pagination/templates/Pagination.html dojo/i18n!../../nls/arcgisonline arcgisonline/tsutils/declareDecorator".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);return function(){function A(B,J){this.templateString=
v.default;this.pageSizeLabel=x.default.contentPage.paginationPerPage;this.i18n=x.default;this.icons=t.default;this.smallestPageSize=this.num=20;this.topic=""}A.prototype.postCreate=function(){this.inherited(arguments);this._addEventListeners();this.hideDropdown&&q.default.hideNode(this._pageDropdown)};A.prototype.render=function(B){this.total=B.total;this.start=B.start;this.nextStart=B.nextStart;this.end=-1===this.nextStart?this.total:this.nextStart-1;this.currentPage=(this.start-1)/this.num+1;this.pages=
Math.ceil(this.total/this.num);this._updateUI()};A.prototype._addEventListeners=function(){var B=this;this.own((0,a.default)(this.next,"click",function(J){d.default.stop(J);B.nextPage()}),(0,a.default)(this.pageLinks,"click",function(J){var P;d.default.stop(J);if(J=b.default.get(J.target,"data-page"))null===(P=B.telemetry)||void 0===P?void 0:P.logEvent({pageUrl:window.location.href,category:"Change page",action:J}),B.selectPage(J)}),(0,a.default)(this.previous,"click",function(J){d.default.stop(J);
B.previousPage()}),(0,m.default)(".js-page-num-link",this.domNode).on("click",function(J){J=J.target.getAttribute("data-num");B.updateNum(J)}))};A.prototype._updateUI=function(){var B=this.currentPage,J=Math.min(this.pages,Math.floor(1E4/this.num)),P=(0,m.default)(".js-btn-previous",this.domNode),R=(0,m.default)(".js-btn-next",this.domNode);(0,m.default)(".js-btn",this.domNode).addClass("btn-transparent");1===B?P.addClass("btn-disabled").attr("tabindex",-1):P.removeClass("btn-disabled").removeAttr("tabindex");
-1===this.nextStart||1E4<this.nextStart+this.num?R.addClass("btn-disabled").attr("tabindex",-1):R.removeClass("btn-disabled").removeAttr("tabindex");this._pageNumLabel.innerHTML=n.default.substitute(this.pageSizeLabel,{num:this.num});(0,m.default)(".js-page-num-link",this.domNode).removeClass("is-active");(0,m.default)(".js-page-num-link[data-num\x3d'"+this.num+"']",this.domNode).addClass("is-active");if(1<J){R=Math.max(4,B);var S=12<J&&J<R+3;P=[];if(6>J)for(R=1;R<=J;R++)P.push(R);else{if(4<B)P.push(1,
"..."),S||P.push(B-1,B);else for(var T=1;T<=B;T++)P.push(T);if(4>B&&4<J)for(T=B+1;4>=T;T++)P.push(T);if(S)for(R=J-3;R<=J;R++)P.push(R);else if(2<J-R)P.push(R+1,"...",J);else for(R+=1;R<=J;R++)P.push(R)}this.pageLinks.innerHTML='\x3cul class\x3d"clear-list-style flex-center"\x3e'.concat(P.reduce(function(E,I){var F=I===B;return E+n.default.substitute("..."===I?u.default:w.default,{pageNum:I,"is-active":F?"no-pointer pagination-btn--active":"btn-transparent pagination-btn--inactive",label:n.default.substitute(F?
x.default.contentPage.paginationActive:x.default.contentPage.paginationLink,{pageNum:I}),current:F?"aria-current\x3d'true' tabindex\x3d'-1'":""})},""),"\x3c/ul\x3e");c.default.remove(this.domNode,"hide");c.default.remove(this.navigation,"hide")}else this.total>this.smallestPageSize?(c.default.add(this.navigation,"hide"),c.default.remove(this.domNode,"hide")):c.default.add(this.domNode,"hide");(0,m.default)(".js-over-limit",this.domNode).removeClass("is-active");1E4<=this.total&&1E4<=this.start+this.num&&
(0,m.default)(".js-over-limit",this.domNode).addClass("is-active")};A.prototype.setInitialProperties=function(B){this.start=B.start||this.start;this.num=B.num||this.num;this._updateUI()};A.prototype.selectPage=function(B){this.currentPage=parseInt(B||1,10);this.start=(this.currentPage-1)*this.num+1;this.nextStart=this.start+this.num>this.total?-1:this.start+this.num;this.end=-1===this.nextStart?this.total:this.nextStart-1;this._updateUI();this.topic||r.default.updateQueryParams({start:this.start,
num:this.num});g.default.publish(this.topic+"pagination/page",this.getCurrentPageObj())};A.prototype.nextPage=function(){var B;this.currentPage=Math.min(this.currentPage+1,this.pages);null===(B=this.telemetry)||void 0===B?void 0:B.logEvent({pageUrl:window.location.href,category:"Change page",action:"Next"});this.selectPage(this.currentPage)};A.prototype.previousPage=function(){var B;this.currentPage=Math.max(this.currentPage-1,1);null===(B=this.telemetry)||void 0===B?void 0:B.logEvent({pageUrl:window.location.href,
category:"Change page",action:"Prev"});this.selectPage(this.currentPage)};A.prototype.updateNum=function(B){var J,P=parseInt(B,10);P!==this.num&&(this.num=P,this.pages=Math.ceil(this.total/this.num),null===(J=this.telemetry)||void 0===J?void 0:J.logEvent({pageUrl:window.location.href,category:"Row count per page",action:B}),this.selectPage(1),f.default.bus.emit("dropdown:close"))};A.prototype.getCurrentPageObj=function(){return{num:this.num,total:this.total,start:this.start,end:this.end,nextStart:this.nextStart,
currentPage:this.currentPage,pages:this.pages}};A.prototype.hide=function(){this.domNode.classList.add("hide")};A.prototype.show=function(){this.domNode.classList.remove("hide")};return A=p.__decorate([(0,z.default)(h.default,l.default)],A)}()})},"arcgisonline/sharing/dijit/dialog/CreateLayersDlg":function(){define("require esri/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin calcite-web/js/calcite-web arcgisonline/esriGeowConfig arcgisonline/sharing/util arcgisonline/pages/pageUtil arcgisonline/sharing/dijit/_federated-servers-table arcgisonline/sharing/dijit/dialog/GeneralDlg arcgisonline/sharing/dijit/dialog/CreateFolder arcgisonline/pages/dijit/InfoTooltip arcgisonline/sharing/dijit/_TimezoneUtils dijit/Dialog dojo/cookie dojo/json dojo/Deferred dojo/promise/all dojo/_base/array dojo/_base/url dojo/on dojo/string dojo/query dojo/dom-class dojo/dom-attr dojo/topic dojo/text!./templates/CreateLayersDlg.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E){return K([p,a,g],{templateString:B.substitute(T,{i18n:E.CreateLayersDlg}),dialog:null,servers:null,currentStep:null,item:null,postCreate:function(){this.inherited(arguments)},constructor:function(I){this.currentStep=1;this.i18n=E;this.datastoreId=I.datastoreId;this.item={datastoreId:I.datastoreId};this.serversUrl=n.restBaseUrl+"portals/self/datastores/getServers";this.publishLayersUrl=n.restBaseUrl+"portals/self/datastores/allDatasets/publishLayers";
this.serverFolderOption="sameAsPortalFolder";this.folderRegex=/\s|\+|\?|&|\/|\(|\)|\\|!|#|"|\||\*|:|<|>|%|\$|@|'|\^|\[|\]|,|=|;/gi},startup:function(){this.inherited(arguments);this._addTimeZone();this.loadToolTip();var I=new u;v({tags:b.loadUserTags(this.portalUser.username),categories:this.portal.getCategories(),folders:this.portalUser.getFolders(),servers:b.request({url:this.serversUrl,content:{datastoreId:this.datastoreId}},{usePost:!0})}).then(function(F){this._setupFolders(F.folders);this._setupServers(F.servers);
this._showModal();I.resolve()}.bind(this),function(F){I.reject(F)});return I},_setupServers:function(I){this.servers=I.servers;this.serversTable=(new d({federatedServers:this.servers,datastoreId:this.datastoreId,singleSelect:!0})).placeAt(this.serversGridContainer)},_setupFolders:function(I){var F=(I||[]).filter(function(D){return D.id!==this.portalUser.username}.bind(this));F.unshift({title:I.length?E.CreateLayersDlg.selectFolder:E.CreateLayersDlg.createFolder,id:""});this._folders.options=x.map(F,
"return { label:item.title, value:item.id };");this._folders.set("value","")},_addFolder:function(I){this._removePreviouslyAddedFolder(I);this._setSelectionText();this._folders.addOption([{label:I.title,value:I.id}]);this._folders.set("value",I.id)},_removePreviouslyAddedFolder:function(I){this.folderAdded&&this._folders.removeOption(this.folderAdded);this.folderAdded=I.id},_setSelectionText:function(){for(var I=0;I<this._folders.options.length;I++){var F=this._folders.options[I];if(!F.value){F.label=
E.CreateLayersDlg.selectFolder;break}}},_showModal:function(){this.dialog=new q({title:E.itemProperties.createLayers,content:this.domNode,class:"create-layers-dlg",onHide:this.destroy.bind(this),closable:!0,autofocus:!1});this.dialog.show().then(function(){this.dialog.closeButtonNode.tabIndex=0;this.dialog.closeButtonNode.focus();this.addEventListeners();m.init()}.bind(this))},addEventListeners:function(){this.own(A(this.createButton,"click",function(I){I.preventDefault();this._createFolder()}.bind(this)),
A(this.cancelButton,"click",function(I){I.preventDefault();this.dialog.hide()}.bind(this)),A(this.nextButton,"click",function(I){I.preventDefault();this._validateStep(this.currentStep)&&this._goToStep(this.currentStep+1)}.bind(this)),A(this.backButton,"click",function(I){I.preventDefault();this._goToStep(this.currentStep-1)}.bind(this)),A(this.startButton,"click",function(I){I.preventDefault();this._validateStep(this.currentStep)&&this._startPublishLayers(this.item)}.bind(this)),A(this.serverFolder,
"input",function(I){this._generateExampleUrl()}.bind(this)),S.subscribe("servers/serverAutoSelected",function(){this._generateExampleUrl()}.bind(this)),J("input[name\x3d'serverFolderRadio']",this.domNode).on("change",function(I){this.serverFolderOption=I.target.value;"newFolder"===I.target.value?R.remove(this.serverFolder,"disabled"):(R.set(this.serverFolder,"disabled","disabled"),this.serverFolder.value=this._sanitizeFolderName(this._getPortalFolder(this.item.portalFolderId)));this._generateExampleUrl()}.bind(this)),
J("input[name\x3d'serverId']",this.domNode).on("change",function(I){this._generateExampleUrl()}.bind(this)))},_generateExampleUrl:function(){var I=null;if((this.serversTable.selectedServers||[]).length){var F=this.serversTable.selectedServers[0].url;b.isValidUrl(F)&&(I=new z(F),I=E.CreateLayersDlg.exampleUrl+"\x26nbsp;"+I.uri+"/rest/services/"+this.serverFolder.value)}I?(this.exampleUrlContainer.innerHTML=I,P.remove(this.exampleUrlContainer,"hide")):P.add(this.exampleUrlContainer,"hide")},_createItemDataObject:function(I){var F=
this.timeZoneSelect.value===E.syncLayersTimeZones.none?"":this.timeZoneSelect.value,D=this.timeZoneCheckBox.checked,C=this.preferredTimeZoneSelect.value===E.syncLayersTimeZones.none?"":this.preferredTimeZoneSelect.value,y=this.preferredTimeZoneCheckBox.checked,G={};F={serviceName:null,type:"MapServer",capabilities:"Map,Query,Data",properties:{datesInUnknownTimeZone:F===E.syncLayersTimeZones.unknown,dateFieldsTimezoneID:[E.syncLayersTimeZones.unknown,E.syncLayersTimeZones.none].includes(F)?"":F,dateFieldsRespectsDayLightSavingTime:D,
preferredTimeZoneID:[E.syncLayersTimeZones.none].includes(C)?"":C,preferredTimeZoneRespectsDayLightSavingTime:y},extensions:[{typeName:"FeatureServer",capabilities:"Query",enabled:"true",properties:{maxRecordCount:"4000"}}]};G.serverId=I.serverId;G.portalFolderId=I.portalFolderId;G.serverFolder=this._sanitizeFolderName(I.serverFolder);G.datastoreId=I.datastoreId;G.templateSvcConfig=JSON.stringify(F);return G},_validateServerFolderName:function(I){var F={valid:!0,errorMessage:""};if(!I)return F.valid=
!1,F.message=this.i18n.CreateLayersDlg.validation.invalidServerFolder,F;for(var D=0;D<I.length;D++){var C=I[D];if(C.match(this.folderRegex)){F.valid=!1;F.message=B.substitute(this.i18n.CreateLayersDlg.validation.invalidServerFolderCharacter,{character:C});break}}return F},_sanitizeFolderName:function(I){return I.replace(this.folderRegex,"")},_startPublishLayers:function(I){I=this._getPortalFolder(this.item.portalFolderId);I===this.item.portalFolderId?this.portalUser.createFolder(I).then(function(F){this.item.portalFolderId=
F.id;this._publishLayers(this.item)}.bind(this),function(F){this.showError(F)}.bind(this)):this._publishLayers(this.item)},_publishLayers:function(I){I=this._createItemDataObject(I);P.remove(this.errorNode,"is-active");this.errorNode.innerHTML="";P.add(this.startButton,"hide");P.add(this.backButton,"hide");P.add(this.cancelButton,"hide");J(".step-"+this.currentStep).addClass("hide");P.add(this.loader,"is-active");b.request({url:this.publishLayersUrl,content:I},{usePost:!0}).then(function(F){F.success?
this.dialog.hide():this._showError(error)}.bind(this),function(F){this._showError(F)}.bind(this))},_showError:function(I){this.errorNode.innerHTML=this.i18n.CreateLayersDlg.publishLayersError;"ORG_1181"===I.messageCode?this.errorNode.innerHTML+=" "+this.i18n.CreateLayersDlg.validation.ORG_1181:I.message&&(this.errorNode.innerHTML+=" "+I.message,(I.details||[]).length&&(this.errorNode.innerHTML+=" "+I.details.join(" ")));J(".step-"+this.currentStep).removeClass("hide");P.remove(this.startButton,"hide");
P.remove(this.backButton,"hide");P.remove(this.cancelButton,"hide");P.remove(this.loader,"is-active");P.add(this.errorNode,"is-active")},_validateStep:function(I){this._setStepFormData(this.currentStep);var F={valid:!0};switch(I){case 1:break;case 2:this.item.portalFolderId||(F=this._generateInvalidResult(this.i18n.CreateLayersDlg.validation.invalidFolder));break;case 3:if(!this.item.serverId){F=this._generateInvalidResult(this.i18n.CreateLayersDlg.validation.invalidServer);break}I=this._validateServerFolderName(this.item.serverFolder);
I.valid||(F=this._generateInvalidResult(I.message));break;default:throw"Invalid step";}F.valid||c.createSpecifiedDialog(l).show(F);return F.valid},_generateInvalidResult:function(I){return{title:this.i18n.generalDlg.errorDlgTitle,valid:!1,message:I}},_getPortalFolder:function(I){var F=this._folders.options.filter(function(D){return D.value===I}.bind(this));return F.length?F[0].label:""},_setStepFormData:function(I){switch(I){case 1:break;case 2:this.item.portalFolderId=this._folders.value!==this.portalUser.username?
this._folders.value:null;"newFolder"!==this.serverFolderOption&&(this.serverFolder.value=this._sanitizeFolderName(this._getPortalFolder(this.item.portalFolderId)));break;case 3:(this.serversTable.selectedServers||[]).length&&(this.item.serverId=this.serversTable.selectedServers[0].id);this.item.serverFolder=this.serverFolder.value;break;default:throw"Error setting step data";}},_goToStep:function(I){this.currentStep=I;3===this.currentStep&&this._generateExampleUrl();this._changeStepIndicator(I);this._changeStepContent(I);
this._changeStepButtons(I)},_changeStepIndicator:function(I){J(".add-datastore-step").removeClass("active");J(".add-datastore-step").removeClass("completed");J("#step"+I.toString()).addClass("active");for(var F=1;F<I;F++)J("#step"+F.toString()).addClass("completed")},_changeStepContent:function(I){J(".step-container").addClass("hide");J(".step-"+I.toString()).removeClass("hide")},_changeStepButtons:function(I){switch(I){case 1:P.remove(this.nextButton,"hide");P.add(this.startButton,"hide");P.add(this.backButton,
"hide");break;case 2:P.remove(this.nextButton,"hide");P.add(this.startButton,"hide");P.remove(this.backButton,"hide");break;case 3:P.add(this.nextButton,"hide"),P.remove(this.backButton,"hide"),P.remove(this.startButton,"hide")}},_createFolder:function(){var I=new h({portalUser:this.portalUser,bypassApi:!0});I.startup();I.showModal().then(function(F){this._addFolder(F)}.bind(this))},onSubmit:function(I){I.preventDefault()},destroy:function(){this.dialog.destroyRecursive()},_addTimeZone:function(){this.timeZoneSelect.innerHTML+=
"\x3coption label\x3d'"+E.syncLayersTimeZones.none+"'value\x3d'"+E.syncLayersTimeZones.none+"'\x3e\x3c/option\x3e";this.timeZoneSelect.innerHTML+="\x3coption label\x3d'"+E.syncLayersTimeZones.unknown+"'value\x3d'"+E.syncLayersTimeZones.unknown+"'\x3e\x3c/option\x3e";this.preferredTimeZoneSelect.innerHTML+="\x3coption label\x3d'"+E.syncLayersTimeZones.none+"'value\x3d'"+E.syncLayersTimeZones.none+"'\x3e\x3c/option\x3e";Object.keys(E.syncLayersTimeZones).map(function(I){["unknown","none"].includes(I)||
(this.timeZoneSelect.innerHTML+="\x3coption label\x3d'"+E.syncLayersTimeZones[I]+"'value\x3d'"+r.TimezoneUtils._winZones[I].id+"'\x3e\x3c/option\x3e",this.preferredTimeZoneSelect.innerHTML+="\x3coption label\x3d'"+E.syncLayersTimeZones[I]+"'value\x3d'"+r.TimezoneUtils._winZones[I].id+"'\x3e\x3c/option\x3e")}.bind(this))},_timeZoneSelectChange:function(){[E.syncLayersTimeZones.none,E.syncLayersTimeZones.unknown].includes(this.timeZoneSelect.value)||(this.timeZoneCheckBox.disabled=!1,this.preferredTimeZoneSelect.disabled=
!1);[E.syncLayersTimeZones.none].includes(this.preferredTimeZoneSelect.value)||(this.preferredTimeZoneCheckBox.disabled=!1);[E.syncLayersTimeZones.none].includes(this.preferredTimeZoneSelect.value)&&(this.preferredTimeZoneCheckBox.disabled=!0,this.preferredTimeZoneCheckBox.checked=!1);[E.syncLayersTimeZones.none,E.syncLayersTimeZones.unknown].includes(this.timeZoneSelect.value)&&(this.timeZoneCheckBox.disabled=!0,this.preferredTimeZoneSelect.disabled=!0,this.preferredTimeZoneCheckBox.disabled=!0,
this.preferredTimeZoneSelect.value=E.syncLayersTimeZones.none,this.preferredTimeZoneCheckBox.checked=!1,this.timeZoneCheckBox.checked=!1)},loadToolTip:function(){(new f({buttonAriaLabel:E.CreateLayersDlg.timeZoneInfo,buttonClasses:"tooltip tooltip-multiline tooltip-wider"},this.timeZoneInfoButton)).disabled=!0;(new f({buttonAriaLabel:E.CreateLayersDlg.preferredTimeZoneInfo,buttonClasses:"tooltip tooltip-multiline tooltip-wide"},this.preferredTimeZoneInfoButton)).disabled=!0}})})},"arcgisonline/sharing/dijit/dialog/SyncLayersDlg":function(){define("require exports tslib preact preact/hooks arcgisonline/pages/utils/alerts arcgisonline/esriGeowConfig dojo/i18n!../../../nls/arcgisonline arcgisonline/pages/dijit/InfoTooltip arcgisonline/sharing/dijit/_TimezoneUtils ../../dijit/dialog/syncLayersDlgRequest ../../dijit/dialog/syncLayersMetaData ../../dijit/dialog/syncLayersProperties".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f){Object.defineProperty(K,"__esModule",{value:!0});m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);K.default=function(r){var q=r.openModal,t=r.itemId,w=r.dateFieldsRespectsDayLightSavingTime,u=r.dateFieldsTimezoneID,v=r.preferredTimeZoneID,x=r.preferredTimeZoneRespectsDayLightSavingTime,z=r.datesInUnknownTimeZone,A=r.hasSyncProperties;
r=(0,g.useState)(!1);var B=r[0],J=r[1];r=(0,g.useState)(!0);var P=r[0];r=r[1];var R=(0,g.useState)(""),S=R[0],T=R[1];R=(0,g.useState)("");var E=R[0],I=R[1];R=(0,g.useState)(!1);var F=R[0],D=R[1];R=(0,g.useState)(!1);var C=R[0],y=R[1];R=(0,g.useState)(!1);var G=R[0],L=R[1],O=(0,g.useState)(!0);R=O[0];var U=O[1],M=(0,g.useState)(!0);O=M[0];var Q=M[1],Y=(0,g.useState)(!0);M=Y[0];var fa=Y[1],va=Object.keys(b.default.syncLayersTimeZones),Aa=new Event("closeDlg"),pa=new Event("cancel");Y="".concat(n.default.self.helpBase).concat(n.default.self.helpMap.m["120004041"]);
var N=d.default.TimezoneUtils._winZones,V=b.default.itemProperties,Z=(0,g.useState)(new l.default)[0];(0,g.useEffect)(function(){A&&(D(w),T(u),I(v),y(x),J(!0));(new c.default({title:"",content:"",buttonAriaLabel:b.default.CreateLayersDlg.timeZoneInfo,buttonClasses:"tooltip tooltip-multiline tooltip-wider timeZoneInfo"},document.querySelector(".timeZoneInfoButton"))).disabled=!0;(new c.default({title:"",content:"",buttonAriaLabel:b.default.CreateLayersDlg.preferredTimeZoneInfo,buttonClasses:"tooltip tooltip-multiline tooltip-wide"},
document.querySelector(".preferredTimeZoneInfoButton"))).disabled=!0;(new c.default({title:"",content:"",buttonAriaLabel:V.itemMetaDataInfo,buttonClasses:"tooltip tooltip-multiline tooltip-wide metaDataInfoButton"},document.querySelector(".metaDataInfoButton"))).disabled=!0},[]);(0,g.useEffect)(function(){B&&(""!==S||z?["",b.default.syncLayersTimeZones.unknown].includes(S)&&z?(T("Unknown"),L(!0),D(!1),y(!1),Q(!0),fa(!0),U(!0)):(U(!1),Q(!1)):(D(!1),y(!1),Q(!0),fa(!0),U(!0)),""===E?fa(!0):fa(!1))},
[B]);return(0,a.h)("calcite-modal",{open:q,id:"syncLayersModal",oncalciteModalOpen:function(ba){setTimeout(function(){ba.target.setFocus()},0)},style:{"--calcite-modal-width":"1050px"}},(0,a.h)("div",{slot:"header",className:"modalTitle"},V.syncLayers),(0,a.h)("div",{slot:"content",className:"syncLayersMessage"},V.syncLayersMessage,(0,a.h)("a",{href:Y,target:"_blank",className:"learnMoreLink","aria-label":V.learnMoreDescription},b.default.myOrganization.licensesTab.learnMore,(0,a.h)("calcite-icon",
{icon:"launch",scale:"s",className:"helpLinkIcon"}))),(0,a.h)(h.default,{metaDataValue:P,onSetMetaDataValue:r}),(0,a.h)("div",{slot:"content",className:"accordionDiv"},(0,a.h)("calcite-accordion",{iconType:"chevron","icon-position":"start",appearance:"transparent",scale:"l",className:"syncLayersAccordion"},(0,a.h)("calcite-accordion-item",{"item-title":V.advanced,className:"syncLayersAccordionItem"},(0,a.h)(f.default,{timeZoneOptions:function(){var ba=b.default.syncLayersTimeZones,ma=ba.none;ba=ba.unknown;
var sa=va.filter(function(Ea){return!["none","unknown"].includes(Ea)}).map(function(Ea){return(0,a.h)("option",{key:Ea,value:N[Ea].id,label:b.default.syncLayersTimeZones[Ea],selected:N[Ea].id===S})});sa.unshift((0,a.h)("option",{key:"none",value:ma,label:ma,selected:""===S&&!z}),(0,a.h)("option",{key:"unknown",value:ba,label:ba,selected:"Unknown"===S&&!!z}));return sa},onTimeZoneSelect:function(ba){ba===b.default.syncLayersTimeZones.none?(L(!1),T(""),I(""),D(!1),y(!1),Q(!0),fa(!0),U(!0)):ba===b.default.syncLayersTimeZones.unknown?
(L(!0),T("Unknown"),I(""),D(!1),y(!1),Q(!0),fa(!0),U(!0)):(T(ba),U(!1),Q(!1))},dayLightSavingsForTimeZone:F,onSetDayLightSavingsForTimeZone:D,disableTimeZoneCheckBox:R,preferredTimeZoneOptions:function(){var ba=b.default.syncLayersTimeZones.none,ma=va.filter(function(sa){return!["none","unknown"].includes(sa)}).map(function(sa){return(0,a.h)("option",{key:sa,value:N[sa].id,label:b.default.syncLayersTimeZones[sa],selected:N[sa].id===E})});ma.unshift((0,a.h)("option",{key:"none",value:ba,label:ba,selected:!E&&
!z}));return ma},onPreferredTimeZoneSelect:function(ba){ba===b.default.syncLayersTimeZones.none?(I(""),fa(!0),y(!1)):(I(ba),fa(!1))},dayLightSavingsForPreferredTimeZone:C,disablePreferredTimeZoneCheckBox:M,disablePreferredTimeZone:O,onSetDayLightSavingsForPreferredTimeZone:y})))),(0,a.h)("div",{slot:"back"},(0,a.h)("div",{className:"modalFooter"},(0,a.h)("calcite-button",{onClick:function(){var ba={};ba={serviceName:null,type:"MapServer",capabilities:"Map,Query,Data",properties:{datesInUnknownTimeZone:G,
dateFieldsTimezoneID:[b.default.syncLayersTimeZones.none,b.default.syncLayersTimeZones.unknown].includes(S)?"":S,dateFieldsRespectsDayLightSavingTime:F,preferredTimeZoneID:E===b.default.syncLayersTimeZones.none?"":E,preferredTimeZoneRespectsDayLightSavingTime:C},extensions:[{typeName:"FeatureServer",capabilities:"Query,Create",enabled:"true",properties:{maxRecordCount:"4000"}}]};ba=S===u&&E===v&&F===w&&C===x?{datastoreId:t,syncItemInfo:P}:{datastoreId:t,templateSvcConfig:JSON.stringify(ba),applySvcConfigChanges:!0,
syncItemInfo:P};Z.sync(ba).then(function(ma){ma.success&&document.dispatchEvent(Aa)},function(ma){document.dispatchEvent(pa);m.default.showAlert("error",ma.message)})}},V.syncLayers),(0,a.h)("calcite-button",{appearance:"outline",kind:"brand",id:"syncLayerCancelButton",onClick:function(){document.dispatchEvent(pa)}},V.cancel))))}})},"arcgisonline/sharing/dijit/dialog/syncLayersDlgRequest":function(){define(["require","exports","tslib","arcgisonline/sharing/util","arcgisonline/esriGeowConfig"],function(e,
K,p,a,g){a=p.__importDefault(a);g=p.__importDefault(g);return function(){function m(){}m.prototype.sync=function(n){return a.default.request({url:"".concat(g.default.restBaseUrl,"portals/").concat(g.default.portal.id,"/datastores/allDatasets/publishLayers"),content:n},{usePost:!0})};return m}()})},"arcgisonline/sharing/dijit/dialog/syncLayersMetaData":function(){define(["require","exports","tslib","preact","dojo/i18n!../../../nls/arcgisonline"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",
{value:!0});g=p.__importDefault(g);var m=g.default.itemProperties;K.default=function(n){var b=n.metaDataValue,c=n.onSetMetaDataValue;return(0,a.h)("div",{slot:"content",className:"itemMetaDataDiv"},(0,a.h)("div",{className:"divTitles"},m.itemMetaData),(0,a.h)("div",{className:"metaDataLayerButtonDiv"},(0,a.h)("div",{className:"metaDataButtonText"},m.itemMetaDataDescription,(0,a.h)("button",{className:"metaDataInfoButton",hidden:!0})),(0,a.h)("calcite-switch",{checked:b,className:"metaDataBlockSwitch",
scale:"l",oncalciteSwitchChange:function(d){return c(d.target.checked)},"aria-label":m.itemMetaDataDescription})))}})},"arcgisonline/sharing/dijit/dialog/syncLayersProperties":function(){define(["require","exports","tslib","preact","dojo/i18n!../../../nls/arcgisonline"],function(e,K,p,a,g){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);var m=g.default.itemProperties;K.default=function(n){var b=n.timeZoneOptions,c=n.onTimeZoneSelect,d=n.dayLightSavingsForTimeZone,l=n.onSetDayLightSavingsForTimeZone,
h=n.disableTimeZoneCheckBox,f=n.onPreferredTimeZoneSelect,r=n.preferredTimeZoneOptions,q=n.dayLightSavingsForPreferredTimeZone,t=n.disablePreferredTimeZoneCheckBox,w=n.disablePreferredTimeZone,u=n.onSetDayLightSavingsForPreferredTimeZone;return(0,a.h)("div",{className:"layerPropertiesDiv"},(0,a.h)("div",{className:"syncLayersdivTitles"},m.layerProperties),(0,a.h)("div",{className:"timeZoneLabel"},m.timeZoneOfTheData,(0,a.h)("button",{className:"timeZoneInfoButton",hidden:!0})),(0,a.h)("select",{label:"timeZone",
className:"timeZoneSelect",onChange:function(v){return c(v.target.value)},"aria-label":m.timeZoneOfTheData},b()),(0,a.h)("div",{className:"dayLightSavingsCheckBox"},(0,a.h)("calcite-checkbox",{scale:"l",checked:d,oncalciteCheckboxChange:function(v){return l(v.target.checked)},disabled:h,id:"timeZoneCheckBox"}),(0,a.h)("calcite-label",{disabled:h,scale:"l",className:"checkBoxLabel",for:"timeZoneCheckBox"},m.adjustDayLightSavings)),(0,a.h)("div",{className:"timeZoneLabel"},m.preferredTimeZone,(0,a.h)("button",
{className:"preferredTimeZoneInfoButton",hidden:!0})),(0,a.h)("select",{label:"preferredTimeZone",className:"timeZoneSelect",onChange:function(v){return f(v.target.value)},"aria-label":m.preferredTimeZone,disabled:w},r()),(0,a.h)("div",{className:"dayLightSavingsCheckBoxPreferredTimeZone"},(0,a.h)("calcite-checkbox",{scale:"l",checked:q,disabled:t,oncalciteCheckboxChange:function(v){return u(v.target.checked)},id:"preferredTimeZoneCheckBox"}),(0,a.h)("calcite-label",{disabled:t,scale:"l",className:"checkBoxLabel",
for:"preferredTimeZoneCheckBox"},(0,a.h)("div",null,m.adjustDayLightSavings))))}})},"arcgisonline/pages/item/widgets/_tasks":function(){define("require exports tslib dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin arcgisonline/tsutils/declareDecorator preact preact/compat ../components/tasks/TasksTab xstyle/css!./css/tasks.css".split(" "),function(e,K,p,a,g,m,n,b,c,d){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);d=p.__importDefault(d);return function(){function l(){this.templateString=
'\x3cmain class\x3d"tasks-tab"\x3e\x3cdiv id\x3d"tasks-tab"\x3e\x3c/div\x3e\x3c/main\x3e'}l.prototype.startup=function(){this.inherited(arguments);this.container=document.getElementById("tasks-tab");(0,b.render)((0,b.h)(d.default,{itemId:this.item.id,username:this.portalUser.username,type:"item"}),this.container);return(new a.default).resolve(!0)};l.prototype.destroy=function(){this.inherited(arguments);(0,c.unmountComponentAtNode)(this.container)};return l=p.__decorate([(0,n.default)(g.default,m.default)],
l)}()})},"arcgisonline/pages/item/components/tasks/TasksTab":function(){define("require exports tslib preact preact/hooks ./TasksNone ./TasksMain".split(" "),function(e,K,p,a,g,m,n){Object.defineProperty(K,"__esModule",{value:!0});m=p.__importDefault(m);n=p.__importDefault(n);K.default=function(b){var c=b.itemId,d=b.username,l=b.mini;b=b.type;var h=(0,g.useState)(!1),f=h[0],r=h[1],q=(0,g.useState)(0);h=q[0];var t=q[1];q=a.h;var w=l?void 0:(0,a.h)("div",{class:h?"hide":null},(0,a.h)(m.default,{itemId:c}));
return q.call(a,"div",{class:f?null:"hide"},w,(0,a.h)("div",{class:h||l?null:"hide"},(0,a.h)(n.default,{itemId:c,username:d,mini:l,tasksCountCallback:function(u){f||r(!0);t(u)},type:b})))}})},"arcgisonline/pages/item/components/tasks/TasksNone":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline dojo/i18n!arcgisonline/nls/notebooks arcgisonline/esriGeowConfig".split(" "),function(e,K,p,a,g,m,n){Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);
m=p.__importDefault(m);n=p.__importDefault(n);K.default=function(b){return(b=b.itemId)?(0,a.h)("section",{class:"grid-container"},(0,a.h)("div",{class:"column-24"},(0,a.h)("div",{class:"empty-view text-center leader-2"},(0,a.h)("i",{class:"icon-ui-calendar"}),(0,a.h)("h3",null,g.default.itemProperties.noTasks),(0,a.h)("p",{class:"font-size--2 text-constrain margin-auto"},g.default.itemProperties.noTasksMessage),(0,a.h)("a",{class:"btn",target:"_blank",href:"".concat(n.default.baseUrl,"notebook/notebook.html?id\x3d").concat(b)},
g.default.itemProperties.openNotebook)))):(0,a.h)("section",{class:"grid-container"},(0,a.h)("div",{class:"column-24"},(0,a.h)("div",{class:"empty-view text-center leader-2"},(0,a.h)("i",{class:"icon-ui-calendar"}),(0,a.h)("h3",null,m.default.notebookServerManager.tabs.tasks.noTasks))))}})},"arcgisonline/pages/item/components/tasks/TasksMain":function(){define("require exports tslib dojo/topic dojo/number preact preact/hooks arcgisonline/pages/notebook/utils/alerts arcgisonline/pages/utils/task dojo/i18n!arcgisonline/nls/arcgisonline dojo/i18n!arcgisonline/nls/notebooks ./TasksTable".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h){Object.defineProperty(K,"__esModule",{value:!0});a=p.__importDefault(a);g=p.__importDefault(g);b=p.__importDefault(b);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);K.default=function(f){var r=this,q=f.itemId,t=f.username,w=f.mini,u=f.tasksCountCallback;f=f.type;var v=(0,n.useState)([]),x=v[0],z=v[1],A=(0,n.useState)(!1);v=A[0];var B=A[1],J=(0,n.useState)(!1);A=J[0];var P=J[1],R=(0,n.useState)(!1);J=R[0];var S=R[1];R=(0,n.useState)(1);var T=
R[0],E=R[1];R=(0,n.useState)(1);var I=R[0],F=R[1];R=(0,n.useState)(20);var D=R[0],C=R[1],y=(0,n.useState)(0);R=y[0];var G=y[1],L=!q&&!t;(0,n.useEffect)(function(){var pa=[a.default.subscribe("tasks__task-created",Y),a.default.subscribe("tasks__task-created-error",fa),a.default.subscribe("tasks__task-saved",va),a.default.subscribe("tasks__task-saved-error",Aa),a.default.subscribe("tasks__task-changed",U)];U();return function(){pa.forEach(function(N){return N.remove()})}},[]);var O=function(pa,N){return L?
c.TaskUtility.getAllTasksAdmin(pa,N):c.TaskUtility.getTasks(q,t,pa,N)},U=function(pa,N){void 0===pa&&(pa=null);void 0===N&&(N=null);pa=pa||T;N=N||D;B(!0);O(pa,N).then(function(V){return M(V)}).always(function(){B(!1)})},M=function(pa){u(pa.total);G(pa.total);P(-1<pa.nextStart);F(pa.nextStart);E(pa.start);w?z((1===pa.start?[]:x).concat(pa.tasks)):z(pa.tasks)};y=function(){return p.__awaiter(r,void 0,void 0,function(){var pa;return p.__generator(this,function(N){switch(N.label){case 0:return N.trys.push([0,
2,3,4]),S(!0),[4,O(I,D)];case 1:return pa=N.sent(),M(pa),[3,4];case 2:return N.sent(),[3,4];case 3:return S(!1),[7];case 4:return[2]}})})};var Q=function(pa){pa=pa.target.startItem;E(pa);U(pa,D)},Y=function(){b.default.showAlert("success",d.default.itemProperties.createTaskSuccess);U(1,D)},fa=function(pa){pa=c.TaskUtility.formatErrorMessage(pa);b.default.showAlert("danger",pa||d.default.itemProperties.createTaskError);U(1,D)},va=function(){b.default.showAlert("success",d.default.itemProperties.saveTaskSuccess);
U(1,D)},Aa=function(pa){pa=c.TaskUtility.formatErrorMessage(pa);b.default.showAlert("danger",pa||d.default.itemProperties.saveTaskError);U(1,D)};return w?(0,m.h)("div",null,(0,m.h)("div",{class:"trailer-half"},(0,m.h)("calcite-button",{appearance:"outline-fill",onClick:function(){return c.TaskUtility.startTaskCreate(q,t)},width:"full"},l.default.notebookViewer.tabContent.tasks.createTask)),(0,m.h)("div",{class:"leader-2 text-center ".concat((null===x||void 0===x?0:x.length)?"hide":"")},(0,m.h)("div",
null,(0,m.h)("i",{class:"icon-ui-calendar tab-empty-icon-large"})),l.default.notebookViewer.tabContent.tasks.noTasks),(0,m.h)("div",{class:"sidebar-tab-panel ".concat((null===x||void 0===x?0:x.length)?"":"hide")},(0,m.h)("h4",{class:"panel-header"},(0,m.h)("span",null,l.default.notebookViewer.tabContent.tasks.scheduledTasks),(0,m.h)("calcite-action",{text:"refresh tasks",icon:"refresh",onClick:function(){return U(1,D)}})),(0,m.h)("div",{class:"loader padding-leader-3 padding-trailer-3 ".concat(v?
"is-active":"")},(0,m.h)("div",{class:"loader-bars"}),(0,m.h)("div",{class:"loader-text"},d.default.itemProperties.tasksLoader)),(0,m.h)("div",{class:v?"hide":""},(0,m.h)(h.default,{tasks:x,isAdmin:L,mini:w}),A&&!J&&(0,m.h)("div",{class:"text-center"},(0,m.h)("a",{onClick:y},d.default.common.loadMore)),A&&J&&(0,m.h)("div",{class:"text-center"},(0,m.h)("calcite-loader",{scale:"m",inline:!0,label:""}),(0,m.h)("span",null,d.default.itemProperties.tasksLoader))))):(0,m.h)("section",null,(0,m.h)("div",
{class:"grid-container"},(0,m.h)("div",{class:"panel panel-white leader-1"},(0,m.h)("div",{class:"flex flex-space-between flex-align-center"},(0,m.h)("h4",{class:"font-size-2 avenir-bold"},d.default.itemProperties.tasks),(0,m.h)("calcite-button",{class:"margin-right-1",appearance:"transparent",kind:"neutral","icon-start":"refresh",scale:"s",onClick:function(){return U()}})),(0,m.h)("div",{class:"tasks-container"},(0,m.h)("div",{class:"create-task-modal"}),(0,m.h)("p",null,f&&"item"===f?d.default.itemProperties.tasksDescription:
l.default.notebookServerManager.tabs.tasks.description),(0,m.h)("div",{class:"trailer-half ".concat(t?"":"hide")},(0,m.h)("button",{class:"btn btn-clear",onClick:function(){return c.TaskUtility.startTaskCreate(q,t)}},d.default.itemProperties.createTask)),(0,m.h)("div",{class:"loader padding-leader-3 padding-trailer-3 ".concat(v?"is-active":"")},(0,m.h)("div",{class:"loader-bars"}),(0,m.h)("div",{class:"loader-text"},d.default.itemProperties.tasksLoader)),(0,m.h)("div",{class:v?"hide":""},(0,m.h)(h.default,
{tasks:x,isAdmin:L}),(0,m.h)("div",{class:"flex"},(0,m.h)("div",{class:"flex-1 flex flex-justify-center"},(0,m.h)("calcite-pagination",{oncalcitePaginationChange:Q,startItem:T,pageSize:D,totalItems:R})),(0,m.h)("div",null,(0,m.h)("calcite-dropdown",{width:"s"},(0,m.h)("calcite-button",{appearance:"outline",slot:"trigger","icon-end":"caret-double-vertical"},g.default.format(D)),(0,m.h)("calcite-dropdown-group",{"group-title":d.default.common.pageSize},[10,20,30,50].map(function(pa){return(0,m.h)("calcite-dropdown-item",
{key:pa,value:pa,onClick:function(){C(pa);E(1);U(1,pa)},selected:D===pa},g.default.format(pa))}))))))))))}})},"arcgisonline/pages/item/components/tasks/TasksTable":function(){define("require exports tslib preact ./TasksTableActions ../../../utils/task dojo/i18n!../../../../nls/arcgisonline arcgisonline/pages/notebook/utils/UtilFunctions".split(" "),function(e,K,p,a,g,m,n,b){function c(d,l){return d?(0,a.h)("td",null,l):""}Object.defineProperty(K,"__esModule",{value:!0});g=p.__importDefault(g);n=p.__importDefault(n);
K.default=function(d){var l=d.tasks,h=d.isAdmin,f=d.mini,r=d.item;d=(null===l||void 0===l?void 0:l.length)&&l.map(function(q){return(0,a.h)("tr",{key:q.id},(0,a.h)("td",null,(0,a.h)("a",{href:"#",onClick:function(t){m.TaskUtility.startTaskInfo(q.id,q.title,q.itemId,q.userId,t)}},h?decodeURIComponent(q.title):q.title)),c(h,q.userId),c(!f,(0,b.getFormattedDate)(q.created)),c(!f,(0,b.getFormattedDate)(q.updated)),(0,a.h)("td",null,m.TaskUtility.formatStatusText(q.taskState)),(0,a.h)("td",null,(0,a.h)(g.default,
{task:h?p.__assign(p.__assign({},q),{title:decodeURIComponent(q.title)}):q,item:r})))})||null;return(0,a.h)("div",null,(0,a.h)("div",{class:"loader padding-leader-3 padding-trailer-3"},(0,a.h)("div",{class:"loader-bars"}),(0,a.h)("div",{class:"loader-text"},n.default.itemProperties.tasksLoader)),(0,a.h)("table",{class:"tasks-table"},(0,a.h)("thead",null,(0,a.h)("tr",null,(0,a.h)("th",null,n.default.itemProperties.tasksTable.name),h?(0,a.h)("th",null,n.default.itemProperties.tasksTable.user):"",f?
"":(0,a.h)("th",null,n.default.itemProperties.tasksTable.created),f?"":(0,a.h)("th",null,n.default.itemProperties.tasksTable.updated),(0,a.h)("th",{colSpan:2},n.default.itemProperties.tasksTable.status))),(0,a.h)("tbody",null,d)))}})},"arcgisonline/pages/item/components/tasks/TasksTableActions":function(){define("require exports tslib preact ../../../utils/task dojo/i18n!../../../../nls/arcgisonline".split(" "),function(e,K,p,a,g,m){Object.defineProperty(K,"__esModule",{value:!0});m=p.__importDefault(m);
K.default=function(n){var b=n.task,c=n.refresh,d=n.counts,l=n.getTaskRuns;n=g.TaskUtility.getTaskStateAction(b.taskState);return(0,a.h)("calcite-dropdown",{"close-on-select-disabled":"true","overlay-positioning":"fixed",placement:"bottom",scale:"m",width:"s"},(0,a.h)("calcite-button",{slot:"trigger",iconStart:"ellipsis",appearance:"transparent",kind:"neutral",title:m.default.itemProperties.tasksTable.actions}),(0,a.h)("calcite-dropdown-group",{selectionMode:"single"},(0,a.h)("calcite-dropdown-item",
{label:m.default.itemProperties.tasksTable.viewTaskDetails,oncalciteDropdownItemSelect:function(h){l?l(b):g.TaskUtility.startTaskInfo(b.id,b.title,b.itemId,b.userId,h)},kind:"neutral"},m.default.itemProperties.tasksTable.details),(0,a.h)("calcite-dropdown-item",{label:m.default.itemProperties.tasksTable.editTask,oncalciteDropdownItemSelect:function(h){return g.TaskUtility.startTaskEdit(b.id,b.userId,b.itemId,h,c,d)},kind:"neutral"},m.default.itemProperties.tasksTable.edit),(0,a.h)("calcite-dropdown-item",
{label:m.default.itemProperties.tasksTable["".concat(n,"Task")],oncalciteDropdownItemSelect:function(h){return g.TaskUtility.startTaskPauseResume(b,b.userId,h,c,d)},kind:"neutral"},m.default.itemProperties.tasksTable["".concat(n)]),(0,a.h)("calcite-dropdown-item",{label:m.default.itemProperties.tasksTable.deleteTask,oncalciteDropdownItemSelect:function(h){return g.TaskUtility.startTaskDelete(b.id,b.title,b.userId,h,c,d)},kind:"neutral"},m.default.itemProperties.tasksTable.delete)))}})},"arcgisonline/pages/item/widgets/_snapshots":function(){define("require exports tslib dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin arcgisonline/tsutils/declareDecorator preact preact/compat ../components/snapshots/SnapshotsTab xstyle/css!./css/snapshots.css".split(" "),
function(e,K,p,a,g,m,n,b,c,d){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);d=p.__importDefault(d);return function(){function l(){this.templateString='\x3cmain class\x3d"snapshots-tab"\x3e\x3cdiv id\x3d"snapshots-tab"\x3e\x3c/div\x3e\x3c/main\x3e'}l.prototype.startup=function(){this.inherited(arguments);this.container=document.getElementById("snapshots-tab");(0,b.render)((0,b.h)(d.default,{itemId:this.item.id,username:this.portalUser.username}),this.container);
return(new a.default).resolve(!0)};l.prototype.destroy=function(){this.inherited(arguments);(0,c.unmountComponentAtNode)(this.container)};return l=p.__decorate([(0,n.default)(g.default,m.default)],l)}()})},"arcgisonline/pages/item/components/snapshots/SnapshotsTab":function(){define("require exports tslib preact preact/hooks arcgisonline/esriGeowConfig arcgisonline/pages/notebook/components/SnapshotActions arcgisonline/pages/utils/formatters arcgisonline/pages/utils/notebook arcgisonline/pages/utils/alerts arcgisonline/pages/utils/snapshots dojo/i18n!arcgisonline/nls/arcgisonline dojo/i18n!arcgisonline/nls/notebooks dojo/Deferred".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r){Object.defineProperty(K,"__esModule",{value:!0});m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);K.default=function(q){function t(E){A(z.map(function(I){I.resourceKey===E.resourceKey&&(I.previewExists=!0);return I}))}var w=this,u=q.itemId;q=(0,g.useState)(!1);var v=q[0],x=q[1];q=(0,g.useState)([]);var z=q[0],A=q[1];q=(0,g.useState)(null);
var B=q[0],J=q[1];(0,g.useEffect)(function(){x(!0);c.default.getNotebookServer().then(function(E){J(E)})},[]);(0,g.useEffect)(function(){(null===B||void 0===B?0:B.url)&&P()},[B]);var P=function(){return p.__awaiter(w,void 0,void 0,function(){var E;return p.__generator(this,function(I){switch(I.label){case 0:return I.trys.push([0,2,3,4]),x(!0),[4,l.SnapshotsUtility.getSnapshots(B.url,u)];case 1:E=I.sent();if("success"===E.status)A(E.snapshots||[]);else throw Error(E.error);return[3,4];case 2:return I.sent(),
d.default.showAlert("error",f.default.notebookViewer.tabContent.snapshots.getSnapshotsError),A([]),[3,4];case 3:return x(!1),[7];case 4:return[2]}})})},R=function(){P()},S=function(){return(new r.default).resolve()};q=a.h;var T=v||z.length?void 0:(0,a.h)("div",{class:"leader-2 text-center"},(0,a.h)("div",null,(0,a.h)("i",{class:"icon-ui-time-clock tab-empty-icon-large"})),f.default.notebookViewer.tabContent.snapshots.noSnapshots);return q.call(a,"section",null,T,function(){if(z.length)return(0,a.h)("div",
null,(0,a.h)("div",{class:"grid-container"},(0,a.h)("div",{class:"panel panel-white leader-1"},(0,a.h)("h4",{class:"font-size-2 avenir-bold"},h.default.itemProperties.snapshots),(0,a.h)("div",{class:"snapshots-container"},(0,a.h)("p",null,f.default.notebookViewer.tabContent.snapshots.snapshotsDescription),(0,a.h)("div",{class:"trailer-half"},(0,a.h)("a",{class:"btn btn-clear",target:"_blank",href:"".concat(m.default.baseUrl,"notebook/notebook.html?id\x3d").concat(u)},h.default.itemProperties.openNotebook),
(0,a.h)("button",{class:"btn btn-link margin-left-1",onClick:P,title:h.default.common.refresh},h.default.common.refresh)),(0,a.h)("calcite-loader",{class:"padding-leader-1",hidden:!v,text:f.default.notebookViewer.tabContent.snapshots.loading,label:""}),(0,a.h)("table",{class:"table table-striped ".concat(v?"hide":"")},(0,a.h)("thead",null,(0,a.h)("tr",null,(0,a.h)("th",null,f.default.notebookViewer.tabContent.snapshots.name),(0,a.h)("th",null,f.default.notebookViewer.tabContent.snapshots.description),
(0,a.h)("th",{colSpan:2},f.default.notebookViewer.tabContent.snapshots.creationDate))),(0,a.h)("tbody",null,z.map(function(E){var I=b.default.fullDate(parseInt(E.created,10)),F=b.default.timeOnly(parseInt(E.created,10)),D=E.properties.name||f.default.notebookViewer.tabContent.snapshots.untitled;return(0,a.h)("tr",null,(0,a.h)("td",null,E.previewExists&&(0,a.h)("calcite-link",{class:"ellipsis",onKeyPress:function(C){"Enter"===C.key&&l.SnapshotsUtility.showPreview(C,E,u)},onClick:function(C){return l.SnapshotsUtility.showPreview(C,
E,u)}},D),!E.previewExists&&(0,a.h)("span",{class:"ellipsis"},D)),(0,a.h)("td",null,E.properties.description),(0,a.h)("td",null,"".concat(I," ").concat(F)),(0,a.h)("td",null,(0,a.h)(n.default,{itemId:u,snapshot:E,notebookServerUrl:B.url,onSnapshotDelete:R,onSnapshotRestore:S,afterPreviewCreated:t})))})))))))}())}})},"arcgisonline/pages/notebook/components/SnapshotActions":function(){define("require exports tslib preact preact/hooks arcgisonline/pages/components/BodyAppender arcgisonline/pages/notebook/utils/alerts arcgisonline/esriGeowConfig arcgisonline/pages/utils/snapshots dojo/i18n!arcgisonline/nls/arcgisonline dojo/i18n!arcgisonline/nls/notebooks".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l){var h=this;Object.defineProperty(K,"__esModule",{value:!0});m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);d=p.__importDefault(d);l=p.__importDefault(l);K.default=function(f){var r=(0,g.useState)(!1),q=r[0],t=r[1];r=(0,g.useState)(!1);var w=r[0],u=r[1];r=(0,g.useState)(!1);var v=r[0],x=r[1],z=(0,g.useState)(!1);r=z[0];var A=z[1],B=(0,g.useRef)(),J=(0,g.useRef)(),P=function(I,F){x(!1);n.default.showAlert("danger",I)},R=function(){u(!1)},S=function(){t(!1)},
T=function(){x(!0);c.SnapshotsUtility.deleteSnapshot(f.notebookServerUrl,f.itemId,f.snapshot.resourceKey).then(function(I){"success"===I.status?(S(),f.onSnapshotDelete(),n.default.showAlert("success",l.default.notebookViewer.tabContent.snapshots.deleteSnapshotSuccess)):P(l.default.notebookViewer.tabContent.snapshots.deleteSnapshotError,I.error);x(!1)},function(I){P(l.default.notebookViewer.tabContent.snapshots.deleteSnapshotError,I)})},E=function(){x(!0);c.SnapshotsUtility.restoreSnapshot(f.notebookServerUrl,
f.itemId,f.snapshot.resourceKey).then(function(I){"success"===I.status?f.onSnapshotRestore().then(function(){x(!1);R();n.default.showAlert("success",l.default.notebookViewer.tabContent.snapshots.restoreSnapshotSuccess)},function(F){P(l.default.notebookViewer.tabContent.snapshots.restoreSnapshotError,F)}):P(l.default.notebookViewer.tabContent.snapshots.restoreSnapshotError,I.error)},function(I){P(l.default.notebookViewer.tabContent.snapshots.restoreSnapshotError,I)})};z=function(){return p.__awaiter(h,
void 0,void 0,function(){var I,F,D;return p.__generator(this,function(C){switch(C.label){case 0:return C.trys.push([0,2,3,4]),A(!0),[4,c.SnapshotsUtility.createSnapPreview(f.notebookServerUrl,f.itemId,f.snapshot.resourceKey)];case 1:I=C.sent();if("success"===I.status)f.afterPreviewCreated(f.snapshot),n.default.showAlert("success",l.default.notebookViewer.tabContent.snapshots.previewCreated);else throw Error((null===(D=I.error)||void 0===D?void 0:D.message)||l.default.notebookViewer.tabContent.snapshots.errorCreatingPreview);
return[3,4];case 2:return F=C.sent(),n.default.showAlert("danger",F.message),[3,4];case 3:return A(!1),[7];case 4:return[2]}})})};return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"flex"},(0,a.h)("calcite-dropdown",null,(0,a.h)("button",{class:"btn btn-transparent link-off-black flex-center padding-right-half padding-left-half padding-leader-0 padding-trailer-0",slot:"trigger"},(0,a.h)("calcite-icon",{icon:"ellipsis"})),(0,a.h)("calcite-dropdown-group",{selectionMode:"none"},f.snapshot.previewExists&&
(0,a.h)("calcite-dropdown-item",{onClick:function(I){return c.SnapshotsUtility.showPreview(I,f.snapshot,f.itemId)}},l.default.notebookViewer.tabContent.snapshots.preview),!f.snapshot.previewExists&&(0,a.h)("calcite-dropdown-item",{onClick:z,disabled:r},(0,a.h)("div",{class:"inline-flex flex-align-center"},r&&(0,a.h)("calcite-loader",{scale:"s",label:l.default.notebookViewer.tabContent.snapshots.generatingPreview,inline:!0}),l.default.notebookViewer.tabContent.snapshots.generatePreview)),(0,a.h)("calcite-dropdown-item",
{onClick:function(){u(!0)}},l.default.notebookViewer.tabContent.snapshots.restore),(0,a.h)("calcite-dropdown-item",{onClick:function(){J.current.value!==b.default.userInfo.credential.token&&(J.current.value=b.default.userInfo.credential.token);B.current.submit()}},(0,a.h)("form",{method:"POST",target:"_blank",action:"".concat(f.notebookServerUrl,"/admin/notebooks/snapshots/download"),ref:B,id:"snapshot_".concat(f.itemId,"_").concat(f.snapshot.resourceKey),name:"snapshot_".concat(f.itemId,"_").concat(f.snapshot.resourceKey)},
(0,a.h)("input",{type:"hidden",name:"itemId",value:f.itemId}),(0,a.h)("input",{type:"hidden",name:"resourceKey",value:f.snapshot.resourceKey}),(0,a.h)("input",{type:"hidden",name:"token",ref:J,value:b.default.userInfo.credential.token}),l.default.notebookViewer.tabContent.snapshots.download)),(0,a.h)("calcite-dropdown-item",{onClick:function(){t(!0)}},l.default.notebookViewer.tabContent.snapshots.delete)))),function(){var I;if(q)return(0,a.h)(m.default,{id:"snapshot-delete-modal"},(0,a.h)("calcite-modal",
{kind:"danger",width:"s",scale:"m",open:q,oncalciteModalClose:S},(0,a.h)("h3",{class:"font-size-2 trailer-0",slot:"header"},l.default.notebookViewer.tabContent.snapshots.deleteSnapshot),(0,a.h)("div",{slot:"content"},(0,a.h)("p",null,l.default.notebookViewer.tabContent.snapshots.deleteSnapshotMessage),(0,a.h)("p",null,(0,a.h)("strong",null,(null===(I=f.snapshot.properties)||void 0===I?void 0:I.name)||d.default.common.untitled)),(0,a.h)("p",null,l.default.notebookViewer.tabContent.snapshots.deleteSnapshotConfirm)),
(0,a.h)("calcite-button",{slot:"secondary",width:"full",appearance:"outline-fill",kind:"danger",onClick:S},d.default.common.cancel),(0,a.h)("calcite-button",{slot:"primary",width:"full",kind:"danger",onClick:T,disabled:v},d.default.common.deleteLabel)))}(),function(){var I;if(w)return(0,a.h)(m.default,{id:"snapshot-restore-modal"},(0,a.h)("calcite-modal",{width:"s",scale:"m",open:w,oncalciteModalClose:R},(0,a.h)("h3",{class:"font-size-2 trailer-0",slot:"header"},l.default.notebookViewer.tabContent.snapshots.restoreSnapshot),
(0,a.h)("div",{slot:"content"},v?(0,a.h)("calcite-loader",{text:l.default.notebookViewer.tabContent.snapshots.restoringSnapshot,label:""}):(0,a.h)(a.Fragment,null,(0,a.h)("p",null,l.default.notebookViewer.tabContent.snapshots.restoreSnapshotDescription),(0,a.h)("p",null,(0,a.h)("strong",null,(null===(I=f.snapshot.properties)||void 0===I?void 0:I.name)||d.default.common.untitled)),(0,a.h)("p",null,l.default.notebookViewer.tabContent.snapshots.restoreSnapshotConfirm))),(0,a.h)("calcite-button",{slot:"secondary",
width:"full",appearance:"outline-fill",onClick:R},d.default.common.cancel),(0,a.h)("calcite-button",{slot:"primary",width:"full",onClick:E,disabled:v},l.default.notebookViewer.tabContent.snapshots.restore)))}())}})},"arcgisonline/pages/utils/snapshots":function(){define("require exports tslib arcgisonline/esriGeowConfig ../../sharing/util arcgisonline/pages/utils/notebook ../item/widgets/Notebook/PreviewOverlay dojo/i18n!arcgisonline/nls/notebooks".split(" "),function(e,K,p,a,g,m,n,b){Object.defineProperty(K,
"__esModule",{value:!0});K.SnapshotsUtility=void 0;a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);e=function(){function c(){}c.getSnapshots=function(d,l){return p.__awaiter(this,void 0,void 0,function(){var h,f,r;return p.__generator(this,function(q){switch(q.label){case 0:return[4,m.default.notebookRequest("".concat(d,"/admin/notebooks/snapshots/list"),"POST",{itemId:l},{useJsonFormatParam:!0,useCredentials:!0})];case 1:h=q.sent();
if("success"!==h.status||!h.snapshots.length)return[3,3];f=h.snapshots.map(function(t){return c.checkPreviewExists(t,l)});return[4,Promise.all(f)];case 2:r=q.sent(),h.snapshots=h.snapshots.map(function(t){var w=r.find(function(u){return u.key===t.resourceKey});t.previewExists=w.exist;return t}),q.label=3;case 3:return[2,h]}})})};c.checkPreviewExists=function(d,l){return p.__awaiter(this,void 0,void 0,function(){var h,f;return p.__generator(this,function(r){switch(r.label){case 0:return h=d.resourceKey.replace("snapshot-",
"snapshot_preview-"),[4,c.checkIfPreviewExist(l,h)];case 1:return f=r.sent(),[2,{key:d.resourceKey,exist:f}]}})})};c.createSnapshot=function(d,l){return m.default.notebookRequest("".concat(d,"/admin/notebooks/snapshots/create"),"POST",l,{useJsonFormatParam:!0,useCredentials:!0})};c.deleteSnapshot=function(d,l,h){return m.default.notebookRequest("".concat(d,"/admin/notebooks/snapshots/delete"),"POST",{itemId:l,resourceKeys:h},{useJsonFormatParam:!0,useCredentials:!0})};c.restoreSnapshot=function(d,
l,h){return m.default.notebookRequest("".concat(d,"/admin/notebooks/snapshots/restore"),"POST",{itemId:l,resourceKey:h,preserveCurrentAsSnapshot:!1},{useJsonFormatParam:!0,useCredentials:!0})};c.checkIfPreviewExist=function(d,l){return p.__awaiter(this,void 0,void 0,function(){var h;return p.__generator(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),h="".concat(a.default.restBaseUrl,"content/items/").concat(d,"/resources/").concat(l),[4,g.default.request({url:h,content:{"request.preventCache":+new Date}},
{useProxy:g.default.shouldUseProxy(h)})];case 1:return f.sent(),[2,!0];case 2:return f.sent(),[2,!1];case 3:return[2]}})})};c.showPreview=function(d,l,h){d.stopPropagation();d.preventDefault();d=l.resourceKey.replace("snapshot-","snapshot_preview-");(new n.default({title:l.properties.name||b.default.notebookViewer.tabContent.snapshots.untitled,constrain:!1,showActionBar:!1,resourceName:d,itemId:h,onClose:function(){}})).open()};c.createSnapPreview=function(d,l,h){return p.__awaiter(this,void 0,void 0,
function(){return p.__generator(this,function(f){return[2,m.default.notebookRequest("".concat(d,"/admin/notebooks/createNotebookPreview"),"POST",{itemId:l,snapshotResourceKey:h},{useJsonFormatParam:!0,useCredentials:!0})]})})};return c}();K.SnapshotsUtility=e})},"arcgisonline/pages/item/widgets/_snippetPreview":function(){define("require exports tslib dojo/Deferred dojox/highlight dojox/highlight/languages/python dijit/_WidgetBase dijit/_TemplatedMixin arcgisonline/tsutils/declareDecorator preact preact/compat arcgisonline/pages/notebook/components/code-snippets/SnippetLibPreview".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);h=p.__importDefault(h);return function(){function f(){this.templateString='\x3cmain class\x3d"grid-container flex-1 flex-column"\x3e\x3cdiv id\x3d"code-snippet-preview" class\x3d"flex-1 flex-column padding-left-half padding-right-half"\x3e\x3c/div\x3e\x3c/main\x3e';this.highlight=g.default;this.snippetLang=m.default}f.prototype.startup=
function(){this.inherited(arguments);this.container=document.getElementById("code-snippet-preview");(0,d.render)((0,d.h)(h.default,{item:this.item}),this.container);return(new a.default).resolve(!0)};f.prototype.destroy=function(){this.inherited(arguments);(0,l.unmountComponentAtNode)(this.container)};return f=p.__decorate([(0,c.default)(n.default,b.default)],f)}()})},"dojox/highlight":function(){define(["./highlight/_base"],function(e){return e})},"dojox/highlight/_base":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/dom","dojo/dom-class"],function(e,K,p,a){function g(q){return q.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;")}function m(q){return K.every(q.childNodes,function(t){return 3==t.nodeType||"br"==String(t.nodeName).toLowerCase()})}function n(q){var t=[];K.forEach(q.childNodes,function(w){if(3==w.nodeType)t.push(w.nodeValue);else if("br"==String(w.nodeName).toLowerCase())t.push("\n");else throw"Complex markup";});return t.join("")}function b(q){if(!q.keywordGroups)for(var t in q.keywords){q.keywordGroups=
q.keywords[t]instanceof Object?q.keywords:{keyword:q.keywords};break}}function c(q,t,w){if("code"==String(q.tagName).toLowerCase()&&"pre"==String(q.parentNode.tagName).toLowerCase()){var u=document.createElement("div"),v=q.parentNode.parentNode;u.innerHTML='\x3cpre\x3e\x3ccode class\x3d"'+t+'"\x3e'+w+"\x3c/code\x3e\x3c/pre\x3e";v.replaceChild(u.firstChild,q.parentNode)}else q.className=t,q.innerHTML=w}function d(q,t){t=new r(q,t);return{result:t.result,langName:q,partialResult:t.partialResult}}function l(q){var t=
"",w="",u;for(u in f.languages)if(f.languages[u].defaultMode){var v=new r(u,q),x=v.keywordCount+v.relevance,z=0;if(!t||x>z)z=x,t=v.result,w=v.langName}return{result:t,langName:w}}function h(q){var t=l(n(q));t.result&&c(q,t.langName,t.result)}var f=e.getObject("dojox.highlight",!0);f.languages=f.languages||{};f.constants={IDENT_RE:"[a-zA-Z][a-zA-Z0-9_]*",UNDERSCORE_IDENT_RE:"[a-zA-Z_][a-zA-Z0-9_]*",NUMBER_RE:"\\b\\d+(\\.\\d+)?",C_NUMBER_RE:"\\b(0x[A-Za-z0-9]+|\\d+(\\.\\d+)?)",APOS_STRING_MODE:{className:"string",
begin:"'",end:"'",illegal:"\\n",contains:["escape"],relevance:0},QUOTE_STRING_MODE:{className:"string",begin:'"',end:'"',illegal:"\\n",contains:["escape"],relevance:0},BACKSLASH_ESCAPE:{className:"escape",begin:"\\\\.",end:"^",relevance:0},C_LINE_COMMENT_MODE:{className:"comment",begin:"//",end:"$",relevance:0},C_BLOCK_COMMENT_MODE:{className:"comment",begin:"/\\*",end:"\\*/"},HASH_COMMENT_MODE:{className:"comment",begin:"#",end:"$"},C_NUMBER_MODE:{className:"number",begin:"\\b(0x[A-Za-z0-9]+|\\d+(\\.\\d+)?)",
end:"^",relevance:0}};var r=function(q,t){this.langName=q;this.lang=f.languages[q];this.modes=[this.lang.defaultMode];this.keywordCount=this.relevance=0;this.result=[];this.lang.defaultMode.illegalRe||(this.buildRes(),q=this.lang,q.defaultMode&&q.modes&&(b(q.defaultMode),K.forEach(q.modes,b)));try{this.highlight(t),this.result=this.result.join("")}catch(w){if("Illegal"==w)this.keywordCount=this.relevance=0,this.partialResult=this.result.join(""),this.result=g(t);else throw w;}};e.extend(r,{buildRes:function(){K.forEach(this.lang.modes,
function(q){q.begin&&(q.beginRe=this.langRe("^"+q.begin));q.end&&(q.endRe=this.langRe("^"+q.end));q.illegal&&(q.illegalRe=this.langRe("^(?:"+q.illegal+")"))},this);this.lang.defaultMode.illegalRe=this.langRe("^(?:"+this.lang.defaultMode.illegal+")")},subMode:function(q){var t=this.modes[this.modes.length-1].contains;if(t)for(var w=this.lang.modes,u=0;u<t.length;++u)for(var v=t[u],x=0;x<w.length;++x){var z=w[x];if(z.className==v&&z.beginRe.test(q))return z}return null},endOfMode:function(q){for(var t=
this.modes.length-1;0<=t;--t){var w=this.modes[t];if(w.end&&w.endRe.test(q))return this.modes.length-t;if(!w.endsWithParent)break}return 0},isIllegal:function(q){var t=this.modes[this.modes.length-1].illegalRe;return t&&t.test(q)},langRe:function(q,t){return new RegExp(q,"m"+(this.lang.case_insensitive?"i":"")+(t?"g":""))},buildTerminators:function(){var q=this.modes[this.modes.length-1],t={};q.contains&&K.forEach(this.lang.modes,function(v){0<=K.indexOf(q.contains,v.className)&&(t[v.begin]=1)});
for(var w=this.modes.length-1;0<=w;--w){var u=this.modes[w];u.end&&(t[u.end]=1);if(!u.endsWithParent)break}q.illegal&&(t[q.illegal]=1);u=[];for(w in t)u.push(w);q.terminatorsRe=this.langRe("("+u.join("|")+")")},eatModeChunk:function(q,t){var w=this.modes[this.modes.length-1];w.terminatorsRe||this.buildTerminators();q=q.substr(t);return(t=w.terminatorsRe.exec(q))?{buffer:t.index?q.substr(0,t.index):"",lexeme:t[0],end:!1}:{buffer:q,lexeme:"",end:!0}},keywordMatch:function(q,t){t=t[0];this.lang.case_insensitive&&
(t=t.toLowerCase());for(var w in q.keywordGroups)if(t in q.keywordGroups[w])return w;return""},buildLexemes:function(q){var t={};K.forEach(q.lexems,function(v){t[v]=1});var w=[],u;for(u in t)w.push(u);q.lexemsRe=this.langRe("("+w.join("|")+")",!0)},processKeywords:function(q){var t=this.modes[this.modes.length-1];if(!t.keywords||!t.lexems)return g(q);t.lexemsRe||this.buildLexemes(t);t.lexemsRe.lastIndex=0;for(var w=[],u=0,v=t.lexemsRe.exec(q);v;)w.push(g(q.substr(u,v.index-u))),(u=this.keywordMatch(t,
v))?(++this.keywordCount,w.push('\x3cspan class\x3d"'+u+'"\x3e'+g(v[0])+"\x3c/span\x3e")):w.push(g(v[0])),u=t.lexemsRe.lastIndex,v=t.lexemsRe.exec(q);w.push(g(q.substr(u,q.length-u)));return w.join("")},processModeInfo:function(q,t,w){var u=this.modes[this.modes.length-1];if(w)this.result.push(this.processKeywords(u.buffer+q));else{if(this.isIllegal(t))throw"Illegal";if(w=this.subMode(t))u.buffer+=q,this.result.push(this.processKeywords(u.buffer)),w.excludeBegin?(this.result.push(t+'\x3cspan class\x3d"'+
w.className+'"\x3e'),w.buffer=""):(this.result.push('\x3cspan class\x3d"'+w.className+'"\x3e'),w.buffer=t),this.modes.push(w),this.relevance+="number"==typeof w.relevance?w.relevance:1;else if(w=this.endOfMode(t)){u.buffer+=q;for(u.excludeEnd?this.result.push(this.processKeywords(u.buffer)+"\x3c/span\x3e"+t):this.result.push(this.processKeywords(u.buffer+t)+"\x3c/span\x3e");1<w;)this.result.push("\x3c/span\x3e"),--w,this.modes.pop();this.modes.pop();this.modes[this.modes.length-1].buffer=""}}},highlight:function(q){var t=
0;this.lang.defaultMode.buffer="";do{var w=this.eatModeChunk(q,t);this.processModeInfo(w.buffer,w.lexeme,w.end);t+=w.buffer.length+w.lexeme.length}while(!w.end);if(1<this.modes.length)throw"Illegal";}});dojox.highlight.processString=function(q,t){return t?d(t,q):l(q)};dojox.highlight.init=function(q){q=p.byId(q);if(!a.contains(q,"no-highlight")&&m(q)){var t=q.className.split(/\s+/);K.some(t,function(w){if("_"!=w.charAt(0)&&f.languages[w]){var u=q;w=d(w,n(u));c(u,u.className,w.result);return!0}return!1})||
h(q)}};f.Code=function(q,t){f.init(t)};return f})},"dojox/highlight/languages/python":function(){define(["../_base"],function(e){var K=e.constants;e.languages.python={defaultMode:{lexems:[K.UNDERSCORE_IDENT_RE],illegal:"(\x3c/|-\x3e)",contains:"comment string function class number decorator".split(" "),keywords:{and:1,elif:1,is:1,global:1,as:1,"in":1,"if":1,from:1,raise:1,"for":1,except:1,"finally":1,print:1,"import":1,pass:1,None:1,"return":1,exec:1,"else":1,"break":1,not:1,"with":1,"class":1,assert:1,
yield:1,"try":1,"while":1,"continue":1,del:1,or:1,def:1,lambda:1}},modes:[{className:"function",lexems:[K.UNDERSCORE_IDENT_RE],begin:"\\bdef ",end:":",illegal:"$",keywords:{def:1},contains:["title","params"],relevance:10},{className:"class",lexems:[K.UNDERSCORE_IDENT_RE],begin:"\\bclass ",end:":",illegal:"[${]",keywords:{"class":1},contains:["title","params"],relevance:10},{className:"title",begin:K.UNDERSCORE_IDENT_RE,end:"^"},{className:"params",begin:"\\(",end:"\\)",contains:["string"]},K.HASH_COMMENT_MODE,
K.C_NUMBER_MODE,{className:"string",begin:"'''",end:"'''",relevance:10},{className:"string",begin:"r'''",end:"'''",relevance:10},{className:"string",begin:"u'''",end:"(^|[^\\\\])'''",relevance:10},{className:"string",begin:"ur'''",end:"'''",relevance:10},{className:"string",begin:'"""',end:'"""',relevance:10},{className:"string",begin:'r"""',end:'"""',relevance:10},{className:"string",begin:'u"""',end:'(^|[^\\\\])"""',relevance:10},{className:"string",begin:'ur"""',end:'"""',relevance:10},K.APOS_STRING_MODE,
K.QUOTE_STRING_MODE,K.BACKSLASH_ESCAPE,{className:"string",begin:"r'",end:"'",relevance:10},{className:"string",begin:'r"',end:'"',relevance:10},{className:"string",begin:"u'",end:"(^|[^\\\\])'",relevance:10},{className:"string",begin:'u"',end:'(^|[^\\\\])"',relevance:10},{className:"string",begin:"ur'",end:"'",relevance:10},{className:"string",begin:'ur"',end:'"',relevance:10},{className:"decorator",begin:"@",end:"$"}]};return e.languages.python})},"arcgisonline/pages/notebook/components/code-snippets/SnippetLibPreview":function(){define("require exports tslib preact preact/hooks dojo/i18n!arcgisonline/nls/arcgisonline ./SnippetsUtil arcgisonline/pages/notebook/utils/alerts arcgisonline/sharing/util arcgisonline/esriGeowConfig".split(" "),
function(e,K,p,a,g,m,n,b,c,d){Object.defineProperty(K,"__esModule",{value:!0});m=p.__importDefault(m);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);var l=m.default.itemProperties.snippetPreview,h;(function(f){f[f.NONE=0]="NONE";f[f.INITIAL_LOADING=1]="INITIAL_LOADING";f[f.PARTIAL_LOADING=2]="PARTIAL_LOADING"})(h||(h={}));K.default=function(f){function r(E){return p.__awaiter(this,void 0,void 0,function(){var I,F;return p.__generator(this,function(D){switch(D.label){case 0:return D.trys.push([0,
2,3,4]),x(E),[4,c.default.request({url:"".concat(d.default.restBaseUrl,"content/items/").concat(t.id,"/resources"),content:{num:w.num,start:w.start,sortField:"created",sortOrder:"desc"}})];case 1:return I=D.sent(),u({num:50,start:I.nextStart,total:I.total}),A(function(C){return C.concat(I.resources.map(function(y){return p.__assign(p.__assign({},y),{properties:JSON.parse(y.properties),itemId:t.id})}))}),[3,4];case 2:return F=D.sent(),b.default.showAlert("danger",F.message),[3,4];case 3:return x(h.NONE),
[7];case 4:return[2]}})})}function q(E){return p.__awaiter(this,void 0,void 0,function(){var I,F;return p.__generator(this,function(D){switch(D.label){case 0:return D.trys.push([0,2,3,4]),R(!0),[4,(0,n.downloadSnippetResource)(E)];case 1:return I=D.sent(),J(I),[3,4];case 2:return F=D.sent(),b.default.showAlert("danger",F.message),[3,4];case 3:return R(!1),[7];case 4:return[2]}})})}var t=f.item;f=(0,g.useState)({num:100,start:0,total:0});var w=f[0],u=f[1],v=(0,g.useState)(h.NONE);f=v[0];var x=v[1],
z=(0,g.useState)([]);v=z[0];var A=z[1],B=(0,g.useState)("");z=B[0];var J=B[1],P=(0,g.useState)(!1);B=P[0];var R=P[1];P=(0,g.useState)("");var S=P[0],T=P[1];(0,g.useEffect)(function(){r(h.INITIAL_LOADING)},[]);return(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"leader-half trailer-1 text-1"},l.snippets),(0,a.h)("div",{class:"flex-1 flex overflow-auto"},(0,a.h)("div",{class:"preview-list-container flex-column"},l.count.replace("${count}",Math.max(0,-1===w.start?w.total:w.start-1)),(0,a.h)("div",{class:"preview-snippet-list full-height"},
f===h.INITIAL_LOADING&&(0,a.h)("div",{class:"leader-1 padding-1 font-size--2"},(0,a.h)("calcite-loader",{style:{"--calcite-loader-padding":"0"},label:m.default.common.loading,scale:"s"}),(0,a.h)("div",{class:"text-center leader-1"},m.default.common.loading)),f!==h.INITIAL_LOADING&&(0,a.h)(a.Fragment,null,(0,a.h)("div",{class:"snippet-search-container"},(0,a.h)("calcite-input",{oncalciteInputInput:function(E){return T(E.target.value)},icon:"search",iconFlipRtl:!0,id:"info",placeholder:m.default.common.search})),
v.filter(function(E){return!S||E.properties.name.includes(S)||E.properties.description.includes(S)}).map(function(E){return(0,a.h)("div",{class:"padding-1 bg-white margin-left-half margin-right-half leader-half snippet-container"},(0,a.h)("div",{class:"avenir-medium break-word"},E.properties.name),(0,a.h)("div",{class:"leader-half text-light break-word"},E.properties.description),(0,a.h)("div",{class:"flex leader-1"},(0,a.h)("a",{onClick:function(){return q(E)}},l.view)))}),0===w.total&&(0,a.h)("div",
{class:"flex flex-justify-center flex-align-center padding-1"},l.noSnippet),f===h.PARTIAL_LOADING&&(0,a.h)("div",{class:"flex flex-justify-center flex-align-center padding-1"},(0,a.h)("calcite-loader",{inline:!0,style:{"--calcite-loader-padding":"0"},label:m.default.common.loading,scale:"s"}),(0,a.h)("div",{class:"margin-left-half"},m.default.common.loading)),f!==h.PARTIAL_LOADING&&-1<w.start&&(0,a.h)("div",{class:"flex flex-justify-center padding-1"},(0,a.h)("calcite-button",{appearance:"outline",
kind:"neutral",onClick:function(){return r(h.PARTIAL_LOADING)}},l.load))))),(0,a.h)("div",{class:"margin-left-half flex-1 flex-column"},l.code,(B||!z)&&(0,a.h)("div",{class:"snippet-code-area flex-1 flex flex-align-center flex-justify-center"},B&&(0,a.h)("div",{class:"leader-1 padding-1 font-size--2"},(0,a.h)("calcite-loader",{style:{"--calcite-loader-padding":"0"},label:m.default.common.loading}),(0,a.h)("div",{class:"text-center leader-1"},m.default.common.loading)),!B&&!z&&(0,a.h)("span",null,
l.clickView)),!B&&z&&(0,a.h)("pre",{class:"code-face flex-1 flex-column overflow-auto leader-0 trailer-0"},(0,a.h)("code",{class:"bg-white flex-1",dangerouslySetInnerHTML:(0,n.StyledCode)(z)})))))}})},"arcgisonline/pages/notebook/components/code-snippets/SnippetsUtil":function(){define("require exports tslib esri/request arcgisonline/esriGeowConfig arcgisonline/sharing/util dojox/highlight esri/libs/sanitizer/Sanitizer ./CodeSnippetConstants arcgisonline/pages/notebook/utils/alerts".split(" "),function(e,
K,p,a,g,m,n,b,c,d){function l(h){return(0,a.default)({url:"".concat(g.default.restBaseUrl,"content/items/").concat(h.itemId,"/resources/").concat(h.resource),content:{read:!0,token:m.default.getToken()},handleAs:"text"})}Object.defineProperty(K,"__esModule",{value:!0});K.toggleSnippetSharing=K.updateSnippetSharing=K.removeSnippetFromLib=K.deleteItemResource=K.addUpdateSnippet=K.getSnippetResource=K.loadNBSnippetLibItems=K.StyledCode=K.downloadSnippetResource=void 0;a=p.__importDefault(a);g=p.__importDefault(g);
m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);d=p.__importDefault(d);K.downloadSnippetResource=l;K.StyledCode=function(h){var f=new b.default({whiteList:{span:["class"]}});h=n.default.processString(h,"python");return{__html:f.sanitize(h.result)}};K.loadNBSnippetLibItems=function(h){return p.__awaiter(this,void 0,void 0,function(){var f,r,q,t,w,u,v,x;return p.__generator(this,function(z){switch(z.label){case 0:f=h.query,r=h.pagination,q=h.setPagination,t=h.setLibItems,w="".concat(g.default.restBaseUrl,
"search"),z.label=1;case 1:return z.trys.push([1,3,4,5]),q(function(A){return p.__assign(p.__assign({},A),{loading:!0})}),u={q:f,sortField:"modified",sortOrder:"desc",num:r.num,start:r.start},[4,m.default.request({url:w,content:u})];case 2:return v=z.sent(),t(function(A){v.results.forEach(function(B,J){B.snippets={pagination:(0,c.getInitPagination)(),snippetsArr:[]};A[B.id]=B});return A}),q(function(A){return p.__assign(p.__assign({},A),{initialized:!0,start:v.nextStart,total:v.total})}),[3,5];case 3:return x=
z.sent(),d.default.showAlert("danger",x.message),[3,5];case 4:return q(function(A){return p.__assign(p.__assign({},A),{loading:!1})}),[7];case 5:return[2]}})})};K.getSnippetResource=function(h){return p.__awaiter(this,void 0,void 0,function(){var f,r,q,t,w,u;return p.__generator(this,function(v){switch(v.label){case 0:return f=h.snippet,r=h.setSnippetsCache,q=h.snippetsCache,t="".concat(f.itemId,"-").concat(f.resource),w=q[t],q[t]?[3,2]:[4,l(f)];case 1:u=v.sent(),r(function(x){var z;return p.__assign(p.__assign({},
x),(z={},z[t]=u,z))}),w=u,v.label=2;case 2:return[2,w]}})})};K.addUpdateSnippet=function(h){var f=h.itemId,r=h.formData;h=h.op;var q="".concat(g.default.restBaseUrl,"content/users/").concat(g.default.userInfo.id,"/items/").concat(f,"/").concat(h);return new Promise(function(t,w){m.default.postForm(r,q,function(u){t(u)},function(u){w(u)})})};K.deleteItemResource=function(h){var f=h.itemId;h=h.resourceKey;f="".concat(g.default.restBaseUrl,"content/users/").concat(g.default.userInfo.id,"/items/").concat(f,
"/removeResources");return m.default.request({url:f,content:{resource:h}},{usePost:!0})};K.removeSnippetFromLib=function(h,f,r){var q=r[h].snippets.snippetsArr.findIndex(function(t){return t.resource===f.resource});-1<q&&(r[h].snippets.snippetsArr.splice(q,1),r[h].snippets.pagination.total--)};K.updateSnippetSharing=function(h){var f=h.itemId,r=h.resource;h=h.access;var q="".concat(g.default.restBaseUrl,"content/users/").concat(g.default.userInfo.id,"/items/").concat(f,"/updateResources"),t=new FormData;
t.append("access",h);t.append("fileName",r);return new Promise(function(w,u){m.default.postForm(t,q,function(v){w(v)},function(v){u(v)})})};K.toggleSnippetSharing=function(h){var f="".concat(g.default.restBaseUrl,"content/users/").concat(g.default.userInfo.id,"/items/").concat(h.itemId,"/updateResources"),r=new FormData,q=JSON.parse(JSON.stringify(h.properties));q.deprecated=!q.deprecated;r.append("properties",JSON.stringify(q));r.append("fileName",h.resource);return new Promise(function(t,w){m.default.postForm(r,
f,function(u){t(u)},function(u){w(u)})})}})},"arcgisonline/pages/notebook/components/code-snippets/CodeSnippetConstants":function(){define(["require","exports"],function(e,K){Object.defineProperty(K,"__esModule",{value:!0});K.CODE_SNIPPET_LIBRARY_ITEM_TYPE=K.CodeSnippetActionBarEvents=K.getInitPagination=K.ACCESS=K.CodeSnippetTabs=void 0;(function(p){p[p.MY_SNIPPETS=0]="MY_SNIPPETS";p[p.SHARED=1]="SHARED";p[p.ESRI=2]="ESRI"})(K.CodeSnippetTabs||(K.CodeSnippetTabs={}));(function(p){p.PRIVATE="private";
p.ORG="org";p.PUBLIC="public"})(K.ACCESS||(K.ACCESS={}));K.getInitPagination=function(){return{num:100,start:1,total:0,loading:!0,initialized:!1,search:{prev:"",curr:""}}};(function(p){p[p.ADD_NEW_CODE_SNIPPET=0]="ADD_NEW_CODE_SNIPPET";p[p.ADD_NEW_SNIPPET_LIBRARY=1]="ADD_NEW_SNIPPET_LIBRARY";p[p.OPEN_LIBRARY_MANAGEMENT=2]="OPEN_LIBRARY_MANAGEMENT";p[p.SEARCH_UPDATED=3]="SEARCH_UPDATED"})(K.CodeSnippetActionBarEvents||(K.CodeSnippetActionBarEvents={}));K.CODE_SNIPPET_LIBRARY_ITEM_TYPE="Notebook Code Snippet Library"})},
"arcgisonline/pages/dijit/SubNav":function(){define("require exports tslib dojo/dom-class dojo/has dojo/hash dojo/query dojo/string dojo/topic dijit/_TemplatedMixin dijit/_WidgetBase ../../tsutils/declareDecorator ../utils/formatters ../utils/arrays ../utils/dom ../utils/focus ./InlineEdit dojo/text!./SubNav/templates/_option.html dojo/text!./SubNav/templates/_title.html dojo/text!./SubNav/templates/_paths.html dojo/text!./SubNav/templates/_path.html dojo/text!./SubNav/templates/SubNav.html dojo/i18n!../../nls/arcgisonline ../utils/icons".split(" "),
function(e,K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);B=p.__importDefault(B);
J=p.__importDefault(J);return function(){function P(R,S){this.templateString=A.default;this.i18n=B.default;this.linksHTML=this.activeLabel="";this.hideLinks="hide";this.edit=null;this._titleTypeSize="subnav-title";this.titleHTML=""}P.prototype.postMixInProperties=function(){var R=this,S;this.inherited(arguments);var T=this.links&&this.links.map(function(E){E.show=-1===Object.keys(E).indexOf("show")||E.show;return E}).filter(function(E){return E.show});0<(null===T||void 0===T?void 0:T.length)&&(this.hideLinks=
"",this.linksHTML=this.links.reduce(function(E,I){I.logClick=!!I.logClick;I.isActive=I.id===R.active?"is-active":"";I.isActive&&(R.activeLabel=I.label);return E+b.default.substitute(u.default,I,null,f.default)},""),document.title="".concat(this.titleText," - ").concat(this.activeLabel));if(100<(null===(S=this.title)||void 0===S?void 0:S.length)||this.paths)this._titleTypeSize+=" subnav-title--".concat(180<this.titleText.length?"smaller":"small"),this.edit&&(this.edit.titleClass=this._titleTypeSize);
this.titleHTML=this.paths?this.generateBreadCrumbs(this.paths):b.default.substitute(v.default,this)};P.prototype.postCreate=function(){var R=this;this.inherited(arguments);this.own((0,n.default)(".js-subnav-expand",this.domNode).on("click",this.toggleNav.bind(this)),(0,n.default)(".js-subnav-link",this.domNode).on("keyup",this.handleKeyUp.bind(this)),(0,n.default)(".js-subnav-link",this.domNode).on("click",this.handleLinkClick.bind(this)),c.default.subscribe("/dojo/hashchange",function(S){((0,g.default)("ie")||
(0,g.default)("trident")||(0,g.default)("edge"))&&R.updateActiveTab(S)}));this.paths&&this.attachBreadCrumbEvents();window.addEventListener("popstate",function(){R.updateActiveTab(window.location.hash)});this.edit&&(this.edit.formClass="flex flex-center fullscreen",this.edit.inputLabel=B.default.itemProperties.editTitle,this._titleEdit=new w.default(this.edit,this.domNode.querySelector(".js-subnav-edit")),this.own(c.default.subscribe("inlineEdit/".concat(this.edit.prop,"/done"),this.closeEdit.bind(this)),
c.default.subscribe("inlineEdit/".concat(this.edit.prop,"/cancel"),this.closeEdit.bind(this)),c.default.subscribe("inlineEdit/".concat(this.edit.prop,"/start"),this.openEdit.bind(this))))};P.prototype.showTab=function(R){(0,n.default)('.js-subnav-link[data-tab\x3d"'.concat(R,'"]'),this.domNode).removeClass("hide")};P.prototype.hideTab=function(R){(0,n.default)('.js-subnav-link[data-tab\x3d"'.concat(R,'"]'),this.domNode).addClass("hide")};P.prototype.showEditLink=function(){var R;null===(R=this._titleEdit)||
void 0===R?void 0:R.showEditLink()};P.prototype.hideEditLink=function(){var R;null===(R=this._titleEdit)||void 0===R?void 0:R.hideEditLink()};P.prototype.updateText=function(R){var S;null===(S=this._titleEdit)||void 0===S?void 0:S.updateText(R)};P.prototype.setPageTitle=function(R){this.domNode.querySelector("#pagetitle").textContent=R};P.prototype.updateBreadCrumbs=function(R){this.paths=R;this.domNode.querySelector(".js-subnav-title-wrap").innerHTML=this.generateBreadCrumbs(R);this.attachBreadCrumbEvents()};
P.prototype.updateActiveTab=function(R){R=R||"overview";var S=(0,n.default)(".js-subnav-link",this.domNode);S.removeClass("is-active").attr("aria-selected","false");if(S=r.default.find(S,function(T){return T.getAttribute("href").replace("#","")===R.replace("#","")}))a.default.add(S,"is-active"),S.setAttribute("aria-selected","true"),this.activeLabel=S.textContent,this.domNode.querySelector(".js-subnav-current-label").innerHTML=this.activeLabel,this.closeNav(),document.title="".concat(this.titleText,
" - ").concat(this.activeLabel)};P.prototype.attachBreadCrumbEvents=function(){var R=this,S;this.domNode.querySelectorAll(".js-subnav-paths")&&0<(null===(S=this.paths)||void 0===S?void 0:S.length)&&(q.default.forEachNode(this.domNode.querySelectorAll(".js-subnav-path"),function(T,E){var I;(null===(I=R.paths[E])||void 0===I?0:I.onPathClick)&&T.addEventListener("click",function(F){R.paths[E].onPathClick(F)})}),S=this.paths[this.paths.length-1],S.edit&&(S.edit.formClass="flex flex-center fullscreen",
S.edit.inputLabel=B.default.itemProperties.editTitle,this._titleEdit=new w.default(S.edit,this.domNode.querySelector(".js-last-path")),this.own(c.default.subscribe("inlineEdit/".concat(S.edit.prop,"/done"),this.closeEdit.bind(this)),c.default.subscribe("inlineEdit/".concat(S.edit.prop,"/cancel"),this.closeEdit.bind(this)),c.default.subscribe("inlineEdit/".concat(S.edit.prop,"/start"),this.openEdit.bind(this)))))};P.prototype.generateBreadCrumbs=function(R){R=R.map(function(S,T,E){return b.default.substitute(z.default,
p.__assign(p.__assign({},S),{icons:J.default,showBack:1<E.length&&0===T?"":"hide",lastPath:T===E.length-1?"js-last-path subnav-breadcrumb-last flex-0":"subnav-breadcrumb-first js-early-path"}))}).join("\x3cspan class\x3d'subnav-breadcrumb-separator flex-0 js-early-path'\x3e/\x3c/span\x3e");return b.default.substitute(x.default,{paths:R,_titleTypeSize:this._titleTypeSize})};P.prototype.openNav=function(){var R=this;this.domNode.querySelector(".js-subnav-expand").setAttribute("aria-expanded","true");
(0,n.default)(".js-subnav-links, .js-subnav-expand",this.domNode).addClass("is-active");window.setTimeout(function(){var S,T=R.domNode.querySelector(".js-subnav-links");null===(S=T.firstChild)||void 0===S?void 0:S.focus();R.focusTrapHandler=t.default.trapFocus(T)},100)};P.prototype.closeNav=function(){this.domNode.querySelector(".js-subnav-expand").setAttribute("aria-expanded","false");(0,n.default)(".js-subnav-links, .js-subnav-expand",this.domNode).removeClass("is-active");this.focusTrapHandler&&
(t.default.untrapFocus(this.domNode.querySelector(".js-subnav-links"),this.focusTrapHandler),this.domNode.querySelector(".js-subnav-expand").focus())};P.prototype.toggleNav=function(R){a.default.contains(R.target,"is-active")?this.closeNav():this.openNav()};P.prototype.openEdit=function(R){(0,n.default)(".js-subnav-links,.js-subnav-expand,.js-early-path").addClass("visibility-hidden")};P.prototype.closeEdit=function(){(0,n.default)(".js-subnav-links,.js-subnav-expand,.js-early-path").removeClass("visibility-hidden")};
P.prototype.handleKeyUp=function(R){32===R.keyCode?(R.preventDefault(),this.logClickEvent(R.target,this.telemetry),(0,m.default)(R.target.getAttribute("href"),!0)):"Escape"===R.key&&this.domNode.querySelector(".js-subnav-expand").classList.contains("is-active")&&this.closeNav()};P.prototype.handleLinkClick=function(R){this.logClickEvent(R.target,this.telemetry)};P.prototype.logClickEvent=function(R,S){"true"===(null===R||void 0===R?void 0:R.dataset.logclick)&&(null===S||void 0===S?void 0:S.logEvent({category:"Secondary Nav",
action:R.dataset.tab,size:window.innerWidth,pageUrl:window.location.href}))};return P=p.__decorate([(0,h.default)(l.default,d.default)],P)}()})},"dojox/charting/bidi/widget/Chart":function(){define(["dojo/_base/declare"],function(e){return e(null,{postMixInProperties:function(){this.textDir=this.params.textDir?this.params.textDir:this.params.dir},_setTextDirAttr:function(K){null!=(/^(ltr|rtl|auto)$/.test(K)?K:null)&&(this._set("textDir",K),this.chart.setTextDir(K))},_setDirAttr:function(K){this._set("dir",
K);this.chart.setDir(K)}})})},"dojox/charting/bidi/axis2d/Default":function(){define(["dojo/_base/declare","dojo/dom-style"],function(e,K){return e(null,{labelTooltip:function(p,a,g,m,n,b){var c="rtl"==K.get(a.node,"direction"),d="rtl"==a.getTextDir(g);d&&!c&&(g="\x3cspan dir\x3d'rtl'\x3e"+g+"\x3c/span\x3e");!d&&c&&(g="\x3cspan dir\x3d'ltr'\x3e"+g+"\x3c/span\x3e");this.inherited(arguments)},_isRtl:function(){return this.chart.isRightToLeft()}})})},"dojox/charting/bidi/action2d/Tooltip":function(){define(["dojo/_base/declare",
"dojo/dom-style"],function(e,K){return e(null,{_recheckPosition:function(p,a,g){if(this.chart.isRightToLeft()){var m=this.chart.offsets.l-this.chart.offsets.r;"marker"==p.element?(a.x=this.chart.dim.width-p.cx+m,g[0]="before-centered",g[1]="after-centered"):"circle"==p.element?a.x=this.chart.dim.width-p.cx-p.cr+m:"bar"==p.element||"column"==p.element?(a.x=this.chart.dim.width-a.width-a.x+m,"bar"==p.element&&(g[0]="before-centered",g[1]="after-centered")):"candlestick"==p.element?a.x=this.chart.dim.width+
m-p.x:"slice"==p.element&&("before-centered"!=g[0]&&"after-centered"!=g[0]||g.reverse(),a.x=p.cx+(p.cx-a.x))}},_format:function(p){var a="rtl"==K.get(this.chart.node,"direction"),g="rtl"==this.chart.getTextDir(p);return g&&!a?"\x3cspan dir \x3d 'rtl'\x3e"+p+"\x3c/span\x3e":!g&&a?"\x3cspan dir \x3d 'ltr'\x3e"+p+"\x3c/span\x3e":p}})})},"dojox/charting/bidi/action2d/ZoomAndPan":function(){define(["dojo/_base/declare"],function(e){return e(null,{_getDelta:function(K){return this.inherited(arguments)*
(this.chart.isRightToLeft()?-1:1)}})})},"dojox/charting/bidi/widget/Legend":function(){define("dojo/_base/declare dojo/dom dijit/registry dojo/_base/connect dojo/_base/array dojo/query".split(" "),function(e,K,p,a,g,m){function n(b){return/^(ltr|rtl|auto)$/.test(b)?b:null}return e(null,{postMixInProperties:function(){if(this.chart)this.textDir=this.chart.textDir,a.connect(this.chart,"setTextDir",this,"_setTextDirAttr");else if(this.chartRef){var b=p.byId(this.chartRef);if(!b)if(b=K.byId(this.chartRef))b=
p.byNode(b);else return;this.textDir=b.textDir;a.connect(b,"setTextDir",this,"_setTextDirAttr")}},_setTextDirAttr:function(b){null!=n(b)&&this.textDir!=b&&(this._set("textDir",b),b=m(".dojoxLegendText",this._tr),g.forEach(b,function(c){c.dir=this.getTextDir(c.innerHTML,c.dir)},this))}})})},"url:arcgisonline/pages/dijit/ImageViewer/ImageViewer.html":'\x3cdiv class\x3d"image-viewer js-image-viewer"\x3e\r\n  \x3cimg src\x3d"${url}" alt\x3d"${alt}" class\x3d"image-viewer__img"\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/dijit/InlineEdit/templates/InlineEdit.html":'\x3cdiv\x3e\r\n    \x3ch1 class\x3d"${titleClass} break-word flex text-ellipsis" data-edit-id\x3d"name" id\x3d"itemtitle" data-dojo-attach-point\x3d"_textView"\x3e\r\n        \x3cspan class\x3d"if-name js-view subnav-title__name" id\x3d"${titleId}"\x3e\x3c/span\x3e\r\n        \x3cbutton class\x3d"js-inline-edit btn btn-transparent padding-leader-quarter font-size--3 inline-edit-pencil ${editButtonClasses}" data-edit-id\x3d"title" aria-label\x3d"${inputLabel}"\x3e${!icons.edit.16}\x3c/button\x3e\r\n    \x3c/h1\x3e\r\n    \x3cform class\x3d"hide ${formClass}" data-edit-id\x3d"name" data-dojo-attach-point\x3d"_form"\x3e\r\n        \x3cdiv class\x3d"leader-0 flex flex-1"\x3e\r\n            \x3cinput maxlength\x3d"250" class\x3d"${inputClass} flex-1 margin-right-1 margin-left-0" name\x3d"name" type\x3d"text" placeholder\x3d"${placeholder}"\r\n                value\x3d"${value}" data-dojo-attach-point\x3d"_input" autocomplete\x3d"off"\x3e\r\n            \x3cspan class\x3d"flex-0"\x3e\r\n                \x3cbutton class\x3d"${saveButtonClasses}" type\x3d"submit" data-dojo-attach-point\x3d"_saveButton"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"flex-0"\x3e\r\n                \x3cbutton class\x3d"${cancelButtonClasses}" data-dojo-attach-point\x3d"_cancelButton"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"inline-edit-save-loader hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditTextArea.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_textView"\x3e\r\n        \x3cbutton class\x3d"js-inline-edit right btn-link btn-link-darker-gray font-size--3 ${editButtonUpdatePermissionClasses}" aria-label\x3d"${inputLabel}"\x3e\r\n            ${!icons.inline.edit.16} ${i18n.common.edit}\r\n        \x3c/button\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_form" class\x3d"hide" data-edit-id\x3d"snippet" aria-live\x3d"polite"\x3e\r\n        \x3clabel class\x3d"trailer-quarter" for\x3d"${inputId}"\x3e\r\n            ${inputLabel}\r\n            \x3ctextarea\r\n                id\x3d"${inputId}"\r\n                data-dojo-attach-point\x3d"_input"\r\n                name\x3d"snippet"\r\n                rows\x3d"${rows}"\r\n                class\x3d"js-snippet-input display-block resize-v"\x3e${value}\x3c/textarea\x3e\r\n        \x3c/label\x3e\r\n        \x3cdiv class\x3d"flex"\x3e\r\n            \x3cdiv class\x3d"flex-1"\x3e\r\n                \x3cdiv class\x3d"hide inline-edit__characters-left" data-dojo-attach-point\x3d"_charactersLeft"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"leader-quarter"\x3e\r\n                \x3cspan class\x3d"inline-edit-textarea__save-loader margin-right-half hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n                \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n                \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditFieldValueType.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_textView"\x3e\r\n    \x3cbutton class\x3d"js-inline-edit right btn-link btn-link-darker-gray font-size--3 ${editButtonUpdatePermissionClasses}" aria-label\x3d"${inputLabel}"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"_form" class\x3d"hide" data-edit-id\x3d"snippet" aria-live\x3d"polite"\x3e\r\n    \x3clabel class\x3d"trailer-half"\x3e\r\n      ${inputLabel}\r\n      \x3cselect class\x3d"dropdown-change" data-dojo-attach-point\x3d"_input"\x3e\x3c/select\x3e\r\n    \x3c/label\x3e\r\n    \x3cdiv class\x3d"text-right"\x3e\r\n        \x3cspan class\x3d"inline-edit-textarea__save-loader margin-right-half hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditRichText.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_textView" class\x3d"trailer-2"\x3e\r\n        \x3cbutton class\x3d"js-inline-edit btn-link btn-link-darker-gray ${editButtonUpdatePermissionClasses} font-size--3 right" aria-label\x3d"${inputLabel}"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_form" action\x3d"" class\x3d"hide leader-1" aria-live\x3d"polite"\x3e\r\n        \x3clabel class\x3d"trailer-half" for\x3d"${inputId}"\x3e${inputLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"${inputId}" class\x3d"rich-text" data-dojo-attach-point\x3d"_inputEl"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"text-right leader-half"\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditCustom.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_textView" class\x3d"leader-1 padding-leader-half"\x3e\r\n        \x3cbutton class\x3d"js-inline-edit btn-link btn-link-darker-gray if-can-update font-size--3 right" aria-label\x3d"${inputLabel}"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n        \x3ch5 class\x3d"trailer-half"\x3e\r\n            ${viewTitle}\r\n        \x3c/h5\x3e\r\n        \x3cp class\x3d"js-view break-word"\x3e\x3c/p\x3e\r\n    \x3c/div\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_form" action\x3d"" class\x3d"hide ${formClass}" aria-live\x3d"polite"\x3e\r\n        ${formTitle}\r\n        \x3cdiv data-dojo-attach-point\x3d"_inputEl"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"text-right ${buttonsClass}"\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditLayerRename.html":'\x3cdiv\x3e\r\n    \x3ch5 class\x3d"font-size-1 trailer-0 leader-0 sub-nav-title break-word" data-edit-id\x3d"name" id\x3d"itemtitle" data-dojo-attach-point\x3d"_textView"\x3e\r\n        \x3cspan class\x3d"padding-right-1 gutter-right-1 rtl-gutter-right-0"\x3e\r\n            \x3ca target\x3d"_blank" href\x3d"${layerUrl}" class\x3d"if-name js-view"\x3e\x3c/a\x3e\r\n        \x3c/span\x3e\r\n        \x3cbutton class\x3d"js-inline-edit right btn-link font-size--3 btn-link-darker-gray if-can-renameLayer" aria-label\x3d"${inputLabel}"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n    \x3c/h5\x3e\r\n    \x3cform class\x3d"column-12 padding-leader-half padding-trailer-half hide" data-edit-id\x3d"name" data-dojo-attach-point\x3d"_form"\x3e\r\n        \x3cdiv class\x3d"input-group leader-0"\x3e\r\n            \x3cinput maxlength\x3d"250" class\x3d"input-group-input" name\x3d"name" type\x3d"text" placeholder\x3d"${placeholder}"\r\n                value\x3d"${value}" data-dojo-attach-point\x3d"_input"\x3e\r\n            \x3cspan class\x3d"input-group-button padding-right-quarter"\x3e\r\n                \x3cbutton class\x3d"btn" type\x3d"submit" data-dojo-attach-point\x3d"_saveButton"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"input-group-button"\x3e\r\n                \x3cbutton class\x3d"btn-link btn btn-clear btn-two cancel-title-edit" data-dojo-attach-point\x3d"_cancelButton"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"inline-edit-save-loader hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditLayerRenameSubnav.html":'\x3cdiv class\x3d"flex-1 flex"\x3e\r\n    \x3ch5 class\x3d"trailer-0 leader-0 break-word flex" data-edit-id\x3d"name" id\x3d"itemtitle" data-dojo-attach-point\x3d"_textView"\x3e\r\n        \x3cspan class\x3d"padding-right-1 gutter-right-1 rtl-gutter-right-0 js-view subnav-breadcrumb flex-1 text-ellipsis"\x3e\x3c/span\x3e\r\n        \x3cbutton class\x3d"js-inline-edit right btn-link font-size--3 btn-link-white" aria-label\x3d"${inputLabel}"\x3e${!icons.edit.16}\x3c/button\x3e\r\n    \x3c/h5\x3e\r\n    \x3cform class\x3d"hide ${formClass}" data-edit-id\x3d"name" data-dojo-attach-point\x3d"_form"\x3e\r\n        \x3cdiv class\x3d"leader-0 flex flex-1"\x3e\r\n            \x3cinput maxlength\x3d"250" class\x3d"${inputClass} flex-1 margin-right-1 margin-left-0" name\x3d"name" type\x3d"text" placeholder\x3d"${placeholder}"\r\n                value\x3d"${value}" data-dojo-attach-point\x3d"_input" autocomplete\x3d"off"\x3e\r\n            \x3cspan class\x3d"flex-0"\x3e\r\n                \x3cbutton class\x3d"${saveButtonClasses}" type\x3d"submit" data-dojo-attach-point\x3d"_saveButton"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"flex-0"\x3e\r\n                \x3cbutton class\x3d"${cancelButtonClasses}" data-dojo-attach-point\x3d"_cancelButton"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"inline-edit-save-loader hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditNotebookTags.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_textView"\x3e\r\n    \x3cbutton\r\n      class\x3d"js-inline-edit btn-link btn-link-darker-gray if-can-update font-size--3 right"\r\n      aria-label\x3d"${inputLabel}"\r\n    \x3e\r\n      ${!icons.inline.edit.16}${i18n.common.edit}\r\n    \x3c/button\x3e\r\n    \x3ch4 class\x3d"panel-header if-tag if-can-update"\x3e${viewTitle}\x3c/h5\x3e\r\n    \x3cp class\x3d"js-view"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"_form" action\x3d"" class\x3d"hide ${formClass}" aria-live\x3d"polite"\x3e\r\n    ${formTitle}\r\n    \x3cdiv data-dojo-attach-point\x3d"_inputEl"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"text-right ${buttonsClass}"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditNumericChange.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_textView"\x3e\r\n      \x3ccalcite-label\x3e ${inputLabel}\r\n        \x3ccalcite-input class\x3d"js-inlineEditNumericChangeReadOnlyValue ${inputClass}" read-only type\x3d"number"\x3e\r\n          \x3ccalcite-button id\x3d"${inputId}_numeric-value-edit-button" class\x3d"js-inline-edit ${editButtonUpdatePermissionClasses}" icon-start\x3d"pencil" kind\x3d"inverse" appearance\x3d"outline-fill" slot\x3d"action" aria-label\x3d"${inputLabel}"\x3e\x3c/calcite-button\x3e\r\n        \x3c/calcite-input\x3e\r\n      \x3c/calcite-label\x3e\r\n      \x3ccalcite-tooltip reference-element\x3d"${inputId}_numeric-value-edit-button" label\x3d"${i18n.common.edit}"\x3e\x3cspan\x3e${i18n.common.edit}\x3c/span\x3e\x3c/calcite-tooltip\x3e\r\n    \x3c/div\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_form" class\x3d"hide" data-edit-id\x3d"snippet" aria-live\x3d"polite"\x3e\r\n      \x3ccalcite-label\x3e ${inputLabel}\r\n        \x3ccalcite-input type\x3d"number" data-dojo-attach-point\x3d"_input"\x3e\x3c/calcite-input\x3e\r\n        \x3cdiv class\x3d"save-and-cancel"\x3e\r\n            \x3cspan class\x3d"inline-edit-textarea__save-loader margin-right-half hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n            \x3ccalcite-button data-dojo-attach-point\x3d"_cancelButton" appearance\x3d"outline-fill" width\x3d"half" class\x3d"cancel-button"\x3e${i18n.common.cancel}\x3c/calcite-button\x3e\r\n            \x3ccalcite-button data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" width\x3d"half" class\x3d"save-button"\x3e${i18n.common.save}\x3c/calcite-button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/calcite-label\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ItemShareSummary/ItemShareSummary.html":'\x3cdiv class\x3d"share-summary ${directionClass} ${responsiveClass}"\x3e\r\n  \x3cbutton class\x3d"js-share-button share-summary__button flex flex-center flex-0" id\x3d"${uid}"\x3e\r\n    \x3cspan class\x3d"js-icon share-summary__level flex flex-center"\x3e${!levelIcon}\x3c/span\x3e\r\n    \x3cspan class\x3d"js-sharing-plus-icon share-summary__plus"\x3e${!icons.plus.16}\x3c/span\x3e\r\n    \x3cspan class\x3d"share-summary__group share-summary__group--unknown"\x3e\r\n      ${!icons.users.16}\r\n    \x3c/span\x3e\r\n  \x3c/button\x3e\r\n  \x3ccalcite-tooltip class\x3d"js-share-summary-tooltip" reference-element\x3d"${uid}"\x3e\r\n    \x3cspan class\x3d"js-tooltip-content share-tooltip-text avenir-regular font-size--3 trailer-0 leader-0"\x3e${levelTooltip}\x3c/span\x3e\r\n  \x3c/calcite-tooltip\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/OrgPopup/OrgPopup.html":'\x3cdiv\x3e\r\n  \x3cspan tabindex\x3d"0" data-dojo-attach-point\x3d"closeIcon" class\x3d"hide popover-close icon-ui-close" tab-index\x3d"0" aria-label\x3d"${i18n.common.close}"\x3e\x3c/span\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"loader" class\x3d"profile-popup__loader loader"\x3e\r\n    \x3cdiv class\x3d"profile-popup__loader-bars loader-bars"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"text-left" data-dojo-attach-point\x3d"content"\x3e\r\n    \x3cdiv class\x3d"profile-popup__top-section flex flex-align-center"\x3e\r\n      \x3cimg src\x3d"${item.verified.thumbnail}" class\x3d"profile-popup__org-thumbnail margin-right-1"\x3e\r\n      \x3cdiv class\x3d"flex-1 font-size-1 avenir-demi"\x3e\r\n        ${item.verified.name}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"profile-popup__org-bottom" data-dojo-attach-point\x3d"bottomSection"\x3e\r\n      \x3cdiv class\x3d"profile-popup__bio-container" data-dojo-attach-point\x3d"descContainer"\x3e\r\n        \x3cp class\x3d"profile-popup__bio-section trailer-half" data-dojo-attach-point\x3d"descEl"\x3e\x3c/p\x3e\r\n        \x3cbutton class\x3d"hide btn-link btn-link-darker-gray profile-popup__more-toggle" data-dojo-attach-point\x3d"descToggle"\x3e${!icons.chevron-down.24}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"leader-1"\x3e\r\n        \x3ca href\x3d"${item.verified.url}"  target\x3d"_blank"\x3e${i18n.myOrganization.homeTab.tabTitle} ${!icons.inline-end.launch.16}\x3c/a\x3e\r\n        \x3ca href\x3d"${item.verified.url}gallery.html"  target\x3d"_blank" class\x3d"margin-left-1"\x3e${i18n.myOrganization.galleryTab.tabTitle} ${!icons.inline-end.launch.16}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ToggleSwitch/templates/ToggleSwitch.html":'\x3cdiv class\x3d"toggle-switch clearfix ${labelClasses} ${hasTooltip}"\x3e\r\n  \x3cinput id\x3d"${uid}" type\x3d"checkbox" class\x3d"toggle-switch-input" aria-label\x3d"${ariaLabel}" data-dojo-attach-point\x3d"_checkbox"\x3e\r\n  \x3cspan class\x3d"toggle-switch-track ${direction} ${switchTrackClasses}" data-dojo-attach-point\x3d"toggleTrack"\x3e\x3c/span\x3e\r\n  \x3cdiv class\x3d"inline-block margin-${direction}-half toggle-switch-label ${tooltipClass} padding-leader-quarter padding-trailer-quarter" data-dojo-attach-point\x3d"_label"\x3e\r\n    \x3clabel class\x3d"toggle-switch-label--text trailer-0" for\x3d"${uid}" data-dojo-attach-point\x3d"labelWrapper"\x3e${!label}\x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"loaderContainer" class\x3d"toggle-switch__loader-container hide ${loaderClasses}"\x3e\r\n    \x3ccalcite-loader scale\x3d"l" inline data-dojo-attach-point\x3d"loader"\x3e\x3c/calcite-loader\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/CopyToClipboard.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"input-group js-copy-group"\x3e\r\n    \x3clabel for\x3d"copy-to-clipboard-${id}" class\x3d"screen-readers-only"\x3e${label}\x3c/label\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"copyInput" class\x3d"input-group-input copy-to-clipboard-input" readonly type\x3d"text" value\x3d"${text}" id\x3d"copy-to-clipboard-${id}"\x3e\r\n    \x3cspan class\x3d"js-copy-tooltip input-group-button tooltip ${tooltipModifier}" aria-label\x3d"${i18n.tocPanel.copy}"\x3e\r\n      \x3cbutton aria-label\x3d"${i18n.itemProperties.copyToClipboard}"\r\n              class\x3d"js-copy-btn btn btn-clear"\r\n              data-dojo-attach-event\x3d"click: copy, mouseleave: reset"\x3e\r\n              \x3ccalcite-icon scale\x3d"s" icon\x3d"${icon}" \x3e\x3c/calcite-icon\x3e\r\n      \x3c/button\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cp role\x3d"alert" aria-live\x3d"polite" class\x3d"js-copy-alert screen-readers-only"\x3e\x3c/p\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_sublayer.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"hide js-metadata-wrapper"\x3e\r\n    \x3cdiv class\x3d"metadata-mask"\x3e\x3c/div\x3e\r\n    \x3ciframe class\x3d"metadata-editor-container js-metadata-iframe hide" title\x3d"${i18n.metadataEditor.title}"\x3e\x3c/iframe\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-sublayer-content hide"\x3e\r\n    \x3cdiv class\x3d"column-17 tablet-column-6 post-1 rtl-post-0"\x3e\r\n      \x3cdiv class\x3d"column-17 flex phone-flex-column phone-trailer-2 first-column tablet-column-6"\x3e\r\n        \x3cdiv class\x3d"phone-leader-1"\x3e\r\n          \x3cdiv class\x3d"sublayer-map" data-dojo-attach-point\x3d"map"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"js-snippet-section leader-1"\x3e\r\n            \x3cp class\x3d"trailer-1 font-size--1 js-typeOwner-info"\x3e\r\n              \x3carcgis-sublayer-type type\x3d"${layerType}" geometry\x3d"${geometryType}"\x3e\x3c/arcgis-sublayer-type\x3e\r\n            \x3c/p\x3e\r\n          \x3c/div\x3e\r\n          \x3cbutton class\x3d"flex btn-link" data-dojo-attach-point\x3d"sublayerOwnerPopup"\x3e\r\n            \x3cspan class\x3d"js-sublayer-owner-thumb no-pointer"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"flex-1 font-size--2 padding-left-quarter no-pointer"\x3e${item.owner}\x3c/span\x3e\r\n          \x3c/button\x3e\r\n          \x3cp class\x3d"font-size--3 trailer-half leader-1 text-darker-gray" data-dojo-attach-point\x3d"lastUpdated"\x3e\r\n            \x3cspan class\x3d"inline-block margin-right-1 margin-left-0"\x3e\r\n              ${i18n.itemProperties.dataLastModified} ${lastUpdate}\r\n            \x3c/span\x3e\r\n          \x3c/p\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3caside class\x3d"column-6 right tablet-column-6 tablet-right padding-trailer-2"\x3e\r\n      \x3cdiv class\x3d"if-featureCollection if-vectorTile if-2d if-table"\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half display-block js-status-disable"\x3e\r\n          \x3cdiv class\x3d"flex clearfix"\x3e\r\n            \x3ca\r\n              data-dojo-attach-point\x3d"viewerLink"\r\n              class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-open-mapViewer js-open-btn js-action-newWebMapViewer"\r\n            \x3e\r\n              ${i18n.itemLinks.openMapViewer}\r\n            \x3c/a\x3e\r\n            \x3cbutton\r\n              class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle js-map-dropdown"\r\n              aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n            \x3e\r\n              ${!icons.chevron-down.16}\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n          \x3cnav class\x3d"dropdown-menu dropdown-menu-full dropdown-right"\x3e\r\n            \x3ca data-dojo-attach-point\x3d"newViewerLink" class\x3d"dropdown-link test-ellipsis"\r\n              \x3e${i18n.itemLinks.addToNewViewer}\r\n            \x3c/a\x3e\r\n            \x3ca data-dojo-attach-point\x3d"newViewerWithEditLink" class\x3d"dropdown-link test-ellipsis if-can-edit-service"\r\n              \x3e${i18n.itemProperties.openViewerFullEditingRole}\r\n            \x3c/a\x3e\r\n            \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n              \x3ca data-dojo-attach-point\x3d"newMapViewerLink" class\x3d"dropdown-link if-feature"\r\n                \x3e${!i18n.itemLinks.openMapViewerBetaLabel}\r\n              \x3c/a\x3e\r\n              \x3c!-- removed if-vectorTile if-mapService if-mapImage classes, reapply at 8.2 --\x3e\r\n            \x3c/div\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-can-export if-no-spatiotemporal if-not-velocity"\x3e\r\n        \x3cbutton\r\n          class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n          tabindex\x3d"0"\r\n        \x3e\r\n          ${i18n.itemProperties.exportLabel}${!icons.inline-end.chevron-down.16}\r\n        \x3c/button\x3e\r\n        \x3cnav data-dojo-attach-point\x3d"export" class\x3d"dropdown-menu dropdown-right can-export js-action-exportData"\x3e\r\n          \x3cbutton data-type\x3d"Shapefile" class\x3d"dropdown-link if-no-multipatch"\x3e\r\n            ${i18n.itemProperties.exportToShapefile}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"CSV" class\x3d"dropdown-link if-no-multipatch"\x3e${i18n.itemProperties.exportToCSVFile}\x3c/button\x3e\r\n          \x3cbutton data-type\x3d"KML" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToKML}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"Excel" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToExcel}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"File Geodatabase" class\x3d"dropdown-link if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToFgdb}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"GeoJson" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToGeoJson}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"Feature Collection" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToFeatureCollection}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"GeoPackage" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToGeoPackage}\r\n          \x3c/button\x3e\r\n        \x3c/nav\x3e\r\n      \x3c/div\x3e\r\n      \x3cbutton\r\n        data-type\x3d"features"\r\n        class\x3d"trailer-half btn btn-fill btn-wrap text-ellipsis btn-clear if-can-publish-views if-not-velocity hide js-create-view-button"\r\n      \x3e\r\n        ${i18n.itemProperties.publishViewLayer}\r\n      \x3c/button\x3e\r\n      \x3cdiv class\x3d"js-create-view-dropdown dropdown js-dropdown trailer-half if-can-publish-views if-not-velocity"\x3e\r\n        \x3cbutton class\x3d"js-if-not-readonly btn btn-fill btn-clear btn-wrap js-dropdown-toggle js-open-btn" tabindex\x3d"0"\x3e\r\n          ${i18n.itemProperties.publishViewLayer}${!icons.inline-end.chevron-down.16}\r\n        \x3c/button\x3e\r\n        \x3cdiv class\x3d"dropdown-menu dropdown-menu-add-create__container dropdown-menu-add-create__overview" role\x3d"menu"\x3e\r\n          \x3cnav class\x3d"dropdown-menu-add-create dropdown-menu-add-create__column"\x3e\r\n            \x3cp class\x3d"trailer-half"\x3e${i18n.itemProperties.chooseViewMethod}\x3c/p\x3e\r\n            \x3cbutton\r\n              id\x3d"create-view-layer"\r\n              class\x3d"dropdown-link-add-create trailer-half"\r\n              data-type\x3d"features"\r\n              data-method\x3d"create"\r\n              role\x3d"menuitem"\r\n              data-dojo-attach-point\x3d"viewLayer"\r\n            \x3e\r\n              \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\r\n                \x3e\x3ccalcite-icon icon\x3d"layer" scale\x3d"l"\x3e\x3c/calcite-icon\r\n              \x3e\x3c/span\x3e\r\n              \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__title font-size-0 avenir-demi"\x3e\r\n                  ${i18n.itemProperties.viewLayer}\r\n                \x3c/span\x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                  ${i18n.itemProperties.viewLayerDescription}\r\n                \x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/button\x3e\r\n            \x3cbutton\r\n              id\x3d"create-join-view-layer"\r\n              class\x3d"dropdown-link-add-create trailer-half"\r\n              data-type\x3d"features"\r\n              data-method\x3d"join"\r\n              role\x3d"menuitem"\r\n              data-dojo-attach-point\x3d"joinedViewLayer"\r\n            \x3e\r\n              \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\r\n                \x3e\x3ccalcite-icon icon\x3d"merge-on-highway-right" scale\x3d"l"\x3e\x3c/calcite-icon\r\n              \x3e\x3c/span\x3e\r\n              \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__title font-size-0 avenir-demi"\x3e\r\n                  ${i18n.itemProperties.joinLayer}\r\n                \x3c/span\x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                  ${i18n.itemProperties.joinLayerDescription}\r\n                \x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cbutton class\x3d"btn btn-fill btn-clear if-can-appendData trailer-half" data-dojo-attach-point\x3d"append"\x3e\r\n        ${i18n.itemProperties.updateData}\r\n      \x3c/button\x3e\r\n      \x3ca class\x3d"btn btn-fill btn-clear trailer-half" data-dojo-attach-point\x3d"geocodeReview"\x3e\r\n        ${i18n.geocodePanel.geocodePanelTitle}\r\n      \x3c/a\x3e\r\n\r\n      \x3cspan class\x3d"display-block"\x3e\r\n        \x3c!-- Metadata - for a viewer, only show metadata link to view HTML metadata if layer has metadata --\x3e\r\n        \x3cspan class\x3d"if-viewer"\x3e\r\n          \x3ca\r\n            target\x3d"_blank"\r\n            class\x3d"js-metadata-link if-layerMetadata trailer-half btn btn-fill btn-clear text-ellipsis"\r\n          \x3e\r\n            ${i18n.itemProperties.metadataURL}\r\n          \x3c/a\x3e\r\n        \x3c/span\x3e\r\n\r\n        \x3c!-- Metadata - for someone who can update, for a non-hosted layer, only show metadata link to view HTML metadata if layer has metadata --\x3e\r\n        \x3cspan class\x3d"if-can-update if-not-hosted"\x3e\r\n          \x3ca\r\n            target\x3d"_blank"\r\n            class\x3d"js-metadata-link if-no-viewer if-layerMetadata trailer-half btn btn-fill btn-clear text-ellipsis"\r\n            \x3e${i18n.itemProperties.metadataURL}\r\n          \x3c/a\x3e\r\n        \x3c/span\x3e\r\n\r\n        \x3c!-- Metadata - for someone who can update, for a hosted layer, and metadata for the org is enabled, allow opening metadata editor --\x3e\r\n        \x3cdiv class\x3d"if-hosted if-can-update if-metadata-enabled if-no-viewer"\x3e\r\n          \x3cbutton\r\n            data-dojo-attach-point\x3d"metadataEdit"\r\n            class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-can-update if-metadata-enabled"\r\n          \x3e\r\n            ${i18n.itemProperties.metadata}\r\n          \x3c/button\x3e\r\n          \x3cdiv class\x3d"dropdown js-dropdown trailer-half js-metadata-split hide"\x3e\r\n            \x3cdiv class\x3d"flex clearfix"\x3e\r\n              \x3ca\r\n                class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-unified-metadata"\r\n                href\x3d"javascript:;"\r\n              \x3e\r\n                ${i18n.itemProperties.metadata}\r\n              \x3c/a\x3e\r\n              \x3cbutton\r\n                class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle"\r\n                aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n              \x3e\r\n                ${!icons.chevron-down.16}\r\n              \x3c/button\x3e\r\n            \x3c/div\x3e\r\n            \x3cnav class\x3d"dropdown-menu dropdown-menu-constrained dropdown-menu-full dropdown-right"\x3e\r\n              \x3ca role\x3d"menuitem" href\x3d"javascript:;" class\x3d"dropdown-link" data-dojo-attach-point\x3d"metadataEditSplit"\x3e\r\n                ${i18n.itemProperties.metadataClassic}\r\n              \x3c/a\x3e\r\n            \x3c/nav\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Metadata - for someone who can update, layer has metadata, but org has metadata disabled, allow viewing HTML metadata --\x3e\r\n        \x3cspan class\x3d"if-metadata-disabled"\x3e\r\n          \x3cspan class\x3d"if-layerMetadata"\x3e\r\n            \x3ca\r\n              target\x3d"_blank"\r\n              class\x3d"js-metadata-link if-no-viewer if-can-update if-hosted if-layerMetadata trailer-half btn btn-fill btn-clear text-ellipsis"\r\n            \x3e\r\n              ${i18n.itemProperties.metadataURL}\r\n            \x3c/a\x3e\r\n          \x3c/span\x3e\r\n        \x3c/span\x3e\r\n      \x3c/span\x3e\r\n    \x3c/aside\x3e\r\n\r\n    \x3cdiv class\x3d"column-17 post-1 rtl-post-0 trailer-4 tablet-trailer-2"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"subtypes"\x3e\r\n        \x3ch4 class\x3d"leader-2 font-size-1"\x3e${i18n.itemProperties.layers}\x3c/h4\x3e\r\n        \x3cul class\x3d"list-plain" data-dojo-attach-point\x3d"subtypesList"\x3e\x3c/ul\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"position-relative"\x3e\r\n        \x3cdiv class\x3d"js-sublayer-summary-section"\x3e\r\n          \x3ch4 class\x3d"leader-2 font-size-1"\x3e${i18n.itemProperties.summary}\x3c/h4\x3e\r\n          \x3cdiv\r\n            data-dojo-attach-point\x3d"summary"\r\n            class\x3d"js-view description-rich-text break-word overflow-auto padding-trailer-quarter"\r\n          \x3e\x3c/div\x3e\r\n          \x3cp class\x3d"text-darker-gray trailer-0"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"summaryUnavailable"\x3e${i18n.sublayer.summaryUnavailable}\x3c/span\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"summaryAdd" class\x3d"js-inline-edit btn-link text-left"\x3e\r\n              ${i18n.sublayer.addSummary}\r\n            \x3c/button\x3e\r\n          \x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-sublayer-summary-loader loader loader-flex overlay-white fullscreen"\x3e\r\n          \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"loader-text padding-leader-4"\x3e${i18n.itemProperties.updatingItemLabel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"position-relative"\x3e\r\n        \x3cdiv class\x3d"js-sublayer-description-section"\x3e\r\n          \x3ch4 class\x3d"leader-2 font-size-1"\x3e${i18n.itemProperties.description}\x3c/h4\x3e\r\n          \x3cdiv\r\n            data-dojo-attach-point\x3d"description"\r\n            class\x3d"js-view description-rich-text break-word overflow-auto padding-trailer-quarter"\r\n          \x3e\x3c/div\x3e\r\n          \x3cp class\x3d"text-darker-gray trailer-0"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"descriptionUnavailable"\x3e${i18n.sublayer.descriptionUnavailable}\x3c/span\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"descriptionAdd" class\x3d"js-inline-edit btn-link text-left"\x3e\r\n              ${i18n.sublayer.addDescription}\r\n            \x3c/button\x3e\r\n          \x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-sublayer-description-loader loader loader-flex overlay-white fullscreen"\x3e\r\n          \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"loader-text padding-leader-4"\x3e${i18n.itemProperties.updatingItemLabel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"position-relative"\x3e\r\n        \x3cdiv class\x3d"js-sublayer-credits"\x3e\r\n          \x3ch4 class\x3d"leader-2 font-size-1"\x3e${i18n.itemProperties.credits}\x3c/h4\x3e\r\n          \x3cspan class\x3d"text-darker-gray trailer-half"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"creditsUnavailable"\x3e${i18n.itemProperties.creditsUnavailable}\x3c/span\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"creditsAdd" class\x3d"btn-link js-inline-edit text-left"\x3e\r\n              ${i18n.sublayer.source}\r\n            \x3c/button\x3e\r\n          \x3c/span\x3e\r\n          \x3cp data-dojo-attach-point\x3d"credits" class\x3d"js-view"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-sublayer-credits-loader loader loader-flex overlay-white fullscreen"\x3e\r\n          \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"loader-text padding-leader-4"\x3e${i18n.itemProperties.updatingItemLabel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3csection class\x3d"js-details font-size--1 column-6 tablet-column-6 tablet-leader-1 trailer-4"\x3e\r\n      \x3cdiv class\x3d"js-lastUpdatedContainer hide"\x3e\r\n        \x3ch5 class\x3d"trailer-half leader-2 avenir-medium font-size-0"\x3e${i18n.itemLinks.details}\x3c/h5\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 js-dataUpdatedLast hide"\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 js-schemaUpdatedLast hide"\x3e\x3c/p\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3ch5 class\x3d"trailer-half leader-2 tablet-leader-0 avenir-medium font-size-0"\x3e\r\n        ${i18n.itemProperties.url}\r\n        \x3ca data-dojo-attach-point\x3d"viewLink" target\x3d"_blank" class\x3d"font-size--3 link-darker-gray avenir-regular right"\x3e\r\n          ${!icons.inline.launch.16}${i18n.itemProperties.metadataView}\r\n        \x3c/a\x3e\r\n      \x3c/h5\x3e\r\n      \x3cdiv class\x3d"js-sublayer-copy"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"attachments"\x3e\r\n        \x3ch5 class\x3d"trailer-half leader-2 avenir-medium font-size-0"\x3e${i18n.sublayer.attachments}\x3c/h5\x3e\r\n        \x3cdiv class\x3d"js-toggle-attachments"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"timeSettings" class\x3d"if-hosted if-no-location-tracking"\x3e\r\n        \x3ch5 class\x3d"trailer-half leader-2 avenir-medium font-size-0"\x3e${i18n.sublayer.timeSettings}\x3c/h5\x3e\r\n          \x3ccalcite-input data-dojo-attach-point\x3d"timeSettingsStatus" read-only icon\x3d"toggle-off" placeholder\x3d"${i18n.sublayer.disabled}"\x3e\r\n            \x3ccalcite-button id\x3d"sublayer-time-settings-edit" data-dojo-attach-point\x3d"timeSettingsEdit" aria-label\x3d"${i18n.sublayer.editTimeSettings}" icon-start\x3d"pencil" kind\x3d"inverse" appearance\x3d"outline-fill" slot\x3d"action"\x3e\x3c/calcite-button\x3e\r\n          \x3c/calcite-input\x3e\r\n          \x3ccalcite-tooltip reference-element\x3d"sublayer-time-settings-edit" label\x3d"${i18n.common.edit}"\x3e\x3cspan\x3e${i18n.common.edit}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"js-geometryOptionsContainer hide"\x3e\r\n        \x3ch5 class\x3d"trailer-half leader-2 avenir-medium font-size-0"\x3e${i18n.itemLinks.geometryOptions}\x3c/h5\x3e\r\n        \x3ccalcite-label\x3e ${i18n.sublayer.mValue}\r\n          \x3ccalcite-input class\x3d"trailer-0 font-size--1 js-mValuesEnabled hide" placeholder\x3d"${i18n.sublayer.disabled}" read-only icon\x3d"toggle-off"\x3e\x3c/calcite-input\x3e \r\n        \x3c/calcite-label\x3e\r\n        \x3ccalcite-label\x3e ${i18n.sublayer.zValue}\r\n          \x3ccalcite-input class\x3d"trailer-0 font-size--1 js-zValuesEnabled hide" placeholder\x3d"${i18n.sublayer.disabled}" read-only icon\x3d"toggle-off"\x3e\x3c/calcite-input\x3e\r\n        \x3c/calcite-label\x3e \r\n        \x3cdiv class\x3d"js-zDefaultValueEnabled hide"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/section\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"js-sublayer-loader"\x3e\r\n    \x3cdiv class\x3d"loader is-active padding-leader-4 padding-trailer-4"\x3e\r\n      \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"loader-text"\x3e${!i18n.common.loading}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/sublayer/_disableAttachments.html":'\x3cdiv class\x3d"panel panel-white panel-no-border padding-left-2 padding-right-2 padding-leader-2 padding-trailer-2"\x3e\r\n  \x3ch4 class\x3d"font-size-0 avenir-medium"\x3e${i18n.sublayer.disableAttachmentsTitle}\x3c/h4\x3e\r\n  \x3cp class\x3d"font-size--1 trailer-0"\x3e${i18n.sublayer.disableAttachmentsDescription}\x3c/p\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/sharing/dijit/templates/RasterFunctionEditor.html":"\x3cdiv class\x3d\"esriRFxEditorContainer\"\x3e\r\n  \x3cdiv class\x3d'close-btn'\x3e \r\n  \x3csvg xmlns\x3d'http://www.w3.org/2000/svg' width\x3d'15' height\x3d'15' viewBox\x3d'0 0 32 32' class\x3d'svg-icon'\x3e \r\n    \x3cpath d\x3d'M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z'/\x3e \r\n  \x3c/svg\x3e \r\n  \x3c/div\x3e \r\n  \x3cdiv data-dojo-attach-point\x3d'passiveOverlay' class\x3d'passive-overlay'\x3e\x3c/div\x3e \r\n  \x3ciframe data-dojo-attach-point\x3d'_iframe'\x3e \r\n  \x3c/iframe\x3e \r\n\x3c/div\x3e\r\n",
"url:arcgisonline/pages/item/widgets/templates/_comment.html":'\x3cdiv class\x3d"js-comment" data-comment-id\x3d"${comment.id}"\x3e\r\n    \x3cdiv class\x3d"panel panel-white panel-bordered border-bottom-clear flex ${classNames}"\x3e\r\n        \x3cdiv class\x3d"comment-avatar flex-0"\x3e\r\n            \x3cspan class\x3d"js-comment-avatar"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"flex-1 padding-left-1"\x3e\r\n            \x3cp class\x3d"comment-meta font-size--2"\x3e\r\n                \x3cspan\x3e\r\n                    \x3ccalcite-link data-owner\x3d"${comment.owner}" class\x3d"margin-right-half js-comment-profile"\x3e\r\n                        ${commentOwnerProfile.username}\r\n                    \x3c/calcite-link\x3e\r\n                    \x3cspan class\x3d"js-comment-profile if-item-owner label"\x3e${i18n.common.itemOwner}\x3c/span\x3e\r\n                \x3c/span\x3e\r\n                \x3cspan class\x3d"padding-left-half tooltip"\r\n                    aria-label\x3d"${comment.created:_formatDate} ${comment.created:_formatTime}"\x3e${comment.created:_formatCommentDate}\x3c/span\x3e\r\n                \x3c!-- if owner of item or owner of comment, can delete --\x3e\r\n                \x3c!-- anybody can reply, only one level deep --\x3e\r\n                \x3cspan class\x3d"right clearfix"\x3e\r\n                    \x3ccalcite-button appearance\x3d"transparent" scale\x3d"m" data-id\x3d"${comment.id}"\r\n                        aria-describedby\x3d"${comment.id}" data-type\x3d"comment"\r\n                        class\x3d"right if-can-delete-comment js-action-deleteComment" aria-controls\x3d"comments"\x3e\r\n                        ${i18n.common.deleteLabel}\r\n                    \x3c/calcite-button\x3e\r\n                    \x3ccalcite-button appearance\x3d"transparent" scale\x3d"m" data-id\x3d"${comment.id}"\r\n                        aria-describedby\x3d"${comment.id}" class\x3d"right if-signed-in js-action-reply"\x3e\r\n                        ${i18n.common.reply}\r\n                    \x3c/calcite-button\x3e\r\n                \x3c/span\x3e\r\n            \x3c/p\x3e\r\n\r\n            \x3cp id\x3d"${comment.id}" class\x3d"font-size--1 text-off-black trailer-half break-word"\x3e${comment.comment}\x3c/p\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"js-reply-${comment.id} if-signed-in padding-left-4 hide"\x3e\r\n        \x3cdiv class\x3d"panel border-bottom-clear"\x3e\r\n            \x3cdiv class\x3d"flex"\x3e\r\n                \x3cdiv class\x3d"comment-avatar flex-0"\x3e\r\n                    \x3cspan class\x3d"js-portal-user-avatar"\x3e\x3c/span\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"flex-1 padding-left-1"\x3e\r\n                    \x3ctextarea class\x3d"js-disable-addComment js-reply leader-0 trailer-half display-block" rows\x3d"3"\r\n                        placeholder\x3d"${i18n.itemProperties.leaveComment}"\x3e\x3c/textarea\x3e\r\n                    \x3cbutton\r\n                        class\x3d"js-action-cancelReply btn btn-small btn-clear btn-two right"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n                    \x3cbutton data-id\x3d"${comment.id}" data-type\x3d"reply" type\x3d"button"\r\n                        class\x3d"btn btn-small inline-block right js-action-addComment js-disable-addComment"\r\n                        aria-controls\x3d"comments"\x3e\r\n                        ${i18n.itemProperties.comment}\r\n                    \x3c/button\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/item/widgets/templates/_layerActions.html":'\x3ca href\x3d"${url}" class\x3d"side-nav-link layer-card js-sublayer-link" data-id\x3d"${layer.id}"\x3e\r\n  \x3cdiv class\x3d"flex flex-center padding-leader-quarter padding-trailer-quarter no-pointer"\x3e\r\n    \x3carcgis-sublayer-type type\x3d"${layerType}" geometry\x3d"${geometryType}" name\x3d"${layer.name}" scale\x3d"s" class\x3d"flex-1"\x3e\x3c/arcgis-sublayer-type\x3e\r\n    \x3cdiv class\x3d"flex-0"\x3e\r\n      ${icons.chevron-right.16}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/a\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_layerRenameActions.html":'\x3cdiv class\x3d"can-renameLayer panel panel-white panel-bordered panel-compact border-bottom-clear"\x3e\r\n  \x3cdiv class\x3d"js-layer-rename"\x3e\r\n    \x3c!-- Container for title InlineEdit --\x3e\r\n  \x3c/div\x3e  \r\n\x3c/div\x3e\r\n',"url:arcgisonline/pages/item/widgets/templates/_modelCharacteristics.html":'\x3cbutton class\x3d"block trailer-1 thumbnail-link thumbnail-link--mixed-height js-model-characteristic"\x3e\r\n  \x3cimg src\x3d"${url}" class\x3d"js-model-characteristic-img no-pointer"\x3e\r\n  \x3cspan class\x3d"thumbnail-overlay if-defaultOpen"\x3e\r\n    \x3cspan class\x3d"font-size--1 text-center thumbnail-icon"\x3e\r\n      ${icons.inline.magnifying-glass-plus.16} ${i18n.itemProperties.viewImage}\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\x3c/button\x3e',
"url:arcgisonline/pages/item/widgets/templates/_overview.html":'\x3cmain class\x3d"grid-container leader-1 item-pane-container" id\x3d"main-content-area"\x3e\r\n  \x3cdiv class\x3d"hide js-metadata-wrapper"\x3e\r\n    \x3ciframe\r\n      class\x3d"metadata-editor-container js-metadata-iframe hide"\r\n      title\x3d"${i18n.metadataEditor.title}"\r\n    \x3e\x3c/iframe\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-item-pane item-pane item-pane--active"\x3e\r\n    \x3cdiv class\x3d"column-17 post-1 rtl-post-0"\x3e\r\n      \x3ccalcite-notice class\x3d"js-empty-layer-notice trailer-1" closable\x3e\r\n        \x3cdiv slot\x3d"title"\x3e${i18n.itemProperties.emptyLayerTitle}\x3c/div\x3e\r\n        \x3cdiv slot\x3d"message"\x3e${i18n.itemProperties.emptyLayerDescription}\x3c/div\x3e\r\n      \x3c/calcite-notice\x3e\r\n      \x3cdiv class\x3d"column-17 if-can-update trailer-quarter"\x3e\r\n        \x3cbutton\r\n          id\x3d"thumbnail"\r\n          data-action\x3d"thumbnail"\r\n          data-telemetry-action\x3d"thumbnail"\r\n          data-edit-id\x3d"thumbnail"\r\n          class\x3d"js-action-editThumbnail js-telemetry-action js-edit-tags font-size--3 btn-link btn-link-darker-gray inline-block"\r\n        \x3e\r\n          ${icons.inline.edit.16}${i18n.itemProperties.editThumbnail}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"column-17 flex phone-flex-column first-column"\x3e\r\n        \x3cdiv class\x3d"thumbnail-wrap flex-0 padding-right-2 padding-left-0"\x3e\r\n          \x3cdiv class\x3d"flex-center"\x3e\r\n            \x3ca\r\n              data-action\x3d"openDefault"\r\n              href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n              class\x3d"js-action-openDefault thumbnail-link flex-center js-status-disable"\r\n            \x3e\r\n              \x3cspan class\x3d"thumbnail-overlay if-defaultOpen"\x3e\r\n                \x3cspan class\x3d"js-thumbnail-overlay-text font-size--1 text-center thumbnail-icon"\r\n                  \x3e${i18n.common.open}\x3c/span\r\n                \x3e\r\n              \x3c/span\x3e\r\n              \x3cdiv\r\n                class\x3d"js-service-status loader js-sharing-loader overlay-white fullscreen padding-leader-1 padding-trailer-3"\r\n              \x3e\r\n                \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"loader-text"\x3e${i18n.itemProperties.creatingService}\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cimg id\x3d"itemThumbnail" class\x3d"thumbnail-img js-thumbnail" src\x3d"${item.thumbnailUrl}" alt\x3d"" /\x3e\r\n            \x3c/a\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"if-signed-in"\x3e\r\n            \x3cdiv class\x3d"js-favorites-container"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3c!-- Check for ratio to show/hide this in _overview.js --\x3e\r\n          \x3cdiv\x3e\r\n            \x3cbutton\r\n              id\x3d"thumbnailAspectRatioTipButton"\r\n              data-action\x3d"thumbnail"\r\n              class\x3d"js-action-editThumbnail font-size--3 btn-link btn-link-darker-gray inline-block panel panel-white leader-half hide"\r\n            \x3e\r\n              ${icons.inline.lightbulb.24}\x3cbr /\x3e\r\n              \x3cspan id\x3d"thumbnailAspectRatioTip"\x3e ${i18n.itemProperties.thumbnailAspectRatioTip}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"phone-leader-1 ie9-summary-wrap snippet-wrap"\x3e\r\n          \x3cdiv class\x3d"js-snippet-section"\x3e\r\n            \x3c!-- Container for snippet InlineEdit --\x3e\r\n            \x3cp class\x3d"trailer-half break-word"\x3e\r\n              \x3cspan class\x3d"js-view if-snippet break-word"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"if-no-snippet text-darker-gray trailer-half"\x3e\r\n                \x3cspan class\x3d"if-viewer"\x3e${i18n.itemProperties.summaryUnavailable}\x3c/span\x3e\r\n                \x3ca href\x3d"#" class\x3d"js-inline-edit if-can-update" data-edit-id\x3d"snippet"\r\n                  \x3e${i18n.itemProperties.noSummary}\x3c/a\r\n                \x3e\r\n              \x3c/span\x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"js-premiumNode trailer-0 hide"\x3e\x3c/p\x3e\r\n            \x3cp class\x3d"js-collaboratedNode trailer-0 hide"\x3e\x3c/p\x3e\r\n            \x3cp class\x3d"trailer-half font-size--1 js-typeOwner-info"\x3e\r\n              \x3cspan alt\x3d"${item.sourceLabel}" title\x3d"${item.sourceLabel}"\x3e\r\n                \x3cimg\r\n                  class\x3d"icon-inline icon-inline--on-left"\r\n                  src\x3d"${item.svgIconUrl16}"\r\n                  width\x3d"16"\r\n                  height\x3d"16"\r\n                  alt\x3d""\r\n                /\x3e\r\n                \x3cspan\x3e\x26lrm;${displayName}\x3c/span\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"js-by-owner"\x3e${i18n.itemProperties.by}\x3c/span\x3e ${item.ownerText}\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"trailer-half font-size--1 js-nb-version-info flex flex-align-center hide"\x3e\r\n              \x3cspan class\x3d"js-nb-curr-version nb-item-curr-version"\x3e\x3c/span\x3e\r\n              \x3ccalcite-tooltip\r\n                placement\x3d"top"\r\n                class\x3d"calcite-mode-dark"\r\n                label\x3d"${i18n.itemProperties.newRunTime}"\r\n                reference-element\x3d"nb-item-version-info"\r\n              \x3e\r\n                ${i18n.itemProperties.newRunTime}\r\n              \x3c/calcite-tooltip\x3e\r\n              \x3ccalcite-icon\r\n                label\x3d"${i18n.itemProperties.newRunTime}"\r\n                scale\x3d"s"\r\n                class\x3d"margin-left-half js-nb-new-version hide"\r\n                id\x3d"nb-item-version-info"\r\n                icon\x3d"information"\r\n              \x3e\x3c/calcite-icon\x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"font-size--2 trailer-half leader-quarter text-darkest-gray"\x3e\r\n              \x3cspan\r\n                class\x3d"inline-block margin-right-1 margin-left-0"\r\n                title\x3d"${i18n.contentPage.createdLabel} ${item.created:completeDate}"\r\n                \x3e${i18n.contentPage.itemCreated} ${item.created:fullDate}\x3c/span\r\n              \x3e\r\n              \x3cspan\r\n                class\x3d"inline-block margin-right-1 margin-left-0"\r\n                title\x3d"${i18n.itemProperties.lastModified} ${item.modified:completeDate}"\r\n                \x3e${i18n.contentPage.itemModified} ${item.modified:fullDate}\x3c/span\r\n              \x3e\r\n              \x3cspan class\x3d"inline-block margin-right-1 margin-left-0"\r\n                \x3e${item:formatViewsLabel} ${item.numViews:formatNumViews}\x3c/span\r\n              \x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"js-last-snapshot trailer-0 font-size--2 hide"\x3e\r\n              ${i18n.itemProperties.snapshot.last} \x3cspan class\x3d"js-last-snapshot-value"\x3e\x3c/span\x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"flex js-item-badges"\x3e\x3c/p\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3caside class\x3d"column-6 right tablet-column-12 tablet-left trailer-2"\x3e\r\n      \x3cdiv class\x3d"js-actions-container column-6 tablet-column-6 tablet-leader-2 tablet-left"\x3e\r\n        \x3cdiv class\x3d"if-only-map-viewer-modern"\x3e\r\n          \x3ca\r\n            class\x3d"btn btn-fill btn-wrap flex-1 text-center text-ellipsis js-open-mapViewer js-open-btn js-action-newWebMapViewer js-telemetry-primary-action"\r\n            href\x3d"${item.newMapViewerUrl:empty}"\r\n            data-href\x3d"${item.newMapViewerUrl:empty}"\r\n            data-action\x3d"newMapViewer"\r\n            data-telemetry-action\x3d"Open in Map Viewer"\r\n            \x3e${i18n.itemLinks.openMapViewerBetaLabel}\x3c/a\r\n          \x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-multiple-map-viewer"\x3e\r\n          \x3c!-- use item-type classes to show and hide actions --\x3e\r\n          \x3c!-- Primary Item Actions --\x3e\r\n          \x3cdiv class\x3d"if-featureCollection if-vectorTile if-2d if-table"\x3e\r\n            \x3cdiv class\x3d"dropdown js-dropdown trailer-half display-block js-status-disable"\x3e\r\n              \x3cdiv class\x3d"flex clearfix"\x3e\r\n                \x3ca\r\n                  class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-open-mapViewer js-open-btn js-action-newWebMapViewer js-telemetry-primary-action"\r\n                  href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n                  data-href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n                  data-action\x3d"newMapViewer"\r\n                  data-telemetry-action\x3d"Open in Map Viewer"\r\n                  \x3e${item:_formatMapViewerPrimaryLabel}\x3c/a\r\n                \x3e\r\n                \x3cbutton\r\n                  class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle js-map-open-more-dropdown"\r\n                  aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n                \x3e\r\n                  ${icons.chevron-down.16}\r\n                \x3c/button\x3e\r\n              \x3c/div\x3e\r\n              \x3cnav class\x3d"dropdown-menu dropdown-menu-constrained dropdown-menu-full dropdown-right"\x3e\r\n                \x3cdiv class\x3d"if-map-viewer-classic"\x3e\r\n                  \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n                    \x3ca\r\n                      role\x3d"menuitem"\r\n                      href\x3d"${item.newMapViewerUrl:empty}"\r\n                      class\x3d"dropdown-link if-can-openInNewMapViewer js-telemetry-primary-action"\r\n                      data-telemetry-action\x3d"Open in Map Viewer"\r\n                      \x3e${i18n.itemLinks.openMapViewerBetaLabel}\x3c/a\r\n                    \x3e\r\n                  \x3c/div\x3e\r\n                  \x3ca\r\n                    role\x3d"menuitem"\r\n                    href\x3d"${item.mapNewViewerUrl:empty}"\r\n                    data-href\x3d"${item.mapNewViewerUrl:empty}"\r\n                    class\x3d"dropdown-link if-featureCollection if-vectorTile if-2d if-table js-action js-telemetry-primary-action"\r\n                    data-action\x3d"newMapViewer"\r\n                    data-telemetry-action\x3d"Open in Map Viewer"\r\n                    \x3e${i18n.itemLinks.addToNewViewer}\x3c/a\r\n                  \x3e\r\n                  \x3ca\r\n                    role\x3d"menuitem"\r\n                    href\x3d"${item.mapViewerWithEditUrl:empty}"\r\n                    data-href\x3d"${item.mapViewerWithEditUrl:empty}"\r\n                    class\x3d"dropdown-link if-can-edit-service js-action js-telemetry-primary-action"\r\n                    data-action\x3d"newMapViewer"\r\n                    data-telemetry-action\x3d"Open in Map Viewer with Full Editing Capabilities"\r\n                    \x3e${i18n.itemProperties.openViewerFullEditingRole}\x3c/a\r\n                  \x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"if-map-viewer-modern"\x3e\r\n                  \x3cspan class\x3d"if-can-openInNewMapViewer"\x3e\r\n                    \x3ca\r\n                      role\x3d"menuitem"\r\n                      href\x3d"${item.mapViewerUrl:empty}"\r\n                      data-href\x3d"${item.mapViewerUrl:empty}"\r\n                      class\x3d"dropdown-link if-map if-featureCollection if-vectorTile if-2d if-table js-action js-telemetry-primary-action"\r\n                      data-action\x3d"newMapViewer"\r\n                      data-telemetry-action\x3d"Open in Map Viewer"\r\n                      \x3e${i18n.itemLinks.openMapViewer}\x3c/a\r\n                    \x3e\r\n                  \x3c/span\x3e\r\n                  \x3ca\r\n                    role\x3d"menuitem"\r\n                    href\x3d"${item.mapViewerWithEditUrl:empty}"\r\n                    data-href\x3d"${item.mapViewerWithEditUrl:empty}"\r\n                    class\x3d"dropdown-link if-can-edit-service js-action btn-wrap js-telemetry-primary-action"\r\n                    data-telemetry-action\x3d"Open in Map Viewer"\r\n                    \x3e${i18n.itemLinks.openMapViewerWithControl}\x3c/a\r\n                  \x3e\r\n                \x3c/div\x3e\r\n              \x3c/nav\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-route-layer navigator-button-mobile hide js-telemetry-primary-action"\x3e\r\n          \x3ca href\x3d"${item.navigatorUrl}" class\x3d"text-ellipsis trailer-half btn btn-fill btn-wrap"\r\n            \x3e${i18n.itemLinks.openNavigator}\x3c/a\r\n          \x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-map"\x3e\r\n          \x3c!-- Keep single button if map viewer beta disabled --\x3e\r\n          \x3cdiv class\x3d"if-no-map-viewer-beta"\x3e\r\n            \x3ca\r\n              href\x3d"${item.mapViewerUrl}"\r\n              class\x3d"text-ellipsis trailer-half btn btn-fill if-map js-open-mapViewer js-open-btn js-action-newWebMapViewer js-telemetry-primary-action"\r\n              href\x3d"${item.mapViewerUrl}"\r\n              data-href\x3d"${item.mapViewerUrl}"\r\n              data-action\x3d"newMapViewer"\r\n              data-telemetry-action\x3d"Open in Map Viewer"\r\n              \x3e${i18n.itemLinks.openMapViewer}\x3c/a\r\n            \x3e\r\n          \x3c/div\x3e\r\n          \x3c!-- Otherwise, enable dropdown for web maps to load in map viewer or map viewer beta --\x3e\r\n          \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n            \x3cdiv class\x3d"dropdown js-dropdown trailer-half display-block js-status-disable"\x3e\r\n              \x3cdiv class\x3d"flex clearfix"\x3e\r\n                \x3ca\r\n                  class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-open-mapViewer js-open-btn js-action-newWebMapViewer js-telemetry-primary-action"\r\n                  href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n                  data-href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n                  data-action\x3d"newMapViewer"\r\n                  data-telemetry-action\x3d"Open in Map Viewer"\r\n                  \x3e${item:_formatMapViewerPrimaryLabel}\x3c/a\r\n                \x3e\r\n                \x3cbutton\r\n                  class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle"\r\n                  aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n                \x3e\r\n                  ${icons.chevron-down.16}\r\n                \x3c/button\x3e\r\n              \x3c/div\x3e\r\n              \x3cnav class\x3d"dropdown-menu dropdown-menu-full dropdown-right"\x3e\r\n                \x3c!-- \x3ca href\x3d"${item.mapNewViewerUrl}" data-href\x3d"${item.mapNewViewerUrl}" data-action\x3d"newMapViewer" class\x3d"dropdown-link test-ellipsis js-action-newWebMapViewer add-to-new-viewer"\x3e${i18n.itemLinks.addToNewViewer}\x3c/a\x3e --\x3e\r\n                \x3ca href\x3d"${item:_formatMapViewerSecondaryLink}" class\x3d"dropdown-link if-map-viewer-beta"\r\n                  \x3e${item:_formatMapViewerSecondaryLabel}\x3c/a\r\n                \x3e\r\n              \x3c/nav\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3ca\r\n          href\x3d"${item.sceneViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-wrap if-scene if-3d js-open-sceneViewer js-status-disable js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open in Scene Viewer"\r\n          \x3e${i18n.itemLinks.openSceneViewer}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.url:sanitizeUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-app js-open-url js-open-btn js-view-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Application"\r\n          \x3e${i18n.itemLinks.viewApp}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.dataPipelineUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-data-pipeline-and-not-blocked js-data-pipeline js-open-dataPipeline js-open-btn js-telemetry-primary-action"\r\n          target\x3d"_blank"\r\n          data-telemetry-action\x3d"Open Data Pipelines"\r\n          \x3e${i18n.itemLinks.openDataPipelines}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.knowledgeStudioUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-knowledge-studio js-open-btn js-telemetry-primary-action"\r\n          target\x3d"_blank"\r\n          data-telemetry-action\x3d"Open Knowledge Studio"\r\n          \x3e${i18n.itemLinks.openKnowledgeStudio}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.appViewerUrl:sanitizeUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-mobile js-open-url js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Get Application"\r\n          \x3e${i18n.itemLinks.getApp}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.appViewerUrl:sanitizeUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-link js-open-url js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Link"\r\n          \x3e${i18n.itemLinks.open}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.workforceViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-workforceProject-and-not-blocked js-open-workforceViewer js-open-btn js-telemetry-primary-action"\r\n          \x3e${i18n.itemLinks.openWorkforce}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.workflowViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-workflow js-open-workflowViewer js-open-btn js-telemetry-primary-action"\r\n          \x3e${i18n.itemLinks.openWorkflow}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.excaliburViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-excaliburProject js-open-excaliburViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Excalibur"\r\n          \x3e${i18n.itemLinks.openExcalibur}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.excaliburProjectUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-excaliburProject js-open-excaliburViewer js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Excalibur Project"\r\n          \x3e${i18n.itemLinks.viewExcaliburProject}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.excaliburMediaUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-excaliburMedia js-open-excaliburViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Excalibur Media"\r\n          \x3e${i18n.itemLinks.openExcalibur}\x3c/a\r\n        \x3e\r\n        \x3cdiv class\x3d"if-notebookServer-enabled"\x3e\r\n          \x3cdiv class\x3d"if-can-create-notebooks"\x3e\r\n            \x3ca\r\n              href\x3d"${item.notebookViewerUrl}"\r\n              target\x3d"_blank"\r\n              class\x3d"text-ellipsis trailer-half btn btn-fill if-notebook js-open-url js-open-btn js-open-notebook js-telemetry-primary-action"\r\n              data-telemetry-action\x3d"Open Notebook"\r\n              \x3e${i18n.itemLinks.openNotebook}\x3c/a\r\n            \x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-surveyForm-and-not-blocked"\x3e\r\n          \x3cbutton class\x3d"btn btn-fill btn-clear btn-wrap js-dropdown-toggle js-open-btn"\x3e\r\n            ${i18n.itemLinks.openSurvey123}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav class\x3d"dropdown-menu dropdown-menu-full dropdown-right"\x3e\r\n            \x3ca href\x3d"${item.surveyViewerUrl}" class\x3d"dropdown-link js-open-surveyViewer if-online js-telemetry-primary-action"\r\n               data-telemetry-action\x3d"Open Survey (in browser)"\r\n              \x3e${i18n.itemLinks.openSurveyBrowser}\x3c/a\r\n            \x3e\r\n            \x3ca href\x3d"${item.surveyAppUrl}" class\x3d"dropdown-link js-open-surveyViewer js-telemetry-primary-action"\r\n               data-telemetry-action\x3d"Open Survey123"\r\n              \x3e${i18n.itemLinks.openSurveyApp}\x3c/a\r\n            \x3e\r\n            \x3ca href\x3d"${item.surveyManageUrl}" class\x3d"dropdown-link if-can-edit-surveyForm js-open-surveyViewer js-telemetry-primary-action"\r\n               data-telemetry-action\x3d"Manage in Survey123 website"\r\n              \x3e${i18n.itemLinks.manageSurveyApp}\x3c/a\r\n            \x3e\r\n            \x3ca href\x3d"${item.surveyEditUrl}" class\x3d"dropdown-link if-can-edit-surveyForm js-open-surveyViewer js-telemetry-primary-action"\r\n               data-telemetry-action\x3d"Edit in Survey123 Connect"\r\n              \x3e${i18n.itemLinks.editSurveyApp}\x3c/a\r\n            \x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Web Experience Actions --\x3e\r\n        \x3ca\r\n          href\x3d"${item.webExperienceUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-published-webExperience-and-not-blocked js-open-webExperienceViewer js-open-btn js-telemetry-primary-action"\r\n          target\x3d"_blank"\r\n          rel\x3d"noopener noreferrer"\r\n          data-telemetry-action\x3d"View Web Experience"\r\n          \x3e${i18n.itemLinks.view}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.webExperienceEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-edit-webExperience-and-not-blocked js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Edit Web Experience"\r\n          \x3e${i18n.common.edit}\x3c/a\r\n        \x3e\r\n\r\n        \x3c!-- Web Experience Template Actions --\x3e\r\n        \x3ca\r\n          href\x3d"${item.webExperienceUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-published-webExperienceTemplate-and-not-blocked js-open-webExperienceViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Web Experience Template"\r\n          \x3e${i18n.itemLinks.view}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.webExperienceEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-edit-webExperienceTemplate js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Edit Web Experience Template"\r\n          \x3e${i18n.common.edit}\x3c/a\r\n        \x3e\r\n        \x3cspan class\x3d"if-published-webExperienceTemplate-and-not-blocked"\x3e\r\n          \x3ca\r\n            href\x3d"${item.webExperienceCreateUrl}"\r\n            class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-create-webExperienceTemplate if-no-public-user js-open-btn js-telemetry-primary-action"\r\n            data-telemetry-action\x3d"Create Web Experience from Template"\r\n            \x3e${i18n.itemLinks.createWebExperience}\x3c/a\r\n          \x3e\r\n        \x3c/span\x3e\r\n\r\n        \x3ca\r\n          href\x3d"${item.insightsViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-insights-and-not-blocked js-open-insightsViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Insights"\r\n          \x3e${i18n.itemLinks.openInsights}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.urbanViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-urbanModel js-open-urbanViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Urban Model"\r\n          \x3e${i18n.itemLinks.openUrbanModel}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.orthoMakerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-orthoMaker-and-not-blocked js-open-orthoMaker js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open OrthoMaker"\r\n          \x3e${i18n.itemLinks.openOrthoMaker}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.missionViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-mission js-open-missionViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Mission"\r\n          \x3e${i18n.itemLinks.openMission}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.geoAIStudioUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-geoAIStudioProject-and-not-blocked js-open-geoAIStudioUrlViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open GeoAIStudio"\r\n          \x3e${i18n.itemLinks.openGeoAIStudio}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.vrExperienceUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-vrExperience-and-not-blocked js-open-vrExperienceViewer js-hide-portal js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open VR Experience"\r\n          \x3e${i18n.itemLinks.openVRExperience}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.hubInitiativeUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear btn-wrap if-hubInitiative-and-not-blocked js-open-hubInitiative js-status-disable js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Hub Initiative"\r\n          \x3e${i18n.itemLinks.openHubInitiative}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.hubEventUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-hubEvent-and-not-blocked js-open-hubEventViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Hub Event"\r\n          \x3e${i18n.itemLinks.viewInHub}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.hubProjectUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-hubProject-and-not-blocked js-open-hubProject js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Hub Project"\r\n          \x3e${i18n.itemLinks.openHubInitiative}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.hubProjectEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-hubProject-and-not-blocked js-edit-hubProject js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Edit Hub Project"\r\n          \x3e${i18n.itemLinks.editHubProject}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.iotViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-bigDataAnalytic if-realTimeAnalytic js-open-iotViewer js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Analytics IoT"\r\n          \x3e${i18n.itemLinks.openAnalyticsIoT}\x3c/a\r\n        \x3e\r\n        \x3cbutton\r\n          data-action\x3d"download"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-pdf js-action-download js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open PDF"\r\n        \x3e\r\n          ${i18n.itemLinks.open}\r\n        \x3c/button\x3e\r\n        \x3ca\r\n          href\x3d"${item.dashboardUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-wrap if-dashboard-and-not-blocked js-open-dashboard js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Dashboard"\r\n          \x3e${i18n.itemLinks.dashboardView}\x3c/a\r\n        \x3e\r\n        \x3cbutton\r\n          data-action\x3d"registerApp"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-can-register js-action-register-app js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Register Application"\r\n        \x3e\r\n          ${i18n.itemProperties.registerApp}\r\n        \x3c/button\x3e\r\n        \x3ca\r\n          href\x3d"${item.storyMapViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-published-storymap-and-not-blocked js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View StoryMap"\r\n        \x3e\r\n          \x3cspan class\x3d"if-storymap-item"\x3e${i18n.itemLinks.viewStorymap}\x3c/span\x3e\r\n          \x3cspan class\x3d"if-storymap-briefing"\x3e${i18n.itemLinks.viewBriefing}\x3c/span\x3e\r\n          \x3cspan class\x3d"if-storymap-collection"\x3e${i18n.itemLinks.viewStorymapCollection}\x3c/span\x3e\r\n        \x3c/a\x3e\r\n\r\n        \x3cdiv class\x3d"if-geoBIM"\x3e\r\n          \x3ca\r\n            href\x3d"${item.geoBIMUrl}"\r\n            class\x3d"text-ellipsis trailer-half btn btn-fill if-create-geoBIM js-open-btn js-open-geoBIM js-telemetry-primary-action"\r\n            data-telemetry-action\x3d"Open In GeoBIM"\r\n            \x3e${i18n.itemLinks.openGeoBIM}\x3c/a\r\n          \x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Secondary Item Actions --\x3e\r\n        \x3ca\r\n          href\x3d"${item.wabEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-edit-wab-and-not-blocked js-open-wabEdit js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Edit Web AppBuilder Application"\r\n          \x3e${i18n.itemLinks.editApp}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.dashboardEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear btn-wrap if-can-edit-dashboard js-open-dashboard js-edit-dashboard js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Edit Dashboard"\r\n          \x3e${i18n.itemLinks.dashboardEdit}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.sceneViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear btn-wrap if-scene-2 js-open-sceneViewer js-status-disable js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open in Scene Viewer"\r\n          \x3e${i18n.itemLinks.openSceneViewer}\x3c/a\r\n        \x3e\r\n\r\n        \x3ca\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-edit-rfx-editor js-open-rfxEditor js-open-btn js-telemetry-primary-action js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open RFX Editor"\r\n          \x3e${i18n.itemLinks.openRFxEditor}\x3c/a\r\n        \x3e\r\n\r\n        \x3cbutton\r\n          data-action\x3d"openDesktop"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-desktop js-action-open-desktop js-status-disable js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Desktop"\r\n        \x3e\r\n          ${i18n.itemLinks.openDesktop}\r\n        \x3c/button\x3e\r\n        \x3cbutton\r\n          data-action\x3d"openPro"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-pro js-action-open-pro js-status-disable js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Pro"\r\n        \x3e\r\n          ${i18n.itemLinks.openPro}\r\n        \x3c/button\x3e\r\n        \x3ca\r\n          href\x3d"${item.vtseEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear btn-wrap if-can-create-items js-vtse-edit js-open-btn hide js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Vector Tile Style Editor"\r\n          \x3e${i18n.itemLinks.editVTSE}\x3c/a\r\n        \x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-desktopPro btn-fill"\x3e\r\n          \x3cbutton class\x3d"btn btn-fill btn-clear btn-wrap js-dropdown-toggle js-open-btn js-status-disable" tabindex\x3d"0"\x3e\r\n            ${i18n.itemLinks.openDesktop}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"openDesktop" class\x3d"dropdown-menu dropdown-right js-action-open-desktop"\x3e\r\n            \x3cbutton data-type\x3d"arcmap" class\x3d"dropdown-link if-no-tiled-imagery js-telemetry-primary-action" data-telemetry-action\x3d"Open ArcMap"\x3e${i18n.itemLinks.openArcMap}\x3c/button\x3e\r\n            \x3cbutton data-type\x3d"pro" class\x3d"dropdown-link js-telemetry-primary-action" data-telemetry-action\x3d"Open Pro"\x3e${i18n.itemLinks.openPro}\x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3ca\r\n          href\x3d"${item.configureStoryMapUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-editable-storymap-and-not-blocked js-configure-storymap js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Edit Storymap"\r\n        \x3e\r\n          \x3cspan class\x3d"if-storymap-item"\x3e${i18n.itemLinks.editStorymap}\x3c/span\x3e\r\n          \x3cspan class\x3d"if-storymap-briefing"\x3e${i18n.itemLinks.editBriefing}\x3c/span\x3e\r\n          \x3cspan class\x3d"if-storymap-collection"\x3e${i18n.itemLinks.editStorymapCollection}\x3c/span\x3e\r\n        \x3c/a\x3e\r\n\r\n        \x3cbutton\r\n          data-action\x3d"download"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-explorer js-action-download js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Explorer"\r\n        \x3e\r\n          ${i18n.itemLinks.openExplorer}\r\n        \x3c/button\x3e\r\n        \x3cbutton\r\n          data-action\x3d"download"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-file if-download js-action-download js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Download"\r\n        \x3e\r\n          ${i18n.itemLinks.download}\r\n        \x3c/button\x3e\r\n        \x3cbutton\r\n          data-action\x3d"publishService"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-publish if-publish js-action-publish js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Publish Item"\r\n        \x3e\r\n          ${i18n.itemProperties.publishItem}\r\n        \x3c/button\x3e\r\n        \x3c!-- TODO-JOSH9445: Re-enable post 10.7 --\x3e\r\n        \x3c!-- \x3cdiv class\x3d"if-notebookServer-enabled"\x3e\r\n                \x3cspan class\x3d"if-notebook"\x3e\r\n                    \x3cbutton data-action\x3d"publishService" class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-publish-notebooks js-action-publish js-open-btn"\x3e${i18n.itemProperties.publishItem}\x3c/button\x3e\r\n                \x3c/span\x3e\r\n            \x3c/div\x3e --\x3e\r\n        \x3ca\r\n          href\x3d"${item.iotFeedUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-feedLayer js-open-iotFeed js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Open Analytics IoT"\r\n          \x3e${i18n.itemLinks.openAnalyticsIoT}\x3c/a\r\n        \x3e\r\n        \x3cbutton\r\n          id\x3d"create-app-dropdown"\r\n          data-type\x3d"template"\r\n          data-action\x3d"createApp"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-hostedTemplate js-action-createApp js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Create Application"\r\n        \x3e\r\n          ${i18n.itemProperties.create}\r\n        \x3c/button\x3e\r\n        \x3ca href\x3d"${item.fieldMapsUrl}" class\x3d"text-ellipsis trailer-half btn btn-fill if-fieldMaps btn-clear js-telemetry-primary-action" data-telemetry-action\x3d"Open in Field Maps Designer"\r\n          \x3e${i18n.itemLinks.fieldMaps}\x3c/a\r\n        \x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-can-create-app if-licensed phone-hide"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear btn-wrap js-dropdown-toggle js-open-btn"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.items.createApp}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cdiv\r\n            data-action\x3d"createApp"\r\n            class\x3d"dropdown-menu dropdown-menu-add-create__container dropdown-menu-add-create__overview can-createApp js-action-createApp"\r\n            role\x3d"menu"\r\n          \x3e\r\n            \x3cnav class\x3d"dropdown-menu-add-create dropdown-menu-add-create__column"\x3e\r\n              \x3ca\r\n                href\x3d"${item.instantAppsUrl}"\r\n                class\x3d"dropdown-link-add-create trailer-half if-map if-scene js-create-instant-apps js-telemetry-primary-action"\r\n                role\x3d"menuitem"\r\n                target\x3d"_blank"\r\n                data-telemetry-action\x3d"Create Instant App"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.instant}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.instantApps}\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon\r\n                        class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical"\r\n                        icon\x3d"launch"\r\n                        scale\x3d"s"\r\n                        aria-hidden\x3d"true"\r\n                      \x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.instantAppsDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/a\x3e\r\n              \x3ca\r\n                href\x3d"${item.experienceBuilderUrl}"\r\n                data-label\x3d"exb"\r\n                class\x3d"dropdown-link-add-create if-webExperience-enabled-and-not-blocked trailer-half js-telemetry-primary-action"\r\n                role\x3d"menuitem"\r\n                target\x3d"_blank"\r\n                data-telemetry-action\x3d"Create Web Experience"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.experienceBuilder}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    Experience Builder\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon\r\n                        class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical"\r\n                        icon\x3d"launch"\r\n                        scale\x3d"s"\r\n                        aria-hidden\x3d"true"\r\n                      \x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.experienceBuilderDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/a\x3e\r\n              \x3cbutton\r\n                id\x3d"create-storymaps"\r\n                data-type\x3d"storymap"\r\n                class\x3d"dropdown-link-add-create trailer-half if-storymap-not-blocked js-telemetry-primary-action"\r\n                role\x3d"menuitem"\r\n                data-telemetry-action\x3d"Create Storymap"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.storyMaps}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.storyMap}\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon\r\n                        class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical"\r\n                        icon\x3d"launch"\r\n                        scale\x3d"s"\r\n                        aria-hidden\x3d"true"\r\n                      \x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.storyMapDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/button\x3e\r\n              \x3ca\r\n                class\x3d"dropdown-link-add-create if-createDashboardFromItem-and-not-blocked trailer-half js-telemetry-primary-action"\r\n                href\x3d"${item.createDashboardUrl}"\r\n                target\x3d"_blank"\r\n                data-telemetry-action\x3d"Create Dashboard"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.dashboard}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.dashboard}\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon\r\n                        class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical"\r\n                        icon\x3d"launch"\r\n                        scale\x3d"s"\r\n                        aria-hidden\x3d"true"\r\n                      \x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.dashboardDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/a\x3e\r\n              \x3cbutton\r\n                id\x3d"create-wab"\r\n                data-type\x3d"wab"\r\n                class\x3d"dropdown-link-add-create if-wab-enabled-and-not-blocked trailer-half js-telemetry-primary-action"\r\n                role\x3d"menuitem"\r\n                data-telemetry-action\x3d"Create Web AppBuilder"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.webAppBuilder}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.webAppBuilder}\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon\r\n                        class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical"\r\n                        icon\x3d"arrowRight"\r\n                        scale\x3d"s"\r\n                        aria-hidden\x3d"true"\r\n                        flip-rtl\r\n                      \x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.webAppBuilderDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/button\x3e\r\n              \x3cbutton\r\n                id\x3d"create-template"\r\n                data-type\x3d"template"\r\n                class\x3d"dropdown-link-add-create trailer-half js-telemetry-primary-action"\r\n                role\x3d"menuitem"\r\n                data-telemetry-action\x3d"Create Configurable App"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.online}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.configurableApp}\x3ccalcite-icon\r\n                      class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical"\r\n                      icon\x3d"arrowRight"\r\n                      scale\x3d"m"\r\n                      aria-hidden\x3d"true"\r\n                      flip-rtl\r\n                    \x3e\x3c/calcite-icon\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.configurableAppDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/button\x3e\r\n            \x3c/nav\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-can-update"\x3e\r\n          \x3ca\r\n            href\x3d"${item.configureUrl}"\r\n            class\x3d"js-if-not-readonly text-ellipsis trailer-half btn btn-fill btn-clear if-can-configure js-action-configure js-open-btn js-configure-btn js-telemetry-primary-action"\r\n            data-telemetry-action\x3d"Configure App"\r\n            \x3e${i18n.itemProperties.configureApp}\x3c/a\r\n          \x3e\r\n        \x3c/div\x3e\r\n        \x3ca\r\n          href\x3d"${item.viewStyleUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-vectorTile if-viewStyle js-open-viewStyle js-open-btn js-status-disable js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Style"\r\n          \x3e${i18n.itemLinks.viewStyle}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.downloadStyleUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-resources js-open-downloadStyle js-open-btn js-status-disable js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Download Style"\r\n          \x3e${i18n.itemLinks.downloadStyle}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.downloadAttachmentUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-codeAttachment js-open-downloadAttachment js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Download Code Attachment"\r\n          \x3e${i18n.itemLinks.download}\x3c/a\r\n        \x3e\r\n        \x3cdiv\r\n          class\x3d"dropdown js-dropdown js-publish-dropdown trailer-half if-not-velocity if-can-publish-tiles if-can-publish-vectorTiles if-can-publish-wfs if-can-publish-ogcfeatures if-can-publish-scenes js-status-disable"\r\n        \x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.publishItem}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"publishTiles" class\x3d"dropdown-menu dropdown-right can-publish-tiles js-action-publish"\x3e\r\n            \x3cbutton data-type\x3d"tiles" class\x3d"dropdown-link if-can-publish-tiles if-no-spatiotemporal js-telemetry-primary-action" data-telemetry-action\x3d"Publish Tile Layer"\x3e\r\n              ${i18n.itemProperties.publishTileLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"vectorTiles" class\x3d"dropdown-link if-can-publish-vectorTiles if-no-spatiotemporal js-telemetry-primary-action" data-telemetry-action\x3d"Publish Vector Tile Layer"\x3e\r\n              ${i18n.itemProperties.publishVectorTileLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"wfs" class\x3d"dropdown-link if-can-publish-wfs if-no-spatiotemporal js-telemetry-primary-action" data-telemetry-action\x3d"Publish WFS Layer"\x3e\r\n              ${i18n.itemProperties.publishWFSLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"ogcfeatures" class\x3d"dropdown-link if-can-publish-ogcfeatures if-no-spatiotemporal js-telemetry-primary-action" data-telemetry-action\x3d"Publish OGC Layer"\x3e\r\n              ${i18n.itemProperties.publishOGCFeatureLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"scenes" class\x3d"dropdown-link if-can-publish-scenes js-telemetry-primary-action" data-telemetry-action\x3d"Publish Scene Layer"\x3e\r\n              ${i18n.itemProperties.publishSceneLayer}\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-can-publish-imagery-tiles if-can-publish-imagery-dynamic"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.publishItem}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"publishImagery" class\x3d"dropdown-menu dropdown-right js-action-publish"\x3e\r\n            \x3cbutton data-type\x3d"tiledImagery" class\x3d"dropdown-link if-can-publish-imagery-tiles js-telemetry-primary-action" data-telemetry-action\x3d"Publish Tiled Imagery"\x3e\r\n              ${i18n.addLayerFromUrlDlg.tiledImagery}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"dynamicImagery" class\x3d"dropdown-link if-can-publish-imagery-dynamic js-telemetry-primary-action" data-telemetry-action\x3d"Publish Dynamic Imagery"\x3e\r\n              ${i18n.addLayerFromUrlDlg.dynamicImageryFull}\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n        \x3cbutton\r\n          data-action\x3d"publishTiles"\r\n          data-type\x3d"features"\r\n          class\x3d"js-create-view-button trailer-half btn btn-fill btn-wrap text-ellipsis btn-clear if-can-publish-views if-not-velocity if-spatiotemporal js-status-disable hide js-open js-action-publish js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Publish View Layer"\r\n        \x3e\r\n          ${i18n.itemProperties.publishViewLayer}\r\n        \x3c/button\x3e\r\n        \x3cdiv class\x3d"js-create-view-dropdown dropdown js-dropdown trailer-half if-can-publish-views if-not-velocity js-status-disable phone-hide"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear btn-wrap js-dropdown-toggle js-open-btn"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.publishViewLayer}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cdiv\r\n            class\x3d"dropdown-menu dropdown-menu-add-create__container dropdown-menu-add-create__overview"\r\n            role\x3d"menu"\r\n          \x3e\r\n            \x3cnav class\x3d"dropdown-menu-add-create dropdown-menu-add-create__column"\x3e\r\n              \x3cp class\x3d"trailer-half"\x3e${i18n.itemProperties.chooseViewMethod}\x3c/p\x3e\r\n              \x3cbutton\r\n                id\x3d"create-view-layer"\r\n                class\x3d"dropdown-link-add-create trailer-half js-action-view-layer js-telemetry-primary-action"\r\n                data-action\x3d"publishTiles"\r\n                data-type\x3d"features"\r\n                data-method\x3d"create"\r\n                role\x3d"menuitem"\r\n                data-telemetry-action\x3d"Publish View Layer"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e\x3ccalcite-icon icon\x3d"layer" scale\x3d"l"\x3e\x3c/calcite-icon\x3e\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0 avenir-demi"\x3e\r\n                    ${i18n.itemProperties.viewLayer}\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.itemProperties.viewLayerDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/button\x3e\r\n              \x3cbutton\r\n                id\x3d"create-join-view-layer"\r\n                class\x3d"dropdown-link-add-create trailer-half js-action-join-view js-telemetry-primary-action"\r\n                data-action\x3d"publishTiles"\r\n                data-type\x3d"features"\r\n                data-method\x3d"join"\r\n                role\x3d"menuitem"\r\n                data-telemetry-action\x3d"Publish Joined View Layer"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e\x3ccalcite-icon icon\x3d"joined-view-layer" scale\x3d"l"\x3e\x3c/calcite-icon\x3e\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0 avenir-demi"\x3e\r\n                    ${i18n.itemProperties.joinLayer}\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.itemProperties.joinLayerDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/button\x3e\r\n              \x3ccalcite-notice icon\x3d"information" class\x3d"js-no-join-view-notice"\x3e\r\n                \x3cdiv slot\x3d"message"\x3e${i18n.itemProperties.noJoinedViewWithOwnership}\x3c/div\x3e\r\n                \x3ccalcite-link slot\x3d"link" target\x3d"_blank" class\x3d"js-no-joined-link"\x3e${i18n.itemProperties.learnMore}\x3c/calcite-link\x3e\r\n              \x3c/calcite-notice\x3e\r\n            \x3c/nav\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-not-velocity if-can-export if-no-spatiotemporal js-status-disable"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.exportLabel}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"exportData" class\x3d"dropdown-menu dropdown-right can-export js-action-exportData"\x3e\r\n            \x3cbutton data-type\x3d"Shapefile" class\x3d"dropdown-link if-no-multipatch js-telemetry-primary-action" data-telemetry-action\x3d"Export Shapefile"\x3e\r\n              ${i18n.itemProperties.exportToShapefile}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"CSV" class\x3d"dropdown-link if-no-multipatch js-telemetry-primary-action" data-telemetry-action\x3d"Export CSV"\x3e\r\n              ${i18n.itemProperties.exportToCSVFile}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"KML" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking js-telemetry-primary-action" data-telemetry-action\x3d"Export KML"\x3e\r\n              ${i18n.itemProperties.exportToKML}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"Excel" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking js-telemetry-primary-action" data-telemetry-action\x3d"Export Excel"\x3e\r\n              ${i18n.itemProperties.exportToExcel}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"File Geodatabase" class\x3d"dropdown-link if-no-location-tracking js-telemetry-primary-action" data-telemetry-action\x3d"Export FGDB"\x3e\r\n              ${i18n.itemProperties.exportToFgdb}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"GeoJson" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking js-telemetry-primary-action" data-telemetry-action\x3d"Export GeoJSON"\x3e\r\n              ${i18n.itemProperties.exportToGeoJson}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"Feature Collection" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking js-telemetry-primary-action" data-telemetry-action\x3d"Export Feature Collection"\x3e\r\n              ${i18n.itemProperties.exportToFeatureCollection}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"GeoPackage" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking js-telemetry-primary-action" data-telemetry-action\x3d"Export GeoPackage"\x3e\r\n              ${i18n.itemProperties.exportToGeoPackage}\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-can-export-imagery"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.exportLabel}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav\r\n            data-action\x3d"exportImagery"\r\n            class\x3d"dropdown-menu dropdown-right can-export-imagery js-action-exportImagery"\r\n          \x3e\r\n            \x3cbutton data-type\x3d"Tile Package" class\x3d"dropdown-link js-telemetry-primary-action" data-telemetry-action\x3d"Export Imagery"\x3e${i18n.itemProperties.exportToTilePackage}\x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cbutton\r\n          data-action\x3d"updateData"\r\n          class\x3d"trailer-half btn btn-fill if-update text-ellipsis btn-clear js-status-disable js-action-updateData js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Update Data"\r\n        \x3e\r\n          ${i18n.itemProperties.updateData}\r\n        \x3c/button\x3e\r\n\r\n\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-overwrite if-overwriteCloud if-can-appendData "\x3e\r\n          \x3cbutton\r\n            data-action\x3d"appendData"\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis can-export js-status-disable js-action-updateData js-telemetry-primary-action"\r\n            tabindex\x3d"0"\r\n            data-telemetry-action\x3d"Update Data"\r\n          \x3e\r\n            ${i18n.itemProperties.updateData}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cbutton\r\n          data-action\x3d"refreshSnapshot"\r\n          class\x3d"trailer-half btn btn-fill if-uses-snapshot text-ellipsis btn-clear js-action-refreshSnapshot js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Refresh Snapshot"\r\n        \x3e\r\n          ${i18n.itemProperties.snapshot.refresh}\r\n        \x3c/button\x3e\r\n\r\n        \x3cdiv class\x3d"if-published-storymap-theme"\x3e\r\n          \x3cdiv class\x3d"dropdown js-dropdown trailer-half display-block"\x3e\r\n            \x3cdiv class\x3d"flex clearfix"\x3e\r\n              \x3ca\r\n                class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-open-btn js-telemetry-primary-action"\r\n                href\x3d"${item.newStoryMapFromThemeUrl}"\r\n                data-telemetry-action\x3d"New Storymap from Theme"\r\n              \x3e\r\n                ${i18n.itemLinks.newStoryFromTheme}\r\n              \x3c/a\x3e\r\n              \x3cbutton\r\n                class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle"\r\n                aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n              \x3e\r\n                ${icons.chevron-down.16}\r\n              \x3c/button\x3e\r\n            \x3c/div\x3e\r\n            \x3cnav class\x3d"dropdown-menu dropdown-menu-constrained dropdown-menu-full dropdown-right"\x3e\r\n              \x3ca role\x3d"menuitem" href\x3d"${item.newStoryMapCollectionFromThemeUrl}" class\x3d"dropdown-link js-telemetry-primary-action" data-telemetry-action\x3d"New Storymap Collection from Theme"\x3e\r\n                ${i18n.itemLinks.newCollectionFromTheme}\r\n              \x3c/a\x3e\r\n            \x3c/nav\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-not-from-collaboration"\x3e\r\n          \x3ca\r\n            href\x3d"${item.configureStoryMapThemeUrl}"\r\n            class\x3d"text-ellipsis trailer-half btn btn-clear btn-fill js-open-btn if-editable-storymap-theme js-telemetry-primary-action"\r\n            data-telemetry-action\x3d"Edit Storymap Theme"\r\n          \x3e\r\n            ${i18n.itemLinks.editStorymapTheme}\r\n          \x3c/a\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Constant Item Actions --\x3e\r\n        \x3c!--\x3cbutton data-action\x3d"downloadImage" class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-downloadImage js-action-downloadImage js-open-btn"\x3e${i18n.downloadImageDlg.title}\x3c/button\x3e--\x3e\r\n        \x3cbutton\r\n          data-action\x3d"share"\r\n          class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-can-share js-action-share js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"Share"\r\n        \x3e\r\n          ${i18n.common.share}\r\n        \x3c/button\x3e\r\n\r\n        \x3c!-- Replace Vector Tile Layer Action --\x3e\r\n        \x3cdiv class\x3d"if-replaceLayer-enabled"\x3e\r\n          \x3cdiv class\x3d"if-can-update"\x3e\r\n            \x3cbutton\r\n              data-action\x3d"replaceLayer"\r\n              class\x3d"if-vectorTile if-tiled-imagery if-tile if-scene-2 trailer-half btn btn-fill btn-clear text-ellipsis js-action-replaceLayer js-open-btn js-status-disable js-telemetry-primary-action"\r\n              data-telemetry-action\x3d"Replace Vector Tile Layer"\r\n            \x3e\r\n              ${i18n.itemLinks.replaceLayer}\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Replace Scene Layer Action --\x3e\r\n        \x3cdiv class\x3d"if-replaceLayer-enabled"\x3e\r\n          \x3cdiv class\x3d"if-can-update"\x3e\r\n            \x3cbutton\r\n              data-action\x3d"replaceSceneLayer"\r\n              class\x3d"if-3d if-scene if-scene-2 trailer-half btn btn-fill btn-clear text-ellipsis js-action-replaceSceneLayer js-open-btn js-status-disable js-telemetry-primary-action"\r\n              data-telemetry-action\x3d"Replace Scene Layer"\r\n            \x3e\r\n              ${i18n.itemLinks.replaceLayer}\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Metadata Actions --\x3e\r\n        \x3c!-- if item has metadata for viewer --\x3e\r\n        \x3cbutton\r\n          data-action\x3d"viewMetadata"\r\n          class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-viewer if-metadata js-action-viewMetadata js-open-btn js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Metadata"\r\n        \x3e\r\n          ${i18n.itemProperties.metadata}\r\n        \x3c/button\x3e\r\n\r\n        \x3c!-- if item has metadata for non-viewer --\x3e\r\n        \x3cbutton\r\n          data-action\x3d"viewMetadata"\r\n          class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-no-viewer if-metadata-disabled if-metadata js-action-viewMetadata js-telemetry-primary-action"\r\n          data-telemetry-action\x3d"View Metadata"\r\n        \x3e\r\n          ${i18n.itemProperties.metadata}\r\n        \x3c/button\x3e\r\n\r\n        \x3c!-- if metadata enabled, and the user can update --\x3e\r\n        \x3cdiv class\x3d"if-can-update if-metadata-enabled if-no-viewer"\x3e\r\n          \x3cbutton\r\n            data-action\x3d"editMetadata"\r\n            class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-can-update if-metadata-enabled if-no-viewer js-action-editMetadata js-telemetry-primary-action"\r\n            data-telemetry-action\x3d"Edit Metadata"\r\n          \x3e\r\n            ${i18n.itemProperties.metadata}\r\n          \x3c/button\x3e\r\n          \x3cdiv class\x3d"dropdown js-dropdown trailer-half js-metadata-split hide"\x3e\r\n            \x3cdiv class\x3d"flex clearfix"\x3e\r\n              \x3ca\r\n                class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-unified-metadata js-telemetry-primary-action"\r\n                href\x3d"javascript:;"\r\n                data-telemetry-action\x3d"Open Metadata Editor"\r\n              \x3e\r\n                ${i18n.itemProperties.metadata}\r\n              \x3c/a\x3e\r\n              \x3cbutton\r\n                class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle"\r\n                aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n              \x3e\r\n                ${icons.chevron-down.16}\r\n              \x3c/button\x3e\r\n            \x3c/div\x3e\r\n            \x3cnav\r\n              class\x3d"dropdown-menu dropdown-menu-constrained dropdown-menu-full dropdown-right"\r\n            \x3e\r\n              \x3ca\r\n                role\x3d"menuitem"\r\n                href\x3d"javascript:;"\r\n                class\x3d"dropdown-link js-action-editMetadata js-telemetry-primary-action"\r\n                data-action\x3d"editMetadata"\r\n                data-telemetry-action\x3d"Open Metadata Editor Classic"\r\n              \x3e\r\n                ${i18n.itemProperties.metadataClassic}\r\n              \x3c/a\x3e\r\n            \x3c/nav\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/aside\x3e\r\n\r\n    \x3cdiv class\x3d"column-17 leader-1 trailer-2 post-1 rtl-post-0"\x3e\r\n      \x3cdiv class\x3d"js-description-section"\x3e\r\n        \x3c!-- Container for Description InlineEdit --\x3e\r\n        \x3ch4 class\x3d"leader-quarter"\x3e${i18n.itemProperties.description}\x3c/h4\x3e\r\n        \x3c!-- Overflow is for https://devtopia.esri.com/WebGIS/arcgis-portal-app/issues/9095\r\n          padding bottom is a hacky workaround for the scrollbar caused by overflow\r\n        --\x3e\r\n        \x3cdiv\r\n          class\x3d"js-view if-description description-rich-text break-word overflow-auto padding-trailer-quarter"\r\n        \x3e\x3c/div\x3e\r\n        \x3cp class\x3d"if-no-description text-darker-gray"\x3e\r\n          \x3cspan class\x3d"if-viewer"\x3e${i18n.itemProperties.descriptionUnavailable}\x3c/span\x3e\r\n          \x3cbutton class\x3d"js-inline-edit btn-link if-can-update text-left" data-edit-id\x3d"description"\x3e\r\n            ${i18n.itemProperties.noDescription}\r\n          \x3c/button\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"js-credentials trailer-2"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"related-items-section"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv\r\n        data-telemetry-action\x3d"sublayer"\r\n        class\x3d"js-telemetry-action js-serviceLayers if-featureLayers if-operationalLayers if-baseMapLayers if-elevationLayers if-tools trailer-2"\r\n      \x3e\r\n        \x3cdiv class\x3d"if-featureLayers if-operationalLayers trailer-2"\x3e\r\n          \x3ch4\x3e${i18n.itemProperties.mapLayers}\x3c/h4\x3e\r\n\r\n          \x3cdiv class\x3d"js-layers js-layerNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-elevationLayers trailer-2"\x3e\r\n          \x3cdiv class\x3d"layer trailer-half"\x3e${i18n.itemProperties.groundLayers}\x3c/div\x3e\r\n          \x3cdiv class\x3d"js-elevationLayers js-layerNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-tools trailer-2"\x3e\r\n          \x3ch4 class\x3d"layer trailer-half"\x3e${i18n.itemProperties.toolLayers}\x3c/h4\x3e\r\n          \x3cdiv class\x3d"js-tools"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"js-serviceTables if-tables trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.mapTables}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-tables js-layerNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-baseMapLayers trailer-2"\x3e\r\n        \x3c!-- TODO: Create basemap string for itemProperties after string freeze --\x3e\r\n        \x3ch4\x3e${i18n.viewer.basemapBtn}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-baseMapLayers js-layerNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-projectContent trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.projectContents}\x3c/h4\x3e\r\n        \x3ctable class\x3d"table table-striped"\x3e\r\n          \x3ctbody class\x3d"js-projectContent"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-solutionContent trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.solutionContents}\x3c/h4\x3e\r\n        \x3ctable class\x3d"table table-striped"\x3e\r\n          \x3ctbody class\x3d"js-solutionContent"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-workflowContent trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.workflowContents}\x3c/h4\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody class\x3d"js-workflowContent"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-formContent trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.mapLayers}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-formContent"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-screenshots"\x3e\r\n        \x3ch4 class\x3d"leader-2 js-screenshots-title"\x3e${i18n.itemProperties.screenshots}\x3c/h4\x3e\r\n        \x3cdiv\r\n          class\x3d"block-group block-group-3-up tablet-block-group-2-up phone-block-group-1-up js-screenshotGroup"\r\n        \x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"js-licenseInfo-section"\x3e\r\n        \x3c!-- Container for Terms of Use InlineEdit --\x3e\r\n        \x3ch4 class\x3d"leader-2"\x3e${i18n.itemProperties.access}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-view if-licenseInfo break-word overflow-auto padding-trailer-quarter"\x3e\x3c/div\x3e\r\n        \x3cp class\x3d"if-no-licenseInfo text-darker-gray"\x3e\r\n          \x3cspan class\x3d"if-viewer"\x3e${i18n.itemProperties.attributionUnavailable}\x3c/span\x3e\r\n          \x3cbutton class\x3d"btn-link js-inline-edit if-can-update text-left" data-edit-id\x3d"licenseInfo"\x3e\r\n            ${i18n.itemProperties.noAttribution}\r\n          \x3c/button\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"js-comments if-commentsEnabled trailer-half"\x3e\r\n        \x3ch4 class\x3d"leader-2"\x3e\r\n          ${i18n.itemProperties.comments}\r\n          \x3cspan class\x3d"js-numComments font-size--2"\x3e(${item.numComments:_formatCount})\x3c/span\x3e\r\n          \x3cspan class\x3d"inline-block padding-left-2"\x3e\r\n            \x3ca\r\n              target\x3d"_blank"\r\n              href\x3d"${item.commentsRssUrl}"\r\n              class\x3d"if-public icon-social-rss icon-social-small js-open-rss"\r\n              aria-label\x3d"${i18n.itemProperties.rssFeed}"\r\n            \x3e\x3c/a\x3e\r\n          \x3c/span\x3e\r\n\r\n          \x3clabel class\x3d"font-size--3 padding-left-1 right if-numComments"\x3e\r\n            ${i18n.gallery.sortBy}\r\n            \x3cselect class\x3d"margin-left-1 inline-block js-sort-comments leader-0" aria-controls\x3d"comments"\x3e\r\n              \x3coption value\x3d"created" selected\x3e${i18n.common.newLabel}\x3c/option\x3e\r\n              \x3coption value\x3d"latest_reply"\x3e${i18n.common.latestReply}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/label\x3e\r\n        \x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-commentbox if-signed-in"\x3e\r\n          \x3cdiv class\x3d"panel border-bottom-clear"\x3e\r\n            \x3clabel class\x3d"trailer-half font-size-0" for\x3d"addComment"\x3e${i18n.itemProperties.leaveComment}\x3c/label\x3e\r\n            \x3cdiv class\x3d"flex"\x3e\r\n              \x3cdiv class\x3d"comment-avatar flex-0"\x3e\r\n                \x3cspan class\x3d"js-portal-user-top-level-avatar"\x3e\x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"flex-1 padding-left-1"\x3e\r\n                \x3ctextarea\r\n                  class\x3d"js-disable-addComment leader-0 trailer-half display-block"\r\n                  id\x3d"addComment"\r\n                  rows\x3d"3"\r\n                  placeholder\x3d"${i18n.itemProperties.leaveComment}"\r\n                \x3e\x3c/textarea\x3e\r\n                \x3cbutton\r\n                  data-id\x3d"${comment.id}"\r\n                  data-type\x3d"comment"\r\n                  type\x3d"button"\r\n                  class\x3d"btn btn-small inline-block right js-action-addComment js-disable-addComment"\r\n                  aria-controls\x3d"comments"\r\n                \x3e\r\n                  ${i18n.itemProperties.comment}\r\n                \x3c/button\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-signed-out"\x3e\r\n          \x3cdiv class\x3d"panel border-bottom-clear"\x3e\r\n            \x3ca href\x3d"signin.html?returnUrl\x3d${currentHref}"\x3e${i18n.common.signIn}\x3c/a\x3e\r\n            ${i18n.itemProperties.toAddNewComment}\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"hide" id\x3d"comments" role\x3d"region" aria-live\x3d"polite"\x3e\x3c/div\x3e\r\n        \x3cbutton class\x3d"js-loadMore-comments hide btn btn-clear btn-fill leader-half" aria-controls\x3d"comments"\x3e\r\n          ${i18n.itemProperties.loadMore}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"column-6 leader-1 trailer-2"\x3e\r\n      \x3c!-- closed view --\x3e\r\n      \x3csection\r\n        class\x3d"font-size--1 column-6 tablet-column-6 if-scoreCompleteness if-can-update js-scoreCompletenessClosed"\r\n      \x3e\r\n        \x3ch5 class\x3d"trailer-half"\x3e\r\n          ${i18n.itemCompleteness.itemDetails}\r\n          \x3cbutton class\x3d"btn-link btn-link-darker-gray font-size--3 right js-show-itemCompleteness js-telemetry-action" data-telemetry-action\x3d"learn more" aria-controls\x3d"item-score-completeness" aria-label\x3d"${i18n.itemCompleteness.learnMore}" aria-expanded\x3d"false"\x3e\r\n            ${icons.inline.question.16}${i18n.addItemFrm.learnMore}\r\n          \x3c/button\x3e\r\n        \x3c/h5\x3e\r\n        \x3cdiv class\x3d"progress-bar" role\x3d"progressbar" aria-valuenow\x3d"${item.scoreCompleteness}" aria-valuemin\x3d"0" aria-valuemax\x3d"100" aria-label\x3d"${i18n.itemCompleteness.itemCompleteness}"\x3e\r\n          \x3cdiv class\x3d"progress-bar-fill js-item-scoreCompleteness-bar" style\x3d"width: ${item.scoreCompleteness}%"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cp class\x3d"font-size--3 leading-quarter trailer-half clearfix"\x3e\r\n          \x3cspan class\x3d"left"\x3e${i18n.common.lowLbl}\x3c/span\x3e\x3cspan class\x3d"right"\x3e${i18n.common.highLbl}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cp\r\n          class\x3d"font-size--2 text-darker-gray padding-left-quarter trailer-0 text-center hide js-itemCompleteness-top"\r\n        \x3e\x3c/p\x3e\r\n        \x3cp class\x3d"font-size--3 trailer-half js-itemCompleteness-wellDone hide"\x3e\r\n          ${item.scoreCompleteness:_formatWellDone}\r\n        \x3c/p\x3e\r\n      \x3c/section\x3e\r\n\r\n      \x3c!-- open view --\x3e\r\n      \x3csection\r\n        class\x3d"font-size--1 leader-1 column-6 tablet-column-6 tablet-leader-1 if-scoreCompleteness if-can-update hide js-scoreCompletenessOpen"\r\n        id\x3d"item-score-completeness"\r\n      \x3e\r\n        \x3ch5 class\x3d"padding-leader-half trailer-half"\x3e\r\n          ${i18n.itemCompleteness.itemDetails}\r\n          \x3cbutton class\x3d"btn-link btn-link-darker-gray font-size--3 right js-hide-itemCompleteness" aria-label\x3d"${i18n.itemCompleteness.learnMore}" aria-controls\x3d"item-score-completeness" aria-expanded\x3d"true"\x3e\r\n            ${icons.inline.x.16}${i18n.common.hideLbl}\r\n          \x3c/button\x3e\r\n        \x3c/h5\x3e\r\n        \x3cspan class\x3d"progress-bar-label text-green"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"progress-bar" role\x3d"progressbar" aria-valuenow\x3d"${item.scoreCompleteness}" aria-valuemin\x3d"0" aria-valuemax\x3d"100" aria-label\x3d"${i18n.itemCompleteness.itemCompleteness}"\x3e\r\n          \x3cdiv class\x3d"progress-bar-fill js-item-scoreCompleteness-bar" style\x3d"width: ${item.scoreCompleteness}%"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cp class\x3d"font-size--3 leading-quarter trailer-half clearfix"\x3e\r\n          \x3cspan class\x3d"left"\x3e${i18n.common.lowLbl}\x3c/span\x3e\x3cspan class\x3d"right"\x3e${i18n.common.highLbl}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"font-size--3 inline-block trailer-half"\x3e${i18n.itemCompleteness.itemCompletenessTip}\x3c/p\x3e\r\n        \x3cul class\x3d"list-plain font-size--3 leader-0 trailer-half js-itemCompleteness-list"\x3e\x3c/ul\x3e\r\n        \x3cp class\x3d"font-size--3 trailer-half js-itemCompleteness-wellDone hide"\x3e\r\n          ${item.scoreCompleteness:_formatWellDone}\r\n        \x3c/p\x3e\r\n      \x3c/section\x3e\r\n\r\n      \x3csection class\x3d"js-details font-size--1 padding-trailer-2 column-6 tablet-column-6 tablet-leader-1"\x3e\r\n        \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e${i18n.itemLinks.details}\x3c/h5\x3e\r\n        \x3cdiv class\x3d"if-urbanModel"\x3e\r\n          \x3cp class\x3d"hide js-urban-database trailer-0"\x3e\x3c/p\x3e\r\n          \x3cp class\x3d"hide js-urban-view"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cp class\x3d"if-dashboard trailer-0 font-size--1"\x3e\r\n          ${i18n.itemProperties.dashboardViews} \x3cspan\x3e${item:_formatDashboardViews}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"if-serviceLink trailer-0 font-size--1"\x3e\r\n          ${i18n.itemProperties.source} \x3cspan class\x3d"js-service-link"\x3e${item:_formatServiceLink}\x3c/span\x3e\r\n          \x3cspan class\x3d"js-image-service-source-collection hide"\x3e${i18n.itemProperties.imageCollection}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"js-relationshipsCreatedFrom if-sourceData if-cloudDriveData trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n        \x3cspan class\x3d"js-otherStyles if-vectorTile if-otherStyles trailer-0 font-size--1"\x3e\r\n          \x3cp class\x3d"js-otherStyles-label trailer-0"\x3e\x3c/p\x3e\r\n        \x3c/span\x3e\r\n        \x3cp class\x3d"if-resultCreatingIn trailer-0 font-size--1 js-resultCreatingIn"\x3e\r\n          ${i18n.itemProperties.creatingDataIn}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"if-resultVisualizations trailer-0 font-size--1"\x3e${i18n.itemProperties.publishedTo}\x3c/p\x3e\r\n        \x3cul class\x3d"if-resultVisualizations other-views trailer-0 font-size--1 js-relationshipsVisualizedTo"\x3e\x3c/ul\x3e\r\n        \x3cp class\x3d"if-resultDataViews trailer-0 font-size--1"\x3e${i18n.itemProperties.dataViews}\x3c/p\x3e\r\n        \x3cul class\x3d"if-resultDataViews other-views trailer-0 font-size--1 js-relationshipsDataViews"\x3e\x3c/ul\x3e\r\n        \x3cp class\x3d"if-appBuilderPlatform trailer-0 font-size--1"\x3e\r\n          ${i18n.itemProperties.applicable} ${item.typeKeywords:_formatApplicable}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 js-dataUpdatedLast hide"\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 js-schemaUpdatedLast hide"\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"js-item-size trailer-0 font-size--1"\x3e${i18n.itemProperties.sizeLabel} ${item.size:_formatSize}\x3c/p\x3e\r\n        \x3cp class\x3d"js-item-attachments-size trailer-0 font-size--1 if-has-attachments"\x3e\r\n          ${i18n.itemProperties.attachmentsSize} ${item.subInfo:_formatSize}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1"\x3e${i18n.itemProperties.id} \x3cspan class\x3d"font-size--2"\x3e${item.id}\x3c/span\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"js-item-image-count trailer-0 font-size--1 if-has-image-count"\x3e\r\n          ${i18n.itemProperties.imageCount} ${item.subInfo:_formatNumber}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 if-web if-mobile if-platform js-app-api"\x3e${item.typeKeywords:_formatAppApi}\x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 if-web if-mobile if-platform js-app-purpose"\x3e\r\n          ${item.typeKeywords:_formatAppPurpose}\r\n        \x3c/p\x3e\r\n\r\n        \x3cp class\x3d"js-rating font-size--3 trailer-half leader-quarter"\x3e\r\n          \x3cspan class\x3d"js-update-ratings"\x3e\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cdiv class\x3d"trailer-0 leader-half inline-block if-can-share-social"\x3e\r\n          \x3cdiv class\x3d"tablet-hide"\x3e\r\n            \x3ca\r\n              target\x3d"_blank"\r\n              href\x3d"${item.type:_formatFacebookLink}"\r\n              class\x3d"icon-social-facebook js-open-facebook js-action-shareSocial js-telemetry-action"\r\n              data-telemetry-action\x3d"social share"\r\n              aria-label\x3d"Facebook"\r\n              data-action\x3d"shareSocial"\r\n            \x3e\r\n              \x3csvg\r\n                xmlns\x3d"http://www.w3.org/2000/svg"\r\n                width\x3d"30"\r\n                height\x3d"30"\r\n                viewBox\x3d"0 0 30 30"\r\n                class\x3d"high-contrast-only"\r\n              \x3e\r\n                \x3cpath\r\n                  fill\x3d"currentColor"\r\n                  d\x3d"M22.117 7H7.883A.883.883 0 0 0 7 7.883v14.234c0 .487.396.883.883.883H15v-7h-3v-2h3v-.992c0-2.066 1.277-3.192 3.121-3.192.883 0 1.879.066 1.879.096V12h-1.764c-1.002 0-1.236.148-1.236.848V14h2.73l-.911 2H17v7h5.117a.884.884 0 0 0 .883-.883V7.883A.883.883 0 0 0 22.117 7z"\r\n                /\x3e\r\n              \x3c/svg\x3e\r\n            \x3c/a\x3e\r\n            \x3ca\r\n              target\x3d"_blank"\r\n              href\x3d"${item.type:_formatTwitterLink}"\r\n              class\x3d"margin-left-quarter icon-social-twitter js-action-shareSocial js-telemetry-action js-open-twitter"\r\n              data-telemetry-action\x3d"social share"\r\n              aria-label\x3d"Twitter"\r\n              data-action\x3d"shareSocial"\r\n            \x3e\r\n              \x3csvg\r\n                xmlns\x3d"http://www.w3.org/2000/svg"\r\n                width\x3d"30"\r\n                height\x3d"30"\r\n                viewBox\x3d"0 0 30 30"\r\n                class\x3d"high-contrast-only"\r\n              \x3e\r\n                \x3cpath\r\n                  fill\x3d"currentColor"\r\n                  d\x3d"M23.156 11.495c.007.158.012.319.012.479 0 4.878-3.717 10.505-10.508 10.505-2.085 0-4.027-.61-5.66-1.658a7.41 7.41 0 0 0 5.466-1.529 3.695 3.695 0 0 1-3.449-2.564 3.621 3.621 0 0 0 1.667-.062 3.697 3.697 0 0 1-2.962-3.621v-.048a3.683 3.683 0 0 0 1.672.463 3.693 3.693 0 0 1-1.143-4.93 10.486 10.486 0 0 0 7.611 3.858 3.691 3.691 0 0 1 6.292-3.367 7.458 7.458 0 0 0 2.345-.896 3.699 3.699 0 0 1-1.624 2.043 7.427 7.427 0 0 0 2.123-.582 7.545 7.545 0 0 1-1.842 1.909z"\r\n                /\x3e\r\n              \x3c/svg\x3e\r\n            \x3c/a\x3e\r\n            \x3cdiv class\x3d"dropdown js-dropdown shorten-url if-online js-shorten-url"\x3e\r\n              \x3ca\r\n                href\x3d"#"\r\n                id\x3d"shorten-url"\r\n                class\x3d"margin-left-quarter icon-social-share js-dropdown-toggle js-shorten-url-link"\r\n                aria-label\x3d"Copy URL"\r\n              \x3e\r\n                \x3csvg\r\n                  xmlns\x3d"http://www.w3.org/2000/svg"\r\n                  width\x3d"30"\r\n                  height\x3d"30"\r\n                  viewBox\x3d"0 0 30 30"\r\n                  class\x3d"high-contrast-only"\r\n                \x3e\r\n                  \x3cpath\r\n                    fill\x3d"currentColor"\r\n                    d\x3d"M19.8 7h-9.6A3.21 3.21 0 0 0 7 10.2v9.6c0 1.761 1.44 3.2 3.2 3.2h9.6c1.761 0 3.2-1.439 3.2-3.2v-9.6C23 8.44 21.561 7 19.8 7zm.35 4.593a2.06 2.06 0 0 1-2.058 2.058h-.186c-.357 0-.708-.095-1.021-.276L13.634 15l3.252 1.626a2.037 2.037 0 0 1 1.021-.276h.186a2.06 2.06 0 0 1 2.058 2.058v.186a2.06 2.06 0 0 1-2.058 2.058h-.186a2.06 2.06 0 0 1-2.058-2.058v-.186c0-.118.013-.237.038-.366l-3.234-1.617a2.064 2.064 0 0 1-1.561.727h-.186a2.06 2.06 0 0 1-2.058-2.058v-.186a2.06 2.06 0 0 1 2.058-2.058h.186c.598 0 1.17.269 1.561.727l3.234-1.617a1.915 1.915 0 0 1-.038-.367v-.186a2.06 2.06 0 0 1 2.058-2.058h.186a2.06 2.06 0 0 1 2.058 2.058v.186z"\r\n                  /\x3e\r\n                \x3c/svg\x3e\r\n              \x3c/a\x3e\r\n              \x3cdiv class\x3d"dropdown-menu dropdown-right leader-quarter trailer-quarter" role\x3d"menu"\x3e\r\n                \x3clabel class\x3d"padding-trailer-quarter leader-quarter padding-left-1 padding-right-1"\x3e\r\n                  ${i18n.itemProperties.shortUrl}\r\n                  \x3cdiv id\x3d"copyToClipBoardShortURL"\x3e\x3c/div\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"hide js-image-service-details"\x3e\r\n          \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e${i18n.itemProperties.imageProperties}\x3c/h5\x3e\r\n          \x3cp class\x3d"js-image-properties-source-type trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n          \x3cp class\x3d"js-image-properties-pixel-type trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n          \x3cp class\x3d"js-image-properties-bands trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n          \x3cp class\x3d"js-image-properties-cell-size trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"hide js-map-image-layer-details"\x3e\r\n          \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e${i18n.itemProperties.layerDrawing}\x3c/h5\x3e\r\n          \x3cp class\x3d"hide js-map-image-layer-drawing-cached"\x3e${i18n.itemProperties.cachedDrawing}\x3c/p\x3e\r\n          \x3cp class\x3d"hide js-map-image-layer-drawing-dynamic"\x3e${i18n.itemProperties.dynamicDrawing}\x3c/p\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Sharing --\x3e\r\n        \x3cdiv class\x3d"position-relative"\x3e\r\n          \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e\r\n            ${i18n.GroupWidget.share}\r\n            \x3cbutton\r\n              class\x3d"btn-link btn-link-darker-gray if-can-share font-size--3 right js-action-share"\r\n              data-action\x3d"share"\r\n              aria-label\x3d"${i18n.itemProperties.editShareLevelLabel}"\r\n            \x3e\r\n              ${icons.inline.edit.16}${i18n.common.edit}\r\n            \x3c/button\x3e\r\n          \x3c/h5\x3e\r\n          \x3cdiv class\x3d"js-item-share-summary"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"js-item-access-mismatch"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Change Owner --\x3e\r\n        \x3cdiv class\x3d"position-relative"\x3e\r\n          \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e\r\n            ${i18n.itemProperties.owner}\r\n            \x3cbutton\r\n              class\x3d"btn-link btn-link-darker-gray if-can-change-owner font-size--3 right js-action-reassignItem"\r\n              data-action\x3d"reassignItem"\r\n            \x3e\r\n              ${icons.inline.user.16}${i18n.itemProperties.reassign}\r\n            \x3c/button\x3e\r\n          \x3c/h5\x3e\r\n          \x3cdiv class\x3d"js-owner-info"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Move to folder --\x3e\r\n        \x3cdiv class\x3d"if-admin"\x3e\r\n          \x3csection class\x3d"position-relative"\x3e\r\n            \x3cheader class\x3d"leader-1 padding-leader-half"\x3e\r\n              \x3ch5\x3e\r\n                ${i18n.itemProperties.folder}\r\n                \x3cbutton\r\n                  data-action\x3d"moveItem"\r\n                  class\x3d"js-telemetry-action js-folder-open btn-link btn-link-darker-gray font-size--3 right js-action-moveItem"\r\n                  data-telemetry-action\x3d"move"\r\n                  aria-label\x3d"${i18n.itemProperties.moveToFolder}"\r\n                \x3e\r\n                  ${icons.inline.folder-move.16}${i18n.itemProperties.moveTo}\r\n                \x3c/button\x3e\r\n              \x3c/h5\x3e\r\n            \x3c/header\x3e\r\n            \x3cp class\x3d"leader-quarter js-folder-title break-word"\x3e\x3c/p\x3e\r\n          \x3c/section\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"js-category-section"\x3e\r\n          \x3c!-- Container for Categories InlineEdit --\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"js-tags-section"\x3e\r\n          \x3c!-- Container for Tags InlineEdit --\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"item-accessInformation leader-1 padding-leader-half"\x3e\r\n          \x3cdiv class\x3d"js-accessInformation-section"\x3e\r\n            \x3c!-- Container for Credits(Attribution) InlineEdit --\x3e\r\n            \x3ch5 class\x3d"trailer-half"\x3e${i18n.itemProperties.credits}\x3c/h5\x3e\r\n            \x3cspan class\x3d"if-no-accessInformation text-darker-gray trailer-half"\x3e\r\n              \x3cspan class\x3d"if-viewer"\x3e${i18n.itemProperties.creditsUnavailable}\x3c/span\x3e\r\n              \x3cbutton class\x3d"btn-link js-inline-edit if-can-update text-left"\x3e${i18n.itemProperties.noCredits}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cp class\x3d"if-accessInformation js-view"\x3e\x3c/p\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-route-layer leader-1 padding-leader-half navigator-button-desktop"\x3e\r\n          \x3ch5 class\x3d"trailer-half flex"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_img" alt\x3d"" class\x3d"margin-right-quarter overview-app-icon"\r\n            src\x3d${basePath}/css/images/app-icons/navigator.png\x3e\r\n            \x3cspan class\x3d"flex-end"\x3e${i18n.itemProperties.navigatorLink}\x3c/span\x3e\r\n          \x3c/h5\x3e\r\n          \x3cdiv id\x3d"copyToClipBoardNavURL"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-url if-documentUrl if-hide-insights leader-1 padding-leader-half"\x3e\r\n          \x3ch5 class\x3d"trailer-half"\x3e\r\n            ${i18n.itemProperties.url}\r\n            \x3ca href\x3d"${item.viewUrl}" target\x3d"_blank" class\x3d"js-telemetry-action js-view-url font-size--3 link-darker-gray right" data-telemetry-action\x3d"view item url"\x3e\r\n              ${icons.inline.launch.16}${i18n.itemProperties.metadataView}\r\n            \x3c/a\x3e\r\n          \x3c/h5\x3e\r\n          \x3cdiv id\x3d"copyToClipBoardURL"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"leader-1 padding-leader-half hide js-view-wmts-url"\x3e\r\n          \x3ch5 class\x3d"trailer-half"\x3e\r\n            ${i18n.itemProperties.wmtsUrl}\r\n            \x3ca href\x3d"${item.wmtsUrl}" target\x3d"_blank" class\x3d"font-size--3 link-darker-gray right js-wmts-link"\x3e\r\n              ${icons.inline.launch.16}${i18n.itemProperties.metadataView}\r\n            \x3c/a\x3e\r\n          \x3c/h5\x3e\r\n          \x3cdiv id\x3d"copyToClipBoardWMTSURL"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"js-help-container"\x3e\x3c/div\x3e\r\n      \x3c/section\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-sublayer-pane item-pane item-pane--right"\x3e\r\n    \x3cdiv class\x3d"js-sublayer"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3c!-- For tile layer auto cache case --\x3e\r\n  \x3ccalcite-alert\r\n    placement\x3d"top"\r\n    icon\r\n    label\x3d"${i18n.itemProperties.buildingTileAutoHeader}"\r\n    class\x3d"tile-layer-auto-cache-alert"\r\n  \x3e\r\n    \x3cdiv slot\x3d"title"\x3e${i18n.itemProperties.buildingTileAutoHeader}\x3c/div\x3e\r\n    \x3cdiv slot\x3d"message"\x3e${i18n.itemProperties.buildingTileAutoDescription}\x3c/div\x3e\r\n  \x3c/calcite-alert\x3e\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_owner.html":'\x3cp class\x3d"flex-center"\x3e\r\n  \x3cspan class\x3d"js-owner-thumbnail"\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"flex-1"\x3e${item.owner}\x3cspan\x3e\r\n\x3c/p\x3e',"url:arcgisonline/pages/item/widgets/templates/_ownerVerified.html":'\x3cp\x3e\r\n  \x3cspan class\x3d"font-size-0 flex-center"\x3e\r\n    \x3cspan class\x3d"js-verified-thumbnail"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"flex-1"\x3e${item.verified.name}\x3c/span\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"font-size--2 leader-half display-block text-ellipsis"\x3e\r\n    \x3cspan class\x3d"display-block font-size--3"\x3e${i18n.itemProperties.managedBy}\x3c/span\x3e\r\n    \x3cspan class\x3d"flex-center leader-quarter"\x3e\r\n      \x3cspan class\x3d"js-owner-thumbnail"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"flex-1"\x3e${item.owner}\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\x3c/p\x3e',
"url:arcgisonline/pages/item/widgets/templates/_reply.html":'\x3cdiv class\x3d"panel panel-white panel-bordered padding-left-4 border-bottom-clear flex ${classNames}" data-comment-id\x3d"${comment.id}"\x3e\r\n    \x3cdiv class\x3d"comment-avatar flex-0"\x3e\r\n        \x3cspan class\x3d"js-comment-avatar"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"flex-1 padding-left-1"\x3e\r\n        \x3cp class\x3d"comment-meta font-size--2"\x3e\r\n            \x3cspan\x3e\r\n              \x3ccalcite-link data-owner\x3d"${comment.owner}" class\x3d"margin-right-half js-comment-profile"\x3e${commentOwnerProfile.username}\x3c/calcite-link\x3e\r\n              \x3cspan class\x3d"js-comment-profile if-item-owner label"\x3e${i18n.common.itemOwner}\x3c/span\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"padding-left-half tooltip" aria-label\x3d"${comment.created:_formatDate} ${comment.created:_formatTime}"\x3e${comment.created:_formatCommentDate}\x3c/span\x3e\r\n\r\n            \x3ccalcite-button appearance\x3d"transparent" scale\x3d"m" data-id\x3d"${comment.id}"\r\n                    data-type\x3d"reply"\r\n                    class\x3d"right if-can-delete-comment js-action-deleteComment"\r\n                    aria-controls\x3d"comments"\x3e\r\n                ${i18n.common.deleteLabel}\r\n            \x3c/calcite-button\x3e\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"font-size--1 text-off-black trailer-half break-word"\x3e${comment.comment}\x3c/p\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_solutionContent.html":'\x3ctr class\x3d\'js-solution-row\'\x3e\r\n  \x3ctd\x3e\r\n    \x3csection class\x3d"accordion-section"\x3e\r\n      \x3ch4 class\x3d"accordion-title filters--accordion--title filters--accordion--title__override" role\x3d"tab" tabindex\x3d"0"\x3e\r\n        ${icons.chevron-down.16}\r\n        \x3cspan class\x3d"solution-list-item" alt\x3d"${type}" title\x3d"${type}"\x3e\r\n          \x3cimg class\x3d"solution-item-icon icon-inline icon-inline--on-left" src\x3d"${source}" width\x3d"16" height\x3d"16" alt\x3d""\x3e\r\n          ${title}\r\n        \x3c/span\x3e  \r\n      \x3c/h4\x3e\r\n\r\n      \x3cdiv class\x3d"accordion-content margin-left-1 margin-right-1"\x3e\r\n        \x3cdiv class\x3d"padding-left-1 padding-right-1 js-no-categories-action"\x3e\r\n          \x3ch5 class\x3d"font-size-0 avenir-regular trailer-0"\x3e${child}\x3c/h5\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/section\x3e\r\n  \x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_solutionItem.html":'\x3cul class\x3d"solution-list"\x3e\r\n  \x3cli\x3e\r\n    \x3cspan class\x3d"display-block solution-list-item" alt\x3d"${type}" title\x3d"${type}"\x3e\r\n      \x3cimg class\x3d"icon-inline icon-inline--on-left" src\x3d"${source}" width\x3d"16" height\x3d"16" alt\x3d""\x3e\r\n      \x3cspan class\x3d"margin-left-quarter"\x3e\r\n        ${titleOrLink}\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n    ${childList}\r\n  \x3c/li\x3e\r\n\x3c/ul\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_toolActions.html":'\x3cdiv class\x3d"${attributes} panel panel-white panel-bordered panel-compact border-bottom-clear"\x3e\r\n  \x3ch5 class\x3d"font-size-1 trailer-0"\x3e\r\n    \x3ca target\x3d"_blank" href\x3d"${tool.url}"\x3e${tool.name}\x3c/a\x3e\r\n  \x3c/h5\x3e\r\n  \x3cnav class\x3d"inline-block" aria-label\x3d"${i18n.itemProperties.layerActions} ${tool.name}"\x3e\r\n    \x3c!-- Open --\x3e\r\n    \x3cdiv class\x3d"dropdown js-dropdown dropdown-right"\x3e\r\n      \x3cspan class\x3d"padding-right-1"\x3e\r\n        \x3cbutton class\x3d"js-dropdown-toggle font-size--3 icon-ui-link-external btn-link btn-link-darker-gray"\r\n                tabindex\x3d"0"\x3e${i18n.itemProperties.openIn}\r\n          \x3cspan class\x3d"icon-ui-down-arrow icon-ui-flush"\x3e\x3c/span\x3e\r\n        \x3c/button\x3e\r\n      \x3c/span\x3e\r\n      \x3c!-- extends side-nav --\x3e\r\n      \x3cnav class\x3d"dropdown-menu"\x3e\r\n          \x3ca href\x3d"${tool.mapViewerUrl}" class\x3d"dropdown-link js-open-mapViewer"\x3e${i18n.itemLinks.openMapViewer}\x3c/a\x3e\r\n      \x3c/nav\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3ca href\x3d"${tool.url}"\r\n       target\x3d"_blank"\r\n       class\x3d"link-darker-gray icon-ui-link-external inline-block font-size--3 js-open-url"\x3e${i18n.itemProperties.serviceURL}\x3c/a\x3e\r\n  \x3c/nav\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_workflowContent.html":'\x3ctr\x3e\r\n  \x3ctd\x3e\r\n    \x3ca target\x3d"_blank" href\x3d"item.html?id\x3d${id}"\x3e${title}\x3c/a\x3e\r\n  \x3c/td\x3e\r\n\x3c/tr\x3e\r\n',"url:arcgisonline/pages/item/widgets/templates/_visualize.html":'\x3cmain class\x3d"fullscreen flex-column ie9-height-100 ie9-width-100"\x3e\r\n  \x3cdiv\x3e\r\n    \x3cdiv class\x3d"js-viz-controls clearfix padding-left-1 padding-right-1 border-box padding-leader-half full-width"\x3e\r\n      \x3clabel class\x3d"js-featureLayers hide if-featureLayers column-12 tablet-column-6 trailer-half"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"layerSelectLabel" class\x3d"inline-block padding-right-1"\x3e${i18n.openMapDlg.layerLabel}\x3c/span\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"layerSelect" class\x3d"inline-block leader-0"\x3e\x3c/select\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv class\x3d"inline-block right padding-trailer-half"\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"saveAsBtn" class\x3d"btn btn-clear btn-two right if-can-create-items"\x3e${i18n.common.saveLayerAs}\x3c/button\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"saveBtn" class\x3d"btn right btn-disabled if-can-update"\x3e${i18n.common.saveLayer}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe class\x3d"item-iframe flex-1" title\x3d"${i18n.itemProperties.mapViewerLbl}" name\x3d"viewer" frameborder\x3d"0" border\x3d"0" cellspacing\x3d"0" scrolling\x3d"no" data-dojo-attach-point\x3d"viewer" id\x3d"main-content-area"\x3e\x3c/iframe\x3e\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_imageManagement.html":'\x3cmain class\x3d"fullscreen flex-column ie9-height-100 ie9-width-100"\x3e\r\n  \x3ciframe class\x3d"item-iframe flex-1" title\x3d"${i18n.itemProperties.imageManagementLbl}" name\x3d"viewer" frameborder\x3d"0" border\x3d"0" cellspacing\x3d"0" scrolling\x3d"no" data-dojo-attach-point\x3d"divImageManagement" id\x3d"main-content-area"\x3e\x3c/iframe\x3e\r\n\x3c/main\x3e\r\n',"url:esri/dijit/templates/ExpressionEditor.html":'\x3cdiv class\x3d"modal"\x3e\r\n  \x3cdiv class\x3d"modal-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_expressionEditorLoading" class\x3d"throb-loading" style\x3d"border:none;height:100%;"\x3e\x3c/div\x3e\r\n    \x3ciframe data-dojo-attach-point\x3d"_expressionEditor" scrolling\x3d"auto" style\x3d"border:none;width:100%;height:100%;visibility:hidden;"\x3e\x3c/iframe\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/CalculateField.html":'\x3cdiv class\x3d"${_css.base}"\x3e\r\n  \x3cdiv class\x3d"esriFloatLeading esriCalcHelp" data-dojo-attach-point\x3d"_helpNode"\x3e\r\n    \x3ca href\x3d"#" data-dojo-attach-point\x3d"_helpurlNode" target\x3d\'_help\' class\x3d""\x3e${i18n.learnMore}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_headerPane" style\x3d"width:99%;margin-top:0.5em; margin-bottom: 0.5em;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_header" class\x3d"${_css.titleLabel}"\x3e\r\n       \x3cdiv class\x3d"esriAlignLeading"\x3e${i18n.expBuilderTitle}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.titleDividerLine}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e  \r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_expressionForm" style\x3d"height:100%;width:99%;"\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_selCalcFieldDiv" style\x3d"width:100%;padding-bottom:0.5em;"\x3e\r\n      \x3cdiv\x3e\x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.selectCalField}\x3c/label\x3e\x3c/div\x3e\r\n      \x3cselect class\x3d"esriLeadingMargin1 ${_css.selectField}" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_selCalcField"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"width:100%;padding-bottom:0.5em;" class\x3d"esriFloatLeading"\x3e\r\n      \x3clabel class\x3d"esriLeadingMargin1" data-dojo-attach-point\x3d"_calcFieldLabel"\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cinput class\x3d"esriFloatLeading esriLeadingMargin1 ${_css.expressionBox}" dir\x3d"ltr" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-attach-point\x3d"_exprBox" data-dojo-props\x3d"rows:${expressionBoxRows} ,cols:${expressionBoxCols},required:true,intermediateChanges:true"\x3e\x3c/input\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading ${_css.actionBtnContainer}"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1" style\x3d"width:70%;padding-bottom:0.5em;" dir\x3d"ltr" data-dojo-attach-point\x3d"_operatorCtr"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.actionButton} esriFloatTrailing esriTrailingMargin1" data-dojo-props\x3d"label:\'${i18n.remove}\',iconClass:\'${_css.clearIcon}\',showLabel: false, disabled:true" data-dojo-attach-event\x3d"onClick:_handleRemoveBtnClick" data-dojo-attach-point\x3d"_removeBtn"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.actionButton} esriFloatTrailing esriTrailingMargin1" data-dojo-props\x3d"label:\'${i18n.validate}\',iconClass:\'${_css.validateIcon}\',showLabel: false, disabled:true" data-dojo-attach-event\x3d"onClick:_handleValidationBtnClick" data-dojo-attach-point\x3d"_validateBtn"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.fieldFunctionContainer}"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading ${_css.fieldContainer}"\x3e\r\n        \x3cdiv class\x3d"${_css.fieldLabelDiv}"\x3e\x3clabel class\x3d"esriLeadingMargin1 ${_css.titleLabel}"\x3e${i18n.fields}\x3c/label\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"${_css.fieldTypeContainer}"\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_strRadioBtn" data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"StrType"/\x3e\r\n            ${i18n.stringLabel}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_numRadioBtn" data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"NumType"/\x3e \r\n            ${i18n.numeric}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_dateRadioBtn"  data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"DateType"/\x3e\r\n            ${i18n.dateLabel}\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriLeadingMargin1 ${_css.fieldListContainer}" dir\x3d"ltr" data-dojo-attach-point\x3d"_attributeListCtr"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing ${_css.functionContainer}"\x3e\r\n        \x3cdiv class\x3d"${_css.functionLabelDiv}"\x3e\r\n          \x3clabel class\x3d"${_css.titleLabel}"\x3e${i18n.functions}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_helpersListCtr" dir\x3d"ltr" class\x3d"${_css.functionListContainer}"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriLeadingMargin05 ${_css.formWarning} esriRoundedBox" data-dojo-attach-point\x3d"_errorMessagePane" style\x3d"clear:both;display:none;"\x3e\r\n      \x3ca href\x3d"#" title\x3d"${i18n.close}" class\x3d"esriFloatTrailing esri-icon-close" title\x3d\'${i18n.close}\' data-dojo-attach-event\x3d"onclick:_handleCloseMsg"\x3e\r\n      \x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_bodyNode" style\x3d"width:100%;height:100%;"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.actionDividerLine}"\x3e\x3c/div\x3e\r\n    \x3cdiv  class\x3d"esriFloatTrailing esriTrailingMargin2 esriCalcFieldActionCtr" data-dojo-attach-point\x3d"_buttonCtr"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button"  class\x3d"${_css.addButton}" data-dojo-attach-point\x3d"_addBtn" data-dojo-attach-event\x3d"onClick:_handleAddButtonClick"\x3e\r\n        ${calculateLabel}\r\n      \x3c/div\x3e\r\n       \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"esriLeadingMargin05 ${_css.closeButton}" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_handleCloseButtonClick"\x3e\r\n        ${i18n.close}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_arcadeExpressionEditorDlg"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dijitDialogUnderlayWrapper" data-dojo-attach-point\x3d"_underlay" style\x3d"position:absolute;z-index:949;display:none;top:0px;left:0px;width:100%;height:100%;"\x3e\r\n    \x3cdiv class\x3d"dijitDialogUnderlay" tabindex\x3d"-1" style\x3d"width:100%;height:100%"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.loadingIcon}" style\x3d"height:100%;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e  \r\n',
"url:esri/dijit/FeatureAttachments/templates/FeatureAttachments.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${_css.contentContainer}"\x3e\r\n    \x3cdiv class\x3d"${_css.tabContainer}" data-dojo-attach-point\x3d "_tabContainer" data-dojo-type\x3d"dijit/layout/TabContainer"\x3e\r\n      \x3cdiv class\x3d"${_css.viewPane}" data-dojo-attach-point\x3d "_viewPane" data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${_i18nStrings.view}" data-dojo-props\x3d"selected:true"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${_css.addPane}" data-dojo-attach-point\x3d "_addPane" data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${_i18nStrings.add}" data-dojo-props\x3d"disabled:true"\x3e\r\n        \x3cdiv class\x3d"${_css.addPaneContent}" data-dojo-attach-point\x3d "_addPaneContent"\x3e\r\n          \x3cinput class\x3d"${_css.dragDrop}" type\x3d"file" name\x3d"ft_attachment_input" size\x3d"40" data-dojo-attach-point\x3d"_fileInput"\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.menuContainer}"\x3e\r\n      \x3cbutton class\x3d\'${_css.formButton} ${_css.uploadButton} ${_css.hidden}\' data-dojo-attach-point\x3d"_uploadButton" data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"disabled:true"\x3e${_i18nStrings.upload}\x3c/button\x3e\r\n      \x3cdiv class\x3d"${_css.feedbackNode}" data-dojo-attach-point\x3d "_feedbackNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${_css.loadingIndicator} ${_css.hidden}" data-dojo-attach-point\x3d"_loadingIndicator"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/TabContainer.html":'\x3cdiv class\x3d"dijitTabContainer"\x3e\r\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:dijit/layout/templates/_TabButton.html":'\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\r\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\r\n\t\t  role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\r\n\t\t\t\t\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/ScrollingTabController.html":'\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_menuBtn"\r\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\r\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\r\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_leftBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_rightBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\r\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\r\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\r\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html":'\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/FeatureTable/templates/Grid.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.borderContainer}" data-dojo-attach-point\x3d "_gridBorderContainerNode" data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false"\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.menu}" data-dojo-attach-point\x3d "_gridHeaderNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'top\'"\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.loadingIndicator} ${css.hidden}" data-dojo-attach-point\x3d "_gridLoadingIndicatorNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.menuOptions}" data-dojo-attach-point\x3d "_menuNode" \x3e\r\n        \x3cdiv data-dojo-attach-point\x3d "_gridMenuNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.title}" data-dojo-attach-point\x3d "_gridTitleNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane}" data-dojo-attach-point\x3d "_gridContentPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'center\'"\x3e\r\n      \x3cdiv class\x3d"${css.grid}" data-dojo-attach-point\x3d"_gridNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/FeatureTable/templates/FeatureTable.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.borderContainer}" data-dojo-attach-point\x3d "_gridBorderContainerNode" data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false"\x3e\r\n    \x3cdiv class\x3d"${css.contentPane}" data-dojo-attach-point\x3d "_leadingPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'leading\'"\x3e\r\n      \x3cdiv class\x3d"${css.grid}" data-dojo-attach-point\x3d"_gridNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.hidden}" data-dojo-attach-point\x3d "_centerPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'center\'"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.hidden}" data-dojo-attach-point\x3d "_trailingPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'trailing\'"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Histogram/templates/Histogram.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.container}" data-dojo-attach-point\x3d"_containerNode"\x3e\r\n    \x3cdiv class\x3d"${css.topLabel}" data-dojo-attach-point\x3d"_topLabelNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.svgContainer}" data-dojo-attach-point\x3d"_svgContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.bottomLabel}" data-dojo-attach-point\x3d"_bottomLabelNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/dijit/FilterSingle/templates/FilterSingle.html":'\x3cul class\x3d"filter-tree" role\x3d"listbox"\x3e${list}\x3c/ul\x3e\r\n\r\n',
"url:arcgisonline/pages/dijit/FilterSingle/templates/FilterOption.html":'\x3cli class\x3d"filter-tree-item filter-tree-item-single ${selected} js-filter-item" data-value\x3d"${value}"\x3e\r\n  \x3ca role\x3d"option" aria-selected\x3d"false" href\x3d"#" title\x3d"${label}" class\x3d"filter-tree-link js-filter-link" data-param\x3d"${param}" data-value\x3d"${value}"\x3e${label}\x3cspan class\x3d"js-filter-link-count hide filter-tree-count margin-left-quarter inline-block no-pointer" data-value\x3d"${value}"\x3e\x3c/span\x3e\x3c/a\x3e\r\n\x3c/li\x3e\r\n',
"url:arcgisonline/pages/dijit/FilterSingle/templates/ClearAll.html":'\x3cbutton class\x3d"js-clear-filter btn-link btn-link-off-black font-size--3 right ${hide} clear-filter-button" data-filter-param\x3d"${param}" aria-label\x3d"${clearText}"\x3e${i18n.groupSelector.clear}\x3c/button\x3e\r\n',"url:arcgisonline/pages/dijit/FilterStatus/templates/FilterStatus.html":'\x3cdiv class\x3d"padding-left-1 inline-block flex-1 filter-chip-wrap hide" data-dojo-attach-point\x3d"filterChipWrap"\x3e\r\n    \x3cspan class\x3d"font-size--2 margin-right-half filter-chips-label"\x3e${i18n.GroupWidget.filters}\x3c/span\x3e\r\n    \x3cspan class\x3d"margin-right-half break-word filter-chips" data-dojo-attach-point\x3d"filterChips"\x3e\x3c/span\x3e\r\n    \x3cbutton class\x3d"btn-link btn-link-off-black font-size--2 filter-clear-all" data-dojo-attach-point\x3d"clearAll"\x3e${i18n.GroupWidget.clearAll}\x3c/a\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/FilterStatus/templates/FilterChip.html":'\x3cspan class\x3d"filter-chip margin-right-half js-filter-chip" data-filter\x3d"${filter.param}" data-value\x3d"${selected.value}"\x3e\r\n  \x3cspan class\x3d"filter-chip-text"\x3e${filter.chipText} ${selected.label}\x3c/span\x3e\r\n  \x3cbutton\r\n    class\x3d"filter-chip--remove js-filter-chip-remove"\r\n    data-filter\x3d"${filter.param}"\r\n    data-value\x3d"${selected.value}"\r\n    aria-label\x3d"${i18n.FilterDlg.removeFilterBtn}: \'${filter.chipText} ${selected.simpleLabel}\'"\r\n  \x3e${icons.x.16}\r\n  \x3c/button\x3e\r\n\x3c/span\x3e\r\n',
"url:arcgisonline/pages/dijit/SearchInput/SearchInput.html":'\x3cdiv class\x3d"full-width position-relative"\x3e\r\n  \x3cinput type\x3d"search" placeholder\x3d"${placeholder}" aria-label\x3d"${placeholder}" class\x3d"flex-1 input-minimal search-input ${cssTheme}" data-dojo-attach-point\x3d"searchInput"\x3e\r\n  \x3cbutton class\x3d"btn-link btn-link-darker-gray search-input__clear-btn hide" data-dojo-attach-point\x3d"clearBtn" aria-label\x3d"${i18n.common.clearValue}"\x3e${!icons.x.16}\x3c/button\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/organization/widgets/templates/members/SearchDropdown.html":'\x3cdiv class\x3d"control-bar__action js-dropdown control-bar--search-dropdown"\x3e\r\n    \x3cbutton class\x3d"control-bar__btn js-toggle-search-dropdown js-dropdown-toggle" aria-label\x3d"${i18n.myOrganization.membersTab.searchMembersBy}" aria-controls\x3d"sortmenu" data-dojo-attach-point\x3d"_toggleLink" tabindex\x3d"0" aria-haspopup\x3d"true" aria-expanded\x3d"false"\x3e\r\n        \x3cspan class\x3d"control-bar__btn-text js-search-label" data-dojo-attach-point\x3d"_searchLabel"\x3e${i18n.myOrganization.membersTab.fullName}\x3c/span\x3e${!icons.inline-end.chevron-down.16}\r\n    \x3c/button\x3e\r\n    \x3cdiv class\x3d"control-bar__overlay"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"control-bar__dropdown-menu dropdown-menu js-control-bar-search-dropdown" role\x3d"menu" id\x3d"searchmenu" aria-labelledby\x3d"searchmenutitle"\x3e\r\n        \x3ch3 class\x3d"control-bar__dropdown-menu__title" id\x3d"searchmenutitle"\x3e\r\n            ${i18n.myOrganization.membersTab.searchMembersBy}\r\n            \x3cbutton class\x3d"js-dropdown-toggle control-bar__dropdown-menu__close control-bar__btn right" aria-label\x3d"${i18n.common.close}"\x3e\r\n                ${!icons.x.24}\r\n            \x3c/button\x3e\r\n        \x3c/h3\x3e\r\n        \x3cnav class\x3d"js-search-options"\x3e\r\n            \x3cbutton class\x3d"js-search-dropdown-property control-bar__dropdown-item is-active"  role\x3d"menuitem" data-property\x3d"fullname"\x3e\r\n                \x3cspan class\x3d"control-bar__dropdown-item__label"\x3e${i18n.myOrganization.membersTab.fullName}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n            \x3cbutton class\x3d"js-search-dropdown-property control-bar__dropdown-item" role\x3d"menuitem" data-property\x3d"username"\x3e\r\n                \x3cspan class\x3d"control-bar__dropdown-item__label"\x3e${i18n.myOrganization.membersTab.username}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n            \x3cbutton class\x3d"js-search-dropdown-property control-bar__dropdown-item" role\x3d"menuitem" data-property\x3d"firstname"\x3e\r\n                \x3cspan class\x3d"control-bar__dropdown-item__label"\x3e${i18n.myOrganization.membersTab.firstName}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n            \x3cbutton class\x3d"js-search-dropdown-property control-bar__dropdown-item" role\x3d"menuitem" data-property\x3d"lastname"\x3e\r\n                \x3cspan class\x3d"control-bar__dropdown-item__label"\x3e${i18n.myOrganization.membersTab.lastName}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n        \x3c/nav\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ControlBar/templates/ControlBar.html":'\x3cdiv class\x3d"control-bar ${hideActionClass} ${hideRightClass} ${marginClass} ${positionAbsoluteClass}"\x3e\r\n  \x3cdiv class\x3d"grid-container"\x3e\r\n    \x3cdiv class\x3d"column-24 flex"\x3e\r\n      \x3cdiv class\x3d"js-control-bar-actions control-bar__section control-bar__section--left flex flex-center flex-0"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"control-bar__search ${searchActionClass} flex-1 flex js-control-bar-search-wrap"\x3e\r\n        \x3cspan class\x3d"control-bar__search-icon"\x3e${!icons.search-f.24}\x3c/span\x3e\r\n        \x3cdiv class\x3d"js-control-bar-search"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"control-bar__search-dropdown js-control-bar-search-dropdown hide"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"control-bar__search__error input-error-message js-control-bar-search-error"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"control-bar__section control-bar__section--right flex flex-center js-control-bar-right-section"\x3e\r\n        \x3cdiv class\x3d"js-control-bar-view-dropdown control-bar__action--view"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"js-control-bar-sort-dropdown"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"js-control-bar-filter-toggle ${hideFilterClass}"\x3e\r\n          \x3ccalcite-button appearance\x3d"transparent" kind\x3d"neutral" icon-start\x3d"sliders" class\x3d"js-toggle-filters"\x3e\r\n            \x3cspan class\x3d"js-toggle-filters-label"\x3e\r\n              ${i18n.filters.filters}\r\n            \x3c/span\x3e\r\n          \x3c/calcite-button\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-control-bar-refresh control-bar__refresh hide"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/ControlBar/templates/Filters.html":'\x3cdiv class\x3d"view--filters js-filters-mobile-wrap" id\x3d"view-filters-wrap"\x3e\r\n  \x3cdiv class\x3d"control-bar__overlay"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"view--filters--wrap flex-column"\x3e\r\n    \x3cdiv class\x3d"view--filters--header clearfix flex-0"\x3e\r\n      \x3ch3 class\x3d"trailer-0 font-size-1"\x3e\r\n        ${i18n.controlBar.filter}\r\n        \x3cbutton class\x3d"js-collapse-filters-button control-bar__dropdown-menu__close control-bar__dropdown-menu__close--flush control-bar__btn right" aria-label\x3d"${i18n.common.close}"\x3e\r\n          ${icons.x.32}\r\n        \x3c/button\x3e\r\n      \x3c/h3\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"js-filters-insert flex-1 view--filters--content leader-quarter"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"view--filters--footer flex-0"\x3e\r\n      \x3cbutton class\x3d"btn display-block margin-auto js-collapse-filters-button js-view-filter-results-button"\x3e${i18n.controlBar.viewResults}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/Card/Card.html":'\x3cdiv class\x3d"js-card card ${selectCardClass} ${selectedClass} ${removedClass} ${imageClass} block trailer-1 position-relative" data-id\x3d"${item.id}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dragHandle" class\x3d"card-drag-handle flex-center tooltip" tabindex\x3d"0" title\x3d"${i18n.orgHomePageSetup.content.reorder}" aria-label\x3d"${i18n.orgHomePageSetup.content.reorder}"\x3e\r\n    ${!icons.drag.16}\r\n  \x3c/div\x3e\r\n  \x3clabel class\x3d"card-select-check-mark js-card-select-check-mark-wrap tooltip" aria-label\x3d"${selectItem}"\x3e\r\n    \x3cinput type\x3d"checkbox" class\x3d"checkbox-custom-input js-card-select-check-mark" aria-label\x3d"${item.title:selectTitle}" value\x3d"${item.id}" data-id\x3d"${item.id}" ${checked}\x3e\r\n    \x3cspan class\x3d"checkbox-custom checkbox-custom--large checkbox-custom--on-dark"\x3e\r\n      \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--checked"\x3e\x3cpath d\x3d"M12.753 3l-7.319 7.497L3.252 8.31 2 9.373l3.434 3.434L14 4.24z"/\x3e\x3c/svg\x3e\r\n      \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--mixed"\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M4 7h8v2H4z"/\x3e\x3c/svg\x3e\r\n    \x3c/span\x3e\r\n  \x3c/label\x3e\r\n\r\n  \x3ca href\x3d"${item.defaultOpenUrl:empty}" class\x3d"card-image-wrap card-last js-default-open js-telemetry-thumbnail-hover" aria-label\x3d"${!item.title}: ${item.defaultOpenText:empty}"\x3e\r\n    \x3cspan class\x3d"card-image-overlay no-pointer"\x3e\r\n      \x3cspan class\x3d"font-size--1 link-white text-center thumbnail-icon card-image-open"\x3e${!item.defaultOpenSvg:empty}${item.defaultOpenText:empty}\x3c/span\x3e\r\n    \x3c/span\x3e\r\n    \x3cimg class\x3d"card-image js-card-image no-pointer ${isImage:show}" src\x3d"${item.largeThumbnailUrl}" alt\x3d""\x3e\r\n    \x3cspan class\x3d"card-image-wrap__center-image ${isImage:hide}"\x3e\r\n      \x3cimg class\x3d"card-image js-card-image no-pointer" src\x3d"${item.largeThumbnailUrl}" alt\x3d""\x3e\r\n    \x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"card-content card-content-no-padding"\x3e\r\n    \x3cdiv class\x3d"padding-leader-half padding-half padding-left-half padding-right-half card-content-auto-top"\x3e\r\n      \x3ch4 class\x3d"card-title font-size--1 trailer-0 text-ellipsis"\x3e\x3ca class\x3d"card-title-link js-telemetry-title-hover" href\x3d"item.html?id\x3d${item.id}" title\x3d"${item.title}"\x3e${!item.title}\x3c/a\x3e\x3c/h4\x3e\r\n      \x3cp class\x3d"font-size--2 trailer-quarter flex"\x3e\r\n        \x3cspan class\x3d"js-layers-tables font-size--2"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"js-layers-tables-toggle text-darkest-gray"\x3e\r\n          \x3cspan class\x3d"flex-0 ${showSource:show}"\x3e\x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"" class\x3d"icon-inline icon-inline--on-left"\x3e\x26lrm;${item.displayName:formatDisplayName}\x3c/span\x3e\r\n          \x3cspan class\x3d"flex-0 ${showSource:hide} tooltip tooltip--data" data-tooltip\x3d"${item.sourceLabel}"\x3e\x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"" class\x3d"icon-inline icon-inline--on-left"\x3e\x26lrm;${item.displayName:formatDisplayName}\x3c/span\x3e\r\n        \x3c/span\x3e\r\n      \x3c/p\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-0 text-darker-gray card-created" title\x3d"${i18n.contentPage.createdLabel} ${item.created:completeDate}"\x3e${i18n.contentPage.created} ${item.created:fullDate}\x3c/p\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-0 text-darker-gray" title\x3d"${i18n.itemProperties.lastModified} ${item.modified:completeDate}"\x3e${i18n.contentPage.modified} ${item.modified:fullDate}\x3c/p\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-0 text-darker-gray"\x3e${item:formatViewsLabel} ${item.numViews:formatNumViews}\x3c/p\x3e\r\n      \x3cdiv class\x3d"flex-0 card-badges js-card-badges"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"card-action-bar flex flex-center leader-quarter"\x3e\r\n      \x3cspan class\x3d"js-card-owner-text flex-1 text-ellipsis font-size--2 inline-block"\x3e${!item.ownerText}\x3c/span\x3e\r\n      \x3cdiv class\x3d"flex-0 flex flex-center flex-justify-end card-actions"\x3e\r\n        \x3cspan class\x3d"js-share-summary"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"js-favorites-container inline-block"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"js-open-dropdown-container js-telemetry-overflow-menu inline-block dropdown-up"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/Card/OpenDropdown.html":'\x3cdiv class\x3d"display-block dropdown js-dropdown"\x3e\r\n  \x3cbutton class\x3d"card-action js-dropdown-toggle" tabindex\x3d"0" aria-haspopup\x3d"true" aria-expanded\x3d"false" aria-label\x3d"${item.title:moreOptionsTitle}"\x3e\r\n    ${icons.ellipsis-f.16}\r\n  \x3c/button\x3e\r\n  \x3cnav class\x3d"dropdown-menu dropdown-menu-constrained dropdown-right" role\x3d"menu"\x3e\r\n    \x3c!-- Primary Item Actions --\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"item.html?id\x3d${item.id}${telemetryParams:empty}" class\x3d"dropdown-link"\x3e${i18n.itemLinks.viewDetails}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.downloadUrl:empty}" class\x3d"dropdown-link if-pdf js-action" data-action\x3d"download"\x3e${i18n.itemLinks.open}\x3c/a\x3e\r\n    \x3cbutton role\x3d"menuitem" class\x3d"dropdown-link js-item-categorize if-allow-categorization js-telemetry-categorize"\x3e${i18n.items.categorize}\x3c/button\x3e\r\n\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.downloadUrl:empty}" class\x3d"dropdown-link if-file if-download js-action" data-action\x3d"download"\x3e${i18n.itemLinks.download}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.downloadUrl:empty}" class\x3d"dropdown-link if-explorer js-action" data-action\x3d"download"\x3e${i18n.itemLinks.openExplorer}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.downloadStyleUrl:empty}" class\x3d"dropdown-link if-resources"\x3e${i18n.itemLinks.downloadStyle}\x3c/a\x3e\r\n\r\n    \x3cdiv class\x3d"if-only-map-viewer-modern"\x3e\r\n      \x3ca role\x3d"menuitem" href\x3d"${item.newMapViewerUrl:empty}" class\x3d"dropdown-link"\x3e${i18n.itemLinks.openMapViewerBetaLabel}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"if-multiple-map-viewer"\x3e\r\n      \x3cdiv class\x3d"if-map-viewer-classic"\x3e\r\n        \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n          \x3ca role\x3d"menuitem" href\x3d"${item.newMapViewerUrl:empty}" class\x3d"dropdown-link if-can-openInNewMapViewer"\x3e${i18n.itemLinks.openMapViewerBetaLabel}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"hide-if-no-legacy-viewer-support"\x3e\r\n          \x3ca role\x3d"menuitem" href\x3d"${item.mapViewerUrl:empty}" data-href\x3d"${item.mapViewerUrl:empty}" class\x3d"dropdown-link if-map if-featureCollection if-vectorTile if-2d if-table js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemLinks.openMapViewer}\x3c/a\x3e\r\n          \x3ca role\x3d"menuitem" href\x3d"${item.mapNewViewerUrl:empty}" data-href\x3d"${item.mapNewViewerUrl:empty}" class\x3d"dropdown-link if-featureCollection if-vectorTile if-2d if-table js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemLinks.addToNewViewer}\x3c/a\x3e\r\n          \x3ca role\x3d"menuitem" href\x3d"${item.mapViewerWithEditUrl:empty}" data-href\x3d"${item.mapViewerWithEditUrl:empty}" class\x3d"dropdown-link if-can-edit-service js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemProperties.openViewerFullEditingRole}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"if-map-viewer-modern"\x3e\r\n        \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n          \x3ca role\x3d"menuitem" href\x3d"${item.newMapViewerUrl:empty}" class\x3d"dropdown-link if-can-openInNewMapViewer"\x3e${i18n.itemLinks.openMapViewerBetaLabel}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"hide-if-no-legacy-viewer-support"\x3e\r\n          \x3ca role\x3d"menuitem" href\x3d"${item.mapViewerUrl:empty}" data-href\x3d"${item.mapViewerUrl:empty}" class\x3d"dropdown-link if-map if-featureCollection if-vectorTile if-2d if-table js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemLinks.openMapViewer}\x3c/a\x3e\r\n          \x3ca role\x3d"menuitem" href\x3d"${item.mapViewerWithEditUrl:empty}" data-href\x3d"${item.mapViewerWithEditUrl:empty}" class\x3d"dropdown-link if-can-edit-service js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemLinks.openMapViewerWithControl}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\r\n    \x3cdiv class\x3d"if-geoBIM"\x3e\r\n      \x3ca role\x3d"menuitem" href\x3d"${item.geoBIMUrl:empty}" class\x3d"dropdown-link if-create-GeoBIM"\x3e${i18n.itemLinks.openGeoBIM}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.sceneViewerUrl:empty}" class\x3d"dropdown-link if-scene if-3d"\x3e${i18n.itemLinks.openSceneViewer}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.url:empty}" target\x3d"_blank" class\x3d"dropdown-link if-app js-view-link"\x3e${i18n.itemLinks.viewApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.appViewerUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-mobile"\x3e${i18n.itemLinks.getApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.appViewerUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-link"\x3e${i18n.itemLinks.open}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.workforceViewerUrl:empty}" class\x3d"dropdown-link if-workforceProject-and-not-blocked"\x3e${i18n.itemLinks.openWorkforce}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.workflowViewerUrl:empty}"  class\x3d"dropdown-link if-workflow"\x3e${i18n.itemLinks.openWorkflow}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.surveyViewerUrl:empty}" class\x3d"dropdown-link if-surveyFormBrowser-and-not-blocked"\x3e${i18n.itemLinks.openSurveyBrowser}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.surveyAppUrl:empty}" class\x3d"dropdown-link if-surveyForm-and-not-blocked"\x3e${i18n.itemLinks.openSurveyApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.surveyManageUrl:empty}" class\x3d"dropdown-link if-can-edit-surveyForm js-open-surveyViewer "\x3e${i18n.itemLinks.manageSurveyApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.surveyEditUrl:empty}" class\x3d"dropdown-link if-can-edit-surveyForm js-open-surveyViewer "\x3e${i18n.itemLinks.editSurveyApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.insightsViewerUrl:empty}" class\x3d"dropdown-link if-insights-and-not-blocked"\x3e${i18n.itemLinks.openInsights}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.urbanViewerUrl:empty}" class\x3d"dropdown-link if-urbanModel"\x3e${i18n.itemLinks.openUrbanModel}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.orthoMakerUrl:empty}" class\x3d"dropdown-link if-orthoMaker-and-not-blocked"\x3e${i18n.itemLinks.openOrthoMaker}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.missionViewerUrl:empty}" class\x3d"dropdown-link if-mission"\x3e${i18n.itemLinks.openMission}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.geoAIStudioUrl:empty}" class\x3d"dropdown-link if-geoAIStudioProject-and-not-blocked"\x3e${i18n.itemLinks.openGeoAIStudio}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.hubInitiativeUrl:empty}" class\x3d"dropdown-link if-hubInitiative-and-not-blocked"\x3e${i18n.itemLinks.openHubInitiative}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.hubEventUrl:empty}" class\x3d"dropdown-link if-hubEvent-and-not-blocked"\x3e${i18n.itemLinks.viewInHub}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.hubProjectUrl:empty}" class\x3d"dropdown-link if-hubProject-and-not-blocked"\x3e${i18n.itemLinks.openHubInitiative}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.hubProjectEditUrl:empty}" class\x3d"dropdown-link if-hubProject-and-not-blocked"\x3e${i18n.itemLinks.editHubProject}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.iotViewerUrl:empty}" class\x3d"dropdown-link if-bigDataAnalytic if-realTimeAnalytic"\x3e${i18n.itemLinks.openAnalyticsIoT}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.iotFeedUrl:empty}" class\x3d"dropdown-link if-feedLayer"\x3e${i18n.itemLinks.openAnalyticsIoT}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.vrExperienceUrl:empty}" class\x3d"dropdown-link if-vrExperience-and-not-blocked js-hide-portal"\x3e${i18n.itemLinks.openVRExperience}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.excaliburViewerUrl:empty}" class\x3d"dropdown-link if-excaliburProject"\x3e${i18n.itemLinks.openExcalibur}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.excaliburProjectUrl:empty}" class\x3d"dropdown-link if-excaliburProject"\x3e${i18n.itemLinks.viewExcaliburProject}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.excaliburMediaUrl:empty}" class\x3d"dropdown-link if-excaliburMedia"\x3e${i18n.itemLinks.openExcalibur}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.dashboardUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-dashboard-and-not-blocked"\x3e${i18n.itemLinks.dashboardView}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.dashboardEditUrl:empty}" class\x3d"dropdown-link if-can-edit-dashboard"\x3e${i18n.itemLinks.dashboardEdit}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.fieldMapsUrl:empty}" class\x3d"dropdown-link if-fieldMaps"\x3e${i18n.itemLinks.fieldMaps}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.dataPipelineUrl:empty}" class\x3d"dropdown-link if-data-pipeline-and-not-blocked"\x3e${i18n.itemLinks.openDataPipelines}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.knowledgeStudioUrl:empty}" class\x3d"dropdown-link if-knowledge-studio"\x3e${i18n.itemLinks.openKnowledgeStudio}\x3c/a\x3e\r\n    \x3cdiv class\x3d"if-notebookServer-enabled"\x3e\r\n      \x3cspan class\x3d"if-can-create-notebooks"\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.notebookViewerUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-notebook"\x3e${i18n.itemLinks.openNotebook}\x3c/a\x3e\r\n      \x3c/span\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- Web Experience Actions ---\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.webExperienceUrl:empty}" class\x3d"dropdown-link if-published-webExperience-and-not-blocked" target\x3d"_blank" rel\x3d"noopener noreferrer"\x3e${i18n.itemLinks.view}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.webExperienceEditUrl:empty}" class\x3d"dropdown-link if-can-edit-webExperience"\x3e${i18n.common.edit}\x3c/a\x3e\r\n\r\n    \x3c!-- Web Experience Template Actions ---\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.webExperienceUrl:empty}" class\x3d"dropdown-link if-published-webExperienceTemplate-and-not-blocked"\x3e${i18n.itemLinks.view}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.webExperienceEditUrl:empty}" class\x3d"dropdown-link if-can-edit-webExperienceTemplate"\x3e${i18n.common.edit}\x3c/a\x3e\r\n    \x3cspan class\x3d"if-published-webExperienceTemplate-and-not-blocked"\x3e\r\n      \x3ca href\x3d"${item.webExperienceCreateUrl:empty}" class\x3d"dropdown-link if-can-create-webExperienceTemplate if-published-webExperienceTemplate-and-not-blocked if-no-public-user js-open-btn"\x3e${i18n.itemLinks.createWebExperience}\x3c/a\x3e\r\n    \x3c/span\x3e\r\n\r\n    \x3c!-- Secondary Item Actions --\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.wabEditUrl:empty}" class\x3d"dropdown-link if-can-edit-wab-and-not-blocked"\x3e${i18n.itemLinks.editApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.sceneViewerUrl:empty}" class\x3d"dropdown-link if-scene-2"\x3e${i18n.itemLinks.openSceneViewer}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.openDesktop:empty}" class\x3d"dropdown-link js-action if-desktop" data-action\x3d"openDesktop" data-type\x3d"arcmap"\x3e${i18n.itemLinks.openDesktop}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.openDesktop:empty}" class\x3d"dropdown-link js-action if-desktop if-desktopPro" data-action\x3d"openDesktop" data-type\x3d"arcmap"\x3e${i18n.itemLinks.openArcMap}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.openDesktop:empty}" class\x3d"dropdown-link js-action if-pro if-desktopPro" data-action\x3d"openDesktop" data-type\x3d"pro"\x3e${i18n.itemLinks.openPro}\x3c/a\x3e\r\n    \x3cdiv class\x3d"if-can-configure"\x3e\r\n      \x3ca role\x3d"menuitem" href\x3d"${item.configureUrl:empty}" class\x3d"dropdown-link if-instant-apps-and-not-blocked"\x3e${i18n.itemProperties.configureApp}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.viewStyleUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-vectorTile if-viewStyle"\x3e${i18n.itemLinks.viewStyle}\x3c/a\x3e\r\n\r\n    \x3c!-- Storymap Actions --\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.configureStoryMapUrl:empty}" class\x3d"dropdown-link if-editable-storymap-and-not-blocked"\x3e\r\n      \x3cspan class\x3d"if-storymap-item"\x3e${i18n.itemLinks.editStorymap}\x3c/span\x3e\r\n      \x3cspan class\x3d"if-storymap-briefing"\x3e${i18n.itemLinks.editBriefing}\x3c/span\x3e\r\n      \x3cspan class\x3d"if-storymap-collection"\x3e${i18n.itemLinks.editStorymapCollection}\x3c/span\x3e\r\n    \x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.storyMapViewerUrl:empty}" class\x3d"dropdown-link if-published-storymap-and-not-blocked"\x3e\r\n      \x3cspan class\x3d"if-storymap-item"\x3e${i18n.itemLinks.viewStorymap}\x3c/span\x3e\r\n      \x3cspan class\x3d"if-storymap-briefing"\x3e${i18n.itemLinks.viewBriefing}\x3c/span\x3e\r\n      \x3cspan class\x3d"if-storymap-collection"\x3e${i18n.itemLinks.viewStorymapCollection}\x3c/span\x3e\r\n    \x3c/a\x3e\r\n\r\n    \x3cdiv class\x3d"if-published-storymap-theme"\x3e\r\n      \x3ca\r\n        class\x3d"dropdown-link"\r\n        href\x3d"${item.newStoryMapFromThemeUrl:empty}"\r\n      \x3e\r\n        ${i18n.itemLinks.newStoryFromTheme}\r\n      \x3c/a\x3e\r\n      \x3ca role\x3d"menuitem" href\x3d"${item.newStoryMapCollectionFromThemeUrl:empty}" class\x3d"dropdown-link"\x3e\r\n        ${i18n.itemLinks.newCollectionFromTheme}\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3ca\r\n      href\x3d"${item.configureStoryMapThemeUrl:empty}"\r\n      class\x3d"dropdown-link if-editable-storymap-theme"\r\n    \x3e\r\n      ${i18n.itemLinks.editStorymapTheme}\r\n    \x3c/a\x3e\r\n  \x3c/nav\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/Card/MinimalCard.html":'\x3cdiv class\x3d"js-card card ${selectCardClass} ${selectedClass} ${removedClass} ${imageClass} block trailer-1 position-relative" data-id\x3d"${item.id}" tabindex\x3d"0"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dragHandle" class\x3d"card-drag-handle flex-center" tabindex\x3d"0"\x3e\r\n    ${!icons.drag.16}\r\n  \x3c/div\x3e\r\n  \x3ca data-dojo-attach-point\x3d"thumbLink" href\x3d"${item.defaultOpenUrl:empty}" class\x3d"card-image-wrap card-last js-default-open" aria-label\x3d"${!item.title}: ${item.defaultOpenText:empty}"\x3e\r\n    \x3cspan class\x3d"card-image-overlay no-pointer"\x3e\r\n      \x3cspan class\x3d"font-size--1 link-white text-center thumbnail-icon card-image-open"\x3e${!item.defaultOpenSvg:empty}${item.defaultOpenText:empty}\x3c/span\x3e\r\n    \x3c/span\x3e\r\n    \x3cimg class\x3d"card-image js-card-image no-pointer ${isImage:show}" src\x3d"${item.largeThumbnailUrl}" alt\x3d""\x3e\r\n    \x3cspan class\x3d"card-image-wrap__center-image ${isImage:hide}"\x3e\r\n      \x3cimg class\x3d"card-image js-card-image no-pointer" src\x3d"${item.largeThumbnailUrl}" alt\x3d""\x3e\r\n    \x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"card-content card-content-no-padding"\x3e\r\n    \x3cdiv class\x3d"padding-leader-half padding-half padding-left-half padding-right-half card-content-auto-top"\x3e\r\n      \x3ch4 class\x3d"card-title font-size-0 leader-quarter trailer-quarter text-ellipsis avenir-bold"\x3e\x3ca data-dojo-attach-point\x3d"titleLink" class\x3d"card-title-link minimal-card__title-link display-block text-ellipsis" href\x3d"item.html?id\x3d${item.id}" title\x3d"${item.title}"\x3e${item.title}\x3c/a\x3e\x3c/h4\x3e\r\n      \x3cp class\x3d"font-size--2"\x3e\x26lrm;${item.displayName:formatDisplayName}\x3c/p\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/CardMobile/CardMobile.html":'\x3ca href\x3d"item.html?id\x3d${item.id}" class\x3d"js-card block card card-mobile trailer-half" data-id\x3d"${item.id}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dragHandle" class\x3d"card-drag-handle flex-center tooltip" tabindex\x3d"0" title\x3d"${i18n.orgHomePageSetup.content.reorder}" aria-label\x3d"${i18n.orgHomePageSetup.content.reorder}"\x3e\r\n    ${!icons.drag.16}\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"card-content"\x3e\r\n    \x3ch4 class\x3d"trailer-0 font-size-1"\x3e${item.title}\x3c/h4\x3e\r\n    \x3cp class\x3d"font-size--2 trailer-half flex"\x3e\r\n      \x3cspan class\x3d"flex-0"\x3e\r\n        \x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"" class\x3d"icon-inline icon-inline--on-left"\x3e\x26lrm;${item.displayName:formatDisplayName}\r\n      \x3c/span\x3e\r\n      \x3cspan class\x3d"margin-left-quarter margin-right-quarter flex-0"\x3e${i18n.itemProperties.by}\x3c/span\x3e\r\n      \x3cspan class\x3d"flex-1 text-ellipsis"\x3e${!item.ownerText}\x3c/span\x3e\r\n    \x3c/p\x3e\r\n    \x3cdiv class\x3d"clearfix"\x3e\r\n      \x3cspan class\x3d"left inline-block margin-right-1 margin-left-0 font-size--3 text-darker-gray"\x3e\r\n        \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 16 16" width\x3d"16" class\x3d"icon-inline icon-inline--on-left"\x3e\r\n          \x3cpath fill\x3d"currentColor" d\x3d"M8 7h3v1H7V3h1zm4.803 5.803a7.5 7.5 0 1 1 0-10.606 7.5 7.5 0 0 1 0 10.606zm-.636-9.97A6.591 6.591 0 0 0 .927 7H2v1H.927A6.567 6.567 0 0 0 7 14.073v-1.38h1v1.38a6.591 6.591 0 0 0 4.167-11.24z"/\x3e\r\n        \x3c/svg\x3e\r\n        ${item.modified:fullDate}\r\n      \x3c/span\x3e\r\n      \x3cdiv class\x3d"right inline-block card-badges js-card-badges"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/a\x3e\r\n',
"url:arcgisonline/pages/dijit/CardWide/CardWide.html":'\x3cdiv\r\n  class\x3d"js-card block card ${selectCardClass} ${selectedClass} ${removedClass} ${imageClass} card-wide trailer-1"\r\n  data-id\x3d"${item.id}"\r\n\x3e\r\n  \x3clabel class\x3d"card-select-check-mark js-card-select-check-mark-wrap"\x3e\r\n    \x3cinput\r\n      type\x3d"checkbox"\r\n      class\x3d"checkbox-custom-input js-card-select-check-mark"\r\n      value\x3d"${item.id}"\r\n      aria-label\x3d"${item.title:selectTitle}"\r\n      data-id\x3d"${item.id}"\r\n      ${checked}\r\n    /\x3e\r\n    \x3cspan class\x3d"checkbox-custom checkbox-custom--large checkbox-custom--on-dark"\x3e\r\n      \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--checked"\x3e\r\n        \x3cpath d\x3d"M12.753 3l-7.319 7.497L3.252 8.31 2 9.373l3.434 3.434L14 4.24z" /\x3e\r\n      \x3c/svg\x3e\r\n      \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--mixed"\x3e\r\n        \x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M4 7h8v2H4z" /\x3e\r\n      \x3c/svg\x3e\r\n    \x3c/span\x3e\r\n  \x3c/label\x3e\r\n  \x3ca\r\n    class\x3d"card-wide-image-wrap card-wide-image-wrap--static js-default-open"\r\n    href\x3d"${item.defaultOpenUrl:empty}"\r\n    aria-label\x3d"${!item.title}: ${item.defaultOpenText:empty}"\r\n  \x3e\r\n    \x3cspan class\x3d"card-image-overlay no-pointer"\x3e\r\n      \x3cspan class\x3d"font-size--1 text-center thumbnail-icon"\r\n        \x3e${!item.defaultOpenSvg:empty}${item.defaultOpenText:empty}\x3c/span\r\n      \x3e\r\n    \x3c/span\x3e\r\n    \x3cimg class\x3d"card-image--static js-card-image no-pointer" src\x3d"${item.largeThumbnailUrl}" alt\x3d"" /\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"card-content card-content-no-padding card-content--static"\x3e\r\n    \x3cdiv class\x3d"padding-left-half padding-right-half padding-leader-half card-last"\x3e\r\n      \x3ch4 class\x3d"trailer-quarter font-size-1"\x3e\r\n        \x3ca class\x3d"card-title-link js-card-title-link" href\x3d"item.html?id\x3d${item.id}"\x3e${!item.title}\x3c/a\x3e\r\n      \x3c/h4\x3e\r\n      \x3cdiv class\x3d"js-layers-tables font-size--2"\x3e\x3c/div\x3e\r\n      \x3cp class\x3d"font-size--2 trailer-half flex ${hasSublayers:show}"\x3e\r\n        \x3cspan class\x3d"js-layers-tables-toggle"\x3e\r\n          \x3cspan class\x3d"flex-0 ${showSource:show}"\x3e\x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"" class\x3d"icon-inline icon-inline--on-left"\x3e\x26lrm;${item.displayName:formatDisplayName}\x3c/span\x3e\r\n          \x3cspan class\x3d"flex-0 ${showSource:hide} tooltip tooltip--data" data-tooltip\x3d"${item.sourceLabel}"\x3e\x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"" class\x3d"icon-inline icon-inline--on-left"\x3e\x26lrm;${item.displayName:formatDisplayName}\x3c/span\x3e\r\n        \x3c/span\x3e\r\n      \x3c/p\x3e\r\n      \x3cp class\x3d"font-size--2 trailer-half leader-quarter"\x3e${item.snippet}\x3c/p\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-half leader-quarter text-darker-gray"\x3e\r\n        \x3cspan\r\n          class\x3d"inline-block margin-right-1 card-created"\r\n          title\x3d"${i18n.contentPage.createdLabel} ${item.created:completeDate}"\r\n          \x3e${i18n.contentPage.created} ${item.created:fullDate}\x3c/span\r\n        \x3e\r\n        \x3cspan\r\n          class\x3d"inline-block margin-right-1"\r\n          title\x3d"${i18n.itemProperties.lastModified} ${item.modified:completeDate}"\r\n          \x3e${i18n.contentPage.modified} ${item.modified:fullDate}\x3c/span\r\n        \x3e\r\n        \x3cspan class\x3d"inline-block margin-right-1"\x3e${item:formatViewsLabel} ${item.numViews:formatNumViews}\x3c/span\x3e\r\n      \x3c/p\x3e\r\n      \x3cdiv class\x3d"js-sublayers"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"flex-1 card-badges js-card-badges trailer-half"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"card-action-bar flex flex-center clearfix"\x3e\r\n      \x3cdiv class\x3d"flex-1"\x3e\r\n        \x3cspan class\x3d"js-card-owner-text flex-1 text-ellipsis"\x3e${!item.ownerText}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"flex-0 flex flex-center card-actions"\x3e\r\n        \x3cspan class\x3d"js-share-summary"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"js-favorites-container inline-block"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"js-open-dropdown-container inline-block dropdown-up"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/TableRow/templates/TableRow.html":'\x3cdiv class\x3d"table-select-row ${activeRow} ${removedRow}" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-checkbox ${selectClass}" role\x3d"cell"\x3e\r\n    \x3cinput type\x3d"checkbox" class\x3d"js-table-select-checkbox" aria-label\x3d"${item.title:selectTitle}" ${checked}\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-extra-wide" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-title flex flex-1"\x3e\r\n        \x3ca href\x3d"./item.html?id\x3d${item.id}" class\x3d"flex-1 overflow-hidden"\x3e${!item.title}\x3c/a\x3e\r\n      \x3c/span\x3e\r\n      \x3cspan class\x3d"padding-left-half padding-right-half table-select-item-type full-width"\x3e\r\n        \x3cspan class\x3d"flex-1"\x3e\r\n          \x3cspan class\x3d"js-layers-tables"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"js-layers-tables-toggle display-block text-ellipsis" title\x3d"${item.displayName:formatDisplayName}"\x3e\r\n            \x3cimg src\x3d"${item.svgIconUrl16}" width\x3d"16" height\x3d"16" alt\x3d"" class\x3d"icon-inline icon-inline--on-left"\x3e\r\n            \x3cspan class\x3d"margin-left-quarter" dir\x3d"ltr"\x3e\x26lrm;${item.displayName:formatDisplayName}\x3c/span\x3e\r\n          \x3c/span\x3e\r\n        \x3c/span\x3e\r\n        \x3cspan class\x3d"table-select-item-type--badges js-badges"\x3e\x3c/span\x3e\r\n      \x3c/span\x3e\r\n      \x3cspan class\x3d"js-share-summary"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"js-favorites-container inline-block"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"js-open-dropdown-container ${dropdownClass}"\x3e\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-medium" role\x3d"cell" title\x3d"${i18n.itemProperties.lastModified} ${item.modified:completeDate}"\x3e${item.modified:fullDate}\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-laptop-show" role\x3d"cell"\x3e${!item.ownerText}\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/Card/RecycleDropdown.html":'\x3cdiv class\x3d"display-block dropdown js-dropdown"\x3e\r\n  \x3cbutton class\x3d"card-action js-dropdown-toggle" tabindex\x3d"0" aria-haspopup\x3d"true" aria-expanded\x3d"false"\r\n    aria-label\x3d"${i18n.siteHeader.moreOptions}"\x3e\r\n    ${icons.ellipsis-f.16}\r\n  \x3c/button\x3e\r\n  \x3cnav class\x3d"dropdown-menu dropdown-menu-constrained dropdown-right" role\x3d"menu"\x3e\r\n    \x3cbutton role\x3d"menuitem" class\x3d"table-laptop-hide dropdown-link js-inline-restore-container"\x3e${i18n.recycle.restore.restore}\x3c/button\x3e\r\n    \x3c!-- In Recycle bin --\x3e\r\n    \x3cbutton role\x3d"menuitem" class\x3d"dropdown-link js-item-permanently-delete"\x3e${i18n.recycle.permanentlyDelete}\x3c/button\x3e\r\n  \x3c/nav\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/ChoiceDlg.html":'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" id\x3d"choice-dialog" class\x3d"general-dialog" title\x3d"${i18n.notice}"\x3e\r\n    \x3cdiv style\x3d"margin-top:1em;" data-dojo-attach-point\x3d"choiceContent"\x3e\x3c/div\x3e\r\n    \x3cdiv style\x3d"clear: both; margin-top: 2em;" class\x3d"esriAlignTrailing right"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"choiceOneButton" class\x3d"primary trailer-quarter" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\x3e\r\n        ${i18n.ok}\r\n      \x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"choiceTwoButton" class\x3d"cancel btn-two trailer-quarter" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\x3e\r\n        ${i18n.cancel}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both; float:none; height: 0;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/CreateFolder.html":'\x3cdiv data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_createFolderForm"\x3e\r\n        \x3clabel for\x3d"create-new-folder"\x3e${i18n.folderDlg.folderName}\x3cinput id\x3d"create-new-folder" name\x3d"folder" type\x3d"text" data-dojo-attach-point\x3d"_input" maxlength\x3d"125"/\x3e\x3c/label\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/sharing/dijit/dialog/templates/CreateGeolocatorDlg.html":'\x3cdiv data-dojo-attach-point\x3d"contentNode"\x3e\r\n  \x3cp data-dojo-attach-point\x3d"_message"\x3e\x3c/p\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_itemPropertiesDlg"  data-dojo-type\x3d"arcgisonline/sharing/dijit/dialog/ItemPropertiesDlg" data-dojo-props\x3d"typeInfo:\'${_typeInfo}\', showFile:false, showUrl:false, showFolders:${showFolders}"\x3e\x3c/div\x3e\r\n  \x3c!-- \x3cdiv class\x3d"tileProperties"\x3e --\x3e \x3c!-- Radio Buttons Dialog: Use when Custom Urls can be set --\x3e\r\n  \x3c!--   \x3clabel\x3e${i18n.publishTileServiceDlg.tileSchemeLabel}\x3c/label\x3e --\x3e\r\n  \x3c!--   \x3cdiv class\x3d"tilePropertiesRadios"\x3e --\x3e\r\n  \x3c!--     \x3clabel\x3e --\x3e\r\n  \x3c!--       \x3cinput id\x3d"${id}-agoBasemap" data-dojo-attach-point\x3d"_agoBasemapRadio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"checked:true" value\x3d"ago"\x3e${i18n.publishTileServiceDlg.matchAGOLBasemaps} --\x3e\r\n  \x3c!--     \x3c/label\x3e --\x3e\r\n  \x3c!--     \x3clabel\x3e --\x3e\r\n  \x3c!--       \x3cinput id\x3d"${id}-custom" data-dojo-attach-point\x3d"_customBasemapRadio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"checked:false" value\x3d"custom"\x3e${i18n.publishTileServiceDlg.matchOwnBasemap} --\x3e\r\n  \x3c!--     \x3c/label\x3e --\x3e\r\n  \x3c!--     \x3cinput data-dojo-attach-point\x3d"_customBasemapUrl" class\x3d"custom esriLeadingMargin2" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"disabled:true,placeholder:\'${i18n.publishTileServiceDlg.tileSchemePlaceholder}\'"/\x3e --\x3e\r\n  \x3c!--   \x3c/div\x3e --\x3e\r\n  \x3c!-- \x3c/div\x3e --\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_table-row.html":'\x3cdiv class\x3d"table-select-row" role\x3d"row"\x3e\r\n  \x3c!-- Field Name --\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-field text-ellipsis"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width display-block"\x3e${field.name}\x3c/span\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n  \x3c!-- Field Type --\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-type text-ellipsis" data-dojo-attach-point\x3d"fieldTypeContainer"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width" data-value\x3d"${field.type}"\x3e${field.type:_getFieldType}\x3c/span\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"fieldTypes" class\x3d"leader-0 hide"\x3e\x3c/select\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n    \x3c!-- Location Type --\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-location text-ellipsis" data-dojo-attach-point\x3d"locationFieldContainer"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width" data-value\x3d"${field.locationType}"\x3e${field.locationType:_getLocationType}\x3c/span\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"locationFields" class\x3d"leader-0 hide"\x3e\x3c/select\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_analyze-results.html":'\x3cdiv\x3e\r\n    \x3csection class\x3d"padding-leader-half padding-trailer-half content-container analyze-results"\x3e\r\n        \x3c!-- Main --\x3e\r\n        \x3cmain class\x3d"rtl-post-0"\x3e\r\n\r\n            \x3c!-- excel sheet --\x3e\r\n            \x3clabel class\x3d"padding-right-1 trailer-half if-excel js-allExcelSheets hide" for\x3d"allExcelSheets"\x3e${i18n.addItemFrm.allExcelSheets}\x3c/label\x3e\r\n            \x3cspan class\x3d"inline-block align-middle trailer-half if-excel js-allExcelSheets hide"\x3e\r\n              \x3cselect id\x3d"allExcelSheets" data-dojo-attach-point\x3d"_allExcelSheets" class\x3d"leader-0 js-excel-sheet"\x3e\x3c/select\x3e\r\n            \x3c/span\x3e\r\n\r\n            \x3c!-- Geocode Type --\x3e\r\n            \x3cfieldset class\x3d"fieldset-radio locate-features-using"\x3e\r\n                \x3clegend class\x3d"font-size-0"\x3e${i18n.addItemFrm.locateUsing}\x3c/legend\x3e\r\n                \x3clabel class\x3d"inline-block margin-right-half"\x3e\r\n                    \x3cinput type\x3d"radio" name\x3d"geocode" value\x3d"coordinates" data-dojo-attach-point\x3d"radio-coordinates"\x3e ${i18n.addItemFrm.latLong}\r\n                \x3c/label\x3e\r\n                \x3clabel class\x3d"inline-block margin-right-half"\x3e\r\n                    \x3cinput type\x3d"radio" name\x3d"geocode" value\x3d"address" data-dojo-attach-point\x3d"radio-address"\x3e ${i18n.addItemFrm.address}\r\n                \x3c/label\x3e\r\n                \x3clabel class\x3d"inline-block margin-right-half"\x3e\r\n                    \x3cinput type\x3d"radio" name\x3d"geocode" value\x3d"none" data-dojo-attach-point\x3d"radio-none"\x3e ${i18n.addItemFrm.table}\r\n                \x3c/label\x3e\r\n            \x3c/fieldset\x3e\r\n\r\n            \x3c!-- Geocoders --\x3e\r\n            \x3clabel class\x3d"padding-right-1 trailer-half if-location js-geocoders hide" for\x3d"geocoder"\x3e${i18n.addItemFrm.selectGeocoder}\x3c/label\x3e\r\n            \x3cspan class\x3d"inline-block align-middle trailer-half if-location js-geocoders hide"\x3e\r\n              \x3cselect id\x3d"geocoder" data-dojo-attach-point\x3d"_geocoders" class\x3d"leader-0 js-run-analyze"\x3e\x3c/select\x3e\r\n            \x3c/span\x3e\r\n\r\n            \x3c!-- Countries --\x3e\r\n            \x3clabel class\x3d"padding-right-1 trailer-half if-location js-countries hide" for\x3d"country"\x3e${i18n.addItemFrm.country}\x3c/label\x3e\r\n            \x3cspan class\x3d"inline-block align-middle trailer-half if-location js-countries hide"\x3e\r\n              \x3cselect id\x3d"country" data-dojo-attach-point\x3d"_countries" class\x3d"leader-0 js-run-analyze"\x3e\x3c/select\x3e\r\n            \x3c/span\x3e\r\n\r\n            \x3c!-- Table View --\x3e\r\n            \x3cdiv class\x3d"flex-0 break-word border-box text-ellipsis trailer-half js-view"\r\n                 data-dojo-attach-point\x3d"_reviewLabel"\x3e${i18n.addItemFrm.review}\x3c/div\x3e\r\n            \x3cdiv class\x3d"js-table-wrap table-select trailer-half js-view" role\x3d"table"\x3e\r\n                \x3cdiv class\x3d"table-select-head js-table-header" role\x3d"rowgroup"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"table-select-rows js-table-rows js-view" role\x3d"rowgroup"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3c!-- TimeZone --\x3e\r\n            \x3cdiv class\x3d"trailer-1 js-view"\x3e\r\n                  \x3clabel class\x3d"padding-right-1 trailer-half" for\x3d"timezone"\x3e${i18n.addItemFrm.timeZone}\x3c/label\x3e\r\n                  \x3cspan class\x3d"inline-block align-middle"\x3e\r\n                    \x3cselect id\x3d"timezone" data-dojo-attach-point\x3d"_timeZones" class\x3d"leader-0"\x3e\x3c/select\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan\x3e\x3c/span\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3c!-- Loader --\x3e\r\n            \x3cdiv class\x3d"hide analyze-loader-wrap js-analyze-loader-wrap"\x3e\x3c/div\x3e\r\n\r\n        \x3c/main\x3e\r\n    \x3c/section\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_table-head.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n    \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"field" data-sort-order\x3d"asc"\x3e${i18n.addItemFrm.fieldName}\x3c/button\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"type" data-sort-order\x3d"asc"\x3e${i18n.addItemFrm.fieldType}\x3c/button\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"location" data-sort-order\x3d"desc"\x3e${i18n.addItemFrm.locationFields}\x3c/button\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_table-head-no-location.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n    \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"field" data-sort-order\x3d"asc"\x3e${i18n.addItemFrm.fieldName}\x3c/button\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"type" data-sort-order\x3d"asc"\x3e${i18n.addItemFrm.fieldType}\x3c/button\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_table-row-no-location.html":'\x3cdiv class\x3d"table-select-row" role\x3d"row"\x3e\r\n  \x3c!-- Field Name --\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-field text-ellipsis"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width display-block"\x3e${field.name}\x3c/span\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n  \x3c!-- Field Type --\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-type text-ellipsis" data-dojo-attach-point\x3d"_fieldTypeContainer"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width" data-value\x3d"${field.type}"\x3e${field.type:_getFieldType}\x3c/span\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"_fieldTypes" class\x3d"leader-0 hide"\x3e\x3c/select\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_table-head-no-type.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n    \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort-order\x3d"asc"\x3e${i18n.addItemFrm.fieldName}\x3c/button\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort-order\x3d"desc"\x3e${i18n.addItemFrm.locationFields}\x3c/button\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_table-row-no-type.html":'\x3cdiv class\x3d"table-select-row" role\x3d"row"\x3e\r\n  \x3c!-- Field Name --\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-field text-ellipsis"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width display-block"\x3e${field.name}\x3c/span\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n    \x3c!-- Location Type --\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-location text-ellipsis" data-dojo-attach-point\x3d"_locationFieldContainer"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width" data-value\x3d"${field.locationType}"\x3e${field.locationType:_getLocationType}\x3c/span\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"_locationFields" class\x3d"leader-0 hide"\x3e\x3c/select\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_table-head-no-location-no-type.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n    \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"field" data-sort-order\x3d"asc"\x3e${i18n.addItemFrm.fieldName}\x3c/button\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/sharing/dijit/AnalyzeResults/templates/_table-row-no-location-no-type.html":'\x3cdiv class\x3d"table-select-row" role\x3d"row"\x3e\r\n  \x3c!-- Field Name --\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-field text-ellipsis"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width display-block"\x3e${field.name}\x3c/span\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/ConnectDataset.html":'\x3cdiv class\x3d"${baseClass}"\x3e\r\n   \x3c!-- data-dojo-attach-point\x3d"contentNode"\x3e --\x3e\r\n\r\n  \x3cdiv class\x3d"page1 changeOpacity divClickable"\x3e\r\n    \x3cbutton class\x3d"googleConnect connectButton btn btn-transparent"\x3e\x3c/button\x3e\r\n    \x3cbutton class\x3d"dropBoxConnect connectButton btn btn-transparent"\x3e\x3c/button\x3e\r\n    \x3cbutton class\x3d"oneDriveConnect connectButton btn btn-transparent"\x3e\x3c/button\x3e\r\n    \x3c!--Hide till box oauth is fixed\r\n     \x3cbr\x3e\x3cbr\x3e\r\n    \x3cbutton class\x3d"boxConnect connectButton btn btn-transparent"\x3e\x3c/button\x3e --\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"page2 changeOpacity divClickable hide"\x3e\r\n    \x3cinput type\x3d"search" placeholder\x3d"${i18n.connectDataset.searchPlaceholder}" aria-label\x3d"${i18n.connectDataset.searchPlaceholder}" class\x3d"searchCloudDrive flex-1 input-minimal"\x3e\r\n    \x3cselect class\x3d"modifier-class dropdownCloud"\x3e\r\n    \x3c/select\x3e\r\n\r\n    \x3ctable class\x3d"listExternalItemsTable modifier-class table-striped"\x3e\r\n      \x3cthead\x3e\r\n        \x3ctr\x3e\r\n          \x3cth\x3e${i18n.connectDataset.tableFileName}\x3c/th\x3e\r\n          \x3cth\x3e${i18n.connectDataset.tableFileType}\x3c/th\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/thead\x3e\r\n    \x3c/table\x3e\r\n\r\n    \x3cbutton class\x3d"page2BackButton backButton btn btn-transparent"\x3e${i18n.connectDataset.backButton}\x3c/button\x3e\r\n\r\n    \x3cdiv class\x3d"paginationCloud text-center trailer-1 leader-1"\x3e\r\n      \x3cbutton class\x3d"previousButton btn btn-transparent btn-arrow"\x3e${i18n.connectDataset.previousPageButton}\x3c/button\x3e\r\n      \x3cbutton class\x3d"nextButton btn btn-transparent btn-arrow"\x3e${i18n.connectDataset.nextPageButton}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"page3 changeOpacity divClickable hide"\x3e\r\n    \x3cdiv id\x3d"itemPropertiesDlgAddon"\x3e\x3c/div\x3e\r\n    \x3cdiv id\x3d"analyzeResultsAddon"\x3e\x3c/div\x3e\r\n    \x3cbutton class\x3d"publishButton right btn"\x3e${i18n.connectDataset.publishButton}\x3c/button\x3e\r\n    \x3cbutton class\x3d"page3BackButton left backButton btn btn-transparent"\x3e${i18n.connectDataset.backButton}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3c!-- Loader --\x3e\r\n  \x3cdiv class\x3d"loader loader-connectDataset is-active hide padding-leader-3 padding-trailer-3"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text"\x3e${i18n.connectDataset.defaultLoading}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/DatastoreCloudMenu.html":'\x3cdiv\x3e\r\n  \x3c!-- Cloud Store type \x26 provider--\x3e\r\n  \x3cdiv class\x3d"cloudstore-types"\x3e\r\n    \x3cfieldset class\x3d"fieldset-radio"\x3e\r\n      \x3clegend class\x3d"cloudstore-legend"\x3e${i18n.cloudStorageProviderTitle}\x3c/legend\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"cloudStoreContent"\x3e\x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:arcgisonline/sharing/dijit/templates/DataStoreNoSQLMenu.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"noSQL-types"\x3e\r\n      \x3cfieldset class\x3d"fieldset-radio"\x3e\r\n        \x3clegend class\x3d"noSQL-legend"\x3e${i18n.nosqlInfo}\x3c/legend\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"noSQLContent"\x3e\x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n\r\n',
"url:arcgisonline/sharing/dijit/templates/DatastoreBDFSSettings.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"datastore-connection"\x3e\r\n        \x3clabel for\x3d"bdfs-general-description"\x3e\r\n            \x3cdiv id\x3d"bdfs-general-description" class\x3d"generalDescription"\x3e\r\n                ${i18n.bdfsConfigurationGuide}\r\n            \x3c/div\x3e\r\n        \x3c/label\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"bdfs-types"\x3e\r\n        \x3cfieldset class\x3d"fieldset-radio"\x3e\r\n            \x3clabel class\x3d"bdfs-type"\x3e\r\n                \x3cinput type\x3d"radio" name\x3d"bdfsType" value\x3d"fileshare"\x3e\r\n                \x3cspan class\x3d"bdfs-type-text"\x3e\r\n                    \x3cspan class\x3d"bdfs-type-label"\x3e${i18n.fileShare}\x3c/span\x3e\r\n                    \x3cspan class\x3d"bdfs-type-description"\x3e${i18n.fileShareDescription}\x3c/span\x3e\r\n                \x3c/span\x3e\r\n            \x3c/label\x3e\r\n            \x3clabel class\x3d"bdfs-type"\x3e\r\n                \x3cinput type\x3d"radio" name\x3d"bdfsType" value\x3d"hdfs"\x3e\r\n                \x3cspan class\x3d"bdfs-type-text"\x3e\r\n                    \x3cspan class\x3d"bdfs-type-label"\x3e${i18n.HDFS}\x3c/span\x3e\r\n                    \x3cspan class\x3d"bdfs-type-description"\x3e${i18n.HDFSDescription}\x3c/span\x3e\r\n                \x3c/span\x3e\r\n            \x3c/label\x3e\r\n            \x3clabel class\x3d"bdfs-type"\x3e\r\n                \x3cinput type\x3d"radio" name\x3d"bdfsType" value\x3d"hive"\x3e\r\n                \x3cspan class\x3d"bdfs-type-text"\x3e\r\n                    \x3cspan class\x3d"bdfs-type-label"\x3e${i18n.hive}\x3c/span\x3e\r\n                    \x3cspan class\x3d"bdfs-type-description"\x3e${i18n.hiveDescription}\x3c/span\x3e\r\n                \x3c/span\x3e\r\n            \x3c/label\x3e\r\n            \x3clabel class\x3d"bdfs-type"\x3e\r\n                \x3cinput type\x3d"radio" name\x3d"bdfsType" value\x3d"bdfsCloud"\x3e\r\n                \x3cspan class\x3d"bdfs-type-text"\x3e\r\n                    \x3cspan class\x3d"bdfs-type-label"\x3e${i18n.cloud}\x3c/span\x3e\r\n                    \x3cspan class\x3d"bdfs-type-description"\x3e${i18n.bdfsCloudDescription}\x3c/span\x3e\r\n                \x3c/span\x3e\r\n            \x3c/label\x3e\r\n        \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/templates/DatastoreBDFSCloudMenu.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"datastore-connection"\x3e\r\n        \x3cfieldset class\x3d"fieldset-radio"\x3e\r\n            \x3clegend\x3e${i18n.datastoreType}\x3c/legend\x3e\r\n            \x3clabel class\x3d"cloudStoreTypeLabel"\x3e\x3cinput type\x3d"radio" \r\n                name\x3d"cloudStoreType" value\x3d"new"\x3e${i18n.newCloudStoreLabel}\x3c/label\x3e\r\n            \x3clabel class\x3d"cloudStoreTypeLabel"\x3e\x3cinput type\x3d"radio" \r\n                name\x3d"cloudStoreType" value\x3d"existing"\x3e${i18n.existingCloudStoreLabel}\x3c/label\x3e\r\n        \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- bdfs cloud menu: amazon \x26\x26 azure --\x3e\r\n    \x3cdiv class\x3d"cloudstore-types"\x3e\r\n        \x3cdiv class\x3d"bdfsNewCloudStoreOptionWrapper hide" data-dojo-attach-point\x3d"bdfsNewCloudStoreOptionWrapper"\x3e\r\n            \x3cfieldset class\x3d"fieldset-radio"\x3e\r\n                \x3clegend\x3e${i18n.cloudStorageProviderTitle}\x3c/legend\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"bdfsCloudStoreContent"\x3e\x3c/div\x3e\r\n            \x3c/fieldset\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"datastore-connection"\x3e\r\n        \x3clabel for\x3d"bdfsExistingCloudStoreOption" class\x3d"cloudStore-options bdfs hide"\r\n            data-dojo-attach-point\x3d"bdfsExistingCloudStoreOptionWrapper"\x3e\r\n            \x3clegend\x3e${i18n.existingCloudStoreDropdownMenu}\x3c/legend\x3e\r\n            \x3cdiv class\x3d"bdfsExistingCloudStoreOption" data-dojo-attach-point\x3d"bdfsExistingCloudStoreOption"\x3e\x3c/div\x3e\r\n        \x3c/label\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/templates/DatastoreBDFSCloudSettings.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"datastore-connection"\x3e\r\n    \x3clabel for\x3d"datastore-cloud-general-description"\x3e\r\n      \x3cdiv id\x3d"datastore-cloud-general-description" class\x3d"generalDescription"\x3e\r\n        ${i18n.configurationGuide}\r\n      \x3c/div\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3c!-- bdfs content --\x3e\r\n  \x3cdiv class\x3d"datastore-connection"\x3e\r\n    \x3clabel for\x3d"bdfsCloudStoreOption" class\x3d"cloudStore-options"\x3e\r\n      ${i18n.cloudStoreOption}\r\n      \x3cdiv\x3e\r\n        \x3cinput id\x3d"bdfsCloudStoreOption" type\x3d"text" data-dojo-attach-point\x3d"bdfsCloudStoreOption" disabled/\x3e\r\n      \x3c/div\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"datastore-connection"\x3e\r\n    \x3cdiv class\x3d"hide cloudStoreRegistrationUI" data-dojo-attach-point\x3d"bdfsCloudStoreRegistrationUI"\x3e\r\n      \x3cdiv class\x3d"amazon"\x3e\r\n        \x3clabel for\x3d"bdfsCredentialType"\x3e\r\n          ${i18n.credentialType}\r\n          \x3cdiv\x3e\r\n            \x3cselect class\x3d"cloud-ui-select" id\x3d"bdfsCredentialType" data-dojo-attach-point\x3d"bdfsCredentialType"\r\n              data-dojo-attach-event\x3d"onChange: _onCredentialTypeChange"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"azure"\x3e\r\n        \x3clabel for\x3d"bdfsAccountName"\x3e\r\n          ${i18n.accountName}\r\n          \x3cdiv\x3e\r\n            \x3cinput id\x3d"bdfsAccountName" type\x3d"text" data-dojo-attach-point\x3d"bdfsAccountName" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"azure"\x3e\r\n        \x3clabel for\x3d"bdfsAccountKey"\x3e\r\n          ${i18n.accountKey}\r\n          \x3cdiv\x3e\r\n            \x3cinput id\x3d"bdfsAccountKey" type\x3d"password" data-dojo-attach-point\x3d"bdfsAccountKey" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"amazon"\x3e\r\n        \x3clabel class\x3d"credential-type-change-connect" for\x3d"bdfsAccessKeyId"\x3e\r\n          ${i18n.accessKeyId}\r\n          \x3cdiv\x3e\r\n            \x3cinput id\x3d"bdfsAccessKeyId" type\x3d"text" data-dojo-attach-point\x3d"bdfsAccessKeyId" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"amazon"\x3e\r\n        \x3clabel class\x3d"credential-type-change-connect" for\x3d"bdfsSecretKeyId"\x3e\r\n          ${i18n.secretKeyId}\r\n          \x3cdiv\x3e\r\n            \x3cinput id\x3d"bdfsSecretKeyId" type\x3d"password" data-dojo-attach-point\x3d"bdfsSecretKeyId" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"amazon"\x3e\r\n        \x3clabel for\x3d"bdfsRegion"\x3e\r\n          ${i18n.region}\r\n          \x3cdiv\x3e\r\n            \x3cselect class\x3d"cloud-ui-select" id\x3d"bdfsRegion" data-dojo-attach-point\x3d"bdfsRegion"\r\n              data-dojo-attach-event\x3d"onChange: _showPrivateURL"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"azure"\x3e\r\n        \x3clabel for\x3d"bdfsEnvironment"\x3e\r\n          ${i18n.environment}\r\n          \x3cdiv\x3e\r\n            \x3cselect class\x3d"cloud-ui-select" id\x3d"bdfsEnvironment" data-dojo-attach-point\x3d"bdfsEnvironment"\r\n              data-dojo-attach-event\x3d"onChange: _showPrivateURL"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"privateUrl"\x3e\r\n        \x3clabel for\x3d"bdfsStorageURL"\x3e\r\n          ${i18n.storageURL}\r\n          \x3cdiv\x3e\r\n            \x3cinput id\x3d"bdfsStorageURL" type\x3d"text" data-dojo-attach-point\x3d"bdfsStorageURL" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"azure"\x3e\r\n        \x3clabel for\x3d"bdfsContainerName"\x3e\r\n          ${i18n.containerName}\r\n          \x3cdiv\x3e\r\n            \x3cinput id\x3d"bdfsContainerName" type\x3d"text" data-dojo-attach-point\x3d"bdfsContainerName" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"amazon"\x3e\r\n        \x3clabel for\x3d"bdfsBucketName"\x3e\r\n          ${i18n.bucketName}\r\n          \x3cdiv\x3e\r\n            \x3cinput id\x3d"bdfsBucketName" type\x3d"text" data-dojo-attach-point\x3d"bdfsBucketName" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"amazon azure" data-dojo-attach-point\x3d"bdfsCloudFolderContainer"\x3e\r\n        \x3clabel for\x3d"bdfsCloudFolder"\x3e\r\n          ${i18n.cloudfolder}\r\n          \x3cdiv\x3e\r\n            \x3cinput type\x3d"text" id\x3d"bdfsCloudFolder" data-dojo-attach-point\x3d"bdfsCloudFolder" placeholder\x3d"${i18n.cloudFolderPlaceHolder}" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/AddDatastoreDlg.html":'\x3cdiv\x3e\r\n    \x3cform data-dojo-attach-point\x3d"containerNode" class\x3d"data-store-form" enctype\x3d"multipart/form-data" action\x3d""\r\n        method\x3d"POST" autocomplete\x3d"off" data-dojo-attach-event\x3d"onsubmit:onSubmit"\x3e\r\n        \x3cdiv class\x3d"clearfix"\x3e\r\n            \x3cdiv class\x3d"step-container step-1" data-dojo-attach-point\x3d"containerStep1Node"\x3e\r\n                \x3cdiv class\x3d"datastore-types"\x3e\r\n                    \x3cfieldset class\x3d"fieldset-radio"\x3e\r\n                        \x3clegend class\x3d"datastore-legend"\x3e${i18n.datastoreType}\x3c/legend\x3e\r\n                        \x3clabel class\x3d"datastore-type"\x3e\r\n                            \x3cinput type\x3d"radio" name\x3d"datastoreType" value\x3d"folder"\x3e\r\n                            \x3cspan class\x3d"datastore-type-text"\x3e\r\n                                \x3cspan class\x3d"datastore-type-label"\x3e${i18n.folder}\x3c/span\x3e\r\n                                \x3cspan class\x3d"datastore-type-description"\x3e${i18n.folderDescription}\x3c/span\x3e\r\n                            \x3c/span\x3e\r\n                        \x3c/label\x3e\r\n                        \x3clabel class\x3d"datastore-type"\x3e\r\n                            \x3cinput type\x3d"radio" name\x3d"datastoreType" value\x3d"database"\x3e\r\n                            \x3cspan class\x3d"datastore-type-text"\x3e\r\n                                \x3cspan class\x3d"datastore-type-label"\x3e${i18n.database}\x3c/span\x3e\r\n                                \x3cspan class\x3d"datastore-type-description"\x3e${i18n.databaseDescription}\x3c/span\x3e\r\n                            \x3c/span\x3e\r\n                        \x3c/label\x3e\r\n                        \x3clabel class\x3d"datastore-type"\x3e\r\n                            \x3cinput type\x3d"radio" name\x3d"datastoreType" value\x3d"cloud"\r\n                                data-dojo-attach-point\x3d"cloudContainerNode"\x3e\r\n                            \x3cspan class\x3d"datastore-type-text"\x3e\r\n                                \x3cspan class\x3d"datastore-type-label"\x3e${i18n.cloud}\x3c/span\x3e\r\n                                \x3cspan class\x3d"datastore-type-description"\x3e${i18n.cloudDescription}\x3c/span\x3e\r\n                            \x3c/span\x3e\r\n                        \x3c/label\x3e\r\n                        \x3clabel class\x3d"datastore-type hide"\x3e\r\n                            \x3cinput type\x3d"radio" name\x3d"datastoreType" value\x3d"bigdata"\r\n                                data-dojo-attach-point\x3d"bigdataContainerNode"\x3e\r\n                            \x3cspan class\x3d"datastore-type-text"\x3e\r\n                                \x3cspan class\x3d"datastore-type-label"\x3e${i18n.bigdata}\x3c/span\x3e\r\n                                \x3cspan class\x3d"datastore-type-description"\x3e${i18n.bigdataDescription}\x3c/span\x3e\r\n                            \x3c/span\x3e\r\n                        \x3c/label\x3e\r\n                        \x3clabel class\x3d"datastore-type hide"\x3e\r\n                            \x3cinput type\x3d"radio" name\x3d"datastoreType" value\x3d"noSQL"\r\n                                data-dojo-attach-point\x3d"noSQLContainerNode"\x3e\r\n                            \x3cspan class\x3d"datastore-type-text"\x3e\r\n                                \x3cspan class\x3d"datastore-type-label"\x3e${i18n.nosql}\x3c/span\x3e\r\n                                \x3cspan class\x3d"datastore-type-description"\x3e${i18n.nosqlDescription}\x3c/span\x3e\r\n                            \x3c/span\x3e\r\n                        \x3c/label\x3e\r\n                    \x3c/fieldset\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"step-2"\x3e\r\n                \x3c!-- widget goes here --\x3e\r\n                \x3cdiv class\x3d"step-container step-2-folder hide" data-dojo-attach-point\x3d"step2FolderContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-database hide" data-dojo-attach-point\x3d"step2databaseContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-cloud hide" data-dojo-attach-point\x3d"step2CloudMenuContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-noSQL hide" data-dojo-attach-point\x3d"step2NoSQLMenuContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-bigdata hide" data-dojo-attach-point\x3d"step2BDSFContainer"\x3e\x3c/div\x3e\r\n\r\n                \x3cdiv class\x3d"step-container step-2-cloudItem hide" data-dojo-attach-point\x3d"step2CloudContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-noSQLItem hide" data-dojo-attach-point\x3d"step2NoSQLContainer"\x3e\x3c/div\x3e\r\n\r\n                \x3c!-- 4 sub-widgets of BDFS go here --\x3e\r\n                \x3cdiv class\x3d"step-container step-2-fileshare hide" data-dojo-attach-point\x3d"step2FileShareContainer"\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-hdfs hide" data-dojo-attach-point\x3d"step2HDFSContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-hive hide" data-dojo-attach-point\x3d"step2HiveContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-bdfsCloudMenu hide"\r\n                    data-dojo-attach-point\x3d"step2BDFSCloudMenuContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"step-container step-2-bdfsCloud hide" data-dojo-attach-point\x3d"step2BDFSCloudContainer"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"step-container step-3 hide"\x3e\r\n                \x3cdiv class\x3d"datastore-connection serverConfiguration"\x3e\r\n                    \x3clabel for\x3d"datastore-cloud-general-description"\x3e\r\n                        \x3cdiv id\x3d"datastore-cloud-general-description" class\x3d"generalDescription step-info-container"\x3e\r\n                            ${i18n.configureServersInfo}\r\n                        \x3c/div\x3e\r\n                    \x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"alert alert-full alert-yellow" style\x3d"margin-top: -20px;"\r\n                    data-dojo-attach-point\x3d"folderKubernetesWarning"\x3e\r\n                    ${i18n.folderKubernetesWarning}\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"federatedServersGridContainer"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"errorNode" class\x3d"alert alert-red"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"loader padding-leader-3 padding-trailer-3" data-dojo-attach-point\x3d"loader"\x3e\r\n                \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"loader-text"\x3e${i18n.loading}\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"step-container step-4 hide"\x3e\r\n                \x3cdiv class\x3d"step-4-description"\x3e${i18n.step4Description}\x3c/div\x3e\r\n                \x3cdiv\x3e\r\n                    \x3ccalcite-label\x3e\r\n                        ${i18n.title}\r\n                        \x3ccalcite-input name\x3d"title" data-dojo-attach-point\x3d"itemTitle"\x3e\x3c/calcite-input\x3e\r\n                    \x3c/calcite-label\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"tags-container"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"folder-container trailer-1"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"categories-container hide trailer-1"\x3e\r\n                    \x3clabel data-dojo-attach-point\x3d"_categoriesLbl" class\x3d"trailer-0" for\x3d"addItemCategoryPicker"\x3e\r\n                        ${i18n.categories}\r\n                    \x3c/label\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_categoriesContainer" id\x3d"addItemCategoryPicker"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"summary-container"\x3e\r\n                    \x3clabel for\x3d"itemSummary"\x3e\r\n                        ${i18n.itemSummaryLabel}\r\n                        \x3cdiv\x3e\r\n                            \x3ctextarea id\x3d"itemSummary" name\x3d"itemSummary" rows\x3d"3" cols\x3d"20" data-dojo-attach-point\x3d"itemSummary"\r\n                                placeholder\x3d"${i18n.itemSummaryPlaceholder}"\x3e\x3c/textarea\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n    \x3cdiv class\x3d"action-buttons"\x3e\r\n        \x3cbutton class\x3d"btn btn-transparent hide" id\x3d"back-button" name\x3d"backButton"\r\n            data-dojo-attach-point\x3d"backButton"\x3e${i18n.backButton}\x3c/button\x3e\r\n        \x3cspan class\x3d"right"\x3e\r\n            \x3cbutton class\x3d"btn btn-clear" id\x3d"cancel-button" name\x3d"cancelButton"\r\n            data-dojo-attach-point\x3d"cancelButton"\x3e${i18n.cancelButton}\x3c/button\x3e\r\n            \x3cbutton class\x3d"btn hide" id\x3d"add-button" name\x3d"addButton" type\x3d"submit"\r\n                data-dojo-attach-point\x3d"addButton"\x3e${i18n.addButton}\x3c/button\x3e\r\n            \x3cbutton class\x3d"btn" id\x3d"next-button" name\x3d"nextButton"\r\n                data-dojo-attach-point\x3d"nextButton"\x3e${i18n.nextButton}\x3c/button\x3e\r\n            \x3ca href\x3d"#" class\x3d"btn hide" name\x3d"itemButton" data-dojo-attach-point\x3d"itemButton"\x3e${i18n.itemButton}\x3c/a\x3e\r\n        \x3c/span\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"js-modal modal-overlay modifier-class" data-modal\x3d"foo" data-dojo-attach-point\x3d"nfsModal"\x3e\r\n        \x3cdiv class\x3d"modal-content column-12" role\x3d"dialog" aria-labelledby\x3d"modal" role\x3d"dialog"\x3e\r\n\r\n          \x3ca class\x3d"js-modal-toggle right" href\x3d"#" aria-label\x3d"close-modal" data-dojo-attach-point\x3d"nfsModalXButton"\x3e\r\n            \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"30" height\x3d"21" viewBox\x3d"0 0 32 32" class\x3d"svg-icon"\x3e\x3cpath d\x3d"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/\x3e\x3c/svg\x3e\r\n          \x3c/a\x3e\r\n\r\n          \x3cp class\x3d"nfsModalText"\x3e${i18n.requiresServicesRestartModalText}\x3c/p\x3e\r\n\r\n          \x3cdiv class\x3d"text-right"\x3e\r\n              \x3cbutton class\x3d"btn btn-clear js-modal-toggle" data-dojo-attach-point\x3d"nfsModalCancelButton"\x3e${i18n.cancelButton}\x3c/button\x3e\r\n              \x3cbutton class\x3d"btn js-modal-toggle" data-dojo-attach-point\x3d"nfsModalOkButton"\x3e${i18n.okButton}\x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/CreateNotebookDlg.html":'\x3cdiv class\x3d"main-flex-container"\x3e\r\n  \x3cdiv class\x3d"trailer-half step-indicator-container hide" data-dojo-attach-point\x3d"stepIndicatorContainer"\x3e\r\n    \x3cdiv class\x3d"create-step active" id\x3d"step1"\x3e\r\n      \x3cdiv class\x3d"step-text"\x3e${i18n.step1}\x3c/div\x3e\r\n      \x3cdiv class\x3d"step-label"\x3e${i18n.step1Description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"create-step" id\x3d"step2"\x3e\r\n      \x3cdiv class\x3d"step-text"\x3e${i18n.step2}\x3c/div\x3e\r\n      \x3cdiv class\x3d"step-label"\x3e${i18n.step2Description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"content-container"\x3e\r\n    \x3cdiv class\x3d"step-container step-1 hide" data-dojo-attach-point\x3d"step1Container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"templateSelectionContainer" class\x3d"template-selection-container"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"step-container step-2 hide" data-dojo-attach-point\x3d"step2Container"\x3e\r\n      \x3cdiv\x3e\r\n        \x3clabel for\x3d"title"\x3e\r\n          ${i18n.title} \x3cinput type\x3d"text" name\x3d"title" data-dojo-attach-point\x3d"itemTitle" autofocus /\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"tags-container"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_tagsLbl" class\x3d"tagLbl" for\x3d"tags"\r\n          \x3e${i18n.itemTags}\r\n          \x3cinput\r\n            id\x3d"tags"\r\n            data-dojo-attach-point\x3d"_tags"\r\n            data-dojo-type\x3d"esri/dijit/Tags"\r\n            name\x3d"tags"\r\n          /\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"summary-container"\x3e\r\n        \x3clabel for\x3d""\x3e\r\n          ${i18n.summary}\r\n          \x3ctextarea\r\n            data-dojo-type\x3d"dijit/form/Textarea"\r\n            data-dojo-attach-point\x3d"_summary"\r\n            id\x3d"summaryTextArea"\r\n          \x3e\x3c/textarea\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide" data-dojo-attach-point\x3d"notebookRuntimeContainer"\x3e\r\n        \x3clabel for\x3d"runtime"\x3e\r\n          ${i18n.runtime}\r\n          \x3cselect data-dojo-attach-point\x3d"notebookRuntimeSelect"\x3e\x3c/select\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"folder-container trailer-1"\x3e\r\n        \x3clabel for\x3d"folder" class\x3d"trailer-0"\x3e ${i18n.folder} \x3c/label\x3e\r\n        \x3cselect\r\n          data-dojo-type\x3d"dijit/form/Select"\r\n          id\x3d"create-notebook-dlg-folder"\r\n          name\x3d"create-notebook-dlg-folder"\r\n          data-dojo-id\x3d"create-notebook-dlg-folder"\r\n          style\x3d"width: 99.5% !important;"\r\n          class\x3d"folderDropdownSelect folderDropdown"\r\n          data-dojo-attach-point\x3d"_folders"\r\n          data-dojo-props\x3d\'maxHeight: "200"\'\r\n        \x3e\x3c/select\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"categories-container hide trailer-1"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_categoriesLbl" class\x3d"trailer-0" for\x3d"addItemCategoryPicker"\x3e\r\n          ${i18n.categories}\r\n        \x3c/label\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_categoriesContainer" id\x3d"addItemCategoryPicker"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"errorNode" class\x3d"alert alert-red"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader padding-leader-3 padding-trailer-3" data-dojo-attach-point\x3d"loader"\x3e\r\n      \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"loader-text"\x3e${i18n.loading}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"action-buttons"\x3e\r\n    \x3cbutton class\x3d"btn btn-transparent hide" id\x3d"back-button" name\x3d"backButton" data-dojo-attach-point\x3d"backButton"\x3e\r\n      ${i18n.backButton}\r\n    \x3c/button\x3e\r\n    \x3cspan class\x3d"right"\x3e\r\n      \x3cbutton class\x3d"btn hide" id\x3d"add-button" name\x3d"addButton" type\x3d"submit" data-dojo-attach-point\x3d"addButton"\x3e\r\n        ${i18n.addButton}\r\n      \x3c/button\x3e\r\n      \x3cbutton class\x3d"btn" id\x3d"next-button" name\x3d"nextButton" data-dojo-attach-point\x3d"nextButton"\x3e\r\n        ${i18n.nextButton}\r\n      \x3c/button\x3e\r\n      \x3cbutton class\x3d"btn btn-clear" id\x3d"cancel-button" name\x3d"cancelButton" data-dojo-attach-point\x3d"cancelButton"\x3e\r\n        ${i18n.cancelButton}\r\n      \x3c/button\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/CreateImageryContent/templates/CreateImageryContent.html":'\x3cdiv class\x3d"flex create-imagery"\x3e\r\n    \x3ciframe class\x3d"js-iframe flex-1 create-imagery__iframe" \x3e\x3c/iframe\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/dijit/CreateRasterFunctionTemplate/templates/CreateRasterFunctionTemplate.html":'\x3cdiv class\x3d"flex create-raster-function-template"\x3e\x3c/div\x3e\r\n',"url:arcgisonline/pages/dijit/View/templates/tableHeader.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-checkbox ${selectClass}" role\x3d"columnheader"\x3e\r\n    \x3clabel class\x3d"table-select-cell-sort table-select-check-all"\x3e\r\n      \x3cinput type\x3d"checkbox" aria-label\x3d"${i18n.filters.selectAll}" class\x3d"js-select-all" /\x3e\r\n    \x3c/label\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader" title\x3d"${i18n.filters.titleHeader}"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header js-title-header" data-sort\x3d"title" data-sort-order\x3d"asc"\x3e\r\n      ${i18n.filters.titleHeader}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan\r\n    class\x3d"table-select-cell table-select-cell-th table-select-cell-medium"\r\n    role\x3d"columnheader"\r\n    title\x3d"${i18n.filters.modifiedHeader}"\r\n  \x3e\r\n    \x3cbutton\r\n      class\x3d"table-select-cell-sort js-table-sort-header js-modified-header"\r\n      data-sort\x3d"modified"\r\n      data-sort-order\x3d"desc"\r\n    \x3e\r\n      ${i18n.filters.modifiedHeader}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan\r\n    class\x3d"table-select-cell table-select-cell-th table-select-cell-small js-recycle-size hide table-select-size"\r\n    role\x3d"columnheader"\r\n    title\x3d"${i18n.filters.sizeHeader}"\r\n  \x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"size" data-sort-order\x3d"desc"\x3e\r\n      ${i18n.filters.sizeHeader}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan\r\n    class\x3d"table-select-cell table-select-cell-th table-laptop-show table-select-cell-medium-small js-owner-sort"\r\n    role\x3d"columnheader"\r\n    title\x3d"${i18n.filters.owner}"\r\n  \x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header js-owner-header" data-sort\x3d"owner" data-sort-order\x3d"asc"\x3e\r\n      ${i18n.filters.owner}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/View/templates/empty.html":'\x3cdiv class\x3d"js-empty-view text-center"\x3e\r\n    \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 256 256" width\x3d"256"\x3e\x3cpath fill\x3d"#ccc" d\x3d"M149.375 182.444l56.463-56.471-25.376-25.376 5.523-14.541-59.827-22.726L110.828 48H56v124h18.365l12.437 4.724 34.182 34.101 15.33-15.294 7.07 2.686 5.164-13.597zm50.806-56.472l-47.34 47.35 26.064-68.626zM112 54.828L141.172 84H112zM60 52h48v36h36v80H60zm60.984 153.17L95.95 180.199l36.263 13.775zm20.081-12.113L85.632 172H148V85.172L133.059 70.23l47.766 18.144-34.628 91.171z"/\x3e\x3c/svg\x3e\r\n    \x3ch3\x3e${i18n.GroupWidget.noItemsYet}\x3c/h3\x3e\r\n    \x3cp class\x3d"font-size--2 text-constrain margin-auto"\x3e${i18n.GroupWidget.noItemsYetExplanation}\x3c/p\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/View/templates/none.html":'\x3cdiv class\x3d"text-center leader-1 text-constrain margin-auto"\x3e${i18n.GroupWidget.noItems}\x3c/div\x3e',"url:arcgisonline/pages/dijit/View/templates/View.html":'\x3cdiv\x3e\r\n  \x3c!-- Table View --\x3e\r\n  \x3cdiv class\x3d"hide content-table-view js-table-wrap table-select js-view" role\x3d"table"\x3e\r\n    \x3cdiv class\x3d"table-select-head js-table-header" role\x3d"rowgroup"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"table-select-rows js-table-rows js-view" role\x3d"rowgroup"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3c!-- Grid View --\x3e\r\n  \x3cdiv\r\n    class\x3d"hide content-grid-view block-group block-group-4-up laptop-block-group-3-up tablet-block-group-2-up phone-block-group-1-up js-grid-wrap js-view"\r\n  \x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Mobile View --\x3e\r\n  \x3cdiv class\x3d"hide content-mobile-view block-group block-group-1-up js-mobile-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- List View --\x3e\r\n  \x3cdiv class\x3d"hide content-list_view block-group block-group-1-up js-list-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Empty View (no results) --\x3e\r\n  \x3cdiv class\x3d"hide js-empty-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- None View (tabula rasa) --\x3e\r\n  \x3cdiv class\x3d"hide js-none-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Loader --\x3e\r\n  \x3cdiv class\x3d"hide js-loader-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Gallery Grid View --\x3e\r\n  \x3cdiv\r\n    class\x3d"hide block-group block-group-4-up laptop-block-group-3-up tablet-block-group-2-up phone-block-group-1-up gallery-card-wrap js-gallery-wrap js-view"\r\n  \x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Gallery List View --\x3e\r\n  \x3cdiv class\x3d"hide block-group block-group-1-up  gallery-list-wrap js-gallery-list-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide js-search-feedback"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/DomainOverlay/templates/DomainOverlay.html":'\x3cdiv class\x3d"grid-container"\x3e\r\n  \x3cdiv class\x3d"loader loader-domains is-active hide"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text"\x3e${i18n.common.loading}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-domain-wrapper"\x3e\r\n    \x3cdiv class\x3d"column-16 pre-1 leader-1 trailer-1"\x3e\r\n      \x3cform action\x3d"" class\x3d"js-manage-domain-form" data-edit-id\x3d"manageDomainForm"\x3e\r\n        \x3cdiv class\x3d"js-coded-value"\x3e\r\n          \x3c!-- hidden button needed, so on "Enter" new entry is added --\x3e\r\n          \x3cbutton class\x3d"hide js-btn-add-coded-value"\x3e${i18n.domainOverlay.codedValueAddMore}\x3c/button\x3e\r\n          \x3cdiv class\x3d"js-manage-domain-coded-value"\x3e\x3c/div\x3e\r\n          \x3cbutton class\x3d"js-btn-add-coded-value btn-add-coded-value btn-link btn-link-darker-gray" aria-label\x3d"${i18n.domainOverlay.codedValueAddMoreBtnLabel}"\x3e${icons.inline.plus.16}${i18n.domainOverlay.codedValueAddMore}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-coded-range hide" value\x3d"actualRangeValues"\x3e\r\n          \x3cdiv class\x3d"flex phone-flex-column"\x3e\r\n            \x3cdiv class\x3d"flex-1 margin-right-2 full-width js-coded-range-input-wrap"\x3e\r\n              \x3clabel class\x3d"js-range-min trailer-quarter" for\x3d"domain-range-min"\x3e${i18n.domainOverlay.rangeMin}\x3c/label\x3e\r\n              \x3cinput id\x3d"domain-range-min" type\x3d"text" class\x3d"inline-block js-template-range-key input-template-range-key" name\x3d"rangeMinimum"\x3e\r\n              \x3cdiv class\x3d"js-domain-range-error input-error-message"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"flex-1 margin-right-2 full-width phone-leader-1 js-coded-range-input-wrap"\x3e\r\n              \x3clabel class\x3d"js-range-max trailer-quarter" for\x3d"domain-range-max"\x3e${i18n.domainOverlay.rangeMax}\x3c/label\x3e\r\n              \x3cinput id\x3d"domain-range-max" type\x3d"text" class\x3d"inline-block js-template-range-value input-template-range-value" name\x3d"rangeMaximum"\x3e\r\n              \x3cdiv class\x3d"js-domain-range-error input-error-message"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-domain-validation-message alert alert-red"\x3e\r\n          ${i18n.domainOverlay.errors.defaultValidationFailed}\r\n          \x3cbutton class\x3d"alert-close js-domain-validation-close btn-link btn-link-black"\x3e${icons.x.24}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/form\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"column-6 leader-1 padding-leader-half js-category-edit-explanation"\x3e\r\n      \x3clabel class\x3d\'js-domain-explanation\'\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/DomainOverlay/templates/CodedValueTemplate.html":'\x3cdiv class\x3d"template-div js-template-div ${id} flex"\x3e\r\n  \x3cdiv class\x3d"inline-block input-template-code-value"\x3e\r\n    \x3clabel class\x3d"trailer-0" for\x3d"storedValue"\x3e${i18n.domainOverlay.codedValueDescription}\x3c/label\x3e\r\n    \x3cinput id\x3d"storedValue" type\x3d"text" name\x3d"${id}" class\x3d"js-template-code-value" value\x3d"${codedValues.name}"\x3e\r\n    \x3cdiv class\x3d"js-domain-coded-error-value input-error-message input-value-error-message"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"inline-block input-template-code-key"\x3e\r\n    \x3clabel class\x3d"trailer-0" for\x3d"displayedValue"\x3e${i18n.domainOverlay.codedValueCode}\x3c/label\x3e\r\n    \x3cinput id\x3d"displayedValue" type\x3d"text" name\x3d"${id}" class\x3d"js-template-code-key" value\x3d"${codedValues.code}"\x3e\r\n    \x3cdiv class\x3d"js-domain-coded-error input-error-message input-key-error-message"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"inline-block leader-1"\x3e\r\n    \x3cbutton class\x3d"tooltip tooltip-right coded-value-delete-item inline-block js-template-delete button${id}" name\x3d"${id}" \x3e\r\n      \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 16 16" width\x3d"16" height\x3d"16"\x3e\x3cpath fill\x3d"#de2900" d\x3d"M2 4l1 12h9l1-12zm9.08 11H3.92L3.087 5h8.826zM5 6.4a.46.46 0 0 1 .5-.4.46.46 0 0 1 .5.4v7.2a.46.46 0 0 1-.5.4.46.46 0 0 1-.5-.4zm2 0a.46.46 0 0 1 .5-.4.46.46 0 0 1 .5.4v7.2a.46.46 0 0 1-.5.4.46.46 0 0 1-.5-.4zm2 0a.512.512 0 0 1 1 0v7.2a.512.512 0 0 1-1 0zM11 2V0H4v2H1v1h13V2zm-1 0H5V1h5z"/\x3e\x3c/svg\x3e\r\n    \x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"inline-block leader-1"\x3e\r\n    \x3cmark class\x3d"label inline-block modifier-class js-template-code-count label-template-code-count"\x3e${codedValues.count}\x3c/mark\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/DomainOverlay/templates/_generateOrDelete.html":'\x3cnav class\x3d"leader-quarter left margin-left-1"\x3e\r\n  \x3cbutton class\x3d"js-domain-generate-button btn"\x3e${i18n.domainOverlay.generateDefault}\x3c/button\x3e\r\n  \x3cbutton class\x3d"js-domain-delete-button btn btn-red"\x3e${i18n.domainOverlay.deleteDefault}\x3c/button\x3e\r\n\x3c/nav\x3e',"url:arcgisonline/pages/dijit/AttributeFieldDetails/templates/AttributeFieldDetails.html":'\x3cdiv class\x3d"js-attributes-details trailer-half"\x3e\r\n\r\n  \x3c!-- display name - label --\x3e\r\n  \x3cdiv class\x3d"field-details-header flex"\x3e\r\n    \x3cdiv class\x3d"flex-1 padding-leader-half padding-left-1 padding-trailer-half"\x3e\r\n      \x3cdiv class\x3d"js-attribute-title-edit"\x3e\r\n        \x3c!-- Container for title InlineEdit --\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cbutton class\x3d"js-close-attribute-details flex-0 btn btn-transparent focus-inset btn-link-black right" aria-label\x3d"${i18n.attributeFieldDetails.closeDetails}"\x3e${!icons.x.32}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3caside class\x3d"flex tablet-flex-column padding-trailer-1 padding-leader-1"\x3e\r\n    \x3cdiv class\x3d"flex-1 padding-left-1 padding-right-1"\x3e\r\n      \x3cdiv class\x3d"js-description-section"\x3e\r\n        \x3c!-- Container for description InlineEdit --\x3e\r\n        \x3ch3 class\x3d"leader-0"\x3e\r\n          ${i18n.attributeFieldDetails.description}\r\n        \x3c/h3\x3e\r\n        \x3cp class\x3d"trailer-half break-word"\x3e\r\n          \x3cspan class\x3d"js-view js-fieldDescription break-word"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"js-noFieldDescription text-darker-gray trailer-half"\x3e\r\n            \x3cspan\x3e${i18n.itemProperties.summaryUnavailable}\x3c/span\x3e\r\n            \x3c!-- \x3ca href\x3d"#" class\x3d"js-inline-edit field-admin-owner-view" data-edit-id\x3d"description"\x3e${i18n.itemProperties.noSummary}\x3c/a\x3e --\x3e\r\n          \x3c/span\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"js-fieldValueType-section"\x3e\r\n        \x3c!-- Container for fieldValueType InlineEdit --\x3e\r\n        \x3ch3 class\x3d"leader-half" data-dojo-attach-point\x3d"fieldValueTypeText"\x3e\x3c/h3\x3e\r\n        \x3cp class\x3d"trailer-half break-word"\x3e\r\n          \x3cspan class\x3d"js-view js-fieldValueType break-word"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"js-noFieldValueType text-darker-gray trailer-half"\x3e\r\n            \x3cspan\x3e${i18n.attributeFieldDetails.contentUnavailable}\x3c/span\x3e\r\n            \x3c!-- \x3ca href\x3d"#" class\x3d"js-inline-edit field-admin-owner-view" data-edit-id\x3d"contentType"\x3e${i18n.attributeFieldDetails.contentUnavailable}\x3c/a\x3e --\x3e\r\n          \x3c/span\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n      \x3ch3 class\x3d"trailer-half"\x3e${i18n.attributeFieldDetails.serviceSettings}\x3c/h3\x3e\r\n      \x3ctable class\x3d"feature-service-settings-table table"\x3e\r\n        \x3c!-- nullable --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.nullable}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"serviceNullable"\x3e\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c!-- editable --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.editable}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"fieldEditable"\x3e\x3c/label\x3e\r\n            \x3cbutton class\x3d\'js-old-inline-edit btn-inline-edit btn-link btn-link-darker-gray font-size--3 right field-admin-owner-view js-portal-view\'\r\n              data-edit-id\x3d"fieldEditable" aria-label\x3d"${i18n.attributeFieldDetails.editEditable}"\x3e\r\n              ${!icons.inline.edit.16}${i18n.common.edit}\r\n            \x3c/button\x3e\r\n          \x3c/td\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"js-inline-edit-form hide" data-edit-id\x3d"fieldEditable"\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cform action\x3d"" class\x3d"js-inline-edit-form js-editable-form form-index" data-edit-id\x3d"fieldEditable"\x3e\r\n              \x3cfieldset class\x3d"fieldset-checkbox-index"\x3e\r\n                \x3clabel for\x3d"service-editable-checkbox-input" \x3e\r\n                  \x3cinput  id\x3d"service-editable-checkbox-input" type\x3d"checkbox" class\x3d"js-fieldEditable-input" name\x3d"fieldEditable" data-dojo-attach-point\x3d"fieldEditableEdit"\x3e\r\n                  \x3cb\x3e${i18n.attributeFieldDetails.allowAttributeEditing}\x3c/b\x3e\x3cbr /\x3e\r\n                \x3c/label\x3e\r\n              \x3c/fieldset\x3e\r\n              \x3cdiv class\x3d"text-right"\x3e\r\n                \x3cbutton class\x3d"btn js-editable-form-submit" disabled\x3e${i18n.common.save}\x3c/button\x3e\r\n                \x3cbutton class\x3d"js-cancel-inline-edit btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n              \x3c/div\x3e\r\n            \x3c/form\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c!-- default value --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.defaultValue}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"serviceDefaultValue"\x3e\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c!-- Length --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.length}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"serviceLength"\x3e\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n        \x3c!-- range, min max --\x3e\r\n        \x3ctr class\x3d"js-range-field-details hide"\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.rangeMinMax}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"rangeMinMax"\x3e\x3c/label\x3e\r\n            \x3cbutton class\x3d\'js-range-domain-edit btn-inline-edit btn-link btn-link-darker-gray font-size--3 right field-admin-owner-view field-view\'\r\n              data-edit-id\x3d"rangeMinMax" aria-label\x3d"${i18n.attributeFieldDetails.editRangeMinMax}"\x3e\r\n              ${!icons.inline.edit.16}${i18n.common.edit}\r\n            \x3c/button\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n        \x3c!-- Unique Index --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.unique}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"serviceIndex"\x3e\x3c/label\x3e\r\n            \x3cbutton class\x3d\'js-old-inline-edit btn-inline-edit btn-link btn-link-darker-gray font-size--3 right field-admin-owner-view field-view\'\r\n              data-edit-id\x3d"serviceIndex" aria-label\x3d"${i18n.attributeFieldDetails.editUnique}"\x3e\r\n              ${!icons.inline.edit.16}${i18n.common.edit}\r\n            \x3c/button\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"js-inline-edit-form hide" data-edit-id\x3d"serviceIndex"\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cform action\x3d"" class\x3d"js-inline-edit-form js-index-form form-index" data-edit-id\x3d"serviceIndex"\x3e\r\n              \x3cfieldset class\x3d"fieldset-checkbox-index"\x3e\r\n                \x3clabel for\x3d"service-index-checkbox-input" \x3e\r\n                  \x3cinput  id\x3d"service-index-checkbox-input" type\x3d"checkbox" class\x3d"js-serviceIndex-input" name\x3d"serviceIndex" data-dojo-attach-point\x3d"serviceIndexEdit"\x3e\r\n                  \x3cb\x3e${i18n.itemProperties.uniqueCheckbox}\x3c/b\x3e\x3cbr /\x3e\r\n                  \x3cp\x3e${i18n.itemProperties.uniqueCheckboxMessage}\x3c/p\x3e\r\n                \x3c/label\x3e\r\n              \x3c/fieldset\x3e\r\n              \x3cdiv class\x3d"text-right"\x3e\r\n                \x3cbutton class\x3d"btn js-index-form-submit" disabled\x3e${i18n.common.save}\x3c/button\x3e\r\n                \x3cbutton class\x3d"js-cancel-inline-edit btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n              \x3c/div\x3e\r\n            \x3c/form\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n      \x3c/table\x3e\r\n\r\n      \x3c!-- coded value table --\x3e\r\n      \x3cdiv class\x3d"js-coded-value-field-details hide"\x3e\r\n        \x3ch3 class\x3d"domain-settings-text" data-dojo-attach-point\x3d"codedValueDomainText"\x3e\x3c/h3\x3e\r\n        \x3cdiv class\x3d"btn-domain-group right"\x3e\r\n          \x3cbutton class\x3d\'js-domain-edit btn-link btn-link-darker-gray font-size--3 field-admin-owner-view field-view\' aria-label\x3d"${i18n.attributeFieldDetails.editCodedValues}"\x3e\r\n            ${!icons.inline.edit.16}${i18n.common.edit}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3ctable class\x3d"table table-coded-value"\x3e\r\n          \x3ctbody class\x3d"js-coded-value-table"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"flex-0 padding-left-1 padding-right-1"\x3e\r\n      \x3cbutton class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear js-domain-btn field-admin-owner-view field-view hide"\x3e${i18n.attributeFieldDetails.createDomains}\x3c/button\x3e\r\n      \x3cbutton class\x3d"text-ellipsis trailer-half btn btn-fill btn-red js-delete-btn field-admin-owner-view field-view"\x3e${i18n.attributeFieldDetails.delete}\x3c/button\x3e\r\n      \x3csection\x3e\r\n        \x3ch3\x3e${i18n.attributeFieldDetails.details}\x3c/h3\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1"\x3e\x3cspan\x3e${i18n.attributeFieldDetails.detailsType}\x3c/span\x3e\x3cspan\r\n            data-dojo-attach-point\x3d"detailsType"\x3e\x3c/span\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1"\x3e\x3cspan\x3e${i18n.attributeFieldDetails.detailsName}\x3c/span\x3e\x3cspan\r\n            data-dojo-attach-point\x3d"detailsName"\x3e\x3c/span\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"js-details-properties hide trailer-0 font-size--1"\x3e\x3cspan\x3e${i18n.attributeFieldDetails.properties}\x3c/span\x3e\x3cspan\r\n            data-dojo-attach-point\x3d"detailsProperties"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"tooltip tooltip-multiline tooltip-left" aria-label\x3d"" data-dojo-attach-point\x3d"detailsPropertiesInfo"\x3e\r\n              \x3ci class\x3d"icon-ui-notice-round font-size--1"\x3e\x3c/i\x3e\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cbutton class\x3d"js-details-properties js-details-reset-btn hide btn btn-link btn-small"\x3e${i18n.attributeFieldDetails.resetToSource}\x3c/button\x3e\r\n      \x3c/section\x3e\r\n    \x3c/div\x3e\r\n  \x3c/aside\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/attributeCard.html":'\x3cdiv class\x3d"panel panel-white block card card-mobile trailer-half ${selectCardClass} ${selectedClass} ${removedClass}"\r\n  data-id\x3d"${item.name}"\x3e\r\n  \x3cdiv class\x3d"flex"\x3e\r\n    \x3cdiv class\x3d"flex-0 margin-right-half leader-quarter"\x3e\r\n      \x3clabel class\x3d"tooltip trailer-0" data-dojo-attach-point\x3d"_checkboxWrap" aria-label\x3d"${selectItem}"\x3e\r\n        \x3cinput type\x3d"checkbox" class\x3d"checkbox-custom-input" value\x3d"${item.name}" data-id\x3d"${item.name}"\r\n          data-dojo-attach-point\x3d"_checkboxBtn" ${checked}\x3d""\x3e\r\n        \x3cspan class\x3d"checkbox-custom checkbox-custom--large"\x3e\r\n          \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--checked"\x3e\r\n            \x3cpath d\x3d"M12.753 3l-7.319 7.497L3.252 8.31 2 9.373l3.434 3.434L14 4.24z"\x3e\x3c/path\x3e\r\n          \x3c/svg\x3e\r\n          \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--mixed"\x3e\r\n            \x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M4 7h8v2H4z"\x3e\x3c/path\x3e\r\n          \x3c/svg\x3e\r\n        \x3c/span\x3e\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"flex-1 margin-right-1"\x3e\r\n      \x3cdiv class\x3d"flex"\x3e\r\n        \x3cdiv class\x3d"flex-1"\x3e\r\n          \x3ch4 class\x3d"trailer-quarter"\x3e\r\n            \x3cbutton class\x3d"btn btn-large btn-link js-field-name-card text-left table-select-cell-wrap"\r\n              fieldname\x3d"${item.name}" ${item.disabled}\x3d""\x3e${item.alias}\x3c/button\x3e\r\n          \x3c/h4\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"flex-0 leader-quarter"\x3e\r\n          \x3cp class\x3d"font-size--3 margin-right-half" style\x3d"display: inline-flex"\x3e${item.name}\x3c/p\x3e\r\n          \x3cmark class\x3d"label margin-right-half" data-dojo-attach-point\x3d"_fieldValueType"\x3e\x3c/mark\x3e\r\n          \x3cmark class\x3d"label"\x3e${item.fieldType}\x3c/mark\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--2"\x3e${item.description.value}\x3c/p\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/_attributesViewActions.html":'\x3cbutton data-action\x3d"addField" class\x3d"icon-ui-plus btn btn-fill btn-clear btn-small js-add-field-btn" aria-label\x3d"${i18n.attributesView.addFieldButtonLabel}"\x3e\r\n  ${i18n.attributesView.addFieldButtonText}\r\n\x3c/button\x3e\r\n',"url:arcgisonline/pages/item/widgets/AttributesView/templates/_attributesView.html":'\x3cdiv class\x3d"js-attributes-view"\x3e\r\n  \x3cdiv class\x3d"js-field-search-bar"\x3e\r\n    \x3cdiv class\x3d"js-control-bar"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3csection class\x3d"grid-container padding-trailer-2"\x3e\r\n    \x3cdiv class\x3d"column-24 flex js-field-main-body"\x3e\r\n      \x3c!-- Left Side --\x3e\r\n      \x3cdiv class\x3d"js-filter-wrap"\x3e\r\n        \x3ch4 class\x3d"trailer-half font-size--1 avenir-demi tablet-hide"\x3e${i18n.GroupWidget.filters}\x3c/h4\x3e\r\n        \x3c!-- Filters --\x3e\r\n        \x3cdiv class\x3d"js-filters"\x3e\r\n          \x3cdiv class\x3d"filters--accordion"\x3e\r\n            \x3c!-- Field type --\x3e\r\n            \x3ccalcite-accordion icon-position\x3d"start" class\x3d"filter-content-container" appearance\x3d"transparent"\x3e\r\n              \x3ccalcite-accordion-item heading\x3d"${i18n.attributesView.fieldType}" expanded\x3e\r\n                \x3cdiv class\x3d"js-filter-content"\x3e\r\n                  \x3cdiv class\x3d"ilters--accordion--content"\x3e\r\n                    \x3cdiv class\x3d"js-filter-field-type"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"js-filter-actions-end" slot\x3d"actions-end"\x3e\x3c/div\x3e\r\n              \x3c/calcite-accordion-item\x3e\r\n            \x3c/calcite-accordion\x3e\r\n             \x3c!-- Field value type --\x3e\r\n              \x3ccalcite-accordion icon-position\x3d"start" class\x3d"filter-content-container" appearance\x3d"transparent"\x3e\r\n                \x3ccalcite-accordion-item heading\x3d"${i18n.attributesView.fieldValueType}"\x3e\r\n                  \x3cdiv class\x3d"js-filter-content"\x3e\r\n                    \x3cdiv class\x3d"ilters--accordion--content"\x3e\r\n                      \x3cdiv class\x3d"js-filter-field-value-type"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                  \x3cdiv class\x3d"js-filter-actions-end" slot\x3d"actions-end"\x3e\x3c/div\x3e\r\n                \x3c/calcite-accordion-item\x3e\r\n              \x3c/calcite-accordion\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3c!-- Main --\x3e\r\n      \x3cmain class\x3d"view-wrap js-view-wrap"\x3e\r\n\r\n        \x3c!-- Hide if items are selected --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-trailer-quarter hide-if-selected flex break-word" data-dojo-attach-point\x3d"statusBar"\x3e\r\n          \x3cdiv class\x3d"font-size--1 inline-block flex-1 flex flex-align-center filter-status-wrap"\x3e\r\n            \x3cspan class\x3d"padding-right-1 padding-leader-quarter padding-trailer-quarter font-size--2 flex-0 nowrap"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_totalFields"\x3e\x3c/span\x3e\r\n            \x3c/span\x3e\r\n            \x3c!-- Filter Status --\x3e\r\n            \x3cdiv class\x3d"inline-block js-filter-status"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cp class\x3d"trailer-0 font-size--1 js-schemaUpdatedLast"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Show if fields are selected --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-trailer-half show-if-selected hide" data-dojo-attach-point\x3d"selectedWrap"\x3e\r\n          \x3cspan class\x3d"label label-green margin-right-1"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"selectedCount"\x3e0\x3c/span\x3e${i18n.attributesView.selected}\x3c/span\x3e\r\n          \x3cbutton class\x3d"js-deselect btn-link btn-link-black"\x3e${i18n.attributesView.clearSelection}\x3c/button\x3e\r\n          \x3cnav class\x3d"right"\x3e\r\n            \x3c!-- \x3cbutton data-action\x3d"groupFields"\r\n                class\x3d"btn-link btn-link-darker-gray margin-right-1 icon-ui-group font-size--2 js-action-groupFields"\r\n                data-dojo-attach-point\x3d"_groupFields"\x3eGroup\x3c/button\x3e\r\n            \x3cbutton data-action\x3d"summarizeFields"\r\n                class\x3d"btn-link btn-link-darker-gray margin-right-1 icon-ui-collection font-size--2 js-action-summarizeFields"\r\n                data-dojo-attach-point\x3d"_summarizeFields"\x3eSummarize\x3c/button\x3e --\x3e\r\n            \x3cbutton data-action\x3d"deleteFields"\r\n                class\x3d"btn-link btn-link-black margin-right-1 font-size--2 js-delete-multiple-fields"\r\n                data-dojo-attach-point\x3d"_deleteFields"\x3e${!icons.inline.trash.16}${i18n.attributesView.deleteFieldButtonText}\x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- populated by View component --\x3e\r\n        \x3cdiv class\x3d"js-views"\x3e\x3c/div\x3e\r\n\r\n      \x3c/main\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- attributes details --\x3e\r\n    \x3cdiv class\x3d"clearfix leader-1 panel-white flex js-attributes-details-info hide"\x3e\r\n      \x3cdiv class\x3d"js-attribute-field-only div-attribute-field-only flex-0 overflow-auto"\x3e\r\n        \x3cdiv class\x3d"div-search-border"\x3e\r\n          \x3ccalcite-input class\x3d"js-field-only-search" type\x3d"search" icon\x3d"search"  placeholder\x3d"${i18n.attributesView.searchPlaceholder}" aria-label\x3d"${i18n.attributesView.searchPlaceholder}"\x3e\x3c/calcite-input\x3e\r\n        \x3c/div\x3e\r\n        \x3ctable class\x3d"js-attribute-field-only-table table table-plain"\x3e\r\n          \x3ctbody class\x3d"js-attributes-details-body table-attributes-details-body"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"js-attribute-field-details div-attribute-field-details flex-1 overflow-auto"\x3e\r\n        \x3cdiv class\x3d"js-attributes-details"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/section\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/tableHead.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-checkbox field-admin-owner-view field-view" role\x3d"columnheader"\x3e\r\n    \x3clabel class\x3d"table-select-cell-sort table-select-check-all"\x3e\r\n      \x3cinput type\x3d"checkbox" aria-label\x3d"Select all" class\x3d"js-select-all"\x3e\r\n    \x3c/label\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"fieldAlias" data-sort-order\x3d"asc"\x3e${i18n.attributesView.fieldAlias}\x3c/button\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"fieldName" data-sort-order\x3d"asc"\x3e${i18n.attributesView.fieldName}\x3c/button\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"fieldType" data-sort-order\x3d"asc"\x3e${i18n.attributesView.fieldType}\x3c/button\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/tableRow.html":'\x3cdiv class\x3d"table-select-row flex table-select-row-avatar ${activeRow}" role\x3d"row"\x3e\r\n  \x3clabel class\x3d"table-select-cell table-select-checkbox flex-0 field-admin-owner-view field-view ${selectClass}" role\x3d"cell"\x3e\r\n    \x3cinput type\x3d"checkbox" aria-label\x3d"${i18n.filters.selectPage}" class\x3d"js-table-select-checkbox" data-username\x3d"${item.name}" ${checked}\x3e\r\n  \x3c/label\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" role\x3d"cell"\x3e\x3cbutton class\x3d\'btn btn-transparent btn-small js-field-name text-left btn-field-name table-select-cell-wrap\' fieldName\x3d"${item.name}" ${item.disabled}\x3e${item.alias}\x3c/button\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" role\x3d"cell"\x3e${item.name}\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" role\x3d"cell"\x3e${item.fieldType}\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/empty.html":'\x3cdiv class\x3d"js-empty-view text-center"\x3e\r\n  \x3ch3\x3e${i18n.attributesView.emptyText}\x3c/h3\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/item/widgets/AttributesView/templates/none.html":'\x3cdiv class\x3d"text-center leader-1 text-constrain margin-auto"\x3e${i18n.attributesView.noneText}\x3c/div\x3e',"url:arcgisonline/pages/dijit/ArcadeCalculatorDlg/templates/ArcadeCalculatorDlg.html":'\x3cdiv class\x3d"${baseClass} arcadeCalculator-wrapper"\x3e\r\n  \x3cdiv class\x3d"js-arcade-calculatorDlg arcade-calculator-modal"\x3e\r\n    \x3cdiv class\x3d"arcade-calculator-modal-content"\x3e\r\n      \x3ciframe\r\n        data-dojo-attach-point\x3d"expressionEditor"\r\n        style\x3d"border:none;width:100%;height:100%;visibility:hidden;"\r\n      \x3e\x3c/iframe\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-arcade-statusDlg arcade-status hide"\x3e\r\n    \x3csection class\x3d"arcade-status__section font-size--1 padding-leader-2"\x3e\r\n      \x3ch5 class\x3d"padding-leader-half trailer-half"\x3e${i18n.arcadeCalculatorDlg.calculatingRecords}\x3c/h5\x3e\r\n      \x3cdiv class\x3d"progress-bar arcade-status__progress-bar"\x3e\r\n        \x3cdiv\r\n          class\x3d"progress-bar-fill progress-bar-fill--blue"\r\n          data-dojo-attach-point\x3d"progressBar"\r\n          style\x3d"width: 0%"\r\n        \x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cp class\x3d"progress-bar__counts font-size--3 leading-quarter trailer-half hide js-progress-bar-counts"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"completedRecords"\x3e${i18n.arcadeCalculatorDlg.zero}\x3c/span\x3e /\r\n        \x3cspan data-dojo-attach-point\x3d"totalRecords"\x3e${i18n.arcadeCalculatorDlg.zero}\x3c/span\x3e\r\n      \x3c/p\x3e\r\n    \x3c/section\x3e\r\n    \x3cdiv class\x3d"js-show-error arcade-status__section--centered leader-1 hide"\x3e\r\n      \x3cdiv class\x3d"arcade-status__error trailer-1"\x3e\r\n        \x3ch4\r\n          class\x3d"font-size--1 arcade-status-error__heading trailer-0"\r\n          data-dojo-attach-point\x3d"reviewErrorHeading"\r\n        \x3e\x3c/h4\x3e\r\n        \x3cdiv class\x3d"arcade-status-error__body"\x3e\r\n          \x3cdiv class\x3d"arcade-status-error__body-cell"\x3e\r\n            \x3ch5\r\n              class\x3d"arcade-status-error-cell__heading trailer-0 text-dark-gray font-size--2"\r\n              data-dojo-attach-point\x3d"reviewErrorFid"\r\n            \x3e\r\n              ${i18n.arcadeCalculatorDlg.displayCalculatedValue}\r\n            \x3c/h5\x3e\r\n            \x3cp class\x3d"arcade-status-error-cell__body trailer-0 leader-0 text-black"\x3e\r\n              \x3cb data-dojo-attach-point\x3d"reviewErrorFidValue"\x3e\x3c/b\x3e\r\n            \x3c/p\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"arcade-status-error__body-cell"\x3e\r\n            \x3ch5 class\x3d"arcade-status-error-cell__heading trailer-0 text-dark-gray font-size--2"\x3e\r\n              ${i18n.arcadeCalculatorDlg.displayCalculatedValue}\r\n            \x3c/h5\x3e\r\n            \x3cp class\x3d"arcade-status-error-cell__body trailer-0 leader-0 text-black"\x3e\r\n              \x3cb data-dojo-attach-point\x3d"reviewErrorValue"\x3e\x3c/b\x3e\r\n            \x3c/p\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cp class\x3d"arcade-status__message font-size-0"\x3e\r\n        ${i18n.arcadeCalculatorDlg.reviewExplainText}\r\n      \x3c/p\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"arcade-status__footer"\x3e\r\n      \x3cbutton class\x3d"btn calcite blue js-review-button arcade-review-button hide"\x3e\r\n        ${i18n.arcadeCalculatorDlg.reviewButton}\r\n      \x3c/button\x3e\r\n      \x3cbutton class\x3d"btn calcite btn-clear js-cancel-button arcade-cancel-button"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- Loader --\x3e\r\n  \x3cdiv class\x3d"loader loader-arcadeCalculator throb-loading is-active hide padding-leader-3 padding-trailer-3"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text throb-loading-text"\x3e${i18n.arcadeCalculatorDlg.defaultLoading}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/CalculateWithOptionsDlg/templates/CalculateWithOptionsDlg.html":'\x3cdiv class\x3d"${baseClass} calculateWithOptions-wrapper"\x3e\r\n  \x3cp class\x3d"trailer-half font-size--1 text-darker-gray"\x3e${i18n.calculateSQLArcadeDlg.whatLanguage}\x3c/p\x3e\r\n\r\n  \x3cdiv class\x3d"calculate-with-options block-group block-group-2-up trailer-half"\x3e\r\n\r\n    \x3cdiv class\x3d"card block"\x3e\r\n\r\n      \x3cdiv class\x3d"card-content calculate-with-options__card-content"\x3e\r\n\r\n        \x3ch4 class\x3d"trailer-half padding-trailer-quarter calculate-option__header"\x3e${i18n.calculateSQLArcadeDlg.arcade}\r\n        \x3c/h4\x3e\r\n        \x3cp class\x3d"trailer-quarter"\x3e${i18n.calculateSQLArcadeDlg.idealFor}\x3c/p\x3e\r\n\r\n        \x3cul\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.arcadePart1}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.arcadePart2}\x3c/li\x3e\r\n        \x3c/ul\x3e\r\n\r\n        \x3cdiv class\x3d"calculate-option__card-footer"\x3e\r\n          \x3ca class\x3d"btn calcite blue btn-half calculate-option__button js-arcade-button"\x3e${i18n.calculateSQLArcadeDlg.arcade}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"panel panel-arcade-disabled js-panel-arcade-disabled modifier-class hide"\x3e\r\n        \x3cp class\x3d"trailer-0 text-darker-gray js-disabled-text"\x3e${i18n.calculateSQLArcadeDlg.arcadeDisabledInfo}\r\n          \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"arcadeDisabledHelpUrl"\x3e${i18n.addItemFrm.learnMore}\x3c/a\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"card block"\x3e\r\n\r\n      \x3cdiv class\x3d"card-content calculate-with-options__card-content"\x3e\r\n        \x3ch4 class\x3d"trailer-half padding-trailer-quarter calculate-option__header"\x3e${i18n.calculateSQLArcadeDlg.sql}\x3c/h4\x3e\r\n        \x3cp class\x3d"trailer-quarter"\x3e${i18n.calculateSQLArcadeDlg.idealFor}\x3c/p\x3e\r\n\r\n        \x3cul\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart1}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart2}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart3}\x3c/li\x3e\r\n        \x3c/ul\x3e\r\n\r\n        \x3cdiv class\x3d"calculate-option__card-footer"\x3e\r\n          \x3ca class\x3d"btn calcite blue btn-half calculate-option__button js-sql-button"\x3e${i18n.calculateSQLArcadeDlg.sql}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"calculate-with-options__footer"\x3e\r\n\r\n    \x3ca target\x3d"_blank"\r\n      data-dojo-attach-point\x3d"docUrl"\r\n      class\x3d"font-size--1"\x3e${i18n.addItemFrm.learnMore}\r\n      ${!icons.inline-end.launch.16}\r\n    \x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/TableAddFieldDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${_css.container}" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" data-dojo-props\x3d"title:\'${i18n.addFieldTitle}\'"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_addForm"\x3e\r\n       \x3ctable class\x3d"${_css.table}" data-dojo-attach-point\x3d"_addTable" style\x3d"border-collapse:collapse;border-spacing:5px;" cellpadding\x3d"5px" cellspacing\x3d"5px"\x3e\r\n         \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel for\x3d"fieldName"\x3e${i18n.nameLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n              \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-props\x3d"required:true" data-dojo-attach-point\x3d"_nameInput" value\x3d"" id\x3d"fieldName"\x3e\x3c/input\x3e\r\n             \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel for\x3d"displayName"\x3e${i18n.aliasLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-attach-point\x3d"_aliasInput" value\x3d"" id\x3d"displayName"\x3e\x3c/input\x3e\r\n             \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n           \x3ctr\x3e\r\n            \x3ctd\x3e\r\n              \x3clabel for\x3d"typeField"\x3e${i18n.typeLabel}\x3c/label\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n                \x3cselect class\x3d"${_css.typeSelect} ${_css.leadingMargin1} ${_css.longInput} ${_css.longLabel}" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-point\x3d"_typeSelect" data-dojo-attach-event\x3d"onChange:_handleTypeChange" data-dojo-props\x3d"value:\'esriFieldTypeString\'" id\x3d"typeField"\x3e\r\n                  \x3coption value\x3d"esriFieldTypeBigInteger"\x3e${newFieldTypeStrings.bigIntegerLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFieldTypeDate"\x3e${i18n.dateLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFieldTypeDateOnly"\x3e${newFieldTypeStrings.dateOnlyLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFieldTypeDouble"\x3e${i18n.doubleLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFieldTypeInteger"\x3e${i18n.integerLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFieldTypeString"\x3e${i18n.stringLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFieldTypeTimeOnly"\x3e${newFieldTypeStrings.timeOnlyLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFieldTypeTimestampOffset"\x3e${newFieldTypeStrings.timestampOffsetLabel}\x3c/option\x3e\r\n                \x3c/select\x3e  \r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n            \x3ctr data-dojo-attach-point\x3d"_lengthRow"\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"_lengthLabel" for\x3d"lengthField"\x3e${i18n.lengthLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-attach-point\x3d"_lengthInput" data-dojo-props\x3d"value:256" id\x3d"lengthField"/\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"${_css.defaultLabelContainer}"\x3e\x3clabel data-dojo-attach-point\x3d"_defaultLabel" for\x3d"defaultField"\x3e${i18n.defaultValueLabel}\x3c/label\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.optionLabelContainer} defaultValOptional" id\x3d"defaultValOptional"\x3e\x3clabel data-dojo-attach-point\x3d"_optionLabel"\x3e${i18n.optional}\x3c/label\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${_css.leadingMargin1}" data-dojo-props\x3d"required:false" data-dojo-attach-point\x3d"_defaultStrInput" id\x3d"defaultField"/\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-props\x3d"constraints:{places:0}" data-dojo-attach-point\x3d"_defaultNumInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultDblInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/DateTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultDateInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/TimeTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultTimeInput" /\x3e\r\n                \x3cselect class\x3d"${_css.leadingMargin1}" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-point\x3d"_defaultTimezoneSelect" data-dojo-attach-event\x3d"onChange:_handleTimeZoneChange" id\x3d"timeZoneSelect" required\x3d"false"\x3e\x3c/select\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \r\n            \x3ctr id\x3d"nullableRow" class\x3d"nullable-row"\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"_lengthLabel" for\x3d"nullableField"\x3e${i18n.nullableLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"${_css.leadingMargin1}"\x3e\r\n                  \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"_nullable" id\x3d"nullableField" checked /\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n         \x3c/table\x3e\r\n         \x3cdiv class\x3d"js-newFieldTypeWarning hide"\x3e\r\n          \x3ccalcite-label layout\x3d"inline" class\x3d"testing avenir-regular trailer-1"\x3e\r\n            \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"32" height\x3d"32" viewBox\x3d"0 0 32 32" class\x3d"svg-icon svg-icon-blue"\x3e\x3cpath d\x3d"M31.297 16.047c0 8.428-6.826 15.25-15.25 15.25S.797 24.475.797 16.047c0-8.424 6.826-15.25 15.25-15.25s15.25 6.826 15.25 15.25zM18 24V12h-4v12h-2v2h8v-2h-2zm0-18h-4v4h4V6z"/\x3e\x3c/svg\x3e\r\n              \x3cspan class\x3d"newFieldTypeWarning-text" style\x3d"width: 23rem;"\x3e${newFieldTypeStrings.newFieldTypeWarning}\r\n                \x3cspan class\x3d"bigInteger-text hide"\x3e${newFieldTypeStrings.bigIntegerInfo}\x3c/span\x3e\r\n              \x3c/span\x3e\r\n          \x3c/calcite-label\x3e\r\n        \x3c/div\x3e\r\n         \x3cdiv class\x3d"${_css.buttonContainer} ${_css.trailing}"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.button}" data-dojo-attach-point\x3d"_addBtn" data-dojo-attach-event\x3d"onClick:_handleAddButtonClick"\x3e${i18n.addNewField}\x3c/div\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.closeButton}" data-dojo-attach-point\x3d"_cancelBtn" data-dojo-attach-event\x3d"onClick:_handleCancelButtonClick"\x3e${i18n.cancel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/item/widgets/templates/_data.html":'\x3cmain class\x3d"flex-column flex-1 ie9-height-100 trailer-half"\x3e\r\n  \x3cdiv class\x3d"padding-leader-half padding-trailer-half clearfix panel-white"\x3e\r\n    \x3cdiv class\x3d"overflow-auto grid-container"\x3e\r\n      \x3cdiv class\x3d"column-16 tablet-column-6 phone-trailer-half flex"\x3e\r\n        \x3cdiv class\x3d"js-featureLayers hide flex-0 margin-right-2"\x3e\r\n          \x3clabel class\x3d"if-layers trailer-0 layer-drop-down"\x3e\r\n            \x3cspan class\x3d"inline-block padding-right-1"\x3e${i18n.openMapDlg.layerLabel}\x3c/span\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"layerSelect" class\x3d"inline-block leader-0"\x3e\x3c/select\x3e\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3clabel class\x3d"js-subtype-group-layers trailer-0 layer-drop-down hide column-16 tablet-column-6 phone-trailer-half"\x3e\r\n          \x3cspan class\x3d"js-subtype-group-layers-label inline-block padding-right-1"\x3e${i18n.itemProperties.assetGroup}\x3c/span\x3e\r\n          \x3cselect class\x3d"js-subtype-group-layers-select inline-block leader-0"\x3e\x3c/select\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"column-8 tablet-column-6 right"\x3e\r\n        \x3cfieldset class\x3d"radio-group trailer-0 js-data-attributes margin-right-quarter right"\x3e\r\n          \x3cinput\r\n            class\x3d"radio-group-input js-data-aspect js-dataView"\r\n            value\x3d"data"\r\n            type\x3d"radio"\r\n            id\x3d"attributeData"\r\n            name\x3d"data_aspect"\r\n            checked\r\n          /\x3e\r\n          \x3clabel class\x3d"radio-group-label trailer-0 leader-0" for\x3d"attributeData"\r\n            \x3e${i18n.itemProperties.attributeDataTab}\x3c/label\r\n          \x3e\r\n          \x3cinput\r\n            class\x3d"radio-group-input js-data-aspect js-attributesView"\r\n            value\x3d"attributes"\r\n            type\x3d"radio"\r\n            id\x3d"attributeFields"\r\n            name\x3d"data_aspect"\r\n          /\x3e\r\n          \x3clabel class\x3d"radio-group-label trailer-0 leader-0" for\x3d"attributeFields"\r\n            \x3e${i18n.itemProperties.attributeFieldsTab}\x3c/label\r\n          \x3e\r\n        \x3c/fieldset\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"grid-container leader-quarter js-feature-table"\x3e\r\n    \x3ccalcite-notice kind\x3d"brand" icon\x3d"exclamation-mark-circle" width\x3d"full" class\x3d"leader-half trailer-half js-admin-edit-notice"\x3e\r\n      \x3cdiv slot\x3d"message"\x3e${i18n.data.adminEditWarning}\x3c/div\x3e\r\n    \x3c/calcite-notice\x3e\r\n    \x3cdiv class\x3d"left leader-quarter if-can-edit-service js-feature-table"\x3e${i18n.itemProperties.dataTabHelpMsg}\x3c/div\x3e\r\n    \x3cdiv class\x3d"right leader-quarter js-dataUpdatedLast right text-right hide js-feature-table"\x3e\x3c/div\x3e\r\n    \x3c!--\x3cdiv class\x3d"js-hide-on-error column-8 action-bar action-bar-right if-can-update"\x3e--\x3e\r\n    \x3c!--\x3ca data-dojo-attach-point\x3d"saveBtn" href\x3d"" class\x3d"btn action-bar-btn right btn-disabled"\x3e${i18n.common.save}\x3c/a\x3e--\x3e\r\n    \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv\r\n    class\x3d"grid-container leader-half flex-1 position-relative ie9-height-90 flex js-feature-table"\r\n    id\x3d"main-content-area"\r\n  \x3e\r\n    \x3cdiv class\x3d"column-24 hide"\x3e\r\n      \x3ch4 data-dojo-attach-point\x3d"fieldViewTopTitleTablet" class\x3d"field-view-title"\x3e\x3c/h4\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"wrapper" class\x3d"flex-1 position-relative ie9-height-90 js-feature-table"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"fieldViewTop" class\x3d"column-19 field-view-top right hide"\x3e\r\n        \x3cdiv class\x3d"field-view-top-title-container"\x3e\r\n          \x3ch4 data-dojo-attach-point\x3d"fieldViewTopTitle" class\x3d"field-view-top-title left"\x3e\x3c/h4\x3e\r\n          \x3c!-- \x3cbutton data-dojo-attach-point\x3d"fieldViewTopTitleEditBtn" class\x3d"field-view-top-title-edit-btn btn-link btn-link-darker-gray icon-ui-edit if-can-update"\x3eEdit\x3c/button\x3e --\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv\r\n          data-dojo-attach-point\x3d"fieldViewTopCloseBtn"\r\n          class\x3d"field-view-top-close-btn right padding-right-half padding-left-half"\r\n          tabindex\x3d"0"\r\n        \x3e\r\n          ${!icons.x.24}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3caside data-dojo-attach-point\x3d"fieldViewContainer" class\x3d"column-19 right field-view-container hide tablet-hide"\x3e\r\n        \x3cdiv class\x3d"column-14 padding-left-1 field-view-content"\x3e\r\n          \x3ch5\x3e${i18n.itemProperties.summary}\x3c/h5\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"fieldViewSummaryContainer" class\x3d"field-view-summary-container"\x3e\x3c/div\x3e\r\n          \x3ch5\x3e${i18n.itemProperties.settings}\x3c/h5\x3e\r\n          \x3ctable class\x3d"settingsTable table"\x3e\x3c/table\x3e\r\n          \x3cform class\x3d"index-form hide"\x3e\r\n            \x3cfieldset class\x3d"fieldset-checkbox"\x3e\r\n              \x3clabel for\x3d"item-properties-unique-input"\x3e\r\n                \x3cinput id\x3d"item-properties-unique-input" type\x3d"checkbox" class\x3d"unique-index-checkbox" /\x3e \x3cb\x3e${i18n.itemProperties.uniqueCheckbox}\x3c/b\r\n                \x3e\x3cbr /\x3e\r\n                \x3cp\x3e${i18n.itemProperties.uniqueCheckboxMessage}\x3c/p\x3e\r\n              \x3c/label\x3e\r\n            \x3c/fieldset\x3e\r\n            \x3cdiv class\x3d"text-right"\x3e\r\n              \x3cbutton class\x3d"btn index-form-submit" disabled\x3d"true"\x3e${i18n.common.save}\x3c/button\x3e\r\n              \x3cbutton class\x3d"cancel-index-form btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/div\x3e\r\n          \x3c/form\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"column-5 padding-left-1 field-view-side"\x3e\r\n          \x3ca\r\n            data-dojo-attach-point\x3d"calculateFieldButton"\r\n            class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear js-open-btn hide"\r\n            \x3e${i18n.itemProperties.calculateField}\x3c/a\r\n          \x3e\r\n          \x3ca\r\n            data-dojo-attach-point\x3d"deleteFieldButton"\r\n            class\x3d"text-ellipsis trailer-half btn btn-fill btn-red js-open-btn trailer-2 hide"\r\n            \x3e${i18n.itemProperties.deleteField}\x3c/a\r\n          \x3e\r\n          \x3csection class\x3d"column-5"\x3e\r\n            \x3ch5\x3e${i18n.itemProperties.details}\x3c/h5\x3e\r\n            \x3cp class\x3d"trailer-0 font-size--1"\x3e\r\n              \x3cspan\x3e${i18n.itemProperties.detailType} \x3c/span\x3e\x3cspan data-dojo-attach-point\x3d"fieldViewFieldType"\x3e\x3c/span\x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"font-size--1"\x3e\r\n              \x3cspan\x3e${i18n.itemProperties.detailName} \x3c/span\x3e\x3cspan data-dojo-attach-point\x3d"fieldViewFieldName"\x3e\x3c/span\x3e\r\n            \x3c/p\x3e\r\n          \x3c/section\x3e\r\n        \x3c/div\x3e\r\n      \x3c/aside\x3e\r\n      \x3cdiv id\x3d"grid"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- attributes view --\x3e\r\n  \x3cdiv class\x3d"clearfix padding-trailer-2 js-attributes-view"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"alert alert-red js-data-error leader-4 margin-auto"\x3e\r\n    ${i18n.common.errors.genericError.message}\r\n  \x3c/div\x3e\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_usage.html":'\x3cmain class\x3d"${baseClass} grid-container"\x3e\r\n    \x3cdiv class\x3d"column-24 padding-leader-2" id\x3d"main-content-area"\x3e\r\n        \x3cdiv class\x3d"flex panel panel-white"\x3e\r\n            \x3cdiv class\x3d"flex-1"\x3e\r\n                \x3ch3 id\x3d"uTitle" class\x3d"trailer-0 avenir-regular"\x3e\x26nbsp;\x3c/h3\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"leader-1 flex-0"\x3e\r\n                \x3cselect id\x3d"${id}-dateSelect" name\x3d"dateSelect" class\x3d"right" aria-label\x3d"${custDateRngTitle}"\x3e\r\n                    \x3coption id\x3d"last24Hours" value\x3d"last24Hours"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last7Days" value\x3d"last7Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last14Days" value\x3d"last14Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last30Days" value\x3d"last30Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last45Days" value\x3d"last45Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last60Days" value\x3d"last60Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last6Months" value\x3d"last6Months"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last12Months" value\x3d"last12Months"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"dsCustomRng" value\x3d"dsCustomRng"\x3e\x3c/option\x3e\r\n                \x3c/select\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv id\x3d"datePickerDiv" class\x3d"datePickerDiv panel panel-white" tabindex\x3d"0"\x3e\r\n            \x3ch4 class\x3d"trailer-half text-center avenir-regular leader-1"\x3e${custDateRngTitle}\x3c/h4\x3e\r\n            \x3cdiv class\x3d"flex flex-justify-center phone-flex-column"\x3e\r\n                \x3clabel for\x3d"dsStart" class\x3d"trailer-0 margin-right-1 phone-trailer-1"\x3e${dateFromLbl}\r\n                    \x3ccalcite-input-date-picker id\x3d"dsStart" name\x3d"startDate" scale\x3d"l" placement\x3d"bottom-start" overlay-positioning\x3d"fixed" /\x3e\r\n                \x3c/label\x3e\r\n                \x3clabel for\x3d"dsEnd" class\x3d"trailer-0 margin-right-1 phone-trailer-1"\x3e${dateToLbl}\r\n                    \x3ccalcite-input-date-picker id\x3d"dsEnd" name\x3d"endDate" scale\x3d"l" placement\x3d"bottom-start" overlay-positioning\x3d"fixed" /\x3e\r\n                \x3c/label\x3e\r\n                \x3cdiv class\x3d"margin-auto-top"\x3e\r\n                    \x3ccalcite-button scale\x3d"l" class\x3d"flex-0" data-dojo-attach-point\x3d"qDateRngBtn"\x3e${qDateLbl}\x3c/calcite-button\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv id\x3d"customDateErrorDiv" class\x3d"alert alert-red leader-half trailer-half margin-auto"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv class\x3d"panel panel-white"\x3e\r\n            \x3cdiv class\x3d"flex phone-flex-column clearfix"\x3e\r\n                \x3cdiv class\x3d"flex-1 ie9-half text-center text-darkest-gray"\x3e\r\n                    \x3ch4 id\x3d"totReqCountLbl" class\x3d"trailer-half avenir-regular font-size-0"\x3e${totReqCountTitle}\x3c/h4\x3e\r\n                    \x3cp id\x3d"totReqCountVal" class\x3d"trailer-0 avenir-regular font-size-4 text-green js-total-requests"\x3e${totReqCountVal}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"flex-1 ie9-half text-center text-darkest-gray phone-leader-1"\x3e\r\n                    \x3ch4 id\x3d"avgCountPerDayLbl" class\x3d"trailer-half avenir-regular font-size-0"\x3e${avgCountPerDayTitle}\x3c/h4\x3e\r\n                    \x3cp id\x3d"avgCountPerDayVal" class\x3d"trailer-0 avenir-regular font-size-4 text-green js-average-requests"\x3e${avgCountPerDayVal}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"flex-1 ie9-half text-center phone-leader-1 hide" id\x3d"creditsUsedLbl"\x3e\r\n                    \x3ch4 class\x3d"trailer-half avenir-regular font-size-0 text-darkest-gray"\x3e${creditsUsedTitle}\x3c/h4\x3e\r\n                    \x3cp id\x3d"creditsUsedVal" class\x3d"trailer-0 avenir-regular font-size-4 text-green js-average-bandwidth"\x3e${creditsUsedVal}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n\r\n              \x3cdiv class\x3d"flex-1 ie9-half text-center phone-leader-1 hide" id\x3d"loginsValLbl"\x3e\r\n                \x3ch4 class\x3d"trailer-half avenir-regular font-size-0 text-darkest-gray"\x3e${loginsTitle}\x3c/h4\x3e\r\n                \x3cp id\x3d"loginsVal" class\x3d"trailer-0 avenir-regular font-size-4 text-green js-average-bandwidth"\x3e${loginsVal}\x3c/p\x3e\r\n              \x3c/div\x3e\r\n\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv class\x3d"panel panel-white"\x3e\r\n            \x3ch4 id\x3d"countChartTitle" class\x3d"avenir-regular"\x3e${countChartTitle}\x3c/h4\x3e\r\n            \x3cdiv id\x3d"cntChartDiv" class\x3d"js-requests-chart ct-double-octave hide" tabindex\x3d"0" style\x3d"max-height: 350px; min-height: 315px;"\x3e\x3c/div\x3e\r\n            \x3cdiv id\x3d"cntChartEmptyDiv" class\x3d"hide" style\x3d"max-height: 350px; min-height: 315px;"\x3e\x3c/div\x3e\r\n            \x3cdiv id\x3d"chartLoaderDiv" class\x3d"loader-bars leader-3 trailer-3" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n            \x3cp id\x3d"tzMsg" class\x3d"font-size--3 text-center"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_usage-empty.html":'\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 256 256" width\x3d"256"\x3e\x3cpath fill\x3d"#e0e0e0" class\x3d"cls-1" d\x3d"M56 200.105h148v4H56V216h-4v-12H40v-4h12V68h4zM156 216h4v-8h-4zm32 0h4v-8h-4zm-64 0h4v-8h-4zm-32 0h4v-8h-4zm-44-56h-8v4h8zm0-40h-8v4h8zm0-40h-8v4h8zm18.084 81.5H65v-4h2.116l25.255 13.966 32.95-48.532 26.032 13.616a8.598 8.598 0 1 1-1.748 3.601l-22.978-12.02-32.998 48.602zM153.4 142a4.6 4.6 0 1 0 4.6-4.6 4.605 4.605 0 0 0-4.6 4.6zm51.414-77.05l-3.509-1.92-4.058 7.416 3.508 1.92zM188.58 94.617l-3.51-1.92-4.058 7.417 3.509 1.92zm8.117-14.834l-3.509-1.92-4.059 7.417 3.51 1.92zm-24.352 44.503l-3.51-1.92-4.058 7.417 3.51 1.92zm8.117-14.835l-3.509-1.92-4.058 7.418 3.508 1.92z"/\x3e\x3c/svg\x3e',
"url:arcgisonline/pages/item/widgets/templates/_preview.html":'\x3cmain class\x3d"grid-container leader-1 notebook-preview-container"\x3e\r\n  \x3cdiv class\x3d"loader padding-leader-3 padding-trailer-3" data-dojo-attach-point\x3d"loader"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"flex-center"\x3e\r\n    \x3cdiv class\x3d"column-12 alert alert-red alert-inline break-word leader-2 trailer-2" data-dojo-attach-point\x3d"error"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe\r\n    frameborder\x3d"0"\r\n    id\x3d"notebook-preview-iframe"\r\n    data-dojo-attach-point\x3d"notebookFrame"\r\n    sandbox\x3d"allow-same-origin"\r\n    scrolling\x3d"no"\r\n  \x3e\x3c/iframe\x3e\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/dijit/Pagination/templates/Number.html":'\x3cli\x3e\x3ca href\x3d"#" class\x3d"js-btn btn btn-small pagination-btn ${is-active}" data-page\x3d"${pageNum}" aria-label\x3d"${label}" ${current}\x3e${pageNum}\x3c/a\x3e\x3c/li\x3e\r\n',"url:arcgisonline/pages/dijit/Pagination/templates/Ellipsis.html":'\x3cli\x3e\x3cspan class\x3d"avenir-light text-light-gray btn-small pagination-btn--inactive"\x3e${pageNum}\x3c/span\x3e\x3c/li\x3e\r\n',"url:arcgisonline/pages/dijit/Pagination/templates/Pagination.html":'\x3cdiv class\x3d"text-center trailer-1 padding-leader-1" data-dojo-attach-point\x3d"pagination"\x3e\r\n  \x3cdiv class\x3d"alert alert-yellow margin-auto trailer-1 js-over-limit"\x3e${i18n.contentPage.errors.overItemLimit}\x3c/div\x3e\r\n  \x3cdiv class\x3d"flex phone-flex-column"\x3e\r\n    \x3cdiv class\x3d"flex-1"\x3e\r\n      \x3cnav class\x3d"pagination margin-auto" data-dojo-attach-point\x3d"navigation" role\x3d"navigation" aria-label\x3d"${i18n.contentPage.paginationLabel}"\x3e\r\n          \x3ca href\x3d"#" aria-label\x3d"${i18n.contentPage.paginationPrevious}" class\x3d"js-btn-previous js-btn pagination-btn btn btn-small btn-transparent btn-disabled" data-dojo-attach-point\x3d"previous"\x3e${i18n.common.previous}\x3c/a\x3e\r\n          \x3cspan class\x3d"js-pagination-links pagination-links" data-dojo-attach-point\x3d"pageLinks"\x3e\x3c/span\x3e\r\n          \x3ca href\x3d"#" aria-label\x3d"${i18n.contentPage.paginationNext}" class\x3d"js-btn-next js-btn pagination-btn btn btn-small btn-transparent btn-disabled" data-dojo-attach-point\x3d"next"\x3e${i18n.common.next}\x3c/a\x3e\r\n      \x3c/nav\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"flex-0" data-dojo-attach-point\x3d"_pageDropdown"\x3e\r\n      \x3cdiv class\x3d"dropdown dropdown-up js-dropdown padding-leader-quarter right full-width phone-leader-half"\x3e\r\n        \x3c!-- extends side-nav --\x3e\r\n        \x3cbutton class\x3d"btn-link font-size--2 btn-link-black js-dropdown-toggle" tabindex\x3d"0" aria-haspopup\x3d"true" aria-expanded\x3d"false"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_pageNumLabel"\x3e\x3c/span\x3e${!icons.inline-end.chevron-down.16}\r\n        \x3c/button\x3e\r\n        \x3cnav class\x3d"dropdown-menu dropdown-right" role\x3d"menu"\x3e\r\n          \x3cbutton class\x3d"js-page-num-link dropdown-link is-active" role\x3d"menuitem" data-num\x3d"20"\x3e20\x3c/button\x3e\r\n          \x3cbutton class\x3d"js-page-num-link dropdown-link" role\x3d"menuitem" data-num\x3d"60"\x3e60\x3c/button\x3e\r\n          \x3cbutton class\x3d"js-page-num-link dropdown-link" role\x3d"menuitem" data-num\x3d"100"\x3e100\x3c/button\x3e\r\n        \x3c/nav\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/CreateLayersDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"trailer-1 step-indicator-container"\x3e\r\n    \x3cdiv class\x3d"add-datastore-step active" id\x3d"step1"\x3e\r\n      \x3cdiv class\x3d"step-text"\x3e${i18n.step1}\x3c/div\x3e\r\n      \x3cdiv class\x3d"step-label"\x3e${i18n.step1Description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"add-datastore-step" id\x3d"step2"\x3e\r\n      \x3cdiv class\x3d"step-text"\x3e${i18n.step2}\x3c/div\x3e\r\n      \x3cdiv class\x3d"step-label"\x3e${i18n.step2Description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"add-datastore-step" id\x3d"step3"\x3e\r\n      \x3cdiv class\x3d"step-text"\x3e${i18n.step3}\x3c/div\x3e\r\n      \x3cdiv class\x3d"step-label"\x3e${i18n.step3Description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cform\r\n    data-dojo-attach-point\x3d"containerNode"\r\n    class\x3d"data-store-form"\r\n    enctype\x3d"multipart/form-data"\r\n    action\x3d""\r\n    method\x3d"POST"\r\n    autocomplete\x3d"off"\r\n    data-dojo-attach-event\x3d"onsubmit:onSubmit"\r\n  \x3e\r\n    \x3cdiv class\x3d"clearfix"\x3e\r\n      \x3cdiv class\x3d"step-container step-1"\x3e\r\n        \x3cdiv slot\x3d"content" class\x3d"dateFieldssDiv"\x3e\r\n          \x3cdiv class\x3d"timeZoneLabel"\x3e\r\n            ${i18n.timeZoneOfTheData}\r\n            \x3cdiv data-dojo-attach-point\x3d"timeZoneInfoButton"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cselect\r\n            class\x3d"timeZoneSelect"\r\n            data-dojo-attach-point\x3d"timeZoneSelect"\r\n            data-dojo-attach-event\x3d"onchange: _timeZoneSelectChange"\r\n            aria-label\x3d"${i18n.timeZoneOfTheData}"\r\n          \x3e\r\n          \x3c/select\x3e\r\n          \x3cdiv class\x3d"dayLightSavingsCheckBox"\x3e\r\n            \x3ccalcite-checkbox\r\n              scale\x3d"l"\r\n              data-dojo-attach-point\x3d"timeZoneCheckBox"\r\n              id\x3d"timeZoneCheckBox"\r\n              disabled\r\n            \x3e\x3c/calcite-checkbox\x3e\r\n            \x3ccalcite-label scale\x3d"l" data-dojo-attach-point\x3d"timeZoneCheckBoxLabel" class\x3d"checkBoxLabel" for\x3d"timeZoneCheckBox"\x3e\r\n              ${i18n.adjustDayLightSavings}\r\n            \x3c/calcite-label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"timeZoneLabel"\x3e\r\n            ${i18n.preferredTimeZone}\r\n            \x3cdiv data-dojo-attach-point\x3d"preferredTimeZoneInfoButton"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cselect\r\n            class\x3d"timeZoneSelect"\r\n            data-dojo-attach-point\x3d"preferredTimeZoneSelect"\r\n            data-dojo-attach-event\x3d"onchange: _timeZoneSelectChange"\r\n            aria-label\x3d"${i18n.preferredTimeZone}"\r\n            disabled\r\n          \x3e\r\n        \x3c/select\x3e\r\n          \x3cdiv class\x3d"dayLightSavingsCheckBoxPreferredTimeZone"\x3e\r\n            \x3ccalcite-checkbox\r\n              scale\x3d"l"\r\n              data-dojo-attach-point\x3d"preferredTimeZoneCheckBox"\r\n              id\x3d"preferredTimeZoneCheckBox"\r\n              disabled\r\n            \x3e\x3c/calcite-checkbox\x3e\r\n            \x3ccalcite-label scale\x3d"l" class\x3d"checkBoxLabel" data-dojo-attach-point\x3d"preferredTimeZoneCheckBoxLabel" id\x3d"preferredTimeZoneCheckBox" for\x3d"preferredTimeZoneCheckBox"\x3e\r\n              ${i18n.adjustDayLightSavings}\r\n            \x3c/calcite-label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"step-container step-2 hide"\x3e\r\n        \x3cdiv class\x3d"folder-container"\x3e\r\n          \x3clabel for\x3d"folder" class\x3d"trailer-0"\x3e ${i18n.saveInFolder} \x3c/label\x3e\r\n          \x3cdiv class\x3d"flex"\x3e\r\n            \x3cselect\r\n              id\x3d"layers_tab__portalFolderSelect"\r\n              data-dojo-type\x3d"dijit/form/Select"\r\n              style\x3d"width: 100% !important;"\r\n              class\x3d"folderDropdownSelect folderDropdown create-layers-dropdown"\r\n              data-dojo-attach-point\x3d"_folders"\r\n            \x3e\x3c/select\x3e\r\n            \x3cbutton class\x3d"btn btn-clear btn-create" data-dojo-attach-point\x3d"createButton"\x3e${i18n.createNew}\x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"step-container step-3 hide"\x3e\r\n        \x3cdiv\x3e\r\n          \x3cp class\x3d"trailer-half"\x3e${i18n.serverInformation}\x3c/p\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"serversGridContainer" class\x3d"servers-grid-container"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"leader-1"\x3e\r\n          \x3clabel for\x3d"serverFolder" class\x3d"trailer-half"\x3e ${i18n.serverFolder} \x3c/label\x3e\r\n          \x3cfieldset class\x3d"fieldset-radio"\x3e\r\n            \x3clabel\r\n              \x3e\x3cinput\r\n                type\x3d"radio"\r\n                name\x3d"serverFolderRadio"\r\n                checked\x3d"checked"\r\n                value\x3d"sameAsPortalFolder"\r\n              /\x3e${i18n.sameAsPortalFolder}\x3c/label\r\n            \x3e\r\n            \x3clabel\x3e\x3cinput type\x3d"radio" name\x3d"serverFolderRadio" value\x3d"newFolder" /\x3e${i18n.newFolder}\x3c/label\x3e\r\n          \x3c/fieldset\x3e\r\n          \x3cdiv class\x3d"flex"\x3e\r\n            \x3cinput\r\n              type\x3d"text"\r\n              data-dojo-attach-point\x3d"serverFolder"\r\n              disabled\r\n              placeholder\x3d"${i18n.serverFolderPlaceholder}"\r\n            /\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"leader-quarter text-light font-size--2 hide" data-dojo-attach-point\x3d"exampleUrlContainer"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"errorNode" class\x3d"alert alert-red leader-half"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"loader padding-leader-3 padding-trailer-2" data-dojo-attach-point\x3d"loader"\x3e\r\n        \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"loader-text"\x3e${i18n.loading}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"action-buttons leader-1"\x3e\r\n      \x3cbutton class\x3d"btn btn-transparent" id\x3d"cancel-button" name\x3d"cancelButton" data-dojo-attach-point\x3d"cancelButton"\x3e\r\n        ${i18n.cancelButton}\r\n      \x3c/button\x3e\r\n      \x3cspan class\x3d"right"\x3e\r\n        \x3cbutton class\x3d"btn btn-clear hide" id\x3d"back-button" name\x3d"backButton" data-dojo-attach-point\x3d"backButton"\x3e\r\n          ${i18n.backButton}\r\n        \x3c/button\x3e\r\n        \x3cbutton class\x3d"btn hide" id\x3d"start-button" name\x3d"addButton" type\x3d"submit" data-dojo-attach-point\x3d"startButton"\x3e\r\n          ${i18n.startButton}\r\n        \x3c/button\x3e\r\n        \x3cbutton class\x3d"btn" id\x3d"next-button" name\x3d"nextButton" data-dojo-attach-point\x3d"nextButton"\x3e\r\n          ${i18n.nextButton}\r\n        \x3c/button\x3e\r\n      \x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_layers.html":'\x3cdiv class\x3d"layers-tab"\x3e\r\n  \x3c!-- control bar section --\x3e\r\n  \x3csection class\x3d"hide trailer-half" data-dojo-attach-point\x3d"_controlBarContainer"\x3e\r\n    \x3cdiv class\x3d"js-control-bar"\x3e\x3c/div\x3e\r\n  \x3c/section\x3e\r\n\r\n  \x3c!-- error section --\x3e\r\n  \x3csection class\x3d"grid-container trailer-half leader-half hide" data-dojo-attach-point\x3d"_errorContainer"\x3e\r\n    \x3cdiv class\x3d"alert alert-full alert-red is-active leader-1" data-dojo-attach-point\x3d"_errorMessage"\x3e\x3c/div\x3e\r\n  \x3c/section\x3e\r\n\r\n  \x3c!-- notification section --\x3e\r\n  \x3csection class\x3d"grid-container trailer-half leader-half hide" data-dojo-attach-point\x3d"_notificationContainer"\x3e\r\n    \x3cdiv class\x3d"column-24 layer-notification"\x3e\r\n      \x3cdiv class\x3d"notification-left"\x3e\r\n          \x3cdiv class\x3d"status-item-container" data-dojo-attach-point\x3d"_statusIconContainer"\x3e\r\n              \x3c!-- job in progress --\x3e\r\n              \x3ci class\x3d"icon-ui" data-dojo-attach-point\x3d"_iconJobRunning" class\x3d"hide"\x3e\r\n                \x3cimg src\x3d"./js/arcgisonline/css/images/LoadingAnimation_circle24blue.gif" /\x3e\r\n              \x3c/i\x3e\r\n      \r\n              \x3c!-- job complete --\x3e\r\n              \x3ci data-dojo-attach-point\x3d"_iconJobCompleted" class\x3d"hide"\x3e\r\n                \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"32" height\x3d"32" viewBox\x3d"0 0 32 32" class\x3d"svg-icon"\x3e\x3cpath fill\x3d"#5a9359" d\x3d"M11.927 22l-6.882-6.883-3 3L11.927 28 31.204 8.728l-3.001-3.001z"/\x3e\x3c/svg\x3e\r\n              \x3c/i\x3e\r\n      \r\n              \x3c!-- job error --\x3e\r\n              \x3ci class\x3d"icon-ui icon-ui-error hide" data-dojo-attach-point\x3d"_iconJobError"\x3e\x3c/i\x3e\r\n      \r\n              \x3c!-- job unknown status --\x3e\r\n              \x3ci class\x3d"icon-ui icon-ui-notice-round hide" data-dojo-attach-point\x3d"_iconJobUnknownStatus"\x3e\x3c/i\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"status-item-container" data-dojo-attach-point\x3d"_statusTextContainer"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"status-action-container" data-dojo-attach-point\x3d"_statuActionContainer"\x3e\r\n        \x3cbutton class\x3d"btn btn-transparent hide" data-dojo-attach-point\x3d"_dismissBtn"\x3e\r\n          ${i18n.itemProperties.dismiss}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/section\x3e\r\n\r\n  \x3c!-- create layers section --\x3e\r\n  \x3csection class\x3d"grid-container hide" data-dojo-attach-point\x3d"_createLayersContainer"\x3e\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n      \x3cdiv class\x3d"empty-view text-center leader-2"\x3e\r\n        \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 256 256" width\x3d"256"\x3e\r\n          \x3cpath\r\n            fill\x3d"#ccc"\r\n            d\x3d"M149.375 182.444l56.463-56.471-25.376-25.376 5.523-14.541-59.827-22.726L110.828 48H56v124h18.365l12.437 4.724 34.182 34.101 15.33-15.294 7.07 2.686 5.164-13.597zm50.806-56.472l-47.34 47.35 26.064-68.626zM112 54.828L141.172 84H112zM60 52h48v36h36v80H60zm60.984 153.17L95.95 180.199l36.263 13.775zm20.081-12.113L85.632 172H148V85.172L133.059 70.23l47.766 18.144-34.628 91.171z"\r\n          /\x3e\r\n        \x3c/svg\x3e\r\n        \x3ch3\x3e${i18n.itemProperties.noLayers}\x3c/h3\x3e\r\n        \x3cp class\x3d"font-size--2 text-constrain margin-auto" data-dojo-attach-point\x3d"_createLayersMessage"\x3e\x3c/p\x3e\r\n        \x3cbutton class\x3d"btn" data-dojo-attach-point\x3d"_createLayersBtn"\x3e${i18n.itemProperties.createLayers}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/section\x3e\r\n\r\n  \x3c!-- layers list container --\x3e\r\n  \x3csection class\x3d"grid-container hide" data-dojo-attach-point\x3d"_layersListContainer"\x3e\r\n    \x3cdiv class\x3d"column-24 flex"\x3e\r\n      \x3cdiv class\x3d"view-wrap js-view-wrap"\x3e\r\n        \x3c!--\r\n          left side\r\n          \x3cdiv class\x3d"js-filter-wrap"\x3e\x3c/div\x3e\r\n        --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-trailer-half flex break-word"\x3e\r\n          \x3cdiv class\x3d"font-size--1 inline-block flex-1 flex flex-align-center filter-status-wrap"\x3e\r\n            \x3c!-- Current/Total counts --\x3e\r\n            \x3cspan\r\n              class\x3d"padding-left-0 font-size--2 flex-0 break-word border-box text-ellipsis range-text"\r\n              data-dojo-attach-point\x3d"_rangeText"\r\n            \x3e\r\n              \x3cspan data-dojo-attach-point\x3d"_pageRange"\x3e\x3c/span\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"folder-container hide" data-dojo-attach-point\x3d"_folderContainer"\x3e \x3c/span\x3e\r\n            \x3cspan\x3e\r\n              \x3cbutton class\x3d"btn btn-transparent btn-red-transparent hide" data-dojo-attach-point\x3d"_deleteBtn"\x3e\r\n                \x3ci class\x3d"icon-ui-trash"\x3e \x3c/i\x3e ${i18n.itemProperties.deleteAllLayers}\r\n              \x3c/button\x3e\r\n            \x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Content Views --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-trailer-half js-content js-views"\x3e\x3c/div\x3e\r\n\r\n        \x3c!-- Pagination --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-leader-half padding-trailer-half js-pagination"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/section\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/layers/_empty.html":'\x3cdiv class\x3d"datasets-empty"\x3e\r\n  \x3cdiv class\x3d"js-empty-view text-center"\x3e\r\n    \x3cp class\x3d"font-size--2 text-constrain margin-auto"\x3e\r\n      ${i18n.itemProperties.noLayersSearch}\r\n    \x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/pages/item/widgets/templates/layers/_none.html":"\x3cdiv\x3enone\x3c/div\x3e","url:arcgisonline/pages/item/widgets/templates/layers/_tableHead.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-checkbox ${selectClass}" role\x3d"columnheader"\x3e\r\n    \x3clabel class\x3d"table-select-cell-sort table-select-check-all"\x3e\r\n      \x3cinput type\x3d"checkbox" aria-label\x3d"${i18n.filters.selectAll}" class\x3d"js-select-all" /\x3e\r\n    \x3c/label\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-large"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" role\x3d"columnheader" data-sort\x3d"layerName" data-sort-order\x3d"asc"\x3e${i18n.itemProperties.layerName1}\x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-medium"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" role\x3d"columnheader" data-sort\x3d"layerType" data-sort-order\x3d"asc"\x3e\r\n      ${i18n.itemProperties.layerTypeLabel}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-large"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" role\x3d"columnheader" data-sort\x3d"datasetName" data-sort-order\x3d"asc"\x3e\r\n      ${i18n.itemProperties.datasetName}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-medium"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" role\x3d"columnheader" data-sort\x3d"created" data-sort-order\x3d"desc"\x3e\r\n      ${i18n.itemProperties.layerCreated}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/layers/_tableRow.html":'\x3cdiv class\x3d"table-select-row flex table-select-row-avatar" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1 layer-name" role\x3d"cell"\x3e\r\n    \x3cdiv class\x3d"flex-align-center"\x3e\r\n      \x3cimg\r\n        src\x3d"${item.iconUrl}"\r\n        alt\x3d"${item.layerType}"\r\n        title\x3d"${item.layerType}"\r\n        width\x3d"16"\r\n        height\x3d"16"\r\n        class\x3d"item-icon"\r\n      /\x3e\r\n      \x3ca href\x3d"${item.itemUrl}" target\x3d"_blank" class\x3d"layer-link"\x3e\r\n        ${item.layerName}\r\n        \x3csvg class\x3d"launch" xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 16 16"\x3e\r\n          \x3cpath d\x3d"M14 8h1v7H1V1h7v1H2v12h12zm-4-7v1h3.29L7.62 7.67l.71.71L14 2.71V6h1V1z" /\x3e\r\n        \x3c/svg\x3e\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" title\x3d"${item.layerType}" role\x3d"cell"\x3e\r\n    ${item.layerType}\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" title\x3d"${item.datasetName}" role\x3d"cell"\x3e\r\n    ${item.datasetName}\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" role\x3d"cell"\x3e ${item.createdDisplay} \x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/layers/_controlBarActions.html":'\x3cdiv class\x3d"flex align-middle tooltip tooltip--data"\r\n  data-tooltip\x3d"${i18n.itemProperties.syncLayersTooltip}"\x3e\r\n  \x3cbutton id\x3d"syncLayersBtn" data-tooltip\x3d"${i18n.itemProperties.syncLayersTooltip}"\r\n    class\x3d"btn btn-clear js-action-syncLayers" data-action\x3d"syncLayers"\x3e\r\n    ${i18n.itemProperties.syncLayers}\r\n  \x3c/button\x3e\r\n  \x3cdiv class\x3d"margin-left-1 margin-right-1 font-size--1 margin-auto-vertical" id\x3d"syncTime"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/SubNav/templates/_option.html":'\x3ca\r\n  href\x3d"#${id}"\r\n  data-tab\x3d"${id}"\r\n  data-logClick\x3d"${logClick}"\r\n  role\x3d"tab"\r\n  aria-selected\x3d"false"\r\n  class\x3d"js-subnav-link subnav-link ${isActive} ${show:hide} ${classes:empty}"\r\n  aria-controls\x3d"tabcontent"\x3e\r\n  \x3cspan class\x3d"subnav-link__text no-pointer"\x3e${label}\x3c/a\x3e\r\n',"url:arcgisonline/pages/dijit/SubNav/templates/_title.html":'\x3cdiv class\x3d"js-subnav-edit subnav-edit flex flex-column flex-1 flex-align-center break-word"\x3e\r\n  \x3ch1 class\x3d"subnav-title ${_titleTypeSize}" id\x3d"pagetitle"\x3e${titleText}\x3c/h1\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/SubNav/templates/_paths.html":'\x3cdiv class\x3d"flex flex-1 flex-align-center break-word js-subnav-paths"\x3e\r\n  ${paths}\r\n\x3c/div\x3e\r\n',"url:arcgisonline/pages/dijit/SubNav/templates/_path.html":'\x3ca href\x3d"#" class\x3d"subnav-breadcrumb js-subnav-path ${lastPath} text-ellipsis"\x3e\r\n  \x3cspan class\x3d"${showBack} inline-block padding-right-quarter subnav-breadcrumb-back"\x3e${icons.arrow-left.24}\x3c/span\x3e${title}\r\n\x3c/a\x3e\r\n',"url:arcgisonline/pages/dijit/SubNav/templates/SubNav.html":'\x3cheader class\x3d"subnav" role\x3d"banner"\x3e\r\n  \x3cdiv class\x3d"subnav-wrap grid-container flex phone-flex-column js-subnav-wrap"\x3e\r\n    \x3cdiv class\x3d"flex flex-1 flex-align-center phone-flex-column ${_titleTypeSize}"\x3e\r\n      \x3cspan class\x3d"js-subnav-title-wrap flex-1 flex"\x3e${!titleHTML}\x3c/span\x3e\r\n      \x3cbutton class\x3d"js-subnav-expand subnav-expand ${hideLinks}" aria-label\x3d"${i18n.common.toggleSubNav}" aria-expanded\x3d"false"\x3e\r\n        \x3cspan class\x3d"js-subnav-current-label subnav-expand__current-label no-pointer inline-block margin-right-half margin-left-0"\x3e${activeLabel}\x3c/span\x3e\r\n        \x3csvg class\x3d"subnav-expand-icon no-pointer" xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"16" height\x3d"16" viewBox\x3d"0 0 16 16"\x3e\r\n          \x3cpath fill\x3d"#FFF" d\x3d"M8 11.5l-7-7h14z"/\x3e\r\n        \x3c/svg\x3e\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cnav class\x3d"subnav-links ${hideLinks} js-subnav-links flex-0 flex" role\x3d"tablist" aria-labelledby\x3d"pagetitle"\x3e${!linksHTML}\x3c/nav\x3e\r\n  \x3c/div\x3e\r\n\x3c/header\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_item.html":'\x3cdiv class\x3d"flex-column flex-1"\x3e\r\n  \x3cdiv class\x3d"js-subnav-wrapper"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"alert alert-yellow alert-full alert-inline js-public-data-collection-alert"\x3e\r\n    \x3cdiv class\x3d"grid-container"\x3e\r\n      \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv class\x3d"flex flex-center"\x3e\r\n          \x3cdiv class\x3d"flex-0 margin-right-half"\x3e\r\n            ${icons.inline.exclamation-mark-triangle.16}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"flex-1 font-size--2"\x3e\r\n            ${i18n.itemProperties.publicDataCollection.alertMessage}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"flex-0"\x3e\r\n              \x3cbutton class\x3d"btn btn-transparent margin-left-half js-public-data-collection-enable"\x3e${i18n.itemProperties.publicDataCollection.allowDataCollection}\x3c/button\x3e\r\n              \x3cbutton class\x3d"btn btn-transparent margin-left-half js-public-data-collection-unshare"\x3e${i18n.itemProperties.publicDataCollection.unshare}\x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv\r\n    class\x3d"js-item-content hide tab-content flex-column flex-1"\r\n    id\x3d"tabcontent"\r\n    aria-live\x3d"polite"\r\n    role\x3d"tabpanel"\r\n  \x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"js-item-loader"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_loader.html":'\x3cdiv class\x3d"loader is-active padding-leader-3 padding-trailer-3"\x3e\r\n  \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"loader-text"\x3e${i18n.common.loading}\x3c/div\x3e\r\n\x3c/div\x3e',"*now":function(e){e(['dojo/i18n!*preload*arcgisonline/pages/nls/item*["ar","bg","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},
"*noref":1}});
define("arcgisonline/pages/item","require exports tslib calcite-web/js/calcite-web taginsert/umd/taginsert moment/moment dojo/dom-attr dojo/dom-construct dojo/dom-class dojo/_base/lang dojo/_base/window dojo/_base/event dojo/has dojo/on dojo/query dojo/json dojo/promise/all dojo/Deferred dojo/when dojo/string dojo/hash dojo/topic esri/lang ../tsutils/declareDecorator ../sharing/dijit/dialog/_CreateItemUtilMixin ../sharing/util ../esriGeowConfig ../pages/basePage ./pageUtil ./utils/clone ./utils/item ./utils/arrays ./utils/date ./utils/dom ./utils/icons ./utils/formatters ./utils/verified ./utils/notebook ./utils/number ./utils/strings ./serviceUtil ./statusUtil ./utils/alerts ./utils/layer ./item/_Actions ./portal/PortalItem ./item/widgets/_settings ./item/widgets/_datasets ./item/widgets/_outputs ./item/widgets/_overview ./item/widgets/_visualize ./item/widgets/_imageManagement ./item/widgets/_data ./item/widgets/_usage ./item/widgets/_preview ./item/widgets/_layers ./item/widgets/_tasks ./item/widgets/_snapshots ./item/widgets/_snippetPreview ./dijit/SubNav dojo/text!./item/widgets/templates/_item.html dojo/text!./item/widgets/templates/_loader.html dojo/i18n!../nls/arcgisonline ./utils/setItemUrls ./utils/search ./components/ManageBlockedApps/blocked-apps-service ../sharing/dijit/dialog/CreateAppDlg ./utils/mapViewer xstyle/css!./item/widgets/css/tasks.css".split(" "),function(e,
K,p,a,g,m,n,b,c,d,l,h,f,r,q,t,w,u,v,x,z,A,B,J,P,R,S,T,E,I,F,D,C,y,G,L,O,U,M,Q,Y,fa,va,Aa,pa,N,V,Z,ba,ma,sa,Ea,ya,wa,aa,ca,ka,qa,da,ia,ra,Fa,ea,xa,ta,Ba,Na,Ra){a=p.__importDefault(a);g=p.__importDefault(g);m=p.__importDefault(m);n=p.__importDefault(n);b=p.__importDefault(b);c=p.__importDefault(c);d=p.__importDefault(d);l=p.__importDefault(l);h=p.__importDefault(h);f=p.__importDefault(f);r=p.__importDefault(r);q=p.__importDefault(q);t=p.__importDefault(t);w=p.__importDefault(w);u=p.__importDefault(u);
v=p.__importDefault(v);x=p.__importDefault(x);z=p.__importDefault(z);A=p.__importDefault(A);B=p.__importDefault(B);J=p.__importDefault(J);P=p.__importDefault(P);R=p.__importDefault(R);S=p.__importDefault(S);T=p.__importDefault(T);E=p.__importDefault(E);I=p.__importDefault(I);F=p.__importDefault(F);D=p.__importDefault(D);C=p.__importDefault(C);y=p.__importDefault(y);G=p.__importDefault(G);L=p.__importDefault(L);O=p.__importDefault(O);U=p.__importDefault(U);M=p.__importDefault(M);Q=p.__importDefault(Q);
Y=p.__importDefault(Y);fa=p.__importDefault(fa);va=p.__importDefault(va);pa=p.__importDefault(pa);N=p.__importDefault(N);V=p.__importDefault(V);Z=p.__importDefault(Z);ba=p.__importDefault(ba);ma=p.__importDefault(ma);sa=p.__importDefault(sa);Ea=p.__importDefault(Ea);ya=p.__importDefault(ya);wa=p.__importDefault(wa);aa=p.__importDefault(aa);ca=p.__importDefault(ca);ka=p.__importDefault(ka);qa=p.__importDefault(qa);da=p.__importDefault(da);ia=p.__importDefault(ia);ra=p.__importDefault(ra);Fa=p.__importDefault(Fa);
ea=p.__importDefault(ea);xa=p.__importDefault(xa);Ba=p.__importDefault(Ba);Na=p.__importDefault(Na);return function(){function Ca(){this.baseClass="item flex-1 flex-column view-background";this.skipToContent="main-content-area";this.i18n=ea.default;this.baseTelemetryPayload={};this.topImprovementClicked=!1;this.blockedApps=[];this.hostedServicePattern="^[^\\\\.@~\\`!#$%\\^\x26*+\x3d\\-\\[\\]';,\\/\\{\\}\\|\":\x3c\x3e\\?]+$";this.namePattern="^[^\x3c\x3e]+$"}Ca.prototype.construtor=function(){};Ca.prototype.postCreate=
function(){this.inherited(arguments);var H=b.default.create("input");this._supportsFormValidation=!(0,f.default)("safari")&&"required"in H&&"pattern"in H;this.i18n.itemLinks.openNotebook=U.default.notebooksBetaFormatter(this.i18n.itemLinks.openNotebook)};Ca.prototype.startup=function(){var H=this;this.inherited(arguments);var W=E.default.getQueryParams(),ha=(0,ta.semanticSearchEnabled)(this.portal,this.portalUser)?"enriched":"";this.telemetry&&W.fromSearch&&(this.telemetry.endWorkflow("search",{details:W.searchTerm,
position:parseInt(W.searchPosition,10),facetValue:W.searchFacet,attribute:ha}),E.default.removeQueryParams(["fromSearch","searchPosition","searchTerm","searchFacet"]));this.getMemberDefaults().then(function(){return H.getHomePageConfig()}).then(function(){return H.portal.isPortal&&H.portal.getFederatedServers()}).then(function(){return H.fetchItem()}).then(function(na){return H.fetchSubLayer(na,W)}).then(function(na){var za,Ga,Oa=na.item;H.sublayer=na.sublayer;H.sublayer&&(null===(za=H.subnav)||void 0===
za?void 0:za.domNode.querySelector('a[data-tab\x3d"settings"]').classList.add("hide"));H.baseTelemetryPayload={eventType:"other",pageName:"item",pageUrl:window.location.href,path:window.location.pathname,attribute:Oa.type};null===(Ga=H.telemetry)||void 0===Ga?void 0:Ga.logEvent(p.__assign(p.__assign({},H.baseTelemetryPayload),{category:"item page view",details:Oa.access}));F.default.getBadges(Oa,!0,H.portalUser,!1)&&F.default.getBadges(Oa,!0,H.portalUser,!1).split(",").forEach(function(Ia){var Ka;
null===(Ka=H.telemetry)||void 0===Ka?void 0:Ka.logEvent({category:"item badge",pageName:"item",pageUrl:window.location.href,attribute:Oa.type,label:Ia,details:Oa.id})});return H.renderPage(Oa)}).then(function(){H.emit("ready")},function(na){H.emit("error",na)})};Ca.prototype.destroy=function(){var H;this._destroyTab();null===(H=this.subnav)||void 0===H?void 0:H.destroy();this.inherited(arguments)};Ca.prototype.refreshItemLayers=function(){this._item.serviceInfo=void 0;this._item.sourceData=void 0;
this._item.relatedItems={};this.processItem(this._item).then(function(){A.default.publish("item-layers/refreshed")})};Ca.prototype._setActionUrlsAttr=function(H){var W;null===(W=H.openIn)||void 0===W?void 0:W.forEach(function(ha){return pa.default[ha](H)})};Ca.prototype._setAttributeCssClassesAttr=function(H){var W,ha,na;H.attributes=[];"url snippet description commentsEnabled numComments spatialReference accessInformation extent licenseInfo operationalLayers baseMapLayers featureLayers elevationLayers tools tables codeAttachment projectContent presentation screenshots tags resultData resultVisualizations resultDataViews sourceData serviceLink scoreCompleteness solutionContent workflowContent".split(" ").forEach(function(za){B.default.isDefined(H[za])&&
H[za]&&H.attributes.push("has-"+za)});H.attributes.push(H.hasMetadata?"has-metadata":"has-no-metadata");H.attributes.push(D.default.includes(H.typeKeywords,"Involved Lookup")?"has-geocodeReview":"has-no-geocodeReview");this.portal.isPortal&&H.isHostedService&&"Feature Service"===H.type&&(H.attributes.push(D.default.includes(H.typeKeywords,"providerSDS")?"":"has-arcobjects"),H.attributes.push(D.default.includes(H.typeKeywords,"providerBDS")?"has-elastic":""),H.attributes.push(H.isSpatiotemporal?"has-spatiotemporal":
""));H.attributes.push(H.hasResources?"has-resources":"");H.attributes.push(H.hasViewStyle?"has-viewStyle":"");H.attributes.push((null===(W=H.openIn)||void 0===W?0:W.length)||D.default.includes(H.types,"is-download")||D.default.includes(H.types,"is-file")||D.default.includes(H.types,"is-desktop")||D.default.includes(H.types,"is-pdf")||H.defaultOpenText?"has-defaultOpen":"");H.attributes.push(("Form"===H.type||"QuickCapture Project"===H.type)&&(null===(ha=H.relatedService)||void 0===ha?0:ha.length)?
"has-formContent":"");H.attributes.push("Solution"===H.type&&H.itemData&&Array.isArray(H.itemData.templates)&&0<H.itemData.templates.length?"has-solutionContent":"");H.attributes.push("Workflow"===H.type&&(null===(na=H.itemData)||void 0===na?0:na.workflowLocations)?"has-workflowContent":"");H.attributes.push(D.default.includes(H.typeKeywords,"HTML")||D.default.includes(H.typeKeywords,"HTML3D")?"has-appBuilderPlatform":"");H.attributes.push(D.default.includes(H.typeKeywords,"Cloud Drive")?"has-cloudDriveData":
"")};Ca.prototype._setBodyCssClassesAttr=function(H){var W,ha,na,za,Ga=!!this.portalUser,Oa=(0,f.default)("trident"),Ia=Ga&&(null===(W=this.portalUser)||void 0===W?void 0:W.isOrgUser);W=[Ga?"is-signed-in":"is-signed-out"];var Ka=document.body.className.split(" ").filter(function(La){return 0===(null===La||void 0===La?void 0:La.indexOf("dj_"))||-1<(null===La||void 0===La?void 0:La.indexOf("-blocked"))}),Sa=!this.portal.isPortal&&H.isHostedService&&"Feature Service"===H.type&&!H.typeKeywords.includes("View Service")&&
0<=H.subInfo,Ua=!this.portal.isPortal&&H.isHostedService&&"Image Service"===H.type&&!D.default.includes(H.typeKeywords,"Tiled Imagery Layer")&&!D.default.includes(H.typeKeywords,"Elevation 3D Layer")&&0<=H.subInfo,Wa=D.default.includes(H.typeKeywords,"usesSnapshot"),hb="Scene Service"===H.type&&D.default.includes(H.typeKeywords,"Voxel"),kb=!!H.origin;W.push(this.sublayer?"":"is-parent-item");W.push(this.portal.isPortal?"is-on-premise":"is-online");W.push(Ia?"":"is-public-user");W.push(H.canUpdate?
"can-update":"is-viewer");W.push(this.canDeleteItem(H)?"can-delete":"");W.push(H.isOwner?" is-owner":"");W.push(H.isAdmin?" is-admin":"");W.push(this.portal.metadataEditable?"is-metadata-enabled":"is-metadata-disabled");W.push(S.default.webExperienceEnabled&&(null===(ha=this.portalUser)||void 0===ha?0:ha.isOrgUser)?"is-webExperience-enabled":"");W.push(H.canShowSocialMediaLinks?"can-share-social":"");W.push(H.hasKMLItemData?"is-update":"");W.push(H.canChangeOwner?"can-change-owner":"");W.push("Dashboard"===
H.type&&H.isSupportedBrowser&&(Ga&&Ia&&this.portalUser.canCreateItems&&!H.isViewOnly||H.isAdmin)?"can-copy-dashboard":"");W.push(S.default.sceneViewerEnabled?"is-sceneViewer-enabled":"");W.push(H.isAdmin&&H.canAppendData?"can-appendData":"");W.push(H.contentStatus?"deprecated"===H.contentStatus?"is-deprecated":"is-authoritative":"has-no-contentStatus");W.push(this.isAdminAndItemBelongsToOrg(H)||H.isOwner&&Ia||H.isOwner&&this.isEsriPublicAccount(H.owner)?"can-edit-contentStatus":"");W.push(this.isAdminAndItemBelongsToOrg(H)?
"can-edit-authoritative-status":"");W.push(S.default.webAppBuilderEnabled&&Ia?"is-wab-enabled":"");W.push(U.default.notebookServerConfigured()?"has-notebookServer-enabled":"");W.push(S.default.replaceLayerEnabled||this.portal.isPortal&&!this.portal.isKubernetes()?"is-replaceLayer-enabled":"");W.push("Notebook"===H.type&&Ia?"is-notebook":"");W.push(D.default.includes(H.typeKeywords,"Route Layer")?"is-route-layer":"");W.push(Ia&&this.portalUser.userRole.canCreateNotebooks()?"can-create-notebooks":"");
W.push(Ia&&this.portalUser.userRole.canPublishNotebooks()?"can-publish-notebooks":"");W.push(Ia&&this.portalUser.userRole.canCreateAdvancedNotebooks()?"can-use-arcpy-notebooks":"");W.push(Wa?"uses-snapshot":"");W.push(hb?"is-voxel":"");W.push(kb?"is-from-collaboration":"");W.push(H.isVelocity()?"is-iot":"");ha=-1<(null===(na=H.openIn)||void 0===na?void 0:na.indexOf("mapViewer"));W.push(ha&&!Oa?"is-map-viewer-beta":"");W.push(Sa?"has-attachments":"");W.push(Ua?"has-image-count":"");W.push(H.typeKeywords.includes("configurableApp")?
"is-instant-apps":"");W.push(this.portal.defaultMapViewer===Ra.MapViewerType.Modern?"is-map-viewer-modern":"is-map-viewer-classic");na=["OGCFeatureServer","Media Layer"].includes(H.type)||"Group Layer"===H.type&&!(null===(za=H.typeKeywords)||void 0===za?0:za.includes("Scene"));W.push(na?"is-only-map-viewer-modern":"is-multiple-map-viewer");c.default.contains(l.default.body(),"can-schedule-notebooks")&&W.push("can-schedule-notebooks");this._item.addBlockClasses(this._item.attributes);c.default.replace(l.default.body(),
W.concat(this._item.privileges||[]).concat(this._item.types||[]).concat(this._item.attributes||[]).concat(Ka||[]));U.default.canScheduleNotebooks(this.portalUser,H)};Ca.prototype._setTypeKeywordFlagsAttr=function(H){var W,ha,na,za=null===(W=this.portalUser)||void 0===W?void 0:W.userRole,Ga=null===za||void 0===za?void 0:za.canReassignOwnItems();W=(null===(ha=this.portalUser)||void 0===ha?void 0:ha.isOrgAdmin)||((null===za||void 0===za?void 0:za.canReassignOrgItems())&&za.canViewOrgItems()||Ga)&&za.canViewOrgUsers();
ha=this.portalUser&&(null===(na=H.itemOwner)||void 0===na?void 0:na.orgId)===this.portalUser.orgId;na=!D.default.includes(H.typeKeywords,"Offline Map Areas");za="Map Area"!==H.type&&!D.default.includes(H.typeKeywords,"MapAreaPackage");H.canChangeOwner=this.portalUser&&W&&ha&&na&&za||!1;H.setTypeKeywordFlags()};Ca.prototype.invalidInputHelper=function(H,W){var ha=this,na=function(Oa,Ia){ha._supportsFormValidation?Oa.setCustomValidity(Ia):(n.default.set(Oa,"data-customValidity",Ia),""===Ia&&ha.hideErrors())},
za=function(Oa,Ia,Ka){return"function"===typeof Oa?Oa.apply(Ia,Ka):Oa},Ga=function(){var Oa,Ia=(null===(Oa=H.value)||void 0===Oa?void 0:Oa.trim())||"";Oa=n.default.get(H,"pattern");var Ka=n.default.has(H,"required"),Sa="TEXTAREA"!==H.nodeName;Ia&&""!==Ia||!Ka?ha._supportsFormValidation&&Sa||!Oa?na(H,""):(new RegExp(Oa)).test(Ia)?na(H,""):na(H,za(W.invalidText,window,[H])):na(H,za(W.emptyText,window,[H]))};this._supportsFormValidation&&H.setCustomValidity(za(W.defaultText||"",window,[H]));this.own((0,r.default)(H,
"change",Ga),(0,r.default)(H,"input",Ga),(0,r.default)(H,"invalid",function(){var Oa,Ia,Ka,Sa,Ua,Wa=(null===(Oa=H.value)||void 0===Oa?void 0:Oa.trim())||"";Wa&&""!==Wa?(null===(Ia=H.validity)||void 0===Ia?0:Ia.patternMismatch)||(null===(Ka=H.validity)||void 0===Ka?0:Ka.badInput)||(null===(Sa=H.validity)||void 0===Sa?0:Sa.typeMismatch)||(null===(Ua=H.validity)||void 0===Ua?0:Ua.customError)?na(H,za(W.invalidText,window,[H])):na(H,""):na(H,za(W.emptyText,window,[H]))}))};Ca.prototype.logItemAction=
function(H){var W;this.topImprovementClicked||(null===(W=this.telemetry)||void 0===W?void 0:W.logEvent(p.__assign(p.__assign({},this.baseTelemetryPayload),{category:"item action",action:H})))};Ca.prototype.loadEventHandlers=function(){var H=this;window.addEventListener("popstate",function(W){var ha;W="#"===window.location.hash.charAt(0)?window.location.hash.substring(1):window.location.hash;!E.default.getQueryParams().sublayer&&H.sublayer?"overview"===H._currentView?null===(ha=H.tabDijit)||void 0===
ha?void 0:ha.toggleSubLayer():(delete H.sublayer,H.updateTab("overview")):H.updateTab(W||"overview")});this.own((0,q.default)(".js-subnav-link",this.contentWrapper).on("click",function(W){null===W||void 0===W?void 0:W.preventDefault();(W=null===W||void 0===W?void 0:W.target)&&(0,z.default)(W.getAttribute("href").split("-")[0],!0)}),(0,q.default)(".js-telemetry-action",this.contentWrapper).on("click",function(W){var ha;return H.logItemAction(null===(ha=W.currentTarget)||void 0===ha?void 0:ha.getAttribute("data-telemetry-action"))}),
(0,r.default)(this.domNode,".js-alert .is-active:click",function(W){h.default.stop(W);b.default.empty((0,q.default)(".js-alert").shift())}),A.default.subscribe("/dojo/hashchange",function(W){((0,f.default)("ie")||(0,f.default)("trident")||(0,f.default)("edge"))&&H.updateTab(W)}),A.default.subscribe("thumbnail/update",function(){return H.getThumbnail(!0)}),A.default.subscribe("item/replaceLayerSuccess",function(){return H.handleReplaceLayerSuccess()}),this._item.watch(this._itemChangeHandler.bind(this)),
A.default.subscribe("imagery/update",function(W){H._checkForJobUpdate=!W.completed}),A.default.subscribe("inlineEdit/title/start",function(){return H.logItemAction("title")}),A.default.subscribe("inlineEdit/snippet/start",function(){return H.logItemAction("summary")}),A.default.subscribe("inlineEdit/description/start",function(){return H.logItemAction("description")}),A.default.subscribe("inlineEdit/categories/start",function(){return H.logItemAction("categories")}),A.default.subscribe("inlineEdit/tags/start",
function(){return H.logItemAction("tags")}),A.default.subscribe("inlineEdit/accessInformation/start",function(){return H.logItemAction("attribution")}),A.default.subscribe("inlineEdit/title/done",function(){H.subnav.updateText(H._item.title)}),(0,q.default)(".js-public-data-collection-enable",this.domNode).on("click",function(){H.updateTab("settings-general",!0).then(function(W){H.subnav.updateActiveTab("settings");W=W.domNode.querySelector(".js-public-data-collection-container");window.scrollTo({top:W.offsetTop-
40,behavior:"smooth"});W.classList.add("fieldset-checkbox--hightlight")})}),(0,q.default)(".js-public-data-collection-unshare",this.domNode).on("click",function(W){pa.default.share({evt:W,item:H._item,user:H.portalUser,page:H.page,portal:H.portal})}),this._item.watch("sharing",this.showPublicDataCollectionWarning.bind(this)),this._item.watch("typeKeywords",this.showPublicDataCollectionWarning.bind(this)),A.default.subscribe("settings/update/serviceInfo",function(W){H.showPublicDataCollectionWarning(null===
W||void 0===W?void 0:W.capabilities)}),A.default.subscribe("item-layers/refresh",function(){H.refreshItemLayers()}))};Ca.prototype._itemChangeHandler=function(H,W,ha){"typeKeywords"===H&&(this._item.typeKeywords=Q.default.stringToArray(ha,",",!1));"text"===H&&(this._item.itemData=t.default.parse(ha));"size"===H&&(0,q.default)(".js-item-size").attr("innerHTML","".concat(this.i18n.itemProperties.sizeLabel," ").concat(this._formatSize(this._item.size)));"subInfo"===H&&"Image Service"===this._item.type&&
(0,q.default)(".js-item-image-count").attr("innerHTML","".concat(this.i18n.itemProperties.imageCount," ").concat(this._formatNumber(this._item.subInfo)));"url"!==H&&"scoreCompleteness"!==H&&ha&&(0,q.default)(".if-".concat(H),this.contentWrapper).attr("innerHTML","tags"===H?this._formatTags(ha):"accessInformation"===H||"snippet"===H?this._linkify(ha):ha);"title"===H&&((0,q.default)(".js-title-input").attr("value",this._item.title),this.set("pageTitle",this._item.title));!this._item.isConfigurableApp||
"folderId"!==H&&"typeKeywords"!==H||(this.set("actionUrls",this._item),(0,q.default)(".js-action-configure").attr("href",this._item.configureUrl));this.set("typeKeywordFlags",this._item);this.set("attributeCssClasses",this._item);this.set("bodyCssClasses",this._item);"codeAttachmentChanged"===H&&!0===ha&&this.refreshCodeAttachment();"styleChanged"===H&&!0===ha&&this.getThumbnail(!0);"serviceChanged"===H&&!0===ha&&(this._item.set("maxAgeCheck",!0),this.refreshServiceInfo());"maxAgeCheck"===H&&!0===
ha&&this._item.ignoreCache&&this._item.ignoreCache()};Ca.prototype.renderPage=function(H){var W=this;b.default.place(x.default.substitute(ra.default,{i18n:ea.default,icons:G.default}),this.domNode);var ha=this.domNode.querySelector(".js-item-loader");ha.innerHTML=x.default.substitute(Fa.default,{i18n:ea.default});this._loader=ha.querySelector(".loader");this._content=this.domNode.querySelector(".js-item-content");this.own(this._item.watch("isLoaded",function(){var na,za,Ga,Oa;W._queryStringParams.jobid&&
(E.default.replaceCurrentLocation(E.default.removeUrlQueryParameter(location.href,"jobid")),delete W._queryStringParams.jobid,R.default.request({url:W._item.itemUrl}).then(function(Ia){var Ka,Sa,Ua=new N.default(d.default.mixin(Ia,{portal:W.portal}));H.set({scoreCompleteness:null!==(Ka=Ua.scoreCompleteness)&&void 0!==Ka?Ka:W._item.scoreCompleteness,thumbnail:Ua.thumbnail||W._item.thumbnail,thumbnailUrl:Ua.thumbnailUrl||W._item.thumbnailUrl,size:null!==(Sa=Ua.size)&&void 0!==Sa?Sa:W._item.size,extent:E.default.extentToString(Ia&&
Ia.extent||W._item.extent),description:Ua.description||W._item.description,snippet:Ua.snippet||W._item.snippet,tags:Ua.tags||W._item.tags});W.getThumbnail(!0).then(function(){W._destinationTab&&(0,z.default)(W._destinationTab,!0)})}));"Feature Service"===W._item.type&&(H.canUpdate||-1<(null===(za=null===(na=W._item.serviceInfo)||void 0===na?void 0:na.capabilities)||void 0===za?void 0:za.indexOf("Query")))&&(W._item.types=W._item.types.concat(["is-data"]),W.subnav&&W.subnav.showTab("data"),W._item.isTable||
(W._item.types=W._item.types.concat(["is-layer"]),null===(Ga=W.subnav)||void 0===Ga?void 0:Ga.showTab("visualize")),(0,Aa.containsOnlySubtypeGroupLayers)(W._item)&&(null===(Oa=W.subnav)||void 0===Oa?void 0:Oa.hideTab("visualize")));W.showPublicDataCollectionWarning();"template"===E.default.getQueryParams().createWebApp&&"Web Map"===H.type&&(E.default.removeQueryParams(["createWebApp"]),(new Na.default({item:W._item})).showWizard());W.canManageImageCollection()&&W.subnav&&(W.subnav.showTab("imageManagement"),
W.updateImageManagementTabState());W.showWhatsNew()}));return this.processItem(H).then(function(na){var za,Ga,Oa,Ia,Ka,Sa,Ua,Wa;W.canShareItem(na)&&W._item.privileges.push("can-share");W.canDeleteItem(na)&&(W._item.canDelete=!0,W._item.privileges.push("can-delete"));W.portalUser&&W.portalUser.canCreateItems&&W._item.privileges.push("can-create-items");(null===(Ga=null===(za=W.portalUser)||void 0===za?void 0:za.userRole)||void 0===Ga?0:Ga.canUpdateOrgItems())&&W._item.privileges.push("can-update-org-items");
!R.default.couldHaveArcGISDesktop()&&D.default.includes(W._item.types,"is-desktop")&&W._item.types.splice(W._item.types.indexOf("is-desktop"),1);if(na.url||na.itemDataUrl)za=-1<(null===(Oa=na.typeKeywords)||void 0===Oa?void 0:Oa.indexOf("Service Proxy"))?"".concat(-1<na.url.indexOf("?")?"\x26":"?","f\x3dpjson"):"",Oa="WFS"===na.type&&-1===(null===(Ia=na.url)||void 0===Ia?void 0:Ia.toLowerCase().indexOf("getcapabilities"))?"".concat(-1<na.url.indexOf("?")?"\x26":"?","request\x3dgetcapabilities"):"",
W.portal.isPortal?na.viewUrl=encodeURI(na.url?"".concat(na.url).concat(za).concat(Oa):na.itemDataUrl):(Ia="public"!==na.access?E.default.needsToken(na,na.url):na.url,na.viewUrl=encodeURI(Ia?"".concat(Ia).concat(za).concat(Oa):na.itemDataUrl));(!W.portal.isPortal||W.portal.isPortal&&"public"===W.portal.access&&"public"===W._item.access)&&(0,g.default)({item:na,imageSrc:"thumbnailUrl",noindex:function(hb){return D.default.includesAll(hb.robots,["noindex","nofollow"])},canonicalUrl:function(){return xa.default.canonicalUrl(na)}});
W.set("pageTitle",na.title);W.set("actionUrls",na);W.set("attributeCssClasses",na);W.set("bodyCssClasses",na);Ia=("#"===window.location.hash.charAt(0)?window.location.hash.substring(1):window.location.hash)||"overview";Oa=D.default.includes(na.typeKeywords,"Requires Subscription")&&(!W.portalUser||!(null===(Ka=W.portalUser)||void 0===Ka?0:Ka.isOrgUser))||na.isMapNotes||na.isMarkup;Ka=9>=(0,f.default)("ie");Ka={active:E.default.splitHashParts(Ia)[0],telemetry:W.telemetry,titleText:na.title,links:[{id:"overview",
label:ea.default.itemProperties.overview,logClick:!0},{id:"data",label:ea.default.itemProperties.data,logClick:!0,show:D.default.includes(W._item.types,"is-data")&&!Oa,classes:"js-status-disable"},{id:"imageManagement",label:ea.default.itemProperties.imageManagement,logClick:!0,show:D.default.includes(W._item.types,"is-imageManagement")&&W.canManageImageCollection()},{id:"visualize",label:ea.default.itemProperties.visualization,logClick:!0,show:D.default.includesSome(W._item.types,["is-layer","is-featureCollection",
"is-streamLayer","is-feedLayer"])&&!Oa&&!Ka,classes:"js-status-disable"},{id:"preview",label:ea.default.itemProperties.preview,logClick:!0,show:D.default.includes(W._item.types,"is-notebook")||W._item.typeKeywords.includes("Notebook Web Tool")},{id:"snippets",label:ea.default.itemProperties.preview,logClick:!0,show:["Code","Notebook","Snippet"].every(function(hb){return W._item.typeKeywords.includes(hb)})},{id:"tasks",label:ea.default.itemProperties.tasks,logClick:!0,show:W.canViewNotebookTasks(W._item),
classes:"if-can-schedule-notebooks"},{id:"snapshots",label:ea.default.itemProperties.snapshots,logClick:!0,show:D.default.includes(W._item.types,"is-notebook")&&U.default.notebookServerConfigured()&&(null===(Ua=null===(Sa=W.portalUser)||void 0===Sa?void 0:Sa.userRole)||void 0===Ua?void 0:Ua.canCreateNotebooks()),classes:"if-owner"},{id:"layers",label:ea.default.itemProperties.layers,logClick:!0,show:W.isDatastoreAndIsOwner(W._item)&&D.default.includes(W._item.typeKeywords,"egdb")&&!D.default.includesSome(W._item.typeKeywords,
["BDAW","bigquery","CDW","snowflake","redshift"])},{id:"usage",label:ea.default.itemProperties.itemUsage,logClick:!0,show:(W._item.isAdmin||W._item.isOwner||W._item.canUpdate)&&(null===(Wa=W.portalUser)||void 0===Wa?void 0:Wa.isOrgUser)&&!W.portal.isPortal&&W.itemCanShowDataTab(W._item),classes:"if-parent-item"},{id:"datasets",label:ea.default.itemProperties.datasets,logClick:!0,show:S.default.bdfsEnabled&&"Big Data File Share"===W._item.type},{id:"outputs",label:ea.default.itemProperties.outputs,
logClick:!0,show:S.default.bdfsEnabled&&"Big Data File Share"===W._item.type},{id:"settings",label:ea.default.itemProperties.settings,logClick:!0,show:W.itemCanShowSettingsTab(W._item),classes:"js-status-disable"}]};na.canUpdate&&!W.sublayer&&(Sa=W._item.isHostedService,Ka.edit={baseClass:"subnav-edit flex flex-1 flex-align-center break-word",editButtonClasses:"btn-link-white",prop:"title",value:na.title,required:!0,pattern:W.namePattern,emptyText:ea.default.itemProperties.error.needTitle,invalidText:Sa?
ea.default.itemProperties.error.serviceNameInvalid:ea.default.itemProperties.error.badCharacter,maxLength:Sa?90:void 0});W.subnav||(W.subnav=new ia.default(Ka,W.domNode.querySelector(".js-subnav-wrapper")),W.updateTab());W.loadEventHandlers();return na})};Ca.prototype.toggleSubLayer=function(H,W){var ha=this._item,na=ha.isHostedService,za=[{href:"#",title:this._item.title,id:"item",classes:"js-item-title-",onPathClick:function(){return E.default.removeQueryParams(["sublayer"],!0)},edit:this._item.canUpdate&&
{baseClass:"subnav-edit flex flex-1 flex-align-center break-word",titleClass:"subnav-breadcrumb flex flex-align-center",editButtonClasses:"btn-link-white",prop:"title",value:this._item.title,required:!0,pattern:this.namePattern,emptyText:ea.default.itemProperties.error.needTitle,invalidText:na?ea.default.itemProperties.error.serviceNameInvalid:ea.default.itemProperties.error.badCharacter,maxLength:na?90:void 0}}];H?(this.sublayer=H,H={href:"#",title:H.name,isActive:!0,id:"sublayer",edit:!ha.isLocationTrackingService&&
ha.canUpdate&&na&&{inputType:"layerRenameSubnav",prop:"layerRename",value:H.name,layerUrl:H.url,layerId:H.id,required:!0,pattern:this.namePattern,emptyText:this.i18n.itemProperties.error.needTitle,invalidText:this.i18n.itemProperties.error.badCharacter,showLoader:R.default.isPortal()}},za.push(H),this.subnav.updateBreadCrumbs(za),this.subnav.domNode.querySelector('a[data-tab\x3d"settings"]').classList.add("hide"),E.default.updateQueryParams({id:this._item.id,sublayer:this.sublayer.id},W)):(this.sublayer=
null,za[0].isActive=!0,this.subnav.updateBreadCrumbs(za),this.itemCanShowSettingsTab(this._item)&&this.subnav.domNode.querySelector('a[data-tab\x3d"settings"]').classList.remove("hide"),E.default.removeQueryParams(["sublayer"]))};Ca.prototype.canViewNotebookTasks=function(H){return H.isOwner&&D.default.includes(this._item.types,"is-notebook")&&this.portalUser.userRole.canScheduleNotebooks()};Ca.prototype.isDatastoreAndIsOwner=function(H){var W;return D.default.includes(H.types,"is-data-store")&&(H.isOwner||
(null===(W=this.portalUser)||void 0===W?void 0:W.isOrgAdmin))};Ca.prototype.canShareItem=function(H){return!H.isRetired&&F.default.canShareItem(H,this.portalUser)};Ca.prototype.canDeleteItem=function(H){return F.default.canDeleteItem(H,this.portalUser)};Ca.prototype.canReplaceLayer=function(H){return D.default.includes([""],H.type)};Ca.prototype.isAdminAndItemBelongsToOrg=function(H){var W,ha;return(null===(W=this.portalUser)||void 0===W?void 0:W.isOrgAdmin)&&(null===(ha=H.itemOwner)||void 0===ha?
void 0:ha.orgId)===this.portalUser.orgId};Ca.prototype.isEsriPublicAccount=function(H){return H.toLowerCase().startsWith("esri_")};Ca.prototype.itemCanShowDataTab=function(H){return"API Key"!==H.type};Ca.prototype.itemCanShowSettingsTab=function(H){return(H.canUpdate||H.canDelete)&&(!D.default.includes(H.types,"is-data-store")||this.isDatastoreAndIsOwner(H))};Ca.prototype.normalizeTab=function(H){var W=H;W=D.default.includes(["settings-general","settings-options"],H)?"settings":H;return D.default.includes("overview settings usage imageManagement visualize data layers preview tasks datasets outputs snapshots snippets".split(" "),
W)?W:"overview"};Ca.prototype.updateTab=function(H,W){var ha=this;void 0===H&&(H=window.location.hash.split("#")[1]);var na=new u.default,za,Ga=this._item;H=E.default.splitHashParts(H);var Oa=this._queryStringParams.jobid,Ia="true"===this._queryStringParams.showAppUsage,Ka=this.normalizeTab((null===H||void 0===H?void 0:H[0])||this.hashParts[0]||this._currentView||"overview");this.hideErrors();if(Ka!==this._currentView||W){!Ia||"layer"!==Ga.classification&&"app"!==Ga.classification||(Ka="layer"===
Ga.classification?"usage":"settings");if(!(Ga.canUpdate||"settings"!==Ka&&"usage"!==Ka||Ga.canDelete)&&"settings"===Ka||"layer"===Ga.classification&&Oa&&"settings"===Ka||"layers"===Ka&&!this.isDatastoreAndIsOwner(this._item))this._destinationTab=(0,z.default)(),Ka="overview",(0,z.default)(Ka,!0);this._destroyTab().then(function(){ha._currentView=Ka;ha._checkForJobUpdate&&fa.default.checkStatus(Ga).then(function(){return ha._checkForJobUpdate=!1});ha.subnav.hideEditLink();var Sa=!0;switch(Ka){case "settings":za=
V.default;break;case "usage":za=wa.default;break;case "visualize":za=sa.default;Sa=!1;break;case "imageManagement":za=Ea.default;Sa=!1;break;case "data":za=ya.default;break;case "preview":za=aa.default;break;case "tasks":za=ka.default;break;case "layers":za=ca.default;break;case "datasets":za=Z.default;break;case "outputs":za=ba.default;break;case "snapshots":za=qa.default;break;case "snippets":za=da.default;break;default:za=ma.default,Sa=!1,ha.subnav.showEditLink()}ha.canManageImageCollection()&&
ha.updateImageManagementTabState();c.default.toggle(ha.domNode,"view-background",Sa);ha.showTab(ha._item,za).then(function(Ua){var Wa;a.default.sticky();na.resolve(Ua);Ga.isLoaded&&ha._item.set("isLoaded",!0);null===(Wa=ha.domNode.querySelector('.js-subnav-link[data-tab\x3d"'.concat(Ka,'"]')))||void 0===Wa?void 0:Wa.classList.add("is-active")})});return na}};Ca.prototype.showTab=function(H,W){var ha=this,na=this.tabDijit=new W({page:this,item:H,i18n:this.i18n,portalUser:this.portalUser,sublayer:this.sublayer},
b.default.create("div",{},this._content)),za=new u.default;na.startup().then(function(Ga){Ga&&ha.hideLoader();za.resolve(na)});return za};Ca.prototype.updateImageManagementTabState=function(){var H,W;if(this.subnav){var ha=-1<(null===(W=null===(H=this._item.properties)||void 0===H?void 0:H.jobUrl)||void 0===W?void 0:W.indexOf("RasterAnalysisTools/GPServer/CreateImageCollection"))&&"completed"!==this._item.status;(0,q.default)('[data-tab\x3d"imageManagement"]',this.subnav.domNode).toggleClass("btn-disabled",
ha)}};Ca.prototype.canManageImageCollection=function(){var H,W;return"Image Service"===this._item.type&&-1<this._item.typeKeywords.indexOf("Managed Image Collection")&&(null===(W=null===(H=this.portalUser)||void 0===H?void 0:H.userRole)||void 0===W?void 0:W.canPublishDynamicImagery())&&(this._item.isAdmin||this._item.isOwner||this._item.canUpdate)};Ca.prototype.showWhatsNew=function(){this.portal.isPortal||pa.default.whatsNew({endDate:new Date("July 31, 2016"),key:"itemPage",redirectUrl:"https://blogs.esri.com/esri/arcgis/2016/05/26/introducing-a-new-experience-for-working-with-items-in-arcgis-online"})};
Ca.prototype.fetchItemResult=function(){var H=this._queryStringParams.id;H="".concat(this.portal.portalUrl,"content/items/").concat(H);return this._request({url:H})};Ca.prototype.fetchItem=function(H){var W=this,ha=new u.default,na=this._queryStringParams.id;this._items=this._items||[];this._items[na]&&!H?ha.resolve(this._items[na]):this.fetchItemResult().then(function(za){var Ga=new N.default(d.default.mixin(za,{portal:W.portal}));Ga.commentsRssUrl="".concat(Ga.itemUrl,"/comments?f\x3drss");(0,w.default)({itemOwner:W.getItemOwner(Ga)}).then(function(Oa){var Ia;
Ga.set(Oa);Oa={comments:W.fetchComments(Ga),isFavorite:E.default.isFavorite(Ga),sharing:E.default.getItemSharing(Ga),verified:O.default.getVerifiedInfo(Ga),blockedApps:(null===(Ia=W.portalUser)||void 0===Ia?0:Ia.orgId)?W.checkBlockedApps():null};(0,w.default)(Oa).then(function(Ka){Ga.removeBlockedTypes(W.blockedApps);Ga.set(Ka);Ga.set("ownerText",L.default.formatOwnerText(Ga));W.set("typeKeywordFlags",Ga);Ga.displayName=W._formatDisplayName(Ga);W._items[na]=Ga;W._item=Ga;W.getThumbnail(!W._item.thumbnail&&
!W._queryStringParams.jobid&&!W.portal.isPortal);ha.resolve(W._item)})})});return ha};Ca.prototype.checkBlockedApps=function(){var H=this,W=new u.default;Ba.default.getBlockedApps().then(function(ha){H.blockedApps=ha||[];W.resolve()},function(){W.resolve()});return W};Ca.prototype.fetchSubLayer=function(H,W){var ha=new u.default,na=E.default.getNeededToken(H);if(B.default.isDefined(W.sublayer)){var za=!1,Ga=void 0,Oa=H.url.lastIndexOf("/");if(-1<Oa)try{Ga=H.url.substring(Oa+1);var Ia=parseInt(Ga,
10);za=!isNaN(Ia)}catch(Sa){za=!1}if(za&&Ga!==W.sublayer)ha.resolve({item:H});else{var Ka=za&&Ga===W.sublayer?"".concat(H.url):"".concat(H.url,"/").concat(W.sublayer);W=p.__assign({url:Ka},na&&{content:{token:na}});this._request(W,na?void 0:{addToken:!1}).then(function(Sa){Sa.url=Ka;ha.resolve({item:H,sublayer:Sa})},function(Sa){ha.resolve({item:H})})}}else ha.resolve({item:H});return ha};Ca.prototype.fetchItemData=function(){var H=this,W=new u.default;(0,v.default)(this.fetchItem(!1),function(ha){H._request({url:"".concat(ha.itemUrl,
"/data")}).then(function(na){return W.resolve(na||!1)},function(){return W.resolve(null)})});return W};Ca.prototype.fetchRelatedItems=function(H,W,ha){var na=new u.default;H.getRelatedItems(W,ha).then(function(za){return na.resolve(za)},function(za){return na.resolve([])});return na};Ca.prototype.toPortalItem=function(H){return H?new N.default(d.default.mixin(H,{portal:this.portal,title:H.title||""})):null};Ca.prototype._fetchServiceInfo=function(H){var W=this,ha,na,za=new u.default,Ga=H.type,Oa=
{token:H.serverToken||null};Oa=E.default.includeTimestampInRequest(Oa);var Ia=!H.portalUser,Ka=H.typeKeywords.includes("Notebook Web Tool");if(Ia&&Ka)return za.resolve(null),za;H.hasServiceInfo&&H.url?(H.url=H.isHostedService?E.default.needsSSL(H,H.url):H.url,this._request({url:H.url,content:Oa},{disableIdentityLookup:H.isServiceProxy||H.isPremium&&((null===(ha=H.portal)||void 0===ha?void 0:ha.isPortal)&&!H.isHostedService||!this.portalUser||!(null===(na=this.portalUser)||void 0===na?0:na.isOrgUser)),
addToken:E.default.addToken(H)}).then(function(Sa){za.resolve(Sa)},function(Sa){var Ua,Wa=(null===(Ua=Sa.details)||void 0===Ua?0:Ua.length)?Sa.details.shift():"";403===(null===Sa||void 0===Sa?void 0:Sa.httpCode)&&-1<Wa.indexOf("SSL Required")?(H.set("url",H.url.replace("http:","https:")),W._fetchServiceInfo(H).then(function(hb){return za.resolve(hb)})):(H.isLoaded=!0,za.resolve({error:Sa}))})):"Feature Collection"===Ga||"Route Layer"===Ga?(H.url="".concat(H.itemUrl,"/data"),(0,v.default)(H.itemData||
this.fetchItemData(),function(Sa){return za.resolve(Sa)},function(){return za.resolve(null)})):za.resolve(null);return za};Ca.prototype.fetchAdminServiceInfo=function(H){var W=this,ha,na,za=new u.default,Ga="Feature Service;Map Service;Vector Tile Service;Scene Service;Image Service;Knowledge Graph".split(";"),Oa=null===(ha=H.portal)||void 0===ha?void 0:ha.isPortal;ha={token:H.adminServerToken||(null===(na=this.portalUser)||void 0===na?void 0:na.getToken())||null,_ts:null};na=-1<H.typeKeywords.indexOf("usesSnapshot");
var Ia=Oa&&!H.isHostedService&&"Scene Service"===H.type&&R.default.onFederatedServer(H.url),Ka=H.isHostedService||H.isCachedMapImageLayer||na||Ia?H.adminUrl:H.url.replace("/rest/services/","/rest/admin/services/");na&&"Feature Service"===H.type&&!H.isHostedService&&(Ka=Ka.replace(".MapServer",".FeatureServer"));Oa=Oa?Y.default.encodeServiceName(Ka,H.isSDS):Ka;ha=E.default.includeTimestampInRequest(ha);H.isHostedService&&"Feature Service"===H.type&&(ha._ts=(new Date).getTime());(H.canUpdate||H.canDelete)&&
(H.isHostedService&&D.default.includes(Ga,H.type)||na||Ia||H.isCachedMapImageLayer)?this._request({url:Oa,content:ha},{useProxy:R.default.shouldUseProxy(Oa)}).then(function(Sa){Y.default.cacheMaxAgeCheck(W._item,Sa);za.resolve(Sa)},function(){return za.resolve(null)}):za.resolve(null);return za};Ca.prototype.fetchServiceLayers=function(H){var W=this,ha,na,za,Ga=new u.default,Oa=null===(ha=H.url)||void 0===ha?void 0:ha.match(/Server\/(\d+)/i),Ia=H.serviceInfo||{},Ka=!H.portalUser&&H.typeKeywords.includes("Notebook Web Tool"),
Sa=[],Ua=[],Wa={};ha=E.default.getNeededToken(H);var hb,kb;if(!H.isFeatureCollection&&(D.default.includes(H.types,"is-feature")||D.default.includes(H.types,"is-tile")||D.default.includes(H.types,"is-table")||D.default.includes(H.types,"is-mapImage")))if(!Oa&&H.url){var La="".concat(H.url,"/layers");"3DTiles Service"===H.type&&(La="".concat(H.url.replace("/tileset.json",""),"/layers"));La=p.__assign({url:La},ha&&{content:{token:ha}});this._request(La,ha?void 0:{addToken:!1}).then(function(X){var la;
X.currentVersion?W.fetchIndividualLayers(H).then(function(ja){return Ga.resolve(ja)}):(H=d.default.mixin(H,{tables:W.fixLayers(H,X.tables,"Table"),featureLayers:(null===(la=X.layers)||void 0===la?0:la.length)?W.fixLayers(H,X.layers,"Feature Layer"):X.layers?null:[].concat(X),reviewTable:W.findReviewTable(H,X.tables||[])}),Ga.resolve([].concat(H.featureLayers||[]).concat(H.tables||[])))},function(X){W.fetchIndividualLayers(H).then(function(la){return Ga.resolve(la)})})}else H.url?(Wa[H.isTable?"tables":
"featureLayers"]=[].concat(d.default.mixin({},Ia,{url:E.default.needsToken(H,H.url),name:null!==(La=Ia.name)&&void 0!==La?La:E.default.getServiceNameFromUrl(H)})),H=d.default.mixin(H,Wa),Ga.resolve(H.isTable?H.tables:H.featureLayers)):Ga.resolve(H);else D.default.includes(H.types,"is-tool")&&(10.6<=Ia.currentVersion||Ka)?(H=d.default.mixin(H,{tools:this.fixToolLayers(H,Ia.tasks||[])}),Ga.resolve([].concat(H.tools||[]))):D.default.includes(H.types,"is-service")&&"Map Service"===H.type&&((null===(na=
null===Ia||void 0===Ia?void 0:Ia.tables)||void 0===na?0:na.length)||(null===(za=null===Ia||void 0===Ia?void 0:Ia.layers)||void 0===za?0:za.length))?(H=d.default.mixin(H,{featureLayers:Ia.layers.map(function(X){return p.__assign(p.__assign({},X),{url:E.default.needsToken(H,"".concat(H.url,"/").concat(X.id))})}),tables:Ia.tables.map(function(X){return p.__assign(p.__assign({},X),{url:E.default.needsToken(H,"".concat(H.url,"/").concat(X.id))})})}),Ga.resolve([].concat(H.featureLayers).concat(H.tables))):
D.default.includes(H.types,"is-service")?(H=d.default.mixin(H,{featureLayers:[].concat(d.default.mixin({},Ia,{url:E.default.needsToken(H,H.url),name:E.default.getServiceNameFromUrl(H)}))}),Ga.resolve(H.featureLayers)):!H.isFeatureCollection||H.isMapNotes||H.isMarkup?Ga.resolve(null):((Ia.layers||[]).forEach(function(X){kb=(hb=X.layerDefinition)&&"Table"===hb.type?Ua:Sa;hb&&kb.push(hb)}),H=d.default.mixin(H,{tables:this.fixLayers(H,Ua,"Table"),featureLayers:(null===Sa||void 0===Sa?0:Sa.length)?this.fixLayers(H,
Sa,"Feature Layer"):Ia.layers?null:[].concat(void 0)}),Ga.resolve([].concat(H.featureLayers||[]).concat(H.tables||[])));return Ga};Ca.prototype.fetchIndividualLayers=function(H){var W=this,ha=new u.default,na=H.serviceInfo||{},za=E.default.getNeededToken(H),Ga=za?void 0:{addToken:!1},Oa=(0,w.default)((na.layers||[]).map(function(Ia){Ia="".concat(H.url,"/").concat(Ia.id);Ia=p.__assign({url:Ia},za&&{content:{token:za}});return W._request(Ia,Ga)}));na=(0,w.default)((na.table||[]).map(function(Ia){Ia=
"".concat(H.url,"/").concat(Ia.id);Ia=p.__assign({url:Ia},za&&{content:{token:za}});return W._request(Ia,Ga)}));(0,w.default)({tables:na,layers:Oa}).then(function(Ia){var Ka;H=d.default.mixin(H,{tables:W.fixLayers(H,Ia.tables,"Table"),featureLayers:(null===(Ka=Ia.layers)||void 0===Ka?0:Ka.length)?W.fixLayers(H,Ia.layers,"Feature Layer"):Ia.layers?null:[].concat(Ia),reviewTable:W.findReviewTable(H,Ia.tables||[])});ha.resolve([].concat(H.featureLayers||[]).concat(H.tables||[]))},function(){return ha.resolve(null)});
return ha};Ca.prototype.checkImageryExportAvailablity=function(H){var W,ha,na=new u.default,za=H.portal,Ga=H.isOwner,Oa=H.isHostedService,Ia=H.type,Ka=H.typeKeywords;Ga=H.isAdmin||Ga;var Sa=null===(ha=null===(W=za.getPortalUser())||void 0===W?void 0:W.userRole)||void 0===ha?void 0:ha.canPublishTiledImagery();if(!(!za.isPortal&&"Image Service"===Ia&&Oa&&D.default.includes(null!==Ka&&void 0!==Ka?Ka:[],"Tiled Imagery")&&Ga&&Sa))return na.resolve(!1),na;this._request({url:S.default.self.helperServices.rasterAnalytics.url+
"/ExportToTilePackage",content:{f:"json"}},{disableIdentityLookup:!0,addToken:E.default.addToken(H)}).then(function(Ua){return na.resolve("ExportToTilePackage"===(null===Ua||void 0===Ua?void 0:Ua.name))},function(){return na.resolve(!1)});return na};Ca.prototype.fixLayers=function(H,W,ha){var na=this,za,Ga,Oa,Ia="Table"!==ha&&(null===(Ga=null===(za=H.itemData)||void 0===za?void 0:za.layers)||void 0===Ga?0:Ga.length)?H.itemData.layers:W,Ka=Array.isArray(null===(Oa=H.itemData)||void 0===Oa?void 0:Oa.tables),
Sa=H.isFeatureCollection;W=null===W||void 0===W?void 0:W.filter(function(Ua){return"Table"===ha&&"Review"===Ua.name?!1:"Table"===ha&&(Ua.name.endsWith("_3DOAM")||Ua.name.endsWith("_3DOAT"))?!1:"Table"===ha?!Ka||H.itemData.tables.some(function(Wa){return(null===Wa||void 0===Wa?void 0:Wa.id)===Ua.id}):(Ia||[]).some(function(Wa){Wa=Wa&&B.default.isDefined(Wa.id)?Wa:Wa.layerDefinition||Wa||{};return Ua.id===Wa.id})}).map(function(Ua){return d.default.mixin(Ua,{name:na.fixTitle(Ua.name),type:Ua.type||
ha,url:Sa?null:E.default.needsToken(H,H.url+(!Sa&&B.default.isDefined(Ua.id)?"/"+Ua.id:""))})});return(null===W||void 0===W?0:W.length)?W:null};Ca.prototype.fixToolLayers=function(H,W){var ha=this;return W.map(function(na){return d.default.mixin({},{name:ha.fixTitle(na),url:E.default.needsToken(H,"".concat(H.url,"/").concat(na))})})};Ca.prototype.findReviewTable=function(H,W){var ha;W=W.filter(function(na){return"Table"===na.type&&"Review"===na.name}).map(function(na){return d.default.mixin(na,{url:E.default.needsToken(H,
H.url+B.default.isDefined(na.id)?"/".concat(na.id):"")})});return null!==(ha=null===W||void 0===W?void 0:W[0])&&void 0!==ha?ha:null};Ca.prototype.fetchMapLayers=function(H){var W=this,ha=new u.default,na,za=[],Ga="Web Scene"===H.type;D.default.includes(H.types,"is-map")||D.default.includes(H.types,"is-scene")?this.fetchItemData().then(function(Oa){H.itemData=Oa;var Ia=(0,I.default)(Oa);if(Ia){Oa=Ia.baseMap||{};var Ka=Ia.operationalLayers,Sa=Oa.baseMapLayers,Ua=Oa.elevationLayers,Wa=Ia.tables;H=d.default.mixin(H,
{baseMapLayers:Sa,operationalLayers:Ka,elevationLayers:Ua,tables:Wa,presentation:D.default.includes(H.types,"is-scene")?null:Ia.presentation});Ia=[].concat(Ka||[]).concat(Ua||[]).concat(Sa||[]).concat(Wa||[]);for(Ka=0;Ka<Ia.length;++Ka){Sa=Ia[Ka];if(Ga)for(na=[].concat(Sa.layers||[]),Ua=0;Ua<na.length;++Ua)W.setLayerProps(na[Ua],Oa);za.push(d.default.mixin(Sa,W.setLayerProps(Sa,Oa),{subLayers:na||null}))}}ha.resolve(za)}):ha.resolve(null);return ha};Ca.prototype.fetchTypeKeywords=function(H){var W=
new u.default;R.default.request({url:H.itemUrl}).then(function(ha){H.set({typeKeywords:(null===ha||void 0===ha?void 0:ha.typeKeywords)||H.typeKeywords});"Image Service"===(null===ha||void 0===ha?void 0:ha.type)&&ha.size!==H.size&&H.set({size:ha.size,subInfo:ha.subInfo});W.resolve(H.typeKeywords)});return W};Ca.prototype.setLayerProps=function(H,W){var ha=H.url||H.styleUrl,na=H.type||H.layerType,za=H.itemId?"item.html?id\x3d".concat(H.itemId):null,Ga=H.wmtsInfo;Ga?(H.title=Ga.layerIdentifier||H.title,
H.url=Ga.url):"VectorTileLayer"===na&&H.styleUrl?za=this.getVectorTileItemUrl(za,H):H.url="OpenStreetMap"===na?"//www.openstreetmap.org/":ha;W&&(H.baseMapTitle=W.title);return d.default.mixin(H,{url:H.url,itemUrl:za,type:na,name:H.title?this.fixTitle(H.title):E.default.getServiceNameFromUrl({url:H.url,title:W.title})})};Ca.prototype.fixTitle=function(H){H=R.default.htmlEncode(H);try{H=decodeURI(H)}catch(W){}return H};Ca.prototype.getVectorTileItemUrl=function(H,W){var ha=W.styleUrl;if(H){H=R.default.parseUrl(H);
var na=R.default.parseUrl(ha),za=-1<ha.indexOf(".arcgis.com");W=-1<ha.indexOf("cdn.arcgis.com")||za&&(null===W||void 0===W?0:W.itemId)&&ha.match(/tile.*.arcgis.com/i)?!0:!1;return"//"+(!za||W?H.host+H.relative:na.host+H.relative.substr(H.relative.indexOf("/home/")))}return ha};Ca.prototype.geocodeReview=function(H){var W=new u.default,ha=H.typeKeywords||[],na=D.default.includes(ha,"showUnmatchedAddresses"),za=H.userItemUrl;H.canUpdate&&na?(0,w.default)({typeKeywords:R.default.request({url:za+"/update",
content:{typeKeywords:D.default.filterOut(ha,["showUnmatchedAddresses"]).join(",")}},{usePost:!0}),geocodeCountResults:Y.default.queryGeocodeCounts(H)}).then(function(Ga){H.set("typeKeywords",ha);W.resolve(H);Ga.geocodeCountResults&&(Ga=Ga.geocodeCountResults,Ga=x.default.substitute(ea.default.itemProperties[Ga.successful!==Ga.total?"invalidGeocodeMsg":"validGeocodeMsg"],Ga),E.default.createConfirmationDialog({strings:{title:ea.default.geocodePanel.geocodePanelTitle,description:Ga,ok:ea.default.common.yesLabel,
cancel:ea.default.common.noLabel},autoCloseOnOk:!0,renderHtmlDescription:!0,onOk:function(){window.location.href="./webmap/viewer.html?layers\x3d".concat(H.id,"\x26review\x3dtrue")}}))}):W.resolve(H);return W};Ca.prototype.updateItem=function(H,W){var ha=this,na=new u.default;this._item.canUpdate?P.default.updateItem(d.default.mixin({},H,{id:this._item.id,folderId:this._item.folderId,owner:this._item.owner}),this.portal).then(function(){var za,Ga;delete H.clearEmptyFields;H.serviceProxyFilter&&H.url&&
delete H.url;var Oa=H.url&&ha._item.url&&H.url!==ha._item.url;W||(ha._item.set(H),Oa&&(xa.default.appViewer(ha._item),Oa=-1<(null===(za=ha._item.typeKeywords)||void 0===za?void 0:za.indexOf("Service Proxy"))?"".concat(-1<ha._item.url.indexOf("?")?"\x26":"?","f\x3dpjson"):"",za="WFS"===ha._item.type&&-1===(null===(Ga=ha._item.url)||void 0===Ga?void 0:Ga.toLowerCase().indexOf("getcapabilities"))?"".concat(-1<ha._item.url.indexOf("?")?"\x26":"?","request\x3dgetcapabilities"):"",ha._item.viewUrl=ha.portal.isPortal?
encodeURI(ha._item.url?ha._item.url+Oa+za:ha._item.itemDataUrl):encodeURI(ha._item.url&&!ha.portal.isPortal?E.default.needsToken(ha._item,ha._item.url)+Oa+za:ha._item.itemDataUrl)),H.advancedSettings&&ha._item.set("advancedSettings",JSON.parse(H.advancedSettings)));na.resolve(ha._item)},function(za){ha._showError(d.default.clone(za));na.reject(za)}):na.resolve(this._item);return na};Ca.prototype.fetchComments=function(H){var W=new u.default;H.getComments().then(function(ha){ha=ha.map(function(na){return na.getReplies()});
return(0,w.default)(ha)}).then(function(){return W.resolve(H.comments)});return W};Ca.prototype.processItem=function(H){switch(H.classification){case "layer":H=this.processLayer(H);break;case "map":H=this.processMap(H);break;case "app":H=this.processApp(H);break;case "file":H=this.processFile(H);break;case "notebook":H=this.processFile(H);break;case "solution":H=this.processSolution(H);break;default:H=this.processGeneric(H)}return H};Ca.prototype.processHostedLayer=function(H){var W=this,ha=new u.default,
na=1<H.typeKeywords.indexOf("usesSnapshot"),za=this.portal.isPortal&&["Knowledge Graph","Scene Service"].includes(H.type)&&!H.isHostedService;H.isHostedService&&(H.types.push("is-hosted"),H.url=E.default.needsSSL(H,H.url));if((H.canUpdate||H.canDelete)&&(H.isHostedService||na||za)){var Ga={serverToken:Y.default.fetchServerToken(H)};this.portal.isPortal?(na=this.portal.getHostedFederatedServers(),za&&(na=this.portal.getFederatedServerByUrl(H.url)),"Knowledge Graph"===H.type&&(na=this.portal.getFederatedServerByFunction("KnowledgeServer")),
(0,v.default)(this._hostedFederatedServer||na,function(Oa){W._hostedFederatedServer=Oa;R.default.onFederatedServer(H.url)?(H.adminUrl=Y.default.fetchItemAdminUrl(H,W._hostedFederatedServer),Ga=d.default.mixin(Ga,{adminServerToken:Y.default.fetchServerToken(H,H.adminUrl)}),(0,w.default)(Ga).then(function(Ia){H=d.default.mixin(H,Ia);ha.resolve(H)})):(H.adminUrl=Y.default.fetchItemAdminUrl(H,null),Ga=d.default.mixin(Ga,{adminServerToken:Y.default.fetchServerToken(H,H.adminUrl)}),(0,w.default)(Ga).then(function(Ia){return ha.resolve(d.default.mixin(H,
Ia))}))})):(H.adminUrl=Y.default.fetchItemAdminUrl(H,null),Ga=d.default.mixin(Ga,{adminServerToken:Y.default.fetchServerToken(H,H.adminUrl)}),(0,w.default)(Ga).then(function(Oa){return ha.resolve(d.default.mixin(H,Oa))}))}else ha.resolve(H);return ha};Ca.prototype.processLayer=function(H){var W=this,ha=new u.default,na=!1,za="Feature Service;Map Service;Vector Tile Service;Scene Service;Image Service;WFS;OGCFeatureServer;Knowledge Graph;3DTiles Service".split(";"),Ga=1<H.typeKeywords.indexOf("usesSnapshot"),
Oa=H.portal.isPortal&&!H.isHostedService&&"Scene Service"===H.type&&R.default.onFederatedServer(H.url);H.watch("status",function(){var Ia,Ka;"completed"===H.status&&(null===(Ia=H.serviceInfo)||void 0===Ia?0:Ia.error)&&(H.serviceInfo=void 0);if(!H.serviceInfo&&"completed"===H.status)(0,w.default)({itemData:"Feature Service"===H.type||H.isFeatureCollection?W.fetchItemData():null,typeKeywords:W.fetchTypeKeywords(H)}).then(function(Ua){H.resetTypeKeywordInfo();H.set("displayName",W._formatDisplayName());
"Image Service"===W._item.type&&W.processCompletedImageryLayerItem();W._item=d.default.mixin(W._item,Ua);W.portal.isPortal&&W._item.adminUrl&&(Ua=Y.default.fetchItemAdminUrl(H,W._hostedFederatedServer),W._item.adminUrl=Ua,H.adminUrl=Ua);(0,w.default)({serviceInfo:W._fetchServiceInfo(H),isExportableTiledImagery:W.checkImageryExportAvailablity(H)}).then(function(Wa){var hb=Wa.isExportableTiledImagery;delete Wa.isExportableTiledImagery;W._item=d.default.mixin(W._item,Wa);na=(null===Wa||void 0===Wa?void 0:
Wa.serviceInfo)&&Wa.serviceInfo.error;Wa={layers:na?null:W.fetchServiceLayers(H),hasResources:Y.default.checkForResources(H),cloudProviderInfo:D.default.includes(H.typeKeywords,"Cloud Drive")&&H.isOwner&&H.isAdmin?P.default.getCloudProviderItemResource(H):null};(H.canUpdate||H.canDelete)&&(H.isHostedService&&D.default.includes(za,H.type)||Ga||Oa)&&(Wa.adminServiceInfo=W.fetchAdminServiceInfo(H));W.canManageImageCollection()&&W.updateImageManagementTabState();(0,w.default)(Wa).then(function(kb){W._item=
d.default.mixin(W._item,kb);Y.default.cacheMaxAgeCheck(W._item,kb.adminServiceInfo);W._item.isMultipatchFeatureService=E.default.isMultipatchFeatureService(H);(0,w.default)({isExportableByUser:E.default.isExportableByUser(H),isOverwriteSupported:E.default.isOverwriteableService(H,!1),isOverwriteCloudSupported:E.default.isOverwriteableCloudService(H),canPublishTileService:E.default.canPublishTileServiceFromFeatureService(H),canPublishVectorTileService:E.default.canPublishVectorTileServiceFromFeatureService(H),
canPublishWFSService:E.default.canPublishWFSServiceFromFeatureService(H),canPublishOGCFeatureServer:E.default.canPublishOGCFeatureServerFromFeatureService(H),canPublishSceneService:E.default.canPublishSceneServiceFromFeatureService(H),canPublishViewService:E.default.canPublishViewServiceFromFeatureService(H),canPublishDynamicImagerService:E.default.canPublishImageServiceAsDynamic(H),canPublishTiledImagerService:E.default.canPublishImageServiceAsTiled(H),canExportImagery:hb&&E.default.canExportImagery(H),
isFilePublishableByUser:D.default.includes(H.types,"is-featureCollection")?E.default.isFilePublishableByUser(H):null,isEditableByUser:E.default.isServiceEditableByUser(H),canEnableAttachments:E.default.canEnableAttachments(H),canAppendData:E.default.canAppendData(H),isTiledImageryLayer:E.default.isTiledImageryService(H),isCachedMapImageLayer:E.default.isEnterpriseCachedMapImageLayer(H)}).then(function(La){var X,la,ja,oa=d.default.mixin(W._item,La),ua=W._item.types||[],Da=W._item.privileges||[],Ha=
La.isFilePublishableByUser||La.canPublishTileService||La.canPublishWFSService||La.canPublishOGCFeatureServer||La.canPublishSceneService||La.canPublishViewService||La.canPublishDynamicImagerService||La.canPublishTiledImagerService,Ja=D.default.includes(ua,"is-scene-2")&&!D.default.includes(oa.typeKeywords,"HasOnlyMultipatchGeometries"),Ma=E.default.isMultipatchFeatureService(oa);ua=D.default[La.isOverwriteSupported?"concatUnique":"filterOut"](ua,["is-overwrite"]);ua=D.default[La.isOverwriteCloudSupported?
"concatUnique":"filterOut"](ua,["is-overwriteCloud"]);ua=D.default[Ma?"concatUnique":"filterOut"](ua,["is-multipatch"]);ua=D.default[W._item.isTiledImageryLayer?"concatUnique":"filterOut"](ua,["is-tiled-imagery"]);ua=D.default[W._item.isVelocity()?"concatUnique":"filterOut"](ua,["is-velocity"]);Da=D.default[La.canPublishTileService?"concatUnique":"filterOut"](Da,["can-publish-tiles"]);Da=D.default[La.canPublishWFSService&&!Ma?"concatUnique":"filterOut"](Da,["can-publish-wfs"]);Da=D.default[La.canPublishOGCFeatureServer?
"concatUnique":"filterOut"](Da,["can-publish-ogcfeatures"]);Da=D.default[La.canPublishSceneService?"concatUnique":"filterOut"](Da,["can-publish-scenes"]);Da=D.default[La.canPublishViewService?"concatUnique":"filterOut"](Da,["can-publish-views"]);Da=D.default[oa.isEditableByUser&&"Feature Service"===W._item.type?"concatUnique":"filterOut"](Da,["can-edit-service"]);Da=D.default[La.canPublishVectorTileService?"concatUnique":"filterOut"](Da,["can-publish-vectorTiles"]);Da=D.default[oa.isExportableByUser?
"concatUnique":"filterOut"](Da,["can-export"]);Da=D.default[La.canExportImagery?"concatUnique":"filterOut"](Da,["can-export-imagery"]);Da=D.default[La.canPublishTiledImagerService?"concatUnique":"filterOut"](Da,["can-publish-imagery-tiles"]);Da=D.default[La.canPublishDynamicImagerService?"concatUnique":"filterOut"](Da,["can-publish-imagery-dynamic"]);Da=D.default[oa.isLocationTrackingService?"concatUnique":"filterOut"](Da,["is-location-tracking"]);Da=D.default[La.canEnableAttachments?"concatUnique":
"filterOut"](Da,["can-enableAttachments"]);Da=D.default[La.isFilePublishableByUser?"concatUnique":"filterOut"](Da,["can-publish"]);Da=D.default[La.canAppendData?"concatUnique":"filterOut"](Da,["can-appendData"]);ua=D.default[Ja?"concatUnique":"filterOut"](ua,["is-scene-2"]);ua=D.default[W._item.typeKeywords.includes("ExtractedCache")||!D.default.includes(W._item.types,"is-vectorTile")||W._item.isHostedService?"filterOut":"concatUnique"](ua,["is-update"]);ua=D.default[Ha?"concatUnique":"filterOut"](ua,
["is-publish"]);W._item.set({types:ua,privileges:Da});W._item.hasResources&&(W.set("actionUrls",oa),(0,q.default)(".js-open-viewStyle").attr("href",oa.viewStyleUrl),(0,q.default)(".js-open-downloadStyle").attr("href",oa.downloadStyleUrl));W._item.isHostedService&&"WFS"===W._item.type&&W._item.set("url",W._item.url+"?service\x3dwfs\x26request\x3dgetcapabilities");!W.portal.isPortal&&oa.isHostedService&&"public"===oa.access&&(null===(X=oa.serviceInfo)||void 0===X?0:X.singleFusedMapCache)&&("Map Service"===
oa.type||"Image Service"===oa.type&&["jpegplus","mixed","jpegpng"].includes(null===(ja=null===(la=oa.serviceInfo.tileInfo)||void 0===la?void 0:la.format)||void 0===ja?void 0:ja.toLowerCase()))&&(La=xa.default.wmtsUrl(oa),W._item.set("wmtsUrl",La));W._item.canUpdate&&W._item.isHostedService&&!D.default.includes(W._item.typeKeywords,"View Service")?Y.default.setFeatureServiceScaleRanges(oa).then(function(){W._item.set("isLoaded",!0);ha.resolve(W._item)}):(W._item.set("isLoaded",!0),ha.resolve(W._item))})})})});
else if("failed"===H.status&&H.statusError){var Sa=ea.default.common.errors.genericError.message;Ia="".concat(H.statusError.split(".")[0].split("ERROR 003428:")[1],".");Sa="undefined."!==Ia?Ia:H.statusError||Sa;W.portal.isKubernetes()&&-1!==(null===(Ka=H.statusError)||void 0===Ka?void 0:Ka.indexOf("Publishing from ArcMap to ArcGIS Enterprise on Kubernetes is not supported."))&&(Sa+=" ".concat("Publishing from ArcMap to ArcGIS Enterprise on Kubernetes is not supported."));setTimeout(function(){var Ua;
va.default.showAlert("error",Sa);W.itemCanShowSettingsTab(H)&&y.default.disableNode(null===(Ua=W.subnav)||void 0===Ua?void 0:Ua.domNode.querySelector('a[data-tab\x3d"settings"]'),!1)},500)}});H.watch("readyForGeocodeReview",function(){if(W._item.canUpdate&&W._item.isHostedService&&W._item.readyForGeocodeReview&&-1<W._item.typeKeywords.indexOf("showUnmatchedAddresses"))var Ia=setInterval(function(){W._item.isLoaded&&(clearInterval(Ia),W.geocodeReview(W._item))},1E3)});this.processHostedLayer(H).then(function(Ia){(0,w.default)({sourceData:!D.default.includes(Ia.typeKeywords,
"Cloud Drive")&&D.default.includes(za,Ia.type)||D.default.includes(Ia.typeKeywords,"Bulk Published Service")||"Route Layer"===Ia.displayName?Ia.getSourceData():null,resultData:"Feature Service"===Ia.type||Ia.isFeatureCollection||"Feed"===Ia.type?Ia.getResultData():null}).then(function(Ka){W._item=d.default.mixin(W._item,Ka);fa.default.checkStatus(W._item).then(function(Sa){W._item=d.default.mixin(W._item,Sa);setTimeout(function(){ha.resolve(Ia)},300)})})});return ha};Ca.prototype.processMap=function(H){var W=
this,ha=new u.default;(0,w.default)({layers:this.fetchMapLayers(H),isApplicationCreateableFromItem:E.default.isApplicationCreateableFromItem(H)}).then(function(na){W._item=d.default.mixin(W._item,na);W._item.set("isLoaded",!0);ha.resolve(W._item)});return ha};Ca.prototype.processApp=function(H){var W=this,ha=new u.default;(0,w.default)({itemData:H.hasItemData?this.fetchItemData():null,codeAttachment:this.fetchRelatedItems(H,"Mobile Application"===H.type?"MobileApp2Code":"WMA2Code","forward"),isApplicationCreateableFromItem:E.default.isApplicationCreateableFromItem(H),
relatedService:"Form"===H.type?this.fetchRelatedItems(H,"Survey2Service","forward"):"QuickCapture Project"===H.type?this.fetchRelatedItems(H,"QuickCaptureProject2Service","forward"):null}).then(function(na){W._item=d.default.mixin(W._item,na);W._hideErrors=!0;E.default.isConfigurableApplication(H).then(function(za){var Ga,Oa,Ia,Ka;W._hideErrors=!1;W._item.isConfigurableApp=za;W._item.isConfigurableApp&&!W._item.origin&&W._item.privileges.push("can-configure");D.default.includes(H.typeKeywords,"Web AppBuilder")&&
(H.codeAttachment=W._item.isAdmin?H.codeAttachment:null,H.types.push("is-dataUrl"),H.canUpdate&&!W._item.origin&&(H.privileges.push("can-edit-wab"),H.removeBlockedTypes(W.blockedApps)));if((null===(Ga=na.itemData)||void 0===Ga?0:Ga.workerWebMapId)||(null===(Oa=na.itemData)||void 0===Oa?0:Oa.dispatcherWebMapId))W._item.projectContent=na.itemData;if(null===(Ia=na.itemData)||void 0===Ia?0:Ia.workflowLocations)W._item.workflowContent=na.itemData;(null===(Ka=W.portalUser)||void 0===Ka?0:Ka.isOrgUser)&&
"Form"===H.type&&(H.types.push("is-surveyForm"),H.removeBlockedTypes(W.blockedApps));W._item.set("isLoaded",!0);ha.resolve(W._item)})});return ha};Ca.prototype.pingData=function(H){var W,ha=new u.default;if("Document Link"!==H.type)return ha.resolve(),ha;try{null===(W=null===navigator||void 0===navigator?void 0:navigator.sendBeacon)||void 0===W?void 0:W.call(navigator,H.itemDataUrl),ha.resolve()}catch(na){ha.resolve()}return ha};Ca.prototype.processFile=function(H){var W=this,ha=new u.default;(0,w.default)({isPublishableByUser:E.default.isFilePublishableByUser(H),
resultData:H.getResultData(),data:this.pingData(H)}).then(function(na){var za;W._item=d.default.mixin(W._item,na);var Ga=(null===(za=null===na||void 0===na?void 0:na.resultData)||void 0===za?void 0:za[0])||na.resultData;W._item.isPublishableByUser&&W._item.privileges.push("can-publish");Ga&&D.default.includes(W._item.types,"is-publish")&&W._item.types.splice(W._item.types.indexOf("is-publish"),1);W._item.set("isLoaded",!0);ha.resolve(W._item)});return ha};Ca.prototype.processSolution=function(H){var W=
this,ha=new u.default;(0,w.default)({itemData:H.hasItemData?this.fetchItemData():null}).then(function(na){W._item=d.default.mixin(W._item,na);W._item.set("isLoaded",!0);ha.resolve(W._item)});return ha};Ca.prototype.processGeneric=function(H){var W=new u.default;this._item.set("isLoaded",!0);W.resolve(H);return W};Ca.prototype.processCompletedImageryLayerItem=function(){var H,W=this._item;"Image Service"===W.type&&"completed"===W.status&&(null===(H=W.properties)||void 0===H?0:H.jobUrl)&&(W.isAdmin||
W.isOwner||W.canUpdate)&&(W.isHostedService||D.default.includes(W.typeKeywords,"Managed Image Collection"))&&(H=W.properties,delete H.jobId,delete H.jobUrl,delete H.jobStatus,delete H.jobType,this.updateItem({properties:JSON.stringify(H)}),W.set("properties",H))};Ca.prototype.getThumbnail=function(H){var W=this,ha=new u.default,na=this._item;na.getThumbnail(H).then(function(za){H&&-1===za.indexOf("token")?W.updateItem({thumbnailUrl:za}).then(function(){R.default.request({url:na.itemUrl}).then(function(Ga){na.thumbnail=
za;na.setScoreCompleteness(Ga.scoreCompleteness);na.set("thumbnailUrl",za);ha.resolve(za)})}):ha.resolve(za)});return ha};Ca.prototype.getItemOwner=function(H){var W=new u.default;H.getOwnerProfile(!0,!0).then(function(ha){H.set("itemOwner",ha);W.resolve(ha)});return W};Ca.prototype.showPublicDataCollectionWarning=function(H){var W,ha=this._item;H=H||(null===(W=ha.serviceInfo)||void 0===W?void 0:W.capabilities)||[];W=this.domNode.querySelector(".js-public-data-collection-alert");"Feature Service"===
ha.type&&ha.canUpdate&&"public"===ha.access&&-1<H.indexOf("Editing")&&-1===ha.typeKeywords.indexOf("Public Data Collection")&&-1<ha.typeKeywords.indexOf("Hosted Service")?W.classList.add("is-active"):W.classList.remove("is-active")};Ca.prototype.refreshServiceInfo=function(){var H=this;return new Promise(function(W){var ha={};B.default.isDefined(H._item.serviceInfo)&&(ha.serviceInfo=H._fetchServiceInfo(H._item));B.default.isDefined(H._item.adminServiceInfo)&&(ha.adminServiceInfo=H.fetchAdminServiceInfo(H._item));
B.default.isDefined(H._item.layers)&&(ha.layers=H.fetchServiceLayers(H._item));E.default.isEmptyObject(ha)||(0,w.default)(ha).then(function(na){var za;H._item=d.default.mixin(H._item,na);H.sublayer&&(null===(za=na.layers)||void 0===za?0:za[H.sublayer.id])&&(H.sublayer=na.layers[H.sublayer.id]);H.emit("service-info-change");W()},function(){W()})})};Ca.prototype.storeCacheJobInfo=function(H){var W=this,ha=this._item.properties,na=H.jobId;H=H.jobUrl;if(na||H)ha=p.__assign(p.__assign({},ha),{cacheJobId:na,
cacheJobUrl:H}),this.updateItem({properties:JSON.stringify(ha)}).then(function(){W._item.set("properties",ha)})};Ca.prototype.dropCacheJobInfo=function(){var H=this,W,ha=null===(W=this._item)||void 0===W?void 0:W.properties;if((null===ha||void 0===ha?0:ha.cacheJobId)||(null===ha||void 0===ha?0:ha.cacheJobUrl))(null===ha||void 0===ha?0:ha.cacheJobId)&&delete ha.cacheJobId,(null===ha||void 0===ha?0:ha.cacheJobUrl)&&delete ha.cacheJobUrl,W=ha?JSON.stringify(ha):"{}",this.updateItem({properties:W}).then(function(){H._item.set("properties",
ha)})};Ca.prototype.storeIndexJobInfo=function(H){var W=this,ha,na=(null===(ha=this._item)||void 0===ha?void 0:ha.properties)||{};ha=H.statusId;H=H.statusURL||H.statusUrl;na=p.__assign(p.__assign({},na),{indexJobId:ha,indexJobUrl:H});this.updateItem({properties:JSON.stringify(na)}).then(function(){W._item.set("properties",na)})};Ca.prototype.dropIndexJobInfo=function(){var H=this,W,ha=null===(W=this._item)||void 0===W?void 0:W.properties;if((null===ha||void 0===ha?0:ha.indexJobId)||(null===ha||void 0===
ha?0:ha.indexJobUrl))(null===ha||void 0===ha?0:ha.indexJobId)&&delete ha.indexJobId,(null===ha||void 0===ha?0:ha.indexJobUrl)&&delete ha.indexJobUrl,W=ha?JSON.stringify(ha):"{}",this.updateItem({properties:W}).then(function(){H._item.set("properties",ha)})};Ca.prototype.refreshCodeAttachment=function(){var H=this,W=new u.default,ha="Mobile Application"===this._item.type?"MobileApp2Code":"WMA2Code";this._item.relatedItems["".concat(ha,"_").concat("forward")]=null;(0,w.default)({codeAttachment:this.fetchRelatedItems(this._item,
ha,"forward")}).then(function(na){H._item=d.default.mixin(H._item,na);D.default.includes(H._item.typeKeywords,"Web AppBuilder")&&!H._item.canUpdate?H._item.set("codeAttachment",null):H._item.set("codeAttachment",H._item.codeAttachment);W.resolve(H._item)});return W};Ca.prototype._formatCommentDate=function(H){return"".concat(this.i18n.itemProperties.commented," ").concat((0,m.default)(H).fromNow())};Ca.prototype._formatDate=function(H){!1===H instanceof Date&&(H=new Date(H));return H?C.default.format(H,
"long-month-day-year"):""};Ca.prototype._formatTime=function(H){!1===H instanceof Date&&(H=new Date(H));return H?C.default.format(H,"short-time"):""};Ca.prototype._formatDateTime=function(H){!1===H instanceof Date&&(H=new Date(H));return H?C.default.format(H,"day-short-month-year-short-time"):""};Ca.prototype._formatTags=function(H){H=H&&"string"===typeof H?H.split(","):H||[];var W="settings-tab"===this._currentView;return H.map(function(ha){var na=R.default.htmlEncode(ha);return W?ha:'\x3ca href\x3d"search.html?t\x3dcontent\x26q\x3dtags:'.concat(na,
'"\x3e').concat(na,"\x3c/a\x3e")}).join(", ")};Ca.prototype._formatSharing=function(H){var W=this,ha=ea.default.itemProperties,na=H.access;H=H.groups;var za;"private"===na?za=ha.itemNotShared:"public"===na?za=ha.everyone:"org"===na?za=ha.organization:"shared"===na&&(za=(null===H||void 0===H?0:H.length)?null:ha.itemNotShared);if(null===H||void 0===H?0:H.length)H=H.map(function(Ga){var Oa=R.default.htmlEncode(Ga.title);Ga="group.html?owner\x3d"+Ga.owner+"\x26title\x3d"+encodeURIComponent(Ga.title);
return x.default.substitute('\x3ca href\x3d"${url}" alt\x3d"${i18n.itemProperties.groupDetails}" title\x3d"${i18n.itemProperties.groupDetails}"\x3e${title}\x3c/a\x3e',{url:Ga,title:Oa,i18n:W.i18n})}),za=(za?"".concat(za,", "):"")+H.join(", ");return za};Ca.prototype._formatServiceLink=function(H){H=this._item||H;var W=H.type,ha=D.default.includes(H.typeKeywords,"Service")&&"Service Definition"!==W||"Feature Collection"===W,na=E.default.needsToken(H,H.url);W=ha?'\x3ca target\x3d"_blank" href\x3d"'.concat("Feature Collection"===
W?H.itemDataUrl:na,'"\x3e').concat(W,"\x3c/a\x3e"):null;H.set("serviceLink",W);return W||""};Ca.prototype._formatDashboardViews=function(H){var W;return(null===(W=null===H||void 0===H?void 0:H.typeKeywords)||void 0===W?0:W.includes("Mobile"))?ea.default.itemProperties.mobile:ea.default.itemProperties.desktop};Ca.prototype._formatDisplayName=function(H,W){void 0===H&&(H=this._item);W=H.typeKeywords;var ha="Feature Service"===H.type,na="Data Store"===H.type,za=H.displayName,Ga="";"Scene Service"===
H.type&&(D.default.includes(W,"IntegratedMesh")?Ga="Integrated Mesh":D.default.includes(W,"3DObject")?Ga="3D Object":D.default.includes(W,"Point")?Ga="Point":D.default.includes(W,"PointCloud")?Ga="Point Cloud":D.default.includes(W,"Building")?Ga="Building Scene Layer":D.default.includes(W,"Voxel")&&(Ga="Voxel Scene Layer"),Ga.length&&(za+=" - ".concat(Ga)));if(D.default.includes(H.typeKeywords,"ArcgisWorkflowManager"))return D.default.includes(H.typeKeywords,"View Service")?"Workflow View":"Workflow Layer";
if(D.default.includes(H.typeKeywords,"ArcgisWorkflowJobLocation")&&D.default.includes(H.typeKeywords,"View Service"))return"Workflow Job Location View";if(D.default.includes(W,"EditExtensionIndoorsSpaces"))return"Indoors Spaces Feature Layer";!H.canUpdate&&!H.canDelete||H.isUtilityNetwork||(H.isHostedService?(ha=" (".concat(H.isDataView?this.i18n.viewsWidget.hostedView:ha?this.i18n.viewsWidget.hostedData:this.i18n.viewsWidget.hostedService,")"),0>za.indexOf(ha)&&(za+=ha),0>H.sentenceCaseDisplayName.indexOf(ha)&&
(H.sentenceCaseDisplayName+=ha)):H.isLocatorView?(ha=" (".concat(this.i18n.viewsWidget.locatorView,")"),0>za.indexOf(ha)&&(za+=ha),0>H.sentenceCaseDisplayName.indexOf(ha)&&(H.sentenceCaseDisplayName+=ha)):H.isPhotoLocations&&(ha=" (".concat(this.i18n.viewsWidget.photoLocations,")"),0>za.indexOf(ha)&&(za+=ha),0>H.sentenceCaseDisplayName.indexOf(ha)&&(H.sentenceCaseDisplayName+=ha)));na&&(za=E.default.formatDataStoreItem(za,W));return za};Ca.prototype._formatSize=function(H){return H?1024>=H?"1 ".concat("\x3csmall class\x3d'font-size--3'\x3eKB\x3c/small\x3e"):
1048576>H?"".concat(M.default.format(H/1024)," ").concat("\x3csmall class\x3d'font-size--3'\x3eKB\x3c/small\x3e"):"".concat(M.default.format(H/1048576)," ").concat("\x3csmall class\x3d'font-size--3'\x3eMB\x3c/small\x3e"):"0 ".concat("\x3csmall class\x3d'font-size--3'\x3eKB\x3c/small\x3e")};Ca.prototype._formatRating=function(H){return""+H||"0.0"};Ca.prototype._formatCount=function(H){return""+H||"0"};Ca.prototype._formatViews=function(){var H="file"!==this._item.classification||D.default.includes(this._item.types,
"is-views")||D.default.includes(this._item.types,"is-pdf")?"views":"downloads";return this.i18n.itemProperties[H]};Ca.prototype._formatNumber=function(H){return M.default.format(H)};Ca.prototype._formatRatingsViewsDownloads=function(H){H=this._item.codeAttachment;var W=M.default.format(this._item.numRatings||0),ha=M.default.format(this._item.numViews||0);return x.default.substitute("${i18n.viewsWidget.startBracket}${numRatings}${i18n.viewsWidget.endBracket} \x3cspan class\x3d'margin-left-1 text-darkest-gray'\x3e${numViews}\x3c/span\x3e"+
(H?", ${numDownloads} ${i18n.itemProperties.downloads}":""),{item:this._item,numRatings:W,numViews:x.default.substitute(ea.default.viewsWidget.universalViewsMsgAlone,{viewcount:ha}),numDownloads:M.default.format((null===H||void 0===H?void 0:H.numViews)||0),i18n:this.i18n},null,this)};Ca.prototype._formatItemTypeSearch=function(H){return encodeURI('search.html?t\x3dcontent\x26q\x3dtype:"'.concat(H,'"'))};Ca.prototype._formatSocialLink=function(H){return x.default.substitute("socialnetwork.html?t\x3d${title}\x26n\x3d${socialNetwork}\x26u\x3d${url}",
{title:R.default.socialNetworkTitle(this._item.title),url:window.location.href,socialNetwork:H})};Ca.prototype._formatTwitterLink=function(){return this._formatSocialLink("tw")};Ca.prototype._formatFacebookLink=function(){return this._formatSocialLink("fb")};Ca.prototype._formatAppApi=function(){var H=this._item.types,W=E.default.getAppApi(this._item);H=D.default.includes(H,"is-mobile")?this.i18n.itemProperties.sdkLbl:D.default.includes(H,"is-platform")?this.i18n.itemProperties.platformLbl:this.i18n.itemProperties.apiLbl;
return W?x.default.substitute("${label} ${api}",{label:H,api:W}):""};Ca.prototype._formatAppPurpose=function(){var H=E.default.getAppPurpose(this._item);return H?x.default.substitute("${i18n.itemProperties.purposeLbl} ${purpose}",{i18n:this.i18n,purpose:H}):""};Ca.prototype._formatApplicable=function(H){return D.default.includes(this._item.typeKeywords,"HTML3D")?this.i18n.addItemFrm["3d"]:this.i18n.addItemFrm["2d"]};Ca.prototype._formatWellDone=function(H){return this._item.canUpdate&&100<=H?x.default.substitute(this.i18n.itemCompleteness.wellDone,
{threshold:"100%",nominateLink:"https://www.esri.com"}):""};Ca.prototype._formatMapViewerPrimaryLink=function(H){var W=H.mapViewerUrl,ha=H.newMapViewerUrl,na="modern"===H.portal.defaultMapViewer,za=H.canOpenInNewMapViewer,Ga=E.default.checkLayersForNewFieldTypes(H);H=["OGCFeatureServer","Media Layer","Group Layer"].includes(H.type)||Ga&&!H.isFeatureCollection;return za&&na||H?ha:W};Ca.prototype._formatMapViewerPrimaryLabel=function(H){var W="modern"===H.portal.defaultMapViewer,ha=H.canOpenInNewMapViewer,
na=E.default.checkLayersForNewFieldTypes(H);H="OGCFeatureServer"===H.type||na&&!H.isFeatureCollection;na=ea.default.itemLinks;return ha&&W||H?na.openMapViewerBeta:na.openMapViewer};Ca.prototype._formatMapViewerSecondaryLink=function(H){var W=H.mapViewerUrl,ha=H.newMapViewerUrl,na="modern"===H.portal.defaultMapViewer;return H.canOpenInNewMapViewer&&na?W:ha};Ca.prototype._formatMapViewerSecondaryLabel=function(H){var W=H.canOpenInNewMapViewer,ha=ea.default.itemLinks;return"modern"===H.portal.defaultMapViewer&&
W?ha.openMapViewer:ha.openMapViewerBetaLabel};Ca.prototype._showDataLastUpdated=function(H,W){var ha=this,na;if((null===(na=H.layers)||void 0===na?0:na.length)&&"Feature Service"===H.type&&D.default.includes(H.typeKeywords,"Hosted Service")){var za,Ga,Oa,Ia;H.layers.forEach(function(Ka){if(Ka){var Sa=B.default.isDefined(W)&&Ka.id===W;Ka=Ka.editingInfo;(za=(null===Ka||void 0===Ka?void 0:Ka.dataLastEditDate)||void 0)&&(!Ga||Ga<za||Sa)&&(Ga=za);(Oa=(null===Ka||void 0===Ka?void 0:Ka.schemaLastEditDate)||
void 0)&&(!Ia||Ia<Oa||Sa)&&(Ia=Oa)}},this);(Ga||Ia)&&y.default.showNode((0,q.default)(".js-lastUpdatedContainer")[0]);H=function(Ka,Sa,Ua){Sa=(0,q.default)(Sa);Ka?null===Sa||void 0===Sa?void 0:Sa.forEach(function(Wa){n.default.set(Wa,"innerHTML","".concat(ha.i18n.itemProperties[Ua]," ").concat(ha._formatDateTime(Ka)));y.default.showNode(Wa)}):null===Sa||void 0===Sa?void 0:Sa.forEach(function(Wa){n.default.set(Wa,"innerHTML","");y.default.hideNode(Wa)})};H(Ga,".js-dataUpdatedLast","dataModified");
H(Ia,".js-schemaUpdatedLast","schemaUpdated")}};Ca.prototype._showMAndZDefaults=function(H,W){var ha,na,za,Ga=W&&W<(null===(ha=H.layers)||void 0===ha?void 0:ha.length)?null===(na=H.layers)||void 0===na?void 0:na[W]:null===(za=H.layers)||void 0===za?void 0:za[0];y.default.showNode((0,q.default)(".js-geometryOptionsContainer")[0]);W=document.querySelector(".js-zValuesEnabled");H=document.querySelector(".js-zDefaultValueEnabled");W.setAttribute("icon",Ga.hasZ?"toggle-on":"toggle-off");W.setAttribute("placeholder",
Ga.hasZ?"":this.i18n.sublayer.disabled);W.setAttribute("value",Ga.hasZ?this.i18n.sublayer.enabled:"");y.default.showNode(W);W=document.querySelector(".js-mValuesEnabled");W.setAttribute("icon",Ga.hasM?"toggle-on":"toggle-off");W.setAttribute("placeholder",Ga.hasM?"":this.i18n.sublayer.disabled);W.setAttribute("value",Ga.hasM?this.i18n.sublayer.enabled:"");y.default.showNode(W);Ga.enableZDefaults&&(W=document.querySelector(".z-default-value-edit"),y.default.showNode(H),W.setAttribute("value",String(Ga.zDefault)))};
Ca.prototype._htmlEncode=function(H){return R.default.htmlEncode(H)};Ca.prototype._linkify=function(H){void 0===H&&(H="");return E.default.linkify(H)};Ca.prototype.handleReplaceLayerSuccess=function(){window.location.reload()};return Ca=p.__decorate([(0,J.default)(T.default)],Ca)}()});